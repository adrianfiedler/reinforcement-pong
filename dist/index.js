!function(){function e(e,t){return Object.keys(t).forEach((function(n){"default"===n||"__esModule"===n||e.hasOwnProperty(n)||Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[n]}})})),e}function t(e){return e&&e.__esModule?e.default:e}function n(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function a(e){Object.defineProperty(e,"__esModule",{value:!0,configurable:!0})}var o={},u={},s=r.parcelRequire2ed5;null==s&&((s=function(e){if(e in o)return o[e].exports;if(e in u){var t=u[e];delete u[e];var n={id:e,exports:{}};return o[e]=n,t.call(n.exports,n,n.exports),n.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){u[e]=t},r.parcelRequire2ed5=s),s.register("jbRpz",(function(t,n){s("dyCh5"),s("f6sen"),s("2Lolk");var r=s("8onfg");e(t.exports,r)})),s.register("dyCh5",(function(e,t){var n=s("1dnDT");s("hbYT1"),s("kZayt"),s("gsgGx");var r=s("8orDI"),a=s("782ce"),i=s("dOUsY"),o=s("i4HMG"),u=s("4JvjV");n.getOrMakeEngine();var c={buffer:r.buffer,cast:a.cast,clone:i.clone,print:o.print};u.setOpHandler(c)})),s.register("1dnDT",(function(e,r){n(e.exports,"ENGINE",(function(){return A})),n(e.exports,"getOrMakeEngine",(function(){return w})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("9M1dW"),c=s("40Zzs"),l=s("lU3MY"),f=s("l2YeR"),d=s("cvMH2"),p=s("d4BUr"),h=s("6dVUb"),v=s("790q1"),g=s("4JvjV"),m=s("gIxdA"),y=s("kglvN"),x=(y=s("kglvN"),function(){"use strict";function e(){a.default(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return i.default(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}()),b=function(){"use strict";function e(t){a.default(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new x}return i.default(e,[{key:"ready",value:function(){var e=this;return o.default(t(c).mark((function n(){var r,a,i;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==e.pendingBackendInit){t.next=2;break}return t.abrupt("return",e.pendingBackendInit.then((function(){})));case 2:if(null==e.backendInstance){t.next=4;break}return t.abrupt("return");case 4:r=e.getSortedBackends(),a=0;case 6:if(!(a<r.length)){t.next=18;break}return i=r[a],t.next=10,e.initializeBackend(i).success;case 10:if(!t.sent){t.next=15;break}return t.next=14,e.setBackend(i);case 14:return t.abrupt("return");case 15:a++,t.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return t.stop()}}),n)})))()}},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(e){var n=this;return o.default(t(c).mark((function r(){var a,i;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n.registryFactory[e]){t.next=2;break}throw new Error("Backend name '".concat(e,"' not found in registry"));case 2:if(n.backendName=e,null!=n.registry[e]){t.next=16;break}if(n.backendInstance=null,a=n.initializeBackend(e),i=a.success,!a.asyncInit){t.next=12;break}return t.next=9,i;case 9:t.t0=t.sent,t.next=13;break;case 12:t.t0=i;case 13:if(t.t0){t.next=16;break}return t.abrupt("return",!1);case 16:return n.backendInstance=n.registry[e],n.setupRegisteredKernels(),n.profiler=new h.Profiler(n.backendInstance),t.abrupt("return",!0);case 20:case"end":return t.stop()}}),r)})))()}},{key:"setupRegisteredKernels",value:function(){var e=this;p.getKernelsForBackend(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;p.getKernelsForBackend(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this.registryFactory[e];if(null==t)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var n=t.factory();if(Promise.resolve(n)===n){var r=this,a=++this.pendingBackendInitId,i=n.then((function(t){return!(a<r.pendingBackendInitId)&&(r.registry[e]=t,r.pendingBackendInit=null,!0)})).catch((function(t){return a<r.pendingBackendInitId||(r.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(t.stack||t.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=n,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t="float32",n={x:e},r={dtype:t};return A.runKernelFunc((function(n){return n.cast(e,t)}),n,null,d.Cast,r)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e,t,n,r,a,i,o){var u,s=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,d=this.state.numBytes,h=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var v,g,m=p.getKernel(r,this.backendName);if(null!=m)f=function(){var e=s,n=s.backend.numDataIds();v=m.kernelFunc({inputs:t,attrs:a,backend:s.backend});var u=Array.isArray(v)?v:[v];s.shouldCheckForMemLeaks()&&s.checkKernelForMemLeak(r,n,u);var f=u.map((function(t){var n=t.dataId,r=t.shape,a=t.dtype;return e.makeTensorFromDataId(n,r,a)}));if(l){var d=s.getTensorsForGradient(r,t,f);if(null==d){null==o&&(o=[]);var p=f.filter((function(e,t){return o[t]}));d=(i||[]).slice().concat(p)}c=s.saveTensorsForBackwardMode(d)}return f};else{var y=this,x=function(e){var t=y;l&&(c=e.map((function(e){return t.keep(t.clone(e))})))};f=function(){var t=y,n=y.backend.numDataIds();v=y.tidy((function(){return e(t.backend,x)}));var a=Array.isArray(v)?v:[v];return y.shouldCheckForMemLeaks()&&y.checkKernelForMemLeak(r,n,a),a}}return this.scopedRun((function(){return s.state.kernelDepth++}),(function(){return s.state.kernelDepth--}),(function(){s.ENV.getBool("DEBUG")||s.state.profiling?(g=s.profiler.profileKernel(r,t,(function(){return f()})),s.ENV.getBool("DEBUG")&&s.profiler.logKernelProfile(g),u=g.outputs):u=f()})),l&&this.addTapeNode(r,t,u,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-d,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-h,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return null!=t[e]?t[e].shape:null})),outputShapes:u.map((function(e){return e.shape})),kernelTimeMs:g.timeMs,extraInfo:g.extraInfo}),Array.isArray(v)?u:u[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=p.getGradient(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(y.assert(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var u=n.filter((function(e,t){return o[t]}));return a.concat(u)}return null}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&y.isString(e[0])&&(a=e.map((function(e){return y.encodeString(e)})));var i=r.write(a,t,n),o=new g.Tensor(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var u=this.state.tensorInfo.get(i),s=y.bytesFromStringArray(a);this.state.numBytes+=s-u.bytes,u.bytes=s}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){n=n||"float32";var a=new g.Tensor(t,n,e,this.nextTensorId());return this.incRef(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new g.Variable(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"incRef",value:function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*y.bytesPerElement(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof g.Variable||this.track(e)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(e){var n=this;return o.default(t(c).mark((function r(){var a,i,o,s,l,f,d,p,h;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.state.profiling=!0,i=n.state.numBytes,o=n.state.numTensors,n.state.activeProfile.kernels=[],t.next=7,e();case 7:n.state.activeProfile.result=t.sent,n.state.profiling=!1,n.state.activeProfile.peakBytes=(a=Math).max.apply(a,u.default(n.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),n.state.activeProfile.newBytes=n.state.numBytes-i,n.state.activeProfile.newTensors=n.state.numTensors-o,s=!0,l=!1,f=void 0,t.prev=13,d=n.state.activeProfile.kernels[Symbol.iterator]();case 15:if(s=(p=d.next()).done){t.next=26;break}return h=p.value,t.next=19,h.kernelTimeMs;case 19:return h.kernelTimeMs=t.sent,t.next=22,h.extraInfo;case 22:h.extraInfo=t.sent;case 23:s=!0,t.next=15;break;case 26:t.next=32;break;case 28:t.prev=28,t.t0=t.catch(13),l=!0,f=t.t0;case 32:t.prev=32,t.prev=33,s||null==d.return||d.return();case 35:if(t.prev=35,!l){t.next=38;break}throw f;case 38:return t.finish(35);case 39:return t.finish(32);case 40:return t.abrupt("return",n.state.activeProfile);case 41:case"end":return t.stop()}}),r,null,[[13,28,32,40],[33,,35,39]])})))()}},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,u={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},s=p.getGradient(e);null!=s&&(r=s.gradFunc),null!=r&&(u.gradient=function(e){var t=o;return e=e.map((function(e,r){if(null==e){var a=n[r],i=y.makeZerosTypedArray(a.size,a.dtype);return t.makeTensor(i,a.shape,a.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(u)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=m.getTensorsInContainer(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this;if(y.assert(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var i=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));y.assert(i instanceof g.Tensor,(function(){return"The result y returned by f() must be a tensor."}));var o=v.getFilteredNodesXToY(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e=a,r={};r[i.id]=null==n?k(i.shape):n,v.backpropagateGradients(r,o,(function(t){return e.tidy(t)}),E);var u=t.map((function(e){return r[e.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e.saved[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.dispose()}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}})),a.state.activeTape=null),{value:i,grads:u}}))}},{key:"customGrad",value:function(e){var t=this;return y.assert(y.isFunction(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;y.assert(r.every((function(e){return e instanceof g.Tensor})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};return r.forEach((function(e,t){o[t]=e})),t.runKernelFunc((function(t,n){return i=e.apply(void 0,u.default(u.default(r).concat([n]))),y.assert(i.value instanceof g.Tensor,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),y.assert(y.isFunction(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value}),o,(function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];y.assert(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),y.assert(a.every((function(e){return e instanceof g.Tensor})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o}))}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(e){var n=this;return o.default(t(c).mark((function r(){var a,i;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=y.now(),t.next=3,n.backend.time(e);case 3:return(i=t.sent).wallMs=y.now()-a,t.abrupt("return",i);case 6:case"end":return t.stop()}}),r)})))()}},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new x,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function k(e){var t=y.makeOnesTypedArray(y.sizeFromShape(e),"float32");return A.makeTensor(t,e,"float32")}function w(){var e=f.getGlobalNamespace();if(null==e._tfengine){var t=new l.Environment(e);e._tfengine=new b(t)}return l.setEnvironmentGlobal(e._tfengine.ENV),g.setTensorTracker((function(){return e._tfengine})),e._tfengine}b.nextTensorId=0,b.nextVariableId=0;var A=w();function E(e,t){var n={a:e,b:t};return A.runKernelFunc((function(n,r){var a=n.add(e,t);return r([e,t]),a}),n,null,d.Add)}})),s.register("1i51P",(function(e,t){n(e.exports,"applyDecoratedDescriptor",(function(){return s("kCPx8").default})),n(e.exports,"arrayLikeToArray",(function(){return s("bpc8w").default})),n(e.exports,"arrayWithHoles",(function(){return s("1xFXZ").default})),n(e.exports,"arrayWithoutHoles",(function(){return s("ev5PT").default})),n(e.exports,"assertThisInitialized",(function(){return s("jZS3C").default})),n(e.exports,"asyncGenerator",(function(){return s("kiaJM").default})),n(e.exports,"asyncGeneratorDelegate",(function(){return s("azpRu").default})),n(e.exports,"asyncIterator",(function(){return s("53d7u").default})),n(e.exports,"asyncToGenerator",(function(){return s("e3nFV").default})),n(e.exports,"awaitAsyncGenerator",(function(){return s("eeR1T").default})),n(e.exports,"awaitValue",(function(){return s("96QON").default})),n(e.exports,"checkPrivateRedeclaration",(function(){return s("9GGhJ").default})),n(e.exports,"classApplyDescriptorDestructureSet",(function(){return s("fpdut").default})),n(e.exports,"classApplyDescriptorGet",(function(){return s("jJDBP").default})),n(e.exports,"classApplyDescriptorSet",(function(){return s("iFYpe").default})),n(e.exports,"classCallCheck",(function(){return s("3QOYJ").default})),n(e.exports,"classCheckPrivateStaticFieldDescriptor",(function(){return s("lSPym").default})),n(e.exports,"classCheckPrivateStaticAccess",(function(){return s("lPdZn").default})),n(e.exports,"classNameTDZError",(function(){return s("4oZ74").default})),n(e.exports,"classPrivateFieldDestructureSet",(function(){return s("72aCx").default})),n(e.exports,"classPrivateFieldGet",(function(){return s("bnPYC").default})),n(e.exports,"classPrivateFieldInit",(function(){return s("gXxGt").default})),n(e.exports,"classPrivateFieldLooseBase",(function(){return s("VIIcq").default})),n(e.exports,"classPrivateFieldLooseKey",(function(){return s("at3mU").default})),n(e.exports,"classPrivateFieldSet",(function(){return s("ctUeN").default})),n(e.exports,"classPrivateMethodGet",(function(){return s("g4juT").default})),n(e.exports,"classPrivateMethodInit",(function(){return s("9osui").default})),n(e.exports,"classPrivateMethodSet",(function(){return s("3eIay").default})),n(e.exports,"classStaticPrivateFieldDestructureSet",(function(){return s("ehcig").default})),n(e.exports,"classStaticPrivateFieldSpecGet",(function(){return s("jM77t").default})),n(e.exports,"classStaticPrivateFieldSpecSet",(function(){return s("knHd6").default})),n(e.exports,"construct",(function(){return s("9DJxQ").default})),n(e.exports,"createClass",(function(){return s("2tuUj").default})),n(e.exports,"createSuper",(function(){return s("d6iiX").default})),n(e.exports,"decorate",(function(){return s("ftIyy").default})),n(e.exports,"defaults",(function(){return s("jJDTV").default})),n(e.exports,"defineEnumerableProperties",(function(){return s("99vVo").default})),n(e.exports,"defineProperty",(function(){return s("4Ui3v").default})),n(e.exports,"extends",(function(){return s("h6h7E").default})),n(e.exports,"get",(function(){return s("kRKWT").default})),n(e.exports,"getPrototypeOf",(function(){return s("eYQ8O").default})),n(e.exports,"inherits",(function(){return s("2vsUb").default})),n(e.exports,"inheritsLoose",(function(){return s("dQCqn").default})),n(e.exports,"initializerDefineProperty",(function(){return s("l1C8f").default})),n(e.exports,"initializerWarningHelper",(function(){return s("lOWzh").default})),n(e.exports,"_instanceof",(function(){return s("j0PpK").default})),n(e.exports,"interopRequireDefault",(function(){return s("idszh").default})),n(e.exports,"interopRequireWildcard",(function(){return s("8LpcR").default})),n(e.exports,"isNativeFunction",(function(){return s("1MGd8").default})),n(e.exports,"isNativeReflectConstruct",(function(){return s("3GVZ2").default})),n(e.exports,"iterableToArray",(function(){return s("1jhzp").default})),n(e.exports,"iterableToArrayLimit",(function(){return s("bTIqw").default})),n(e.exports,"iterableToArrayLimitLoose",(function(){return s("66wj1").default})),n(e.exports,"jsx",(function(){return s("aU5X9").default})),n(e.exports,"newArrowCheck",(function(){return s("rmW7X").default})),n(e.exports,"nonIterableRest",(function(){return s("79bcI").default})),n(e.exports,"nonIterableSpread",(function(){return s("BkPa5").default})),n(e.exports,"objectSpread",(function(){return s("83kYg").default})),n(e.exports,"objectWithoutProperties",(function(){return s("6HjhT").default})),n(e.exports,"objectWithoutPropertiesLoose",(function(){return s("95Sgr").default})),n(e.exports,"possibleConstructorReturn",(function(){return s("fQHbd").default})),n(e.exports,"readOnlyError",(function(){return s("55NcR").default})),n(e.exports,"set",(function(){return s("emV2x").default})),n(e.exports,"setPrototypeOf",(function(){return s("9kCQT").default})),n(e.exports,"skipFirstGeneratorNext",(function(){return s("lcpLa").default})),n(e.exports,"slicedToArray",(function(){return s("6vecG").default})),n(e.exports,"slicedToArrayLoose",(function(){return s("dWbUC").default})),n(e.exports,"superPropBase",(function(){return s("1yvT6").default})),n(e.exports,"taggedTemplateLiteral",(function(){return s("cGsiS").default})),n(e.exports,"taggedTemplateLiteralLoose",(function(){return s("7qcPG").default})),n(e.exports,"_throw",(function(){return s("eND62").default})),n(e.exports,"toArray",(function(){return s("cTgYo").default})),n(e.exports,"toConsumableArray",(function(){return s("9M1dW").default})),n(e.exports,"toPrimitive",(function(){return s("2JZVl").default})),n(e.exports,"toPropertyKey",(function(){return s("bpy7o").default})),n(e.exports,"typeOf",(function(){return s("5lcaY").default})),n(e.exports,"unsupportedIterableToArray",(function(){return s("kDJ7E").default})),n(e.exports,"wrapAsyncGenerator",(function(){return s("hxOv2").default})),n(e.exports,"wrapNativeSuper",(function(){return s("4pZGK").default})),n(e.exports,"__decorate",(function(){return s("eAFLd").__decorate})),n(e.exports,"__metadata",(function(){return s("eAFLd").__metadata})),n(e.exports,"__param",(function(){return s("eAFLd").__param}));s("kCPx8"),s("bpc8w"),s("1xFXZ"),s("ev5PT"),s("jZS3C"),s("kiaJM"),s("azpRu"),s("53d7u"),s("e3nFV"),s("eeR1T"),s("96QON"),s("9GGhJ"),s("fpdut"),s("jJDBP"),s("iFYpe"),s("3QOYJ"),s("lSPym"),s("lPdZn"),s("4oZ74"),s("72aCx"),s("bnPYC"),s("gXxGt"),s("VIIcq"),s("at3mU"),s("ctUeN"),s("g4juT"),s("9osui"),s("3eIay"),s("ehcig"),s("jM77t"),s("knHd6"),s("9DJxQ"),s("2tuUj"),s("d6iiX"),s("ftIyy"),s("jJDTV"),s("99vVo"),s("4Ui3v"),s("h6h7E"),s("kRKWT"),s("eYQ8O"),s("2vsUb"),s("dQCqn"),s("l1C8f"),s("lOWzh"),s("j0PpK"),s("idszh"),s("8LpcR"),s("1MGd8"),s("3GVZ2"),s("1jhzp"),s("bTIqw"),s("66wj1"),s("aU5X9"),s("rmW7X"),s("79bcI"),s("BkPa5"),s("83kYg"),s("6HjhT"),s("95Sgr"),s("fQHbd"),s("55NcR"),s("emV2x"),s("9kCQT"),s("lcpLa"),s("6vecG"),s("dWbUC"),s("1yvT6"),s("cGsiS"),s("7qcPG"),s("eND62"),s("cTgYo"),s("9M1dW"),s("2JZVl"),s("bpy7o"),s("5lcaY"),s("kDJ7E"),s("hxOv2"),s("4pZGK"),s("eAFLd")})),s.register("kCPx8",(function(e,t){function r(e,t,n,r,a){var i={};Object.keys(r).forEach((function(e){i[e]=r[e]})),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=n.slice().reverse().reduce((function(n,r){return r&&r(e,t,n)||n}),i);var o=Object.prototype.hasOwnProperty.call(i,"get")||Object.prototype.hasOwnProperty.call(i,"set");return a&&void 0!==i.initializer&&!o&&(i.value=i.initializer?i.initializer.call(a):void 0,i.initializer=void 0),o&&(delete i.writable,delete i.initializer,delete i.value),void 0===i.initializer&&(Object.defineProperty(e,t,i),i=null),i}n(e.exports,"default",(function(){return r}))})),s.register("bpc8w",(function(e,t){function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n(e.exports,"default",(function(){return r}))})),s.register("1xFXZ",(function(e,t){function r(e){if(Array.isArray(e))return e}n(e.exports,"default",(function(){return r}))})),s.register("ev5PT",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bpc8w");function a(e){if(Array.isArray(e))return r.default(e)}})),s.register("jZS3C",(function(e,t){function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n(e.exports,"default",(function(){return r}))})),s.register("kiaJM",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("96QON");function a(e){var t,n;function a(t,n){try{var o=e[t](n),u=o.value,s=u instanceof r.default;Promise.resolve(s?u.wrapped:u).then((function(e){s?a("next",e):i(o.done?"return":"normal",e)}),(function(e){a("throw",e)}))}catch(e){i("throw",e)}}function i(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?a(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(i,o){var u={key:e,arg:r,resolve:i,reject:o,next:null};n?n=n.next=u:(t=n=u,a(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(a.prototype[Symbol.asyncIterator]=function(){return this}),a.prototype.next=function(e){return this._invoke("next",e)},a.prototype.throw=function(e){return this._invoke("throw",e)},a.prototype.return=function(e){return this._invoke("return",e)}})),s.register("96QON",(function(e,t){function r(e){this.wrapped=e}n(e.exports,"default",(function(){return r}))})),s.register("azpRu",(function(e,t){function r(e,t){var n={},r=!1;function a(n,a){return r=!0,a=new Promise((function(t){t(e[n](a))})),{done:!1,value:t(a)}}return"function"==typeof Symbol&&Symbol.iterator&&(n[Symbol.iterator]=function(){return this}),n.next=function(e){return r?(r=!1,e):a("next",e)},"function"==typeof e.throw&&(n.throw=function(e){if(r)throw r=!1,e;return a("throw",e)}),"function"==typeof e.return&&(n.return=function(e){return a("return",e)}),n}n(e.exports,"default",(function(){return r}))})),s.register("53d7u",(function(e,t){function r(e){var t;if("function"==typeof Symbol){if(Symbol.asyncIterator&&null!=(t=e[Symbol.asyncIterator]))return t.call(e);if(Symbol.iterator&&null!=(t=e[Symbol.iterator]))return t.call(e)}throw new TypeError("Object is not async iterable")}n(e.exports,"default",(function(){return r}))})),s.register("e3nFV",(function(e,t){function r(e,t,n,r,a,i,o){try{var u=e[i](o),s=u.value}catch(e){return void n(e)}u.done?t(s):Promise.resolve(s).then(r,a)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var o=e.apply(t,n);function u(e){r(o,a,i,u,s,"next",e)}function s(e){r(o,a,i,u,s,"throw",e)}u(void 0)}))}}n(e.exports,"default",(function(){return a}))})),s.register("eeR1T",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("96QON");function a(e){return new r.default(e)}})),s.register("9GGhJ",(function(e,t){function r(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}n(e.exports,"default",(function(){return r}))})),s.register("fpdut",(function(e,t){function r(e,t){if(t.set)return"__destrObj"in t||(t.__destrObj={set value(n){t.set.call(e,n)}}),t.__destrObj;if(!t.writable)throw new TypeError("attempted to set read only private field");return t}n(e.exports,"default",(function(){return r}))})),s.register("jJDBP",(function(e,t){function r(e,t){return t.get?t.get.call(e):t.value}n(e.exports,"default",(function(){return r}))})),s.register("iFYpe",(function(e,t){function r(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=n}}n(e.exports,"default",(function(){return r}))})),s.register("3QOYJ",(function(e,t){function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n(e.exports,"default",(function(){return r}))})),s.register("lSPym",(function(e,t){function r(e,t){if(void 0===e)throw new TypeError("attempted to "+t+" private static field before its declaration")}n(e.exports,"default",(function(){return r}))})),s.register("lPdZn",(function(e,t){function r(e,t){if(e!==t)throw new TypeError("Private static access of wrong provenance")}n(e.exports,"default",(function(){return r}))})),s.register("4oZ74",(function(e,t){function r(e){throw new Error('Class "'+e+'" cannot be referenced in computed property keys.')}n(e.exports,"default",(function(){return r}))})),s.register("72aCx",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("ba3KO"),a=s("fpdut");function i(e,t){var n=r.default(e,t,"set");return a.default(e,n)}})),s.register("ba3KO",(function(e,t){function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to "+n+" private field on non-instance");return t.get(e)}n(e.exports,"default",(function(){return r}))})),s.register("bnPYC",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("ba3KO"),a=s("jJDBP");function i(e,t){var n=r.default(e,t,"get");return a.default(e,n)}})),s.register("gXxGt",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("9GGhJ");function a(e,t,n){r.default(e,t),t.set(e,n)}})),s.register("VIIcq",(function(e,t){function r(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}n(e.exports,"default",(function(){return r}))})),s.register("at3mU",(function(e,t){n(e.exports,"default",(function(){return a}));var r=0;function a(e){return"__private_"+r+++"_"+e}})),s.register("ctUeN",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("ba3KO"),a=s("iFYpe");function i(e,t,n){var i=r.default(e,t,"set");return a.default(e,i,n),n}})),s.register("g4juT",(function(e,t){function r(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n}n(e.exports,"default",(function(){return r}))})),s.register("9osui",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("9GGhJ");function a(e,t){r.default(e,t),t.add(e)}})),s.register("3eIay",(function(e,t){function r(){throw new TypeError("attempted to reassign private method")}n(e.exports,"default",(function(){return r}))})),s.register("ehcig",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("lPdZn"),a=(r=s("lPdZn"),s("fpdut"));function i(e,t,n){return r.default(e,t),r.default(n,"set"),a.default(e,n)}})),s.register("jM77t",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("lPdZn"),a=(r=s("lPdZn"),s("jJDBP"));function i(e,t,n){return r.default(e,t),r.default(n,"get"),a.default(e,n)}})),s.register("knHd6",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("lPdZn"),a=(r=s("lPdZn"),s("iFYpe"));function i(e,t,n,i){return r.default(e,t),r.default(n,"set"),a.default(e,n,i),i}})),s.register("9DJxQ",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("9kCQT");function a(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function i(e,t,n){return i=a()?Reflect.construct:function(e,t,n){var a=[null];a.push.apply(a,t);var i=new(Function.bind.apply(e,a));return n&&r.default(i,n.prototype),i},i.apply(null,arguments)}function o(e,t,n){return i.apply(null,arguments)}})),s.register("9kCQT",(function(e,t){function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return r(e,t)}n(e.exports,"default",(function(){return a}))})),s.register("2tuUj",(function(e,t){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n(e.exports,"default",(function(){return a}))})),s.register("d6iiX",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("3GVZ2"),a=s("eYQ8O"),i=s("fQHbd");function o(e){var t=r.default();return function(){var n,r=a.default(e);if(t){var o=a.default(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return i.default(this,n)}}})),s.register("3GVZ2",(function(e,t){function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}n(e.exports,"default",(function(){return r}))})),s.register("eYQ8O",(function(e,t){function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){return r(e)}n(e.exports,"default",(function(){return a}))})),s.register("fQHbd",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("jZS3C"),a=s("5lcaY");function i(e,t){return!t||"object"!==a.default(t)&&"function"!=typeof t?r.default(e):t}})),s.register("5lcaY",(function(e,t){function r(e){return e&&e.constructor===Symbol?"symbol":typeof e}n(e.exports,"default",(function(){return r}))})),s.register("ftIyy",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("cTgYo"),a=s("bpy7o");function i(e,t,n){var r,a,i,s=t((function(e){!function(e,t){["method","field"].forEach((function(n){t.forEach((function(t){t.kind===n&&"own"===t.placement&&f(e,t)}))}))}(e,h.elements)}),n),h=function(e,t){var n=[],r=[],a={static:[],prototype:[],own:[]};if(e.forEach((function(e){d(e,a)})),e.forEach((function(e){if(!c(e))return n.push(e);var t=function(e,t){for(var n=[],r=[],a=e.decorators,i=a.length-1;i>=0;i--){var o=t[e.placement];o.splice(o.indexOf(e.key),1);var u=p(e),s=g((0,a[i])(u)||u);d(e=s.element,t),s.finisher&&r.push(s.finisher);var c=s.extras;if(c){for(var l=0;l<c.length;l++)d(c[l],t);n.push.apply(n,c)}}return{element:e,finishers:r,extras:n}}(e,a);n.push(t.element),n.push.apply(n,t.extras),r.push.apply(r,t.finishers)})),!t)return{elements:n,finishers:r};var i=function(e,t){for(var n=[],r=t.length-1;r>=0;r--){var a=m(e),i=y((0,t[r])(a)||a);if(void 0!==i.finisher&&n.push(i.finisher),void 0!==i.elements){e=i.elements;for(var o=0;o<e.length-1;o++)for(var u=o+1;u<e.length;u++)if(e[o].key===e[u].key&&e[o].placement===e[u].placement)throw new TypeError("Duplicated element ("+e[o].key+")")}}return{elements:e,finishers:n}}(n,t);return r.push.apply(r,i.finishers),i.finishers=r,i}(function(e){for(var t=[],n=function(e){return"method"===e.kind&&e.key===i.key&&e.placement===i.placement},r=0;r<e.length;r++){var a,i=e[r];if("method"===i.kind&&(a=t.find(n)))if(l(i.descriptor)||l(a.descriptor)){if(c(i)||c(a))throw new ReferenceError("Duplicated methods ("+i.key+") can't be decorated.");a.descriptor=i.descriptor}else{if(c(i)){if(c(a))throw new ReferenceError("Decorators can't be placed on different accessors with for the same property ("+i.key+").");a.decorators=i.decorators}u(i,a)}else t.push(i)}return t}(s.d.map(o)),e);return r=s.F,a=h.elements,i=r.prototype,["method","field"].forEach((function(e){a.forEach((function(t){var n=t.placement;t.kind!==e||"static"!==n&&"prototype"!==n||f("static"===n?r:i,t)}))})),function(e,t){for(var n=0;n<t.length;n++){var r=(0,t[n])(e);if(void 0!==r){if("function"!=typeof r)throw new TypeError("Finishers must return a constructor.");e=r}}return e}(s.F,h.finishers)}function o(e){var t,n=a.default(e.key);"method"===e.kind?(t={value:e.value,writable:!0,configurable:!0,enumerable:!1},Object.defineProperty(e.value,"name",{value:"symbol"===_typeof(n)?"":n,configurable:!0})):"get"===e.kind?t={get:e.value,configurable:!0,enumerable:!1}:"set"===e.kind?t={set:e.value,configurable:!0,enumerable:!1}:"field"===e.kind&&(t={configurable:!0,writable:!0,enumerable:!0});var r={kind:"field"===e.kind?"field":"method",key:n,placement:e.static?"static":"field"===e.kind?"own":"prototype",descriptor:t};return e.decorators&&(r.decorators=e.decorators),"field"===e.kind&&(r.initializer=e.value),r}function u(e,t){void 0!==e.descriptor.get?t.descriptor.get=e.descriptor.get:t.descriptor.set=e.descriptor.set}function c(e){return e.decorators&&e.decorators.length}function l(e){return void 0!==e&&!(void 0===e.value&&void 0===e.writable)}function f(e,t){var n=t.descriptor;if("field"===t.kind){var r=t.initializer;n={enumerable:n.enumerable,writable:n.writable,configurable:n.configurable,value:void 0===r?void 0:r.call(e)}}Object.defineProperty(e,t.key,n)}function d(e,t,n){var r=t[e.placement];if(!n&&-1!==r.indexOf(e.key))throw new TypeError("Duplicated element ("+e.key+")");r.push(e.key)}function p(e){var t={kind:e.kind,key:e.key,placement:e.placement,descriptor:e.descriptor};return Object.defineProperty(t,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),"field"===e.kind&&(t.initializer=e.initializer),t}function h(e){if(void 0!==e)return r.default(e).map((function(e){var t=v(e);return x(e,"finisher","An element descriptor"),x(e,"extras","An element descriptor"),t}))}function v(e){var t=String(e.kind);if("method"!==t&&"field"!==t)throw new TypeError('An element descriptor\'s .kind property must be either "method" or "field", but a decorator created an element descriptor with .kind "'+t+'"');var n=a.default(e.key),r=String(e.placement);if("static"!==r&&"prototype"!==r&&"own"!==r)throw new TypeError('An element descriptor\'s .placement property must be one of "static", "prototype" or "own", but a decorator created an element descriptor with .placement "'+r+'"');var i=e.descriptor;x(e,"elements","An element descriptor");var o={kind:t,key:n,placement:r,descriptor:Object.assign({},i)};return"field"!==t?x(e,"initializer","A method descriptor"):(x(i,"get","The property descriptor of a field descriptor"),x(i,"set","The property descriptor of a field descriptor"),x(i,"value","The property descriptor of a field descriptor"),o.initializer=e.initializer),o}function g(e){return{element:v(e),finisher:b(e,"finisher"),extras:h(e.extras)}}function m(e){var t={kind:"class",elements:e.map(p)};return Object.defineProperty(t,Symbol.toStringTag,{value:"Descriptor",configurable:!0}),t}function y(e){var t=String(e.kind);if("class"!==t)throw new TypeError('A class descriptor\'s .kind property must be "class", but a decorator created a class descriptor with .kind "'+t+'"');x(e,"key","A class descriptor"),x(e,"placement","A class descriptor"),x(e,"descriptor","A class descriptor"),x(e,"initializer","A class descriptor"),x(e,"extras","A class descriptor");var n=b(e,"finisher");return{elements:h(e.elements),finisher:n}}function x(e,t,n){if(void 0!==e[t])throw new TypeError(n+" can't have a ."+t+" property.")}function b(e,t){var n=e[t];if(void 0!==n&&"function"!=typeof n)throw new TypeError("Expected '"+t+"' to be a function");return n}})),s.register("cTgYo",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("1xFXZ"),a=s("1jhzp"),o=s("79bcI"),u=s("kDJ7E");function c(e){return r.default(e)||a.default(e)||u.default(e,i)||o.default()}})),s.register("1jhzp",(function(e,t){function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n(e.exports,"default",(function(){return r}))})),s.register("79bcI",(function(e,t){function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n(e.exports,"default",(function(){return r}))})),s.register("kDJ7E",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bpc8w");function a(e,t){if(e){if("string"==typeof e)return r.default(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r.default(e,t):void 0}}})),s.register("bpy7o",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("5lcaY"),a=s("2JZVl");function i(e){var t=a.default(e,"string");return"symbol"===r.default(t)?t:String(t)}})),s.register("2JZVl",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("5lcaY");function a(e,t){if("object"!==r.default(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r.default(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}})),s.register("jJDTV",(function(e,t){function r(e,t){for(var n=Object.getOwnPropertyNames(t),r=0;r<n.length;r++){var a=n[r],i=Object.getOwnPropertyDescriptor(t,a);i&&i.configurable&&void 0===e[a]&&Object.defineProperty(e,a,i)}return e}n(e.exports,"default",(function(){return r}))})),s.register("99vVo",(function(e,t){function r(e,t){for(var n in t){(i=t[n]).configurable=i.enumerable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n,i)}if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(t),a=0;a<r.length;a++){var i,o=r[a];(i=t[o]).configurable=i.enumerable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,o,i)}return e}n(e.exports,"default",(function(){return r}))})),s.register("4Ui3v",(function(e,t){function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n(e.exports,"default",(function(){return r}))})),s.register("h6h7E",(function(e,t){function r(){return r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},r.apply(this,arguments)}function a(){return r.apply(this,arguments)}n(e.exports,"default",(function(){return a}))})),s.register("kRKWT",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("1yvT6");function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=r.default(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(n||e):i.value}})(e,t,n)}function i(e,t,n){return a(e,t,n)}})),s.register("1yvT6",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("eYQ8O");function a(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r.default(e)););return e}})),s.register("2vsUb",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("9kCQT");function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r.default(e,t)}})),s.register("dQCqn",(function(e,t){function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n(e.exports,"default",(function(){return r}))})),s.register("l1C8f",(function(e,t){function r(e,t,n,r){n&&Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}n(e.exports,"default",(function(){return r}))})),s.register("lOWzh",(function(e,t){function r(e,t){throw new Error("Decorating class property failed. Please ensure that proposal-class-properties is enabled and set to use loose mode. To use proposal-class-properties in spec mode with decorators, wait for the next major version of decorators in stage 2.")}n(e.exports,"default",(function(){return r}))})),s.register("j0PpK",(function(e,t){function r(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}n(e.exports,"default",(function(){return r}))})),s.register("idszh",(function(e,t){function r(e){return e&&e.__esModule?e:{default:e}}n(e.exports,"default",(function(){return r}))})),s.register("8LpcR",(function(e,t){function r(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return r=function(){return e},e}function a(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=r();if(t&&t.has(e))return t.get(e);var n={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var o=a?Object.getOwnPropertyDescriptor(e,i):null;o&&(o.get||o.set)?Object.defineProperty(n,i,o):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}n(e.exports,"default",(function(){return a}))})),s.register("1MGd8",(function(e,t){function r(e){return-1!==Function.toString.call(e).indexOf("[native code]")}n(e.exports,"default",(function(){return r}))})),s.register("bTIqw",(function(e,t){function r(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,u=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{o||null==n.return||n.return()}finally{if(u)throw a}}return i}}n(e.exports,"default",(function(){return r}))})),s.register("66wj1",(function(e,t){function r(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null!=n){var r=[];for(n=n.call(e);!(kr=n.next()).done&&(r.push(kr.value),!t||r.length!==t););return r}}n(e.exports,"default",(function(){return r}))})),s.register("aU5X9",(function(e,t){var r;function a(e,t,n,a){r||(r="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var i=e&&e.defaultProps,o=arguments.length-3;if(t||0===o||(t={children:void 0}),t&&i)for(var u in i)void 0===t[u]&&(t[u]=i[u]);else t||(t=i||{});if(1===o)t.children=a;else if(o>1){for(var s=new Array(o),c=0;c<o;c++)s[c]=arguments[c+3];t.children=s}return{$$typeof:r,type:e,key:void 0===n?null:""+n,ref:null,props:t,_owner:null}}n(e.exports,"default",(function(){return a}))})),s.register("rmW7X",(function(e,t){function r(e,t){if(e!==t)throw new TypeError("Cannot instantiate an arrow function")}n(e.exports,"default",(function(){return r}))})),s.register("BkPa5",(function(e,t){function r(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n(e.exports,"default",(function(){return r}))})),s.register("83kYg",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("4Ui3v");function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){r.default(e,t,n[t])}))}return e}})),s.register("6HjhT",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("95Sgr");function a(e,t){if(null==e)return{};var n,a,i=r.default(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}})),s.register("95Sgr",(function(e,t){function r(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}n(e.exports,"default",(function(){return r}))})),s.register("55NcR",(function(e,t){function r(e){throw new Error('"'+e+'" is read-only')}n(e.exports,"default",(function(){return r}))})),s.register("emV2x",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("4Ui3v"),a=s("1yvT6");function i(e,t,n,o){return i="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,i){var o,u=a.default(e,t);if(u){if((o=Object.getOwnPropertyDescriptor(u,t)).set)return o.set.call(i,n),!0;if(!o.writable)return!1}if(o=Object.getOwnPropertyDescriptor(i,t)){if(!o.writable)return!1;o.value=n,Object.defineProperty(i,t,o)}else r.default(i,t,n);return!0},i(e,t,n,o)}function o(e,t,n,r,a){if(!i(e,t,n,r||e)&&a)throw new Error("failed to set property");return n}})),s.register("lcpLa",(function(e,t){function r(e){return function(){var t=e.apply(this,arguments);return t.next(),t}}n(e.exports,"default",(function(){return r}))})),s.register("6vecG",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("1xFXZ"),a=s("1jhzp"),i=s("79bcI"),o=s("kDJ7E");function u(e,t){return r.default(e)||a.default(e,t)||o.default(e,t)||i.default()}})),s.register("dWbUC",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("1xFXZ"),a=s("66wj1"),i=s("79bcI"),o=s("kDJ7E");function u(e,t){return r.default(e)||a.default(e,t)||o.default(e,t)||i.default()}})),s.register("cGsiS",(function(e,t){function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n(e.exports,"default",(function(){return r}))})),s.register("7qcPG",(function(e,t){function r(e,t){return t||(t=e.slice(0)),e.raw=t,e}n(e.exports,"default",(function(){return r}))})),s.register("eND62",(function(e,t){function r(e){throw e}n(e.exports,"default",(function(){return r}))})),s.register("9M1dW",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("ev5PT"),a=s("1jhzp"),i=s("BkPa5"),o=s("kDJ7E");function u(e){return r.default(e)||a.default(e)||o.default(e)||i.default()}})),s.register("hxOv2",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("kiaJM");function a(e){return function(){return new r.default(e.apply(this,arguments))}}})),s.register("4pZGK",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("9DJxQ"),a=s("1MGd8"),i=s("eYQ8O"),o=s("9kCQT");function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||!a.default(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return r.default(e,arguments,i.default(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o.default(n,e)},u(e)}function c(e){return u(e)}})),s.register("eAFLd",(function(e,t){n(e.exports,"__decorate",(function(){return r})),n(e.exports,"__param",(function(){return a})),n(e.exports,"__metadata",(function(){return i}));function r(e,t,n,r){var a,i=arguments.length,o=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(o=(i<3?a(o):i>3?a(t,n,o):a(t,n))||o);return i>3&&o&&Object.defineProperty(t,n,o),o}function a(e,t){return function(n,r){t(n,r,e)}}function i(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}Object.create;Object.create})),s.register("40Zzs",(function(e,t){var n=function(e){var t,n=Object.prototype,r=n.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},i=a.iterator||"@@iterator",o=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,i=Object.create(a.prototype),o=new T(r||[]);return i._invoke=function(e,t,n){var r=f;return function(a,i){if(r===p)throw new Error("Generator is already running");if(r===h){if("throw"===a)throw i;return F()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=C(o,n);if(u){if(u===v)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===f)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=p;var s=l(e,t,n);if("normal"===s.type){if(r=n.done?h:d,s.arg===v)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=h,n.method="throw",n.arg=s.arg)}}}(e,n,o),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",h="completed",v={};function g(){}function m(){}function y(){}var x={};s(x,i,(function(){return this}));var b=Object.getPrototypeOf,k=b&&b(b(D([])));k&&k!==n&&r.call(k,i)&&(x=k);var w=y.prototype=g.prototype=Object.create(x);function A(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function E(e,t){function n(a,i,o,u){var s=l(e[a],e,i);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,o,u)}),(function(e){n("throw",e,o,u)})):t.resolve(f).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,u)}))}u(s.arg)}var a;this._invoke=function(e,r){function i(){return new t((function(t,a){n(e,r,t,a)}))}return a=a?a.then(i,i):i()}}function C(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var a=l(r,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,v;var i=a.arg;return i?i.done?(n[e.resultName]=i.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function N(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function D(e){if(e){var n=e[i];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function n(){for(;++a<e.length;)if(r.call(e,a))return n.value=e[a],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}return{next:F}}function F(){return{value:t,done:!0}}return m.prototype=y,s(w,"constructor",y),s(y,"constructor",m),m.displayName=s(y,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},A(E.prototype),s(E.prototype,o,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new E(c(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},A(w),s(w,u,"Generator"),s(w,i,(function(){return this})),s(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=D,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function a(r,a){return u.type="throw",u.arg=e,n.next=r,a&&(n.method="next",n.arg=t),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],u=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(s&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;N(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})),s.register("lU3MY",(function(e,r){n(e.exports,"Environment",(function(){return f})),n(e.exports,"env",(function(){return p})),n(e.exports,"ENV",(function(){return h})),n(e.exports,"setEnvironmentGlobal",(function(){return v})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("6vecG"),c=s("40Zzs"),l="tfjsflags",f=function(){"use strict";function e(t){a.default(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return i.default(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(e){var n=this;return o.default(t(c).mark((function r(){return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e in n.flags)){t.next=2;break}return t.abrupt("return",n.flags[e]);case 2:return t.next=4,n.evaluateFlag(e);case 4:return n.flags[e]=t.sent,t.abrupt("return",n.flags[e]);case 6:case"end":return t.stop()}}),r)})))()}},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(t instanceof Promise)throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var e,t,n=(e=this.global.location.search,t={},e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return d(t,r[0],r[1]),r.join("=")})),t);if(l in n){var r=this;n.tfjsflags.split(",").forEach((function(e){var t=u.default(e.split(":"),2),n=t[0],a=t[1];r.urlFlags[n]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(n,a)}))}}}}]),e}();function d(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function p(){return h}var h=null;function v(e){h=e}})),s.register("l2YeR",(function(e,t){n(e.exports,"getGlobalNamespace",(function(){return o})),n(e.exports,"getGlobal",(function(){return u}));var a,i=s("dJYM3");
/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o(){if(null==a){var e;if("undefined"!=typeof window)e=window;else if(void 0!==r)e=r;else if(void 0!==i)e=i;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}a=e}return a}function u(e,t){var n,r=(null==(n=o())._tfGlobals&&(n._tfGlobals=new Map),n._tfGlobals);if(r.has(e))return r.get(e);var a=t();return r.set(e,a),r.get(e)}})),s.register("dJYM3",(function(e,t){var n,r,a=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,c=[],l=!1,f=-1;function d(){l&&s&&(l=!1,s.length?c=s.concat(c):f=-1,c.length&&p())}function p(){if(!l){var e=u(d);l=!0;for(var t=c.length;t;){for(s=c,c=[];++f<t;)s&&s[f].run();f=-1,t=c.length}s=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function v(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||u(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=v,a.addListener=v,a.once=v,a.off=v,a.removeListener=v,a.removeAllListeners=v,a.emit=v,a.prependListener=v,a.prependOnceListener=v,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}})),s.register("cvMH2",(function(e,t){n(e.exports,"Abs",(function(){return r})),n(e.exports,"Acos",(function(){return a})),n(e.exports,"Acosh",(function(){return i})),n(e.exports,"Add",(function(){return o})),n(e.exports,"AddN",(function(){return u})),n(e.exports,"All",(function(){return s})),n(e.exports,"Any",(function(){return c})),n(e.exports,"ArgMax",(function(){return l})),n(e.exports,"ArgMin",(function(){return f})),n(e.exports,"Asin",(function(){return d})),n(e.exports,"Asinh",(function(){return p})),n(e.exports,"Atan",(function(){return h})),n(e.exports,"Atanh",(function(){return v})),n(e.exports,"Atan2",(function(){return g})),n(e.exports,"AvgPool",(function(){return m})),n(e.exports,"AvgPoolBackprop",(function(){return y})),n(e.exports,"AvgPool3D",(function(){return x})),n(e.exports,"AvgPool3DBackprop",(function(){return b})),n(e.exports,"BatchMatMul",(function(){return k})),n(e.exports,"BatchToSpaceND",(function(){return w})),n(e.exports,"BroadcastTo",(function(){return A})),n(e.exports,"Cast",(function(){return E})),n(e.exports,"Ceil",(function(){return C})),n(e.exports,"ClipByValue",(function(){return S})),n(e.exports,"Complex",(function(){return N})),n(e.exports,"Concat",(function(){return T})),n(e.exports,"Conv2D",(function(){return D})),n(e.exports,"Conv2DBackpropFilter",(function(){return F})),n(e.exports,"Conv2DBackpropInput",(function(){return O})),n(e.exports,"Conv3D",(function(){return _})),n(e.exports,"Conv3DBackpropFilterV2",(function(){return I})),n(e.exports,"Conv3DBackpropInputV2",(function(){return R})),n(e.exports,"Cos",(function(){return M})),n(e.exports,"Cosh",(function(){return B})),n(e.exports,"Cumsum",(function(){return P})),n(e.exports,"CropAndResize",(function(){return L})),n(e.exports,"DepthToSpace",(function(){return j})),n(e.exports,"DepthwiseConv2dNative",(function(){return z})),n(e.exports,"DepthwiseConv2dNativeBackpropFilter",(function(){return U})),n(e.exports,"DepthwiseConv2dNativeBackpropInput",(function(){return V})),n(e.exports,"Diag",(function(){return W})),n(e.exports,"Dilation2D",(function(){return G})),n(e.exports,"Dilation2DBackpropInput",(function(){return H})),n(e.exports,"Dilation2DBackpropFilter",(function(){return q})),n(e.exports,"Div",(function(){return J})),n(e.exports,"Elu",(function(){return K})),n(e.exports,"EluGrad",(function(){return X})),n(e.exports,"Erf",(function(){return Y})),n(e.exports,"Equal",(function(){return Q})),n(e.exports,"Exp",(function(){return Z})),n(e.exports,"Expm1",(function(){return $})),n(e.exports,"FFT",(function(){return ee})),n(e.exports,"Fill",(function(){return te})),n(e.exports,"FlipLeftRight",(function(){return ne})),n(e.exports,"Floor",(function(){return re})),n(e.exports,"FloorDiv",(function(){return ae})),n(e.exports,"FusedBatchNorm",(function(){return ie})),n(e.exports,"GatherV2",(function(){return oe})),n(e.exports,"GatherNd",(function(){return ue})),n(e.exports,"Greater",(function(){return se})),n(e.exports,"GreaterEqual",(function(){return ce})),n(e.exports,"Identity",(function(){return le})),n(e.exports,"IFFT",(function(){return fe})),n(e.exports,"Imag",(function(){return de})),n(e.exports,"IsFinite",(function(){return pe})),n(e.exports,"IsInf",(function(){return he})),n(e.exports,"IsNan",(function(){return ve})),n(e.exports,"Less",(function(){return ge})),n(e.exports,"LessEqual",(function(){return me})),n(e.exports,"LinSpace",(function(){return ye})),n(e.exports,"Log",(function(){return xe})),n(e.exports,"Log1p",(function(){return be})),n(e.exports,"LogicalAnd",(function(){return ke})),n(e.exports,"LogicalNot",(function(){return we})),n(e.exports,"LogicalOr",(function(){return Ae})),n(e.exports,"LogSoftmax",(function(){return Ee})),n(e.exports,"LRN",(function(){return Ce})),n(e.exports,"LRNBackprop",(function(){return Se})),n(e.exports,"Max",(function(){return Ne})),n(e.exports,"Maximum",(function(){return Te})),n(e.exports,"MaxPool",(function(){return De})),n(e.exports,"MaxPoolBackprop",(function(){return Fe})),n(e.exports,"MaxPool3D",(function(){return Oe})),n(e.exports,"MaxPool3DBackprop",(function(){return _e})),n(e.exports,"MaxPoolWithArgmax",(function(){return Ie})),n(e.exports,"Mean",(function(){return Re})),n(e.exports,"Min",(function(){return Me})),n(e.exports,"Minimum",(function(){return Be})),n(e.exports,"Mod",(function(){return Pe})),n(e.exports,"Multiply",(function(){return Le})),n(e.exports,"Negate",(function(){return je})),n(e.exports,"NotEqual",(function(){return ze})),n(e.exports,"NonMaxSuppressionV3",(function(){return Ue})),n(e.exports,"NonMaxSuppressionV4",(function(){return Ve})),n(e.exports,"NonMaxSuppressionV5",(function(){return We})),n(e.exports,"OnesLike",(function(){return Ge})),n(e.exports,"OneHot",(function(){return He})),n(e.exports,"PadV2",(function(){return qe})),n(e.exports,"Pool",(function(){return Je})),n(e.exports,"Pow",(function(){return Ke})),n(e.exports,"Prelu",(function(){return Xe})),n(e.exports,"Prod",(function(){return Ye})),n(e.exports,"Range",(function(){return Qe})),n(e.exports,"Real",(function(){return Ze})),n(e.exports,"Reciprocal",(function(){return $e})),n(e.exports,"Relu",(function(){return et})),n(e.exports,"Reshape",(function(){return tt})),n(e.exports,"ResizeNearestNeighbor",(function(){return nt})),n(e.exports,"ResizeNearestNeighborGrad",(function(){return rt})),n(e.exports,"ResizeBilinear",(function(){return at})),n(e.exports,"ResizeBilinearGrad",(function(){return it})),n(e.exports,"Relu6",(function(){return ot})),n(e.exports,"Reverse",(function(){return ut})),n(e.exports,"Round",(function(){return st})),n(e.exports,"Rsqrt",(function(){return ct})),n(e.exports,"ScatterNd",(function(){return lt})),n(e.exports,"SelectV2",(function(){return ft})),n(e.exports,"Selu",(function(){return dt})),n(e.exports,"Slice",(function(){return pt})),n(e.exports,"Sin",(function(){return ht})),n(e.exports,"Sinh",(function(){return vt})),n(e.exports,"Sign",(function(){return gt})),n(e.exports,"Sigmoid",(function(){return mt})),n(e.exports,"Softplus",(function(){return yt})),n(e.exports,"Sqrt",(function(){return xt})),n(e.exports,"Sum",(function(){return bt})),n(e.exports,"SpaceToBatchND",(function(){return kt})),n(e.exports,"SplitV",(function(){return wt})),n(e.exports,"Softmax",(function(){return At})),n(e.exports,"SquaredDifference",(function(){return Et})),n(e.exports,"Square",(function(){return Ct})),n(e.exports,"Sub",(function(){return St})),n(e.exports,"SparseToDense",(function(){return Nt})),n(e.exports,"StridedSlice",(function(){return Tt})),n(e.exports,"Tan",(function(){return Dt})),n(e.exports,"Tanh",(function(){return Ft})),n(e.exports,"Tile",(function(){return Ot})),n(e.exports,"TopK",(function(){return _t})),n(e.exports,"Transpose",(function(){return It})),n(e.exports,"Unpack",(function(){return Rt})),n(e.exports,"UnsortedSegmentSum",(function(){return Mt})),n(e.exports,"ZerosLike",(function(){return Bt})),n(e.exports,"Step",(function(){return Pt})),n(e.exports,"FromPixels",(function(){return Lt})),n(e.exports,"RotateWithOffset",(function(){return jt})),n(e.exports,"_FusedMatMul",(function(){return zt})),n(e.exports,"FusedConv2D",(function(){return Ut})),n(e.exports,"FusedDepthwiseConv2D",(function(){return Vt}));var r="Abs",a="Acos",i="Acosh",o="Add",u="AddN",s="All",c="Any",l="ArgMax",f="ArgMin",d="Asin",p="Asinh",h="Atan",v="Atanh",g="Atan2",m="AvgPool",y="AvgPoolBackprop",x="AvgPool3D",b="AvgPool3DBackprop",k="BatchMatMul",w="BatchToSpaceND",A="BroadcastTo",E="Cast",C="Ceil",S="ClipByValue",N="Complex",T="Concat",D="Conv2D",F="Conv2DBackpropFilter",O="Conv2DBackpropInput",_="Conv3D",I="Conv3DBackpropFilterV2",R="Conv3DBackpropInputV2",M="Cos",B="Cosh",P="Cumsum",L="CropAndResize",j="DepthToSpace",z="DepthwiseConv2dNative",U="DepthwiseConv2dNativeBackpropFilter",V="DepthwiseConv2dNativeBackpropInput",W="Diag",G="Dilation2D",H="Dilation2DBackpropInput",q="Dilation2DBackpropFilter",J="Div",K="Elu",X="EluGrad",Y="Erf",Q="Equal",Z="Exp",$="Expm1",ee="FFT",te="Fill",ne="FlipLeftRight",re="Floor",ae="FloorDiv",ie="FusedBatchNorm",oe="GatherV2",ue="GatherNd",se="Greater",ce="GreaterEqual",le="Identity",fe="IFFT",de="Imag",pe="IsFinite",he="IsInf",ve="IsNan",ge="Less",me="LessEqual",ye="LinSpace",xe="Log",be="Log1p",ke="LogicalAnd",we="LogicalNot",Ae="LogicalOr",Ee="LogSoftmax",Ce="LRN",Se="LRNBackprop",Ne="Max",Te="Maximum",De="MaxPool",Fe="MaxPoolBackprop",Oe="MaxPool3D",_e="MaxPool3DBackprop",Ie="MaxPoolWithArgmax",Re="Mean",Me="Min",Be="Minimum",Pe="Mod",Le="Multiply",je="Negate",ze="NotEqual",Ue="NonMaxSuppressionV3",Ve="NonMaxSuppressionV4",We="NonMaxSuppressionV5",Ge="OnesLike",He="OneHot",qe="PadV2",Je="Pool",Ke="Pow",Xe="Prelu",Ye="Prod",Qe="Range",Ze="Real",$e="Reciprocal",et="Relu",tt="Reshape",nt="ResizeNearestNeighbor",rt="ResizeNearestNeighborGrad",at="ResizeBilinear",it="ResizeBilinearGrad",ot="Relu6",ut="Reverse",st="Round",ct="Rsqrt",lt="ScatterNd",ft="SelectV2",dt="Selu",pt="Slice",ht="Sin",vt="Sinh",gt="Sign",mt="Sigmoid",yt="Softplus",xt="Sqrt",bt="Sum",kt="SpaceToBatchND",wt="SplitV",At="Softmax",Et="SquaredDifference",Ct="Square",St="Sub",Nt="SparseToDense",Tt="StridedSlice",Dt="Tan",Ft="Tanh",Ot="Tile",_t="TopK",It="Transpose",Rt="Unpack",Mt="UnsortedSegmentSum",Bt="ZerosLike",Pt="Step",Lt="FromPixels",jt="RotateWithOffset",zt="_FusedMatMul",Ut="FusedConv2D",Vt="FusedDepthwiseConv2D"})),s.register("d4BUr",(function(e,t){n(e.exports,"getKernel",(function(){return c})),n(e.exports,"getGradient",(function(){return l})),n(e.exports,"getKernelsForBackend",(function(){return f})),n(e.exports,"registerKernel",(function(){return d})),n(e.exports,"registerGradient",(function(){return p})),n(e.exports,"unregisterKernel",(function(){return h})),n(e.exports,"unregisterGradient",(function(){return v})),s("1i51P");var r=s("6vecG"),a=s("lU3MY"),i=s("l2YeR"),o=i.getGlobal("kernelRegistry",(function(){return new Map})),u=i.getGlobal("gradRegistry",(function(){return new Map}));function c(e,t){var n=g(e,t);return o.get(n)}function l(e){return u.get(e)}function f(e){for(var t=o.entries(),n=[];;){var a=t.next(),i=a.done,u=a.value;if(i)break;var s=r.default(u,2),c=s[0],l=s[1];r.default(c.split("_"),1)[0]===e&&n.push(l)}return n}function d(e){var t=e.kernelName,n=e.backendName,r=g(t,n);o.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),o.set(r,e)}function p(e){var t=e.kernelName;u.has(t)&&a.env().getBool("DEBUG")&&console.warn("Overriding the gradient for '".concat(t,"'")),u.set(t,e)}function h(e,t){var n=g(e,t);if(!o.has(n))throw new Error("The kernel '".concat(e,"' for backend ")+"'".concat(t,"' is not registered"));o.delete(n)}function v(e){if(!u.has(e))throw new Error("The gradient '".concat(e,"' for backend is not registered"));u.delete(e)}function g(e,t){return"".concat(t,"_").concat(e)}})),s.register("6dVUb",(function(e,t){n(e.exports,"Profiler",(function(){return o})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("kglvN"),o=function(){"use strict";function e(t,n){r.default(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new u)}return a.default(e,[{key:"profileKernel",value:function(e,t,n){for(var r,a=function(t){var n=r[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},i=this.backendTimer.time((function(){r=n()})),o=0;o<r.length;o++)a(o);return{kernelName:e,outputs:r,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){var r=t;Promise.all([e.data(),a,o]).then((function(t){r.logger.logKernelProfile(n,e,t[0],t[1],i,t[2])}))}))}}]),e}();var u=function(){"use strict";function e(){r.default(this,e)}return a.default(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,o){var u="number"==typeof r?i.rightPad("".concat(r,"ms"),9):r.error,s=i.rightPad(e,25),c=t.rank,l=t.size,f=i.rightPad(t.shape.toString(),14),d="";for(var p in a){var h=a[p];if(null!=h){var v=h.shape||t.shape,g=v.length;d+="".concat(p,": ").concat(g,"D ").concat(g>0?v:""," ")}}console.log("%c".concat(s,"\t%c").concat(u,"\t%c").concat(c,"D ").concat(f,"\t%c").concat(l,"\t%c").concat(d,"\t%c").concat(o),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}()})),s.register("kglvN",(function(e,t){n(e.exports,"shuffle",(function(){return a})),n(e.exports,"clamp",(function(){return i})),n(e.exports,"nearestLargerEven",(function(){return o})),n(e.exports,"sum",(function(){return u})),n(e.exports,"randUniform",(function(){return c})),n(e.exports,"distSquared",(function(){return l})),n(e.exports,"assert",(function(){return f})),n(e.exports,"assertShapesMatch",(function(){return d})),n(e.exports,"arraysEqual",(function(){return m})),n(e.exports,"assertNonNull",(function(){return p})),n(e.exports,"flatten",(function(){return h})),n(e.exports,"isTypedArray",(function(){return _})),n(e.exports,"sizeFromShape",(function(){return v})),n(e.exports,"isScalarShape",(function(){return g})),n(e.exports,"isInt",(function(){return y})),n(e.exports,"tanh",(function(){return x})),n(e.exports,"sizeToSquarishShape",(function(){return b})),n(e.exports,"createShuffledIndices",(function(){return k})),n(e.exports,"rightPad",(function(){return w})),n(e.exports,"repeatedTry",(function(){return A})),n(e.exports,"inferFromImplicitShape",(function(){return E})),n(e.exports,"parseAxisParam",(function(){return C})),n(e.exports,"squeezeShape",(function(){return S})),n(e.exports,"getTypedArrayFromDType",(function(){return N})),n(e.exports,"getArrayFromDType",(function(){return T})),n(e.exports,"checkConversionForErrors",(function(){return D})),n(e.exports,"isValidDtype",(function(){return F})),n(e.exports,"hasEncodingLoss",(function(){return O})),n(e.exports,"bytesPerElement",(function(){return I})),n(e.exports,"bytesFromStringArray",(function(){return R})),n(e.exports,"isString",(function(){return M})),n(e.exports,"isBoolean",(function(){return B})),n(e.exports,"isNumber",(function(){return P})),n(e.exports,"inferDtype",(function(){return L})),n(e.exports,"isFunction",(function(){return j})),n(e.exports,"nearestDivisor",(function(){return z})),n(e.exports,"computeStrides",(function(){return U})),n(e.exports,"toTypedArray",(function(){return V})),n(e.exports,"toNestedArray",(function(){return G})),n(e.exports,"makeOnesTypedArray",(function(){return H})),n(e.exports,"makeZerosTypedArray",(function(){return q})),n(e.exports,"makeZerosNestedTypedArray",(function(){return J})),n(e.exports,"now",(function(){return K})),n(e.exports,"assertNonNegativeIntegerDimensions",(function(){return X})),n(e.exports,"fetch",(function(){return Y})),n(e.exports,"encodeString",(function(){return Q})),n(e.exports,"decodeString",(function(){return Z})),n(e.exports,"locToIndex",(function(){return $})),n(e.exports,"indexToLoc",(function(){return ee}));var r=s("lU3MY");function a(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function i(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2==0?e:e+1}function u(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function c(e,t){var n=Math.random();return t*n+(1-n)*e}function l(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function f(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";f(m(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function p(e){f(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||_(e)&&!n)for(var r=0;r<e.length;++r)h(e[r],t,n);else t.push(e);return t}function v(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function g(e){return 0===e.length}function m(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function y(e){return e%1==0}function x(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function b(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function k(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return a(t),t}function w(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0,o=function(){if(e())r();else{i++;var u=t(i);null!=n&&i>=n?a():setTimeout(o,u)}};o()}))}function E(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function C(e,t){var n=t.length;return f((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),f(e.every((function(e){return y(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function S(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:C(t,e).sort(),o=0,u=0;u<e.length;++u){if(null!=i){if(i[o]===u&&1!==e[u])throw new Error("Can't squeeze axis ".concat(u," since its dim '").concat(e[u],"' is not 1"));(null==i[o]||i[o]>u)&&1===e[u]&&(n.push(e[u]),r.push(u)),i[o]<=u&&o++}1!==e[u]&&(n.push(e[u]),r.push(u))}return{newShape:n,keptDims:r}}function N(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function T(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function D(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function F(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function O(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function _(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function I(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function R(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function M(e){return"string"==typeof e||e instanceof String}function B(e){return"boolean"==typeof e}function P(e){return"number"==typeof e}function L(e){return Array.isArray(e)?L(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":P(e)?"float32":M(e)?"string":B(e)?"bool":"float32"}function j(e){return!!(e&&e.constructor&&e.call&&e.apply)}function z(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function U(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function V(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=h(e)),r.env().getBool("DEBUG")&&D(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),a=0;a<n.length;++a)0!==Math.round(e[a])&&(n[a]=1);return n}throw new Error("Unknown data type ".concat(t))}function W(e,t,n){var r=new Array;if(1===t.length)for(var a=t[0],i=0;i<a;i++)r[i]=n[e+i];else for(var o=t[0],u=t.slice(1),s=u.reduce((function(e,t){return e*t})),c=0;c<o;c++)r[c]=W(e+c*s,u,n);return r}function G(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length,"."));return W(0,e,t)}function H(e,t){for(var n=q(e,t),r=0;r<n.length;r++)n[r]=1;return n}function q(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function J(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return G(e,new Float32Array(n));if("int32"===t)return G(e,new Int32Array(n));if("bool"===t)return G(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function K(){return r.env().platform.now()}function X(e){e.forEach((function(t){f(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function Y(e,t){return r.env().platform.fetch(e,t)}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",r.env().platform.encode(e,t)}function Z(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",r.env().platform.decode(e,t)}function $(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function ee(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}})),s.register("790q1",(function(e,t){n(e.exports,"getFilteredNodesXToY",(function(){return a})),n(e.exports,"backpropagateGradients",(function(){return i}));var r=s("kglvN");function a(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var u=e[o],s=u.inputs;for(var c in s){for(var l=s[c],f=!1,d=0;d<t.length;d++)if(r[l.id]){u.outputs.forEach((function(e){return r[e.id]=!0})),f=!0,a[u.id]=!0;break}if(f)break}}var p={};p[n.id]=!0;for(var h={},v=e.length-1;v>=0;v--)for(var g=e[v],m=g.inputs,y=0;y<g.outputs.length;y++)if(p[g.outputs[y].id]){for(var x in m)p[m[x].id]=!0,h[g.id]=!0;break}for(var b=[],k=0;k<e.length;k++){var w=e[k];if(a[w.id]&&h[w.id]){var A={};for(var E in w.inputs){var C=w.inputs[E];r[C.id]&&(A[E]=C)}var S=Object.assign({},w);S.inputs=A,S.outputs=w.outputs,b.push(S)}}return b}function i(e,t,n,a){for(var i=function(i){var o=function(t){if(!(t in c))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(c),"."));var i=n((function(){return c[t]()}));if("float32"!==i.dtype)throw new Error("Error in gradient for op ".concat(u.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(i.dtype,"'"));var o=u.inputs[t];if(!r.arraysEqual(i.shape,o.shape))throw new Error("Error in gradient for op ".concat(u.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(i.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=i;else{var s=e[o.id];e[o.id]=a(s,i),s.dispose()}},u=t[i],s=[];if(u.outputs.forEach((function(t){var n=e[t.id];null!=n?s.push(n):s.push(null)})),null==u.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(u.kernelName,"."));var c=u.gradient(s);for(var l in u.inputs)o(l)},o=t.length-1;o>=0;o--)i(o)}})),s.register("4JvjV",(function(e,r){n(e.exports,"TensorBuffer",(function(){return p})),n(e.exports,"setTensorTracker",(function(){return g})),n(e.exports,"setOpHandler",(function(){return m})),n(e.exports,"setDeprecationWarningFn",(function(){return y})),n(e.exports,"Tensor",(function(){return x})),n(e.exports,"Variable",(function(){return b})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("2vsUb"),c=s("d6iiX"),l=s("40Zzs"),f=s("hbKww"),d=s("kglvN"),p=(d=s("kglvN"),function(){"use strict";function e(t,n,r){if(a.default(this,e),this.dtype=n,this.shape=t.slice(),this.size=d.sizeFromShape(t),null!=r){var i=this,o=r.length;d.assert(o===this.size,(function(){return"Length of values '".concat(o,"' does not match the size ")+"inferred by the shape '".concat(i.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||d.getArrayFromDType(n,this.size),this.strides=d.computeStrides(t)}return i.default(e,[{key:"set",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=this;0===n.length&&(n=[0]),d.assert(n.length===this.rank,(function(){return"The number of provided coordinates (".concat(n.length,") must ")+"match the rank (".concat(a.rank,")")}));var i=this.locToIndex(n);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);var r=0,a=!0,i=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;if(c<0||c>=this.shape[r]){var l="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(l)}r++}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}for(var f=t[t.length-1],d=0;d<t.length-1;++d)f+=this.strides[d]*t[d];return this.values[f]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return h().makeTensor(this.values,this.shape,this.dtype)}}]),e}()),h=null,v=null;function g(e){h=e}function m(e){v=e}function y(e){e}var x=function(){"use strict";function e(t,n,r,i){a.default(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=d.sizeFromShape(t),this.strides=d.computeStrides(t),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}return i.default(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=this;return o.default(t(l).mark((function n(){var r;return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.data();case 2:return r=t.sent,t.abrupt("return",v.buffer(e.shape,e.dtype,r));case 4:case"end":return t.stop()}}),n)})))()}},{key:"bufferSync",value:function(){return v.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=this;return o.default(t(l).mark((function n(){var r;return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.data();case 2:return r=t.sent,t.abrupt("return",d.toNestedArray(e.shape,r));case 4:case"end":return t.stop()}}),n)})))()}},{key:"arraySync",value:function(){return d.toNestedArray(this.shape,this.dataSync())}},{key:"data",value:function(){var e=this;return o.default(t(l).mark((function n(){var r,a;return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.throwIfDisposed(),r=h().read(e.dataId),"string"!==e.dtype){t.next=13;break}return t.next=5,r;case 5:return a=t.sent,t.prev=6,t.abrupt("return",a.map((function(e){return d.decodeString(e)})));case 10:throw t.prev=10,t.t0=t.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return t.abrupt("return",r);case 14:case"end":return t.stop()}}),n,null,[[6,10]])})))()}},{key:"dataSync",value:function(){this.throwIfDisposed();var e=h().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return d.decodeString(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=this;return o.default(t(l).mark((function n(){var r;return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.throwIfDisposed(),t.next=3,h().read(e.dataId);case 3:if(r=t.sent,"string"!==e.dtype){t.next=8;break}return t.abrupt("return",r);case 8:return t.abrupt("return",new Uint8Array(r.buffer));case 9:case"end":return t.stop()}}),n)})))()}},{key:"dispose",value:function(){this.isDisposed||(h().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return v.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),v.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return f.tensorToString(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),v.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),h().makeVariable(this,e,t,n)}}]),e}();Object.defineProperty(x,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}});var b=function(e){"use strict";u.default(n,e);var t=c.default(n);function n(e,r,i,o){var u;return a.default(this,n),(u=t.call(this,e.shape,e.dtype,e.dataId,o)).trainable=r,u.name=i,u}return i.default(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!d.arraysEqual(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));h().disposeTensor(this),this.dataId=e.dataId,h().incRef(this,null)}},{key:"dispose",value:function(){h().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(x);Object.defineProperty(b,Symbol.hasInstance,{value:function(e){return e instanceof x&&null!=e.assign&&e.assign instanceof Function}})})),s.register("hbKww",(function(e,t){n(e.exports,"tensorToString",(function(){return i})),s("1i51P");var r=s("9M1dW"),a=s("kglvN");function i(e,t,n,r){var i=a.computeStrides(t),u=function(e,t,n,r){var i=a.sizeFromShape(t),u=r[r.length-1],s=new Array(u).fill(0),c=t.length,f="complex64"===n?l(e):e;if(c>1)for(var d=0;d<i/u;d++)for(var p=d*u,h=0;h<u;h++)s[h]=Math.max(s[h],o(f[p+h],0,n).length);return s}(e,t,n,i),s=t.length,f=c(e,t,n,i,u),d=["Tensor"];return r&&(d.push("  dtype: ".concat(n)),d.push("  rank: ".concat(s)),d.push("  shape: [".concat(t,"]")),d.push("  values:")),d.push(f.map((function(e){return"    "+e})).join("\n")),d.join("\n")}function o(e,t,n){var r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):a.isString(e)?"'".concat(e,"'"):"bool"===n?u(e):parseFloat(e.toFixed(7)).toString(),a.rightPad(r,t)}function u(e){return 0===e?"false":"true"}function c(e,t,n,a,i){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],f="complex64"===n?2:1,d=t[0],p=t.length;if(0===p){if("complex64"===n){var h=l(e);return[o(h[0],0,n)]}return"bool"===n?[u(e[0])]:[e[0].toString()]}if(1===p){if(d>20){var v=3*f,g=Array.from(e.slice(0,v)),m=Array.from(e.slice((d-3)*f,d*f));return"complex64"===n&&(g=l(g),m=l(m)),["["+g.map((function(e,t){return o(e,i[t],n)})).join(", ")+", ..., "+m.map((function(e,t){return o(e,i[d-3+t],n)})).join(", ")+"]"]}var y="complex64"===n?l(e):Array.from(e);return["["+y.map((function(e,t){return o(e,i[t],n)})).join(", ")+"]"]}var x=t.slice(1),b=a.slice(1),k=a[0]*f,w=[];if(d>20){for(var A=0;A<3;A++){var E,C=A*k,S=C+k;(E=w).push.apply(E,r.default(c(e.slice(C,S),x,n,b,i,!1)))}w.push("...");for(var N=d-3;N<d;N++){var T,D=N*k,F=D+k;(T=w).push.apply(T,r.default(c(e.slice(D,F),x,n,b,i,N===d-1)))}}else for(var O=0;O<d;O++){var _,I=O*k,R=I+k;(_=w).push.apply(_,r.default(c(e.slice(I,R),x,n,b,i,O===d-1)))}var M=2===p?",":"";w[0]="["+w[0]+M;for(var B=1;B<w.length-1;B++)w[B]=" "+w[B]+M;for(var P=",\n",L=2;L<p;L++)P+="\n";return w[w.length-1]=" "+w[w.length-1]+"]"+(s?"":P),w}function l(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}})),s.register("gIxdA",(function(e,t){n(e.exports,"makeTypesMatch",(function(){return o})),n(e.exports,"assertTypesMatch",(function(){return u})),n(e.exports,"isTensorInList",(function(){return c})),n(e.exports,"getTensorsInContainer",(function(){return l}));var r=s("4JvjV"),a=s("aTTkI"),i=s("kglvN");function o(e,t){if(e.dtype===t.dtype)return[e,t];var n=a.upcastType(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function u(e,t){i.assert(e.dtype===t.dtype,(function(){return"The dtypes of the first(".concat(e.dtype,") and")+" second(".concat(t.dtype,") input must match")}))}function c(e,t){return t.some((function(t){return t.id===e.id}))}function l(e){var t=[];return f(e,t,new Set),t}function f(e,t,n){if(null!=e)if(e instanceof r.Tensor)t.push(e);else if(a=e,Array.isArray(a)||"object"==typeof a){var a,i=e;for(var o in i){var u=i[o];n.has(u)||(n.add(u),f(u,t,n))}}}})),s.register("aTTkI",(function(e,t){var r,a,i,o,u,s,c,l,f;n(e.exports,"Rank",(function(){return r})),n(e.exports,"upcastType",(function(){return p})),n(e.exports,"sumOutType",(function(){return h})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),(i=a||(a={})).float32="float32",i.int32="int32",i.bool="int32",i.complex64="complex64",(u=o||(o={})).float32="float32",u.int32="int32",u.bool="bool",u.complex64="complex64",(c=s||(s={})).float32="float32",c.int32="float32",c.bool="float32",c.complex64="complex64",(f=l||(l={})).float32="complex64",f.int32="complex64",f.bool="complex64",f.complex64="complex64";var d={float32:s,int32:a,bool:o,complex64:l};function p(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return d[e][t]}function h(e){return p(e,"int32")}})),s.register("hbYT1",(function(e,t){var n=s("iUbQh"),r=s("lU3MY"),a=s("dJYM3"),i=r.env();i.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),i.registerFlag("IS_BROWSER",(function(){return n.isBrowser()})),i.registerFlag("IS_NODE",(function(){return void 0!==a&&void 0!==a.versions&&void 0!==a.versions.node})),i.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),i.registerFlag("PROD",(function(){return!1})),i.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return i.getBool("DEBUG")})),i.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),i.registerFlag("IS_TEST",(function(){return!1}))})),s.register("iUbQh",(function(e,t){function r(){if("undefined"!=typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function a(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}n(e.exports,"isMobile",(function(){return r})),n(e.exports,"isBrowser",(function(){return a}))})),s.register("kZayt",(function(e,t){s("1i51P");var n=s("3QOYJ"),r=s("2tuUj");s("hbYT1");var a=s("lU3MY"),i=s("gd2tB"),o=s("2H47L"),u=s("lmNUn"),c=function(){"use strict";function e(){n.default(this,e)}return r.default(e,[{key:"fetch",value:function(e,t){return fetch(e,t)}},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(a.env().get("IS_BROWSER")){a.env().setPlatform("browser",new c);try{u.ModelStoreManagerRegistry.registerManager(o.BrowserLocalStorage.URL_SCHEME,new o.BrowserLocalStorageManager)}catch(e){}try{u.ModelStoreManagerRegistry.registerManager(i.BrowserIndexedDB.URL_SCHEME,new i.BrowserIndexedDBManager)}catch(e){}}})),s.register("gd2tB",(function(e,r){n(e.exports,"BrowserIndexedDB",(function(){return m})),n(e.exports,"BrowserIndexedDBManager",(function(){return x})),s("1i51P");var a=s("e3nFV"),i=s("3QOYJ"),o=s("2tuUj"),u=s("40Zzs");s("hbYT1");var c=s("lU3MY"),l=s("69QQV"),f=s("5nSEP"),d="tensorflowjs",p="models_store",h="model_info_store";function v(){if(!c.env().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"==typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function g(e){var t=e.result;t.createObjectStore(p,{keyPath:"modelPath"}),t.createObjectStore(h,{keyPath:"modelPath"})}var m=function(){"use strict";function e(t){if(i.default(this,e),this.indexedDB=v(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return o.default(e,[{key:"save",value:function(e){var n=this;return a.default(t(u).mark((function r(){return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return t.abrupt("return",n.databaseAction(n.modelPath,e));case 3:case"end":return t.stop()}}),r)})))()}},{key:"load",value:function(){var e=this;return a.default(t(u).mark((function n(){return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.databaseAction(e.modelPath));case 1:case"end":return t.stop()}}),n)})))()}},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n,i=n.indexedDB.open(d,1);i.onupgradeneeded=function(){return g(i)},i.onsuccess=function(){var n=i.result;if(null==t){var o=a,u=n.transaction(p,"readonly"),s=u.objectStore(p).get(a.modelPath);s.onsuccess=function(){if(null==s.result)return n.close(),r(new Error("Cannot find model with path '".concat(o.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return n.close(),r(s.error)},u.oncomplete=function(){return n.close()}}else{var c,f=a,d=l.getModelArtifactsInfoForJSON(t),v=n.transaction(h,"readwrite"),g=v.objectStore(h),m=g.put({modelPath:a.modelPath,modelArtifactsInfo:d});m.onsuccess=function(){var a=f,i=(c=n.transaction(p,"readwrite")).objectStore(p).put({modelPath:f.modelPath,modelArtifacts:t,modelArtifactsInfo:d});i.onsuccess=function(){return e({modelArtifactsInfo:d})},i.onerror=function(e){var t=(g=v.objectStore(h)).delete(a.modelPath);t.onsuccess=function(){return n.close(),r(i.error)},t.onerror=function(e){return n.close(),r(i.error)}}},m.onerror=function(e){return n.close(),r(m.error)},v.oncomplete=function(){null==c?n.close():c.oncomplete=function(){return n.close()}}}},i.onerror=function(e){return r(i.error)}}))}}]),e}();m.URL_SCHEME="indexeddb://";var y=function(e){return c.env().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(m.URL_SCHEME)?(t=e.slice(m.URL_SCHEME.length),new m(t)):null;var t};f.IORouterRegistry.registerSaveRouter(y),f.IORouterRegistry.registerLoadRouter(y);var x=function(){"use strict";function e(){i.default(this,e),this.indexedDB=v()}return o.default(e,[{key:"listModels",value:function(){var e=this;return a.default(t(u).mark((function n(){return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){var r=e.indexedDB.open(d,1);r.onupgradeneeded=function(){return g(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(h,"readonly"),i=a.objectStore(h).getAll();i.onsuccess=function(){var e={},n=!0,r=!1,a=void 0;try{for(var o,u=i.result[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;e[s.modelPath]=s.modelArtifactsInfo}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}t(e)},i.onerror=function(t){return e.close(),n(i.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return t.stop()}}),n)})))()}},{key:"removeModel",value:function(e){var n=this;return a.default(t(u).mark((function r(){return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=(r=e).startsWith(m.URL_SCHEME)?r.slice(m.URL_SCHEME.length):r,t.abrupt("return",new Promise((function(t,r){var a=n.indexedDB.open(d,1);a.onupgradeneeded=function(){return g(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(h,"readwrite"),u=o.objectStore(h),s=u.get(e);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(e,"' ")+"in IndexedDB."));var a=u.delete(e),o=function(){var a=(n=i.transaction(p,"readwrite")).objectStore(p).delete(e);a.onsuccess=function(){return t(s.result.modelArtifactsInfo)},a.onerror=function(e){return r(s.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(s.error)}},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return t.stop()}var r}),r)})))()}}]),e}()})),s.register("69QQV",(function(e,r){n(e.exports,"encodeWeights",(function(){return d})),n(e.exports,"decodeWeights",(function(){return h})),n(e.exports,"arrayBufferToBase64String",(function(){return y})),n(e.exports,"base64StringToArrayBuffer",(function(){return x})),n(e.exports,"concatenateArrayBuffers",(function(){return b})),n(e.exports,"basename",(function(){return k})),n(e.exports,"getModelArtifactsInfoForJSON",(function(){return w})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("3IcUj"),u=s("616DT"),c=s("kglvN"),l=s("bJQ9Z"),f=s("1mtJC").Buffer;function d(e,t){return p.apply(this,arguments)}function p(){return p=a.default(t(i).mark((function e(n,r){var o,u,s,c,l,f,d,p,h;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[],u=[],s=Array.isArray(n)?n.map((function(e){return e.name})):Object.keys(n),c=0;case 4:if(!(c<s.length)){e.next=16;break}if(l=s[c],"float32"===(f=Array.isArray(n)?n[c].tensor:n[l]).dtype||"int32"===f.dtype||"bool"===f.dtype||"string"===f.dtype||"complex64"===f.dtype){e.next=9;break}throw new Error("Unsupported dtype in weight '".concat(l,"': ").concat(f.dtype));case 9:d={name:l,shape:f.shape,dtype:f.dtype},"string"===f.dtype?(p=new Promise(function(){var e=a.default(t(i).mark((function e(n){var r,a,o,u,s,c,l;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.bytes();case 2:for(r=e.sent,a=r.reduce((function(e,t){return e+t.length}),0)+4*r.length,o=new Uint8Array(a),u=0,s=0;s<r.length;s++)c=r[s],l=new Uint8Array(new Uint32Array([c.length]).buffer),o.set(l,u),u+=4,o.set(c,u),u+=c.length;n(o);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),u.push(p)):u.push(f.data()),null!=r&&(d.group=r),o.push(d);case 13:++c,e.next=4;break;case 16:return e.next=18,Promise.all(u);case 18:return h=e.sent,e.abrupt("return",{data:v(h),specs:o});case 20:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function h(e,t){var n,r={},a=0,i=!0,s=!1,f=void 0;try{for(var d,p=t[Symbol.iterator]();!(i=(d=p.next()).done);i=!0){var h=d.value,v=h.name,g=h.dtype,m=h.shape,y=c.sizeFromShape(m),x=void 0;if("quantization"in h){var b=h.quantization;if("uint8"===b.dtype||"uint16"===b.dtype){if(!("min"in b)||!("scale"in b))throw new Error("Weight ".concat(h.name," with quantization ").concat(b.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==b.dtype)throw new Error("Weight ".concat(h.name," has unknown ")+"quantization dtype ".concat(b.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==g)throw new Error("Weight ".concat(h.name," is quantized with ").concat(b.dtype," ")+"which only supports weights of type float32 not ".concat(g,"."))}var k=l.DTYPE_VALUE_SIZE_MAP[b.dtype],w=e.slice(a,a+y*k),E="uint8"===b.dtype?new Uint8Array(w):new Uint16Array(w);if("float32"===g)if("uint8"===b.dtype||"uint16"===b.dtype){x=new Float32Array(E.length);for(var C=0;C<E.length;C++){var S=E[C];x[C]=S*b.scale+b.min}}else{if("float16"!==b.dtype)throw new Error("Unsupported quantization type ".concat(b.dtype," ")+"for weight type float32.");void 0===n&&(n=A()),x=n(E)}else{if("int32"!==g)throw new Error("Unsupported dtype in weight '".concat(v,"': ").concat(g));if("uint8"!==b.dtype&&"uint16"!==b.dtype)throw new Error("Unsupported quantization type ".concat(b.dtype," ")+"for weight type int32.");x=new Int32Array(E.length);for(var N=0;N<E.length;N++){var T=E[N];x[N]=Math.round(T*b.scale+b.min)}}a+=y*k}else if("string"===g){var D=c.sizeFromShape(h.shape);x=[];for(var F=0;F<D;F++){var O=new Uint32Array(e.slice(a,a+4))[0];a+=4;var _=new Uint8Array(e.slice(a,a+O));x.push(_),a+=O}}else{var I=l.DTYPE_VALUE_SIZE_MAP[g],R=e.slice(a,a+y*I);if("float32"===g)x=new Float32Array(R);else if("int32"===g)x=new Int32Array(R);else if("bool"===g)x=new Uint8Array(R);else{if("complex64"!==g)throw new Error("Unsupported dtype in weight '".concat(v,"': ").concat(g));x=new Float32Array(R);for(var M=new Float32Array(x.length/2),B=new Float32Array(x.length/2),P=0;P<M.length;P++)M[P]=x[2*P],B[P]=x[2*P+1];var L=u.tensor(M,m,"float32"),j=u.tensor(B,m,"float32");r[v]=o.complex(L,j)}a+=y*I}"complex64"!==g&&(r[v]=u.tensor(x,m,g))}}catch(e){s=!0,f=e}finally{try{i||null==p.return||p.return()}finally{if(s)throw f}}return r}function v(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var g=void 0!==f&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function m(e){return g?f.byteLength(e):new Blob([e]).size}function y(e){if(g)return f.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function x(e){if(g){var t=f.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}function b(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function k(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function w(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:m(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:m(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function A(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0==(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var u=r[o],s=e[n[u>>10]+(1023&u)]+t[u>>10];i[o]=s}return new Float32Array(a)}}})),s.register("3IcUj",(function(e,t){n(e.exports,"complex",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({complex_:function(e,t){var n=i.convertToTensor(e,"real","complex"),u=i.convertToTensor(t,"imag","complex");o.assertShapesMatch(n.shape,u.shape,"real and imag shapes, ".concat(n.shape," and ").concat(u.shape,", ")+"must match in call to tf.complex().");var s={real:n,imag:u};return r.ENGINE.runKernelFunc((function(e){return e.complex(n,u)}),s,null,a.Complex)}})})),s.register("lcVC1",(function(e,t){n(e.exports,"inferShape",(function(){return u})),n(e.exports,"convertToTensor",(function(){return f})),n(e.exports,"convertToTensorArray",(function(){return d}));var r=s("1dnDT"),a=s("lU3MY"),i=s("4JvjV"),o=s("kglvN");function u(e,t){var n=e;if(o.isTypedArray(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||o.isTypedArray(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&a.env().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&c(e,r,[]),r}function c(e,t,n){if(n=n||[],Array.isArray(e)||o.isTypedArray(e)){o.assert(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),o.assert(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)c(e[a],r,n.concat(a))}else o.assert(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function l(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}function f(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof i.Tensor)return l(a,e.dtype,t,n),e;var s=o.inferDtype(e);if("string"!==s&&["bool","int32","float32"].indexOf(a)>=0&&(s=a),l(a,s,t,n),null==e||!o.isTypedArray(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var c=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(c,"'"))}var f=u(e,s);o.isTypedArray(e)||Array.isArray(e)||(e=[e]);var d=!0,p="string"!==s?o.toTypedArray(e,s):o.flatten(e,[],d);return r.ENGINE.makeTensor(p,f,s)}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,r){return f(e,"".concat(t,"[").concat(r,"]"),n)}),r)}})),s.register("f1skK",(function(e,t){n(e.exports,"OP_SCOPE_SUFFIX",(function(){return i})),n(e.exports,"op",(function(){return o})),s("1i51P");var r=s("9M1dW"),a=s("1dnDT"),i="__op";function o(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],o=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+=i;var u=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];a.ENGINE.startScope(n);try{var u=o.apply(void 0,r.default(t));return u instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),a.ENGINE.endScope(u),u}catch(e){throw a.ENGINE.endScope(null),e}};return Object.defineProperty(u,"name",{value:n,configurable:!0}),u}})),s.register("616DT",(function(e,t){n(e.exports,"tensor",(function(){return i}));var r=s("lcVC1"),a=s("fTjN4");function i(e,t,n){var i=r.inferShape(e,n);return a.makeTensor(e,t,i,n)}})),s.register("fTjN4",(function(e,t){n(e.exports,"makeTensor",(function(){return i}));var r=s("1dnDT"),a=s("kglvN");function i(e,t,n,i){if(null==i&&(i=a.inferDtype(e)),"complex64"===i)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!a.isTypedArray(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){a.assertNonNegativeIntegerDimensions(t);var o=a.sizeFromShape(t),u=a.sizeFromShape(n);a.assert(o===u,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(o," values but has ").concat(u)}));for(var s=0;s<n.length;++s){var c=n[s],l=s!==n.length-1||c!==a.sizeFromShape(t.slice(s));a.assert(n[s]===t[s]||!l,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return a.isTypedArray(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==i?a.toTypedArray(e,i):a.flatten(e,[],!0),r.ENGINE.makeTensor(e,t,i)}})),s.register("bJQ9Z",(function(e,t){n(e.exports,"DTYPE_VALUE_SIZE_MAP",(function(){return r}));var r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}})),s.register("1mtJC",(function(e,t){n(e.exports,"Buffer",(function(){return r}),(function(e){return r=e})),n(e.exports,"INSPECT_MAX_BYTES",(function(){return a}),(function(e){return a=e})),s("1i51P");var r,a,i=s("5lcaY"),o=s("2vsUb"),u=s("d6iiX"),c=s("3QOYJ"),l=s("jZS3C"),f=s("2tuUj"),d=s("6dQ6P"),p=s("km2p9"),h="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r=m,a=50;var v=2147483647;function g(e){if(e>v)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,m.prototype),t}function m(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return b(e)}return y(e,t,n)}function y(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!m.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|E(e,t),r=g(n),a=r.write(e,t);a!==n&&(r=r.slice(0,a));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ae(e,Uint8Array)){var t=new Uint8Array(e);return w(t.buffer,t.byteOffset,t.byteLength)}return k(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+(void 0===e?"undefined":i.default(e)));if(ae(e,ArrayBuffer)||e&&ae(e.buffer,ArrayBuffer))return w(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(ae(e,SharedArrayBuffer)||e&&ae(e.buffer,SharedArrayBuffer)))return w(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return m.from(r,t,n);var a=function(e){if(m.isBuffer(e)){var t=0|A(e.length),n=g(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||ie(e.length)?g(0):k(e);if("Buffer"===e.type&&Array.isArray(e.data))return k(e.data)}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return m.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+(void 0===e?"undefined":i.default(e)))}function x(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function b(e){return x(e),g(e<0?0:0|A(e))}function k(e){for(var t=e.length<0?0:0|A(e.length),n=g(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function w(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,m.prototype),r}function A(e){if(e>=v)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+v.toString(16)+" bytes");return 0|e}function E(e,t){if(m.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ae(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+(void 0===e?"undefined":i.default(e)));var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return te(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ne(e).length;default:if(a)return r?-1:te(e).length;t=(""+t).toLowerCase(),a=!0}}function C(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return L(this,t,n);case"base64":return R(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return z(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function S(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function N(e,t,n,r,a){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),ie(n=+n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=m.from(t,r)),m.isBuffer(t))return 0===t.length?-1:T(e,t,n,r,a);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):T(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function T(e,t,n,r,a){var i,o=1,u=e.length,s=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,u/=2,s/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var l=-1;for(i=n;i<u;i++)if(c(e,i)===c(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===s)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+s>u&&(n=u-s),i=n;i>=0;i--){for(var f=!0,d=0;d<s;d++)if(c(e,i+d)!==c(t,d)){f=!1;break}if(f)return i}return-1}function D(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i,o=t.length;for(r>o/2&&(r=o/2),i=0;i<r;++i){var u=parseInt(t.substr(2*i,2),16);if(ie(u))return i;e[n+i]=u}return i}function F(e,t,n,r){return re(te(t,e.length-n),e,n,r)}function O(e,t,n,r){return re(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return re(ne(t),e,n,r)}function I(e,t,n,r){return re(function(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,a=n%256,i.push(a),i.push(r);return i}(t,e.length-n),e,n,r)}function R(e,t,n){return 0===t&&n===e.length?d.fromByteArray(e):d.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i=e[a],o=null,u=i>239?4:i>223?3:i>191?2:1;if(a+u<=n){var s=void 0,c=void 0,l=void 0,f=void 0;switch(u){case 1:i<128&&(o=i);break;case 2:128==(192&(s=e[a+1]))&&(f=(31&i)<<6|63&s)>127&&(o=f);break;case 3:s=e[a+1],c=e[a+2],128==(192&s)&&128==(192&c)&&(f=(15&i)<<12|(63&s)<<6|63&c)>2047&&(f<55296||f>57343)&&(o=f);break;case 4:s=e[a+1],c=e[a+2],l=e[a+3],128==(192&s)&&128==(192&c)&&128==(192&l)&&(f=(15&i)<<18|(63&s)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(o=f)}}null===o?(o=65533,u=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),a+=u}return function(e){var t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=B));return n}(r)}m.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),m.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(m.prototype,"parent",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.buffer}}),Object.defineProperty(m.prototype,"offset",{enumerable:!0,get:function(){if(m.isBuffer(this))return this.byteOffset}}),m.poolSize=8192,m.from=function(e,t,n){return y(e,t,n)},Object.setPrototypeOf(m.prototype,Uint8Array.prototype),Object.setPrototypeOf(m,Uint8Array),m.alloc=function(e,t,n){return function(e,t,n){return x(e),e<=0?g(e):void 0!==t?"string"==typeof n?g(e).fill(t,n):g(e).fill(t):g(e)}(e,t,n)},m.allocUnsafe=function(e){return b(e)},m.allocUnsafeSlow=function(e){return b(e)},m.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==m.prototype},m.compare=function(e,t){if(ae(e,Uint8Array)&&(e=m.from(e,e.offset,e.byteLength)),ae(t,Uint8Array)&&(t=m.from(t,t.offset,t.byteLength)),!m.isBuffer(e)||!m.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},m.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},m.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return m.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=m.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(ae(i,Uint8Array))a+i.length>r.length?(m.isBuffer(i)||(i=m.from(i)),i.copy(r,a)):Uint8Array.prototype.set.call(r,i,a);else{if(!m.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,a)}a+=i.length}return r},m.byteLength=E,m.prototype._isBuffer=!0,m.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)S(this,t,t+1);return this},m.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)S(this,t,t+3),S(this,t+1,t+2);return this},m.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)S(this,t,t+7),S(this,t+1,t+6),S(this,t+2,t+5),S(this,t+3,t+4);return this},m.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?M(this,0,e):C.apply(this,arguments)},m.prototype.toLocaleString=m.prototype.toString,m.prototype.equals=function(e){if(!m.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===m.compare(this,e)},m.prototype.inspect=function(){var e="",t=a;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},h&&(m.prototype[h]=m.prototype.inspect),m.prototype.compare=function(e,t,n,r,a){if(ae(e,Uint8Array)&&(e=m.from(e,e.offset,e.byteLength)),!m.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+(void 0===e?"undefined":i.default(e)));if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(a>>>=0)-(r>>>=0),u=(n>>>=0)-(t>>>=0),s=Math.min(o,u),c=this.slice(r,a),l=e.slice(t,n),f=0;f<s;++f)if(c[f]!==l[f]){o=c[f],u=l[f];break}return o<u?-1:u<o?1:0},m.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},m.prototype.indexOf=function(e,t,n){return N(this,e,t,n,!0)},m.prototype.lastIndexOf=function(e,t,n){return N(this,e,t,n,!1)},m.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return D(this,e,t,n);case"utf8":case"utf-8":return F(this,e,t,n);case"ascii":case"latin1":case"binary":return O(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},m.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;function P(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function L(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function j(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=oe[e[i]];return a}function z(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length-1;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function U(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function V(e,t,n,r,a,i){if(!m.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function W(e,t,n,r,a){Q(t,r,a,e,n,7);var i=Number(t&BigInt(4294967295));e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i,i>>=8,e[n++]=i;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function G(e,t,n,r,a){Q(t,r,a,e,n,7);var i=Number(t&BigInt(4294967295));e[n+7]=i,i>>=8,e[n+6]=i,i>>=8,e[n+5]=i,i>>=8,e[n+4]=i;var o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function H(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function q(e,t,n,r,a){return t=+t,n>>>=0,a||H(e,0,n,4),p.write(e,t,n,r,23,4),n+4}function J(e,t,n,r,a){return t=+t,n>>>=0,a||H(e,0,n,8),p.write(e,t,n,r,52,8),n+8}m.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,m.prototype),r},m.prototype.readUintLE=m.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||U(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},m.prototype.readUintBE=m.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||U(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},m.prototype.readUint8=m.prototype.readUInt8=function(e,t){return e>>>=0,t||U(e,1,this.length),this[e]},m.prototype.readUint16LE=m.prototype.readUInt16LE=function(e,t){return e>>>=0,t||U(e,2,this.length),this[e]|this[e+1]<<8},m.prototype.readUint16BE=m.prototype.readUInt16BE=function(e,t){return e>>>=0,t||U(e,2,this.length),this[e]<<8|this[e+1]},m.prototype.readUint32LE=m.prototype.readUInt32LE=function(e,t){return e>>>=0,t||U(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},m.prototype.readUint32BE=m.prototype.readUInt32BE=function(e,t){return e>>>=0,t||U(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},m.prototype.readBigUInt64LE=ue((function(e){Z(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);var r=t+256*this[++e]+65536*this[++e]+this[++e]*Math.pow(2,24),a=this[++e]+256*this[++e]+65536*this[++e]+n*Math.pow(2,24);return BigInt(r)+(BigInt(a)<<BigInt(32))})),m.prototype.readBigUInt64BE=ue((function(e){Z(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);var r=t*Math.pow(2,24)+65536*this[++e]+256*this[++e]+this[++e],a=this[++e]*Math.pow(2,24)+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(a)})),m.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||U(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},m.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||U(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},m.prototype.readInt8=function(e,t){return e>>>=0,t||U(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},m.prototype.readInt16LE=function(e,t){e>>>=0,t||U(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},m.prototype.readInt16BE=function(e,t){e>>>=0,t||U(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},m.prototype.readInt32LE=function(e,t){return e>>>=0,t||U(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},m.prototype.readInt32BE=function(e,t){return e>>>=0,t||U(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},m.prototype.readBigInt64LE=ue((function(e){Z(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);var r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*Math.pow(2,24))})),m.prototype.readBigInt64BE=ue((function(e){Z(e>>>=0,"offset");var t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);var r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+65536*this[++e]+256*this[++e]+n)})),m.prototype.readFloatLE=function(e,t){return e>>>=0,t||U(e,4,this.length),p.read(this,e,!0,23,4)},m.prototype.readFloatBE=function(e,t){return e>>>=0,t||U(e,4,this.length),p.read(this,e,!1,23,4)},m.prototype.readDoubleLE=function(e,t){return e>>>=0,t||U(e,8,this.length),p.read(this,e,!0,52,8)},m.prototype.readDoubleBE=function(e,t){return e>>>=0,t||U(e,8,this.length),p.read(this,e,!1,52,8)},m.prototype.writeUintLE=m.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||V(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},m.prototype.writeUintBE=m.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||V(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},m.prototype.writeUint8=m.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,1,255,0),this[t]=255&e,t+1},m.prototype.writeUint16LE=m.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},m.prototype.writeUint16BE=m.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},m.prototype.writeUint32LE=m.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},m.prototype.writeUint32BE=m.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},m.prototype.writeBigUInt64LE=ue((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return W(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),m.prototype.writeBigUInt64BE=ue((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return G(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),m.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);V(this,e,t,n,a-1,-a)}var i=0,o=1,u=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===u&&0!==this[t+i-1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+n},m.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var a=Math.pow(2,8*n-1);V(this,e,t,n,a-1,-a)}var i=n-1,o=1,u=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===u&&0!==this[t+i+1]&&(u=1),this[t+i]=(e/o>>0)-u&255;return t+n},m.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},m.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},m.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},m.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},m.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||V(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},m.prototype.writeBigInt64LE=ue((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return W(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),m.prototype.writeBigInt64BE=ue((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return G(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),m.prototype.writeFloatLE=function(e,t,n){return q(this,e,t,!0,n)},m.prototype.writeFloatBE=function(e,t,n){return q(this,e,t,!1,n)},m.prototype.writeDoubleLE=function(e,t,n){return J(this,e,t,!0,n)},m.prototype.writeDoubleBE=function(e,t,n){return J(this,e,t,!1,n)},m.prototype.copy=function(e,t,n,r){if(!m.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),a},m.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!m.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var a=e.charCodeAt(0);("utf8"===r&&a<128||"latin1"===r)&&(e=a)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=m.isBuffer(e)?e:m.from(e,r),u=o.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%u]}return this};var K={};function X(e,t,n){K[e]=function(n){o.default(a,n);var r=u.default(a);function a(){var n;return c.default(this,a),n=r.call(this),Object.defineProperty(l.default(n),"message",{value:t.apply(l.default(n),arguments),writable:!0,configurable:!0}),n.name="".concat(n.name," [").concat(e,"]"),n.stack,delete n.name,n}return f.default(a,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),a}(n)}function Y(e){for(var t="",n=e.length,r="-"===e[0]?1:0;n>=r+4;n-=3)t="_".concat(e.slice(n-3,n)).concat(t);return"".concat(e.slice(0,n)).concat(t)}function Q(e,t,n,r,a,o){if(e>n||e<t){var u,s="bigint"===(void 0===t?"undefined":i.default(t))?"n":"";throw u=o>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(o+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(o+1)-1).concat(s,") and < 2 ** ")+"".concat(8*(o+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(n).concat(s),new K.ERR_OUT_OF_RANGE("value",u,e)}!function(e,t,n){Z(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||$(t,e.length-(n+1))}(r,a,o)}function Z(e,t){if("number"!=typeof e)throw new K.ERR_INVALID_ARG_TYPE(t,"number",e)}function $(e,t,n){if(Math.floor(e)!==e)throw Z(e,n),new K.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new K.ERR_BUFFER_OUT_OF_BOUNDS;throw new K.ERR_OUT_OF_RANGE(n||"offset",">= ".concat(n?1:0," and <= ").concat(t),e)}X("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),X("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(void 0===t?"undefined":i.default(t))}),TypeError),X("ERR_OUT_OF_RANGE",(function(e,t,n){var r='The value of "'.concat(e,'" is out of range.'),a=n;return Number.isInteger(n)&&Math.abs(n)>Math.pow(2,32)?a=Y(String(n)):"bigint"===(void 0===n?"undefined":i.default(n))&&(a=String(n),(n>Math.pow(BigInt(2),BigInt(32))||n<-Math.pow(BigInt(2),BigInt(32)))&&(a=Y(a)),a+="n"),r+=" It must be ".concat(t,". Received ").concat(a)}),RangeError);var ee=/[^+/0-9A-Za-z-_]/g;function te(e,t){var n;t=t||1/0;for(var r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function ne(e){return d.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(ee,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function re(e,t,n,r){var a;for(a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function ae(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ie(e){return e!=e}var oe=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,a=0;a<16;++a)t[r+a]=e[n]+e[a];return t}();function ue(e){return"undefined"==typeof BigInt?se:e}function se(){throw new Error("BigInt not supported")}})),s.register("6dQ6P",(function(e,t){var r,a;n(e.exports,"toByteArray",(function(){return r}),(function(e){return r=e})),n(e.exports,"fromByteArray",(function(){return a}),(function(e){return a=e})),r=function(e){var t,n,r=f(e),a=r[0],i=r[1],s=new u(function(e,t,n){return 3*(t+n)/4-n}(0,a,i)),c=0,l=i>0?a-4:a;for(n=0;n<l;n+=4)t=o[e.charCodeAt(n)]<<18|o[e.charCodeAt(n+1)]<<12|o[e.charCodeAt(n+2)]<<6|o[e.charCodeAt(n+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=255&t;2===i&&(t=o[e.charCodeAt(n)]<<2|o[e.charCodeAt(n+1)]>>4,s[c++]=255&t);1===i&&(t=o[e.charCodeAt(n)]<<10|o[e.charCodeAt(n+1)]<<4|o[e.charCodeAt(n+2)]>>2,s[c++]=t>>8&255,s[c++]=255&t);return s},a=function(e){for(var t,n=e.length,r=n%3,a=[],o=16383,u=0,s=n-r;u<s;u+=o)a.push(d(e,u,u+o>s?s:u+o));1===r?(t=e[n-1],a.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],a.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return a.join("")};for(var i=[],o=[],u="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,l=s.length;c<l;++c)i[c]=s[c],o[s.charCodeAt(c)]=c;function f(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var r,a,o=[],u=t;u<n;u+=3)r=(e[u]<<16&16711680)+(e[u+1]<<8&65280)+(255&e[u+2]),o.push(i[(a=r)>>18&63]+i[a>>12&63]+i[a>>6&63]+i[63&a]);return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63})),s.register("km2p9",(function(e,t){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var r,a;n(e.exports,"read",(function(){return r}),(function(e){return r=e})),n(e.exports,"write",(function(){return a}),(function(e){return a=e})),r=function(e,t,n,r,a){var i,o,u=8*a-r-1,s=(1<<u)-1,c=s>>1,l=-7,f=n?a-1:0,d=n?-1:1,p=e[t+f];for(f+=d,i=p&(1<<-l)-1,p>>=-l,l+=u;l>0;i=256*i+e[t+f],f+=d,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[t+f],f+=d,l-=8);if(0===i)i=1-c;else{if(i===s)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),i-=c}return(p?-1:1)*o*Math.pow(2,i-r)},a=function(e,t,n,r,a,i){var o,u,s,c=8*i-a-1,l=(1<<c)-1,f=l>>1,d=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,h=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(s=Math.pow(2,-o))<1&&(o--,s*=2),(t+=o+f>=1?d/s:d*Math.pow(2,1-f))*s>=2&&(o++,s/=2),o+f>=l?(u=0,o=l):o+f>=1?(u=(t*s-1)*Math.pow(2,a),o+=f):(u=t*Math.pow(2,f-1)*Math.pow(2,a),o=0));a>=8;e[n+p]=255&u,p+=h,u/=256,a-=8);for(o=o<<a|u,c+=a;c>0;e[n+p]=255&o,p+=h,o/=256,c-=8);e[n+p-h]|=128*v}})),s.register("5nSEP",(function(e,t){n(e.exports,"IORouterRegistry",(function(){return i})),n(e.exports,"registerSaveRouter",(function(){return o})),n(e.exports,"registerLoadRouter",(function(){return u})),n(e.exports,"getSaveHandlers",(function(){return c})),n(e.exports,"getLoadHandlers",(function(){return l})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=function(){"use strict";function e(){r.default(this,e),this.saveRouters=[],this.loadRouters=[]}return a.default(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),o=function(e){return i.registerSaveRouter(e)},u=function(e){return i.registerLoadRouter(e)},c=function(e){return i.getSaveHandlers(e)},l=function(e,t){return i.getLoadHandlers(e,t)}})),s.register("2H47L",(function(e,r){n(e.exports,"BrowserLocalStorage",(function(){return w})),n(e.exports,"BrowserLocalStorageManager",(function(){return E})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("40Zzs");s("hbYT1");var c=s("lU3MY"),l=s("kglvN"),f=s("69QQV"),d=s("5nSEP"),p="/",h="tensorflowjs_models",v="info",g="model_topology",m="weight_specs",y="weight_data",x="model_metadata";function b(e){return{info:[h,e,v].join(p),topology:[h,e,g].join(p),weightSpecs:[h,e,m].join(p),weightData:[h,e,y].join(p),modelMetadata:[h,e,x].join(p)}}function k(e){var t=e.split(p);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(p)}var w=function(){"use strict";function e(t){if(a.default(this,e),!c.env().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=b(this.modelPath)}return i.default(e,[{key:"save",value:function(e){var n=this;return o.default(t(u).mark((function r(){var a,i,o;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return a=JSON.stringify(e.modelTopology),i=JSON.stringify(e.weightSpecs),o=f.getModelArtifactsInfoForJSON(e),t.prev=7,n.LS.setItem(n.keys.info,JSON.stringify(o)),n.LS.setItem(n.keys.topology,a),n.LS.setItem(n.keys.weightSpecs,i),n.LS.setItem(n.keys.weightData,f.arrayBufferToBase64String(e.weightData)),n.LS.setItem(n.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),t.abrupt("return",{modelArtifactsInfo:o});case 16:throw t.prev=16,t.t0=t.catch(7),n.LS.removeItem(n.keys.info),n.LS.removeItem(n.keys.topology),n.LS.removeItem(n.keys.weightSpecs),n.LS.removeItem(n.keys.weightData),n.LS.removeItem(n.keys.modelMetadata),new Error("Failed to save model '".concat(n.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(o.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(o.weightSpecsBytes,", ")+"weightDataBytes=".concat(o.weightDataBytes,"."));case 24:case"end":return t.stop()}}),r,null,[[7,16]])})))()}},{key:"load",value:function(){var e=this;return o.default(t(u).mark((function n(){var r,a,i,o,s,c,l;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=(r=JSON.parse(e.LS.getItem(e.keys.info)))){t.next=3;break}throw new Error("In local storage, there is no model with name '".concat(e.modelPath,"'"));case 3:if("JSON"===r.modelTopologyType){t.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(a={},null!=(i=JSON.parse(e.LS.getItem(e.keys.topology)))){t.next=9;break}throw new Error("In local storage, the topology of model '".concat(e.modelPath,"' ")+"is missing.");case 9:if(a.modelTopology=i,null!=(o=JSON.parse(e.LS.getItem(e.keys.weightSpecs)))){t.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(e.modelPath,"' ")+"are missing.");case 13:if(a.weightSpecs=o,null!=(s=e.LS.getItem(e.keys.modelMetadata))&&(c=JSON.parse(s),a.format=c.format,a.generatedBy=c.generatedBy,a.convertedBy=c.convertedBy,a.userDefinedMetadata=c.userDefinedMetadata),null!=(l=e.LS.getItem(e.keys.weightData))){t.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(e.modelPath,"' are missing."));case 19:return a.weightData=f.base64StringToArrayBuffer(l),t.abrupt("return",a);case 21:case"end":return t.stop()}}),n)})))()}}]),e}();w.URL_SCHEME="localstorage://";var A=function(e){return c.env().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(w.URL_SCHEME)?(t=e.slice(w.URL_SCHEME.length),new w(t)):null;var t};d.IORouterRegistry.registerSaveRouter(A),d.IORouterRegistry.registerLoadRouter(A);var E=function(){"use strict";function e(){a.default(this,e),l.assert(c.env().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),l.assert("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return i.default(e,[{key:"listModels",value:function(){var e=this;return o.default(t(u).mark((function n(){var r,a,i,o,s,c;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(r={},a=h+p,i=p+v,o=0;o<e.LS.length;++o)(s=e.LS.key(o)).startsWith(a)&&s.endsWith(i)&&(c=k(s),r[c]=JSON.parse(e.LS.getItem(s)));return t.abrupt("return",r);case 5:case"end":return t.stop()}}),n)})))()}},{key:"removeModel",value:function(e){var n=this;return o.default(t(u).mark((function r(){var a,i;return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=(r=e).startsWith(w.URL_SCHEME)?r.slice(w.URL_SCHEME.length):r,a=b(e),null!=n.LS.getItem(a.info)){t.next=4;break}throw new Error("Cannot find model at path '".concat(e,"'"));case 4:return i=JSON.parse(n.LS.getItem(a.info)),n.LS.removeItem(a.info),n.LS.removeItem(a.topology),n.LS.removeItem(a.weightSpecs),n.LS.removeItem(a.weightData),t.abrupt("return",i);case 10:case"end":return t.stop()}var r}),r)})))()}}]),e}()})),s.register("lmNUn",(function(e,r){n(e.exports,"ModelStoreManagerRegistry",(function(){return d})),n(e.exports,"listModels",(function(){return g})),n(e.exports,"removeModel",(function(){return y})),n(e.exports,"copyModel",(function(){return b})),n(e.exports,"moveModel",(function(){return w})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("40Zzs"),c=s("kglvN"),l=s("5nSEP"),f="://",d=function(){"use strict";function e(){a.default(this,e),this.managers={}}return i.default(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){c.assert(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(f)&&(t=t.slice(0,t.indexOf(f))),c.assert(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();c.assert(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function p(e){if(-1===e.indexOf(f))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(d.getSchemes().join(",")));return{scheme:e.split(f)[0],path:e.split(f)[1]}}function h(e,t){return v.apply(this,arguments)}function v(){return v=o.default(t(u).mark((function e(n,r){var a,i,o,s,f,h,v,g,m,y,x=arguments;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=x.length>2&&void 0!==x[2]&&x[2],c.assert(n!==r,(function(){return"Old path and new path are the same: '".concat(n,"'")})),i=l.IORouterRegistry.getLoadHandlers(n),c.assert(i.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(n,".")})),c.assert(i.length<2,(function(){return"Copying failed because more than one (".concat(i.length,") ")+"load handlers for source URL ".concat(n,".")})),o=i[0],s=l.IORouterRegistry.getSaveHandlers(r),c.assert(s.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(r,".")})),c.assert(s.length<2,(function(){return"Copying failed because more than one (".concat(i.length,") ")+"save handlers for destination URL ".concat(r,".")})),f=s[0],h=p(n).scheme,v=p(n).path,g=h===p(n).scheme,e.next=15,o.load();case 15:if(m=e.sent,!a||!g){e.next=19;break}return e.next=19,d.getManager(h).removeModel(v);case 19:return e.next=21,f.save(m);case 21:if(y=e.sent,!a||g){e.next=25;break}return e.next=25,d.getManager(h).removeModel(v);case 25:return e.abrupt("return",y.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function g(){return m.apply(this,arguments)}function m(){return m=o.default(t(u).mark((function e(){var n,r,a,i,o,s,c,l,p,h;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.getSchemes(),r={},a=!0,i=!1,o=void 0,e.prev=3,s=n[Symbol.iterator]();case 5:if(a=(c=s.next()).done){e.next=14;break}return l=c.value,e.next=9,d.getManager(l).listModels();case 9:for(h in p=e.sent)r[l+f+h]=p[h];case 11:a=!0,e.next=5;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(3),i=!0,o=e.t0;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,!i){e.next=26;break}throw o;case 26:return e.finish(23);case 27:return e.finish(20);case 28:return e.abrupt("return",r);case 29:case"end":return e.stop()}}),e,null,[[3,16,20,28],[21,,23,27]])}))),m.apply(this,arguments)}function y(e){return x.apply(this,arguments)}function x(){return(x=o.default(t(u).mark((function e(n){var r,a;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=p(n),a=d.getManager(r.scheme),e.abrupt("return",a.removeModel(r.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(e,t){return k.apply(this,arguments)}function k(){return(k=o.default(t(u).mark((function e(n,r){return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",h(n,r,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e,t){return A.apply(this,arguments)}function A(){return(A=o.default(t(u).mark((function e(n,r){return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",h(n,r,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}})),s.register("gsgGx",(function(e,t){s("1i51P");var n,r=s("3QOYJ"),a=s("2tuUj"),i=s("lU3MY"),o=s("dJYM3"),u=function(){return s("jebYF")};var c=function(){"use strict";function e(){r.default(this,e),this.util=s("jebYF"),this.textEncoder=new this.util.TextEncoder}return a.default(e,[{key:"fetch",value:function(e,t){return null!=i.env().global.fetch?i.env().global.fetch(e,t):(null==n&&(n=u()),n(e,t))}},{key:"now",value:function(){var e=o.hrtime();return 1e3*e[0]+e[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),e}();i.env().get("IS_NODE")&&i.env().setPlatform("node",new c)})),s.register("jebYF",(function(e,t){})),s.register("8orDI",(function(e,t){n(e.exports,"buffer",(function(){return i}));var r=s("4JvjV"),a=s("kglvN");function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",a.assertNonNegativeIntegerDimensions(e),new r.TensorBuffer(e,t,n)}})),s.register("782ce",(function(e,t){n(e.exports,"cast",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({cast_:function(e,t){var n=i.convertToTensor(e,"x","cast");if(!o.isValidDtype(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var u={x:n},s={dtype:t};return r.ENGINE.runKernelFunc((function(e){return e.cast(n,t)}),u,null,a.Cast,s)}})})),s.register("dOUsY",(function(e,t){n(e.exports,"clone",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({clone_:function(e){var t=i.convertToTensor(e,"x","clone",null),n={x:t};return r.ENGINE.runKernelFunc((function(){return r.ENGINE.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),n,null,a.Identity)}})})),s.register("i4HMG",(function(e,t){function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}n(e.exports,"print",(function(){return r}))})),s.register("f6sen",(function(e,t){var n=s("d1vFE"),r=s("7nbvq"),a=s("2wyjl"),i=s("bVw5s"),o=s("lFBAr"),u=s("8BrL8"),c=s("bB9e4"),l=s("k7dvM"),f=s("5xav7"),d=s("aRxot"),p=s("3wjHo"),h=s("k6u05"),v=s("1irYX"),g=s("1vnFN"),m=s("lckOo"),y=s("431hm"),x=s("7gfxB"),b=s("4YtsC"),k=s("8qks2"),w=s("5PkjL"),A=s("kdsaQ"),E=s("9qehG"),C=s("1EbUn"),S=s("5YKNI"),N=s("gVS0M"),T=s("277p7"),D=s("2uzV9"),F=s("23SLU"),O=s("2vxvE"),_=s("eqk6I"),I=s("lKYBS"),R=s("ioDbU"),M=s("aPSyU"),B=s("4PEpk"),P=s("1GJoU"),L=s("9l5vS"),j=s("g6Jb3"),z=s("5pxGR"),U=s("2lJZz"),V=s("cNbMP"),W=s("6UTnq"),G=s("5igHw"),H=s("c9jDQ"),q=s("2Xrqn"),J=s("cDLOS"),K=s("44Yns"),X=s("l1V6Q"),Y=s("baIQW"),Q=s("1p8ad"),Z=s("fCjRI"),$=s("4ebM0"),ee=s("kluJF"),te=s("8pDEH"),ne=s("3lSBZ"),re=s("Jz5MQ"),ae=s("57Act"),ie=s("D7D3s"),oe=s("9xIBt"),ue=s("2xrRx"),se=s("eIh3i"),ce=s("6vdXF"),le=s("fBdM2"),fe=s("3vVAh"),de=s("kcVUh"),pe=s("gNur9"),he=s("25SUP"),ve=s("8QHx3"),ge=s("eCdCS"),me=s("jZSjo"),ye=s("5DlQ8"),xe=s("jWm6K"),be=s("4jq6O"),ke=s("03id1"),we=s("9TGgL"),Ae=s("2oAw8"),Ee=s("4ptMz"),Ce=s("4tzvL"),Se=s("h4mO5"),Ne=s("53zFQ"),Te=s("nY2fZ"),De=s("hX7T9"),Fe=s("eri5d"),Oe=s("8CZoQ"),_e=s("4Z2tW"),Ie=s("57aKI"),Re=s("6WuX5"),Me=s("acOdm"),Be=s("53dUL"),Pe=s("j4Ir3"),Le=s("2YU3f"),je=s("lUXJf"),ze=s("hsYp4"),Ue=s("6wPR5"),Ve=s("dShLg"),We=s("d4BUr"),Ge=[n.absGradConfig,r.acosGradConfig,a.acoshGradConfig,i.addGradConfig,o.addNGradConfig,u.argMaxGradConfig,c.argMinGradConfig,l.asinGradConfig,f.asinhGradConfig,d.atan2GradConfig,p.atanGradConfig,h.atanhGradConfig,v.avgPool3DGradConfig,g.avgPoolGradConfig,m.batchMatMulGradConfig,y.batchToSpaceNDGradConfig,x.broadcastToGradConfig,b.castGradConfig,k.ceilGradConfig,w.clipByValueGradConfig,A.concatGradConfig,C.conv2DBackpropInputGradConfig,E.conv2DGradConfig,S.conv3DGradConfig,N.cosGradConfig,T.coshGradConfig,D.cumsumGradConfig,F.depthwiseConv2dNativeGradConfig,O.dilation2dGradConfig,_.divGradConfig,I.eluGradConfig,R.erfGradConfig,M.expGradConfig,B.expm1GradConfig,L.floorDivGradConfig,P.floorGradConfig,j.fusedBatchNormGradConfig,z.gatherGradConfig,U.greaterEqualGradConfig,V.identityGradConfig,W.isFiniteGradConfig,G.isInfGradConfig,H.isNanGradConfig,q.log1pGradConfig,J.logGradConfig,K.logSoftmaxGradConfig,X.lrnGradConfig,Y.maxGradConfig,Y.maxGradConfig,Q.maximumGradConfig,Z.maxPool3DGradConfig,$.maxPoolGradConfig,ee.minGradConfig,te.minimumGradConfig,ne.modGradConfig,re.multiplyGradConfig,ae.negateGradConfig,ie.oneHotGradConfig,oe.onesLikeGradConfig,ue.padV2GradConfig,ue.padV2GradConfig,se.powGradConfig,ce.preluGradConfig,le.reciprocalGradConfig,fe.relu6GradConfig,de.reluGradConfig,pe.reshapeGradConfig,he.resizeBilinearGradConfig,ve.resizeNearestNeighborGradConfig,ge.reverseGradConfig,me.roundGradConfig,ye.rsqrtGradConfig,xe.selectV2PoolGradConfig,be.seluGradConfig,ke.sigmoidGradConfig,we.signGradConfig,Ae.sinGradConfig,Ee.sinhGradConfig,Ce.sliceGradConfig,Se.softmaxGradConfig,Ne.softplusGradConfig,Te.spaceToBatchNDGradConfig,Te.spaceToBatchNDGradConfig,De.splitVGradConfig,De.splitVGradConfig,Fe.sqrtGradConfig,_e.squaredDifferenceGradConfig,Oe.squareGradConfig,Ie.stepGradConfig,Re.subGradConfig,Me.sumGradConfig,Be.tanGradConfig,Pe.tanhGradConfig,Le.tileGradConfig,je.transposeGradConfig,ze.unpackGradConfig,Ue.unsortedSegmentSumGradConfig,Ve.zerosLikeGradConfig],He=!0,qe=!1,Je=void 0;try{for(var Ke,Xe=Ge[Symbol.iterator]();!(He=(Ke=Xe.next()).done);He=!0){var Ye=Ke.value;We.registerGradient(Ye)}}catch(e){qe=!0,Je=e}finally{try{He||null==Xe.return||Xe.return()}finally{if(qe)throw Je}}})),s.register("d1vFE",(function(e,t){n(e.exports,"absGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("j0e1k"),u=s("lWKd3"),c={kernelName:a.Abs,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.mul(e,u.step(i.cast(n,"float32"),-1))}}}}})),s.register("j0e1k",(function(e,t){n(e.exports,"mul",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({mul_:function(e,t){var n,s=u.convertToTensor(e,"a","mul"),c=u.convertToTensor(t,"b","mul");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.multiply(s,c);return t([s,c]),n}),l,null,i.Multiply)}})})),s.register("lWKd3",(function(e,t){n(e.exports,"step",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i.convertToTensor(e,"x","step"),o={x:n},u={alpha:t};return r.ENGINE.runKernelFunc((function(e){return e.step(n,t)}),o,null,a.Step,u)}})})),s.register("7nbvq",(function(e,t){n(e.exports,"acosGradConfig",(function(){return p})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6baO0"),u=s("ee0Eu"),c=s("bftEy"),l=s("buy0T"),f=s("4C8ia"),d=s("fZE7S"),p={kernelName:a.Acos,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){var t=f.square(i.cast(n,"float32")),r=l.sqrt(d.sub(c.scalar(1),t));return u.neg(o.div(e,r))}}}}})),s.register("6baO0",(function(e,t){n(e.exports,"div",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("cisxn");var l=s("f1skK").op({div_:function(e,t){var n,s=u.convertToTensor(e,"a","div"),l=u.convertToTensor(t,"b","div");if(n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],"int32"===s.dtype&&"int32"===l.dtype)return c.floorDiv(s,l);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e,t){var n=e.realDivide(s,l);return t([s,l]),n}),f,null,i.Div,{})}})})),s.register("cisxn",(function(e,t){n(e.exports,"floorDiv",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({floorDiv_:function(e,t){var n,s=u.convertToTensor(e,"a","floorDiv"),c=u.convertToTensor(t,"b","floorDiv");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.floorDiv(s,c);return t([s,c]),n}),l,null,i.FloorDiv)}})})),s.register("ee0Eu",(function(e,t){n(e.exports,"neg",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({neg_:function(e){var t=i.convertToTensor(e,"x","neg"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.neg(t)}),n,null,a.Negate)}})})),s.register("bftEy",(function(e,t){n(e.exports,"scalar",(function(){return i}));var r=s("kglvN"),a=s("fTjN4");function i(e,t){if((r.isTypedArray(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&r.isTypedArray(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return a.makeTensor(e,[],[],t)}})),s.register("buy0T",(function(e,t){n(e.exports,"sqrt",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({sqrt_:function(e){var t=i.convertToTensor(e,"x","sqrt"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),n,null,a.Sqrt)}})})),s.register("4C8ia",(function(e,t){n(e.exports,"square",(function(){return i}));var r=s("1dnDT"),a=s("lcVC1");var i=s("f1skK").op({square_:function(e){var t=a.convertToTensor(e,"x","square"),n=[t];return r.ENGINE.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}})})),s.register("fZE7S",(function(e,t){n(e.exports,"sub",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({sub_:function(e,t){var n,s=u.convertToTensor(e,"a","sub"),c=u.convertToTensor(t,"b","sub");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.subtract(s,c);return t([s,c]),n}),l,null,i.Sub)}})})),s.register("2wyjl",(function(e,t){n(e.exports,"acoshGradConfig",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6baO0"),u=s("buy0T"),c=s("4C8ia"),l=s("fZE7S"),f={kernelName:a.Acosh,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){var t=u.sqrt(l.sub(c.square(i.cast(n,"float32")),1));return o.div(e,t)}}}}})),s.register("bVw5s",(function(e,t){n(e.exports,"addGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("gldWN"),u=s("2xCpB"),c={kernelName:a.Add,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],c=i.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=e,n=i.getReductionAxes(a.shape,c);return n.length>0&&(t=u.sum(t,n)),o.reshape(t,a.shape)},b:function(){var t=e,n=i.getReductionAxes(s.shape,c);return n.length>0&&(t=u.sum(t,n)),o.reshape(t,s.shape)}}}}})),s.register("kNwIt",(function(e,t){function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var u="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(u)}n.unshift(i)}}return n}n(e.exports,"getBroadcastDims",(function(){return r})),n(e.exports,"getReductionAxes",(function(){return a})),n(e.exports,"assertAndGetBroadcastShape",(function(){return i}))})),s.register("gldWN",(function(e,t){n(e.exports,"reshape",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({reshape_:function(e,t){var n=i.convertToTensor(e,"x","reshape",null);t=o.inferFromImplicitShape(t,n.size),o.assert(n.size===o.sizeFromShape(t),(function(){return"new shape and old shape must have the same number of elements."}));var u={x:n},s={shape:t};return r.ENGINE.runKernelFunc((function(e,r){return r([n]),e.reshape(n,t)}),u,null,a.Reshape,s)}})})),s.register("2xCpB",(function(e,t){n(e.exports,"sum",(function(){return p}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("782ce"),l=s("f1skK"),f=s("gldWN"),d=s("9PS5J");var p=l.op({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i.convertToTensor(e,"x","sum");"bool"===s.dtype&&(s=c.cast(s,"int32"));var l=function(e,r){r([s]);var a=o.parseAxisParam(t,s.shape),i=u.getAxesPermutation(a,s.rank),c=a,l=s;null!=i&&(l=d.transpose(s,i),c=u.getInnerMostAxes(c.length,s.rank));var p=e.sum(l,c);if(n){var h=u.expandShapeToKeepDim(p.shape,a);p=f.reshape(p,h)}return p},p={x:s},h={axis:t,keepDims:n};return r.ENGINE.runKernelFunc(l,p,null,a.Sum,h)}})})),s.register("4RRNB",(function(e,t){n(e.exports,"axesAreInnerMostDims",(function(){return a})),n(e.exports,"combineLocations",(function(){return i})),n(e.exports,"computeOutAndReduceShapes",(function(){return o})),n(e.exports,"expandShapeToKeepDim",(function(){return u})),n(e.exports,"assertAxesAreInnerMostDims",(function(){return c})),n(e.exports,"getAxesPermutation",(function(){return l})),n(e.exports,"getUndoAxesPermutation",(function(){return f})),n(e.exports,"getInnerMostAxes",(function(){return d}));var r=s("kglvN");function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,u=0;u<r;u++)-1===n.indexOf(u)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function u(e,t){return i(e,t.map((function(e){return 1})),t)}function c(e,t,n){r.assert(a(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function l(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function f(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function d(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}})),s.register("9PS5J",(function(e,t){n(e.exports,"transpose",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({transpose_:function(e,t){var n=i.convertToTensor(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),o.assert(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){o.assert(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var u={x:n},s={perm:t};return r.ENGINE.runKernelFunc((function(e){return e.transpose(n,t)}),u,null,a.Transpose,s)}})})),s.register("lFBAr",(function(e,t){n(e.exports,"addNGradConfig",(function(){return r}));var r={kernelName:s("cvMH2").AddN,saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}}})),s.register("8BrL8",(function(e,t){n(e.exports,"argMaxGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("8p3bZ"),o={kernelName:a.ArgMax,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.zerosLike(n)}}}}})),s.register("8p3bZ",(function(e,t){n(e.exports,"zerosLike",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({zerosLike_:function(e){var t=i.convertToTensor(e,"x","zerosLike"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.zerosLike(t)}),n,null,a.ZerosLike)}})})),s.register("bB9e4",(function(e,t){n(e.exports,"argMinGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("8p3bZ"),o={kernelName:a.ArgMin,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.zerosLike(n)}}}}})),s.register("k7dvM",(function(e,t){n(e.exports,"asinGradConfig",(function(){return d})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6baO0"),u=s("bftEy"),c=s("buy0T"),l=s("4C8ia"),f=s("fZE7S"),d={kernelName:a.Asin,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.div(e,c.sqrt(f.sub(u.scalar(1),l.square(i.cast(n,"float32")))))}}}}})),s.register("5xav7",(function(e,t){n(e.exports,"asinhGradConfig",(function(){return d})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("b3Qcj"),o=s("782ce"),u=s("6baO0"),c=s("bftEy"),l=s("buy0T"),f=s("4C8ia"),d={kernelName:a.Asinh,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){var t=l.sqrt(i.add(c.scalar(1),f.square(o.cast(n,"float32"))));return u.div(e,t)}}}}})),s.register("b3Qcj",(function(e,t){n(e.exports,"add",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({add_:function(e,t){var n,s=u.convertToTensor(e,"a","add"),c=u.convertToTensor(t,"b","add");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.add(s,c);return t([s,c]),n}),l,null,i.Add)}})})),s.register("aRxot",(function(e,t){n(e.exports,"atan2GradConfig",(function(){return h})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("b3Qcj"),o=s("kNwIt"),u=s("6baO0"),c=s("j0e1k"),l=s("ee0Eu"),f=s("gldWN"),d=s("4C8ia"),p=s("2xCpB"),h={kernelName:a.Atan2,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],h=o.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=i.add(d.square(a),d.square(s)),n=c.mul(e,u.div(s,t)),r=o.getReductionAxes(a.shape,h);return r.length>0&&(n=p.sum(n,r)),f.reshape(n,a.shape)},b:function(){var t=i.add(d.square(a),d.square(s)),n=l.neg(c.mul(e,u.div(a,t))),r=o.getReductionAxes(s.shape,h);return r.length>0&&(n=p.sum(n,r)),f.reshape(n,s.shape)}}}}})),s.register("3wjHo",(function(e,t){n(e.exports,"atanGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("b3Qcj"),o=s("782ce"),u=s("6baO0"),c=s("4C8ia"),l={kernelName:a.Atan,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return u.div(e,i.add(c.square(o.cast(n,"float32")),1))}}}}})),s.register("k6u05",(function(e,t){n(e.exports,"atanhGradConfig",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6baO0"),u=s("4C8ia"),c=s("fZE7S"),l=s("bftEy"),f={kernelName:a.Atanh,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.div(e,c.sub(l.scalar(1),u.square(i.cast(n,"float32"))))}}}}})),s.register("1irYX",(function(e,t){n(e.exports,"avgPool3DGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("cSZ7e"),o={kernelName:a.AvgPool3D,inputsToSave:["x"],gradFunc:function(e,t,n){var a=r.default(t,1)[0],o=n.filterSize,u=n.strides,s=n.dilations,c=n.pad,l=n.dimRoundingMode,f=null==s?[1,1,1]:s;return{x:function(){return i.avgPool3dBackprop(e,a,o,u,f,c,l)}}}}})),s.register("cSZ7e",(function(e,t){n(e.exports,"avgPool3dBackprop",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=s("f1skK"),l=s("gldWN");var f=c.op({avgPool3dBackprop_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1,1],f=arguments.length>5?arguments[5]:void 0,d=arguments.length>6?arguments[6]:void 0,p=i.convertToTensor(e,"dy","avgPool3dBackprop"),h=i.convertToTensor(t,"input","avgPool3dBackprop"),v=p,g=h,m=!1;4===h.rank&&(m=!0,v=l.reshape(p,[1,p.shape[0],p.shape[1],p.shape[2],p.shape[3]]),g=l.reshape(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),o.assert(5===v.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+"".concat(v.rank,".")})),o.assert(5===g.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+"".concat(g.rank,".")})),o.assert(u.eitherStridesOrDilationsAreOne(s,c),(function(){return"Error in avgPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(s," and dilations '").concat(c,"'")})),null!=d&&o.assert(o.isInt(f),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(d," but got pad ").concat(f,".")}));var y=function(e){var t=u.computePool3DInfo(g.shape,n,s,c,f,d);return e.avgPool3dBackprop(v,g,t)},x={dy:v,input:g},b={filterSize:n,strides:s,dilations:c,pad:f,dimRoundingMode:d},k=r.ENGINE.runKernelFunc(y,x,null,a.AvgPool3DBackprop,b);return m?l.reshape(k,[k.shape[1],k.shape[2],k.shape[3],k.shape[4]]):k}})})),s.register("drGuD",(function(e,t){n(e.exports,"computeDilation2DInfo",(function(){return o})),n(e.exports,"convertConv2DDataFormat",(function(){return k})),n(e.exports,"computeConv2DInfo",(function(){return l})),n(e.exports,"computePool2DInfo",(function(){return u})),n(e.exports,"computePool3DInfo",(function(){return c})),n(e.exports,"computeConv3DInfo",(function(){return f})),n(e.exports,"computeDefaultPad",(function(){return d})),n(e.exports,"tupleValuesAreOne",(function(){return x})),n(e.exports,"eitherStridesOrDilationsAreOne",(function(){return b})),s("1i51P");var r=s("9M1dW"),a=s("6vecG"),i=s("kglvN");function o(e,t,n,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,u=e[3],s=r.default(t).concat([u]),c=k(i);return l(e,s,n,o,a,null,null,c)}function u(e,t,n,r,i,o){var u,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",c=a.default(p(t),2),f=c[0],d=c[1];if("channelsLast"===s)u=[f,d,e[3],e[3]];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));u=[f,d,e[1],e[1]]}return l(e,u,n,r,i,o,!1,s)}function c(e,t,n,r,i,o){var u,s,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",l=a.default(h(t),3),d=l[0],p=l[1],v=l[2];if("NDHWC"===c)s="channelsLast",u=[d,p,v,e[4],e[4]];else{if("NCDHW"!==c)throw new Error("Unknown dataFormat ".concat(c));s="channelsFirst",u=[d,p,v,e[1],e[1]]}return f(e,u,n,r,i,!1,s,o)}function l(e,t,n,r,i,o){var u,s,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",f=-1,d=-1,h=-1,m=-1;if("channelsLast"===l)f=(u=a.default(e,4))[0],d=u[1],h=u[2],m=u[3];else{if("channelsFirst"!==l)throw new Error("Unknown dataFormat ".concat(l));f=(s=a.default(e,4))[0],m=s[1],d=s[2],h=s[3]}var y,x=a.default(t,4),b=x[0],k=x[1],w=x[3],A=a.default(p(n),2),E=A[0],C=A[1],S=a.default(p(r),2),N=S[0],T=S[1],D=v(b,N),F=v(k,T),O=g(i,d,h,E,C,D,F,o,l),_=O.padInfo,I=O.outHeight,R=O.outWidth,M=c?w*m:w;return"channelsFirst"===l?y=[f,M,I,R]:"channelsLast"===l&&(y=[f,I,R,M]),{batchSize:f,dataFormat:l,inHeight:d,inWidth:h,inChannels:m,outHeight:I,outWidth:R,outChannels:M,padInfo:_,strideHeight:E,strideWidth:C,filterHeight:b,filterWidth:k,effectiveFilterHeight:D,effectiveFilterWidth:F,dilationHeight:N,dilationWidth:T,inShape:e,outShape:y,filterShape:t}}function f(e,t,n,r,i){var o,u,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5],c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=arguments.length>7?arguments[7]:void 0,f=-1,d=-1,p=-1,g=-1,y=-1;if("channelsLast"===c)f=(o=a.default(e,5))[0],d=o[1],p=o[2],g=o[3],y=o[4];else{if("channelsFirst"!==c)throw new Error("Unknown dataFormat ".concat(c));f=(u=a.default(e,5))[0],y=u[1],d=u[2],p=u[3],g=u[4]}var x,b=a.default(t,5),k=b[0],w=b[1],A=b[2],E=b[4],C=a.default(h(n),3),S=C[0],N=C[1],T=C[2],D=a.default(h(r),3),F=D[0],O=D[1],_=D[2],I=v(k,F),R=v(w,O),M=v(A,_),B=m(i,d,p,g,S,N,T,I,R,M,l),P=B.padInfo,L=B.outDepth,j=B.outHeight,z=B.outWidth,U=s?E*y:E;return"channelsFirst"===c?x=[f,U,L,j,z]:"channelsLast"===c&&(x=[f,L,j,z,U]),{batchSize:f,dataFormat:c,inDepth:d,inHeight:p,inWidth:g,inChannels:y,outDepth:L,outHeight:j,outWidth:z,outChannels:U,padInfo:P,strideDepth:S,strideHeight:N,strideWidth:T,filterDepth:k,filterHeight:w,filterWidth:A,effectiveFilterDepth:I,effectiveFilterHeight:R,effectiveFilterWidth:M,dilationDepth:F,dilationHeight:O,dilationWidth:_,inShape:e,outShape:x,filterShape:t}}function d(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=v(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function p(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function h(e){return"number"==typeof e?[e,e,e]:e}function v(e,t){return t<=1?e:e+(e-1)*(t-1)}function g(e,t,n,r,a,o,u,s,c){var l,f,p;if("number"==typeof e){l={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var h=function(e,t,n,r,a){null==r&&(r=d(e,t,n));var o=e[0],u=e[1],s=y((o-t+2*r)/n+1,a);i.assert(i.isInt(s),(function(){return"The output # of rows (".concat(s,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var c=y((u-t+2*r)/n+1,a);return i.assert(i.isInt(c),(function(){return"The output # of columns (".concat(c,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[s,c]}([t,n],o,r,e,s);f=h[0],p=h[1]}else if("same"===e){f=Math.ceil(t/r),p=Math.ceil(n/a);var v=Math.max(0,(f-1)*r+o-t),g=Math.max(0,(p-1)*a+u-n),m=Math.floor(v/2),x=v-m,b=Math.floor(g/2);l={top:m,bottom:x,left:b,right:g-b,type:"SAME"}}else if("valid"===e)l={top:0,bottom:0,left:0,right:0,type:"VALID"},f=Math.ceil((t-o+1)/r),p=Math.ceil((n-u+1)/a);else{if("object"!=typeof e)throw Error("Unknown padding parameter: ".concat(e));var k="channelsLast"===c?e[1][0]:e[2][0],w="channelsLast"===c?e[1][1]:e[2][1],A="channelsLast"===c?e[2][0]:e[3][0],E="channelsLast"===c?e[2][1]:e[3][1];l={top:k,bottom:w,left:A,right:E,type:0===k&&0===w&&0===A&&0===E?"VALID":"EXPLICIT"},f=y((t-o+k+w)/r+1,s),p=y((n-u+A+E)/a+1,s)}return{padInfo:l,outHeight:f,outWidth:p}}function m(e,t,n,r,a,o,u,s,c,l,f){var p,h,v,g;if("number"==typeof e){p={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var m=function(e,t,n,r,a,o){null==a&&(a=d(e,t,r));var u=e[0],s=e[1],c=e[2],l=y((u-t+2*a)/r+1,o);i.assert(i.isInt(l),(function(){return"The output # of depths (".concat(l,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var f=y((s-t+2*a)/r+1,o);i.assert(i.isInt(f),(function(){return"The output # of rows (".concat(f,") must be an integer. ")+"Change the stride and/or zero pad parameters"}));var p=y((c-t+2*a)/r+1,o);return i.assert(i.isInt(p),(function(){return"The output # of columns (".concat(p,") must be an integer. ")+"Change the stride and/or zero pad parameters"})),[l,f,p,n]}([t,n,r,1],s,1,a,e,f);h=m[0],v=m[1],g=m[2]}else if("same"===e){var x=((h=Math.ceil(t/a))-1)*a+s-t,b=((v=Math.ceil(n/o))-1)*o+c-n,k=((g=Math.ceil(r/u))-1)*u+l-r,w=Math.floor(x/2),A=x-w,E=Math.floor(b/2),C=b-E,S=Math.floor(k/2);p={top:E,bottom:C,left:S,right:k-S,front:w,back:A,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));p={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-s+1)/a),v=Math.ceil((n-c+1)/o),g=Math.ceil((r-l+1)/u)}return{padInfo:p,outDepth:h,outHeight:v,outWidth:g}}function y(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function x(e){var t=a.default(p(e),3),n=t[0],r=t[1],i=t[2];return 1===n&&1===r&&1===i}function b(e,t){return x(e)||x(t)}function k(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}})),s.register("1vnFN",(function(e,t){n(e.exports,"avgPoolGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("fVVb0"),o={kernelName:a.AvgPool,inputsToSave:["x"],gradFunc:function(e,t,n){var a=r.default(t,1)[0],o=n.filterSize,u=n.strides,s=n.pad;return{x:function(){return i.avgPoolBackprop(e,a,o,u,s)}}}}})),s.register("fVVb0",(function(e,t){n(e.exports,"avgPoolBackprop",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=s("f1skK"),l=s("gldWN");var f=c.op({avgPoolBackprop_:function(e,t,n,s,c){var f=i.convertToTensor(e,"dy","avgPoolBackprop"),d=i.convertToTensor(t,"input","avgPoolBackprop");o.assert(d.rank===f.rank,(function(){return"Rank of input (".concat(d.rank,") does not match rank of dy (").concat(f.rank,")")}));var p=d,h=f,v=!1;3===d.rank&&(v=!0,p=l.reshape(d,[1,d.shape[0],d.shape[1],d.shape[2]]),h=l.reshape(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.assert(4===h.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+"".concat(h.rank,".")})),o.assert(4===p.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+"".concat(p.rank,".")}));var g={dy:h,input:p},m={filterSize:n,strides:s,pad:c},y=r.ENGINE.runKernelFunc((function(e){var t=u.computePool2DInfo(p.shape,n,s,1,c);return e.avgPoolBackprop(h,p,t)}),g,null,a.AvgPoolBackprop,m);return v?l.reshape(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})})),s.register("lckOo",(function(e,t){n(e.exports,"batchMatMulGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("5KHLt"),o={kernelName:a.BatchMatMul,inputsToSave:["a","b"],gradFunc:function(e,t,n){var a=r.default(t,2),o=a[0],u=a[1],s=n.transposeA,c=n.transposeB;return s||c?!s&&c?{a:function(){return i.matMul(e,u,!1,!1)},b:function(){return i.matMul(e,o,!0,!1)}}:s&&!c?{a:function(){return i.matMul(u,e,!1,!0)},b:function(){return i.matMul(o,e,!1,!1)}}:{a:function(){return i.matMul(u,e,!0,!0)},b:function(){return i.matMul(e,o,!0,!0)}}:{a:function(){return i.matMul(e,u,!1,!0)},b:function(){return i.matMul(o,e,!0,!1)}}}}})),s.register("5KHLt",(function(e,t){n(e.exports,"matMul",(function(){return d})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kglvN"),l=s("f1skK"),f=s("gldWN");var d=l.op({matMul_:function(e,t){var n,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],l=arguments.length>3&&void 0!==arguments[3]&&arguments[3],d=u.convertToTensor(e,"a","matMul"),p=u.convertToTensor(t,"b","matMul");n=r.default(o.makeTypesMatch(d,p),2),d=n[0],p=n[1],c.assert(d.rank>=2&&p.rank>=2&&d.rank===p.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, "+"got ranks ".concat(d.rank," and ").concat(p.rank,".")}));var h=s?d.shape[d.rank-2]:d.shape[d.rank-1],v=l?p.shape[p.rank-1]:p.shape[p.rank-2],g=s?d.shape[d.rank-1]:d.shape[d.rank-2],m=l?p.shape[p.rank-2]:p.shape[p.rank-1],y=d.shape.slice(0,-2),x=p.shape.slice(0,-2),b=c.sizeFromShape(y),k=c.sizeFromShape(x);c.assert(c.arraysEqual(y,x),(function(){return"Error in matMul: outer dimensions (".concat(y,") and (")+"".concat(x,") of Tensors with shapes ").concat(d.shape," and ")+"".concat(p.shape," must match.")})),c.assert(h===v,(function(){return"Error in matMul: inner shapes (".concat(h,") and (")+"".concat(v,") of Tensors with shapes ").concat(d.shape," and ")+"".concat(p.shape," and transposeA=").concat(s)+" and transposeB=".concat(l," must match.")}));var w=d.shape.slice(0,-2).concat([g,m]),A=s?f.reshape(d,[b,h,g]):f.reshape(d,[b,g,h]),E=l?f.reshape(p,[k,m,v]):f.reshape(p,[k,v,m]),C=function(e,t){return t([A,E]),e.batchMatMul(A,E,s,l)},S={a:A,b:E},N={transposeA:s,transposeB:l},T=a.ENGINE.runKernelFunc(C,S,null,i.BatchMatMul,N);return f.reshape(T,w)}})})),s.register("431hm",(function(e,t){n(e.exports,"batchToSpaceNDGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("h7Gux"),i={kernelName:r.BatchToSpaceND,gradFunc:function(e,t,n){var r=n.blockShape,i=n.crops;return{x:function(){return a.spaceToBatchND(e,r,i)}}}}})),s.register("h7Gux",(function(e,t){n(e.exports,"spaceToBatchND",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({spaceToBatchND_:function(e,t,n){var u=i.convertToTensor(e,"x","spaceToBatchND");o.assert(u.rank>=1+t.length,(function(){return"input rank ".concat(u.rank," should be > than [blockShape] ").concat(t.length)})),o.assert(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.assert(u.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e}),!0),(function(){return"input spatial dimensions ".concat(u.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var s={x:u},c={blockShape:t,paddings:n};return r.ENGINE.runKernelFunc((function(e){return e.spaceToBatchND(u,t,n)}),s,null,a.SpaceToBatchND,c)}})})),s.register("7gfxB",(function(e,t){n(e.exports,"broadcastToGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("2xCpB"),i={kernelName:r.BroadcastTo,gradFunc:function(e,t,n){for(var r=n,i=r.inputShape,o=r.shape,u=Array.from(o),s=i.length-1;s>=0;s--)if(i[s]===o[s])u[s]=1;else if(1!==i[s])throw new Error("broadcastTo(): [".concat(i,"] cannot be broadcast to [").concat(o,"]."));for(var c=[],l=0;l<u.length;l++)u[l]>1&&c.push(l);return{x:function(){return a.sum(e,c,!0)}}}}})),s.register("4YtsC",(function(e,t){n(e.exports,"castGradConfig",(function(){return r}));var r={kernelName:s("cvMH2").Cast,gradFunc:function(e){return{x:function(){return e.clone()}}}}})),s.register("8qks2",(function(e,t){n(e.exports,"ceilGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.Ceil,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("5PkjL",(function(e,t){n(e.exports,"clipByValueGradConfig",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("6Bgjr"),o=s("j0AHg"),u=s("7WLBj"),c=s("6FAlx"),l=s("8p3bZ"),f={kernelName:a.ClipByValue,inputsToSave:["x"],gradFunc:function(e,t,n){var a=r.default(t,1)[0],s=n.clipValueMin,f=n.clipValueMax;return{x:function(){return c.where(u.logicalAnd(i.greaterEqual(a,s),o.lessEqual(a,f)),e,l.zerosLike(e))}}}}})),s.register("6Bgjr",(function(e,t){n(e.exports,"greaterEqual",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({greaterEqual_:function(e,t){var n,s=u.convertToTensor(e,"a","greaterEqual"),l=u.convertToTensor(t,"b","greaterEqual");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e,t){var n=e.greaterEqual(s,l);return t([s,l]),n}),f,null,i.GreaterEqual)}})})),s.register("j0AHg",(function(e,t){n(e.exports,"lessEqual",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({lessEqual_:function(e,t){var n,s=u.convertToTensor(e,"a","lessEqual"),l=u.convertToTensor(t,"b","lessEqual");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e,t){var n=e.lessEqual(s,l);return t([s,l]),n}),f,null,i.LessEqual)}})})),s.register("7WLBj",(function(e,t){n(e.exports,"logicalAnd",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kNwIt");var u=s("f1skK").op({logicalAnd_:function(e,t){var n=i.convertToTensor(e,"a","logicalAnd","bool"),u=i.convertToTensor(t,"b","logicalAnd","bool");o.assertAndGetBroadcastShape(n.shape,u.shape);var s={a:n,b:u};return r.ENGINE.runKernelFunc((function(e){return e.logicalAnd(n,u)}),s,null,a.LogicalAnd)}})})),s.register("6FAlx",(function(e,t){n(e.exports,"where",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("kEXNH"),c=s("kNwIt");var l=s("f1skK").op({where_:function(e,t,n){var s=i.convertToTensor(t,"a","where"),l=i.convertToTensor(n,"b","where"),f=i.convertToTensor(e,"condition","where","bool"),d=c.assertAndGetBroadcastShape(s.shape,l.shape),p=u.broadcastTo(s,d),h=u.broadcastTo(l,d);1===f.rank&&o.assert(f.shape[0]===s.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})),1!==f.rank&&o.assertShapesMatch(f.shape,h.shape,"Error in where: ");var v={condition:f,t:p,e:h};return r.ENGINE.runKernelFunc((function(e,t){var n=e.select(f,p,h);return t([f]),n}),v,null,a.SelectV2)}})})),s.register("kEXNH",(function(e,t){n(e.exports,"broadcastTo",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("dOUsY"),u=s("f1skK"),c=s("gldWN");var l=u.op({broadcastTo_:function(e,t){var n=i.convertToTensor(e,"broadcastTo","x"),u=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var s=n.shape.slice();s.length<t.length;)s.unshift(1);n=c.reshape(n,s)}for(var l=n.shape,f=Array.from(t),d=t.length-1;d>=0;d--)if(l[d]===t[d])f[d]=1;else if(1!==n.shape[d])throw new Error("broadcastTo(): [".concat(u,"] cannot be broadcast to [").concat(t,"]."));if(0===f.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return o.clone(n);var p={x:n},h={shape:t,inputShape:l};return r.ENGINE.runKernelFunc((function(e){return e.tile(n,f)}),p,null,a.BroadcastTo,h)}})})),s.register("kdsaQ",(function(e,t){n(e.exports,"concatGradConfig",(function(){return o}));var r=s("cvMH2"),a=s("htMbZ"),i=s("kglvN"),o={kernelName:r.Concat,saveAllInputs:!0,gradFunc:function(e,t,n){var r=t.map((function(e){return e.shape})),o=n.axis,u=i.parseAxisParam(o,t[0].shape)[0],s=r.map((function(e){return e[u]}));return a.split(e,s,u).map((function(e){return function(){return e}}))}}})),s.register("htMbZ",(function(e,t){n(e.exports,"split",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("f1skK"),c=s("hP8ts");var l=u.op({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=i.convertToTensor(e,"x","split"),s=function(e,r){var a=o.parseAxisParam(n,u.shape)[0],i=c.prepareSplitSize(u,t,a);return e.split(u,i,a)},l={x:u},f={numOrSizeSplits:t,axis:n};return r.ENGINE.runKernelFunc(s,l,null,a.SplitV,f)}})})),s.register("hP8ts",(function(e,t){n(e.exports,"prepareSplitSize",(function(){return a}));var r=s("kglvN");function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=[];if("number"==typeof t)r.assert(e.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),a=new Array(t).fill(e.shape[n]/t);else{var i=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);r.assert(i<=1,(function(){return"There should be only one negative value in split array."}));var o=t.indexOf(-1);if(-1!==o){var u=t.reduce((function(e,t){return t>0?e+t:e}));t[o]=e.shape[n]-u}r.assert(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),a=t}return a}})),s.register("9qehG",(function(e,t){n(e.exports,"conv2DGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("hH7x5"),o=s("eWkFG"),u=s("drGuD"),c=s("kglvN"),l={kernelName:a.Conv2D,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var a=r.default(t,2),s=a[0],l=a[1],f=n.dilations,d=n.strides,p=n.pad,h=n.dataFormat;return c.assert(u.tupleValuesAreOne(f),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(f,"'")})),{x:function(){return o.conv2DBackpropInput(s.shape,e,l,d,p,h)},filter:function(){return i.conv2DBackpropFilter(s,e,l.shape,d,p,h)}}}}})),s.register("hH7x5",(function(e,t){n(e.exports,"conv2DBackpropFilter",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN"),o=s("drGuD"),u=s("f1skK"),c=s("gldWN");var l=u.op({conv2DBackpropFilter_:function(e,t,n,u,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=arguments.length>6?arguments[6]:void 0,d=e;3===e.rank&&(d=c.reshape(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var p=t;3===p.rank&&(p=c.reshape(t,[1,t.shape[0],t.shape[1],t.shape[2]])),i.assert(4===d.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(d.shape,".")})),i.assert(4===p.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(p.shape,".")})),i.assert(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var h="NHWC"===l?d.shape[3]:d.shape[1],v="NHWC"===l?p.shape[3]:p.shape[1];i.assert(h===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(h,") must ")+"match input depth in filter (".concat(n[2],".")})),i.assert(v===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(v,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=f&&i.assert(i.isInt(s),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(s,".")}));var g=function(e){var t=o.convertConv2DDataFormat(l),r=o.computeConv2DInfo(d.shape,n,u,1,s,f,!1,t);return e.conv2dDerFilter(d,p,r)},m={x:d,dy:p},y={strides:u,pad:s,dataFormat:l,dimRoundingMode:f};return r.ENGINE.runKernelFunc(g,m,null,a.Conv2DBackpropFilter,y)}})})),s.register("eWkFG",(function(e,t){n(e.exports,"conv2DBackpropInput",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN"),o=s("drGuD"),u=s("f1skK"),c=s("gldWN");var l=u.op({conv2DBackpropInput_:function(e,t,n,u,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=arguments.length>6?arguments[6]:void 0;i.assert(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var d=e,p=t,h=!1;3===t.rank&&(h=!0,p=c.reshape(t,[1,t.shape[0],t.shape[1],t.shape[2]]),d=[1,e[0],e[1],e[2]]),i.assert(4===d.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,".")})),i.assert(4===p.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(p.rank)})),i.assert(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var v="NHWC"===l?d[3]:d[1],g="NHWC"===l?p.shape[3]:p.shape[1];i.assert(v===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(v,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),i.assert(g===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(g,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=f&&i.assert(i.isInt(s),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(s,".")}));var m=function(e,t){var r=o.convertConv2DDataFormat(l),a=o.computeConv2DInfo(d,n.shape,u,1,s,f,!1,r),i=e.conv2dDerInput(p,n,a);return t([p,n]),i},y={dy:p,filter:n},x={strides:u,pad:s,dataFormat:l,dimRoundingMode:f,inputShape:d},b=r.ENGINE.runKernelFunc(m,y,null,a.Conv2DBackpropInput,x);return h?c.reshape(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})})),s.register("1EbUn",(function(e,t){n(e.exports,"conv2DBackpropInputGradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("dH9u6"),o=s("hH7x5"),u={kernelName:a.Conv2DBackpropInput,inputsToSave:["dy","filter"],gradFunc:function(e,t,n){var a=r.default(t,2),u=a[0],s=a[1],c=n.strides,l=n.pad,f=n.dataFormat,d=n.dimRoundingMode;return{dy:function(){return i.conv2d(e,s,c,l,f,1,d)},filter:function(){return o.conv2DBackpropFilter(e,u,s.shape,c,l,f,d)}}}}})),s.register("dH9u6",(function(e,t){n(e.exports,"conv2d",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=s("f1skK"),l=s("gldWN");var f=c.op({conv2d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,p=i.convertToTensor(e,"x","conv2d"),h=i.convertToTensor(t,"filter","conv2d"),v=p,g=!1;3===p.rank&&(g=!0,v=l.reshape(p,[1,p.shape[0],p.shape[1],p.shape[2]])),o.assert(4===v.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(v.rank,".")})),o.assert(4===h.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(h.rank,".")})),null!=d&&o.assert(o.isInt(s),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(s,".")}));var m="NHWC"===c?v.shape[3]:v.shape[1];o.assert(m===h.shape[2],(function(){return"Error in conv2d: depth of input (".concat(m,") must match ")+"input depth for filter ".concat(h.shape[2],".")})),o.assert(u.eitherStridesOrDilationsAreOne(n,f),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(f,"'")}));var y=function(e,t){var r=u.convertConv2DDataFormat(c),a=u.computeConv2DInfo(v.shape,h.shape,n,f,s,d,!1,r),i=e.conv2d(v,h,a);return t([v,h]),i},x={x:v,filter:h},b={strides:n,pad:s,dataFormat:c,dilations:f,dimRoundingMode:d},k=r.ENGINE.runKernelFunc(y,x,null,a.Conv2D,b);return g?l.reshape(k,[k.shape[1],k.shape[2],k.shape[3]]):k}})})),s.register("5YKNI",(function(e,t){n(e.exports,"conv3DGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("7cO1F"),o=s("iFTVM"),u=s("drGuD"),c=s("kglvN"),l={kernelName:a.Conv3D,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var a=n.dilations,s=n.strides,l=n.pad;c.assert(u.tupleValuesAreOne(a),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are "+"not yet supported in gradients. Got dilations '".concat(a,"'")}));var f=r.default(t,2),d=f[0],p=f[1];return{x:function(){return o.conv3DBackpropInput(d.shape,e,p,s,l)},filter:function(){return i.conv3DBackpropFilter(d,e,p.shape,s,l)}}}}})),s.register("7cO1F",(function(e,t){n(e.exports,"conv3DBackpropFilter",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN"),o=s("drGuD"),u=s("f1skK"),c=s("gldWN");var l=u.op({conv3DBackpropFilter_:function(e,t,n,u,s){var l=e;4===e.rank&&(l=c.reshape(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]));var f=t;4===f.rank&&(f=c.reshape(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]])),i.assert(5===l.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+"".concat(l.shape,".")})),i.assert(5===f.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+"".concat(f.shape,".")})),i.assert(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+"".concat(n,".")})),i.assert(l.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input ".concat(l.shape[4],") must ")+"match input depth in filter (".concat(n[3],".")})),i.assert(f.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy (".concat(f.shape[4],") must ")+"match output depth for filter (".concat(n[4],").")}));var d={x:l,y:f},p={strides:u,pad:s};return r.ENGINE.runKernelFunc((function(e){var t=o.computeConv3DInfo(l.shape,n,u,1,s);return e.conv3dDerFilter(l,f,t)}),d,null,a.Conv3DBackpropFilterV2,p)}})})),s.register("iFTVM",(function(e,t){n(e.exports,"conv3DBackpropInput",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN"),o=s("drGuD"),u=s("f1skK"),c=s("gldWN");var l=u.op({conv3DBackpropInput_:function(e,t,n,u,s){i.assert(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var l=e,f=t,d=!1;4===t.rank&&(d=!0,f=c.reshape(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]),l=[1,e[0],e[1],e[2],e[3]]);var p=l[4],h=f.shape[4];i.assert(5===l.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+"".concat(l.length,".")})),i.assert(5===f.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got "+"rank ".concat(f.rank)})),i.assert(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got "+"rank ".concat(n.rank)})),i.assert(p===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input (".concat(p,") must ")+"match input depth for filter ".concat(n.shape[3],".")})),i.assert(h===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output (".concat(h,") must ")+"match output depth for filter ".concat(n.shape[4],".")}));var v={dy:f},g={pad:s},m=r.ENGINE.runKernelFunc((function(e){var t=o.computeConv3DInfo(l,n.shape,u,1,s);return e.conv3dDerInput(f,n,t)}),v,null,a.Conv3DBackpropInputV2,g);return d?c.reshape(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}})})),s.register("gVS0M",(function(e,t){n(e.exports,"cosGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("j0e1k"),u=s("ee0Eu"),c=s("hHkhi"),l={kernelName:a.Cos,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.mul(u.neg(c.sin(i.cast(n,"float32"))),e)}}}}})),s.register("hHkhi",(function(e,t){n(e.exports,"sin",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({sin_:function(e){var t=i.convertToTensor(e,"x","sin"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),n,null,a.Sin)}})})),s.register("277p7",(function(e,t){n(e.exports,"coshGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("j0e1k"),u=s("kPryz"),c={kernelName:a.Cosh,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.mul(u.sinh(i.cast(n,"float32")),e)}}}}})),s.register("kPryz",(function(e,t){n(e.exports,"sinh",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({sinh_:function(e){var t=i.convertToTensor(e,"x","sinh"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),n,null,a.Sinh)}})})),s.register("2uzV9",(function(e,t){n(e.exports,"cumsumGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("4RRNB"),o=s("bjxnt"),u=s("9PS5J"),c={kernelName:a.Cumsum,inputsToSave:["x"],gradFunc:function(e,t,n){var a=r.default(t,1)[0],s=n.axis,c=n.exclusive,l=n.reverse;return{x:function(){var t=i.getAxesPermutation([s],a.rank),n=o.cumsum(e,s,c,!l);return null!=t&&(n=u.transpose(n,t)),n}}}}})),s.register("bjxnt",(function(e,t){n(e.exports,"cumsum",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("4RRNB"),u=s("f1skK"),c=s("9PS5J");var l=u.op({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=i.convertToTensor(e,"x","cumsum"),l=function(e,r){var a=o.getAxesPermutation([t],s.rank),i=s;null!=a&&(i=c.transpose(s,a));var l=o.getInnerMostAxes(1,s.rank)[0],f=e.cumsum(i,l,n,u);if(r([s]),null!=a){var d=o.getUndoAxesPermutation(a);f=c.transpose(f,d)}return f},f={x:s},d={axis:t,exclusive:n,reverse:u};return r.ENGINE.runKernelFunc(l,f,null,a.Cumsum,d)}})})),s.register("23SLU",(function(e,t){n(e.exports,"depthwiseConv2dNativeGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("drGuD"),o=s("apWCa"),u=s("aY1tG"),c=s("kglvN"),l={kernelName:a.DepthwiseConv2dNative,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var a=n.dilations,s=n.strides,l=n.pad,f=n.dimRoundingMode,d=null==a?[1,1]:a;c.assert(i.tupleValuesAreOne(d),(function(){return"Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(d,"'")}));var p=r.default(t,2),h=p[0],v=p[1];c.assert(4===h.rank,(function(){return"Error in gradient of depthwiseConv2dNative: input must be "+"rank 4, but got rank ".concat(h.rank,".")})),c.assert(4===v.rank,(function(){return"Error in gradient of depthwiseConv2dNative: filter must be "+"rank 4, but got rank ".concat(v.rank,".")})),c.assert(h.shape[3]===v.shape[2],(function(){return"Error in gradient of depthwiseConv2d: number of input "+"channels (".concat(h.shape[3],") must match the inChannels dimension ")+"in filter ".concat(v.shape[2],".")})),c.assert(i.eitherStridesOrDilationsAreOne(s,d),(function(){return"Error in gradient of depthwiseConv2d: Either strides or "+"dilations must be  1. Got strides ".concat(s," and dilations ")+"'".concat(d,"'.")})),null!=f&&c.assert(c.isInt(l),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(l,".")}));var g=i.computeConv2DInfo(h.shape,v.shape,s,d,l,f,!0);return{x:function(){return u.depthwiseConv2dNativeBackpropInput(h.shape,e,v,g)},filter:function(){return o.depthwiseConv2dNativeBackpropFilter(h,e,v.shape,g)}}}}})),s.register("apWCa",(function(e,t){n(e.exports,"depthwiseConv2dNativeBackpropFilter",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("f1skK"),o=s("gldWN");var u=i.op({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,i){var u=e;3===e.rank&&(u=o.reshape(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var s=t;3===s.rank&&(s=o.reshape(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={x:u,dy:s};return r.ENGINE.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(u,s,i)}),c,null,a.DepthwiseConv2dNativeBackpropFilter)}})})),s.register("aY1tG",(function(e,t){n(e.exports,"depthwiseConv2dNativeBackpropInput",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("f1skK"),o=s("gldWN");var u=i.op({depthwiseConv2dNativeBackpropInput_:function(e,t,n,i){var u=t,s=!1;3===t.rank&&(s=!0,u=o.reshape(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var c={dy:u},l=r.ENGINE.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(u,n,i)}),c,null,a.DepthwiseConv2dNativeBackpropInput);return s?o.reshape(l,[l.shape[1],l.shape[2],l.shape[3]]):l}})})),s.register("2vxvE",(function(e,t){n(e.exports,"dilation2dGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o={kernelName:i.Dilation2D,inputsToSave:["x","filter"],gradFunc:function(e,t,n){var o=r.default(t,2),u=o[0],s=o[1],c={x:u,filter:s,dy:e},l={x:u,filter:s,dy:e};return{x:function(){return a.ENGINE.runKernel(i.Dilation2DBackpropInput,c,n)},filter:function(){return a.ENGINE.runKernel(i.Dilation2DBackpropFilter,l,n)}}}}})),s.register("eqk6I",(function(e,t){n(e.exports,"divGradConfig",(function(){return h})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("782ce"),u=s("6baO0"),c=s("j0e1k"),l=s("ee0Eu"),f=s("gldWN"),d=s("4C8ia"),p=s("2xCpB"),h={kernelName:a.Div,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],h=i.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=u.div(e,o.cast(s,"float32")),n=i.getReductionAxes(a.shape,h);return n.length>0?f.reshape(p.sum(t,n),a.shape):t},b:function(){var t=c.mul(e,o.cast(a,"float32")),n=i.getReductionAxes(s.shape,h);n.length>0&&(t=f.reshape(p.sum(t,n),s.shape));var r=d.square(s);return l.neg(u.div(t,o.cast(r,"float32")))}}}}})),s.register("lKYBS",(function(e,t){n(e.exports,"eluGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o={kernelName:i.Elu,outputsToSave:[!0],gradFunc:function(e,t){var n=r.default(t,1)[0],o=function(t){return t.eluDer(e,n)},u={dy:e,y:n};return{x:function(){return a.ENGINE.runKernelFunc(o,u,null,i.EluGrad)}}}}})),s.register("ioDbU",(function(e,t){n(e.exports,"erfGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("byJMV"),o=s("j0e1k"),u=s("ee0Eu"),c=s("4C8ia"),l={kernelName:a.Erf,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0],a=o.mul(i.exp(u.neg(c.square(n))),2/Math.sqrt(Math.PI));return{x:function(){return o.mul(e,a)}}}}})),s.register("byJMV",(function(e,t){n(e.exports,"exp",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({exp_:function(e){var t=i.convertToTensor(e,"x","exp"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),n,null,a.Exp)}})})),s.register("aPSyU",(function(e,t){n(e.exports,"expGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o={kernelName:a.Exp,outputsToSave:[!0],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.mul(e,n)}}}}})),s.register("4PEpk",(function(e,t){n(e.exports,"expm1GradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("byJMV"),o=s("j0e1k"),u={kernelName:a.Expm1,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.mul(e,i.exp(n))}}}}})),s.register("1GJoU",(function(e,t){n(e.exports,"floorGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.Floor,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("9l5vS",(function(e,t){n(e.exports,"floorDivGradConfig",(function(){return h})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("782ce"),u=s("6baO0"),c=s("j0e1k"),l=s("ee0Eu"),f=s("gldWN"),d=s("4C8ia"),p=s("2xCpB"),h={kernelName:a.FloorDiv,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],h=i.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=u.div(e,o.cast(s,"float32")),n=i.getReductionAxes(a.shape,h);return n.length>0?f.reshape(p.sum(t,n),a.shape):t},b:function(){var t=c.mul(e,o.cast(a,"float32")),n=i.getReductionAxes(s.shape,h);n.length>0&&(t=f.reshape(p.sum(t,n),s.shape));var r=d.square(s);return l.neg(u.div(t,o.cast(r,"float32")))}}}}})),s.register("g6Jb3",(function(e,t){n(e.exports,"fusedBatchNormGradConfig",(function(){return v})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("b3Qcj"),o=s("kNwIt"),u=s("j0e1k"),c=s("gldWN"),l=s("giife"),f=s("bftEy"),d=s("fZE7S"),p=s("2xCpB"),h=s("kP8JI"),v={kernelName:a.FusedBatchNorm,inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var a=n.varianceEpsilon,s=r.default(t,4),v=s[0],g=s[1],m=s[2],y=s[3],x=null==y?f.scalar(1):y,b=o.getReductionAxes(g.shape,v.shape),k=[];if(1===g.rank){for(var w=0;w<v.shape.length-1;++w)k.push(v.shape[w]);k.push(1)}var A=d.sub(v,g),E=u.mul(e,x),C=l.rsqrt(i.add(m,f.scalar(a))),S=u.mul(u.mul(u.mul(C,C),C),f.scalar(-.5));return{x:function(){return 1===g.rank?c.reshape(u.mul(u.mul(e,h.tile(c.reshape(C,[1,1,1,g.shape[0]]),k)),x),v.shape):c.reshape(u.mul(u.mul(e,C),x),v.shape)},mean:function(){var e=u.mul(u.mul(C,f.scalar(-1)),E);return 1===g.rank&&(e=p.sum(e,b)),c.reshape(e,g.shape)},variance:function(){var e=u.mul(u.mul(S,A),E);return 1===g.rank&&(e=p.sum(e,b)),c.reshape(e,g.shape)},scale:function(){var t=u.mul(A,C),n=u.mul(e,t);return 1===g.rank&&(n=p.sum(n,b)),c.reshape(n,g.shape)},offset:function(){var t=e;return 1===g.rank&&(t=p.sum(t,b)),c.reshape(t,g.shape)}}}}})),s.register("giife",(function(e,t){n(e.exports,"rsqrt",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({rsqrt_:function(e){var t=i.convertToTensor(e,"x","rsqrt"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),n,null,a.Rsqrt)}})})),s.register("kP8JI",(function(e,t){n(e.exports,"tile",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({tile_:function(e,t){var n=i.convertToTensor(e,"x","tile",null);o.assert(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var u=[n],s={x:n},c={reps:t};return r.ENGINE.runKernelFunc((function(e,r){var a=e.tile(n,t);return r([n]),a}),s,null,a.Tile,c,u)}})})),s.register("5pxGR",(function(e,t){n(e.exports,"gatherGradConfig",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("4RRNB"),o=s("gldWN"),u=s("9PS5J"),c=s("h4byS"),l=s("kglvN"),f={kernelName:a.GatherV2,inputsToSave:["x","indices"],gradFunc:function(e,t,n){var a=r.default(t,2),s=a[0],f=a[1],h=n.axis,v=l.parseAxisParam(h,s.shape)[0];return{x:function(){var t=s.shape,n=f.size,r=t.slice(0,v),a=r.length,l=t.slice(h,t.length).slice(1),g=l.length,m=d(0,a),y=d(a+1,a+1+g),x=p([r,[n],l]),b=o.reshape(e,x),k=o.reshape(f,[n]),w=p([[a],m,y]),A=u.transpose(b,w),E=c.unsortedSegmentSum(A,k,s.shape[v]),C=i.getUndoAxesPermutation(w);return E=u.transpose(E,C)},indices:function(){return f}}}};function d(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function p(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}})),s.register("h4byS",(function(e,t){n(e.exports,"unsortedSegmentSum",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({unsortedSegmentSum_:function(e,t,n){var u=i.convertToTensor(e,"x","unsortedSegmentSum"),s=i.convertToTensor(t,"segmentIds","unsortedSegmentSum","int32");o.assert(o.isInt(n),(function(){return"numSegments must be of dtype int"}));var c={x:u,segmentIds:s},l={numSegments:n};return r.ENGINE.runKernelFunc((function(e,t){var r=e.unsortedSegmentSum(u,s,n);return t([s]),r}),c,null,a.UnsortedSegmentSum,l)}})})),s.register("2lJZz",(function(e,t){n(e.exports,"greaterEqualGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("8p3bZ"),o={kernelName:a.GreaterEqual,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],o=n[1];return{a:function(){return i.zerosLike(a)},b:function(){return i.zerosLike(o)}}}}})),s.register("cNbMP",(function(e,t){n(e.exports,"identityGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("782ce"),i={kernelName:r.Identity,gradFunc:function(e){return{x:function(){return a.cast(e,"float32")}}}}})),s.register("6UTnq",(function(e,t){n(e.exports,"isFiniteGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.IsFinite,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("5igHw",(function(e,t){n(e.exports,"isInfGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.IsInf,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("c9jDQ",(function(e,t){n(e.exports,"isNanGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.IsNan,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("2Xrqn",(function(e,t){n(e.exports,"log1pGradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("b3Qcj"),o=s("6baO0"),u={kernelName:a.Log1p,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.div(e,i.add(n,1))}}}}})),s.register("cDLOS",(function(e,t){n(e.exports,"logGradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6baO0"),u={kernelName:a.Log,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.div(e,i.cast(n,"float32"))}}}}})),s.register("44Yns",(function(e,t){n(e.exports,"logSoftmaxGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("byJMV"),o=s("j0e1k"),u=s("fZE7S"),c=s("2xCpB"),l={kernelName:a.LogSoftmax,inputsToSave:[],outputsToSave:[!0],gradFunc:function(e,t,n){var a=r.default(t,1)[0],s=n.axis;return{logits:function(){var t=i.exp(a);return u.sub(e,o.mul(c.sum(e,s,!0),t))}}}}})),s.register("l1V6Q",(function(e,t){n(e.exports,"lrnGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("25iUx"),o={kernelName:a.LRN,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var a=r.default(t,2),o=a[0],u=a[1],s=n.depthRadius,c=n.bias,l=n.alpha,f=n.beta;return{x:function(){return i.localResponseNormalizationBackprop(o,u,e,s,c,l,f)}}}}})),s.register("25iUx",(function(e,t){n(e.exports,"localResponseNormalizationBackprop",(function(){return i}));var r=s("1dnDT"),a=s("cvMH2");var i=s("f1skK").op({localResponseNormalizationBackprop_:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:.5,c=function(r){return r.LRNGrad(n,e,t,i,o,u,s)},l={x:e,y:t,dy:n},f={depthRadius:i,bias:o,alpha:u,beta:s};return r.ENGINE.runKernelFunc(c,l,null,a.LRNBackprop,f)}})})),s.register("baIQW",(function(e,t){n(e.exports,"maxGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("4RRNB"),o=s("9PS5J"),u=s("kglvN"),c=s("b3oXK"),l={kernelName:a.Max,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var a=n.reductionIndices,s=r.default(t,2),l=s[0],f=s[1],d=u.parseAxisParam(a,l.shape),p=i.getAxesPermutation(d,l.rank),h=c.gradForMinAndMax(e,f,l,d,p);return{x:function(){var e=h.x();return null!=p&&(e=o.transpose(e)),e}}}}})),s.register("b3oXK",(function(e,t){n(e.exports,"gradForMinAndMax",(function(){return l}));var r=s("4RRNB"),a=s("782ce"),i=s("iuFae"),o=s("j0e1k"),u=s("gldWN"),c=s("9PS5J");function l(e,t,n,s,l){return t.rank<n.rank&&(t=u.reshape(t,r.expandShapeToKeepDim(t.shape,s))),e.rank<n.rank&&(e=u.reshape(e,r.expandShapeToKeepDim(e.shape,s))),{x:function(){var r=o.mul(e,a.cast(i.equal(n,t),e.dtype));return null==l?r:c.transpose(r,l)}}}})),s.register("iuFae",(function(e,t){n(e.exports,"equal",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({equal_:function(e,t){var n,s=u.convertToTensor(e,"a","equal"),l=u.convertToTensor(t,"b","equal");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e){return e.equal(s,l)}),f,null,i.Equal)}})})),s.register("1p8ad",(function(e,t){n(e.exports,"maximumGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6Bgjr"),u=s("dKHZ2"),c=s("j0e1k"),l={kernelName:a.Maximum,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1];return{a:function(){return c.mul(e,i.cast(o.greaterEqual(a,s),"float32"))},b:function(){return c.mul(e,i.cast(u.less(a,s),"float32"))}}}}})),s.register("dKHZ2",(function(e,t){n(e.exports,"less",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({less_:function(e,t){var n,s=u.convertToTensor(e,"a","less"),l=u.convertToTensor(t,"b","less");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e){return e.less(s,l)}),f,null,i.Less)}})})),s.register("fCjRI",(function(e,t){n(e.exports,"maxPool3DGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("aP4Hv"),o={kernelName:a.MaxPool3D,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var a=r.default(t,2),o=a[0],u=a[1],s=n.filterSize,c=n.strides,l=n.dilations,f=n.pad,d=n.dimRoundingMode,p=null==l?[1,1,1]:l;return{x:function(){return i.maxPool3dBackprop(e,o,u,s,c,p,f,d)}}}}})),s.register("aP4Hv",(function(e,t){n(e.exports,"maxPool3dBackprop",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=s("f1skK"),l=s("gldWN");var f=c.op({maxPool3dBackprop_:function(e,t,n,s,c){var f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],d=arguments.length>6?arguments[6]:void 0,p=arguments.length>7?arguments[7]:void 0,h=i.convertToTensor(e,"dy","maxPool3dBackprop"),v=i.convertToTensor(t,"input","maxPool3dBackprop"),g=i.convertToTensor(n,"output","maxPool3dBackprop"),m=h,y=v,x=g,b=!1;4===v.rank&&(b=!0,m=l.reshape(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]]),y=l.reshape(v,[1,v.shape[0],v.shape[1],v.shape[2],v.shape[3]]),x=l.reshape(g,[1,g.shape[0],g.shape[1],g.shape[2],g.shape[3]])),o.assert(5===m.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+"".concat(m.rank,".")})),o.assert(5===y.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+"".concat(y.rank,".")})),o.assert(5===x.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+"".concat(x.rank,".")})),o.assert(u.eitherStridesOrDilationsAreOne(c,f),(function(){return"Error in maxPool3dBackprop: Either strides or dilations "+"must be 1. Got strides ".concat(c," and dilations '").concat(f,"'")})),null!=p&&o.assert(o.isInt(d),(function(){return"Error in maxPool3dBackprop: pad must be an integer when "+"using, dimRoundingMode ".concat(p," but got pad ").concat(d,".")}));var k=function(e){var t=u.computePool3DInfo(y.shape,s,c,f,d,p);return e.maxPool3dBackprop(m,y,x,t)},w={dy:m,input:y,output:x},A={filterSize:s,strides:c,dilations:f,pad:d,dimRoundingMode:p},E=r.ENGINE.runKernelFunc(k,w,null,a.MaxPool3DBackprop,A);return b?l.reshape(E,[E.shape[1],E.shape[2],E.shape[3],E.shape[4]]):E}})})),s.register("4ebM0",(function(e,t){n(e.exports,"maxPoolGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("srFZX"),o={kernelName:a.MaxPool,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var a=r.default(t,2),o=a[0],u=a[1],s=n.filterSize,c=n.strides,l=n.pad;return{x:function(){return i.maxPoolBackprop(e,o,u,s,c,l)}}}}})),s.register("srFZX",(function(e,t){n(e.exports,"maxPoolBackprop",(function(){return c}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD");var c=s("f1skK").op({maxPoolBackprop_:function(e,t,n,s,c,l,f){var d=i.convertToTensor(e,"dy","maxPoolBackprop"),p=i.convertToTensor(t,"input","maxPoolBackprop"),h=i.convertToTensor(n,"output","maxPoolBackprop");o.assert(p.rank===d.rank,(function(){return"Rank of input (".concat(p.rank,") does not match rank of dy ")+"(".concat(d.rank,")")})),o.assert(4===d.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+"".concat(d.rank,".")})),o.assert(4===p.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+"".concat(p.rank,".")})),null!=f&&o.assert(o.isInt(l),(function(){return"Error in maxPoolBackprop: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(l,".")}));var v={dy:d,input:p,output:h},g={filterSize:s,strides:c,pad:l,dimRoundingMode:f};return r.ENGINE.runKernelFunc((function(e){var t=u.computePool2DInfo(p.shape,s,c,1,l,f);return e.maxPoolBackprop(d,p,h,t)}),v,null,a.MaxPoolBackprop,g)}})})),s.register("kluJF",(function(e,t){n(e.exports,"minGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("4RRNB"),o=s("9PS5J"),u=s("kglvN"),c=s("b3oXK"),l={kernelName:a.Min,inputsToSave:["x"],outputsToSave:[!0],gradFunc:function(e,t,n){var a=n.axis,s=r.default(t,2),l=s[0],f=s[1],d=u.parseAxisParam(a,l.shape),p=i.getAxesPermutation(d,l.rank),h=c.gradForMinAndMax(e,f,l,d,p);return{x:function(){var e=h.x();return null!=p&&(e=o.transpose(e)),e}}}}})),s.register("8pDEH",(function(e,t){n(e.exports,"minimumGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("ejjI8"),u=s("j0AHg"),c=s("j0e1k"),l={kernelName:a.Minimum,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1];return{a:function(){return c.mul(e,i.cast(u.lessEqual(a,s),"float32"))},b:function(){return c.mul(e,i.cast(o.greater(a,s),"float32"))}}}}})),s.register("ejjI8",(function(e,t){n(e.exports,"greater",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({greater_:function(e,t){var n,s=u.convertToTensor(e,"a","greater"),l=u.convertToTensor(t,"b","greater");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e){return e.greater(s,l)}),f,null,i.Greater)}})})),s.register("3lSBZ",(function(e,t){n(e.exports,"modGradConfig",(function(){return p})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("6baO0"),u=s("ksyR5"),c=s("j0e1k"),l=s("ee0Eu"),f=s("gldWN"),d=s("2xCpB"),p={kernelName:a.Mod,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],p=i.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=i.getReductionAxes(a.shape,p);return t.length>0?f.reshape(d.sum(e,t),a.shape):e},b:function(){var t=c.mul(e,l.neg(u.floor(o.div(a,s)))),n=i.getReductionAxes(s.shape,p);return n.length>0?f.reshape(d.sum(t,n),s.shape):t}}}}})),s.register("ksyR5",(function(e,t){n(e.exports,"floor",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({floor_:function(e){var t=i.convertToTensor(e,"x","floor"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.floor(t)}),n,null,a.Floor)}})})),s.register("Jz5MQ",(function(e,t){n(e.exports,"multiplyGradConfig",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("782ce"),u=s("j0e1k"),c=s("gldWN"),l=s("2xCpB"),f={kernelName:a.Multiply,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],f=i.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=u.mul(e,o.cast(s,"float32")),n=i.getReductionAxes(a.shape,f);return n.length>0?c.reshape(l.sum(t,n),a.shape):t},b:function(){var t=u.mul(e,o.cast(a,"float32")),n=i.getReductionAxes(s.shape,f);return n.length>0?c.reshape(l.sum(t,n),s.shape):t}}}}})),s.register("57Act",(function(e,t){n(e.exports,"negateGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("ee0Eu"),i={kernelName:r.Negate,gradFunc:function(e){return{x:function(){return a.neg(e)}}}}})),s.register("D7D3s",(function(e,t){n(e.exports,"oneHotGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("ilMKa"),i={kernelName:r.OneHot,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return a.zeros(n.shape,"float32")}}}}})),s.register("ilMKa",(function(e,t){n(e.exports,"zeros",(function(){return o}));var r=s("1dnDT"),a=s("kglvN"),i=s("3IcUj");function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=o(e,"float32"),u=o(e,"float32");return i.complex(n,u)}var s=a.makeZerosTypedArray(a.sizeFromShape(e),t);return r.ENGINE.makeTensor(s,e,t)}})),s.register("9xIBt",(function(e,t){n(e.exports,"onesLikeGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.OnesLike,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("2xrRx",(function(e,t){n(e.exports,"padV2GradConfig",(function(){return i}));var r=s("cvMH2"),a=s("jPaTA"),i={kernelName:r.PadV2,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],i=n.paddings.map((function(e){return e[0]}));return{x:function(){return a.slice(e,i,r.shape)}}}}})),s.register("jPaTA",(function(e,t){n(e.exports,"slice",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("lcVC1"),u=s("f1skK"),c=s("aK0eq");var l=u.op({slice_:function(e,t,n){var u=o.convertToTensor(e,"x","slice");if(0===u.rank)throw new Error("Slicing scalar is not possible");var s=r.default(c.parseSliceParams(u,t,n),2),l=s[0],f=s[1];c.assertParamsValid(u,l,f);var d={x:u},p={begin:t,size:n};return a.ENGINE.runKernelFunc((function(e,t){return t([u]),e.slice(u,l,f)}),d,null,i.Slice,p)}})})),s.register("aK0eq",(function(e,t){n(e.exports,"assertParamsValid",(function(){return i})),n(e.exports,"maskToAxes",(function(){return o})),n(e.exports,"computeOutShape",(function(){return u})),n(e.exports,"stridesWithElidedDims",(function(){return c})),n(e.exports,"getNormalizedAxes",(function(){return d})),n(e.exports,"startIndicesWithElidedDims",(function(){return p})),n(e.exports,"stopIndicesWithElidedDims",(function(){return h})),n(e.exports,"startForAxis",(function(){return g})),n(e.exports,"stopForAxis",(function(){return m})),n(e.exports,"stridesForAxis",(function(){return v})),n(e.exports,"isSliceContinous",(function(){return y})),n(e.exports,"computeFlatOffset",(function(){return x})),n(e.exports,"parseSliceParams",(function(){return b})),s("1i51P");var r=s("9M1dW"),a=s("kglvN");function i(e,t,n){var r=function(r){a.assert(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice".concat(e.rank,"D: begin[").concat(r,"] + size[").concat(r,"] ")+"(".concat(t[r]+n[r],") would overflow input.shape[").concat(r,"] (").concat(e.shape[r],")")}))};a.assert(e.rank===t.length,(function(){return"Error in slice".concat(e.rank,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(e.rank,").")})),a.assert(e.rank===n.length,(function(){return"Error in slice".concat(e.rank,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(e.rank,").")}));for(var i=0;i<e.rank;++i)r(i)}function o(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function u(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function c(e,t,n,a){for(var i=r.default(e),o=i.length;o<a.length;o++)i.push(1);for(var u=0;u<n;u++)0===u?i[t]=1:(i.splice(t,0,1),i.pop());return i}function l(e,t,n){return n<=e?n:n-(t-1)}function f(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function d(e,t,n,r,a,i,o,u,s){var l=e.length,f=new Array(l),d=new Array(l),y=new Array(l);if(t.length&&n>0){var x=t[0],b=n+1;f=p(o,x,b,r,e),d=h(u,x,b,a,e),y=c(i,x,b,e)}else for(var k=0;k<l;k++)f[k]=g(o,r,i,e,k,s),d[k]=m(u,a,i,e,k,s),y[k]=v(i,k,s);return{begin:f,end:d,strides:y}}function p(e,t,n,a,i){for(var o=r.default(i),u=f(n,t),s=0;s<o.length;s++)if(u.indexOf(s)>-1)o[s]=0;else{var c=l(t,n,s),d=a[c];e&1<<c&&(d=0),o[s]=d}return o}function h(e,t,n,i,o){for(var u=r.default(o),s=f(n,t),c=0;c<u.length;c++)if(s.indexOf(c)>-1)u[c]=Number.MAX_SAFE_INTEGER;else{var d=l(t,n,c),p=i[d];e&1<<d&&(p=Number.MAX_SAFE_INTEGER),u[c]=p}for(var h=0;h<u.length;h++){var v=o[h];u[h]<0&&(u[h]+=v),u[h]=a.clamp(0,u[h],o[h])}return u}function v(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function g(e,t,n,r,i,o){var u=t[i],s=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var c=r[i];return u<0&&(u+=c),u=a.clamp(0,u,c-1)}function m(e,t,n,r,i,o){var u=t[i],s=n[i]||1;(e&1<<i||o&1<<i||null==u)&&(u=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var c=r[i];return u<0&&(u+=c),u=s>0?a.clamp(0,u,c):a.clamp(-1,u,c-1)}function y(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function x(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function b(e,t,n){var i,o;return(i="number"==typeof t?[t].concat(r.default(new Array(e.rank-1).fill(0))):t.length<e.rank?t.concat(new Array(e.rank-t.length).fill(0)):t.slice()).forEach((function(e){a.assert(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),o=(o=null==n?new Array(e.rank).fill(-1):"number"==typeof n?[n].concat(r.default(new Array(e.rank-1).fill(-1))):n.length<e.rank?n.concat(new Array(e.rank-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(a.assert(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-i[n])})),[i,o]}})),s.register("eIh3i",(function(e,t){n(e.exports,"powGradConfig",(function(){return y})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("782ce"),u=s("ejjI8"),c=s("WSSiT"),l=s("j0e1k"),f=s("WvbbQ"),d=s("gldWN"),p=s("bftEy"),h=s("fZE7S"),v=s("2xCpB"),g=s("6FAlx"),m=s("8p3bZ"),y={kernelName:a.Pow,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:function(e,t){var n=r.default(t,3),a=n[0],s=n[1],y=n[2],x=a,b=s,k=i.assertAndGetBroadcastShape(x.shape,b.shape);return{a:function(){var t=o.cast(b,"float32"),n=l.mul(e,l.mul(t,f.pow(x,h.sub(t,p.scalar(1))))),r=i.getReductionAxes(x.shape,k);return r.length>0&&(n=v.sum(n,r)),d.reshape(n,x.shape)},b:function(){var t=u.greater(x,0),n=g.where(t,c.log(x),m.zerosLike(x)),r=l.mul(e,l.mul(y,n)),a=i.getReductionAxes(b.shape,k);return a.length>0&&(r=v.sum(r,a)),d.reshape(r,b.shape)}}}}})),s.register("WSSiT",(function(e,t){n(e.exports,"log",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({log_:function(e){var t=i.convertToTensor(e,"x","log"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),n,null,a.Log)}})})),s.register("WvbbQ",(function(e,t){n(e.exports,"pow",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({pow_:function(e,t){var n,s=u.convertToTensor(e,"base","pow"),c=u.convertToTensor(t,"exp","pow");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.pow(s,c);return t([s,c,n]),n}),l,null,i.Pow)}})})),s.register("6vdXF",(function(e,t){n(e.exports,"preluGradConfig",(function(){return p})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("ejjI8"),u=s("j0e1k"),c=s("gldWN"),l=s("2xCpB"),f=s("6FAlx"),d=s("8p3bZ"),p={kernelName:a.Prelu,inputsToSave:["x","alpha"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],p=o.greater(a,0);return{x:function(){return f.where(p,e,u.mul(e,s))},alpha:function(){var t=f.where(p,d.zerosLike(e),u.mul(e,a)),n=i.getReductionAxes(s.shape,e.shape);return n.length>0&&(t=l.sum(t,n)),c.reshape(t,s.shape)}}}}})),s.register("fBdM2",(function(e,t){n(e.exports,"reciprocalGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("6baO0"),o=s("ee0Eu"),u=s("4C8ia"),c={kernelName:a.Reciprocal,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.div(e,o.neg(u.square(n)))}}}}})),s.register("3vVAh",(function(e,t){n(e.exports,"relu6GradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("j0AHg"),u=s("j0e1k"),c=s("lWKd3"),l={kernelName:a.Relu6,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0],a=u.mul(o.lessEqual(n,6),c.step(n));return{x:function(){return u.mul(e,i.cast(a,"float32"))}}}}})),s.register("kcVUh",(function(e,t){n(e.exports,"reluGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("j0e1k"),u=s("lWKd3"),c={kernelName:a.Relu,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.mul(e,i.cast(u.step(n),"float32"))}}}}})),s.register("gNur9",(function(e,t){n(e.exports,"reshapeGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("gldWN"),o={kernelName:a.Reshape,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.reshape(e,n.shape)}}}}})),s.register("25SUP",(function(e,t){n(e.exports,"resizeBilinearGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o={kernelName:i.ResizeBilinear,inputsToSave:["images"],gradFunc:function(e,t,n){var o=r.default(t,1)[0],u=function(t){var r=n.alignCorners;return t.resizeBilinearBackprop(e,o,r)},s={images:o};return{images:function(){return a.ENGINE.runKernelFunc(u,s,null,i.ResizeBilinearGrad,n)}}}}})),s.register("8QHx3",(function(e,t){n(e.exports,"resizeNearestNeighborGradConfig",(function(){return o})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o={kernelName:i.ResizeNearestNeighbor,inputsToSave:["images"],gradFunc:function(e,t,n){var o=r.default(t,1)[0],u=function(t){var r=n.alignCorners;return t.resizeNearestNeighborBackprop(e,o,r)},s={images:o};return{images:function(){return a.ENGINE.runKernelFunc(u,s,null,i.ResizeNearestNeighborGrad,n)}}}}})),s.register("eCdCS",(function(e,t){n(e.exports,"reverseGradConfig",(function(){return o}));var r=s("cvMH2"),a=s("hYjAM"),i=s("kglvN"),o={kernelName:r.Reverse,gradFunc:function(e,t,n){var r=n.dims,o=i.parseAxisParam(r,e.shape);return{x:function(){return a.reverse(e,o)}}}}})),s.register("hYjAM",(function(e,t){n(e.exports,"reverse",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("dOUsY"),c=s("f1skK"),l=s("gldWN");var f=c.op({reverse_:function(e,t){var n=i.convertToTensor(e,"x","reverse"),s={x:n},c={dims:t};return r.ENGINE.runKernelFunc((function(e){var r=o.parseAxisParam(t,n.shape);if(0===n.rank)return u.clone(n);var a=e.reverse(n,r);return l.reshape(a,n.shape)}),s,null,a.Reverse,c)}})})),s.register("jZSjo",(function(e,t){n(e.exports,"roundGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.Round,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("5DlQ8",(function(e,t){n(e.exports,"rsqrtGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("6baO0"),o=s("j0e1k"),u=s("ee0Eu"),c=s("WvbbQ"),l={kernelName:a.Rsqrt,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return u.neg(i.div(e,o.mul(c.pow(n,1.5),2)))}}}}})),s.register("jWm6K",(function(e,t){n(e.exports,"selectV2PoolGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("1bFci"),u=s("j0e1k"),c=s("8p3bZ"),l={kernelName:a.SelectV2,inputsToSave:["condition"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{condition:function(){return i.cast(c.zerosLike(n),"float32")},t:function(){return u.mul(e,i.cast(n,e.dtype))},e:function(){return u.mul(e,i.cast(o.logicalNot(n),e.dtype))}}}}})),s.register("1bFci",(function(e,t){n(e.exports,"logicalNot",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({logicalNot_:function(e){var t=i.convertToTensor(e,"x","logicalNot","bool"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.logicalNot(t)}),n,null,a.LogicalNot)}})})),s.register("4jq6O",(function(e,t){n(e.exports,"seluGradConfig",(function(){return p})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("byJMV"),u=s("ejjI8"),c=s("j0e1k"),l=s("bftEy"),f=s("gT6fB"),d=s("6FAlx"),p={kernelName:a.Selu,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){var t=u.greater(n,l.scalar(0)),r=l.scalar(f.SELU_SCALEALPHA),a=l.scalar(f.SELU_SCALE),s=c.mul(e,a),p=c.mul(c.mul(e,r),o.exp(i.cast(n,"float32")));return d.where(t,s,p)}}}}})),s.register("gT6fB",(function(e,t){n(e.exports,"SELU_SCALEALPHA",(function(){return r})),n(e.exports,"SELU_SCALE",(function(){return a}));var r=1.7580993408473768,a=1.0507009873554805})),s.register("03id1",(function(e,t){n(e.exports,"sigmoidGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o=s("bftEy"),u=s("fZE7S"),c={kernelName:a.Sigmoid,outputsToSave:[!0],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.mul(e,i.mul(n,u.sub(o.scalar(1),n)))}}}}})),s.register("9TGgL",(function(e,t){n(e.exports,"signGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.Sign,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("2oAw8",(function(e,t){n(e.exports,"sinGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("9D7bL"),u=s("j0e1k"),c={kernelName:a.Sin,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return u.mul(o.cos(i.cast(n,"float32")),e)}}}}})),s.register("9D7bL",(function(e,t){n(e.exports,"cos",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({cos_:function(e){var t=i.convertToTensor(e,"x","cos"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),n,null,a.Cos)}})})),s.register("4ptMz",(function(e,t){n(e.exports,"sinhGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("hmI2F"),u=s("j0e1k"),c={kernelName:a.Sinh,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return u.mul(o.cosh(i.cast(n,"float32")),e)}}}}})),s.register("hmI2F",(function(e,t){n(e.exports,"cosh",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({cosh_:function(e){var t=i.convertToTensor(e,"x","cosh"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),n,null,a.Cosh)}})})),s.register("4tzvL",(function(e,t){n(e.exports,"sliceGradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("elYe2"),o=s("aK0eq"),u={kernelName:a.Slice,inputsToSave:["x"],gradFunc:function(e,t,n){for(var a=r.default(t,1)[0],u=n.begin,s=n.size,c=a.shape,l=r.default(o.parseSliceParams(a,u,s),2),f=l[0],d=l[1],p=[],h=0;h<e.rank;h++)p.push([f[h],c[h]-f[h]-d[h]]);return{x:function(){return i.pad(e,p)}}}}})),s.register("elYe2",(function(e,t){n(e.exports,"pad",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=i.convertToTensor(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var u=function(e,r){return r([o]),e.pad(o,t,n)},s={paddings:t,constantValue:n},c={x:o};return r.ENGINE.runKernelFunc(u,c,null,a.PadV2,s)}})})),s.register("h4mO5",(function(e,t){n(e.exports,"softmaxGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o=s("fZE7S"),u=s("2xCpB"),c={kernelName:a.Softmax,outputsToSave:[!0],gradFunc:function(e,t,n){var a=r.default(t,1)[0],s=n.dim,c=i.mul(e,a);return{logits:function(){return o.sub(c,i.mul(u.sum(c,[s],true),a))}}}}})),s.register("53zFQ",(function(e,t){n(e.exports,"softplusGradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o=s("5uQwR"),u={kernelName:a.Softplus,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.mul(e,o.sigmoid(n))}}}}})),s.register("5uQwR",(function(e,t){n(e.exports,"sigmoid",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({sigmoid_:function(e){var t=i.convertToTensor(e,"x","sigmoid"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),n,null,a.Sigmoid)}})})),s.register("nY2fZ",(function(e,t){n(e.exports,"spaceToBatchNDGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("fiGYl"),i={kernelName:r.SpaceToBatchND,gradFunc:function(e,t,n){var r=n.blockShape,i=n.paddings;return{x:function(){return a.batchToSpaceND(e,r,i)}}}}})),s.register("fiGYl",(function(e,t){n(e.exports,"batchToSpaceND",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({batchToSpaceND_:function(e,t,n){var u=i.convertToTensor(e,"x","batchToSpaceND"),s=t.reduce((function(e,t){return e*t}));o.assert(u.rank>=1+t.length,(function(){return"input rank is ".concat(u.rank," but should be > than blockShape.length ").concat(t.length)})),o.assert(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.assert(u.shape[0]%s==0,(function(){return"input tensor batch is ".concat(u.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(s)}));var c={x:u},l={blockShape:t,crops:n};return r.ENGINE.runKernelFunc((function(e){return e.batchToSpaceND(u,t,n)}),c,null,a.BatchToSpaceND,l)}})})),s.register("hX7T9",(function(e,t){n(e.exports,"splitVGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("6hkW8"),i={kernelName:r.SplitV,gradFunc:function(e,t,n){var r=n.axis;return{x:function(){return a.concat(e,r)}}}}})),s.register("6hkW8",(function(e,t){n(e.exports,"concat",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("9MLLM"),c=s("f1skK"),l=s("616DT");var f=c.op({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;o.assert(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=i.convertToTensorArray(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))}));var s=o.parseAxisParam(t,n[0].shape)[0],c=u.computeOutShape(n.map((function(e){return e.shape})),s);if(0===o.sizeFromShape(c))return l.tensor([],c);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var f=n.map((function(e){return e.shape}));u.assertParamsConsistent(f,s);var d=function(e,t){var r=e.concat(n,s);return t(n),r},p=n,h={axis:t};return r.ENGINE.runKernelFunc(d,p,null,a.Concat,h)}})})),s.register("9MLLM",(function(e,t){n(e.exports,"assertParamsConsistent",(function(){return a})),n(e.exports,"computeOutShape",(function(){return i}));var r=s("kglvN");function a(e,t){var n=e[0].length;e.forEach((function(e,t){r.assert(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),r.assert(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var a=e[0];e.forEach((function(e,i){for(var o=0;o<n;o++)r.assert(o===t||e[o]===a[o],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(i,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(a,") ")+"along the non-concatenated axis ".concat(i,".")}))}))}function i(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}})),s.register("eri5d",(function(e,t){n(e.exports,"sqrtGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("6baO0"),u=s("j0e1k"),c=s("buy0T"),l={kernelName:a.Sqrt,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.div(e,u.mul(c.sqrt(i.cast(n,"float32")),2))}}}}})),s.register("8CZoQ",(function(e,t){n(e.exports,"squareGradConfig",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("782ce"),o=s("j0e1k"),u={kernelName:a.Square,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.mul(e,o.mul(i.cast(n,"float32"),2))}}}}})),s.register("4Z2tW",(function(e,t){n(e.exports,"squaredDifferenceGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o=s("bftEy"),u=s("fZE7S"),c={kernelName:a.SquaredDifference,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],c=o.scalar(2);return{a:function(){return i.mul(e,i.mul(c,u.sub(a,s)))},b:function(){return i.mul(e,i.mul(c,u.sub(s,a)))}}}}})),s.register("57aKI",(function(e,t){n(e.exports,"stepGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.Step,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("6WuX5",(function(e,t){n(e.exports,"subGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("kNwIt"),o=s("ee0Eu"),u=s("gldWN"),c=s("2xCpB"),l={kernelName:a.Sub,inputsToSave:["a","b"],gradFunc:function(e,t){var n=r.default(t,2),a=n[0],s=n[1],l=i.assertAndGetBroadcastShape(a.shape,s.shape);return{a:function(){var t=e,n=i.getReductionAxes(a.shape,l);return n.length>0&&(t=c.sum(t,n)),u.reshape(t,a.shape)},b:function(){var t=e,n=i.getReductionAxes(s.shape,l);return n.length>0&&(t=c.sum(t,n)),u.reshape(o.neg(t),s.shape)}}}}})),s.register("acOdm",(function(e,t){n(e.exports,"sumGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o=s("6XDPM"),u=s("gldWN"),c=s("kglvN"),l={kernelName:a.Sum,inputsToSave:["x"],gradFunc:function(e,t,n){var a=r.default(t,1)[0],s=a.shape.slice(),l=n.axis;c.parseAxisParam(l,a.shape).forEach((function(e){s[e]=1}));var f=u.reshape(e,s),d=i.mul(f,o.ones(a.shape,"float32"));return{x:function(){return d}}}}})),s.register("6XDPM",(function(e,t){n(e.exports,"ones",(function(){return u}));var r=s("1dnDT"),a=s("kglvN"),i=s("3IcUj"),o=s("ilMKa");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=u(e,"float32"),s=o.zeros(e,"float32");return i.complex(n,s)}var c=a.makeOnesTypedArray(a.sizeFromShape(e),t);return r.ENGINE.makeTensor(c,e,t)}})),s.register("53dUL",(function(e,t){n(e.exports,"tanGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("9D7bL"),o=s("6baO0"),u=s("4C8ia"),c={kernelName:a.Tan,inputsToSave:["x"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return o.div(e,u.square(i.cos(n)))}}}}})),s.register("j4Ir3",(function(e,t){n(e.exports,"tanhGradConfig",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("j0e1k"),o=s("bftEy"),u=s("4C8ia"),c=s("fZE7S"),l={kernelName:a.Tanh,outputsToSave:[!0],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return i.mul(c.sub(o.scalar(1),u.square(n)),e)}}}}})),s.register("2YU3f",(function(e,t){n(e.exports,"tileGradConfig",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("b3Qcj"),o=s("jPaTA"),u=s("8p3bZ"),c={kernelName:a.Tile,inputsToSave:["x"],gradFunc:function(e,t,n){var a=r.default(t,1)[0],s=n.reps;return{x:function(){var t=u.zerosLike(a);if(1===a.rank)for(var n=0;n<s[0];++n)t=i.add(t,o.slice(e,[n*a.shape[0]],[a.shape[0]]));else if(2===a.rank)for(var r=0;r<s[0];++r)for(var c=0;c<s[1];++c)t=i.add(t,o.slice(e,[r*a.shape[0],c*a.shape[1]],[a.shape[0],a.shape[1]]));else if(3===a.rank)for(var l=0;l<s[0];++l)for(var f=0;f<s[1];++f)for(var d=0;d<s[2];++d)t=i.add(t,o.slice(e,[l*a.shape[0],f*a.shape[1],d*a.shape[2]],[a.shape[0],a.shape[1],a.shape[2]]));else{if(4!==a.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+"".concat(a.rank," tensors yet."));for(var p=0;p<s[0];++p)for(var h=0;h<s[1];++h)for(var v=0;v<s[2];++v)for(var g=0;g<s[3];++g)t=i.add(t,o.slice(e,[p*a.shape[0],h*a.shape[1],v*a.shape[2],g*a.shape[3]],[a.shape[0],a.shape[1],a.shape[2],a.shape[3]]))}return t}}}}})),s.register("lUXJf",(function(e,t){n(e.exports,"transposeGradConfig",(function(){return o}));var r=s("cvMH2"),a=s("4RRNB"),i=s("9PS5J"),o={kernelName:r.Transpose,gradFunc:function(e,t,n){var r=n.perm,o=a.getUndoAxesPermutation(r);return{x:function(){return i.transpose(e,o)}}}}})),s.register("hsYp4",(function(e,t){n(e.exports,"unpackGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("biSQf"),i={kernelName:r.Unpack,gradFunc:function(e,t,n){var r=n.axis;return{value:function(){return a.stack(e,r)}}}}})),s.register("biSQf",(function(e,t){n(e.exports,"stack",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("6hkW8"),o=s("fwOP6");var u=s("f1skK").op({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r.convertToTensorArray(e,"tensors","stack");if(a.assert(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return o.expandDims(n[0],t);var u=n[0].rank,s=n[0].shape,c=n[0].dtype;a.assert(t<=u,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){a.assertShapesMatch(s,e.shape,"All tensors passed to stack must have matching shapes"),a.assert(c===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var l=n.map((function(e){return o.expandDims(e,t)}));return i.concat(l,t)}})})),s.register("fwOP6",(function(e,t){n(e.exports,"expandDims",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("gldWN");var u=i.op({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=null,i=r.convertToTensor(e,"x","expandDims",n);a.assert(t<=i.rank,(function(){return"Axis must be <= rank of the tensor"}));var u=i.shape.slice();return t<0&&(a.assert(-(i.rank+1)<=t,(function(){return"Axis must be in the interval [".concat(-(i.rank+1),", ").concat(i.rank,"]")})),t=i.rank+t+1),u.splice(t,0,1),o.reshape(i,u)}})})),s.register("6wPR5",(function(e,t){n(e.exports,"unsortedSegmentSumGradConfig",(function(){return v})),s("1i51P");var r=s("6vecG"),a=s("cvMH2"),i=s("fwOP6"),o=s("17OvF"),u=s("6Bgjr"),c=s("7WLBj"),l=s("k7Du7"),f=s("6XDPM"),d=s("bftEy"),p=s("6FAlx"),h=s("8p3bZ"),v={kernelName:a.UnsortedSegmentSum,inputsToSave:["segmentIds"],gradFunc:function(e,t){var n=r.default(t,1)[0];return{x:function(){return function(e,t){for(var n=l.maximum(t,h.zerosLike(t)),r=o.gather(e,n),a=u.greaterEqual(t,d.scalar(0,"int32")),s=r.rank-a.rank,v=0;v<s;++v)a=i.expandDims(a,v+1);a=c.logicalAnd(a,f.ones(r.shape,"bool"));var g=h.zerosLike(r);return p.where(a,r,g)}(e,n)}}}}})),s.register("17OvF",(function(e,t){n(e.exports,"gather",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("f1skK"),c=s("gldWN"),l=s("gXhQh");var f=u.op({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=i.convertToTensor(e,"x","gather"),s=i.convertToTensor(t,"indices","gather","int32"),f={x:u,indices:s},d={axis:n},p=function(e,t){var r=o.parseAxisParam(n,u.shape)[0],a=l.collectGatherOpShapeInfo(u,s,r),i=e.gather(u,c.reshape(s,[s.size]),r);return t([u,s]),c.reshape(i,a.outputShape)};return r.ENGINE.runKernelFunc(p,f,null,a.GatherV2,d)}})})),s.register("gXhQh",(function(e,t){n(e.exports,"segOpComputeOptimalWindowSize",(function(){return i})),n(e.exports,"computeOutShape",(function(){return o})),n(e.exports,"collectGatherOpShapeInfo",(function(){return u}));var r=s("kglvN"),a=s("cut2C");function i(e,t){var n,i=!1;for(e<=a.PARALLELIZE_THRESHOLD?(n=e,i=!0):n=r.nearestDivisor(e,Math.floor(Math.sqrt(e)));!i;)n>t||n===e?i=!0:n=r.nearestDivisor(e,n+1);return n}function o(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function u(e,t,n){for(var r=e.shape[n],a=[],i=1,o=1,u=0;u<n;u++)a.push(e.shape[u]),i*=e.shape[u];for(var s=0;s<t.rank;s++)a.push(t.shape[s]);for(var c=n+1;c<e.rank;c++)a.push(e.shape[c]),o*=e.shape[c];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}})),s.register("cut2C",(function(e,t){n(e.exports,"PARALLELIZE_THRESHOLD",(function(){return a})),n(e.exports,"computeOptimalWindowSize",(function(){return i}));var r=s("kglvN"),a=30;function i(e){return e<=a?e:r.nearestDivisor(e,Math.floor(Math.sqrt(e)))}})),s.register("k7Du7",(function(e,t){n(e.exports,"maximum",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt"),l=s("782ce");var f=s("f1skK").op({maximum_:function(e,t){var n,s=u.convertToTensor(e,"a","maximum"),f=u.convertToTensor(t,"b","maximum");n=r.default(o.makeTypesMatch(s,f),2),s=n[0],f=n[1],"bool"===s.dtype&&(s=l.cast(s,"int32"),f=l.cast(f,"int32")),c.assertAndGetBroadcastShape(s.shape,f.shape);var d={a:s,b:f};return a.ENGINE.runKernelFunc((function(e,t){var n=e.maximum(s,f);return t([s,f]),n}),d,null,i.Maximum)}})})),s.register("dShLg",(function(e,t){n(e.exports,"zerosLikeGradConfig",(function(){return i}));var r=s("cvMH2"),a=s("8p3bZ"),i={kernelName:r.ZerosLike,gradFunc:function(e){return{x:function(){return a.zerosLike(e)}}}}})),s.register("2Lolk",(function(e,t){s("hwyvt"),s("gNpl8"),s("9CthG"),s("f8qZD"),s("4XzGG"),s("jhqh3"),s("6ca2P"),s("4VWHH"),s("41uN2"),s("3XTF9"),s("3NbCW"),s("3iTu7"),s("9BHKS"),s("8FzNk"),s("e4Q2w"),s("2BMO9"),s("llveq"),s("6YTzx"),s("7wwAP"),s("k4OMZ"),s("b84pO"),s("eHCEi"),s("dqUPm"),s("38soh"),s("kEJem"),s("6De5d"),s("l0ymt"),s("eQBXB"),s("ehav6"),s("mGrZ4"),s("ksmG2"),s("jBr3X"),s("lTg6p"),s("az5Lk"),s("cW4Cq"),s("hG2hR"),s("i27uK"),s("hd9Gu"),s("c15zI"),s("lganq"),s("iUTkU"),s("1FdsZ"),s("9hVdo"),s("c5mSJ"),s("bO5yI"),s("9mMu3"),s("dxDy9"),s("4yjxw"),s("cszJQ"),s("19gxJ"),s("7T3xE"),s("A0CbI"),s("8tWoF"),s("b75AL"),s("7vXim"),s("6609F"),s("74B9q"),s("cs6Yb"),s("9yVb8"),s("ez68x"),s("TUoW1"),s("bXgt9"),s("biCW7"),s("jmvdB"),s("8a14h"),s("42H0k"),s("fQsx5"),s("60Lvw"),s("aNRro"),s("4WKT5"),s("vqz9V"),s("d4PvU"),s("7p8b8"),s("funaN"),s("8AXld"),s("jiygW"),s("bvjLz"),s("gtZiz"),s("aHTbo"),s("i3Yqy"),s("020of"),s("SFzUR"),s("3NDxA"),s("9wHBk"),s("3rnEY"),s("glVbo"),s("2g1QF"),s("hBwdE"),s("4Irv0"),s("2TUAc"),s("brv6v"),s("3czH4"),s("8VBtX"),s("fIWOU"),s("jHPbT"),s("jxlr2"),s("7rUqg"),s("bspV4"),s("2MKSo"),s("7fSb2"),s("4ieGD"),s("94Js2"),s("kaUgU"),s("hfAXI"),s("f4FvN"),s("buiNI"),s("4GWE0"),s("at5c5"),s("esbpE"),s("i6TwW"),s("lSRAT"),s("b3Ahf"),s("8SdkN"),s("7KHNx"),s("6xrkP"),s("ibZze"),s("fGJxj"),s("gGqDX"),s("kBHdp"),s("aB4KZ"),s("cSXEJ"),s("gnbds"),s("kub3L"),s("dlwZD"),s("9JczD"),s("hgVLg"),s("hvvV7"),s("hogxP"),s("46a1z"),s("2VwSk"),s("b3zXR"),s("22fJG"),s("iyCvC"),s("dNLCh"),s("dmRkm"),s("dZA8w"),s("43tqC"),s("fDDut"),s("3g8cU"),s("5PhAK"),s("5qnA3"),s("3jrGi"),s("aHTEN"),s("41T4P"),s("bS0Iz"),s("1b7KT"),s("fC9P4"),s("jHjSX"),s("6OFZh")})),s.register("hwyvt",(function(e,t){s("j2ViA");var n=s("3gUC5");s("4JvjV").Tensor.prototype.abs=function(){return this.throwIfDisposed(),n.abs(this)}})),s.register("j2ViA",(function(t,r){n(t.exports,"spectral",(function(){return K})),n(t.exports,"signal",(function(){return X})),n(t.exports,"image",(function(){return Y})),n(t.exports,"linalg",(function(){return Q})),n(t.exports,"losses",(function(){return Z})),n(t.exports,"abs",(function(){return s("3gUC5").abs})),n(t.exports,"acos",(function(){return s("4JdlT").acos})),n(t.exports,"acosh",(function(){return s("deh8x").acosh})),n(t.exports,"add",(function(){return s("b3Qcj").add})),n(t.exports,"addN",(function(){return s("1XItt").addN})),n(t.exports,"all",(function(){return s("d6rwS").all})),n(t.exports,"any",(function(){return s("a7Ldu").any})),n(t.exports,"argMax",(function(){return s("9UQ7R").argMax})),n(t.exports,"argMin",(function(){return s("8wukb").argMin})),n(t.exports,"asin",(function(){return s("6jOGJ").asin})),n(t.exports,"asinh",(function(){return s("ilRXh").asinh})),n(t.exports,"atan",(function(){return s("1KNQy").atan})),n(t.exports,"atan2",(function(){return s("hL6PI").atan2})),n(t.exports,"atanh",(function(){return s("9MsjU").atanh})),n(t.exports,"avgPool",(function(){return s("WcUsE").avgPool})),n(t.exports,"avgPool3d",(function(){return s("4laI6").avgPool3d})),n(t.exports,"basicLSTMCell",(function(){return s("25qxf").basicLSTMCell})),n(t.exports,"batchToSpaceND",(function(){return s("fiGYl").batchToSpaceND})),n(t.exports,"batchNorm",(function(){return s("7oZFS").batchNorm})),n(t.exports,"batchNorm2d",(function(){return s("1wkm4").batchNorm2d})),n(t.exports,"batchNorm3d",(function(){return s("7qMEf").batchNorm3d})),n(t.exports,"batchNorm4d",(function(){return s("3bI6J").batchNorm4d})),n(t.exports,"broadcastTo",(function(){return s("kEXNH").broadcastTo})),n(t.exports,"buffer",(function(){return s("8orDI").buffer})),n(t.exports,"cast",(function(){return s("782ce").cast})),n(t.exports,"ceil",(function(){return s("fecqZ").ceil})),n(t.exports,"clipByValue",(function(){return s("djUTy").clipByValue})),n(t.exports,"clone",(function(){return s("dOUsY").clone})),n(t.exports,"complex",(function(){return s("3IcUj").complex})),n(t.exports,"concat",(function(){return s("6hkW8").concat})),n(t.exports,"concat1d",(function(){return s("7dix2").concat1d})),n(t.exports,"concat2d",(function(){return s("it0uc").concat2d})),n(t.exports,"concat3d",(function(){return s("lC5hh").concat3d})),n(t.exports,"concat4d",(function(){return s("2Iobd").concat4d})),n(t.exports,"conv1d",(function(){return s("ceZj5").conv1d})),n(t.exports,"conv2d",(function(){return s("dH9u6").conv2d})),n(t.exports,"conv2dTranspose",(function(){return s("1DPo2").conv2dTranspose})),n(t.exports,"conv3d",(function(){return s("bxgT2").conv3d})),n(t.exports,"conv3dTranspose",(function(){return s("63G10").conv3dTranspose})),n(t.exports,"cos",(function(){return s("9D7bL").cos})),n(t.exports,"cosh",(function(){return s("hmI2F").cosh})),n(t.exports,"cumsum",(function(){return s("bjxnt").cumsum})),n(t.exports,"depthToSpace",(function(){return s("46h8X").depthToSpace})),n(t.exports,"depthwiseConv2d",(function(){return s("btnhd").depthwiseConv2d})),n(t.exports,"diag",(function(){return s("j7yAW").diag})),n(t.exports,"dilation2d",(function(){return s("8h0Lc").dilation2d})),n(t.exports,"div",(function(){return s("6baO0").div})),n(t.exports,"divNoNan",(function(){return s("1DCIn").divNoNan})),n(t.exports,"dot",(function(){return s("7UdNs").dot})),n(t.exports,"elu",(function(){return s("gGOj0").elu})),n(t.exports,"equal",(function(){return s("iuFae").equal})),n(t.exports,"erf",(function(){return s("c5hEb").erf})),n(t.exports,"exp",(function(){return s("byJMV").exp})),n(t.exports,"expandDims",(function(){return s("fwOP6").expandDims})),n(t.exports,"expm1",(function(){return s("lX82t").expm1})),n(t.exports,"eye",(function(){return s("lyVnl").eye})),n(t.exports,"fill",(function(){return s("jwnkA").fill})),n(t.exports,"floor",(function(){return s("ksyR5").floor})),n(t.exports,"floorDiv",(function(){return s("cisxn").floorDiv})),n(t.exports,"gather",(function(){return s("17OvF").gather})),n(t.exports,"greater",(function(){return s("ejjI8").greater})),n(t.exports,"greaterEqual",(function(){return s("6Bgjr").greaterEqual})),n(t.exports,"imag",(function(){return s("hXj3N").imag})),n(t.exports,"isFinite",(function(){return s("j3cEz").isFinite})),n(t.exports,"isInf",(function(){return s("cFDTG").isInf})),n(t.exports,"isNaN",(function(){return s("d4DaY").isNaN})),n(t.exports,"leakyRelu",(function(){return s("1LZgP").leakyRelu})),n(t.exports,"less",(function(){return s("dKHZ2").less})),n(t.exports,"lessEqual",(function(){return s("j0AHg").lessEqual})),n(t.exports,"linspace",(function(){return s("dPpnl").linspace})),n(t.exports,"localResponseNormalization",(function(){return s("jq1h8").localResponseNormalization})),n(t.exports,"log",(function(){return s("WSSiT").log})),n(t.exports,"log1p",(function(){return s("3rEkq").log1p})),n(t.exports,"logSigmoid",(function(){return s("imK0S").logSigmoid})),n(t.exports,"logSoftmax",(function(){return s("bYmSd").logSoftmax})),n(t.exports,"logSumExp",(function(){return s("acLJn").logSumExp})),n(t.exports,"logicalAnd",(function(){return s("7WLBj").logicalAnd})),n(t.exports,"logicalNot",(function(){return s("1bFci").logicalNot})),n(t.exports,"logicalOr",(function(){return s("49dpo").logicalOr})),n(t.exports,"logicalXor",(function(){return s("fiOos").logicalXor})),n(t.exports,"matMul",(function(){return s("5KHLt").matMul})),n(t.exports,"max",(function(){return s("avJI0").max})),n(t.exports,"maxPool",(function(){return s("2dPgQ").maxPool})),n(t.exports,"maxPool3d",(function(){return s("181UU").maxPool3d})),n(t.exports,"maxPoolWithArgmax",(function(){return s("lsNiP").maxPoolWithArgmax})),n(t.exports,"maximum",(function(){return s("k7Du7").maximum})),n(t.exports,"mean",(function(){return s("4804C").mean})),n(t.exports,"min",(function(){return s("cGC0n").min})),n(t.exports,"minimum",(function(){return s("eu81x").minimum})),n(t.exports,"mod",(function(){return s("hQKIK").mod})),n(t.exports,"moments",(function(){return s("bRIeS").moments})),n(t.exports,"mul",(function(){return s("j0e1k").mul})),n(t.exports,"multiRNNCell",(function(){return s("lV6Sm").multiRNNCell})),n(t.exports,"multinomial",(function(){return s("1SpQu").multinomial})),n(t.exports,"neg",(function(){return s("ee0Eu").neg})),n(t.exports,"notEqual",(function(){return s("7owLz").notEqual})),n(t.exports,"oneHot",(function(){return s("9ZTJv").oneHot})),n(t.exports,"ones",(function(){return s("6XDPM").ones})),n(t.exports,"onesLike",(function(){return s("4z0yD").onesLike})),n(t.exports,"outerProduct",(function(){return s("9rcKy").outerProduct})),n(t.exports,"pad",(function(){return s("elYe2").pad})),n(t.exports,"pad1d",(function(){return s("lIW56").pad1d})),n(t.exports,"pad2d",(function(){return s("cc4Di").pad2d})),n(t.exports,"pad3d",(function(){return s("iSlCw").pad3d})),n(t.exports,"pad4d",(function(){return s("6THdB").pad4d})),n(t.exports,"pool",(function(){return s("l6jFw").pool})),n(t.exports,"pow",(function(){return s("WvbbQ").pow})),n(t.exports,"prelu",(function(){return s("9JCtR").prelu})),n(t.exports,"print",(function(){return s("i4HMG").print})),n(t.exports,"prod",(function(){return s("iGcXf").prod})),n(t.exports,"rand",(function(){return s("aOJMk").rand})),n(t.exports,"randomGamma",(function(){return s("l1WmC").randomGamma})),n(t.exports,"randomNormal",(function(){return s("5Qmo8").randomNormal})),n(t.exports,"randomUniform",(function(){return s("1GxQM").randomUniform})),n(t.exports,"range",(function(){return s("jlvqc").range})),n(t.exports,"real",(function(){return s("2acG6").real})),n(t.exports,"reciprocal",(function(){return s("1FDpf").reciprocal})),n(t.exports,"relu",(function(){return s("2MKa7").relu})),n(t.exports,"relu6",(function(){return s("83Plb").relu6})),n(t.exports,"reshape",(function(){return s("gldWN").reshape})),n(t.exports,"reverse",(function(){return s("hYjAM").reverse})),n(t.exports,"reverse1d",(function(){return s("hUanB").reverse1d})),n(t.exports,"reverse2d",(function(){return s("eRHoj").reverse2d})),n(t.exports,"reverse3d",(function(){return s("43t4p").reverse3d})),n(t.exports,"reverse4d",(function(){return s("fG12c").reverse4d})),n(t.exports,"round",(function(){return s("8Irjk").round})),n(t.exports,"rsqrt",(function(){return s("giife").rsqrt})),n(t.exports,"scalar",(function(){return s("bftEy").scalar})),n(t.exports,"selu",(function(){return s("lKM5m").selu})),n(t.exports,"separableConv2d",(function(){return s("jHQP9").separableConv2d})),n(t.exports,"setdiff1dAsync",(function(){return s("fFUjj").setdiff1dAsync})),n(t.exports,"sigmoid",(function(){return s("5uQwR").sigmoid})),n(t.exports,"sign",(function(){return s("d10y4").sign})),n(t.exports,"sin",(function(){return s("hHkhi").sin})),n(t.exports,"sinh",(function(){return s("kPryz").sinh})),n(t.exports,"slice",(function(){return s("jPaTA").slice})),n(t.exports,"slice1d",(function(){return s("djXCd").slice1d})),n(t.exports,"slice2d",(function(){return s("dd8tD").slice2d})),n(t.exports,"slice3d",(function(){return s("2KAsd").slice3d})),n(t.exports,"slice4d",(function(){return s("jxscz").slice4d})),n(t.exports,"softmax",(function(){return s("etmQx").softmax})),n(t.exports,"softplus",(function(){return s("eQuwX").softplus})),n(t.exports,"spaceToBatchND",(function(){return s("h7Gux").spaceToBatchND})),n(t.exports,"fft",(function(){return s("casYn").fft})),n(t.exports,"ifft",(function(){return s("eBkYt").ifft})),n(t.exports,"irfft",(function(){return s("dvCn4").irfft})),n(t.exports,"rfft",(function(){return s("8x9VA").rfft})),n(t.exports,"split",(function(){return s("htMbZ").split})),n(t.exports,"sqrt",(function(){return s("buy0T").sqrt})),n(t.exports,"square",(function(){return s("4C8ia").square})),n(t.exports,"squaredDifference",(function(){return s("lfNC8").squaredDifference})),n(t.exports,"squeeze",(function(){return s("4y8cw").squeeze})),n(t.exports,"stack",(function(){return s("biSQf").stack})),n(t.exports,"step",(function(){return s("lWKd3").step})),n(t.exports,"stridedSlice",(function(){return s("fTdnV").stridedSlice})),n(t.exports,"sub",(function(){return s("fZE7S").sub})),n(t.exports,"sum",(function(){return s("2xCpB").sum})),n(t.exports,"tan",(function(){return s("jc2CK").tan})),n(t.exports,"tanh",(function(){return s("lzRoG").tanh})),n(t.exports,"tensor",(function(){return s("616DT").tensor})),n(t.exports,"tensor1d",(function(){return s("5J0XY").tensor1d})),n(t.exports,"tensor2d",(function(){return s("bqdMI").tensor2d})),n(t.exports,"tensor3d",(function(){return s("a5FCc").tensor3d})),n(t.exports,"tensor4d",(function(){return s("a0S6X").tensor4d})),n(t.exports,"tensor5d",(function(){return s("1JEgs").tensor5d})),n(t.exports,"tensor6d",(function(){return s("9aiVe").tensor6d})),n(t.exports,"tile",(function(){return s("kP8JI").tile})),n(t.exports,"topk",(function(){return s("1jhOm").topk})),n(t.exports,"truncatedNormal",(function(){return s("dqB3G").truncatedNormal})),n(t.exports,"unsortedSegmentSum",(function(){return s("h4byS").unsortedSegmentSum})),n(t.exports,"unstack",(function(){return s("6jWCC").unstack})),n(t.exports,"variable",(function(){return s("4ETT0").variable})),n(t.exports,"where",(function(){return s("6FAlx").where})),n(t.exports,"whereAsync",(function(){return s("cxotR").whereAsync})),n(t.exports,"zeros",(function(){return s("ilMKa").zeros})),n(t.exports,"zerosLike",(function(){return s("8p3bZ").zerosLike})),n(t.exports,"op",(function(){return s("f1skK").op})),n(t.exports,"OP_SCOPE_SUFFIX",(function(){return s("f1skK").OP_SCOPE_SUFFIX})),n(t.exports,"fused",(function(){return s("lGvfM")}));var a=s("8x9VA"),i=s("casYn"),o=s("eBkYt"),u=s("dvCn4"),c=(s("lGvfM"),s("87y9E")),l=s("60SBN"),f=s("6tFHu"),d=s("jvUWC"),p=s("l22S7"),h=s("jinyt"),v=s("75VXs"),g=s("hvgy1"),m=s("dqyru"),y=s("kwUk5"),x=s("dpvlk"),b=s("29f6i"),k=s("iiKqT"),w=s("em9A1"),A=s("1Wdii"),E=s("btsCn"),C=s("52rtn"),S=s("2yUOI"),N=s("7t46p"),T=s("2v1rL"),D=s("8sCZS"),F=s("aNtPC"),O=s("cFDc5"),_=s("kxzAB"),I=s("M5LBI"),R=s("c5h4Q"),M=s("3IAqt"),B=(s("3gUC5"),s("4JdlT"),s("deh8x"),s("b3Qcj"),s("1XItt"),s("d6rwS"),s("a7Ldu"),s("9UQ7R"),s("8wukb"),s("6jOGJ"),s("ilRXh"),s("1KNQy"),s("hL6PI"),s("9MsjU"),s("WcUsE"),s("4laI6"),s("25qxf"),s("fiGYl"),s("7oZFS"),s("1wkm4"),s("7qMEf"),s("3bI6J"),s("kEXNH"),s("8orDI"),s("782ce"),s("fecqZ"),s("djUTy"),s("dOUsY"),s("3IcUj"),s("6hkW8"),s("7dix2"),s("it0uc"),s("lC5hh"),s("2Iobd"),s("ceZj5"),s("dH9u6"),s("1DPo2"),s("bxgT2"),s("63G10"),s("9D7bL"),s("hmI2F"),s("bjxnt"),s("46h8X"),s("btnhd"),s("j7yAW"),s("8h0Lc"),s("6baO0"),s("1DCIn"),s("7UdNs"),s("gGOj0"),s("iuFae"),s("c5hEb"),s("byJMV"),s("fwOP6"),s("lX82t"),s("lyVnl"),s("jwnkA"),s("ksyR5"),s("cisxn"),s("17OvF"),s("ejjI8"),s("6Bgjr"),s("hXj3N"),s("j3cEz"),s("cFDTG"),s("d4DaY"),s("1LZgP"),s("dKHZ2"),s("j0AHg"),s("dPpnl"),s("jq1h8"),s("WSSiT"),s("3rEkq"),s("imK0S"),s("bYmSd"),s("acLJn"),s("7WLBj"),s("1bFci"),s("49dpo"),s("fiOos"),s("5KHLt"),s("avJI0"),s("2dPgQ"),s("181UU"),s("lsNiP"),s("k7Du7"),s("4804C"),s("cGC0n"),s("eu81x"),s("hQKIK"),s("bRIeS"),s("j0e1k"),s("lV6Sm"),s("1SpQu"),s("ee0Eu"),s("7owLz"),s("9ZTJv"),s("6XDPM"),s("4z0yD"),s("9rcKy"),s("elYe2"),s("lIW56"),s("cc4Di"),s("iSlCw"),s("6THdB"),s("l6jFw"),s("WvbbQ"),s("9JCtR"),s("i4HMG"),s("iGcXf"),s("aOJMk"),s("l1WmC"),s("5Qmo8"),s("1GxQM"),s("jlvqc"),s("2acG6"),s("1FDpf"),s("2MKa7"),s("83Plb"),s("gldWN"),s("hYjAM"),s("hUanB"),s("eRHoj"),s("43t4p"),s("fG12c"),s("8Irjk"),s("giife"),s("bftEy"),s("lKM5m"),s("jHQP9"),s("fFUjj"),s("5uQwR"),s("d10y4"),s("hHkhi"),s("kPryz"),s("jPaTA"),s("djXCd"),s("dd8tD"),s("2KAsd"),s("jxscz"),s("etmQx"),s("eQuwX"),s("h7Gux"),i=s("casYn"),o=s("eBkYt"),u=s("dvCn4"),a=s("8x9VA"),s("htMbZ"),s("buy0T"),s("4C8ia"),s("lfNC8"),s("4y8cw"),s("biSQf"),s("lWKd3"),s("fTdnV"),s("fZE7S"),s("2xCpB"),s("jc2CK"),s("lzRoG"),s("616DT"),s("5J0XY"),s("bqdMI"),s("a5FCc"),s("a0S6X"),s("1JEgs"),s("9aiVe"),s("kP8JI"),s("1jhOm"),s("dqB3G"),s("h4byS"),s("6jWCC"),s("4ETT0"),s("6FAlx"),s("cxotR"),s("ilMKa"),s("8p3bZ"),s("jl6td")),P=s("1AnXD"),L=s("bLCbB"),j=s("9PS5J"),z=s("eC6uZ"),U=s("8ZlyQ"),V=s("cjdFa"),W=s("ios2x"),G=s("lOxkD"),H=s("6UffC"),q=s("gfBfC"),J=s("6p2WX"),K=(s("f1skK"),{fft:i.fft,ifft:o.ifft,rfft:a.rfft,irfft:u.irfft}),X={hammingWindow:c.hammingWindow,hannWindow:l.hannWindow,frame:f.frame,stft:d.stft},Y={flipLeftRight:h.flipLeftRight,resizeNearestNeighbor:A.resizeNearestNeighbor,resizeBilinear:w.resizeBilinear,rotateWithOffset:v.rotateWithOffset,cropAndResize:p.cropAndResize,nonMaxSuppression:g.nonMaxSuppression,nonMaxSuppressionAsync:m.nonMaxSuppressionAsync,nonMaxSuppressionWithScore:y.nonMaxSuppressionWithScore,nonMaxSuppressionWithScoreAsync:x.nonMaxSuppressionWithScoreAsync,nonMaxSuppressionPadded:b.nonMaxSuppressionPadded,nonMaxSuppressionPaddedAsync:k.nonMaxSuppressionPaddedAsync},Q={bandPart:E.bandPart,gramSchmidt:C.gramSchmidt,qr:S.qr},Z={absoluteDifference:N.absoluteDifference,computeWeightedLoss:T.computeWeightedLoss,cosineDistance:D.cosineDistance,hingeLoss:F.hingeLoss,huberLoss:O.huberLoss,logLoss:_.logLoss,meanSquaredError:I.meanSquaredError,sigmoidCrossEntropy:R.sigmoidCrossEntropy,softmaxCrossEntropy:M.softmaxCrossEntropy};e(t.exports,B),e(t.exports,P),e(t.exports,L),e(t.exports,j),e(t.exports,z),e(t.exports,U),e(t.exports,V),e(t.exports,W),e(t.exports,G),e(t.exports,H),e(t.exports,q),e(t.exports,J)})),s.register("8x9VA",(function(e,t){n(e.exports,"rfft",(function(){return g}));var r=s("kglvN"),a=s("3IcUj"),i=s("6hkW8"),o=s("hXj3N"),u=s("f1skK"),c=s("2acG6"),l=s("gldWN"),f=s("jPaTA"),d=s("htMbZ"),p=s("ilMKa"),h=s("8p3bZ"),v=s("casYn");var g=u.op({rfft_:function(e,t){r.assert("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,u=e.shape[e.shape.length-1],s=e.size/u;if(null!=t&&t<u){var g=e.shape.map((function(e){return 0})),m=e.shape.map((function(e){return e}));m[e.shape.length-1]=t,n=f.slice(e,g,m),u=t}else if(null!=t&&t>u){var y=e.shape.map((function(e){return e}));y[e.shape.length-1]=t-u,n=i.concat([e,p.zeros(y)],e.shape.length-1),u=t}else n=e;var x=h.zerosLike(n),b=l.reshape(a.complex(n,x),[s,u]),k=v.fft(b),w=Math.floor(u/2)+1,A=c.real(k),E=o.imag(k),C=d.split(A,[w,u-w],A.shape.length-1),S=d.split(E,[w,u-w],E.shape.length-1),N=n.shape.slice();return N[n.shape.length-1]=w,l.reshape(a.complex(C[0],S[0]),N)}})})),s.register("hXj3N",(function(e,t){n(e.exports,"imag",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({imag_:function(e){var t=i.convertToTensor(e,"input","imag"),n={input:t};return r.ENGINE.runKernelFunc((function(e){return e.imag(t)}),n,null,a.Imag)}})})),s.register("2acG6",(function(e,t){n(e.exports,"real",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({real_:function(e){var t=i.convertToTensor(e,"input","real"),n={input:t};return r.ENGINE.runKernelFunc((function(e){return e.real(t)}),n,null,a.Real)}})})),s.register("casYn",(function(e,t){n(e.exports,"fft",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN");var o=s("f1skK").op({fft_:function(e){i.assert("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.ENGINE.runKernelFunc((function(t){var n=e.shape[e.shape.length-1],r=e.size/n,a=e.as2D(r,n);return t.fft(a).reshape(e.shape)}),t,null,a.FFT)}})})),s.register("eBkYt",(function(e,t){n(e.exports,"ifft",(function(){return c}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN"),o=s("f1skK"),u=s("gldWN");var c=o.op({ifft_:function(e){i.assert("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.ENGINE.runKernelFunc((function(t){var n=e.shape[e.shape.length-1],r=e.size/n,a=u.reshape(e,[r,n]),i=t.ifft(a);return u.reshape(i,e.shape)}),t,null,a.IFFT)}})})),s.register("dvCn4",(function(e,t){n(e.exports,"irfft",(function(){return v}));var r=s("3IcUj"),a=s("6hkW8"),i=s("hXj3N"),o=s("j0e1k"),u=s("f1skK"),c=s("2acG6"),l=s("gldWN"),f=s("hYjAM"),d=s("bftEy"),p=s("jPaTA"),h=s("eBkYt");var v=u.op({irfft_:function(e){var t,n=e.shape[e.shape.length-1],u=e.size/n;if(n<=2){var s=l.reshape(e,[u,n]);t=h.ifft(s)}else{var v=[u,2*(n-1)],g=l.reshape(c.real(e),[u,n]),m=l.reshape(i.imag(e),[u,n]),y=f.reverse(p.slice(g,[0,1],[u,n-2]),1),x=o.mul(f.reverse(p.slice(m,[0,1],[u,n-2]),1),d.scalar(-1)),b=a.concat([g,y],1),k=a.concat([m,x],1),w=l.reshape(r.complex(b,k),[v[0],v[1]]);t=h.ifft(w)}if(t=c.real(t),3===e.rank&&0!==e.shape[0]){var A=t,E=e.shape[0];t=l.reshape(t,[E,t.shape[0]/E,t.shape[1]]),A.dispose()}return t}})})),s.register("lGvfM",(function(e,t){n(e.exports,"conv2d",(function(){return s("3ZWiI").conv2d})),n(e.exports,"depthwiseConv2d",(function(){return s("muqF4").depthwiseConv2d})),n(e.exports,"matMul",(function(){return s("eu0dS").matMul}));s("3ZWiI"),s("muqF4"),s("eu0dS")})),s.register("3ZWiI",(function(e,t){n(e.exports,"conv2d",(function(){return b})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("2c3OP"),o=s("cvMH2"),u=s("gIxdA"),c=s("lcVC1"),l=s("kglvN"),f=s("b3Qcj"),d=s("kNwIt"),p=s("dH9u6"),h=s("hH7x5"),v=s("eWkFG"),g=s("drGuD"),m=s("5nWoB"),y=s("f1skK"),x=s("gldWN");var b=y.op({fusedConv2d_:function(e){var t=e.x,n=e.filter,s=e.strides,y=e.pad,b=e.dataFormat,k=void 0===b?"NHWC":b,w=e.dilations,A=void 0===w?[1,1]:w,E=e.dimRoundingMode,C=e.bias,S=e.activation,N=void 0===S?"linear":S,T=e.preluActivationWeights;if(N=N||"linear",!1===m.shouldFuse(a.ENGINE.state.gradientDepth,N)){var D=p.conv2d(t,n,s,y,k,A,E);return null!=C&&(D=f.add(D,C)),m.applyActivation(D,N,T)}var F=c.convertToTensor(t,"x","conv2d"),O=c.convertToTensor(n,"filter","conv2d"),_=F,I=!1;3===F.rank&&(I=!0,_=x.reshape(F,[1,F.shape[0],F.shape[1],F.shape[2]])),l.assert(4===_.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(_.rank,".")})),l.assert(4===O.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(O.rank,".")})),null!=E&&l.assert(l.isInt(y),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(E," but got pad ").concat(y,".")})),l.assert(_.shape[3]===O.shape[2],(function(){return"Error in conv2d: depth of input (".concat(_.shape[3],") must match ")+"input depth for filter ".concat(O.shape[2],".")})),l.assert(g.eitherStridesOrDilationsAreOne(s,A),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(A,"'")})),l.assert("NHWC"===k,(function(){return"Error in conv2d: got dataFormat of ".concat(k," but only NHWC is currently supported.")}));var R,M,B,P=g.computeConv2DInfo(_.shape,O.shape,s,A,y,E);null!=C&&(R=c.convertToTensor(C,"bias","fused conv2d"),M=r.default(u.makeTypesMatch(R,F),1),R=M[0],d.assertAndGetBroadcastShape(P.outShape,R.shape)),null!=T&&(B=c.convertToTensor(T,"prelu weights","fused conv2d"));var L=function(e,t){var n=r.default(t,4),a=n[0],i=n[1],o=n[2],u=n[3],c=m.getFusedDyActivation(e,o,N);l.assert(g.tupleValuesAreOne(A),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(A,"'")}));var f=[v.conv2DBackpropInput(i.shape,c,a,s,y),h.conv2DBackpropFilter(i,c,a.shape,s,y)];if(null!=u){var d=m.getFusedBiasGradient(u,c);f.push(d)}return f},j=function(e){return e.fusedConv2d({input:_,filter:O,convInfo:P,bias:R,activation:N,preluActivationWeights:B})},z={x:_,filter:O,bias:R,preluActivationWeights:B},U={strides:s,pad:y,dataFormat:k,dilations:A,dimRoundingMode:E,activation:N};return null==C?i.customGrad((function(e,t,n){var r=a.ENGINE.runKernelFunc(j,z,null,o.FusedConv2D,U);return n([t,e,r]),I&&(r=x.reshape(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:L}}))(_,O):i.customGrad((function(e,t,n,r){var i=a.ENGINE.runKernelFunc(j,z,null,o.FusedConv2D,U);return r([t,e,i,n]),I&&(i=x.reshape(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:L}}))(_,O,R)}})})),s.register("2c3OP",(function(e,t){n(e.exports,"grad",(function(){return c})),n(e.exports,"grads",(function(){return l})),n(e.exports,"valueAndGrad",(function(){return f})),n(e.exports,"valueAndGrads",(function(){return d})),n(e.exports,"variableGrads",(function(){return p})),n(e.exports,"customGrad",(function(){return h})),s("1i51P");var r=s("9M1dW"),a=s("1dnDT"),i=s("4JvjV"),o=s("lcVC1"),u=s("kglvN");function c(e){return u.assert(u.isFunction(e),(function(){return"The f passed in grad(f) must be a function"})),function(t,n){var r=o.convertToTensor(t,"x","tf.grad",null),i=null!=n?o.convertToTensor(n,"dy","tf.grad"):null;return a.ENGINE.tidy((function(){var t=a.ENGINE.gradients((function(){return e(r)}),[r],i),n=t.value,o=t.grads;return null!=i&&u.assertShapesMatch(n.shape,i.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),v(o),o[0]}))}}function l(e){return u.assert(u.isFunction(e),(function(){return"The f passed in grads(f) must be a function"})),function(t,n){u.assert(Array.isArray(t),(function(){return"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s"}));var i=o.convertToTensorArray(t,"args","tf.grads",null),s=null!=n?o.convertToTensor(n,"dy","tf.grads"):null;return a.ENGINE.tidy((function(){var t=a.ENGINE.gradients((function(){return e.apply(void 0,r.default(i))}),i,s),n=t.value,o=t.grads;return null!=s&&u.assertShapesMatch(n.shape,s.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),v(o),o}))}}function f(e){return u.assert(u.isFunction(e),(function(){return"The f passed in valueAndGrad(f) must be a function"})),function(t,n){u.assert(t instanceof i.Tensor,(function(){return"The x passed in valueAndGrad(f)(x) must be a tensor"})),u.assert(null==n||n instanceof i.Tensor,(function(){return"The dy passed in valueAndGrad(f)(x, dy) must be a tensor"}));var r=a.ENGINE.gradients((function(){return e(t)}),[t],n),o=r.grads,s=r.value;return v(o),{grad:o[0],value:s}}}function d(e){return u.assert(u.isFunction(e),(function(){return"The f passed in valueAndGrads(f) must be a function"})),function(t,n){u.assert(Array.isArray(t)&&t.every((function(e){return e instanceof i.Tensor})),(function(){return"The args passed in valueAndGrads(f)(args) must be array of tensors"})),u.assert(null==n||n instanceof i.Tensor,(function(){return"The dy passed in valueAndGrads(f)(args, dy) must be a tensor"}));var o=a.ENGINE.gradients((function(){return e.apply(void 0,r.default(t))}),t,n);return null!=n&&u.assertShapesMatch(o.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),v(o.grads),o}}function p(e,t){u.assert(u.isFunction(e),(function(){return"The f passed in variableGrads(f) must be a function"})),u.assert(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof i.Variable})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],a.ENGINE.registeredVariables)t.push(a.ENGINE.registeredVariables[r]);var o=n?t.filter((function(e){return!e.trainable})):null,s=t.length;t=t.filter((function(e){return e.trainable})),u.assert(t.length>0,(function(){return"variableGrads() expects at least one of the input variables to "+"be trainable, but none of the ".concat(s," variables is ")+"trainable."}));var c=a.ENGINE.gradients(e,t,null,!0),l=c.value,f=c.grads;u.assert(f.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),u.assert(0===l.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it "+"returned a rank-".concat(l.rank," tensor")}));var d={};return t.forEach((function(e,t){null!=f[t]&&(d[e.name]=f[t])})),null!=o&&o.forEach((function(e){return d[e.name]=null})),{value:l,grads:d}}function h(e){return a.ENGINE.customGrad(e)}function v(e){if(e.filter((function(e){return null==e})).length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that\n    the f you passed encloses all operations that lead from x to y.")}})),s.register("5nWoB",(function(e,t){n(e.exports,"getFusedDyActivation",(function(){return p})),n(e.exports,"getFusedBiasGradient",(function(){return h})),n(e.exports,"applyActivation",(function(){return v})),n(e.exports,"shouldFuse",(function(){return g}));var r=s("kNwIt"),a=s("gGOj0"),i=s("j0e1k"),o=s("9JCtR"),u=s("2MKa7"),c=s("83Plb"),l=s("gldWN"),f=s("lWKd3"),d=s("2xCpB");function p(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return i.mul(e,f.step(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function h(e,t){var n=t,a=r.getReductionAxes(e.shape,t.shape);return a.length>0&&(n=d.sum(n,a)),l.reshape(n,e.shape)}function v(e,t,n){if("linear"===t)return e;if("relu"===t)return u.relu(e);if("elu"===t)return a.elu(e);if("relu6"===t)return c.relu6(e);if("prelu"===t)return o.prelu(e,n);throw new Error("Unknown fused activation ".concat(t,"."))}var g=function(e,t){return!(e>0)||"linear"===t}})),s.register("gGOj0",(function(e,t){n(e.exports,"elu",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({elu_:function(e){var t=i.convertToTensor(e,"x","elu"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),n,null,a.Elu)}})})),s.register("9JCtR",(function(e,t){n(e.exports,"prelu",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({prelu_:function(e,t){var n=i.convertToTensor(e,"x","prelu"),o=i.convertToTensor(t,"alpha","prelu"),u={x:n,alpha:o};return r.ENGINE.runKernelFunc((function(e,t){var r=e.prelu(n,o);return t([n,o]),r}),u,null,a.Prelu)}})})),s.register("2MKa7",(function(e,t){n(e.exports,"relu",(function(){return c}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("f1skK"),u=s("782ce");var c=o.op({relu_:function(e){var t=i.convertToTensor(e,"x","relu"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){return n([t]),"bool"===t.dtype?u.cast(t,"int32"):e.relu(t)}),n,null,a.Relu)}})})),s.register("83Plb",(function(e,t){n(e.exports,"relu6",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("782ce");var u=s("f1skK").op({relu6_:function(e){var t=i.convertToTensor(e,"x","relu6"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){return n([t]),"bool"===t.dtype?o.cast(t,"int32"):e.relu6(t)}),n,null,a.Relu6)}})})),s.register("muqF4",(function(e,t){n(e.exports,"depthwiseConv2d",(function(){return b})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("2c3OP"),o=s("cvMH2"),u=s("gIxdA"),c=s("lcVC1"),l=s("kglvN"),f=s("b3Qcj"),d=s("kNwIt"),p=s("drGuD"),h=s("btnhd"),v=s("apWCa"),g=s("aY1tG"),m=s("5nWoB"),y=s("f1skK"),x=s("gldWN");var b=y.op({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,s=e.strides,y=e.pad,b=e.dataFormat,k=void 0===b?"NHWC":b,w=e.dilations,A=void 0===w?[1,1]:w,E=e.dimRoundingMode,C=e.bias,S=e.activation,N=void 0===S?"linear":S,T=e.preluActivationWeights;if(!1===m.shouldFuse(a.ENGINE.state.gradientDepth,N)){var D=h.depthwiseConv2d(t,n,s,y,k,A,E);return null!=C&&(D=f.add(D,C)),m.applyActivation(D,N,T)}var F=c.convertToTensor(t,"x","depthwiseConv2d"),O=c.convertToTensor(n,"filter","depthwiseConv2d"),_=F,I=!1;3===F.rank&&(I=!0,_=x.reshape(F,[1,F.shape[0],F.shape[1],F.shape[2]])),l.assert(4===_.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(_.rank,".")})),l.assert(4===O.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(O.rank,".")})),l.assert(_.shape[3]===O.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(_.shape[3],") must match the inChannels dimension in ")+"filter ".concat(O.shape[2],".")})),null==A&&(A=[1,1]),l.assert(p.eitherStridesOrDilationsAreOne(s,A),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(s," and dilations '").concat(A,"'")})),null!=E&&l.assert(l.isInt(y),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(E," but got pad ").concat(y,".")}));var R,M,B,P=p.computeConv2DInfo(_.shape,O.shape,s,A,y,E,!0);null!=C&&(R=c.convertToTensor(C,"bias","fused conv2d"),M=r.default(u.makeTypesMatch(R,F),1),R=M[0],d.assertAndGetBroadcastShape(P.outShape,R.shape)),null!=T&&(B=c.convertToTensor(T,"prelu weights","fused depthwiseConv2d"));var L=function(e,t){l.assert(p.tupleValuesAreOne(A),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(A,"'")}));var n=r.default(t,4),a=n[0],i=n[1],o=n[2],u=n[3],s=m.getFusedDyActivation(e,o,N),c=g.depthwiseConv2dNativeBackpropInput(i.shape,s,a,P),f=v.depthwiseConv2dNativeBackpropFilter(i,s,a.shape,P);return null!=u?[c,f,m.getFusedBiasGradient(R,s)]:[c,f]},j=function(e){return e.fusedDepthwiseConv2D({input:_,filter:O,convInfo:P,bias:R,activation:N,preluActivationWeights:B})},z={x:_,filter:O,bias:R,preluActivationWeights:B},U={strides:s,pad:y,dataFormat:k,dilations:A,dimRoundingMode:E,activation:N};return null==C?i.customGrad((function(e,t,n){var r=a.ENGINE.runKernelFunc(j,z,null,o.FusedDepthwiseConv2D,U);return n([t,e,r]),I&&(r=x.reshape(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:L}}))(_,O):i.customGrad((function(e,t,n,r){var i=a.ENGINE.runKernelFunc(j,z,null,o.FusedDepthwiseConv2D,U);return r([t,e,i,n]),I&&(i=x.reshape(i,[i.shape[1],i.shape[2],i.shape[3]])),{value:i,gradFunc:L}}))(_,O,R)}})})),s.register("btnhd",(function(e,t){n(e.exports,"depthwiseConv2d",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=s("f1skK"),l=s("gldWN");var f=c.op({depthwiseConv2d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,p=i.convertToTensor(e,"x","depthwiseConv2d"),h=i.convertToTensor(t,"filter","depthwiseConv2d"),v=p,g=!1;3===p.rank&&(g=!0,v=l.reshape(p,[1,p.shape[0],p.shape[1],p.shape[2]])),o.assert(4===v.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),o.assert(4===h.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(h.rank,".")})),o.assert(v.shape[3]===h.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(v.shape[3],") must match the inChannels dimension in ")+"filter ".concat(h.shape[2],".")})),null!=d&&o.assert(o.isInt(s),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(s,".")}));var m=function(e,t){null==f&&(f=[1,1]),o.assert(u.eitherStridesOrDilationsAreOne(n,f),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(n," and dilations '").concat(f,"'")}));var r=u.computeConv2DInfo(v.shape,h.shape,n,f,s,d,!0),a=e.depthwiseConv2D(v,h,r);return t([v,h]),a},y={x:v,filter:h},x={strides:n,pad:s,dataFormat:c,dilations:f,dimRoundingMode:d},b=r.ENGINE.runKernelFunc(m,y,null,a.DepthwiseConv2dNative,x);return g?l.reshape(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})})),s.register("eu0dS",(function(e,t){n(e.exports,"matMul",(function(){return m})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("2c3OP"),o=s("cvMH2"),u=s("gIxdA"),c=s("lcVC1"),l=s("kglvN"),f=s("b3Qcj"),d=s("kNwIt"),p=s("5nWoB"),h=s("5KHLt"),v=s("f1skK"),g=s("gldWN");var m=v.op({fusedMatMul_:function(e){var t=e.a,n=e.b,s=e.transposeA,v=void 0!==s&&s,m=e.transposeB,y=void 0!==m&&m,x=e.bias,b=e.activation,k=void 0===b?"linear":b,w=e.preluActivationWeights;if(!1===p.shouldFuse(a.ENGINE.state.gradientDepth,k)){var A=h.matMul(t,n,v,y);return null!=x&&(A=f.add(A,x)),p.applyActivation(A,k,w)}var E,C=c.convertToTensor(t,"a","fused matMul"),S=c.convertToTensor(n,"b","fused matMul");E=r.default(u.makeTypesMatch(C,S),2),C=E[0],S=E[1];var N=v?C.shape[C.rank-2]:C.shape[C.rank-1],T=y?S.shape[S.rank-1]:S.shape[S.rank-2],D=v?C.shape[C.rank-1]:C.shape[C.rank-2],F=y?S.shape[S.rank-2]:S.shape[S.rank-1],O=C.shape.slice(0,-2),_=S.shape.slice(0,-2),I=l.sizeFromShape(O),R=l.sizeFromShape(_);l.assert(C.rank>=2&&S.rank>=2&&C.rank===S.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least "+"2, got ranks ".concat(C.rank," and ").concat(S.rank,".")})),l.assert(l.arraysEqual(O,_),(function(){return"Error in fused matMul: outer dimensions (".concat(O,") and (")+"".concat(_,") of Tensors with shapes ").concat(C.shape," and ")+"".concat(S.shape," must match.")})),l.assert(N===T,(function(){return"Error in fused matMul: inner shapes (".concat(N,") and (")+"".concat(T,") of Tensors with shapes ").concat(C.shape," and ")+"".concat(S.shape," and transposeA=").concat(v)+" and transposeB=".concat(y," must match.")}));var M,B,P,L=C.shape.slice(0,-2).concat([D,F]),j=v?g.reshape(C,[I,N,D]):g.reshape(C,[I,D,N]),z=y?g.reshape(S,[R,F,T]):g.reshape(S,[R,T,F]);null!=x&&(M=c.convertToTensor(x,"bias","fused matMul"),B=r.default(u.makeTypesMatch(M,C),1),M=B[0],d.assertAndGetBroadcastShape(L,M.shape)),null!=w&&(P=c.convertToTensor(w,"prelu weights","fused matMul"));var U=function(e,t){var n,a,i=r.default(t,4),o=i[0],u=i[1],s=i[2],c=i[3],l=p.getFusedDyActivation(g.reshape(e,s.shape),s,k);return v||y?!v&&y?(n=h.matMul(l,u,!1,!1),a=h.matMul(l,o,!0,!1)):v&&!y?(n=h.matMul(u,l,!1,!0),a=h.matMul(o,l,!1,!1)):(n=h.matMul(u,l,!0,!0),a=h.matMul(l,o,!0,!0)):(n=h.matMul(l,u,!1,!0),a=h.matMul(o,l,!0,!1)),null!=x?[n,a,p.getFusedBiasGradient(c,l)]:[n,a]},V=function(e){return e.fusedBatchMatMul({a:j,b:z,transposeA:v,transposeB:y,bias:M,activation:k,preluActivationWeights:P})},W={a:j,b:z,bias:M,preluActivationWeights:P},G={transposeA:v,transposeB:y,activation:k};return null==x?i.customGrad((function(e,t,n){var r=a.ENGINE.runKernelFunc(V,W,null,o._FusedMatMul,G);return n([e,t,r]),{value:g.reshape(r,L),gradFunc:U}}))(j,z):i.customGrad((function(e,t,n,r){var i=a.ENGINE.runKernelFunc(V,W,null,o._FusedMatMul,G);return r([e,t,i,n]),{value:g.reshape(i,L),gradFunc:U}}))(j,z,M)}})})),s.register("87y9E",(function(e,t){n(e.exports,"hammingWindow",(function(){return i}));var r=s("f1skK"),a=s("gfBfC");var i=r.op({hammingWindow_:function(e){return a.cosineWindow(e,.54,.46)}})})),s.register("gfBfC",(function(e,t){n(e.exports,"enclosingPowerOfTwo",(function(){return a})),n(e.exports,"cosineWindow",(function(){return i}));var r=s("5J0XY");function a(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function i(e,t,n){for(var a=1-e%2,i=new Float32Array(e),o=0;o<e;++o){var u=2*Math.PI*o/(e+a-1);i[o]=t-n*Math.cos(u)}return r.tensor1d(i,"float32")}})),s.register("5J0XY",(function(e,t){n(e.exports,"tensor1d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("fTjN4");function o(e,t){a.assertNonNull(e);var n=r.inferShape(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return i.makeTensor(e,null,n,t)}})),s.register("60SBN",(function(e,t){n(e.exports,"hannWindow",(function(){return i}));var r=s("f1skK"),a=s("gfBfC");var i=r.op({hannWindow_:function(e){return a.cosineWindow(e,.5,.5)}})})),s.register("6tFHu",(function(e,t){n(e.exports,"frame",(function(){return l}));var r=s("6hkW8"),a=s("jwnkA"),i=s("f1skK"),o=s("gldWN"),u=s("jPaTA"),c=s("bqdMI");var l=i.op({frame_:function(e,t,n){for(var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,l=0,f=[];l+t<=e.size;)f.push(u.slice(e,l,t)),l+=n;if(i)for(;l<e.size;){var d=l+t-e.size,p=r.concat([u.slice(e,l,t-d),a.fill([d],s)]);f.push(p),l+=n}return 0===f.length?c.tensor2d([],[0,t]):o.reshape(r.concat(f),[f.length,t])}})})),s.register("jwnkA",(function(e,t){n(e.exports,"fill",(function(){return i}));var r=s("1dnDT"),a=s("cvMH2");function i(e,t,n){var i={shape:e,value:t,dtype:n};return r.ENGINE.runKernelFunc((function(r){return r.fill(e,t,n)}),{},null,a.Fill,i)}})),s.register("bqdMI",(function(e,t){n(e.exports,"tensor2d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("fTjN4");function o(e,t,n){if(a.assertNonNull(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var o=r.inferShape(e,n);if(2!==o.length&&1!==o.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return i.makeTensor(e,t,o,n)}})),s.register("jvUWC",(function(e,t){n(e.exports,"stft",(function(){return d}));var r=s("6hkW8"),a=s("j0e1k"),i=s("f1skK"),o=s("gfBfC"),u=s("jPaTA"),c=s("8x9VA"),l=s("6tFHu"),f=s("60SBN");var d=i.op({stft_:function(e,t,n,i){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:f.hannWindow;null==i&&(i=o.enclosingPowerOfTwo(t));for(var d=l.frame(e,t,n),p=a.mul(d,s(t)),h=[],v=0;v<d.shape[0];v++)h.push(c.rfft(u.slice(p,[v,0],[1,t]),i));return r.concat(h)}})})),s.register("l22S7",(function(e,t){n(e.exports,"cropAndResize",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({cropAndResize_:function(e,t,n,u,s,c){var l=i.convertToTensor(e,"image","cropAndResize"),f=i.convertToTensor(t,"boxes","cropAndResize","float32"),d=i.convertToTensor(n,"boxInd","cropAndResize","int32");s=s||"bilinear",c=c||0;var p=f.shape[0];o.assert(4===l.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(l.rank,".")})),o.assert(2===f.rank&&4===f.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(p,",4] ")+"but had shape ".concat(f.shape,".")})),o.assert(1===d.rank&&d.shape[0]===p,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(p,"] ")+"but had shape ".concat(f.shape,".")})),o.assert(2===u.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(u.length,".")})),o.assert(u[0]>=1&&u[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(u)})),o.assert("bilinear"===s||"nearest"===s,(function(){return"method must be bilinear or nearest, but was ".concat(s)}));var h={image:l,boxes:f,boxInd:d},v={method:s,extrapolationValue:c,cropSize:u};return r.ENGINE.runKernelFunc((function(e){return e.cropAndResize(l,f,d,u,s,c)}),h,null,a.CropAndResize,v)}})})),s.register("jinyt",(function(e,t){n(e.exports,"flipLeftRight",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({flipLeftRight_:function(e){var t=i.convertToTensor(e,"image","flipLeftRight","float32");o.assert(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return r.ENGINE.runKernel(a.FlipLeftRight,n,{})}})})),s.register("75VXs",(function(e,t){n(e.exports,"rotateWithOffset",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=i.convertToTensor(e,"image","rotateWithOffset","float32");o.assert(4===s.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(s.rank,".")}));var c={image:s},l={radians:t,fillValue:n,center:u},f=r.ENGINE.runKernel(a.RotateWithOffset,c,l);return f}})})),s.register("hvgy1",(function(e,t){n(e.exports,"nonMaxSuppression",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("gjuyW");var u=s("f1skK").op({nonMaxSuppression_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,c=i.convertToTensor(e,"boxes","nonMaxSuppression"),l=i.convertToTensor(t,"scores","nonMaxSuppression"),f=o.nonMaxSuppSanityCheck(c,l,n,u,s);n=f.maxOutputSize,u=f.iouThreshold,s=f.scoreThreshold;var d={maxOutputSize:n,iouThreshold:u,scoreThreshold:s};return r.ENGINE.runKernelFunc((function(e){return e.nonMaxSuppression(c,l,n,u,s)}),{boxes:c,scores:l},null,a.NonMaxSuppressionV3,d)}})})),s.register("gjuyW",(function(e,t){n(e.exports,"nonMaxSuppSanityCheck",(function(){return a}));var r=s("kglvN");function a(e,t,n,a,i,o){null==a&&(a=.5),null==i&&(i=Number.NEGATIVE_INFINITY),null==o&&(o=0);var u=e.shape[0];return n=Math.min(n,u),r.assert(0<=a&&a<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(a,"'")})),r.assert(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),r.assert(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),r.assert(1===t.rank,(function(){return"scores must be a 1D tensor"})),r.assert(t.shape[0]===u,(function(){return"scores has incompatible shape with boxes. Expected ".concat(u,", ")+"but was ".concat(t.shape[0])})),r.assert(0<=o&&o<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(o,"'")})),{maxOutputSize:n,iouThreshold:a,scoreThreshold:i,softNmsSigma:o}}})),s.register("dqyru",(function(e,r){n(e.exports,"nonMaxSuppressionAsync",(function(){return f})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("cMPcY"),u=s("lcVC1"),c=s("gjuyW");function l(){return l=a.default(t(i).mark((function e(n,r,a){var s,l,f,d,p,h,v,g,m,y=arguments;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=y.length>3&&void 0!==y[3]?y[3]:.5,l=y.length>4&&void 0!==y[4]?y[4]:Number.NEGATIVE_INFINITY,f=u.convertToTensor(n,"boxes","nonMaxSuppressionAsync"),d=u.convertToTensor(r,"scores","nonMaxSuppressionAsync"),p=c.nonMaxSuppSanityCheck(f,d,a,s,l),a=p.maxOutputSize,s=p.iouThreshold,l=p.scoreThreshold,e.next=9,Promise.all([f.data(),d.data()]);case 9:return h=e.sent,v=h[0],g=h[1],m=o.nonMaxSuppressionV3Impl(v,g,a,s,l),f!==n&&f.dispose(),d!==r&&d.dispose(),e.abrupt("return",m);case 16:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var f=function(e,t,n){return l.apply(this,arguments)}})),s.register("cMPcY",(function(e,t){n(e.exports,"nonMaxSuppressionV3Impl",(function(){return u})),n(e.exports,"nonMaxSuppressionV4Impl",(function(){return c})),n(e.exports,"nonMaxSuppressionV5Impl",(function(){return l})),s("1i51P");var r=s("9M1dW"),a=s("bftEy"),i=s("5J0XY"),o=s("1M9uT");function u(e,t,n,r,a){return f(e,t,n,r,a,0).selectedIndices}function c(e,t,n,r,a,i){return f(e,t,n,r,a,0,!1,i,!0)}function l(e,t,n,r,a,i){return f(e,t,n,r,a,i,!0)}function f(e,t,n,u,s,c){for(var l=arguments.length>6&&void 0!==arguments[6]&&arguments[6],f=arguments.length>7&&void 0!==arguments[7]&&arguments[7],v=arguments.length>8&&void 0!==arguments[8]&&arguments[8],g=[],m=0;m<t.length;m++)t[m]>s&&g.push({score:t[m],boxIndex:m,suppressBeginIndex:0});g.sort(h);for(var y=c>0?-.5/c:0,x=[],b=[];x.length<n&&g.length>0;){var k=g.pop(),w=k.score,A=k.boxIndex,E=k.suppressBeginIndex;if(w<s)break;for(var C=!1,S=x.length-1;S>=E;--S){var N=d(e,A,x[S]);if(N>=u){C=!0;break}if(k.score=k.score*p(u,y,N),k.score<=s)break}k.suppressBeginIndex=x.length,C||(k.score===w?(x.push(A),b.push(k.score)):k.score>s&&o.binaryInsert(g,k,h))}var T,D,F=x.length,O=n-F;f&&O>0&&((T=x).push.apply(T,r.default(new Array(O).fill(0))),(D=b).push.apply(D,r.default(new Array(O).fill(0))));var _={selectedIndices:i.tensor1d(x,"int32")};return l&&(_.selectedScores=i.tensor1d(b,"float32")),v&&(_.validOutputs=a.scalar(F,"int32")),_}function d(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),u=Math.max(r[0],r[2]),s=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),d=Math.max(a[1],a[3]),p=(u-i)*(s-o),h=(f-c)*(d-l);if(p<=0||h<=0)return 0;var v=Math.max(i,c),g=Math.max(o,l),m=Math.min(u,f),y=Math.min(s,d),x=Math.max(m-v,0)*Math.max(y-g,0);return x/(p+h-x)}function p(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function h(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}})),s.register("1M9uT",(function(e,t){function r(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var u=n(t,e[i=r+(a-r>>>1)]);u>0?r=i+1:(a=i,o=!u)}return o?r:-r-1}(e,t,n||a)}(e,t,n),i=r<0?-(r+1):r;e.splice(i,0,t)}function a(e,t){return e>t?1:e<t?-1:0}n(e.exports,"binaryInsert",(function(){return r}))})),s.register("kwUk5",(function(e,t){n(e.exports,"nonMaxSuppressionWithScore",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("gjuyW");var u=s("f1skK").op({nonMaxSuppressionWithScore_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,l=i.convertToTensor(e,"boxes","nonMaxSuppression"),f=i.convertToTensor(t,"scores","nonMaxSuppression"),d=o.nonMaxSuppSanityCheck(l,f,n,u,s,c),p={boxes:l,scores:f},h={maxOutputSize:n=d.maxOutputSize,iouThreshold:u=d.iouThreshold,scoreThreshold:s=d.scoreThreshold,softNmsSigma:c=d.softNmsSigma},v=r.ENGINE.runKernel(a.NonMaxSuppressionV5,p,h);return{selectedIndices:v[0],selectedScores:v[1]}}})})),s.register("dpvlk",(function(e,r){n(e.exports,"nonMaxSuppressionWithScoreAsync",(function(){return f})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("cMPcY"),u=s("lcVC1"),c=s("gjuyW");function l(){return l=a.default(t(i).mark((function e(n,r,a){var s,l,f,d,p,h,v,g,m,y,x=arguments;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=x.length>3&&void 0!==x[3]?x[3]:.5,l=x.length>4&&void 0!==x[4]?x[4]:Number.NEGATIVE_INFINITY,f=x.length>5&&void 0!==x[5]?x[5]:0,d=u.convertToTensor(n,"boxes","nonMaxSuppressionAsync"),p=u.convertToTensor(r,"scores","nonMaxSuppressionAsync"),h=c.nonMaxSuppSanityCheck(d,p,a,s,l,f),a=h.maxOutputSize,s=h.iouThreshold,l=h.scoreThreshold,f=h.softNmsSigma,e.next=10,Promise.all([d.data(),p.data()]);case 10:return v=e.sent,g=v[0],m=v[1],y=o.nonMaxSuppressionV5Impl(g,m,a,s,l,f),d!==n&&d.dispose(),p!==r&&p.dispose(),e.abrupt("return",y);case 17:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var f=function(e,t,n){return l.apply(this,arguments)}})),s.register("29f6i",(function(e,t){n(e.exports,"nonMaxSuppressionPadded",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("gjuyW");var u=s("f1skK").op({nonMaxSuppressionPadded_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=i.convertToTensor(e,"boxes","nonMaxSuppression"),f=i.convertToTensor(t,"scores","nonMaxSuppression"),d=o.nonMaxSuppSanityCheck(l,f,n,u,s,null),p=d.maxOutputSize,h=d.iouThreshold,v=d.scoreThreshold,g={boxes:l,scores:f},m={maxOutputSize:p,iouThreshold:h,scoreThreshold:v,padToMaxOutputSize:c},y=r.ENGINE.runKernel(a.NonMaxSuppressionV4,g,m);return{selectedIndices:y[0],validOutputs:y[1]}}})})),s.register("iiKqT",(function(e,r){n(e.exports,"nonMaxSuppressionPaddedAsync",(function(){return f}));var a=s("1i51P"),i=s("40Zzs"),o=s("cMPcY"),u=s("lcVC1"),c=s("gjuyW");function l(){return l=a.asyncToGenerator(t(i).mark((function e(n,r,s){var l,f,d,p,h,v,g,m,y,x,b,k,w,A=arguments;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=A.length>3&&void 0!==A[3]?A[3]:.5,f=A.length>4&&void 0!==A[4]?A[4]:Number.NEGATIVE_INFINITY,d=A.length>5&&void 0!==A[5]&&A[5],p=u.convertToTensor(n,"boxes","nonMaxSuppressionAsync"),h=u.convertToTensor(r,"scores","nonMaxSuppressionAsync"),v=c.nonMaxSuppSanityCheck(p,h,s,l,f,null),g=v.maxOutputSize,m=v.iouThreshold,y=v.scoreThreshold,e.t0=a,e.next=10,Promise.all([p.data(),h.data()]);case 10:return e.t1=e.sent,x=e.t0.slicedToArray.call(e.t0,e.t1,2),b=x[0],k=x[1],w=o.nonMaxSuppressionV4Impl(b,k,g,m,y,d),p!==n&&p.dispose(),h!==r&&h.dispose(),e.abrupt("return",w);case 18:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var f=function(e,t,n){return l.apply(this,arguments)}})),s.register("em9A1",(function(e,t){n(e.exports,"resizeBilinear",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("lcVC1"),u=s("kglvN"),c=s("f1skK"),l=s("gldWN");var f=c.op({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=o.convertToTensor(e,"images","resizeBilinear");u.assert(3===s.rank||4===s.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(s.rank,".")})),u.assert(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")}));var c=s,f=!1;3===s.rank&&(f=!0,c=l.reshape(s,[1,s.shape[0],s.shape[1],s.shape[2]]));var d=r.default(t,2),p=d[0],h=d[1],v=function(e,t){return t([c]),e.resizeBilinear(c,p,h,n)},g={images:c},m={alignCorners:n,size:t},y=a.ENGINE.runKernelFunc(v,g,null,i.ResizeBilinear,m);return f?l.reshape(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})})),s.register("1Wdii",(function(e,t){n(e.exports,"resizeNearestNeighbor",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("lcVC1"),u=s("kglvN"),c=s("f1skK"),l=s("gldWN");var f=c.op({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=o.convertToTensor(e,"images","resizeNearestNeighbor");u.assert(3===s.rank||4===s.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(s.rank,".")})),u.assert(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),u.assert("float32"===s.dtype||"int32"===s.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var c=s,f=!1;3===s.rank&&(f=!0,c=l.reshape(s,[1,s.shape[0],s.shape[1],s.shape[2]]));var d=r.default(t,2),p=d[0],h=d[1],v={images:c},g={alignCorners:n,size:t},m=function(e,t){return t([c]),e.resizeNearestNeighbor(c,p,h,n)},y=a.ENGINE.runKernelFunc(m,v,null,i.ResizeNearestNeighbor,g);return f?l.reshape(y,[y.shape[1],y.shape[2],y.shape[3]]):y}})})),s.register("btsCn",(function(e,t){n(e.exports,"bandPart",(function(){return x})),s("1i51P");var r=s("6vecG"),a=s("lcVC1"),i=s("kglvN"),o=s("6Bgjr"),u=s("j0AHg"),c=s("7WLBj"),l=s("f1skK"),f=s("jlvqc"),d=s("gldWN"),p=s("bftEy"),h=s("biSQf"),v=s("fZE7S"),g=s("6jWCC"),m=s("6FAlx"),y=s("ilMKa");var x=l.op({bandPart_:function(e,t,n){i.assert(t%1==0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),i.assert(n%1==0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var s=a.convertToTensor(e,"a","bandPart");i.assert(s.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(s.rank,".")}));var l=s.shape,x=r.default(s.shape.slice(-2),2),b=x[0],k=x[1];if(!(t<=b))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(b,")."));if(!(n<=k))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(k,")."));t<0&&(t=b),n<0&&(n=k);var w=d.reshape(f.range(0,b,1,"int32"),[-1,1]),A=f.range(0,k,1,"int32"),E=v.sub(w,A),C=c.logicalAnd(u.lessEqual(E,p.scalar(+t,"int32")),o.greaterEqual(E,p.scalar(-n,"int32"))),S=y.zeros([b,k],s.dtype);return d.reshape(h.stack(g.unstack(d.reshape(s,[-1,b,k])).map((function(e){return m.where(C,e,S)}))),l)}})})),s.register("jlvqc",(function(e,t){n(e.exports,"range",(function(){return c}));var r=s("1dnDT"),a=s("cvMH2"),i=s("kglvN"),o=s("5J0XY"),u=s("ilMKa");function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var c=function(){if(e===t||e<t&&n<0||t<e&&n>1)return u.zeros([0],s);var r=Math.abs(Math.ceil((t-e)/n)),a=i.makeZerosTypedArray(r,s);t<e&&1===n&&(n=-1),a[0]=e;for(var c=1;c<a.length;c++)a[c]=a[c-1]+n;return o.tensor1d(a,s)},l={start:e,stop:t,step:n,dtype:s};return r.ENGINE.runKernelFunc(c,{},null,a.Range,l)}})),s.register("6jWCC",(function(e,t){n(e.exports,"unstack",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i.convertToTensor(e,"x","unstack");o.assert(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")})),t<0&&(t+=n.shape.length);var u={value:n},s={axis:t},c=function(e){return e.unstack(n,t)};return r.ENGINE.runKernelFunc(c,u,null,a.Unpack,s)}})})),s.register("52rtn",(function(e,t){n(e.exports,"gramSchmidt",(function(){return v}));var r=s("1dnDT"),a=s("kglvN"),i=s("6baO0"),o=s("j0e1k"),u=s("eC6uZ"),c=s("f1skK"),l=s("htMbZ"),f=s("4y8cw"),d=s("biSQf"),p=s("fZE7S"),h=s("2xCpB");var v=c.op({gramSchmidt_:function(e){var t,n=function(e){g.push(r.ENGINE.tidy((function(){var t=m[e];if(e>0)for(var n=0;n<e;++n){var r=o.mul(h.sum(o.mul(g[n],t)),g[n]);t=p.sub(t,r)}return i.div(t,u.norm(t,"euclidean"))})))};if(Array.isArray(e)){var s=function(t){a.assert(e[t].shape[0]===c,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(c,")")}))};t=!1,a.assert(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var c=e[0].shape[0],v=1;v<e.length;++v)s(v)}else t=!0,e=l.split(e,e.shape[0],0).map((function(e){return f.squeeze(e,[0])}));a.assert(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var g=[],m=e,y=0;y<e.length;++y)n(y);return t?d.stack(g,0):g}})})),s.register("eC6uZ",(function(e,t){n(e.exports,"norm",(function(){return y}));var r=s("lcVC1"),a=s("kglvN"),i=s("3gUC5"),o=s("4RRNB"),u=s("avJI0"),c=s("cGC0n"),l=s("f1skK"),f=s("WvbbQ"),d=s("gldWN"),p=s("bftEy"),h=s("buy0T"),v=s("4C8ia"),g=s("2xCpB");function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return i.abs(e);if(1!==e.rank&&null===n)return m(d.reshape(e,[-1]),t,n);if(1===e.rank||"number"==typeof n||Array.isArray(n)&&1===n.length){if(1===t)return g.sum(i.abs(e),n);if(t===1/0)return u.max(i.abs(e),n);if(t===-1/0)return c.min(i.abs(e),n);if("euclidean"===t||2===t)return h.sqrt(g.sum(f.pow(i.abs(e),p.scalar(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return u.max(g.sum(i.abs(e),n[0]),n[1]-1);if(t===1/0)return u.max(g.sum(i.abs(e),n[1]),n[0]);if(t===-1/0)return c.min(g.sum(i.abs(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return h.sqrt(g.sum(v.square(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var y=l.op({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=m(e=r.convertToTensor(e,"x","norm"),t,n),s=u.shape;if(i){var c=a.parseAxisParam(n,e.shape);s=o.expandShapeToKeepDim(u.shape,c)}return d.reshape(u,s)}})})),s.register("3gUC5",(function(e,t){n(e.exports,"abs",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({abs_:function(e){var t=i.convertToTensor(e,"x","abs"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){return n([t]),"complex64"===t.dtype?e.complexAbs(t):e.abs(t)}),n,null,a.Abs)}})})),s.register("avJI0",(function(e,t){n(e.exports,"max",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("f1skK"),l=s("gldWN"),f=s("9PS5J");var d=c.op({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i.convertToTensor(e,"x","max"),c=function(e,r){var a=o.parseAxisParam(t,s.shape),i=u.getAxesPermutation(a,s.rank),c=s;null!=i&&(c=f.transpose(s,i),a=u.getInnerMostAxes(a.length,c.rank));var d=e.max(c,a);null!=i&&c.dispose();var p=d;if(n){var h=u.expandShapeToKeepDim(p.shape,o.parseAxisParam(t,s.shape));p=l.reshape(p,h),d.dispose()}return r([s,p]),p},d={x:s},p={reductionIndices:t,keepDims:n};return r.ENGINE.runKernelFunc(c,d,null,a.Max,p)}})})),s.register("cGC0n",(function(e,t){n(e.exports,"min",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("f1skK"),l=s("gldWN"),f=s("9PS5J");var d=c.op({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i.convertToTensor(e,"x","min"),c=function(e,r){var a=o.parseAxisParam(t,s.shape),i=a,c=u.getAxesPermutation(i,s.rank),d=s;null!=c&&(d=f.transpose(s,c),i=u.getInnerMostAxes(i.length,s.rank));var p=e.min(d,i);null!=c&&d.dispose();var h=p;if(n){var v=u.expandShapeToKeepDim(h.shape,a);h=l.reshape(p,v),p.dispose()}return r([s,h]),h},d={x:s},p={axis:t,keepDims:n};return r.ENGINE.runKernelFunc(c,d,null,a.Min,p)}})})),s.register("4y8cw",(function(e,t){n(e.exports,"squeeze",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("gldWN");var u=i.op({squeeze_:function(e,t){var n=r.convertToTensor(e,"x","squeeze");return o.reshape(n,a.squeezeShape(n.shape,t).newShape)}})})),s.register("2yUOI",(function(e,t){n(e.exports,"qr",(function(){return N})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("P1tXK"),o=s("kglvN"),u=s("dOUsY"),c=s("6hkW8"),l=s("6baO0"),f=s("lyVnl"),d=s("ejjI8"),p=s("5KHLt"),h=s("j0e1k"),v=s("ee0Eu"),g=s("eC6uZ"),m=s("f1skK"),y=s("gldWN"),x=s("jPaTA"),b=s("biSQf"),k=s("fZE7S"),w=s("bqdMI"),A=s("9PS5J"),E=s("6jWCC"),C=s("6FAlx");function S(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return a.ENGINE.tidy((function(){var n=function(e){var t,n=b,o=S,f=y;t=r.default(a.ENGINE.tidy((function(){var t=x.slice(b,[e,e],[s-e,1]),n=g.norm(t),r=x.slice(b,[e,e],[1,1]),a=C.where(d.greater(r,0),w.tensor2d([[-1]]),w.tensor2d([[1]])),i=k.sub(r,h.mul(a,n)),o=l.div(t,i);S=1===o.shape[0]?u.clone(E):c.concat([E,x.slice(o,[1,0],[o.shape[0]-1,o.shape[1]])],0);var f=v.neg(l.div(p.matMul(a,i),n)),N=x.slice(b,[e,0],[s-e,m]),T=h.mul(f,S),D=A.transpose(S);if(0===e)b=k.sub(N,p.matMul(T,p.matMul(D,N)));else{var F=k.sub(N,p.matMul(T,p.matMul(D,N)));b=c.concat([x.slice(b,[0,0],[e,m]),F],0)}var O=A.transpose(T),_=x.slice(y,[0,e],[s,y.shape[1]-e]);if(0===e)y=k.sub(_,p.matMul(p.matMul(_,S),O));else{var I=k.sub(_,p.matMul(p.matMul(_,S),O));y=c.concat([x.slice(y,[0,0],[s,e]),I],1)}return[S,b,y]})),3),S=t[0],b=t[1],y=t[2],i.dispose([n,o,f])};o.assert(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var s=e.shape[0],m=e.shape[1],y=f.eye(s),b=u.clone(e),E=w.tensor2d([[1]],[1,1]),S=u.clone(E),N=s>=m?m:s,T=0;T<N;++T)n(T);return!t&&s>m&&(y=x.slice(y,[0,0],[s,m]),b=x.slice(b,[0,0],[m,m])),[y,b]}))}var N=m.op({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(o.assert(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return S(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),a=E.unstack(y.reshape(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),i=[],u=[];a.forEach((function(e){var n=r.default(S(e,t),2),a=n[0],o=n[1];i.push(a),u.push(o)}));var s=y.reshape(b.stack(i,0),e.shape),c=y.reshape(b.stack(u,0),e.shape);return[s,c]}})})),s.register("P1tXK",(function(e,t){n(e.exports,"enableProdMode",(function(){return u})),n(e.exports,"enableDebugMode",(function(){return c})),n(e.exports,"disableDeprecationWarnings",(function(){return l})),n(e.exports,"deprecationWarn",(function(){return f})),n(e.exports,"disposeVariables",(function(){return d})),n(e.exports,"engine",(function(){return p})),n(e.exports,"memory",(function(){return h})),n(e.exports,"profile",(function(){return v})),n(e.exports,"tidy",(function(){return g})),n(e.exports,"dispose",(function(){return m})),n(e.exports,"keep",(function(){return y})),n(e.exports,"time",(function(){return x})),n(e.exports,"setBackend",(function(){return b})),n(e.exports,"ready",(function(){return k})),n(e.exports,"getBackend",(function(){return w})),n(e.exports,"removeBackend",(function(){return A})),n(e.exports,"findBackend",(function(){return E})),n(e.exports,"findBackendFactory",(function(){return C})),n(e.exports,"registerBackend",(function(){return S})),n(e.exports,"backend",(function(){return N})),n(e.exports,"setPlatform",(function(){return T}));var r=s("1dnDT"),a=s("lU3MY"),i=s("4JvjV"),o=s("gIxdA");function u(){a.env().set("PROD",!0)}function c(){a.env().set("DEBUG",!0)}function l(){a.env().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function f(e){a.env().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function d(){r.ENGINE.disposeVariables()}function p(){return r.ENGINE}function h(){return r.ENGINE.memory()}function v(e){return r.ENGINE.profile(e)}function g(e,t){return r.ENGINE.tidy(e,t)}function m(e){o.getTensorsInContainer(e).forEach((function(e){return e.dispose()}))}function y(e){return r.ENGINE.keep(e)}function x(e){return r.ENGINE.time(e)}function b(e){return r.ENGINE.setBackend(e)}function k(){return r.ENGINE.ready()}function w(){return r.ENGINE.backendName}function A(e){r.ENGINE.removeBackend(e)}function E(e){return r.ENGINE.findBackend(e)}function C(e){return r.ENGINE.findBackendFactory(e)}function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.ENGINE.registerBackend(e,t,n)}function N(){return r.ENGINE.backend}function T(e,t){a.env().setPlatform(e,t)}i.setDeprecationWarningFn(f)})),s.register("lyVnl",(function(e,t){n(e.exports,"eye",(function(){return c}));var r=s("8orDI"),a=s("fwOP6"),i=s("f1skK"),o=s("gldWN"),u=s("kP8JI");var c=i.op({eye_:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var s=r.buffer([e,t],i),c=e<=t?e:t,l=0;l<c;++l)s.set(1,l,l);var f=o.reshape(s.toTensor(),[e,t]);if(null==n)return f;if(1===n.length)return u.tile(a.expandDims(f,0),[n[0],1,1]);if(2===n.length)return u.tile(a.expandDims(a.expandDims(f,0),0),[n[0],n[1],1,1]);if(3===n.length)return u.tile(a.expandDims(a.expandDims(a.expandDims(f,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}})})),s.register("7t46p",(function(e,t){n(e.exports,"absoluteDifference",(function(){return f}));var r=s("lcVC1"),a=s("kglvN"),i=s("3gUC5"),o=s("ctwOS"),u=s("f1skK"),c=s("fZE7S"),l=s("2v1rL");var f=u.op({absoluteDifference_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:o.Reduction.SUM_BY_NONZERO_WEIGHTS,s=r.convertToTensor(e,"labels","absoluteDifference"),f=r.convertToTensor(t,"predictions","absoluteDifference"),d=null;null!=n&&(d=r.convertToTensor(n,"weights","absoluteDifference")),a.assertShapesMatch(s.shape,f.shape,"Error in absoluteDifference: ");var p=i.abs(c.sub(s,f));return l.computeWeightedLoss(p,d,u)}})})),s.register("ctwOS",(function(e,t){var r;n(e.exports,"Reduction",(function(){return r})),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))})),s.register("2v1rL",(function(e,t){n(e.exports,"computeWeightedLoss",(function(){return v}));var r=s("lcVC1"),a=s("782ce"),i=s("6baO0"),o=s("ctwOS"),u=s("4804C"),c=s("j0e1k"),l=s("7owLz"),f=s("6XDPM"),d=s("f1skK"),p=s("bftEy"),h=s("2xCpB");var v=d.op({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.Reduction.SUM_BY_NONZERO_WEIGHTS,s=r.convertToTensor(e,"losses","computeWeightedLoss"),d=null;null!=t&&(d=r.convertToTensor(t,"weights","computeWeightedLoss"));var v=null==d?s:c.mul(s,d);if(n===o.Reduction.NONE)return v;if(n===o.Reduction.SUM)return h.sum(v);if(n===o.Reduction.MEAN){if(null==d)return u.mean(v);var g=s.size/d.size,m=i.div(h.sum(v),h.sum(d));return g>1?i.div(m,p.scalar(g)):m}if(n===o.Reduction.SUM_BY_NONZERO_WEIGHTS){if(null==d)return i.div(h.sum(v),p.scalar(s.size));var y=c.mul(d,f.ones(s.shape)),x=a.cast(h.sum(l.notEqual(y,p.scalar(0))),"float32");return i.div(h.sum(v),x)}throw Error("Unknown reduction: ".concat(n))}})})),s.register("4804C",(function(e,t){n(e.exports,"mean",(function(){return g}));var r=s("2c3OP"),a=s("lcVC1"),i=s("kglvN"),o=s("4RRNB"),u=s("782ce"),c=s("6baO0"),l=s("j0e1k"),f=s("6XDPM"),d=s("f1skK"),p=s("gldWN"),h=s("bftEy"),v=s("2xCpB");var g=d.op({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=a.convertToTensor(e,"x","mean"),d=i.parseAxisParam(t,s.shape),g=o.computeOutAndReduceShapes(s.shape,d),m=g[1],y=i.sizeFromShape(m),x=r.customGrad((function(e){var r=h.scalar(y),a=r.dtype===e.dtype?e:u.cast(e,r.dtype),i=c.div(a,r);return{value:v.sum(i,t,n),gradFunc:function(t){var n=e.shape.slice();d.forEach((function(e){n[e]=1}));var r=p.reshape(t,n);return c.div(l.mul(r,f.ones(e.shape,"float32")),y)}}}));return x(s)}})})),s.register("7owLz",(function(e,t){n(e.exports,"notEqual",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({notEqual_:function(e,t){var n,s=u.convertToTensor(e,"a","notEqual"),l=u.convertToTensor(t,"b","notEqual");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e){return e.notEqual(s,l)}),f,null,i.NotEqual)}})})),s.register("8sCZS",(function(e,t){n(e.exports,"cosineDistance",(function(){return p}));var r=s("lcVC1"),a=s("kglvN"),i=s("ctwOS"),o=s("j0e1k"),u=s("f1skK"),c=s("bftEy"),l=s("fZE7S"),f=s("2xCpB"),d=s("2v1rL");var p=u.op({cosineDistance_:function(e,t,n,u){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:i.Reduction.SUM_BY_NONZERO_WEIGHTS,p=r.convertToTensor(e,"labels","cosineDistance"),h=r.convertToTensor(t,"predictions","cosineDistance"),v=null;null!=u&&(v=r.convertToTensor(u,"weights","cosineDistance")),a.assertShapesMatch(p.shape,h.shape,"Error in cosineDistance: ");var g=c.scalar(1),m=l.sub(g,f.sum(o.mul(p,h),n,!0));return d.computeWeightedLoss(m,v,s)}})})),s.register("aNtPC",(function(e,t){n(e.exports,"hingeLoss",(function(){return p}));var r=s("lcVC1"),a=s("kglvN"),i=s("ctwOS"),o=s("j0e1k"),u=s("f1skK"),c=s("2MKa7"),l=s("bftEy"),f=s("fZE7S"),d=s("2v1rL");var p=u.op({hingeLoss_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.Reduction.SUM_BY_NONZERO_WEIGHTS,s=r.convertToTensor(e,"labels","hingeLoss"),p=r.convertToTensor(t,"predictions","hingeLoss"),h=null;null!=n&&(h=r.convertToTensor(n,"weights","hingeLoss")),a.assertShapesMatch(s.shape,p.shape,"Error in hingeLoss: ");var v=l.scalar(1);s=f.sub(o.mul(l.scalar(2),s),v);var g=c.relu(f.sub(v,o.mul(s,p)));return d.computeWeightedLoss(g,h,u)}})})),s.register("cFDc5",(function(e,t){n(e.exports,"huberLoss",(function(){return g}));var r=s("lcVC1"),a=s("kglvN"),i=s("3gUC5"),o=s("b3Qcj"),u=s("ctwOS"),c=s("eu81x"),l=s("j0e1k"),f=s("f1skK"),d=s("bftEy"),p=s("4C8ia"),h=s("fZE7S"),v=s("2v1rL");var g=f.op({huberLoss_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u.Reduction.SUM_BY_NONZERO_WEIGHTS,g=r.convertToTensor(e,"labels","huberLoss"),m=r.convertToTensor(t,"predictions","huberLoss"),y=null;null!=n&&(y=r.convertToTensor(n,"weights","huberLoss")),a.assertShapesMatch(g.shape,m.shape,"Error in huberLoss: ");var x=d.scalar(s),b=i.abs(h.sub(m,g)),k=c.minimum(b,x),w=h.sub(b,k),A=o.add(l.mul(d.scalar(.5),p.square(k)),l.mul(x,w));return v.computeWeightedLoss(A,y,f)}})})),s.register("eu81x",(function(e,t){n(e.exports,"minimum",(function(){return f})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt"),l=s("782ce");var f=s("f1skK").op({minimum_:function(e,t){var n,s=u.convertToTensor(e,"a","minimum"),f=u.convertToTensor(t,"b","minimum");n=r.default(o.makeTypesMatch(s,f),2),s=n[0],f=n[1],"bool"===s.dtype&&(s=l.cast(s,"int32"),f=l.cast(f,"int32")),c.assertAndGetBroadcastShape(s.shape,f.shape);var d={a:s,b:f};return a.ENGINE.runKernelFunc((function(e,t){var n=e.minimum(s,f);return t([s,f]),n}),d,null,i.Minimum)}})})),s.register("kxzAB",(function(e,t){n(e.exports,"logLoss",(function(){return v}));var r=s("lcVC1"),a=s("kglvN"),i=s("b3Qcj"),o=s("WSSiT"),u=s("ctwOS"),c=s("j0e1k"),l=s("ee0Eu"),f=s("f1skK"),d=s("bftEy"),p=s("fZE7S"),h=s("2v1rL");var v=f.op({logLoss_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,f=arguments.length>4&&void 0!==arguments[4]?arguments[4]:u.Reduction.SUM_BY_NONZERO_WEIGHTS,v=r.convertToTensor(e,"labels","logLoss"),g=r.convertToTensor(t,"predictions","logLoss"),m=null;null!=n&&(m=r.convertToTensor(n,"weights","logLoss")),a.assertShapesMatch(v.shape,g.shape,"Error in logLoss: ");var y=d.scalar(1),x=d.scalar(s),b=l.neg(c.mul(v,o.log(i.add(g,x)))),k=c.mul(p.sub(y,v),o.log(i.add(p.sub(y,g),x))),w=p.sub(b,k);return h.computeWeightedLoss(w,m,f)}})})),s.register("M5LBI",(function(e,t){n(e.exports,"meanSquaredError",(function(){return l}));var r=s("lcVC1"),a=s("kglvN"),i=s("ctwOS"),o=s("f1skK"),u=s("lfNC8"),c=s("2v1rL");var l=o.op({meanSquaredError_:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i.Reduction.SUM_BY_NONZERO_WEIGHTS,s=r.convertToTensor(e,"labels","meanSquaredError"),l=r.convertToTensor(t,"predictions","meanSquaredError"),f=null;null!=n&&(f=r.convertToTensor(n,"weights","meanSquaredError")),a.assertShapesMatch(s.shape,l.shape,"Error in meanSquaredError: ");var d=u.squaredDifference(s,l);return c.computeWeightedLoss(d,f,o)}})})),s.register("lfNC8",(function(e,t){n(e.exports,"squaredDifference",(function(){return l})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1"),c=s("kNwIt");var l=s("f1skK").op({squaredDifference_:function(e,t){var n,s=u.convertToTensor(e,"a","squaredDifference"),l=u.convertToTensor(t,"b","squaredDifference");n=r.default(o.makeTypesMatch(s,l),2),s=n[0],l=n[1],c.assertAndGetBroadcastShape(s.shape,l.shape);var f={a:s,b:l};return a.ENGINE.runKernelFunc((function(e,t){var n=e.squaredDifference(s,l);return t([s,l]),n}),f,null,i.SquaredDifference,{})}})})),s.register("c5h4Q",(function(e,t){n(e.exports,"sigmoidCrossEntropy",(function(){return x}));var r=s("lcVC1"),a=s("kglvN"),i=s("3gUC5"),o=s("b3Qcj"),u=s("byJMV"),c=s("3rEkq"),l=s("ctwOS"),f=s("j0e1k"),d=s("ee0Eu"),p=s("f1skK"),h=s("2MKa7"),v=s("bftEy"),g=s("fZE7S"),m=s("2v1rL");function y(e,t){var n=r.convertToTensor(e,"labels","sigmoidCrossEntropyWithLogits"),s=r.convertToTensor(t,"logits","sigmoidCrossEntropyWithLogits");a.assertShapesMatch(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");var l=h.relu(s),p=f.mul(s,n),v=c.log1p(u.exp(d.neg(i.abs(s))));return o.add(g.sub(l,p),v)}var x=p.op({sigmoidCrossEntropy_:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:l.Reduction.SUM_BY_NONZERO_WEIGHTS,s=r.convertToTensor(e,"multiClassLabels","sigmoidCrossEntropy"),c=r.convertToTensor(t,"logits","sigmoidCrossEntropy"),d=null;if(null!=n&&(d=r.convertToTensor(n,"weights","sigmoidCrossEntropy")),a.assertShapesMatch(s.shape,c.shape,"Error in sigmoidCrossEntropy: "),i>0){var p=v.scalar(i),h=v.scalar(1),x=v.scalar(.5);s=o.add(f.mul(s,g.sub(h,p)),f.mul(x,p))}var b=y(s,c);return m.computeWeightedLoss(b,d,u)}})})),s.register("3rEkq",(function(e,t){n(e.exports,"log1p",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({log1p_:function(e){var t=i.convertToTensor(e,"x","log1p"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),n,null,a.Log1p)}})})),s.register("3IAqt",(function(e,t){n(e.exports,"softmaxCrossEntropy",(function(){return E})),s("1i51P");var r=s("6vecG"),a=s("2c3OP"),i=s("lcVC1"),o=s("kglvN"),u=s("b3Qcj"),c=s("4RRNB"),l=s("782ce"),f=s("6baO0"),d=s("byJMV"),p=s("acLJn"),h=s("ctwOS"),v=s("j0e1k"),g=s("ee0Eu"),m=s("f1skK"),y=s("gldWN"),x=s("bftEy"),b=s("fZE7S"),k=s("2xCpB"),w=s("2v1rL");function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var i=a.customGrad((function(e,t,a){var i=p.logSumExp(t,[n],!0),o=b.sub(l.cast(t,"float32"),i);a([e,o]);var u=g.neg(v.mul(o,e));return{value:k.sum(u,[n]),gradFunc:function(e,t){var a=r.default(t,2),i=a[0],o=a[1],u=c.expandShapeToKeepDim(e.shape,[n]);return[v.mul(y.reshape(e,u),b.sub(l.cast(i,"float32"),d.exp(o))),v.mul(y.reshape(e,u),b.sub(d.exp(o),l.cast(i,"float32")))]}}}));return i(e,t)}var E=m.op({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:h.Reduction.SUM_BY_NONZERO_WEIGHTS,s=i.convertToTensor(e,"onehotLabels","softmaxCrossEntropy"),c=i.convertToTensor(t,"logits","softmaxCrossEntropy"),l=null;if(null!=n&&(l=i.convertToTensor(n,"weights","softmaxCrossEntropy")),o.assertShapesMatch(s.shape,c.shape,"Error in softmaxCrossEntropy: "),r>0){var d=x.scalar(r),p=x.scalar(1),g=x.scalar(s.shape[1]);s=u.add(v.mul(s,b.sub(p,d)),f.div(d,g))}var m=A(s,c);return w.computeWeightedLoss(m,l,a)}})})),s.register("acLJn",(function(e,t){n(e.exports,"logSumExp",(function(){return v}));var r=s("lcVC1"),a=s("kglvN"),i=s("b3Qcj"),o=s("4RRNB"),u=s("byJMV"),c=s("WSSiT"),l=s("avJI0"),f=s("f1skK"),d=s("gldWN"),p=s("fZE7S"),h=s("2xCpB");var v=f.op({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=r.convertToTensor(e,"x","logSumExp"),f=a.parseAxisParam(t,s.shape),v=l.max(s,f,!0),g=p.sub(s,v),m=u.exp(g),y=h.sum(m,f),x=c.log(y),b=i.add(d.reshape(v,x.shape),x);if(n){var k=o.expandShapeToKeepDim(b.shape,f);return d.reshape(b,k)}return b}})})),s.register("4JdlT",(function(e,t){n(e.exports,"acos",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({acos_:function(e){var t=i.convertToTensor(e,"x","acos"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),n,null,a.Acos)}})})),s.register("deh8x",(function(e,t){n(e.exports,"acosh",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({acosh_:function(e){var t=i.convertToTensor(e,"x","acosh"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),n,null,a.Acosh)}})})),s.register("1XItt",(function(e,t){n(e.exports,"addN",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({addN_:function(e){o.assert(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),o.assert(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return i.convertToTensor(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!o.arraysEqual(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var u=t;return r.ENGINE.runKernelFunc((function(e,n){var r=e.addN(t);return n(t),r}),u,null,a.AddN)}})})),s.register("d6rwS",(function(e,t){n(e.exports,"all",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("f1skK"),l=s("gldWN"),f=s("9PS5J");var d=c.op({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i.convertToTensor(e,"x","all","bool"),c=function(e){var r=o.parseAxisParam(t,s.shape),a=r,i=u.getAxesPermutation(a,s.rank);null!=i&&(s=f.transpose(s,i),a=u.getInnerMostAxes(a.length,s.rank));var c=e.all(s,a);if(n){var d=u.expandShapeToKeepDim(c.shape,r);return l.reshape(c,d)}return c},d={x:s},p={axis:t,keepDims:n};return r.ENGINE.runKernelFunc(c,d,null,a.All,p)}})})),s.register("a7Ldu",(function(e,t){n(e.exports,"any",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("f1skK"),l=s("gldWN"),f=s("9PS5J");var d=c.op({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i.convertToTensor(e,"x","any","bool"),c=function(e){var r=o.parseAxisParam(t,s.shape),a=r,i=u.getAxesPermutation(a,s.rank);null!=i&&(s=f.transpose(s,i),a=u.getInnerMostAxes(a.length,s.rank));var c=e.any(s,a);if(n){var d=u.expandShapeToKeepDim(c.shape,r);return l.reshape(c,d)}return c},d={x:s},p={axis:t,keepDims:n};return r.ENGINE.runKernelFunc(c,d,null,a.Any,p)}})})),s.register("9UQ7R",(function(e,t){n(e.exports,"argMax",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("f1skK"),l=s("9PS5J");var f=c.op({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i.convertToTensor(e,"x","argMax"),s=function(e,r){r([n]);var a=o.parseAxisParam(t,n.shape),i=u.getAxesPermutation(a,n.rank);return null!=i&&(n=l.transpose(n,i),a=u.getInnerMostAxes(a.length,n.rank)),e.argMax(n,a[0])},c={x:n},f={axis:t};return r.ENGINE.runKernelFunc(s,c,null,a.ArgMax,f)}})})),s.register("8wukb",(function(e,t){n(e.exports,"argMin",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("f1skK"),l=s("9PS5J");var f=c.op({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=i.convertToTensor(e,"x","argMin"),s=function(e,r){r([n]),null==t&&(t=0);var a=o.parseAxisParam(t,n.shape),i=u.getAxesPermutation(a,n.rank);return null!=i&&(n=l.transpose(n,i),a=u.getInnerMostAxes(a.length,n.rank)),e.argMin(n,a[0])},c={x:n},f={axis:t};return r.ENGINE.runKernelFunc(s,c,null,a.ArgMin,f)}})})),s.register("6jOGJ",(function(e,t){n(e.exports,"asin",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({asin_:function(e){var t=i.convertToTensor(e,"x","asin"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),n,null,a.Asin)}})})),s.register("ilRXh",(function(e,t){n(e.exports,"asinh",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({asinh_:function(e){var t=i.convertToTensor(e,"x","asinh"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),n,null,a.Asinh)}})})),s.register("1KNQy",(function(e,t){n(e.exports,"atan",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({atan_:function(e){var t=i.convertToTensor(e,"x","atan"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),n,null,a.Atan)}})})),s.register("hL6PI",(function(e,t){n(e.exports,"atan2",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({atan2_:function(e,t){var n,s=u.convertToTensor(e,"a","atan2"),c=u.convertToTensor(t,"b","atan2");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.atan2(s,c);return t([s,c]),n}),l,null,i.Atan2)}})})),s.register("9MsjU",(function(e,t){n(e.exports,"atanh",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({atanh_:function(e){var t=i.convertToTensor(e,"x","atanh"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),n,null,a.Atanh)}})})),s.register("WcUsE",(function(e,t){n(e.exports,"avgPool",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("782ce"),c=s("drGuD"),l=s("f1skK"),f=s("gldWN");var d=l.op({avgPool_:function(e,t,n,s,l){var d=i.convertToTensor(e,"x","avgPool","float32");o.assert(c.eitherStridesOrDilationsAreOne(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var p=d,h=!1;3===d.rank&&(h=!0,p=f.reshape(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.assert(4===p.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(p.rank,".")})),null!=l&&o.assert(o.isInt(s),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(s,".")}));var v={x:p},g={filterSize:t,strides:n,pad:s,dimRoundingMode:l},m=r.ENGINE.runKernelFunc((function(e,r){var a=c.computePool2DInfo(p.shape,t,n,1,s,l);return r([p]),1===a.filterWidth&&1===a.filterHeight&&o.arraysEqual(a.inShape,a.outShape)?p.clone():e.avgPool(p,a)}),v,null,a.AvgPool,g);return m=u.cast(m,d.dtype),h?f.reshape(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})})),s.register("4laI6",(function(e,t){n(e.exports,"avgPool3d",(function(){return p}));var r=s("1dnDT"),a=s("P1tXK"),i=s("cvMH2"),o=s("lcVC1"),u=s("kglvN"),c=s("782ce"),l=s("drGuD"),f=s("f1skK"),d=s("gldWN");var p=f.op({avgPool3d_:function(e,t,n,s,f){var p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",h=arguments.length>6?arguments[6]:void 0;null==h?h=[1,1,1]:a.deprecationWarn("dilations is deprecated, this field will be gone in v3.0.0.");var v=o.convertToTensor(e,"x","avgPool3d","float32"),g=v,m=!1;4===v.rank&&(m=!0,g=d.reshape(v,[1,v.shape[0],v.shape[1],v.shape[2],v.shape[3]])),u.assert(5===g.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(g.rank,".")})),u.assert("NDHWC"===p,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(p)})),u.assert(l.eitherStridesOrDilationsAreOne(n,h),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(h,"'")})),null!=f&&u.assert(u.isInt(s),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(s,".")}));var y=function(e,r){null==h&&(h=[1,1,1]);var a=l.computePool3DInfo(g.shape,t,n,h,s,f,p);return r([g]),e.avgPool3d(g,a)},x={x:g},b={filterSize:t,strides:n,pad:s,dimRoundingMode:f,dataFormat:p,dilations:h},k=r.ENGINE.runKernelFunc(y,x,null,i.AvgPool3D,b);return k=c.cast(k,g.dtype),m?d.reshape(k,[k.shape[1],k.shape[2],k.shape[3],k.shape[4]]):k}})})),s.register("25qxf",(function(e,t){n(e.exports,"basicLSTMCell",(function(){return p}));var r=s("lcVC1"),a=s("b3Qcj"),i=s("6hkW8"),o=s("5KHLt"),u=s("j0e1k"),c=s("f1skK"),l=s("5uQwR"),f=s("jPaTA"),d=s("lzRoG");var p=c.op({basicLSTMCell_:function(e,t,n,s,c,p){var h=r.convertToTensor(e,"forgetBias","basicLSTMCell"),v=r.convertToTensor(t,"lstmKernel","basicLSTMCell"),g=r.convertToTensor(n,"lstmBias","basicLSTMCell"),m=r.convertToTensor(s,"data","basicLSTMCell"),y=r.convertToTensor(c,"c","basicLSTMCell"),x=r.convertToTensor(p,"h","basicLSTMCell"),b=i.concat([m,x],1),k=o.matMul(b,v),w=a.add(k,g),A=w.shape[0],E=w.shape[1]/4,C=[A,E],S=f.slice(w,[0,0],C),N=f.slice(w,[0,E],C),T=f.slice(w,[0,2*E],C),D=f.slice(w,[0,3*E],C),F=a.add(u.mul(l.sigmoid(S),d.tanh(N)),u.mul(y,l.sigmoid(a.add(h,T))));return[F,u.mul(d.tanh(F),l.sigmoid(D))]}})})),s.register("lzRoG",(function(e,t){n(e.exports,"tanh",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({tanh_:function(e){var t=i.convertToTensor(e,"x","tanh"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),n,null,a.Tanh)}})})),s.register("7oZFS",(function(e,t){n(e.exports,"batchNorm",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("fu489"),c=s("f1skK"),l=s("gldWN");function f(e){return null==e?null:0===e.rank?l.reshape(e,[e.size]):1===e.rank?e:2===e.rank?l.reshape(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?l.reshape(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}var d=c.op({batchNorm_:function(e,t,n,s,c,d){null==d&&(d=.001);var p,h,v=i.convertToTensor(e,"x","batchNorm"),g=i.convertToTensor(t,"mean","batchNorm"),m=i.convertToTensor(n,"variance","batchNorm");null!=c&&(p=i.convertToTensor(c,"scale","batchNorm")),null!=s&&(h=i.convertToTensor(s,"offset","batchNorm")),o.assert(g.rank===m.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.assert(null==h||g.rank===h.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.assert(null==p||g.rank===p.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var y=u.xAs4D(v),x={x:y,scale:p,offset:h,mean:g,variance:m},b={varianceEpsilon:d},k=r.ENGINE.runKernelFunc((function(e,t){return t([y,g,m,p]),e.batchNorm(y,f(g),f(m),f(h),f(p),d)}),x,null,a.FusedBatchNorm,b);return l.reshape(k,v.shape)}})})),s.register("fu489",(function(e,t){n(e.exports,"xAs4D",(function(){return a}));var r=s("gldWN");function a(e){return 0===e.rank||1===e.rank?r.reshape(e,[1,1,1,e.size]):2===e.rank?r.reshape(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?r.reshape(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}})),s.register("1wkm4",(function(e,t){n(e.exports,"batchNorm2d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("7oZFS");var o=s("f1skK").op({batchNorm2d_:function(e,t,n,o,u,s){var c,l,f=r.convertToTensor(e,"x","batchNorm"),d=r.convertToTensor(t,"mean","batchNorm"),p=r.convertToTensor(n,"variance","batchNorm");return null!=u&&(c=r.convertToTensor(u,"scale","batchNorm")),null!=o&&(l=r.convertToTensor(o,"offset","batchNorm")),a.assert(2===f.rank,(function(){return"Error in batchNorm2D: x must be rank 2 but got rank "+"".concat(f.rank,".")})),a.assert(2===d.rank||1===d.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but "+"got rank ".concat(d.rank,".")})),a.assert(2===p.rank||1===p.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 "+"but got rank ".concat(p.rank,".")})),null!=c&&a.assert(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=l&&a.assert(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 "+"but got rank ".concat(l.rank,".")})),i.batchNorm(f,d,p,l,c,s)}})})),s.register("7qMEf",(function(e,t){n(e.exports,"batchNorm3d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("7oZFS");var o=s("f1skK").op({batchNorm3d_:function(e,t,n,o,u,s){var c,l,f=r.convertToTensor(e,"x","batchNorm"),d=r.convertToTensor(t,"mean","batchNorm"),p=r.convertToTensor(n,"variance","batchNorm");return null!=u&&(c=r.convertToTensor(u,"scale","batchNorm")),null!=o&&(l=r.convertToTensor(o,"offset","batchNorm")),a.assert(3===f.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+"".concat(f.rank,".")})),a.assert(3===d.rank||1===d.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but "+"got rank ".concat(d.rank,".")})),a.assert(3===p.rank||1===p.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 "+"but got rank ".concat(p.rank,".")})),null!=c&&a.assert(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=l&&a.assert(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 "+"but got rank ".concat(l.rank,".")})),i.batchNorm(f,d,p,l,c,s)}})})),s.register("3bI6J",(function(e,t){n(e.exports,"batchNorm4d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("7oZFS");var o=s("f1skK").op({batchNorm4d_:function(e,t,n,o,u,s){var c,l,f=r.convertToTensor(e,"x","batchNorm"),d=r.convertToTensor(t,"mean","batchNorm"),p=r.convertToTensor(n,"variance","batchNorm");return null!=u&&(c=r.convertToTensor(u,"scale","batchNorm")),null!=o&&(l=r.convertToTensor(o,"offset","batchNorm")),a.assert(4===f.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+"".concat(f.rank,".")})),a.assert(4===d.rank||1===d.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but "+"got rank ".concat(d.rank,".")})),a.assert(4===p.rank||1===p.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 "+"but got rank ".concat(p.rank,".")})),null!=c&&a.assert(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 "+"but got rank ".concat(c.rank,".")})),null!=l&&a.assert(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 "+"but got rank ".concat(l.rank,".")})),i.batchNorm(f,d,p,l,c,s)}})})),s.register("fecqZ",(function(e,t){n(e.exports,"ceil",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({ceil_:function(e){var t=i.convertToTensor(e,"x","ceil"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.ceil(t)}),n,null,a.Ceil)}})})),s.register("djUTy",(function(e,t){n(e.exports,"clipByValue",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({clipByValue_:function(e,t,n){var u=i.convertToTensor(e,"x","clipByValue");o.assert(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var s={x:u},c={clipValueMin:t,clipValueMax:n};return r.ENGINE.runKernelFunc((function(e,r){var a=e.clip(u,t,n);return r([u]),a}),s,null,a.ClipByValue,c)}})})),s.register("7dix2",(function(e,t){n(e.exports,"concat1d",(function(){return a}));var r=s("6hkW8");var a=s("f1skK").op({concat1d_:function(e){return r.concat(e,0)}})})),s.register("it0uc",(function(e,t){n(e.exports,"concat2d",(function(){return a}));var r=s("6hkW8");var a=s("f1skK").op({concat2d_:function(e,t){return r.concat(e,t)}})})),s.register("lC5hh",(function(e,t){n(e.exports,"concat3d",(function(){return a}));var r=s("6hkW8");var a=s("f1skK").op({concat3d_:function(e,t){return r.concat(e,t)}})})),s.register("2Iobd",(function(e,t){n(e.exports,"concat4d",(function(){return a}));var r=s("6hkW8");var a=s("f1skK").op({concat4d_:function(e,t){return r.concat(e,t)}})})),s.register("ceZj5",(function(e,t){n(e.exports,"conv1d",(function(){return l}));var r=s("lcVC1"),a=s("kglvN"),i=s("dH9u6"),o=s("drGuD"),u=s("f1skK"),c=s("gldWN");var l=u.op({conv1d_:function(e,t,n,u){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,f=arguments.length>6?arguments[6]:void 0,d=r.convertToTensor(e,"x","conv1d"),p=r.convertToTensor(t,"filter","conv1d"),h=d,v=!1;2===d.rank&&(v=!0,h=c.reshape(d,[1,d.shape[0],d.shape[1]])),a.assert(3===h.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(h.rank,".")})),a.assert(3===p.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(p.rank,".")})),null!=f&&a.assert(a.isInt(u),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(f," but got pad ").concat(u,".")})),a.assert(h.shape[2]===p.shape[1],(function(){return"Error in conv1d: depth of input (".concat(h.shape[2],") must match ")+"input depth for filter ".concat(p.shape[1],".")})),a.assert(o.eitherStridesOrDilationsAreOne(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.assert("NWC"===s,(function(){return"Error in conv1d: got dataFormat of ".concat(s," but only NWC is currently supported.")}));var g=c.reshape(p,[1,p.shape[0],p.shape[1],p.shape[2]]),m=c.reshape(h,[h.shape[0],1,h.shape[1],h.shape[2]]),y=[1,n],x=[1,l],b="NHWC",k=i.conv2d(m,g,y,u,b,x,f);return v?c.reshape(k,[k.shape[2],k.shape[3]]):c.reshape(k,[k.shape[0],k.shape[2],k.shape[3]])}})})),s.register("1DPo2",(function(e,t){n(e.exports,"conv2dTranspose",(function(){return i}));var r=s("lcVC1"),a=s("eWkFG");var i=s("f1skK").op({conv2dTranspose_:function(e,t,n,i,o,u){var s=r.convertToTensor(e,"x","conv2dTranspose"),c=r.convertToTensor(t,"filter","conv2dTranspose");return a.conv2DBackpropInput(n,s,c,i,o,"NHWC",u)}})})),s.register("bxgT2",(function(e,t){n(e.exports,"conv3d",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=(u=s("drGuD"),s("f1skK")),l=s("gldWN");var f=c.op({conv3d_:function(e,t,n,s){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],d=i.convertToTensor(e,"x","conv3d"),p=i.convertToTensor(t,"filter","conv3d"),h=d,v=!1;4===d.rank&&(v=!0,h=l.reshape(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.assert(5===h.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(h.rank,".")})),o.assert(5===p.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(p.rank,".")})),o.assert(h.shape[4]===p.shape[3],(function(){return"Error in conv3d: depth of input (".concat(h.shape[4],") must match ")+"input depth for filter ".concat(p.shape[3],".")})),o.assert(u.eitherStridesOrDilationsAreOne(n,f),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(f,"'")})),o.assert("NDHWC"===c,(function(){return"Error in conv3d: got dataFormat of ".concat(c," but only NDHWC is currently supported.")}));var g=function(e,t){var r=u.computeConv3DInfo(h.shape,p.shape,n,f,s),a=e.conv3d(h,p,r);return t([h,p]),a},m={x:h,filter:p},y={strides:n,pad:s,dataFormat:c,dilations:f},x=r.ENGINE.runKernelFunc(g,m,null,a.Conv3D,y);return v?l.reshape(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}})})),s.register("63G10",(function(e,t){n(e.exports,"conv3dTranspose",(function(){return i}));var r=s("lcVC1"),a=s("iFTVM");var i=s("f1skK").op({conv3dTranspose_:function(e,t,n,i,o){var u=r.convertToTensor(e,"x","conv3dTranspose"),s=r.convertToTensor(t,"filter","conv3dTranspose");return a.conv3DBackpropInput(n,u,s,i,o)}})})),s.register("46h8X",(function(e,t){n(e.exports,"depthToSpace",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN");var u=s("f1skK").op({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",u=i.convertToTensor(e,"x","depthToSpace"),s="NHWC"===n?u.shape[1]:u.shape[2],c="NHWC"===n?u.shape[2]:u.shape[3],l="NHWC"===n?u.shape[3]:u.shape[1];o.assert(s*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(s," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(u.shape)})),o.assert(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t," for depthToSpace with input shape\n        ").concat(u.shape)})),o.assert(l%(t*t)==0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(u.shape)}));var f=function(e){return e.depthToSpace(u,t,n)},d={x:u},p={blockSize:t,dataFormat:n};return r.ENGINE.runKernelFunc(f,d,null,a.DepthToSpace,p)}})})),s.register("j7yAW",(function(e,t){n(e.exports,"diag",(function(){return l})),s("1i51P");var r=s("9M1dW"),a=s("1dnDT"),i=s("cvMH2"),o=s("lcVC1"),u=s("f1skK"),c=s("gldWN");var l=u.op({diag_:function(e){var t=o.convertToTensor(e,"x","diag"),n={x:t};return a.ENGINE.runKernelFunc((function(n){var a=c.reshape(t,[t.size]),i=n.diag(a),o=r.default(e.shape).concat(r.default(e.shape));return c.reshape(i,o)}),n,null,i.Diag)}})})),s.register("8h0Lc",(function(e,t){n(e.exports,"dilation2d",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("f1skK"),c=s("gldWN");var l=u.op({dilation2d_:function(e,t,n,u){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",f=i.convertToTensor(e,"x","dilation2d"),d=i.convertToTensor(t,"filter","dilation2d");o.assert(3===f.rank||4===f.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(f.rank,".")})),o.assert(3===d.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(d.rank,".")})),o.assert("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var p=f,h=!1;3===f.rank&&(p=c.reshape(f,[1,f.shape[0],f.shape[1],f.shape[2]]),h=!0);var v={x:p,filter:d},g={strides:n,pad:u,dilations:s},m=r.ENGINE.runKernel(a.Dilation2D,v,g);return h?c.reshape(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})})),s.register("1DCIn",(function(e,t){n(e.exports,"divNoNan",(function(){return d})),s("1i51P");var r=s("6vecG"),a=s("gIxdA"),i=s("lcVC1"),o=s("6baO0"),u=s("iuFae"),c=s("f1skK"),l=s("6FAlx"),f=s("8p3bZ");var d=c.op({divNoNan_:function(e,t){var n,s=i.convertToTensor(e,"a","div"),c=i.convertToTensor(t,"b","div");s=(n=r.default(a.makeTypesMatch(s,c),2))[0],c=n[1];var d=o.div(s,c),p=f.zerosLike(d),h=u.equal(c,p);return l.where(h,p,d)}})})),s.register("7UdNs",(function(e,t){n(e.exports,"dot",(function(){return c}));var r=s("lcVC1"),a=s("kglvN"),i=s("5KHLt"),o=s("f1skK"),u=s("gldWN");var c=o.op({dot_:function(e,t){var n=r.convertToTensor(e,"t1","dot"),o=r.convertToTensor(t,"t2","dot");a.assert(!(1!==n.rank&&2!==n.rank||1!==o.rank&&2!==o.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")}));var s=1===n.rank?n.size:n.shape[1],c=1===o.rank?o.size:o.shape[0];if(a.assert(s===c,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+"".concat(s," and ").concat(c,".")})),1===n.rank&&1===o.rank){var l=u.reshape(n,[1,-1]),f=u.reshape(o,[-1,1]),d=i.matMul(l,f);return u.reshape(d,[])}if(1===n.rank&&2===o.rank){var p=u.reshape(n,[1,-1]),h=u.reshape(o,[o.shape[0],o.shape[1]]),v=i.matMul(p,h);return u.reshape(v,[v.size])}if(2===n.rank&&1===o.rank){var g=u.reshape(o,[-1,1]),m=i.matMul(n,g);return u.reshape(m,[m.size])}var y=u.reshape(o,[o.shape[0],o.shape[1]]);return i.matMul(n,y)}})})),s.register("c5hEb",(function(e,t){n(e.exports,"erf",(function(){return c}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("782ce");var c=s("f1skK").op({erf_:function(e){var t=i.convertToTensor(e,"x","erf");o.assert("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=u.cast(t,"float32"));var n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),n,null,a.Erf)}})})),s.register("lX82t",(function(e,t){n(e.exports,"expm1",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({expm1_:function(e){var t=i.convertToTensor(e,"x","expm1"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),n,null,a.Expm1)}})})),s.register("j3cEz",(function(e,t){n(e.exports,"isFinite",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({isFinite_:function(e){var t=i.convertToTensor(e,"x","isFinite"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.isFinite(t)}),n,null,a.IsFinite)}})})),s.register("cFDTG",(function(e,t){n(e.exports,"isInf",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({isInf_:function(e){var t=i.convertToTensor(e,"x","isInf"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.isInf(t)}),n,null,a.IsInf)}})})),s.register("d4DaY",(function(e,t){n(e.exports,"isNaN",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({isNaN_:function(e){var t=i.convertToTensor(e,"x","isNaN"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.isNaN(t)}),n,null,a.IsNan)}})})),s.register("1LZgP",(function(e,t){n(e.exports,"leakyRelu",(function(){return c}));var r=s("lcVC1"),a=s("k7Du7"),i=s("j0e1k"),o=s("f1skK"),u=s("bftEy");var c=o.op({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=r.convertToTensor(e,"x","leakyRelu");return a.maximum(i.mul(u.scalar(t),n),n)}})})),s.register("dPpnl",(function(e,t){n(e.exports,"linspace",(function(){return i}));var r=s("1dnDT"),a=s("cvMH2");function i(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var i={start:e,stop:t,num:n};return r.ENGINE.runKernelFunc((function(r){return r.linspace(e,t,n)}),{},null,a.LinSpace,i)}})),s.register("jq1h8",(function(e,t){n(e.exports,"localResponseNormalization",(function(){return l}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("f1skK"),c=s("gldWN");var l=u.op({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=i.convertToTensor(e,"x","localResponseNormalization");o.assert(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.assert(o.isInt(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var f=l,d=!1;3===l.rank&&(d=!0,f=c.reshape(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var p=function(e,r){var a=e.localResponseNormalization4D(f,t,n,u,s);return r([f,a]),a},h={x:f},v={depthRadius:t,bias:n,alpha:u,beta:s},g=r.ENGINE.runKernelFunc(p,h,null,a.LRN,v);return d?c.reshape(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})})),s.register("imK0S",(function(e,t){n(e.exports,"logSigmoid",(function(){return f}));var r=s("2c3OP"),a=s("lcVC1"),i=s("j0e1k"),o=s("ee0Eu"),u=s("f1skK"),c=s("5uQwR"),l=s("eQuwX");var f=u.op({logSigmoid_:function(e){var t=a.convertToTensor(e,"x","logSigmoid"),n=r.customGrad((function(e){return{value:o.neg(l.softplus(o.neg(e))),gradFunc:function(t){return i.mul(t,c.sigmoid(o.neg(e)))}}}));return n(t)}})})),s.register("eQuwX",(function(e,t){n(e.exports,"softplus",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({softplus_:function(e){var t=i.convertToTensor(e,"x","softplus"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),n,null,a.Softplus)}})})),s.register("bYmSd",(function(e,t){n(e.exports,"logSoftmax",(function(){return h}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("782ce"),u=s("byJMV"),c=s("WSSiT"),l=s("avJI0"),f=s("f1skK"),d=s("fZE7S"),p=s("2xCpB");var h=f.op({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=i.convertToTensor(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var s=function(n,r){var a=l.max(e,t,!0),i=d.sub(e,a),s=d.sub(o.cast(i,"float32"),c.log(p.sum(u.exp(i),t,!0)));return r([s]),s},f={logits:n},h={axis:t};return r.ENGINE.runKernelFunc(s,f,null,a.LogSoftmax,h)}})})),s.register("49dpo",(function(e,t){n(e.exports,"logicalOr",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kNwIt");var u=s("f1skK").op({logicalOr_:function(e,t){var n=i.convertToTensor(e,"a","logicalOr","bool"),u=i.convertToTensor(t,"b","logicalOr","bool");o.assertAndGetBroadcastShape(n.shape,u.shape);var s={a:n,b:u};return r.ENGINE.runKernelFunc((function(e){return e.logicalOr(n,u)}),s,null,a.LogicalOr)}})})),s.register("fiOos",(function(e,t){n(e.exports,"logicalXor",(function(){return c}));var r=s("lcVC1"),a=s("kNwIt"),i=s("7WLBj"),o=s("1bFci"),u=s("49dpo");var c=s("f1skK").op({logicalXor_:function(e,t){var n=r.convertToTensor(e,"a","logicalXor","bool"),s=r.convertToTensor(t,"b","logicalXor","bool");return a.assertAndGetBroadcastShape(n.shape,s.shape),i.logicalAnd(u.logicalOr(e,t),o.logicalNot(i.logicalAnd(e,t)))}})})),s.register("2dPgQ",(function(e,t){n(e.exports,"maxPool",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("drGuD"),c=s("f1skK"),l=s("gldWN");var f=c.op({maxPool_:function(e,t,n,s,c){var f=i.convertToTensor(e,"x","maxPool"),d=f,p=!1;3===f.rank&&(p=!0,d=l.reshape(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.assert(4===d.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(d.rank,".")})),o.assert(u.eitherStridesOrDilationsAreOne(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=c&&o.assert(o.isInt(s),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(c," but got pad ").concat(s,".")}));var h={x:d},v={filterSize:t,strides:n,pad:s,dimRoundingMode:c},g=r.ENGINE.runKernelFunc((function(e,r){var a,i=u.computePool2DInfo(d.shape,t,n,1,s,c);return a=1===i.filterWidth&&1===i.filterHeight&&o.arraysEqual(i.inShape,i.outShape)?d.clone():e.maxPool(d,i),r([d,a]),a}),h,null,a.MaxPool,v);return p?l.reshape(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})})),s.register("181UU",(function(e,t){n(e.exports,"maxPool3d",(function(){return d}));var r=s("1dnDT"),a=s("P1tXK"),i=s("cvMH2"),o=s("lcVC1"),u=s("kglvN"),c=s("drGuD"),l=s("f1skK"),f=s("gldWN");var d=l.op({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,l=arguments.length>4?arguments[4]:void 0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",p=arguments.length>6?arguments[6]:void 0;null==p?p=[1,1,1]:a.deprecationWarn("dilations is deprecated, this field will be gone in v3.0.0.");var h=o.convertToTensor(e,"x","maxPool3d"),v=h,g=!1;4===h.rank&&(g=!0,v=f.reshape(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),u.assert(5===v.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(v.rank,".")})),u.assert("NDHWC"===d,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(d)})),u.assert(c.eitherStridesOrDilationsAreOne(n,p),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(p,"'")})),null!=l&&u.assert(u.isInt(s),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(s,".")}));var m=function(e,r){null==p&&(p=[1,1,1]);var a=c.computePool3DInfo(v.shape,t,n,p,s,l,d),i=e.maxPool3d(v,a);return r([v,i]),i},y={x:v},x={filterSize:t,strides:n,pad:s,dimRoundingMode:l,dataFormat:d,dilations:p},b=r.ENGINE.runKernelFunc(m,y,null,i.MaxPool3D,x);return g?f.reshape(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})})),s.register("lsNiP",(function(e,t){n(e.exports,"maxPoolWithArgmax",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({maxPoolWithArgmax_:function(e,t,n,o){var u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=i.convertToTensor(e,"x","maxPoolWithArgmax"),c={x:s},l={filterSize:t,strides:n,pad:o,includeBatchInIndex:u},f=r.ENGINE.runKernel(a.MaxPoolWithArgmax,c,l);return{result:f[0],indexes:f[1]}}})})),s.register("hQKIK",(function(e,t){n(e.exports,"mod",(function(){return c})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("gIxdA"),u=s("lcVC1");var c=s("f1skK").op({mod_:function(e,t){var n,s=u.convertToTensor(e,"a","mod"),c=u.convertToTensor(t,"b","mod");n=r.default(o.makeTypesMatch(s,c),2),s=n[0],c=n[1];var l={a:s,b:c};return a.ENGINE.runKernelFunc((function(e,t){var n=e.mod(s,c);return t([s,c]),n}),l,null,i.Mod)}})})),s.register("bRIeS",(function(e,t){n(e.exports,"moments",(function(){return p}));var r=s("lcVC1"),a=s("kglvN"),i=s("4RRNB"),o=s("782ce"),u=s("4804C"),c=s("f1skK"),l=s("gldWN"),f=s("4C8ia"),d=s("fZE7S");var p=c.op({moments_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=r.convertToTensor(e,"x","moments");var s=a.parseAxisParam(t,e.shape),c=u.mean(e,s,n),p=c.shape;n||(p=i.expandShapeToKeepDim(c.shape,s));var h=f.square(d.sub(o.cast(e,"float32"),l.reshape(c,p))),v=u.mean(h,s,n);return{mean:c,variance:v}}})})),s.register("lV6Sm",(function(e,t){n(e.exports,"multiRNNCell",(function(){return a}));var r=s("lcVC1");var a=s("f1skK").op({multiRNNCell_:function(e,t,n,a){for(var i=r.convertToTensor(t,"data","multiRNNCell"),o=r.convertToTensorArray(n,"c","multiRNNCell"),u=r.convertToTensorArray(a,"h","multiRNNCell"),s=i,c=[],l=0;l<e.length;l++){var f=e[l](s,o[l],u[l]);c.push(f[0]),c.push(f[1]),s=f[1]}for(var d=[],p=[],h=0;h<c.length;h+=2)d.push(c[h]),p.push(c[h+1]);return[d,p]}})})),s.register("1SpQu",(function(e,t){n(e.exports,"multinomial",(function(){return u}));var r=s("1dnDT"),a=s("lcVC1"),i=s("f1skK"),o=s("gldWN");var u=i.op({multinomial_:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=a.convertToTensor(e,"logits","multinomial"),s=u.size,c=u.rank;if(s<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(s,"."));if(c>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(c));n=n||Math.random();var l=1===c?o.reshape(u,[1,-1]):u,f=r.ENGINE.runKernelFunc((function(e){return e.multinomial(l,i,t,n)}),{logits2D:l});return 1===c?o.reshape(f,[f.size]):f}})})),s.register("9ZTJv",(function(e,t){n(e.exports,"oneHot",(function(){return l})),s("1i51P");var r=s("9M1dW"),a=s("1dnDT"),i=s("cvMH2"),o=s("lcVC1"),u=s("f1skK"),c=s("gldWN");var l=u.op({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var s=o.convertToTensor(e,"indices","oneHot","int32"),l=r.default(s.shape).concat([t]),f=function(e,r){return r([s]),c.reshape(e.oneHot(c.reshape(s,[s.size]),t,n,u),l)},d={indices:s},p={depth:t,onValue:n,offValue:u};return a.ENGINE.runKernelFunc(f,d,null,i.OneHot,p)}})})),s.register("4z0yD",(function(e,t){n(e.exports,"onesLike",(function(){return d}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("3IcUj"),u=s("hXj3N"),c=s("f1skK"),l=s("2acG6"),f=s("8p3bZ");var d=c.op({onesLike_:function(e){var t=i.convertToTensor(e,"x","onesLike"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){if("complex64"===t.dtype){var r=d(l.real(t)),a=f.zerosLike(u.imag(t));return o.complex(r,a)}return e.onesLike(t)}),n,null,a.OnesLike)}})})),s.register("9rcKy",(function(e,t){n(e.exports,"outerProduct",(function(){return c}));var r=s("lcVC1"),a=s("kglvN"),i=s("5KHLt"),o=s("f1skK"),u=s("gldWN");var c=o.op({outerProduct_:function(e,t){var n=r.convertToTensor(e,"v1","outerProduct"),o=r.convertToTensor(t,"v2","outerProduct");a.assert(1===n.rank&&1===o.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+"".concat(n.rank," and ").concat(o.rank,".")}));var s=u.reshape(n,[-1,1]),c=u.reshape(o,[1,-1]);return i.matMul(s,c)}})})),s.register("lIW56",(function(e,t){n(e.exports,"pad1d",(function(){return o}));var r=s("kglvN"),a=s("f1skK"),i=s("elYe2");var o=a.op({pad1d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r.assert(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),i.pad(e,[t],n)}})})),s.register("cc4Di",(function(e,t){n(e.exports,"pad2d",(function(){return o}));var r=s("kglvN"),a=s("f1skK"),i=s("elYe2");var o=a.op({pad2d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r.assert(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),i.pad(e,t,n)}})})),s.register("iSlCw",(function(e,t){n(e.exports,"pad3d",(function(){return o}));var r=s("kglvN"),a=s("f1skK"),i=s("elYe2");var o=a.op({pad3d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r.assert(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),i.pad(e,t,n)}})})),s.register("6THdB",(function(e,t){n(e.exports,"pad4d",(function(){return o}));var r=s("kglvN"),a=s("f1skK"),i=s("elYe2");var o=a.op({pad4d_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r.assert(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),i.pad(e,t,n)}})})),s.register("l6jFw",(function(e,t){n(e.exports,"pool",(function(){return h})),s("1i51P");var r=s("6vecG"),a=s("lcVC1"),i=s("kglvN"),o=s("WcUsE"),u=s("fiGYl"),c=s("drGuD"),l=s("2dPgQ"),f=s("f1skK"),d=s("gldWN"),p=s("h7Gux");var h=f.op({pool_:function(e,t,n,s,f,h){null==f&&(f=[1,1]),null==h&&(h=1),0===s&&(s="valid");var v=a.convertToTensor(e,"x","maxPool"),g=v,m=!1;3===v.rank&&(m=!0,g=d.reshape(v,[1,v.shape[0],v.shape[1],v.shape[2]])),i.assert(c.eitherStridesOrDilationsAreOne(h,f),(function(){return"Error in pool: Either strides or dilations must be 1. "+"Got strides ".concat(h," and dilations '").concat(f,"'")}));var y,x=c.computePool2DInfo(g.shape,t,h,f,s),b=[x.dilationHeight,x.dilationWidth];y="same"===s?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([x.filterHeight,x.filterWidth],b):[[0,0],[0,0]];var k=1===b[0]&&1===b[1],w=r.default(function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),u=a.map((function(e,t){return e+o[t]})),s=t.map((function(e,t){return[r[t],u[t]]})),c=t.map((function(e,t){return[0,o[t]]}));return[s,c]}([x.inHeight,x.inWidth],b,y),2),A=w[0],E=w[1],C=k?s:"valid",S=k?g:p.spaceToBatchND(g,b,A),N=("avg"===n?function(){return o.avgPool(S,t,h,C)}:function(){return l.maxPool(S,t,h,C)})(),T=k?N:u.batchToSpaceND(N,b,E);return m?d.reshape(T,[T.shape[1],T.shape[2],T.shape[3]]):T}})})),s.register("iGcXf",(function(e,t){n(e.exports,"prod",(function(){return p}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("kglvN"),u=s("4RRNB"),c=s("782ce"),l=s("f1skK"),f=s("gldWN"),d=s("9PS5J");var p=l.op({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=i.convertToTensor(e,"x","prod"),l=function(e){"bool"===s.dtype&&(s=c.cast(s,"int32"));var r=o.parseAxisParam(t,s.shape),a=u.getAxesPermutation(r,s.rank),i=r,l=s;null!=a&&(l=d.transpose(s,a),i=u.getInnerMostAxes(i.length,s.rank));var p=e.prod(l,i);if(n){var h=u.expandShapeToKeepDim(p.shape,r);p=f.reshape(p,h)}return p},p={x:s},h={axis:t,keepDims:n};return r.ENGINE.runKernelFunc(l,p,null,a.Prod,h)}})})),s.register("aOJMk",(function(e,t){n(e.exports,"rand",(function(){return i}));var r=s("1dnDT"),a=s("kglvN");var i=s("f1skK").op({rand_:function(e,t,n){var i=a.sizeFromShape(e),o=null;if(null==n||"float32"===n)o=new Float32Array(i);else if("int32"===n)o=new Int32Array(i);else{if("bool"!==n)throw new Error("Unknown data type ".concat(n));o=new Uint8Array(i)}for(var u=0;u<i;u++)o[u]=t();return r.ENGINE.makeTensor(o,e,n)}})})),s.register("l1WmC",(function(e,t){n(e.exports,"randomGamma",(function(){return o}));var r=s("8orDI"),a=s("f1skK"),i=s("eQBNf");var o=a.op({randomGamma_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0;if(null==n&&(n=1),null==a&&(a="float32"),"float32"!==a&&"int32"!==a)throw new Error("Unsupported data type ".concat(a));for(var u=new i.RandGamma(t,n,a,o),s=r.buffer(e,a),c=0;c<s.values.length;c++)s.values[c]=u.nextValue();return s.toTensor()}})})),s.register("eQBNf",(function(e,t){n(e.exports,"MPRandGauss",(function(){return o})),n(e.exports,"RandGamma",(function(){return u})),n(e.exports,"UniformRandom",(function(){return c})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("1Rhbk"),o=(s("4XRKR"),function(){"use strict";function e(t,n,a,o,u){r.default(this,e),this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var s=u||Math.random();this.random=i.alea(s.toString())}return a.default(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var u=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*u,n=this.mean+this.stdDev*i*u,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}()),u=function(){"use strict";function e(t,n,a,u){r.default(this,e),this.alpha=t,this.beta=1/n,this.dtype=a;var s=u||Math.random();this.randu=i.alea(s.toString()),this.randn=new o(0,1,a,!1,this.randu()),this.d=t<1?t+2/3:t-1/3,this.c=1/Math.sqrt(9*this.d)}return a.default(e,[{key:"nextValue",value:function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}},{key:"convertValue",value:function(e){return"float32"===this.dtype?e:Math.round(e)}}]),e}(),c=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,u=this;if(r.default(this,e),this.canReturnFloat=function(){return null==u.dtype||"float32"===u.dtype},this.min=t,this.range=n-t,this.dtype=a,null==o&&(o=Math.random()),"number"==typeof o&&(o=o.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(t," - ").concat(n," <= 1 and dtype is not float"));this.random=i.alea(o)}return a.default(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}()})),s.register("1Rhbk",(function(e,t){var n=s("7igkP"),r=s("irIS3"),a=s("6lDfc"),i=s("iyAJf"),o=s("7BskM"),u=s("gB547"),c=s("dqi7q");c.alea=n,c.xor128=r,c.xorwow=a,c.xorshift7=i,c.xor4096=o,c.tychei=u,e.exports=c})),s.register("7igkP",(function(e,t){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.alea=i}(0,e,"function"==typeof define&&define)})),s.register("irIS3",(function(e,t){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xor128=i}(0,e,"function"==typeof define&&define)})),s.register("6lDfc",(function(e,t){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xorwow=i}(0,e,"function"==typeof define&&define)})),s.register("iyAJf",(function(e,t){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},o.int32=n.next,o.quick=o,i&&(i.x&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xorshift7=i}(0,e,"function"==typeof define&&define)})),s.register("7BskM",(function(e,t){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,u=[],s=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,s=Math.max(s,t.length)),a=0,i=-32;i<s;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=u[127&i]^=r+o)?a+1:0);for(a>=128&&(u[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=u[a+34&127],n=u[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,u[a]=r^n;e.w=o,e.X=u,e.i=a}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},o.int32=n.next,o.quick=o,i&&(i.X&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.xor4096=i}(0,e,"function"==typeof define&&define)})),s.register("gB547",(function(e,t){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/2097152}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:n&&n.amd?n((function(){return i})):this.tychei=i}(0,e,"function"==typeof define&&define)})),s.register("dqi7q",(function(e,t){s("1i51P");var n=s("5lcaY");!function(t,r){var a,i=this,o=256,u=r.pow(o,6),c=r.pow(2,52),l=2*c,f=255;function d(e,n,s){var f=[],d=g(v((n=1==n?{entropy:!0}:n||{}).entropy?[e,m(t)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(o):(e=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(t)]}}():e,3),f),y=new p(f),x=function(){for(var e=y.g(6),t=u,n=0;e<c;)e=(e+n)*o,t*=o,n=y.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|y.g(4)},x.quick=function(){return y.g(4)/4294967296},x.double=x,g(m(y.S),t),(n.pass||s||function(e,t,n,a){return a&&(a.S&&h(a,y),e.state=function(){return h(y,{})}),n?(r.random=e,t):e})(x,d,"global"in n?n.global:this==r,n.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,u=r.S=[];for(n||(e=[n++]);a<o;)u[a]=a++;for(a=0;a<o;a++)u[a]=u[i=f&i+e[a%n]+(t=u[a])],u[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,u=r.S;e--;)t=u[a=f&a+1],n=n*o+u[f&(u[a]=u[i=f&i+t])+(u[i]=t)];return r.i=a,r.j=i,n})(o)}function h(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var r,a=[],i=void 0===e?"undefined":n.default(e);if(t&&"object"==i)for(r in e)try{a.push(v(e[r],t-1))}catch(e){}return a.length?a:"string"==i?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(r.seedrandom=d,g(r.random(),t),e.exports){e.exports=d;try{a=s("jebYF")}catch(e){}}else"function"==typeof define&&define.amd&&define((function(){return d}))}([],Math)})),s.register("4XRKR",(function(e,t){n(e.exports,"TEST_EPSILON_FLOAT16",(function(){return o})),n(e.exports,"expectArraysClose",(function(){return u})),n(e.exports,"testEpsilon",(function(){return c})),n(e.exports,"expectPromiseToFail",(function(){return f})),n(e.exports,"expectArraysEqual",(function(){return d})),n(e.exports,"expectNumbersClose",(function(){return p})),n(e.exports,"expectValuesInRange",(function(){return v})),n(e.exports,"expectArrayBuffersEqual",(function(){return g}));var r=s("1dnDT"),a=s("lcVC1"),i=s("kglvN"),o=.1;function u(e,t,n){return null==n&&(n=c()),l(e,t,(function(e,t){return h(e,t,n)}))}function c(){return 32===r.ENGINE.backend.floatPrecision()?.001:o}function l(e,t,n){var r=!0;if((i.isTypedArray(e)||i.isTypedArray(t))&&(r=!1),i.isTypedArray(e)&&i.isTypedArray(t)&&(r=!0),r){var o=e.constructor.name,u=t.constructor.name;if(o!==u)throw new Error("Arrays are of different type. Actual: ".concat(o,". ")+"Expected: ".concat(u))}if(Array.isArray(e)&&Array.isArray(t)){var s=a.inferShape(e),c=a.inferShape(t);if(!i.arraysEqual(s,c))throw new Error("Arrays have different shapes. "+"Actual: [".concat(s,"]. Expected: [").concat(c,"]"))}var l=i.isTypedArray(e)?e:i.flatten(e),f=i.isTypedArray(t)?t:i.flatten(t);if(l.length!==f.length)throw new Error("Arrays have different lengths actual: ".concat(l.length," vs ")+"expected: ".concat(f.length,".\n")+"Actual:   ".concat(l,".\n")+"Expected: ".concat(f,"."));for(var d=0;d<f.length;++d){var p=l[d],h=f[d];if(!n(p,h))throw new Error("Arrays differ: actual[".concat(d,"] = ").concat(p,", expected[").concat(d,"] = ").concat(h,".\n")+"Actual:   ".concat(l,".\n")+"Expected: ".concat(f,"."))}}function f(e,t){e().then((function(){return t.fail()}),(function(){return t()}))}function d(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return i.isString(e)||i.isString(e[0])||i.isString(t)||i.isString(t[0])?l(e,n,(function(e,t){return e==t})):l(e,t,(function(e,t){return h(e,t,0)}))}function p(e,t,n){if(null==n&&(n=c()),!h(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t))}function h(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}function v(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:".concat(e[r]," low: ").concat(t,", high: ").concat(n))}function g(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}})),s.register("5Qmo8",(function(e,t){n(e.exports,"randomNormal",(function(){return o}));var r=s("8orDI"),a=s("f1skK"),i=s("eQBNf");var o=a.op({randomNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type ".concat(a));for(var u=new i.MPRandGauss(t,n,a,!1,o),s=r.buffer(e,a),c=0;c<s.values.length;c++)s.values[c]=u.nextValue();return s.toTensor()}})})),s.register("1GxQM",(function(e,t){n(e.exports,"randomUniform",(function(){return o}));var r=s("8orDI"),a=s("f1skK"),i=s("eQBNf");var o=a.op({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0,u=r.buffer(e,a),s=new i.UniformRandom(t,n,null,o),c=0;c<u.values.length;c++)u.values[c]=s.nextValue();return u.toTensor()}})})),s.register("1FDpf",(function(e,t){n(e.exports,"reciprocal",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({reciprocal_:function(e){var t=i.convertToTensor(e,"x","reciprocal"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),n,null,a.Reciprocal)}})})),s.register("hUanB",(function(e,t){n(e.exports,"reverse1d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("hYjAM");var u=i.op({reverse1d_:function(e){var t=r.convertToTensor(e,"x","reverse");return a.assert(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank ".concat(t.rank,".")})),o.reverse(t,0)}})})),s.register("eRHoj",(function(e,t){n(e.exports,"reverse2d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("hYjAM");var u=i.op({reverse2d_:function(e,t){var n=r.convertToTensor(e,"x","reverse");return a.assert(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank ".concat(n.rank,".")})),o.reverse(n,t)}})})),s.register("43t4p",(function(e,t){n(e.exports,"reverse3d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("hYjAM");var u=i.op({reverse3d_:function(e,t){var n=r.convertToTensor(e,"x","reverse");return a.assert(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank ".concat(n.rank,".")})),o.reverse(n,t)}})})),s.register("fG12c",(function(e,t){n(e.exports,"reverse4d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("hYjAM");var u=i.op({reverse4d_:function(e,t){var n=r.convertToTensor(e,"x","reverse");return a.assert(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank ".concat(n.rank,".")})),o.reverse(n,t)}})})),s.register("8Irjk",(function(e,t){n(e.exports,"round",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({round_:function(e){var t=i.convertToTensor(e,"x","round"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.round(t)}),n,null,a.Round)}})})),s.register("lKM5m",(function(e,t){n(e.exports,"selu",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({selu_:function(e){var t=i.convertToTensor(e,"x","selu"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),n,null,a.Selu)}})})),s.register("jHQP9",(function(e,t){n(e.exports,"separableConv2d",(function(){return l}));var r=s("lcVC1"),a=s("kglvN"),i=s("dH9u6"),o=s("btnhd"),u=s("f1skK"),c=s("gldWN");var l=u.op({separableConv2d_:function(e,t,n,u,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NHWC",d=r.convertToTensor(e,"x","separableConv2d"),p=r.convertToTensor(t,"depthwiseFilter","separableConv2d"),h=r.convertToTensor(n,"pointwiseFilter","separableConv2d"),v=d,g=!1;if(3===d.rank&&(g=!0,v=c.reshape(d,[1,d.shape[0],d.shape[1],d.shape[2]])),"NCHW"===f)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");a.assert(4===v.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got "+"rank ".concat(v.rank,".")})),a.assert(4===p.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but "+"got rank ".concat(p.rank,".")})),a.assert(4===h.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but "+"got rank ".concat(p.rank,".")})),a.assert(1===h.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter "+" must be 1, but got ".concat(h.shape[0],".")})),a.assert(1===h.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise "+"filter must be 1, but got ".concat(h.shape[1],".")}));var m=p.shape[2],y=p.shape[3];a.assert(h.shape[2]===m*y,(function(){return"Error in separableConv2d: the third dimension of pointwise filter "+"must be ".concat(m*y,", ")+"but got ".concat(h.shape[2],".")}));var x=o.depthwiseConv2d(v,p,u,s,f,l),b=1,k=i.conv2d(x,h,b,"valid",f);return g?c.reshape(k,[k.shape[1],k.shape[2],k.shape[3]]):k}})})),s.register("fFUjj",(function(e,r){n(e.exports,"setdiff1dAsync",(function(){return f})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("4JvjV"),u=s("lcVC1"),c=s("kglvN");function l(){return l=a.default(t(i).mark((function e(n,r){var a,s,l,f,d,p,h,v,g,m,y;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=u.convertToTensor(n,"x","setdiff1d"),s=u.convertToTensor(r,"y","setdiff1d"),c.assert(a.dtype===s.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(a.dtype,") and y (").concat(s.dtype,").")})),c.assert(1===a.rank,(function(){return"x should be 1D tensor, but got x (".concat(a.shape,").")})),c.assert(1===s.rank,(function(){return"y should be 1D tensor, but got y (".concat(s.shape,").")})),e.next=7,a.data();case 7:return l=e.sent,e.next=10,s.data();case 10:for(f=e.sent,d=new Set(f),p=0,h=0;h<l.length;h++)d.has(l[h])||p++;for(v=new o.TensorBuffer([p],a.dtype),g=new o.TensorBuffer([p],"int32"),m=0,y=0;m<l.length;m++)d.has(l[m])||(v.values[y]=l[m],g.values[y]=m,y++);return e.abrupt("return",[v.toTensor(),g.toTensor()]);case 18:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var f=function(e,t){return l.apply(this,arguments)}})),s.register("d10y4",(function(e,t){n(e.exports,"sign",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({sign_:function(e){var t=i.convertToTensor(e,"x","sign"),n={x:t};return r.ENGINE.runKernelFunc((function(e){return e.sign(t)}),n,null,a.Sign)}})})),s.register("djXCd",(function(e,t){n(e.exports,"slice1d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("jPaTA");var u=i.op({slice1d_:function(e,t,n){var i=r.convertToTensor(e,"x","slice1d");return a.assert(1===i.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-".concat(i.rank," tensor")})),o.slice(i,[t],[n])}})})),s.register("dd8tD",(function(e,t){n(e.exports,"slice2d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("jPaTA");var u=i.op({slice2d_:function(e,t,n){var i=r.convertToTensor(e,"x","slice2d");return a.assert(2===i.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-".concat(i.rank," tensor")})),o.slice(i,t,n)}})})),s.register("2KAsd",(function(e,t){n(e.exports,"slice3d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("jPaTA");var u=i.op({slice3d_:function(e,t,n){var i=r.convertToTensor(e,"x","slice3d");return a.assert(3===i.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-".concat(i.rank," tensor")})),o.slice(i,t,n)}})})),s.register("jxscz",(function(e,t){n(e.exports,"slice4d",(function(){return u}));var r=s("lcVC1"),a=s("kglvN"),i=s("f1skK"),o=s("jPaTA");var u=i.op({slice4d_:function(e,t,n){var i=r.convertToTensor(e,"x","slice4d");return a.assert(4===i.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-".concat(i.rank," tensor")})),o.slice(i,t,n)}})})),s.register("etmQx",(function(e,t){n(e.exports,"softmax",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=i.convertToTensor(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var o={logits:n},u={dim:t};return r.ENGINE.runKernelFunc((function(e,r){var a=e.softmax(n,t);return r([a]),a}),o,null,a.Softmax,u)}})})),s.register("fTdnV",(function(e,t){n(e.exports,"stridedSlice",(function(){return f}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("f1skK"),u=s("gldWN"),c=s("jPaTA"),l=s("aK0eq");var f=o.op({stridedSlice_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,f=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,p=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,v=i.convertToTensor(e,"x","stridedSlice"),g=function(e){null==o&&(o=new Array(t.length));var r=l.maskToAxes(d);if(r.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==d&&0!==p)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==d&&0!==h)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var a=v.rank-t.length,i=l.maskToAxes(p),g=v.shape.slice();i.forEach((function(e){t[e]=0,n[e]=1,g.splice(e,0,1)})),v=u.reshape(v,g);var m=l.getNormalizedAxes(v.shape,r,a,t,n,o,s,f,d),y=m.begin,x=m.end,b=m.strides;t=y,n=x,o=b;var k=l.maskToAxes(h);k.forEach((function(e){n[e]=t[e]+1,o[e]=1}));var w=l.computeOutShape(t,n,o),A=w.filter((function(e,t){return-1===k.indexOf(t)}));if(o.every((function(e){return 1===e})))return u.reshape(c.slice(v,t,w),A);var E=e.stridedSlice(v,t,n,o);return u.reshape(E,A)},m={x:v},y={begin:t,end:n,strides:o,beginMask:s,endMask:f,ellipsisMask:d,newAxisMask:p,shrinkAxisMask:h};return r.ENGINE.runKernelFunc(g,m,null,a.StridedSlice,y)}})})),s.register("jc2CK",(function(e,t){n(e.exports,"tan",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({tan_:function(e){var t=i.convertToTensor(e,"x","tan"),n={x:t};return r.ENGINE.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),n,null,a.Tan)}})})),s.register("a5FCc",(function(e,t){n(e.exports,"tensor3d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("fTjN4");function o(e,t,n){if(a.assertNonNull(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var o=r.inferShape(e,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return i.makeTensor(e,t,o,n)}})),s.register("a0S6X",(function(e,t){n(e.exports,"tensor4d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("fTjN4");function o(e,t,n){if(a.assertNonNull(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var o=r.inferShape(e,n);if(4!==o.length&&1!==o.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return i.makeTensor(e,t,o,n)}})),s.register("1JEgs",(function(e,t){n(e.exports,"tensor5d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("fTjN4");function o(e,t,n){if(a.assertNonNull(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var o=r.inferShape(e,n);if(5!==o.length&&1!==o.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return i.makeTensor(e,t,o,n)}})),s.register("9aiVe",(function(e,t){n(e.exports,"tensor6d",(function(){return o}));var r=s("lcVC1"),a=s("kglvN"),i=s("fTjN4");function o(e,t,n){if(a.assertNonNull(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var o=r.inferShape(e,n);if(6!==o.length&&1!==o.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return t=t||o,i.makeTensor(e,t,o,n)}})),s.register("1jhOm",(function(e,t){n(e.exports,"topk",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("1dnDT"),i=s("cvMH2"),o=s("lcVC1");var u=s("f1skK").op({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],u=o.convertToTensor(e,"x","topk");if(0===u.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var s=u.shape[u.shape.length-1];if(t>s)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(s,") ")+"but got ".concat(t));var c={x:u},l={k:t,sorted:n},f=r.default(a.ENGINE.runKernelFunc((function(e){return e.topk(u,t,n)}),c,null,i.TopK,l),2),d=f[0],p=f[1];return{values:d,indices:p}}})})),s.register("dqB3G",(function(e,t){n(e.exports,"truncatedNormal",(function(){return o}));var r=s("8orDI"),a=s("f1skK"),i=s("eQBNf");var o=a.op({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");for(var u=new i.MPRandGauss(t,n,a,!0,o),s=r.buffer(e,a),c=0;c<s.values.length;c++)s.values[c]=u.nextValue();return s.toTensor()}})})),s.register("4ETT0",(function(e,t){n(e.exports,"variable",(function(){return a}));var r=s("1dnDT");function a(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;return r.ENGINE.makeVariable(e,t,n,a)}})),s.register("cxotR",(function(e,r){n(e.exports,"whereAsync",(function(){return l})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("ah74e"),u=s("lcVC1");function c(){return c=a.default(t(i).mark((function e(n){var r,a,s;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.convertToTensor(n,"condition","whereAsync","bool"),e.next=3,r.data();case 3:return a=e.sent,s=o.whereImpl(r.shape,a),n!==r&&r.dispose(),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)}))),c.apply(this,arguments)}var l=function(e){return c.apply(this,arguments)}})),s.register("ah74e",(function(e,t){n(e.exports,"whereImpl",(function(){return a}));var r=s("8orDI");function a(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);for(var i=r.buffer(e,"int32"),o=r.buffer([n.length,e.length],"int32"),u=0;u<n.length;u++){var s=i.indexToLoc(n[u]),c=u*e.length;o.values.set(s,c)}return o.toTensor()}})),s.register("jl6td",(function(e,r){n(e.exports,"booleanMaskAsync",(function(){return h})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("lcVC1"),u=s("kglvN"),c=s("17OvF"),l=s("gldWN"),f=s("4y8cw"),d=s("cxotR");function p(){return(p=a.default(t(i).mark((function e(n,r,a){var s,p,h,v,g,m,y,x,b,k,w,A,E;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(s=o.convertToTensor(n,"tensor","boolMask"),p=o.convertToTensor(r,"mask","boolMask","bool"),h=null==a?0:a,v=p.rank,g=s.shape,u.assert(v>0,(function(){return"mask cannot be scalar"})),u.assertShapesMatch(g.slice(h,h+v),p.shape,"mask's shape must match the first K dimensions of tensor's shape,"),m=1,y=h;y<h+v;y++)m*=g[y];return x=g.slice(0,h).concat([m],g.slice(h+v)),b=l.reshape(s,x),k=l.reshape(p,[-1]),e.next=14,d.whereAsync(k);case 14:return w=e.sent,A=f.squeeze(w,[1]),E=c.gather(b,A,h),n!==s&&s.dispose(),r!==p&&p.dispose(),A.dispose(),b.dispose(),k.dispose(),w.dispose(),e.abrupt("return",E);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var h=function(e,t,n){return p.apply(this,arguments)}})),s.register("1AnXD",(function(e,t){n(e.exports,"equalStrict",(function(){return h})),n(e.exports,"greaterEqualStrict",(function(){return v})),n(e.exports,"greaterStrict",(function(){return g})),n(e.exports,"lessEqualStrict",(function(){return m})),n(e.exports,"lessStrict",(function(){return y})),n(e.exports,"notEqualStrict",(function(){return x}));var r=s("P1tXK"),a=s("lcVC1"),i=s("kglvN"),o=s("iuFae"),u=s("ejjI8"),c=s("6Bgjr"),l=s("dKHZ2"),f=s("j0AHg"),d=s("7owLz"),p=s("f1skK");var h=p.op({equalStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","equalStrict"),u=a.convertToTensor(t,"b","equalStrict");return i.assertShapesMatch(n.shape,u.shape,"Error in equalStrict: "),o.equal(n,u)}}),v=p.op({greaterEqualStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","greaterEqualStrict"),o=a.convertToTensor(t,"b","greaterEqualStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in greaterEqualStrict: "),c.greaterEqual(n,o)}}),g=p.op({greaterStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","greaterStrict"),o=a.convertToTensor(t,"b","greaterStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in greaterStrict: "),u.greater(n,o)}}),m=p.op({lessEqualStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","lessEqualStrict"),o=a.convertToTensor(t,"b","lessEqualStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in lessEqualStrict: "),f.lessEqual(n,o)}}),y=p.op({lessStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","lessStrict"),o=a.convertToTensor(t,"b","lessStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in lessStrict: "),l.less(n,o)}}),x=p.op({notEqualStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","notEqualStrict"),o=a.convertToTensor(t,"b","notEqualStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in notEqualStrict: "),d.notEqual(n,o)}})})),s.register("bLCbB",(function(e,t){n(e.exports,"addStrict",(function(){return m})),n(e.exports,"divStrict",(function(){return y})),n(e.exports,"maximumStrict",(function(){return x})),n(e.exports,"minimumStrict",(function(){return b})),n(e.exports,"modStrict",(function(){return k})),n(e.exports,"mulStrict",(function(){return w})),n(e.exports,"powStrict",(function(){return A})),n(e.exports,"squaredDifferenceStrict",(function(){return E})),n(e.exports,"subStrict",(function(){return C}));var r=s("P1tXK"),a=s("lcVC1"),i=s("kglvN"),o=s("b3Qcj"),u=s("6baO0"),c=s("k7Du7"),l=s("eu81x"),f=s("hQKIK"),d=s("j0e1k"),p=s("f1skK"),h=s("WvbbQ"),v=s("lfNC8"),g=s("fZE7S");var m=p.op({addStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","addStrict"),u=a.convertToTensor(t,"b","addStrict");return i.assertShapesMatch(n.shape,u.shape,"Error in addStrict: "),o.add(n,u)}}),y=p.op({divStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","div"),o=a.convertToTensor(t,"b","div");return i.assertShapesMatch(n.shape,o.shape,"Error in divideStrict: "),u.div(n,o)}}),x=p.op({maximumStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","maximumStrict"),o=a.convertToTensor(t,"b","maximumStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in maximumStrict: "),c.maximum(n,o)}}),b=p.op({minimumStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","minimumStrict"),o=a.convertToTensor(t,"b","minimumStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in minimumStrict: "),l.minimum(n,o)}}),k=p.op({modStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","modStrict"),o=a.convertToTensor(t,"b","modStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in modStrict: "),f.mod(n,o)}}),w=p.op({mulStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","mul"),o=a.convertToTensor(t,"b","mul");return i.assertShapesMatch(n.shape,o.shape,"Error in multiplyStrict: "),d.mul(n,o)}}),A=p.op({powStrict_:function(e,t){return r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future"),i.assertShapesMatch(e.shape,t.shape,"Error in powStrict: "),h.pow(e,t)}}),E=p.op({squaredDifferenceStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","squaredDifferenceStrict"),o=a.convertToTensor(t,"b","squaredDifferenceStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in squaredDifferenceStrict: "),v.squaredDifference(n,o)}}),C=p.op({subStrict_:function(e,t){r.deprecationWarn("strict variants of ops have been deprecated and will be removed in future");var n=a.convertToTensor(e,"a","subStrict"),o=a.convertToTensor(t,"b","subStrict");return i.assertShapesMatch(n.shape,o.shape,"Error in subStrict: "),g.sub(n,o)}})})),s.register("8ZlyQ",(function(e,t){n(e.exports,"movingAverage",(function(){return h}));var r=s("gIxdA"),a=s("lcVC1"),i=s("kglvN"),o=s("b3Qcj"),u=s("6baO0"),c=s("j0e1k"),l=s("f1skK"),f=s("WvbbQ"),d=s("bftEy"),p=s("fZE7S");var h=l.op({movingAverage_:function(e,t,n,s){var l=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],h=a.convertToTensor(e,"v","movingAverage"),v=a.convertToTensor(t,"x","movingAverage"),g=a.convertToTensor(n,"decay","movingAverage");r.assertTypesMatch(h,v),i.assert(i.arraysEqual(h.shape,v.shape),(function(){return"Shape mismatch in v and x"}));var m=d.scalar(1),y=p.sub(m,g),x=c.mul(p.sub(v,h),y);if(l){i.assert(null!=s,(function(){return"When using zeroDebias: true, step is required."}));var b=a.convertToTensor(s,"step","movingAverage");x=u.div(x,p.sub(m,f.pow(g,b)))}return o.add(h,x)}})})),s.register("cjdFa",(function(e,t){n(e.exports,"scatterND",(function(){return c}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1"),o=s("f1skK"),u=s("cInGs");var c=o.op({scatterND_:function(e,t,n){var o=i.convertToTensor(e,"indices","scatterND","int32"),s=i.convertToTensor(t,"updates","scatterND");u.validateInput(s,o,n);var c={indices:o,updates:s},l={shape:n};return r.ENGINE.runKernelFunc((function(e){return e.scatterND(o,s,n)}),c,null,a.ScatterNd,l)}})})),s.register("cInGs",(function(e,t){n(e.exports,"validateUpdateShape",(function(){return i})),n(e.exports,"validateInput",(function(){return o})),n(e.exports,"calculateShapes",(function(){return u})),s("1i51P");var r=s("9M1dW"),a=s("kglvN");function i(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var u=0;u<n.rank-a;++u)if(n.shape[u+a]!==e[u+r])throw new Error(i+" updates.shape[".concat(u+a,"] (").concat(n.shape[u+a],") != shape[").concat(u+a,"] (").concat(e[u+a],")"))}function o(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}i(n,t,e)}function u(e,t,n){for(var i=t.shape.length,o=i>1?t.shape[i-1]:1,u=n.length,s=1,c=o;c<u;++c)s*=n[c];var l=o<1?1:o;return{sliceRank:o,numUpdates:a.sizeFromShape(t.shape)/l,sliceSize:s,strides:r.default(a.computeStrides(n.slice(0,o))).concat([1]),outputSize:a.sizeFromShape(n)}}})),s.register("ios2x",(function(e,t){n(e.exports,"sparseToDense",(function(){return u}));var r=s("1dnDT"),a=s("cvMH2"),i=s("2q6OJ"),o=s("lcVC1");var u=s("f1skK").op({sparseToDense_:function(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=o.convertToTensor(e,"sparseIndices","sparseToDense","int32"),c=o.convertToTensor(t,"sparseValues","sparseToDense"),l=o.convertToTensor(u,"defaultValue","sparseToDense",c.dtype);i.validateInput(s,c,n,l);var f={sparseIndices:s,sparseValues:c,defaultValue:l},d={outputShape:n};return r.ENGINE.runKernelFunc((function(e){return e.sparseToDense(s,c,n,l)}),f,null,a.SparseToDense,d)}})})),s.register("2q6OJ",(function(e,t){function r(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}n(e.exports,"validateInput",(function(){return r}))})),s.register("lOxkD",(function(e,t){n(e.exports,"gatherND",(function(){return o}));var r=s("1dnDT"),a=s("cvMH2"),i=s("lcVC1");var o=s("f1skK").op({gatherND_:function(e,t){var n=i.convertToTensor(t,"indices","gatherND","int32"),o=i.convertToTensor(e,"x","gatherND"),u={params:o,indices:n};return r.ENGINE.runKernelFunc((function(e){return e.gatherND(o,n)}),u,null,a.GatherNd)}})})),s.register("6UffC",(function(e,t){n(e.exports,"dropout",(function(){return h}));var r=s("4JvjV"),a=s("lcVC1"),i=s("kglvN"),o=s("b3Qcj"),u=s("6baO0"),c=s("56CZS"),l=s("ksyR5"),f=s("j0e1k"),d=s("f1skK"),p=s("1GxQM");var h=d.op({dropout_:function(e,t,n,s){var d=a.convertToTensor(e,"x","dropout");if(i.assert("float32"===d.dtype,(function(){return"x has to be a floating point tensor since it's going to be "+"scaled, but got a ".concat(d.dtype," tensor instead.")})),i.assert(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got ".concat(t,".")})),0===t)return e instanceof r.Tensor?d.clone():d;var h=c.getNoiseShape(d,n),v=1-t,g=u.div(l.floor(o.add(p.randomUniform(h,0,1,"float32",s),v)),v);return f.mul(d,g)}})})),s.register("56CZS",(function(e,t){n(e.exports,"getNoiseShape",(function(){return a}));var r=s("kglvN");function a(e,t){if(null==t)return e.shape.slice();if(r.arraysEqual(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],a=0;a<e.shape.length;a++)null==t[a]&&null!=e.shape[a]?n.push(e.shape[a]):n.push(t[a]);return n}return t}})),s.register("6p2WX",(function(e,r){n(e.exports,"inTopKAsync",(function(){return f})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("lcVC1"),u=s("kglvN"),c=s("616DT");function l(){return l=a.default(t(i).mark((function e(n,r){var a,s,l,f,d,p,h,v,g,m,y,x,b,k,w,A,E=arguments;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=E.length>2&&void 0!==E[2]?E[2]:1,s=o.convertToTensor(n,"predictions","inTopK"),l=o.convertToTensor(r,"targets","inTopK"),u.assert(s.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, "+"but got ".concat(s.rank)})),u.assert(s.rank-1===l.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+"".concat(s.rank," and targets rank ").concat(l.rank)})),u.assertShapesMatch(s.shape.slice(0,s.shape.length-1),l.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),f=s.shape[s.shape.length-1],u.assert(a>0&&a<=f,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last "+"dimension (".concat(f,"), but got ").concat(a)})),e.next=10,s.data();case 10:return d=e.sent,e.next=13,l.data();case 13:p=e.sent,h=[d.length/f,f],v=h[0],g=h[1],m=u.getTypedArrayFromDType("bool",v),y=0;case 17:if(!(y<v)){e.next=35;break}for(x=y*g,b=d.subarray(x,x+g),k=[],w=0;w<b.length;w++)k.push({value:b[w],index:w});k.sort((function(e,t){return t.value-e.value})),m[y]=0,A=0;case 25:if(!(A<a)){e.next=32;break}if(k[A].index!==p[y]){e.next=29;break}return m[y]=1,e.abrupt("break",32);case 29:A++,e.next=25;break;case 32:y++,e.next=17;break;case 35:return n!==s&&s.dispose(),r!==l&&l.dispose(),e.abrupt("return",c.tensor(m,l.shape,"bool"));case 38:case"end":return e.stop()}}),e)}))),l.apply(this,arguments)}var f=function(e,t){return l.apply(this,arguments)}})),s.register("gNpl8",(function(e,t){s("j2ViA");var n=s("4JdlT");s("4JvjV").Tensor.prototype.acos=function(){return this.throwIfDisposed(),n.acos(this)}})),s.register("9CthG",(function(e,t){s("j2ViA");var n=s("deh8x");s("4JvjV").Tensor.prototype.acosh=function(){return this.throwIfDisposed(),n.acosh(this)}})),s.register("f8qZD",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.addStrict=function(e){return this.throwIfDisposed(),n.addStrict(this,e)}})),s.register("4XzGG",(function(e,t){var n=s("b3Qcj");s("4JvjV").Tensor.prototype.add=function(e){return this.throwIfDisposed(),n.add(this,e)}})),s.register("jhqh3",(function(e,t){var n=s("d6rwS");s("4JvjV").Tensor.prototype.all=function(e,t){return this.throwIfDisposed(),n.all(this,e,t)}})),s.register("6ca2P",(function(e,t){var n=s("a7Ldu");s("4JvjV").Tensor.prototype.any=function(e,t){return this.throwIfDisposed(),n.any(this,e,t)}})),s.register("4VWHH",(function(e,t){var n=s("9UQ7R");s("4JvjV").Tensor.prototype.argMax=function(e){return this.throwIfDisposed(),n.argMax(this,e)}})),s.register("41uN2",(function(e,t){var n=s("8wukb");s("4JvjV").Tensor.prototype.argMin=function(e){return this.throwIfDisposed(),n.argMin(this,e)}})),s.register("3XTF9",(function(e,t){var n=s("gldWN"),r=s("4JvjV"),a=s("kglvN");r.Tensor.prototype.asScalar=function(){return this.throwIfDisposed(),a.assert(1===this.size,(function(){return"The array must have only 1 element."})),n.reshape(this,[])}})),s.register("3NbCW",(function(e,t){s("j2ViA");var n=s("782ce");s("4JvjV").Tensor.prototype.asType=function(e){return this.throwIfDisposed(),n.cast(this,e)}})),s.register("3iTu7",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.as1D=function(){return this.throwIfDisposed(),n.reshape(this,[this.size])}})),s.register("9BHKS",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.as2D=function(e,t){return this.throwIfDisposed(),n.reshape(this,[e,t])}})),s.register("8FzNk",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.as3D=function(e,t,r){return this.throwIfDisposed(),n.reshape(this,[e,t,r])}})),s.register("e4Q2w",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.as4D=function(e,t,r,a){return this.throwIfDisposed(),n.reshape(this,[e,t,r,a])}})),s.register("2BMO9",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.as5D=function(e,t,r,a,i){return this.throwIfDisposed(),n.reshape(this,[e,t,r,a,i])}})),s.register("llveq",(function(e,t){s("j2ViA");var n=s("6jOGJ");s("4JvjV").Tensor.prototype.asin=function(){return this.throwIfDisposed(),n.asin(this)}})),s.register("6YTzx",(function(e,t){s("j2ViA");var n=s("ilRXh");s("4JvjV").Tensor.prototype.asinh=function(){return this.throwIfDisposed(),n.asinh(this)}})),s.register("7wwAP",(function(e,t){s("j2ViA");var n=s("1KNQy");s("4JvjV").Tensor.prototype.atan=function(){return this.throwIfDisposed(),n.atan(this)}})),s.register("k4OMZ",(function(e,t){var n=s("hL6PI");s("4JvjV").Tensor.prototype.atan2=function(e){return this.throwIfDisposed(),n.atan2(this,e)}})),s.register("b84pO",(function(e,t){s("j2ViA");var n=s("9MsjU");s("4JvjV").Tensor.prototype.atanh=function(){return this.throwIfDisposed(),n.atanh(this)}})),s.register("eHCEi",(function(e,t){var n=s("WcUsE");s("4JvjV").Tensor.prototype.avgPool=function(e,t,r,a){return this.throwIfDisposed(),n.avgPool(this,e,t,r,a)}})),s.register("dqUPm",(function(e,t){var n=s("fiGYl");s("4JvjV").Tensor.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),n.batchToSpaceND(this,e,t)}})),s.register("38soh",(function(e,t){var n=s("7oZFS");s("4JvjV").Tensor.prototype.batchNorm=function(e,t,r,a,i){return this.throwIfDisposed(),n.batchNorm(this,e,t,r,a,i)}})),s.register("kEJem",(function(e,t){var n=s("kEXNH");s("4JvjV").Tensor.prototype.broadcastTo=function(e){return this.throwIfDisposed(),n.broadcastTo(this,e)}})),s.register("6De5d",(function(e,t){s("j2ViA");var n=s("782ce");s("4JvjV").Tensor.prototype.cast=function(e){return this.throwIfDisposed(),n.cast(this,e)}})),s.register("l0ymt",(function(e,t){s("j2ViA");var n=s("fecqZ");s("4JvjV").Tensor.prototype.ceil=function(){return this.throwIfDisposed(),n.ceil(this)}})),s.register("eQBXB",(function(e,t){s("j2ViA");var n=s("djUTy");s("4JvjV").Tensor.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),n.clipByValue(this,e,t)}})),s.register("ehav6",(function(e,t){s("1i51P");var n=s("9M1dW"),r=s("6hkW8"),a=s("4JvjV");a.Tensor.prototype.concat=function(e,t){return this.throwIfDisposed(),e instanceof a.Tensor&&(e=[e]),r.concat([this].concat(n.default(e)),t)}})),s.register("mGrZ4",(function(e,t){var n=s("ceZj5");s("4JvjV").Tensor.prototype.conv1d=function(e,t,r,a,i,o){return this.throwIfDisposed(),n.conv1d(this,e,t,r,a,i,o)}})),s.register("ksmG2",(function(e,t){var n=s("1DPo2");s("4JvjV").Tensor.prototype.conv2dTranspose=function(e,t,r,a,i){return this.throwIfDisposed(),n.conv2dTranspose(this,e,t,r,a,i)}})),s.register("jBr3X",(function(e,t){var n=s("dH9u6");s("4JvjV").Tensor.prototype.conv2d=function(e,t,r,a,i,o){return this.throwIfDisposed(),n.conv2d(this,e,t,r,a,i,o)}})),s.register("lTg6p",(function(e,t){s("j2ViA");var n=s("9D7bL");s("4JvjV").Tensor.prototype.cos=function(){return this.throwIfDisposed(),n.cos(this)}})),s.register("az5Lk",(function(e,t){s("j2ViA");var n=s("hmI2F");s("4JvjV").Tensor.prototype.cosh=function(){return this.throwIfDisposed(),n.cosh(this)}})),s.register("cW4Cq",(function(e,t){var n=s("bjxnt");s("4JvjV").Tensor.prototype.cumsum=function(e,t,r){return this.throwIfDisposed(),n.cumsum(this,e,t,r)}})),s.register("hG2hR",(function(e,t){var n=s("46h8X");s("4JvjV").Tensor.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),n.depthToSpace(this,e,t)}})),s.register("i27uK",(function(e,t){var n=s("P1tXK"),r=s("btnhd");s("4JvjV").Tensor.prototype.depthwiseConv2D=function(e,t,a,i,o,u){return n.deprecationWarn("depthwiseConv2D is deprecated, use depthwiseConv2d instead"),this.throwIfDisposed(),r.depthwiseConv2d(this,e,t,a,i,o,u)}})),s.register("hd9Gu",(function(e,t){var n=s("btnhd");s("4JvjV").Tensor.prototype.depthwiseConv2d=function(e,t,r,a,i,o){return this.throwIfDisposed(),n.depthwiseConv2d(this,e,t,r,a,i,o)}})),s.register("c15zI",(function(e,t){var n=s("8h0Lc");s("4JvjV").Tensor.prototype.dilation2d=function(e,t,r,a,i){return this.throwIfDisposed(),n.dilation2d(this,e,t,r,a,i)}})),s.register("lganq",(function(e,t){var n=s("1DCIn");s("4JvjV").Tensor.prototype.divNoNan=function(e){return this.throwIfDisposed(),n.divNoNan(this,e)}})),s.register("iUTkU",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.divStrict=function(e){return this.throwIfDisposed(),n.divStrict(this,e)}})),s.register("1FdsZ",(function(e,t){var n=s("6baO0");s("4JvjV").Tensor.prototype.div=function(e){return this.throwIfDisposed(),n.div(this,e)}})),s.register("9hVdo",(function(e,t){var n=s("7UdNs");s("4JvjV").Tensor.prototype.dot=function(e){return this.throwIfDisposed(),n.dot(this,e)}})),s.register("c5mSJ",(function(e,t){var n=s("gGOj0");s("4JvjV").Tensor.prototype.elu=function(){return this.throwIfDisposed(),n.elu(this)}})),s.register("bO5yI",(function(e,t){s("j2ViA");var n=s("1AnXD");s("4JvjV").Tensor.prototype.equalStrict=function(e){return this.throwIfDisposed(),n.equalStrict(this,e)}})),s.register("9mMu3",(function(e,t){var n=s("iuFae");s("4JvjV").Tensor.prototype.equal=function(e){return this.throwIfDisposed(),n.equal(this,e)}})),s.register("dxDy9",(function(e,t){s("j2ViA");var n=s("c5hEb");s("4JvjV").Tensor.prototype.erf=function(){return this.throwIfDisposed(),n.erf(this)}})),s.register("4yjxw",(function(e,t){s("j2ViA");var n=s("byJMV");s("4JvjV").Tensor.prototype.exp=function(){return this.throwIfDisposed(),n.exp(this)}})),s.register("cszJQ",(function(e,t){var n=s("fwOP6");s("4JvjV").Tensor.prototype.expandDims=function(e){return this.throwIfDisposed(),n.expandDims(this,e)}})),s.register("19gxJ",(function(e,t){s("j2ViA");var n=s("lX82t");s("4JvjV").Tensor.prototype.expm1=function(){return this.throwIfDisposed(),n.expm1(this)}})),s.register("7T3xE",(function(e,t){s("j2ViA");var n=s("casYn");s("4JvjV").Tensor.prototype.fft=function(){return this.throwIfDisposed(),n.fft(this)}})),s.register("A0CbI",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.flatten=function(){return this.throwIfDisposed(),n.reshape(this,[this.size])}})),s.register("8tWoF",(function(e,t){s("j2ViA");var n=s("ksyR5");s("4JvjV").Tensor.prototype.floor=function(){return this.throwIfDisposed(),n.floor(this)}})),s.register("b75AL",(function(e,t){var n=s("cisxn");s("4JvjV").Tensor.prototype.floorDiv=function(e){return this.throwIfDisposed(),n.floorDiv(this,e)}})),s.register("7vXim",(function(e,t){var n=s("17OvF");s("4JvjV").Tensor.prototype.gather=function(e,t){return this.throwIfDisposed(),n.gather(this,e,t)}})),s.register("6609F",(function(e,t){s("j2ViA");var n=s("1AnXD");s("4JvjV").Tensor.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),n.greaterEqualStrict(this,e)}})),s.register("74B9q",(function(e,t){var n=s("6Bgjr");s("4JvjV").Tensor.prototype.greaterEqual=function(e){return this.throwIfDisposed(),n.greaterEqual(this,e)}})),s.register("cs6Yb",(function(e,t){s("j2ViA");var n=s("1AnXD");s("4JvjV").Tensor.prototype.greaterStrict=function(e){return this.throwIfDisposed(),n.greaterStrict(this,e)}})),s.register("9yVb8",(function(e,t){var n=s("ejjI8");s("4JvjV").Tensor.prototype.greater=function(e){return this.throwIfDisposed(),n.greater(this,e)}})),s.register("ez68x",(function(e,t){s("j2ViA");var n=s("eBkYt");s("4JvjV").Tensor.prototype.ifft=function(){return this.throwIfDisposed(),n.ifft(this)}})),s.register("TUoW1",(function(e,t){s("j2ViA");var n=s("dvCn4");s("4JvjV").Tensor.prototype.irfft=function(){return this.throwIfDisposed(),n.irfft(this)}})),s.register("bXgt9",(function(e,t){s("j2ViA");var n=s("j3cEz");s("4JvjV").Tensor.prototype.isFinite=function(){return this.throwIfDisposed(),n.isFinite(this)}})),s.register("biCW7",(function(e,t){s("j2ViA");var n=s("cFDTG");s("4JvjV").Tensor.prototype.isInf=function(){return this.throwIfDisposed(),n.isInf(this)}})),s.register("jmvdB",(function(e,t){s("j2ViA");var n=s("d4DaY");s("4JvjV").Tensor.prototype.isNaN=function(){return this.throwIfDisposed(),n.isNaN(this)}})),s.register("8a14h",(function(e,t){var n=s("1LZgP");s("4JvjV").Tensor.prototype.leakyRelu=function(e){return this.throwIfDisposed(),n.leakyRelu(this,e)}})),s.register("42H0k",(function(e,t){s("j2ViA");var n=s("1AnXD");s("4JvjV").Tensor.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),n.lessEqualStrict(this,e)}})),s.register("fQsx5",(function(e,t){var n=s("j0AHg");s("4JvjV").Tensor.prototype.lessEqual=function(e){return this.throwIfDisposed(),n.lessEqual(this,e)}})),s.register("60Lvw",(function(e,t){s("j2ViA");var n=s("1AnXD");s("4JvjV").Tensor.prototype.lessStrict=function(e){return this.throwIfDisposed(),n.lessStrict(this,e)}})),s.register("aNRro",(function(e,t){var n=s("dKHZ2");s("4JvjV").Tensor.prototype.less=function(e){return this.throwIfDisposed(),n.less(this,e)}})),s.register("4WKT5",(function(e,t){var n=s("jq1h8");s("4JvjV").Tensor.prototype.localResponseNormalization=function(e,t,r,a){return this.throwIfDisposed(),n.localResponseNormalization(this,e,t,r,a)}})),s.register("vqz9V",(function(e,t){s("j2ViA");var n=s("imK0S");s("4JvjV").Tensor.prototype.logSigmoid=function(){return this.throwIfDisposed(),n.logSigmoid(this)}})),s.register("d4PvU",(function(e,t){s("j2ViA");var n=s("bYmSd");s("4JvjV").Tensor.prototype.logSoftmax=function(e){return this.throwIfDisposed(),n.logSoftmax(this,e)}})),s.register("7p8b8",(function(e,t){var n=s("acLJn");s("4JvjV").Tensor.prototype.logSumExp=function(e,t){return this.throwIfDisposed(),n.logSumExp(this,e,t)}})),s.register("funaN",(function(e,t){s("j2ViA");var n=s("WSSiT");s("4JvjV").Tensor.prototype.log=function(){return this.throwIfDisposed(),n.log(this)}})),s.register("8AXld",(function(e,t){s("j2ViA");var n=s("3rEkq");s("4JvjV").Tensor.prototype.log1p=function(){return this.throwIfDisposed(),n.log1p(this)}})),s.register("jiygW",(function(e,t){var n=s("7WLBj");s("4JvjV").Tensor.prototype.logicalAnd=function(e){return this.throwIfDisposed(),n.logicalAnd(this,e)}})),s.register("bvjLz",(function(e,t){var n=s("1bFci");s("4JvjV").Tensor.prototype.logicalNot=function(){return this.throwIfDisposed(),n.logicalNot(this)}})),s.register("gtZiz",(function(e,t){var n=s("49dpo");s("4JvjV").Tensor.prototype.logicalOr=function(e){return this.throwIfDisposed(),n.logicalOr(this,e)}})),s.register("aHTbo",(function(e,t){var n=s("fiOos");s("4JvjV").Tensor.prototype.logicalXor=function(e){return this.throwIfDisposed(),n.logicalXor(this,e)}})),s.register("i3Yqy",(function(e,t){var n=s("5KHLt");s("4JvjV").Tensor.prototype.matMul=function(e,t,r){return this.throwIfDisposed(),n.matMul(this,e,t,r)}})),s.register("020of",(function(e,t){var n=s("2dPgQ");s("4JvjV").Tensor.prototype.maxPool=function(e,t,r,a){return this.throwIfDisposed(),n.maxPool(this,e,t,r,a)}})),s.register("SFzUR",(function(e,t){var n=s("avJI0");s("4JvjV").Tensor.prototype.max=function(e,t){return this.throwIfDisposed(),n.max(this,e,t)}})),s.register("3NDxA",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.maximumStrict=function(e){return this.throwIfDisposed(),n.maximumStrict(this,e)}})),s.register("9wHBk",(function(e,t){var n=s("k7Du7");s("4JvjV").Tensor.prototype.maximum=function(e){return this.throwIfDisposed(),n.maximum(this,e)}})),s.register("3rnEY",(function(e,t){var n=s("4804C");s("4JvjV").Tensor.prototype.mean=function(e,t){return this.throwIfDisposed(),n.mean(this,e,t)}})),s.register("glVbo",(function(e,t){var n=s("cGC0n");s("4JvjV").Tensor.prototype.min=function(e,t){return this.throwIfDisposed(),n.min(this,e,t)}})),s.register("2g1QF",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.minimumStrict=function(e){return this.throwIfDisposed(),n.minimumStrict(this,e)}})),s.register("hBwdE",(function(e,t){var n=s("eu81x");s("4JvjV").Tensor.prototype.minimum=function(e){return this.throwIfDisposed(),n.minimum(this,e)}})),s.register("4Irv0",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.modStrict=function(e){return this.throwIfDisposed(),n.modStrict(this,e)}})),s.register("2TUAc",(function(e,t){var n=s("hQKIK");s("4JvjV").Tensor.prototype.mod=function(e){return this.throwIfDisposed(),n.mod(this,e)}})),s.register("brv6v",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.mulStrict=function(e){return this.throwIfDisposed(),n.mulStrict(this,e)}})),s.register("3czH4",(function(e,t){var n=s("j0e1k");s("4JvjV").Tensor.prototype.mul=function(e){return this.throwIfDisposed(),n.mul(this,e)}})),s.register("8VBtX",(function(e,t){s("j2ViA");var n=s("ee0Eu");s("4JvjV").Tensor.prototype.neg=function(){return this.throwIfDisposed(),n.neg(this)}})),s.register("fIWOU",(function(e,t){s("j2ViA");var n=s("eC6uZ");s("4JvjV").Tensor.prototype.norm=function(e,t,r){return this.throwIfDisposed(),n.norm(this,e,t,r)}})),s.register("jHPbT",(function(e,t){s("j2ViA");var n=s("1AnXD");s("4JvjV").Tensor.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),n.notEqualStrict(this,e)}})),s.register("jxlr2",(function(e,t){var n=s("7owLz");s("4JvjV").Tensor.prototype.notEqual=function(e){return this.throwIfDisposed(),n.notEqual(this,e)}})),s.register("7rUqg",(function(e,t){var n=s("9ZTJv");s("4JvjV").Tensor.prototype.oneHot=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.throwIfDisposed(),n.oneHot(this,e,t,r)}})),s.register("bspV4",(function(e,t){s("j2ViA");var n=s("4z0yD");s("4JvjV").Tensor.prototype.onesLike=function(){return this.throwIfDisposed(),n.onesLike(this)}})),s.register("2MKSo",(function(e,t){var n=s("elYe2");s("4JvjV").Tensor.prototype.pad=function(e,t){return this.throwIfDisposed(),n.pad(this,e,t)}})),s.register("7fSb2",(function(e,t){var n=s("l6jFw");s("4JvjV").Tensor.prototype.pool=function(e,t,r,a,i){return this.throwIfDisposed(),n.pool(this,e,t,r,a,i)}})),s.register("4ieGD",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.powStrict=function(e){return this.throwIfDisposed(),n.powStrict(this,e)}})),s.register("94Js2",(function(e,t){var n=s("WvbbQ");s("4JvjV").Tensor.prototype.pow=function(e){return this.throwIfDisposed(),n.pow(this,e)}})),s.register("kaUgU",(function(e,t){var n=s("9JCtR");s("4JvjV").Tensor.prototype.prelu=function(e){return this.throwIfDisposed(),n.prelu(this,e)}})),s.register("hfAXI",(function(e,t){var n=s("iGcXf");s("4JvjV").Tensor.prototype.prod=function(e,t){return this.throwIfDisposed(),n.prod(this,e,t)}})),s.register("f4FvN",(function(e,t){s("j2ViA");var n=s("1FDpf");s("4JvjV").Tensor.prototype.reciprocal=function(){return this.throwIfDisposed(),n.reciprocal(this)}})),s.register("buiNI",(function(e,t){var n=s("2MKa7");s("4JvjV").Tensor.prototype.relu=function(){return this.throwIfDisposed(),n.relu(this)}})),s.register("4GWE0",(function(e,t){var n=s("83Plb");s("4JvjV").Tensor.prototype.relu6=function(){return this.throwIfDisposed(),n.relu6(this)}})),s.register("at5c5",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.reshapeAs=function(e){return this.throwIfDisposed(),n.reshape(this,e.shape)}})),s.register("esbpE",(function(e,t){var n=s("gldWN");s("4JvjV").Tensor.prototype.reshape=function(e){return this.throwIfDisposed(),n.reshape(this,e)}})),s.register("i6TwW",(function(e,t){var n=s("em9A1");s("4JvjV").Tensor.prototype.resizeBilinear=function(e,t){return this.throwIfDisposed(),n.resizeBilinear(this,e,t)}})),s.register("lSRAT",(function(e,t){var n=s("1Wdii");s("4JvjV").Tensor.prototype.resizeNearestNeighbor=function(e,t){return this.throwIfDisposed(),n.resizeNearestNeighbor(this,e,t)}})),s.register("b3Ahf",(function(e,t){var n=s("hYjAM");s("4JvjV").Tensor.prototype.reverse=function(e){return this.throwIfDisposed(),n.reverse(this,e)}})),s.register("8SdkN",(function(e,t){s("j2ViA");var n=s("8x9VA");s("4JvjV").Tensor.prototype.rfft=function(){return this.throwIfDisposed(),n.rfft(this)}})),s.register("7KHNx",(function(e,t){s("j2ViA");var n=s("8Irjk");s("4JvjV").Tensor.prototype.round=function(){return this.throwIfDisposed(),n.round(this)}})),s.register("6xrkP",(function(e,t){s("j2ViA");var n=s("giife");s("4JvjV").Tensor.prototype.rsqrt=function(){return this.throwIfDisposed(),n.rsqrt(this)}})),s.register("ibZze",(function(e,t){var n=s("lKM5m");s("4JvjV").Tensor.prototype.selu=function(){return this.throwIfDisposed(),n.selu(this)}})),s.register("fGJxj",(function(e,t){var n=s("jHQP9");s("4JvjV").Tensor.prototype.separableConv2d=function(e,t,r,a,i,o){return this.throwIfDisposed(),n.separableConv2d(this,e,t,r,a,i,o)}})),s.register("gGqDX",(function(e,t){s("j2ViA");var n=s("5uQwR");s("4JvjV").Tensor.prototype.sigmoid=function(){return this.throwIfDisposed(),n.sigmoid(this)}})),s.register("kBHdp",(function(e,t){s("j2ViA");var n=s("d10y4");s("4JvjV").Tensor.prototype.sign=function(){return this.throwIfDisposed(),n.sign(this)}})),s.register("aB4KZ",(function(e,t){s("j2ViA");var n=s("hHkhi");s("4JvjV").Tensor.prototype.sin=function(){return this.throwIfDisposed(),n.sin(this)}})),s.register("cSXEJ",(function(e,t){s("j2ViA");var n=s("kPryz");s("4JvjV").Tensor.prototype.sinh=function(){return this.throwIfDisposed(),n.sinh(this)}})),s.register("gnbds",(function(e,t){s("j2ViA");var n=s("jPaTA");s("4JvjV").Tensor.prototype.slice=function(e,t){return this.throwIfDisposed(),n.slice(this,e,t)}})),s.register("kub3L",(function(e,t){s("j2ViA");var n=s("etmQx");s("4JvjV").Tensor.prototype.softmax=function(e){return this.throwIfDisposed(),n.softmax(this,e)}})),s.register("dlwZD",(function(e,t){s("j2ViA");var n=s("eQuwX");s("4JvjV").Tensor.prototype.softplus=function(){return this.throwIfDisposed(),n.softplus(this)}})),s.register("9JczD",(function(e,t){var n=s("h7Gux");s("4JvjV").Tensor.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),n.spaceToBatchND(this,e,t)}})),s.register("hgVLg",(function(e,t){var n=s("htMbZ");s("4JvjV").Tensor.prototype.split=function(e,t){return this.throwIfDisposed(),n.split(this,e,t)}})),s.register("hvvV7",(function(e,t){s("j2ViA");var n=s("buy0T");s("4JvjV").Tensor.prototype.sqrt=function(){return this.throwIfDisposed(),n.sqrt(this)}})),s.register("hogxP",(function(e,t){s("j2ViA");var n=s("4C8ia");s("4JvjV").Tensor.prototype.square=function(){return this.throwIfDisposed(),n.square(this)}})),s.register("46a1z",(function(e,t){var n=s("lfNC8");s("4JvjV").Tensor.prototype.squaredDifference=function(e){return this.throwIfDisposed(),n.squaredDifference(this,e)}})),s.register("2VwSk",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),n.squaredDifferenceStrict(this,e)}})),s.register("b3zXR",(function(e,t){var n=s("4y8cw");s("4JvjV").Tensor.prototype.squeeze=function(e){return this.throwIfDisposed(),n.squeeze(this,e)}})),s.register("22fJG",(function(e,t){s("1i51P");var n=s("9M1dW"),r=s("biSQf"),a=s("4JvjV");a.Tensor.prototype.stack=function(e,t){this.throwIfDisposed();var i=e instanceof a.Tensor?[this,e]:[this].concat(n.default(e));return r.stack(i,t)}})),s.register("iyCvC",(function(e,t){s("j2ViA");var n=s("lWKd3");s("4JvjV").Tensor.prototype.step=function(e){return this.throwIfDisposed(),n.step(this,e)}})),s.register("dNLCh",(function(e,t){s("j2ViA");var n=s("fTdnV");s("4JvjV").Tensor.prototype.stridedSlice=function(e,t,r,a,i,o,u,s){return this.throwIfDisposed(),n.stridedSlice(this,e,t,r,a,i,o,u,s)}})),s.register("dmRkm",(function(e,t){s("j2ViA");var n=s("bLCbB");s("4JvjV").Tensor.prototype.subStrict=function(e){return this.throwIfDisposed(),n.subStrict(this,e)}})),s.register("dZA8w",(function(e,t){var n=s("fZE7S");s("4JvjV").Tensor.prototype.sub=function(e){return this.throwIfDisposed(),n.sub(this,e)}})),s.register("43tqC",(function(e,t){var n=s("2xCpB");s("4JvjV").Tensor.prototype.sum=function(e,t){return this.throwIfDisposed(),n.sum(this,e,t)}})),s.register("fDDut",(function(e,t){s("j2ViA");var n=s("jc2CK");s("4JvjV").Tensor.prototype.tan=function(){return this.throwIfDisposed(),n.tan(this)}})),s.register("3g8cU",(function(e,t){s("j2ViA");var n=s("lzRoG");s("4JvjV").Tensor.prototype.tanh=function(){return this.throwIfDisposed(),n.tanh(this)}})),s.register("5PhAK",(function(e,t){var n=s("kP8JI");s("4JvjV").Tensor.prototype.tile=function(e){return this.throwIfDisposed(),n.tile(this,e)}})),s.register("5qnA3",(function(e,t){s("j2ViA");var n=s("782ce");s("4JvjV").Tensor.prototype.toBool=function(){return this.throwIfDisposed(),n.cast(this,"bool")}})),s.register("3jrGi",(function(e,t){s("j2ViA");var n=s("782ce");s("4JvjV").Tensor.prototype.toFloat=function(){return this.throwIfDisposed(),n.cast(this,"float32")}})),s.register("aHTEN",(function(e,t){s("j2ViA");var n=s("782ce");s("4JvjV").Tensor.prototype.toInt=function(){return this.throwIfDisposed(),n.cast(this,"int32")}})),s.register("41T4P",(function(e,t){var n=s("1jhOm");s("4JvjV").Tensor.prototype.topk=function(e,t){return this.throwIfDisposed(),n.topk(this,e,t)}})),s.register("bS0Iz",(function(e,t){var n=s("9PS5J");s("4JvjV").Tensor.prototype.transpose=function(e){return this.throwIfDisposed(),n.transpose(this,e)}})),s.register("1b7KT",(function(e,t){var n=s("h4byS");s("4JvjV").Tensor.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),n.unsortedSegmentSum(this,e,t)}})),s.register("fC9P4",(function(e,t){var n=s("6jWCC");s("4JvjV").Tensor.prototype.unstack=function(e){return this.throwIfDisposed(),n.unstack(this,e)}})),s.register("jHjSX",(function(e,t){var n=s("6FAlx");s("4JvjV").Tensor.prototype.where=function(e,t){return this.throwIfDisposed(),n.where(e,this,t)}})),s.register("6OFZh",(function(e,t){s("j2ViA");var n=s("8p3bZ");s("4JvjV").Tensor.prototype.zerosLike=function(){return this.throwIfDisposed(),n.zerosLike(this)}})),s.register("8onfg",(function(t,r){n(t.exports,"AdadeltaOptimizer",(function(){return s("eF9sD").AdadeltaOptimizer})),n(t.exports,"AdagradOptimizer",(function(){return s("lPnjT").AdagradOptimizer})),n(t.exports,"AdamOptimizer",(function(){return s("c5YZO").AdamOptimizer})),n(t.exports,"AdamaxOptimizer",(function(){return s("gYXqz").AdamaxOptimizer})),n(t.exports,"MomentumOptimizer",(function(){return s("lKg8b").MomentumOptimizer})),n(t.exports,"Optimizer",(function(){return s("aS8kb").Optimizer})),n(t.exports,"RMSPropOptimizer",(function(){return s("YMSdl").RMSPropOptimizer})),n(t.exports,"SGDOptimizer",(function(){return s("kyk60").SGDOptimizer})),n(t.exports,"Tensor",(function(){return s("4JvjV").Tensor})),n(t.exports,"TensorBuffer",(function(){return s("4JvjV").TensorBuffer})),n(t.exports,"Variable",(function(){return s("4JvjV").Variable})),n(t.exports,"Rank",(function(){return s("aTTkI").Rank})),n(t.exports,"sumOutType",(function(){return s("aTTkI").sumOutType})),n(t.exports,"upcastType",(function(){return s("aTTkI").upcastType})),n(t.exports,"Reduction",(function(){return s("ctwOS").Reduction})),n(t.exports,"customGrad",(function(){return s("2c3OP").customGrad})),n(t.exports,"grad",(function(){return s("2c3OP").grad})),n(t.exports,"grads",(function(){return s("2c3OP").grads})),n(t.exports,"valueAndGrad",(function(){return s("2c3OP").valueAndGrad})),n(t.exports,"valueAndGrads",(function(){return s("2c3OP").valueAndGrads})),n(t.exports,"variableGrads",(function(){return s("2c3OP").variableGrads})),n(t.exports,"Environment",(function(){return s("lU3MY").Environment})),n(t.exports,"env",(function(){return s("lU3MY").env})),n(t.exports,"ENV",(function(){return s("lU3MY").ENV})),n(t.exports,"version_core",(function(){return s("9lNTO").version})),n(t.exports,"nextFrame",(function(){return s("QkKgL").nextFrame})),n(t.exports,"browser",(function(){return s("iq41T")})),n(t.exports,"io",(function(){return s("j8KB3")})),n(t.exports,"math",(function(){return s("bSHEf")})),n(t.exports,"serialization",(function(){return s("6b8rQ")})),n(t.exports,"test_util",(function(){return s("4XRKR")})),n(t.exports,"util",(function(){return s("kglvN")})),n(t.exports,"backend_util",(function(){return s("dITq1")})),n(t.exports,"tensor_util",(function(){return s("gIxdA")})),n(t.exports,"slice_util",(function(){return s("aK0eq")})),n(t.exports,"gather_util",(function(){return s("f432R")})),n(t.exports,"scatter_util",(function(){return s("cInGs")})),n(t.exports,"device_util",(function(){return s("iUbQh")})),n(t.exports,"kernel_impls",(function(){return s("289sH")})),n(t.exports,"KernelBackend",(function(){return s("lvUHp").KernelBackend})),n(t.exports,"DataStorage",(function(){return s("lvUHp").DataStorage}));s("j8KB3"),s("bSHEf"),s("iq41T"),s("f432R"),s("cInGs"),s("aK0eq"),s("6b8rQ"),s("gIxdA"),s("4XRKR"),s("kglvN"),s("9lNTO"),s("dITq1"),s("iUbQh"),s("289sH"),s("eF9sD"),s("lPnjT"),s("c5YZO"),s("gYXqz"),s("lKg8b"),s("aS8kb"),s("YMSdl"),s("kyk60"),s("4JvjV"),s("aTTkI");var a=s("j2ViA"),i=(s("ctwOS"),s("aqs9m")),o=s("P1tXK"),u=s("d4BUr"),c=(s("2c3OP"),s("lU3MY"),s("QkKgL"),s("lvUHp"),s("cvMH2"));e(t.exports,a),e(t.exports,i),e(t.exports,o),e(t.exports,u),e(t.exports,c)})),s.register("j8KB3",(function(e,t){n(e.exports,"copyModel",(function(){return s("lmNUn").copyModel})),n(e.exports,"listModels",(function(){return s("lmNUn").listModels})),n(e.exports,"moveModel",(function(){return s("lmNUn").moveModel})),n(e.exports,"removeModel",(function(){return s("lmNUn").removeModel})),n(e.exports,"browserFiles",(function(){return s("dbU7w").browserFiles})),n(e.exports,"browserHTTPRequest",(function(){return s("kwOmS").browserHTTPRequest})),n(e.exports,"concatenateArrayBuffers",(function(){return s("69QQV").concatenateArrayBuffers})),n(e.exports,"decodeWeights",(function(){return s("69QQV").decodeWeights})),n(e.exports,"encodeWeights",(function(){return s("69QQV").encodeWeights})),n(e.exports,"fromMemory",(function(){return s("jdufM").fromMemory})),n(e.exports,"getLoadHandlers",(function(){return s("5nSEP").getLoadHandlers})),n(e.exports,"getModelArtifactsInfoForJSON",(function(){return s("69QQV").getModelArtifactsInfoForJSON})),n(e.exports,"getSaveHandlers",(function(){return s("5nSEP").getSaveHandlers})),n(e.exports,"http",(function(){return s("kwOmS").http})),n(e.exports,"isHTTPScheme",(function(){return s("kwOmS").isHTTPScheme})),n(e.exports,"loadWeights",(function(){return s("8MN3w").loadWeights})),n(e.exports,"registerLoadRouter",(function(){return s("5nSEP").registerLoadRouter})),n(e.exports,"registerSaveRouter",(function(){return s("5nSEP").registerSaveRouter})),n(e.exports,"weightsLoaderFactory",(function(){return s("8MN3w").weightsLoaderFactory})),n(e.exports,"withSaveHandler",(function(){return s("jdufM").withSaveHandler})),s("gd2tB"),s("2H47L");s("dbU7w"),s("kwOmS"),s("69QQV"),s("jdufM"),s("5nSEP"),s("8MN3w"),s("lmNUn")})),s.register("dbU7w",(function(e,r){n(e.exports,"browserFiles",(function(){return g})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("9M1dW"),c=s("40Zzs");s("hbYT1");var l=s("lU3MY"),f=s("69QQV"),d=s("5nSEP");function p(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var h=function(){"use strict";function e(t){if(a.default(this,e),!l.env().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return i.default(e,[{key:"save",value:function(e){var n=this;return o.default(t(c).mark((function r(){var a,i,o,u,s,l;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("undefined"!=typeof document){t.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(a=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer)){t.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return i=[{paths:["./"+n.weightDataFileName],weights:e.weightSpecs}],o={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:i},u=window.URL.createObjectURL(new Blob([JSON.stringify(o)],{type:"application/json"})),(s=null==n.jsonAnchor?document.createElement("a"):n.jsonAnchor).download=n.modelTopologyFileName,s.href=u,t.next=15,p((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 15:if(null==e.weightData){t.next=21;break}return(l=null==n.weightDataAnchor?document.createElement("a"):n.weightDataAnchor).download=n.weightDataFileName,l.href=a,t.next=21,p((function(){return l.dispatchEvent(new MouseEvent("click"))}));case 21:return t.abrupt("return",{modelArtifactsInfo:f.getModelArtifactsInfoForJSON(e)});case 22:case"end":return t.stop()}}),r)})))()}}]),e}();h.URL_SCHEME="downloads://";var v=function(){"use strict";function e(t){if(a.default(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}return i.default(e,[{key:"load",value:function(){var e=this;return o.default(t(c).mark((function n(){var r,a;return t(c).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.files[0],a=e.files.slice(1),t.abrupt("return",new Promise((function(t,n){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===a.length&&t({modelTopology:s});var c=o.weightsManifest;if(null!=c){var l;try{l=e.checkManifestAndWeightFiles(c,a)}catch(e){return void n(e)}var d=[],p=[],h=[];c.forEach((function(e){var t;e.paths.forEach((function(e){p.push(e),h.push(null)})),(t=d).push.apply(t,u.default(e.weights))})),c.forEach((function(e){e.paths.forEach((function(e){var r=new FileReader;r.onload=function(n){var r=n.target.result,a=p.indexOf(e);h[a]=r,-1===h.indexOf(null)&&t({modelTopology:s,weightSpecs:d,weightData:f.concatenateArrayBuffers(h),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},r.onerror=function(t){return n("Failed to weights data from file of path '".concat(e,"'."))},r.readAsArrayBuffer(l[e])}))}))}else n(new Error("weightManifest field is missing from file ".concat(r.name)))}else n(new Error("modelTopology field is missing from file ".concat(r.name)))},i.onerror=function(e){return n("Failed to read model topology and weights manifest JSON "+"from file '".concat(r.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(r)})));case 3:case"end":return t.stop()}}),n)})))()}},{key:"checkManifestAndWeightFiles",value:function(e,t){var n=[],r=t.map((function(e){return f.basename(e.name)})),a={},i=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){s.value.paths.forEach((function(e){var i=f.basename(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(i,"'"));if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '".concat(i,"' is not provided."));a[e]=t[r.indexOf(i)]}))}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(n.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return a}}]),e}();function g(e){return new v(e)}d.IORouterRegistry.registerSaveRouter((function(e){return l.env().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(h.URL_SCHEME)?function(){return new h(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model")}(e.slice(h.URL_SCHEME.length)):null}))})),s.register("kwOmS",(function(e,r){n(e.exports,"isHTTPScheme",(function(){return h})),n(e.exports,"http",(function(){return g})),n(e.exports,"browserHTTPRequest",(function(){return m}));var a=s("1i51P"),i=s("40Zzs"),o=s("lU3MY"),u=s("kglvN"),c=s("69QQV"),l=s("5nSEP"),f=s("8MN3w"),d=function(){"use strict";function e(t,n){if(a.classCallCheck(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(u.assert("function"==typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=o.env().platform.fetch,u.assert(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&u.assert(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return a.createClass(e,[{key:"save",value:function(e){var n=this;return a.asyncToGenerator(t(i).mark((function r(){var a,o,u,s;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.modelTopology instanceof ArrayBuffer)){t.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(a=Object.assign({method:n.DEFAULT_METHOD},n.requestInit)).body=new FormData,o=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],u={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:o},a.body.append("model.json",new Blob([JSON.stringify(u)],{type:"application/json"}),"model.json"),null!=e.weightData&&a.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),t.next=10,n.fetch(n.path,a);case 10:if(!(s=t.sent).ok){t.next=15;break}return t.abrupt("return",{modelArtifactsInfo:c.getModelArtifactsInfoForJSON(e),responses:[s]});case 15:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(s.status,"."));case 16:case"end":return t.stop()}}),r)})))()}},{key:"load",value:function(){var e=this;return a.asyncToGenerator(t(i).mark((function n(){var r,o,u,s,c,l,f,d,p,h,v,g,m;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetch(e.path,e.requestInit);case 2:if((r=t.sent).ok){t.next=5;break}throw new Error("Request to ".concat(e.path," failed with status code ")+"".concat(r.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return t.prev=6,t.next=9,r.json();case 9:o=t.sent,t.next=17;break;case 12:throw t.prev=12,t.t0=t.catch(6),u="Failed to parse model JSON of response from ".concat(e.path,"."),e.path.endsWith(".pb")?u+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":u+=" Please make sure the server is serving valid JSON for this request.",new Error(u);case 17:if(s=o.modelTopology,c=o.weightsManifest,l=o.generatedBy,f=o.convertedBy,d=o.format,p=o.userDefinedMetadata,null!=s||null!=c){t.next=25;break}throw new Error("The JSON from HTTP path ".concat(e.path," contains neither model ")+"topology or manifest for weights.");case 25:if(null==c){t.next=33;break}return t.next=30,e.loadWeights(c);case 30:g=t.sent,m=a.slicedToArray(g,2),h=m[0],v=m[1];case 33:return t.abrupt("return",{modelTopology:s,weightSpecs:h,weightData:v,userDefinedMetadata:p,generatedBy:l,convertedBy:f,format:d});case 34:case"end":return t.stop()}}),n,null,[[6,12]])})))()}},{key:"loadWeights",value:function(e){var n=this;return a.asyncToGenerator(t(i).mark((function r(){var o,u,s,l,d,h,v,g,m,y,x,b,k,w,A,E,C,S,N,T,D,F,O,_,I,R,M,B,P;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(s=Array.isArray(n.path)?n.path[1]:n.path,l=a.slicedToArray(p(s),2),d=l[0],h=l[1],v=n.weightPathPrefix||d,g=[],m=!0,y=!1,x=void 0,t.prev=6,b=e[Symbol.iterator]();!(m=(k=b.next()).done);m=!0)w=k.value,(o=g).push.apply(o,a.toConsumableArray(w.weights));t.next=14;break;case 10:t.prev=10,t.t0=t.catch(6),y=!0,x=t.t0;case 14:t.prev=14,t.prev=15,m||null==b.return||b.return();case 17:if(t.prev=17,!y){t.next=20;break}throw x;case 20:return t.finish(17);case 21:return t.finish(14);case 22:A=[],E=[],C=!0,S=!1,N=void 0,t.prev=25,T=e[Symbol.iterator]();case 27:if(C=(D=T.next()).done){t.next=49;break}for(F=D.value,O=!0,_=!1,I=void 0,t.prev=30,R=F.paths[Symbol.iterator]();!(O=(M=R.next()).done);O=!0)B=M.value,null!=n.weightUrlConverter?E.push(n.weightUrlConverter(B)):A.push(v+B+h);t.next=38;break;case 34:t.prev=34,t.t1=t.catch(30),_=!0,I=t.t1;case 38:t.prev=38,t.prev=39,O||null==R.return||R.return();case 41:if(t.prev=41,!_){t.next=44;break}throw I;case 44:return t.finish(41);case 45:return t.finish(38);case 46:C=!0,t.next=27;break;case 49:t.next=55;break;case 51:t.prev=51,t.t2=t.catch(25),S=!0,N=t.t2;case 55:t.prev=55,t.prev=56,C||null==T.return||T.return();case 58:if(t.prev=58,!S){t.next=61;break}throw N;case 61:return t.finish(58);case 62:return t.finish(55);case 63:if(!n.weightUrlConverter){t.next=72;break}return t.t3=(u=A).push,t.t4=u,t.t5=a,t.next=69,Promise.all(E);case 69:t.t6=t.sent,t.t7=t.t5.toConsumableArray.call(t.t5,t.t6),t.t3.apply.call(t.t3,t.t4,t.t7);case 72:return t.next=74,f.loadWeightsAsArrayBuffer(A,{requestInit:n.requestInit,fetchFunc:n.fetch,onProgress:n.onProgress});case 74:return P=t.sent,t.abrupt("return",[g,c.concatenateArrayBuffers(P)]);case 76:case"end":return t.stop()}}),r,null,[[6,10,14,22],[15,,17,21],[25,51,55,63],[30,34,38,46],[39,,41,45],[56,,58,62]])})))()}}]),e}();function p(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function h(e){return null!=e.match(d.URL_SCHEME_REGEX)}d.URL_SCHEME_REGEX=/^https?:\/\//;var v=function(e,t){if("undefined"==typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return h(e)})):h(e))?g(e,t):null};function g(e,t){return new d(e,t)}function m(e,t){return g(e,t)}l.IORouterRegistry.registerSaveRouter(v),l.IORouterRegistry.registerLoadRouter(v)})),s.register("8MN3w",(function(e,r){n(e.exports,"loadWeightsAsArrayBuffer",(function(){return d})),n(e.exports,"loadWeights",(function(){return h})),n(e.exports,"weightsLoaderFactory",(function(){return g})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("lU3MY"),u=s("kglvN"),c=s("69QQV"),l=s("5M72w"),f=s("bJQ9Z");function d(e,t){return p.apply(this,arguments)}function p(){return(p=a.default(t(i).mark((function e(n,r){var a,u,s,c,f,d,p,h,v;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r&&(r={}),a=null==r.fetchFunc?o.env().platform.fetch:r.fetchFunc,u=n.map((function(e){return a(e,r.requestInit,{isBinary:!0})})),s=0,c=.5,null!=r.onProgress){e.next=11;break}return e.next=8,Promise.all(u);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,l.monitorPromisesProgress(u,r.onProgress,s,c);case 13:e.t0=e.sent;case 14:if(f=e.t0,d=f.map((function(e){return e.arrayBuffer()})),p=.5,h=1,null!=r.onProgress){e.next=24;break}return e.next=21,Promise.all(d);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,l.monitorPromisesProgress(d,r.onProgress,p,h);case 26:e.t1=e.sent;case 27:return v=e.t1,e.abrupt("return",v);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function h(e){return v.apply(this,arguments)}function v(){return v=a.default(t(i).mark((function e(n){var r,a,o,u,s=arguments;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:"",a=s.length>2?s[2]:void 0,o=s.length>3?s[3]:void 0,u=g((function(e){return d(e,{requestInit:o})})),e.abrupt("return",u(n,r,a));case 4:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function g(e){return n=a.default(t(i).mark((function n(r){var a,o,s,l,d,p,h,v,g,m,y,x,b=arguments;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=b.length>1&&void 0!==b[1]?b[1]:"",o=b.length>2?b[2]:void 0,s=r.map((function(){return!1})),l={},d=null!=o?o.map((function(){return!1})):[],p=[],r.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,a=f.DTYPE_VALUE_SIZE_MAP[r]*u.sizeFromShape(e.shape),i=function(){s[t]=!0,null==l[t]&&(l[t]=[]),l[t].push({manifestEntry:e,groupOffset:n,sizeBytes:a})};null!=o?o.forEach((function(t,n){t===e.name&&(i(),d[n]=!0)})):i(),p.push(e.name),n+=a}))})),d.every((function(e){return e}))){t.next=9;break}throw h=o.filter((function(e,t){return!d[t]})),new Error("Could not find weights in manifest with names: "+"".concat(h.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(p.join(", "),"."));case 9:return v=s.reduce((function(e,t,n){return t&&e.push(n),e}),[]),g=[],v.forEach((function(e){r[e].paths.forEach((function(e){var t=a+(a.endsWith("/")?"":"/")+e;g.push(t)}))})),t.next=14,e(g);case 14:return m=t.sent,y={},x=0,v.forEach((function(e){for(var t=r[e].paths.length,n=0,a=0;a<t;a++)n+=m[x+a].byteLength;for(var i=new ArrayBuffer(n),o=new Uint8Array(i),u=0,s=0;s<t;s++){var f=new Uint8Array(m[x+s]);o.set(f,u),u+=f.byteLength}l[e].forEach((function(e){var t=i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=c.decodeWeights(t,[e.manifestEntry]);for(var r in n)y[r]=n[r]})),x+=t})),t.abrupt("return",y);case 19:case"end":return t.stop()}}),n)}))),function(e){return n.apply(this,arguments)};var n}})),s.register("5M72w",(function(e,t){n(e.exports,"monitorPromisesProgress",(function(){return a}));var r=s("kglvN");function a(e,t,n,a){var i,o,u;i=e,r.assert(null!=i&&Array.isArray(i)&&i.length>0,(function(){return"promises must be a none empty array"})),o=n=null==n?0:n,u=a=null==a?1:a,r.assert(o>=0&&o<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(o)})),r.assert(u>=0&&u<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(u)})),r.assert(u>=o,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(o," and endFraction ")+"".concat(u)}));var s=0;return Promise.all(e.map((function(r){return r.then((function(r){var i=n+ ++s/e.length*(a-n);return t(i),r})),r})))}})),s.register("jdufM",(function(e,r){n(e.exports,"fromMemory",(function(){return f})),n(e.exports,"withSaveHandler",(function(){return d})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("e3nFV"),u=s("40Zzs"),c=function(){"use strict";function e(t){a.default(this,e),this.modelArtifacts=t}return i.default(e,[{key:"load",value:function(){var e=this;return o.default(t(u).mark((function n(){return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.modelArtifacts);case 1:case"end":return t.stop()}}),n)})))()}}]),e}(),l=function(){"use strict";function e(t){a.default(this,e),this.saveHandler=t}return i.default(e,[{key:"save",value:function(e){var n=this;return o.default(t(u).mark((function r(){return t(u).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.saveHandler(e));case 1:case"end":return t.stop()}}),r)})))()}}]),e}();function f(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new c(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new c({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new c({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function d(e){return new l(e)}})),s.register("bSHEf",(function(e,t){n(e.exports,"confusionMatrix",(function(){return s("jHZuF").confusionMatrix}));s("jHZuF")})),s.register("jHZuF",(function(e,t){n(e.exports,"confusionMatrix",(function(){return f}));var r=s("lcVC1"),a=s("kglvN"),i=s("782ce"),o=s("5KHLt"),u=s("9ZTJv"),c=s("f1skK"),l=s("9PS5J");var f=c.op({confusionMatrix_:function(e,t,n){var s=r.convertToTensor(e,"labels","confusionMatrix"),c=r.convertToTensor(t,"predictions","confusionMatrix");a.assert(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, "+"but got ".concat(n)})),a.assert(1===s.rank,(function(){return"Expected the rank of labels to be 1, but got ".concat(s.rank)})),a.assert(1===c.rank,(function(){return"Expected the rank of predictions to be 1, "+"but got ".concat(c.rank)})),a.assert(s.shape[0]===c.shape[0],(function(){return"Mismatch in the number of examples: "+"".concat(s.shape[0]," vs. ").concat(c.shape[0],". ")+"Labels and predictions should have the same number of elements."})),a.assert(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+"".concat(n)}));var f=u.oneHot(i.cast(s,"int32"),n),d=u.oneHot(i.cast(c,"int32"),n),p=l.transpose(f);return i.cast(o.matMul(p,d),"int32")}})})),s.register("iq41T",(function(e,r){n(e.exports,"toPixels",(function(){return m})),n(e.exports,"fromPixels",(function(){return x})),s("1i51P");var a,i=s("6vecG"),o=s("e3nFV"),u=s("40Zzs"),c=s("1dnDT"),l=s("cvMH2"),f=s("d4BUr"),d=s("4JvjV"),p=s("lcVC1"),h=s("782ce"),v=s("f1skK"),g=s("a5FCc");function m(e,t){return y.apply(this,arguments)}function y(){return y=o.default(t(u).mark((function e(n,r){var a,o,s,c,l,f,v,g,m,y,x,b,k,w,A,E;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=p.convertToTensor(n,"img","toPixels"),n instanceof d.Tensor||(o=a,a=h.cast(o,"int32"),o.dispose()),2===a.rank||3===a.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(a.rank,"."));case 4:if(s=i.default(a.shape.slice(0,2),2),c=s[0],l=s[1],!((f=2===a.rank?1:a.shape[2])>4||2===f)){e.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(f));case 8:if("float32"===a.dtype||"int32"===a.dtype){e.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(a.dtype,".")+" Please use float32 or int32 tensors.");case 10:return e.next=12,a.data();case 12:v=e.sent,g="float32"===a.dtype?255:1,m=new Uint8ClampedArray(l*c*4),y=0;case 16:if(!(y<c*l)){e.next=41;break}x=[0,0,0,255],b=0;case 19:if(!(b<f)){e.next=33;break}if(k=v[y*f+b],"float32"!==a.dtype){e.next=26;break}if(!(k<0||k>1)){e.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(k,"."));case 24:e.next=29;break;case 26:if("int32"!==a.dtype){e.next=29;break}if(!(k<0||k>255)){e.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(k,"."));case 29:1===f?(x[0]=k*g,x[1]=k*g,x[2]=k*g):x[b]=k*g;case 30:b++,e.next=19;break;case 33:m[(w=4*y)+0]=Math.round(x[0]),m[w+1]=Math.round(x[1]),m[w+2]=Math.round(x[2]),m[w+3]=Math.round(x[3]);case 38:++y,e.next=16;break;case 41:return null!=r&&(r.width=l,r.height=c,A=r.getContext("2d"),E=new ImageData(m,l,c),A.putImageData(E,0,0)),a!==n&&a.dispose(),e.abrupt("return",m);case 44:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}var x=v.op({fromPixels_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,o=!1,u=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)o=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)u=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(o){var d=2;if(o&&e.readyState<d)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var p=f.getKernel(l.FromPixels,c.ENGINE.backendName);if(null!=p){var h={pixels:e},v={numChannels:t};return c.ENGINE.runKernel(l.FromPixels,h,v)}var m,y,x=i.default(o?[e.videoWidth,e.videoHeight]:[e.width,e.height],2),b=x[0],k=x[1];if(s?m=e.getContext("2d").getImageData(0,0,b,k).data:r||n?m=e.data:(u||o)&&(null==a&&(a=document.createElement("canvas").getContext("2d")),a.canvas.width=b,a.canvas.height=k,a.drawImage(e,0,0,b,k),m=a.getImageData(0,0,b,k).data),4===t)y=new Int32Array(m);else{var w=b*k;y=new Int32Array(w*t);for(var A=0;A<w;A++)for(var E=0;E<t;++E)y[A*t+E]=m[4*A+E]}var C=[k,b,t];return g.tensor3d(y,C,"int32")}})})),s.register("f432R",(function(e,t){n(e.exports,"prepareAndValidate",(function(){return i})),s("1i51P");var r=s("9M1dW"),a=s("kglvN");function i(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[t.rank-1]," vs. ").concat(e.rank));if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var n=t.shape,i=n[n.length-1],o=1,u=0;u<n.length-1;++u)o*=n[u];var s=e.shape,c=n.slice();c.pop();for(var l=1,f=i;f<e.rank;++f)l*=s[f],c.push(s[f]);var d=r.default(a.computeStrides(e.shape).map((function(e){return e/l}))).concat([1]).slice(0,i);return[c,o,l,d]}})),s.register("6b8rQ",(function(e,t){n(e.exports,"Serializable",(function(){return u})),n(e.exports,"SerializationMap",(function(){return c})),n(e.exports,"registerClass",(function(){return l})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("5lcaY"),o=s("kglvN"),u=function(){"use strict";function e(){r.default(this,e)}return a.default(e,[{key:"getClassName",value:function(){return this.constructor.className}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),e}(),c=function(){"use strict";function e(){r.default(this,e),this.classNameMap={}}return a.default(e,null,[{key:"getMap",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"register",value:function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]}}]),e}();function l(e){o.assert(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),o.assert("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+i.default(e.className)})),o.assert(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),c.register(e)}})),s.register("9lNTO",(function(e,t){n(e.exports,"version",(function(){return r}));
/** @license See the LICENSE file. */
var r="2.4.0"})),s.register("dITq1",(function(t,r){n(t.exports,"castTensor",(function(){return S})),n(t.exports,"reshapeTensor",(function(){return N})),n(t.exports,"linspaceImpl",(function(){return T})),n(t.exports,"slice_util",(function(){return s("aK0eq")})),n(t.exports,"upcastType",(function(){return s("aTTkI").upcastType})),n(t.exports,"segment_util",(function(){return s("gXhQh")}));var a=s("1dnDT"),i=s("782ce"),o=s("bftEy"),u=s("5J0XY"),c=s("ilMKa"),l=s("kglvN"),f=(s("aK0eq"),s("gXhQh"),s("4RRNB")),d=s("kNwIt"),p=s("9MLLM"),h=s("drGuD"),v=s("5nWoB"),g=s("cut2C"),m=(s("aTTkI"),s("gGGeQ")),y=s("hWjdn"),x=s("f432R"),b=s("cInGs"),k=s("gT6fB"),w=(v=s("5nWoB"),s("4xc7q")),A=s("leTnN"),E=s("mkU1V"),C=s("hP8ts");function S(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=c.zeros(e.shape),u=i.cast(e,"float32"),s=n.complex(u,r);return r.dispose(),u.dispose(),s}if(!l.hasEncodingLoss(e.dtype,t))return a.ENGINE.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var f=n.real(e),d=i.cast(f,t);return f.dispose(),d}if("int32"===t)return n.int(e);if("bool"===t){var p=o.scalar(0,e.dtype),h=n.notEqual(e,p);return p.dispose(),h}throw new Error("Error in Cast: failed to cast ".concat(e.dtype," to ").concat(t))}function N(e,t){return a.ENGINE.makeTensorFromDataId(e.dataId,t,e.dtype)}function T(e,t,n){var r=(t-e)/(n-1),a=l.makeZerosTypedArray(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return u.tensor1d(a,"float32")}e(t.exports,f),e(t.exports,d),e(t.exports,p),e(t.exports,h),e(t.exports,v),e(t.exports,g),e(t.exports,m),e(t.exports,y),e(t.exports,x),e(t.exports,b),e(t.exports,k),e(t.exports,w),e(t.exports,A),e(t.exports,E),e(t.exports,C)})),s.register("gGGeQ",(function(e,t){function r(e,t,n){return[n*("number"==typeof e?e:e[0]),t*("number"==typeof e?e:e[1])]}n(e.exports,"getImageCenter",(function(){return r}))})),s.register("hWjdn",(function(e,t){n(e.exports,"getReshaped",(function(){return a})),n(e.exports,"getPermuted",(function(){return i})),n(e.exports,"getReshapedPermuted",(function(){return o})),n(e.exports,"getSliceBeginCoords",(function(){return u})),n(e.exports,"getSliceSize",(function(){return c})),s("1i51P");var r=s("9M1dW");function a(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function i(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=[];if(n){a.push(t);for(var i=t+1;i<e;++i)i<=2*t?(a.push(i),a.push(i-(t+1))):a.push(i)}else{for(var o,u,s=[],c=[],l=1;l<e;++l)l>=2*t+1||l%2==1?c.push(l):s.push(l);(o=a).push.apply(o,r.default(s)),a.push(0),(u=a).push.apply(u,r.default(c))}return a}function o(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function u(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function c(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}})),s.register("4xc7q",(function(e,t){n(e.exports,"ERF_P",(function(){return r})),n(e.exports,"ERF_A1",(function(){return a})),n(e.exports,"ERF_A2",(function(){return i})),n(e.exports,"ERF_A3",(function(){return o})),n(e.exports,"ERF_A4",(function(){return u})),n(e.exports,"ERF_A5",(function(){return s}));var r=.3275911,a=.254829592,i=-.284496736,o=1.421413741,u=-1.453152027,s=1.061405429})),s.register("leTnN",(function(e,t){n(e.exports,"warn",(function(){return i})),n(e.exports,"log",(function(){return o})),s("1i51P");var r=s("9M1dW"),a=s("lU3MY");function i(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;a.env().getBool("IS_TEST")||(i=console).warn.apply(i,r.default(t))}function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i;a.env().getBool("IS_TEST")||(i=console).log.apply(i,r.default(t))}})),s.register("mkU1V",(function(e,t){function r(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function a(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function i(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function o(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function u(e,t){return{real:e[2*t],imag:e[2*t+1]}}function s(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function c(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function l(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}n(e.exports,"mergeRealAndImagArrays",(function(){return r})),n(e.exports,"splitRealAndImagArrays",(function(){return a})),n(e.exports,"complexWithEvenIndex",(function(){return i})),n(e.exports,"complexWithOddIndex",(function(){return o})),n(e.exports,"getComplexWithIndex",(function(){return u})),n(e.exports,"assignToTypedArray",(function(){return s})),n(e.exports,"exponents",(function(){return c})),n(e.exports,"exponent",(function(){return l}))})),s.register("289sH",(function(e,t){n(e.exports,"nonMaxSuppressionV3Impl",(function(){return s("cMPcY").nonMaxSuppressionV3Impl})),n(e.exports,"nonMaxSuppressionV4Impl",(function(){return s("cMPcY").nonMaxSuppressionV4Impl})),n(e.exports,"nonMaxSuppressionV5Impl",(function(){return s("cMPcY").nonMaxSuppressionV5Impl})),n(e.exports,"split",(function(){return s("dPVsR").split})),n(e.exports,"tile",(function(){return s("cfg5H").tile})),n(e.exports,"topkImpl",(function(){return s("fZDxr").topkImpl})),n(e.exports,"whereImpl",(function(){return s("ah74e").whereImpl}));s("cMPcY"),s("dPVsR"),s("cfg5H"),s("fZDxr"),s("ah74e")})),s.register("dPVsR",(function(e,t){n(e.exports,"split",(function(){return i})),s("1i51P");var r=s("9M1dW"),a=s("jPaTA");function i(e,t,n){var i=new Array(e.rank).fill(0),o=e.shape.slice();return t.map((function(t){var u=r.default(o);u[n]=t;var s=a.slice(e,i,u);return i[n]+=t,s}))}})),s.register("cfg5H",(function(e,t){n(e.exports,"tile",(function(){return a}));var r=s("8orDI");function a(e,t){for(var n=new Array(e.rank),a=0;a<n.length;a++)n[a]=e.shape[a]*t[a];for(var i=r.buffer(n,e.dtype),o=0;o<i.values.length;++o){for(var u=i.indexToLoc(o),s=new Array(e.rank),c=0;c<s.length;c++)s[c]=u[c]%e.shape[c];var l=e.locToIndex(s);i.values[o]=e.values[l]}return i.toTensor()}})),s.register("fZDxr",(function(e,t){n(e.exports,"topkImpl",(function(){return i}));var r=s("616DT"),a=s("kglvN");function i(e,t,n,i,o){for(var u=function(t){for(var n=t*f,r=e.subarray(n,n+f),a=[],o=0;o<r.length;o++)a.push({value:r[o],index:o});a.sort((function(e,t){return t.value-e.value}));for(var u=t*i,s=d.subarray(u,u+i),c=p.subarray(u,u+i),l=0;l<i;l++)s[l]=a[l].value,c[l]=a[l].index},s=t[t.length-1],c=[e.length/s,s],l=c[0],f=c[1],d=a.getTypedArrayFromDType(n,l*i),p=a.getTypedArrayFromDType("int32",l*i),h=0;h<l;h++)u(h);var v=t.slice();return v[v.length-1]=i,[r.tensor(d,v,n),r.tensor(p,v,"int32")]}})),s.register("eF9sD",(function(e,r){n(e.exports,"AdadeltaOptimizer",(function(){return k})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("9M1dW"),f=s("40Zzs"),d=s("1dnDT"),p=s("P1tXK"),h=s("b3Qcj"),v=s("6baO0"),g=s("j0e1k");s("j2ViA");var m=s("buy0T"),y=s("4C8ia"),x=s("8p3bZ"),b=s("6b8rQ"),k=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return o.default(this,r),(a=n.call(this)).learningRate=e,a.rho=t,a.epsilon=i,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==i&&(a.epsilon=d.ENGINE.backend.epsilon()),a}return u.default(r,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=t,i=d.ENGINE.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:"".concat(n,"/accum_grad"),variable:p.tidy((function(){return x.zerosLike(i).variable(false)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:"".concat(n,"/accum_var"),variable:p.tidy((function(){return x.zerosLike(i).variable(false)}))});var o=Array.isArray(e)?e[r].tensor:e[n];if(null!=o){var u=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;p.tidy((function(){var e=h.add(g.mul(u,a.rho),g.mul(y.square(o),1-a.rho)),t=g.mul(v.div(m.sqrt(h.add(s,a.epsilon)),m.sqrt(h.add(u,a.epsilon))),o),n=h.add(g.mul(s,a.rho),g.mul(y.square(t),1-a.rho));u.assign(e),s.assign(n);var r=h.add(g.mul(t,-a.learningRate),i);i.assign(r)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedUpdates&&(p.dispose(this.accumulatedGrads.map((function(e){return e.variable}))),p.dispose(this.accumulatedUpdates.map((function(e){return e.variable}))))}},{key:"getWeights",value:function(){var e=this;return c.default(t(f).mark((function n(){var r;return t(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.default(e.accumulatedGrads).concat(l.default(e.accumulatedUpdates)),t.next=3,e.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(r.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return t.stop()}}),n)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(f).mark((function r(){var a;return t(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.extractIterations(e);case 2:e=t.sent,a=e.length/2,!1,n.accumulatedGrads=e.slice(0,a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),n.accumulatedUpdates=e.slice(a,2*a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 7:case"end":return t.stop()}}),r)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.rho,t.epsilon)}}]),r}(s("aS8kb").Optimizer);k.className="Adadelta",b.registerClass(k)})),s.register("aS8kb",(function(e,r){n(e.exports,"Optimizer",(function(){return h})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("40Zzs"),f=s("P1tXK"),d=s("2c3OP");s("j2ViA");var p=s("bftEy"),h=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(){return o.default(this,r),n.apply(this,arguments)}return u.default(r,[{key:"minimize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return f.dispose(i),t?a:(a.dispose(),null)}},{key:"iterations",get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_}},{key:"incrementIterations",value:function(){this.iterations_=this.iterations+1}},{key:"computeGradients",value:function(e,t){return d.variableGrads(e,t)}},{key:"dispose",value:function(){null!=this.iterations_&&f.dispose(this.iterations_)}},{key:"saveIterations",value:function(){var e=this;return c.default(t(l).mark((function n(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return null==e.iterations_&&(e.iterations_=0),t.abrupt("return",{name:"iter",tensor:p.scalar(e.iterations_,"int32")});case 2:case"end":return t.stop()}}),n)})))()}},{key:"getWeights",value:function(){return c.default(t(l).mark((function e(){return t(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for this optimizer yet.");case 1:case"end":return e.stop()}}),e)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(l).mark((function e(){return t(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for this optimizer class "+"".concat(n.getClassName()));case 1:case"end":return e.stop()}}),e)})))()}},{key:"extractIterations",value:function(e){var n=this;return c.default(t(l).mark((function r(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e[0].tensor.data();case 2:return n.iterations_=t.sent[0],t.abrupt("return",e.slice(1));case 4:case"end":return t.stop()}}),r)})))()}}]),r}(s("6b8rQ").Serializable);Object.defineProperty(h,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}})})),s.register("lPnjT",(function(e,r){n(e.exports,"AdagradOptimizer",(function(){return b})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("40Zzs"),f=s("1dnDT"),d=s("P1tXK"),p=s("b3Qcj"),h=s("6baO0"),v=s("jwnkA"),g=s("j0e1k"),m=s("buy0T"),y=s("4C8ia"),x=s("6b8rQ"),b=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return o.default(this,r),(t=n.call(this)).learningRate=e,t.initialAccumulatorValue=a,t.accumulatedGrads=[],t}return u.default(r,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=t,i=f.ENGINE.registeredVariables[n];if(null==t.accumulatedGrads[r]){var o=t;t.accumulatedGrads[r]={originalName:"".concat(n,"/accumulator"),variable:d.tidy((function(){return v.fill(i.shape,o.initialAccumulatorValue).variable(false)}))}}var u=Array.isArray(e)?e[r].tensor:e[n];if(null!=u){var s=t.accumulatedGrads[r].variable;d.tidy((function(){var e=p.add(s,y.square(u));s.assign(e);var t=p.add(g.mul(h.div(u,m.sqrt(p.add(e,f.ENGINE.backend.epsilon()))),-a.learningRate),i);i.assign(t)}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedGrads&&d.dispose(this.accumulatedGrads.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=this;return c.default(t(l).mark((function n(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return t.stop()}}),n)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(l).mark((function r(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.extractIterations(e);case 2:e=t.sent,!1,n.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return t.stop()}}),r)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)}}]),r}(s("aS8kb").Optimizer);b.className="Adagrad",x.registerClass(b)})),s.register("c5YZO",(function(e,r){n(e.exports,"AdamOptimizer",(function(){return E})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("9M1dW"),f=s("40Zzs"),d=s("1dnDT"),p=s("P1tXK"),h=s("b3Qcj"),v=s("6baO0"),g=s("j0e1k"),m=s("WvbbQ"),y=s("bftEy"),x=s("buy0T"),b=s("4C8ia"),k=s("fZE7S"),w=s("8p3bZ"),A=s("6b8rQ"),E=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e,t,a){var i,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return o.default(this,r),(i=n.call(this)).learningRate=e,i.beta1=t,i.beta2=a,i.epsilon=u,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],p.tidy((function(){i.accBeta1=y.scalar(t).variable(),i.accBeta2=y.scalar(a).variable()})),null==u&&(i.epsilon=d.ENGINE.backend.epsilon()),i}return u.default(r,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);p.tidy((function(){var r=t,a=k.sub(1,t.accBeta1),i=k.sub(1,t.accBeta2);n.forEach((function(t,n){var o=d.ENGINE.registeredVariables[t];null==r.accumulatedFirstMoment[n]&&(r.accumulatedFirstMoment[n]={originalName:"".concat(t,"/m"),variable:p.tidy((function(){return w.zerosLike(o).variable(false)}))}),null==r.accumulatedSecondMoment[n]&&(r.accumulatedSecondMoment[n]={originalName:"".concat(t,"/v"),variable:p.tidy((function(){return w.zerosLike(o).variable(false)}))});var u=Array.isArray(e)?e[n].tensor:e[t];if(null!=u){var s=r.accumulatedFirstMoment[n].variable,c=r.accumulatedSecondMoment[n].variable,l=h.add(g.mul(s,r.beta1),g.mul(u,1-r.beta1)),f=h.add(g.mul(c,r.beta2),g.mul(b.square(u),1-r.beta2)),m=v.div(l,a),y=v.div(f,i);s.assign(l),c.assign(f);var k=h.add(g.mul(v.div(m,h.add(x.sqrt(y),r.epsilon)),-r.learningRate),o);o.assign(k)}})),t.accBeta1.assign(g.mul(t.accBeta1,t.beta1)),t.accBeta2.assign(g.mul(t.accBeta2,t.beta2))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&p.dispose(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&p.dispose(this.accumulatedSecondMoment.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=this;return c.default(t(f).mark((function n(){var r;return t(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=l.default(e.accumulatedFirstMoment).concat(l.default(e.accumulatedSecondMoment)),t.next=3,e.saveIterations();case 3:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(r.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 5:case"end":return t.stop()}}),n)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(f).mark((function r(){var a;return t(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.extractIterations(e);case 2:e=t.sent,p.tidy((function(){n.accBeta1.assign(m.pow(n.beta1,n.iterations_+1)),n.accBeta2.assign(m.pow(n.beta2,n.iterations_+1))})),a=e.length/2,!1,n.accumulatedFirstMoment=e.slice(0,a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}})),n.accumulatedSecondMoment=e.slice(a,2*a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 8:case"end":return t.stop()}}),r)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)}}]),r}(s("aS8kb").Optimizer);E.className="Adam",A.registerClass(E)})),s.register("gYXqz",(function(e,r){n(e.exports,"AdamaxOptimizer",(function(){return w})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("40Zzs"),f=s("1dnDT"),d=s("P1tXK"),p=s("3gUC5"),h=s("b3Qcj"),v=s("6baO0"),g=s("k7Du7"),m=s("j0e1k"),y=s("bftEy"),x=s("fZE7S"),b=s("8p3bZ"),k=s("6b8rQ"),w=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e,t,a){var i,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return o.default(this,r),(i=n.call(this)).learningRate=e,i.beta1=t,i.beta2=a,i.epsilon=u,i.decay=s,i.accumulatedFirstMoment=[],i.accumulatedWeightedInfNorm=[],d.tidy((function(){i.iteration=y.scalar(0).variable(),i.accBeta1=y.scalar(t).variable()})),null==u&&(i.epsilon=f.ENGINE.backend.epsilon()),i}return u.default(r,[{key:"applyGradients",value:function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);d.tidy((function(){var r=t,a=x.sub(1,t.accBeta1),i=v.div(-t.learningRate,h.add(m.mul(t.iteration,t.decay),1));n.forEach((function(t,n){var o=f.ENGINE.registeredVariables[t];null==r.accumulatedFirstMoment[n]&&(r.accumulatedFirstMoment[n]={originalName:"".concat(t,"/m"),variable:b.zerosLike(o).variable(false)}),null==r.accumulatedWeightedInfNorm[n]&&(r.accumulatedWeightedInfNorm[n]={originalName:"".concat(t,"/v"),variable:b.zerosLike(o).variable(false)});var u=Array.isArray(e)?e[n].tensor:e[t];if(null!=u){var s=r.accumulatedFirstMoment[n].variable,c=r.accumulatedWeightedInfNorm[n].variable,l=h.add(m.mul(s,r.beta1),m.mul(u,1-r.beta1)),d=m.mul(c,r.beta2),y=p.abs(u),x=g.maximum(d,y);s.assign(l),c.assign(x);var k=h.add(m.mul(v.div(i,a),v.div(l,h.add(x,r.epsilon))),o);o.assign(k)}})),t.iteration.assign(h.add(t.iteration,1)),t.accBeta1.assign(m.mul(t.accBeta1,t.beta1))})),this.incrementIterations()}},{key:"dispose",value:function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&d.dispose(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&d.dispose(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){return c.default(t(l).mark((function e(){return t(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("getWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})))()}},{key:"setWeights",value:function(e){return c.default(t(l).mark((function e(){return t(l).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("setWeights() is not implemented for Adamax yet.");case 1:case"end":return e.stop()}}),e)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)}}]),r}(s("aS8kb").Optimizer);w.className="Adamax",k.registerClass(w)})),s.register("lKg8b",(function(e,r){n(e.exports,"MomentumOptimizer",(function(){return y})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("40Zzs"),f=s("1dnDT"),d=s("P1tXK"),p=s("b3Qcj"),h=s("j0e1k"),v=s("bftEy"),g=s("8p3bZ"),m=s("6b8rQ"),y=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return o.default(this,r),(a=n.call(this,e)).learningRate=e,a.momentum=t,a.useNesterov=i,a.accumulations=[],a.m=v.scalar(a.momentum),a}return u.default(r,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=t,i=f.ENGINE.registeredVariables[n];if(null==t.accumulations[r]){t.accumulations[r]={originalName:"".concat(n,"/momentum"),variable:d.tidy((function(){return g.zerosLike(i).variable(false)}))}}var o=t.accumulations[r].variable,u=Array.isArray(e)?e[r].tensor:e[n];null!=u&&d.tidy((function(){var e,t=p.add(h.mul(a.m,o),u);e=a.useNesterov?p.add(h.mul(a.c,p.add(u,h.mul(t,a.m))),i):p.add(h.mul(a.c,t),i),o.assign(t),i.assign(e)}))})),this.incrementIterations()}},{key:"dispose",value:function(){this.m.dispose(),null!=this.accumulations&&d.dispose(this.accumulations.map((function(e){return e.variable})))}},{key:"setMomentum",value:function(e){this.momentum=e}},{key:"getWeights",value:function(){var e=this;return c.default(t(l).mark((function n(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(e.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 4:case"end":return t.stop()}}),n)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(l).mark((function r(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.extractIterations(e);case 2:e=t.sent,!1,n.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(false)}}));case 5:case"end":return t.stop()}}),r)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)}}]),r}(s("kyk60").SGDOptimizer);y.className="Momentum",m.registerClass(y)})),s.register("kyk60",(function(e,r){n(e.exports,"SGDOptimizer",(function(){return m})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("40Zzs"),f=s("1dnDT"),d=s("P1tXK"),p=s("b3Qcj"),h=s("j0e1k"),v=s("bftEy"),g=s("6b8rQ"),m=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e){var t;return o.default(this,r),(t=n.call(this)).learningRate=e,t.setLearningRate(e),t}return u.default(r,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=t,i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=f.ENGINE.registeredVariables[n];d.tidy((function(){var e=p.add(h.mul(a.c,i),o);o.assign(e)}))}})),this.incrementIterations()}},{key:"setLearningRate",value:function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=d.keep(v.scalar(-e))}},{key:"dispose",value:function(){this.c.dispose()}},{key:"getWeights",value:function(){var e=this;return c.default(t(l).mark((function n(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.saveIterations();case 2:return t.t0=t.sent,t.abrupt("return",[t.t0]);case 4:case"end":return t.stop()}}),n)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(l).mark((function r(){return t(l).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.extractIterations(e);case 2:if(0===(e=t.sent).length){t.next=5;break}throw new Error("SGD optimizer does not have settable weights.");case 5:case"end":return t.stop()}}),r)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate)}}]),r}(s("aS8kb").Optimizer);m.className="SGD",g.registerClass(m)})),s.register("YMSdl",(function(e,r){n(e.exports,"RMSPropOptimizer",(function(){return w})),s("1i51P");var a=s("2vsUb"),i=s("d6iiX"),o=s("3QOYJ"),u=s("2tuUj"),c=s("e3nFV"),l=s("9M1dW"),f=s("40Zzs"),d=s("1dnDT"),p=s("P1tXK"),h=s("b3Qcj"),v=s("6baO0"),g=s("j0e1k"),m=s("buy0T"),y=s("4C8ia"),x=s("fZE7S"),b=s("8p3bZ"),k=s("6b8rQ"),w=function(e){"use strict";a.default(r,e);var n=i.default(r);function r(e){var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(o.default(this,r),(t=n.call(this)).learningRate=e,t.decay=a,t.momentum=i,t.epsilon=u,t.accumulatedMeanSquares=[],t.accumulatedMoments=[],t.accumulatedMeanGrads=[],t.centered=s,null==u&&(t.epsilon=d.ENGINE.backend.epsilon()),null==e)throw new Error("learningRate for RMSPropOptimizer must be defined.");return t}return u.default(r,[{key:"applyGradients",value:function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=t,i=d.ENGINE.registeredVariables[n],o=!1;null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:"".concat(n,"/rms"),variable:p.tidy((function(){return b.zerosLike(i).variable(o)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:"".concat(n,"/momentum"),variable:p.tidy((function(){return b.zerosLike(i).variable(o)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:"".concat(n,"/mg"),variable:p.tidy((function(){return b.zerosLike(i).variable(o)}))});var u=Array.isArray(e)?e[r].tensor:e[n];if(null!=u){var s=t.accumulatedMeanSquares[r].variable,c=t.accumulatedMoments[r].variable;p.tidy((function(){var e=h.add(g.mul(s,a.decay),g.mul(y.square(u),1-a.decay));if(a.centered){var t=a.accumulatedMeanGrads[r].variable,n=h.add(g.mul(t,a.decay),g.mul(u,1-a.decay)),o=v.div(g.mul(u,a.learningRate),m.sqrt(x.sub(e,h.add(y.square(n),a.epsilon)))),l=h.add(g.mul(c,a.momentum),o);s.assign(e),t.assign(n),c.assign(l);var f=x.sub(i,l);i.assign(f)}else{var d=h.add(g.mul(s,a.decay),g.mul(y.square(u),1-a.decay)),p=h.add(g.mul(c,a.momentum),v.div(g.mul(u,a.learningRate),m.sqrt(h.add(d,a.epsilon))));s.assign(d),c.assign(p);var b=x.sub(i,p);i.assign(b)}}))}})),this.incrementIterations()}},{key:"dispose",value:function(){null!=this.accumulatedMeanSquares&&p.dispose(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&p.dispose(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&p.dispose(this.accumulatedMoments.map((function(e){return e.variable})))}},{key:"getWeights",value:function(){var e=this;return c.default(t(f).mark((function n(){var r,a;return t(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=l.default(e.accumulatedMeanSquares).concat(l.default(e.accumulatedMoments)),e.centered&&(r=a).push.apply(r,l.default(e.accumulatedMeanGrads)),t.next=5,e.saveIterations();case 5:return t.t0=t.sent,t.abrupt("return",[t.t0].concat(a.map((function(e){return{name:e.originalName,tensor:e.variable}}))));case 7:case"end":return t.stop()}}),n)})))()}},{key:"setWeights",value:function(e){var n=this;return c.default(t(f).mark((function r(){var a,i;return t(f).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.extractIterations(e);case 2:e=t.sent,a=n.centered?e.length/3:e.length/2,i=!1,n.accumulatedMeanSquares=e.slice(0,a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(i)}})),n.accumulatedMoments=e.slice(a,2*a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(i)}})),n.centered&&(n.accumulatedMeanGrads=e.slice(2*a,3*a).map((function(e){return{originalName:e.name,variable:e.tensor.variable(i)}})));case 8:case"end":return t.stop()}}),r)})))()}},{key:"getConfig",value:function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}}],[{key:"fromConfig",value:function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)}}]),r}(s("aS8kb").Optimizer);w.className="RMSProp",k.registerClass(w)})),s.register("aqs9m",(function(e,t){n(e.exports,"train",(function(){return a}));var r=s("de3Wo"),a={sgd:r.OptimizerConstructors.sgd,momentum:r.OptimizerConstructors.momentum,adadelta:r.OptimizerConstructors.adadelta,adagrad:r.OptimizerConstructors.adagrad,rmsprop:r.OptimizerConstructors.rmsprop,adamax:r.OptimizerConstructors.adamax,adam:r.OptimizerConstructors.adam}})),s.register("de3Wo",(function(e,t){n(e.exports,"OptimizerConstructors",(function(){return p})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("eF9sD"),o=s("lPnjT"),u=s("c5YZO"),c=s("gYXqz"),l=s("lKg8b"),f=s("YMSdl"),d=s("kyk60"),p=function(){"use strict";function e(){r.default(this,e)}return a.default(e,null,[{key:"sgd",value:function(e){return new d.SGDOptimizer(e)}},{key:"momentum",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new l.MomentumOptimizer(e,t,n)}},{key:"rmsprop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return new f.RMSPropOptimizer(e,t,n,r,a)}},{key:"adam",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return new u.AdamOptimizer(e,t,n,r)}},{key:"adadelta",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.001,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.95,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new i.AdadeltaOptimizer(e,t,n)}},{key:"adamax",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.002,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.9,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.999,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return new c.AdamaxOptimizer(e,t,n,r,a)}},{key:"adagrad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1;return new o.AdagradOptimizer(e,t)}}]),e}()})),s.register("QkKgL",(function(e,t){n(e.exports,"nextFrame",(function(){return a}));
/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
var r="undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate?setImmediate:function(e){return e()};function a(){return new Promise((function(e){return r((function(){return e()}))}))}})),s.register("lvUHp",(function(e,t){n(e.exports,"DataStorage",(function(){return i})),n(e.exports,"KernelBackend",(function(){return o})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=function(){"use strict";function e(t,n){r.default(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return a.default(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),o=function(){"use strict";function e(){r.default(this,e)}return a.default(e,[{key:"time",value:function(e){return u("time")}},{key:"read",value:function(e){return u("read")}},{key:"readSync",value:function(e){return u("readSync")}},{key:"numDataIds",value:function(){return u("numDataIds")}},{key:"disposeData",value:function(e){return u("disposeData")}},{key:"write",value:function(e,t,n){return u("write")}},{key:"move",value:function(e,t,n,r){return u("move")}},{key:"memory",value:function(){return u("memory")}},{key:"floatPrecision",value:function(){return u("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"batchMatMul",value:function(e,t,n,r){return u("batchMatMul")}},{key:"fusedBatchMatMul",value:function(e){e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights;return u("fusedBatchMatMul")}},{key:"slice",value:function(e,t,n){return u("slice")}},{key:"stridedSlice",value:function(e,t,n,r){return u("stridedSlice")}},{key:"unstack",value:function(e,t){return u("unstack")}},{key:"reverse",value:function(e,t){return u("reverse")}},{key:"concat",value:function(e,t){return u("concat")}},{key:"neg",value:function(e){return u("neg")}},{key:"add",value:function(e,t){return u("add")}},{key:"addN",value:function(e){return u("addN")}},{key:"subtract",value:function(e,t){return u("subtract")}},{key:"multiply",value:function(e,t){return u("multiply")}},{key:"realDivide",value:function(e,t){return u("realDivide")}},{key:"floorDiv",value:function(e,t){return u("floorDiv")}},{key:"sum",value:function(e,t){return u("sum")}},{key:"prod",value:function(e,t){return u("prod")}},{key:"unsortedSegmentSum",value:function(e,t,n){return u("unsortedSegmentSum")}},{key:"argMin",value:function(e,t){return u("argMin")}},{key:"argMax",value:function(e,t){return u("argMax")}},{key:"equal",value:function(e,t){return u("equal")}},{key:"notEqual",value:function(e,t){return u("notEqual")}},{key:"less",value:function(e,t){return u("less")}},{key:"lessEqual",value:function(e,t){return u("lessEqual")}},{key:"greater",value:function(e,t){return u("greater")}},{key:"greaterEqual",value:function(e,t){return u("greaterEqual")}},{key:"logicalNot",value:function(e){return u("logicalNot")}},{key:"logicalAnd",value:function(e,t){return u("logicalAnd")}},{key:"logicalOr",value:function(e,t){return u("logicalOr")}},{key:"where",value:function(e){return u("where")}},{key:"select",value:function(e,t,n){return u("select")}},{key:"topk",value:function(e,t,n){return u("topk")}},{key:"min",value:function(e,t){return u("min")}},{key:"minimum",value:function(e,t){return u("minimum")}},{key:"mod",value:function(e,t){return u("mod")}},{key:"max",value:function(e,t){return u("max")}},{key:"maximum",value:function(e,t){return u("maximum")}},{key:"all",value:function(e,t){return u("all")}},{key:"any",value:function(e,t){return u("any")}},{key:"squaredDifference",value:function(e,t){return u("squaredDifference")}},{key:"ceil",value:function(e){return u("ceil")}},{key:"floor",value:function(e){return u("floor")}},{key:"round",value:function(e){return u("round")}},{key:"sign",value:function(e){return u("sign")}},{key:"isNaN",value:function(e){return u("isNaN")}},{key:"isInf",value:function(e){return u("isInf")}},{key:"isFinite",value:function(e){return u("isFinite")}},{key:"pow",value:function(e,t){return u("pow")}},{key:"exp",value:function(e){return u("exp")}},{key:"expm1",value:function(e){return u("expm1")}},{key:"softmax",value:function(e,t){return u("softmax")}},{key:"log",value:function(e){return u("log")}},{key:"log1p",value:function(e){return u("log1p")}},{key:"sqrt",value:function(e){return u("sqrt")}},{key:"rsqrt",value:function(e){return u("rsqrt")}},{key:"square",value:function(e){return u("square")}},{key:"reciprocal",value:function(e){return u("reciprocal")}},{key:"relu",value:function(e){return u("relu")}},{key:"relu6",value:function(e){return u("relu6")}},{key:"prelu",value:function(e,t){return u("prelu")}},{key:"elu",value:function(e){return u("elu")}},{key:"eluDer",value:function(e,t){return u("eluDer")}},{key:"selu",value:function(e){return u("selu")}},{key:"int",value:function(e){return u("int")}},{key:"clip",value:function(e,t,n){return u("clip")}},{key:"abs",value:function(e){return u("abs")}},{key:"complexAbs",value:function(e){return u("complexAbs")}},{key:"sigmoid",value:function(e){return u("sigmoid")}},{key:"softplus",value:function(e){return u("softplus")}},{key:"sin",value:function(e){return u("sin")}},{key:"cos",value:function(e){return u("cos")}},{key:"tan",value:function(e){return u("tan")}},{key:"asin",value:function(e){return u("asin")}},{key:"acos",value:function(e){return u("acos")}},{key:"atan",value:function(e){return u("atan")}},{key:"atan2",value:function(e,t){return u("atan2")}},{key:"sinh",value:function(e){return u("sinh")}},{key:"cosh",value:function(e){return u("cosh")}},{key:"tanh",value:function(e){return u("tanh")}},{key:"asinh",value:function(e){return u("asinh")}},{key:"acosh",value:function(e){return u("acosh")}},{key:"atanh",value:function(e){return u("atanh")}},{key:"erf",value:function(e){return u("erf")}},{key:"step",value:function(e,t){return u("step")}},{key:"fusedConv2d",value:function(e){e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights;return u("fusedConv2d")}},{key:"conv2d",value:function(e,t,n){return u("conv2d")}},{key:"conv2dDerInput",value:function(e,t,n){return u("conv2dDerInput")}},{key:"conv2dDerFilter",value:function(e,t,n){return u("conv2dDerFilter")}},{key:"fusedDepthwiseConv2D",value:function(e){e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights;return u("fusedDepthwiseConv2D")}},{key:"depthwiseConv2D",value:function(e,t,n){return u("depthwiseConv2D")}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){return u("depthwiseConv2DDerInput")}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){return u("depthwiseConv2DDerFilter")}},{key:"conv3d",value:function(e,t,n){return u("conv3d")}},{key:"conv3dDerInput",value:function(e,t,n){return u("conv3dDerInput")}},{key:"conv3dDerFilter",value:function(e,t,n){return u("conv3dDerFilter")}},{key:"maxPool",value:function(e,t){return u("maxPool")}},{key:"maxPoolBackprop",value:function(e,t,n,r){return u("maxPoolBackprop")}},{key:"avgPool",value:function(e,t){return u("avgPool")}},{key:"avgPoolBackprop",value:function(e,t,n){return u("avgPoolBackprop")}},{key:"avgPool3d",value:function(e,t){return u("avgPool3d")}},{key:"avgPool3dBackprop",value:function(e,t,n){return u("avgPool3dBackprop")}},{key:"maxPool3d",value:function(e,t){return u("maxPool3d")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){return u("maxPool3dBackprop")}},{key:"reshape",value:function(e,t){return u("reshape")}},{key:"cast",value:function(e,t){return u("cast")}},{key:"tile",value:function(e,t){return u("tile")}},{key:"pad",value:function(e,t,n){return u("pad")}},{key:"transpose",value:function(e,t){return u("transpose")}},{key:"gather",value:function(e,t,n){return u("gather")}},{key:"gatherND",value:function(e,t){return u("gatherND")}},{key:"scatterND",value:function(e,t,n){return u("scatterND")}},{key:"batchToSpaceND",value:function(e,t,n){return u("batchToSpaceND")}},{key:"spaceToBatchND",value:function(e,t,n){return u("spaceToBatchND")}},{key:"resizeBilinear",value:function(e,t,n,r){return u("resizeBilinear")}},{key:"resizeBilinearBackprop",value:function(e,t,n){return u("resizeBilinearBackprop")}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){return u("resizeNearestNeighbor")}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){return u("resizeNearestNeighborBackprop")}},{key:"batchNorm",value:function(e,t,n,r,a,i){return u("batchNorm")}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){return u("localResponseNormalization4D")}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){return u("LRNGrad")}},{key:"multinomial",value:function(e,t,n,r){return u("multinomial")}},{key:"oneHot",value:function(e,t,n,r){return u("oneHot")}},{key:"cumsum",value:function(e,t,n,r){return u("cumsum")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){return u("nonMaxSuppression")}},{key:"fft",value:function(e){return u("fft")}},{key:"ifft",value:function(e){return u("ifft")}},{key:"complex",value:function(e,t){return u("complex")}},{key:"real",value:function(e){return u("real")}},{key:"imag",value:function(e){return u("imag")}},{key:"cropAndResize",value:function(e,t,n,r,a,i){return u("cropAndResize")}},{key:"depthToSpace",value:function(e,t,n){return u("depthToSpace")}},{key:"split",value:function(e,t,n){return u("split")}},{key:"sparseToDense",value:function(e,t,n,r){return u("sparseToDense")}},{key:"diag",value:function(e){return u("diag")}},{key:"fill",value:function(e,t,n){return u("fill")}},{key:"onesLike",value:function(e){return u("onesLike")}},{key:"zerosLike",value:function(e){return u("zerosLike")}},{key:"linspace",value:function(e,t,n){return u("linspace")}},{key:"dispose",value:function(){return u("dispose")}}]),e}();function u(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"Did you forget to import the kernel?")}})),s.register("lJspJ",(function(e,r){a(e.exports),n(e.exports,"vega",(function(){return w})),n(e.exports,"vegaLite",(function(){return A})),n(e.exports,"DEFAULT_ACTIONS",(function(){return C})),n(e.exports,"guessMode",(function(){return R})),n(e.exports,"default",(function(){return z}));var i=s("40Zzs");s("gwYJi");var o=s("lq2em"),u=s("4qDAZ"),c=s("aT3RN");s("eBb9L");var l=s("caNzv"),f=s("eBb9L");s("eBb9L");l=s("caNzv"),f=s("eBb9L");var d=s("2Wi4c"),p=s("axtJv"),h=s("ixC8H"),v=s("1x0ks");
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function g(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(o,u)}s((r=r.apply(e,t||[])).next())}))}function m(e,t,n){var r=e.open(t),a=new URL(t).origin,i=40;e.addEventListener("message",(function t(n){n.source===r&&(i=0,e.removeEventListener("message",t,!1))}),!1),setTimeout((function e(){i<=0||(r.postMessage(n,a),setTimeout(e,250),i-=1)}),250)}var y,x='.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box; }\n  .vega-embed.has-actions {\n    padding-right: 38px; }\n  .vega-embed details:not([open]) > :not(summary) {\n    display: none !important; }\n  .vega-embed summary {\n    list-style: none;\n    position: absolute;\n    top: 0;\n    right: 0;\n    padding: 6px;\n    z-index: 1000;\n    background: white;\n    box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n    color: #1b1e23;\n    border: 1px solid #aaa;\n    border-radius: 999px;\n    opacity: 0.2;\n    transition: opacity 0.4s ease-in;\n    outline: none;\n    cursor: pointer;\n    line-height: 0px; }\n    .vega-embed summary::-webkit-details-marker {\n      display: none; }\n    .vega-embed summary:active {\n      box-shadow: #aaa 0px 0px 0px 1px inset; }\n    .vega-embed summary svg {\n      width: 14px;\n      height: 14px; }\n  .vega-embed details[open] summary {\n    opacity: 0.7; }\n  .vega-embed:hover summary,\n  .vega-embed:focus summary {\n    opacity: 1 !important;\n    transition: opacity 0.2s ease; }\n  .vega-embed .vega-actions {\n    position: absolute;\n    z-index: 1001;\n    top: 35px;\n    right: -9px;\n    display: flex;\n    flex-direction: column;\n    padding-bottom: 8px;\n    padding-top: 8px;\n    border-radius: 4px;\n    box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n    border: 1px solid #d9d9d9;\n    background: white;\n    animation-duration: 0.15s;\n    animation-name: scale-in;\n    animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n    text-align: left; }\n    .vega-embed .vega-actions a {\n      padding: 8px 16px;\n      font-family: sans-serif;\n      font-size: 14px;\n      font-weight: 600;\n      white-space: nowrap;\n      color: #434a56;\n      text-decoration: none; }\n      .vega-embed .vega-actions a:hover {\n        background-color: #f7f7f9;\n        color: black; }\n    .vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n      content: "";\n      display: inline-block;\n      position: absolute; }\n    .vega-embed .vega-actions::before {\n      left: auto;\n      right: 14px;\n      top: -16px;\n      border: 8px solid #0000;\n      border-bottom-color: #d9d9d9; }\n    .vega-embed .vega-actions::after {\n      left: auto;\n      right: 15px;\n      top: -14px;\n      border: 7px solid #0000;\n      border-bottom-color: #fff; }\n  .vega-embed .chart-wrapper {\n    width: 100%;\n    height: 100%; }\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px; }\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6); }\n  to {\n    opacity: 1;\n    transform: scale(1); } }\n';function b(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=!0,i=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;k(e,c)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return e}function k(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=Object.keys(t)[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;l.writeConfig(e,u,t[u],!0)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var w=f,A=d,E="undefined"!=typeof window?window:void 0;void 0===A&&(null===(y=null==E?void 0:E.vl)||void 0===y?void 0:y.compile)&&(A=E.vl);var C={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},S={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},N={vega:"Vega","vega-lite":"Vega-Lite"},T={vega:w.version,"vega-lite":A?A.version:"not available"},D={vega:function(e){return e},"vega-lite":function(e,t){return A.compile(e,{config:t}).spec}},F='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',O="chart-wrapper";function _(e){return"function"==typeof e}function I(e,t,n,r){var a="<html><head>".concat(t,'</head><body><pre><code class="json">'),i="</code></pre>".concat(n,"</body></html>"),o=window.open("");o.document.write(a+e+i),o.document.title="".concat(N[r]," JSON Source")}function R(e,t){var n;if(e.$schema){var r=p.default(e.$schema);t&&t!==r.library&&console.warn("The given visualization spec is written in ".concat(N[r.library],", but mode argument sets ").concat(null!==(n=N[t])&&void 0!==n?n:t,"."));var a=r.library;return c.satisfies(T[a],"^".concat(r.version.slice(1)))||console.warn("The input spec uses ".concat(N[a]," ").concat(r.version,", but the current version of ").concat(N[a]," is v").concat(T[a],".")),a}return"mark"in e||"encoding"in e||"layer"in e||"hconcat"in e||"vconcat"in e||"facet"in e||"repeat"in e?"vega-lite":"marks"in e||"signals"in e||"scales"in e||"axes"in e?"vega":null!=t?t:"vega"}function M(e){return(t=e)&&"load"in t?e:w.loader(e);var t}function B(e){var t;return null!==(t=e.usermeta&&e.usermeta.embedOptions)&&void 0!==t?t:{}}function P(e,n){var r;return g(this,void 0,void 0,t(i).mark((function a(){var o,u;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l.isString(e.config)){t.next=8;break}return t.t1=JSON,t.next=4,n.load(e.config);case 4:t.t2=t.sent,t.t0=t.t1.parse.call(t.t1,t.t2),t.next=9;break;case 8:t.t0=null!==(r=e.config)&&void 0!==r?r:{};case 9:if(o=t.t0,!l.isString(e.patch)){t.next=18;break}return t.t4=JSON,t.next=14,n.load(e.patch);case 14:t.t5=t.sent,t.t3=t.t4.parse.call(t.t4,t.t5),t.next=19;break;case 18:t.t3=e.patch;case 19:return u=t.t3,t.abrupt("return",Object.assign(Object.assign(Object.assign({},e),u?{patch:u}:{}),o?{config:o}:{}));case 21:case"end":return t.stop()}}),a)})))}function L(e){var t,n=e.getRootNode?e.getRootNode():document;return n instanceof ShadowRoot?{root:n,rootContainer:n}:{root:document,rootContainer:null!==(t=document.head)&&void 0!==t?t:document.body}}function j(e,n){var r,a,s,f,d,y,k=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},A=arguments.length>3?arguments[3]:void 0;return g(this,void 0,void 0,t(i).mark((function E(){var N,M,B,P,j,z,U,V,W,G,H,q,J,K,X,Y,Q,Z,$,ee,te,ne,re,ae,ie,oe,ue,se,ce,le,fe,de,pe,he,ve,ge,me,ye,xe,be,ke,we,Ae,Ee;return t(i).wrap((function(E){for(;;)switch(E.prev=E.next){case 0:if(Ee=function(){ue&&document.removeEventListener("click",ue),te.finalize()},N=k.theme?l.mergeConfig(h[k.theme],null!==(r=k.config)&&void 0!==r?r:{}):k.config,M=l.isBoolean(k.actions)?k.actions:b({},C,null!==(a=k.actions)&&void 0!==a?a:{}),B=Object.assign(Object.assign({},S),k.i18n),P=null!==(s=k.renderer)&&void 0!==s?s:"canvas",j=null!==(f=k.logLevel)&&void 0!==f?f:w.Warn,z=null!==(d=k.downloadFileName)&&void 0!==d?d:"visualization",U="string"==typeof e?document.querySelector(e):e){E.next=10;break}throw new Error("".concat(e," does not exist"));case 10:return!1!==k.defaultStyle&&(V="vega-embed-style",W=L(U),G=W.root,H=W.rootContainer,G.getElementById(V)||((q=document.createElement("style")).id=V,q.innerText=void 0===k.defaultStyle||!0===k.defaultStyle?x.toString():k.defaultStyle,H.appendChild(q))),J=R(n,k.mode),K=D[J](n,N),"vega-lite"===J&&K.$schema&&(X=p.default(K.$schema),c.satisfies(T.vega,"^".concat(X.version.slice(1)))||console.warn("The compiled spec uses Vega ".concat(X.version,", but current version is v").concat(T.vega,"."))),U.classList.add("vega-embed"),M&&U.classList.add("has-actions"),U.innerHTML="",Y=U,M&&((Q=document.createElement("div")).classList.add(O),U.appendChild(Q),Y=Q),(Z=k.patch)&&(K=Z instanceof Function?Z(K):o.applyPatch(K,Z,!0,!1).newDocument),k.formatLocale&&w.formatLocale(k.formatLocale),k.timeFormatLocale&&w.timeFormatLocale(k.timeFormatLocale),$=k.ast,ee=w.parse(K,"vega-lite"===J?{}:N,{ast:$}),te=new(k.viewClass||w.View)(ee,Object.assign({loader:A,logLevel:j,renderer:P},$?{expr:w.expressionInterpreter}:{})),!1!==k.tooltip&&(ne=_(k.tooltip)?k.tooltip:new v.Handler(!0===k.tooltip?{}:k.tooltip).call,te.tooltip(ne)),void 0===(re=k.hover)&&(re="vega"===J),re&&(ie=(ae="boolean"==typeof re?{}:re).hoverSet,oe=ae.updateSet,te.hover(ie,oe)),k&&(null!=k.width&&te.width(k.width),null!=k.height&&te.height(k.height),null!=k.padding&&te.padding(k.padding)),E.next=33,te.initialize(Y,k.bind).runAsync();case 33:if(!1===M){E.next=61;break}if(se=U,!1!==k.defaultStyle&&((ce=document.createElement("details")).title=B.CLICK_TO_VIEW_ACTIONS,U.append(ce),se=ce,(le=document.createElement("summary")).innerHTML=F,ce.append(le),ue=function(e){ce.contains(e.target)||ce.removeAttribute("open")},document.addEventListener("click",ue)),fe=document.createElement("div"),se.append(fe),fe.classList.add("vega-actions"),!0!==M&&!1===M.export){E.next=58;break}for(de=!0,pe=!1,he=void 0,E.prev=42,ve=["svg","png"][Symbol.iterator]();!(de=(ge=ve.next()).done);de=!0)me=ge.value,(!0===M||!0===M.export||M.export[me])&&(ye=B["".concat(me.toUpperCase(),"_ACTION")],(xe=document.createElement("a")).text=ye,xe.href="#",xe.target="_blank",xe.download="".concat(z,".").concat(me),xe.addEventListener("mousedown",(function(e){return g(this,void 0,void 0,t(i).mark((function n(){var r;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.next=3,te.toImageURL(me,k.scaleFactor);case 3:r=t.sent,this.href=r;case 5:case"end":return t.stop()}}),n,this)})))})),fe.append(xe));E.next=50;break;case 46:E.prev=46,E.t0=E.catch(42),pe=!0,he=E.t0;case 50:E.prev=50,E.prev=51,de||null==ve.return||ve.return();case 53:if(E.prev=53,!pe){E.next=56;break}throw he;case 56:return E.finish(53);case 57:return E.finish(50);case 58:!0!==M&&!1===M.source||((be=document.createElement("a")).text=B.SOURCE_ACTION,be.href="#",be.addEventListener("click",(function(e){var r,a;I(t(u)(n),null!==(r=k.sourceHeader)&&void 0!==r?r:"",null!==(a=k.sourceFooter)&&void 0!==a?a:"",J),e.preventDefault()})),fe.append(be)),"vega-lite"!==J||!0!==M&&!1===M.compiled||((ke=document.createElement("a")).text=B.COMPILED_ACTION,ke.href="#",ke.addEventListener("click",(function(e){var n,r;I(t(u)(K),null!==(n=k.sourceHeader)&&void 0!==n?n:"",null!==(r=k.sourceFooter)&&void 0!==r?r:"","vega"),e.preventDefault()})),fe.append(ke)),!0!==M&&!1===M.editor||(we=null!==(y=k.editorUrl)&&void 0!==y?y:"https://vega.github.io/editor/",(Ae=document.createElement("a")).text=B.EDITOR_ACTION,Ae.href="#",Ae.addEventListener("click",(function(e){m(window,we,{config:N,mode:J,renderer:P,spec:t(u)(n)}),e.preventDefault()})),fe.append(Ae));case 61:return E.abrupt("return",{view:te,spec:n,vgSpec:K,finalize:Ee});case 63:case"end":return E.stop()}}),E,null,[[42,46,50,58],[51,,53,57]])})))}var z=function(e,n){var r,a,o,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return g(this,void 0,void 0,t(i).mark((function s(){var c,f,d,p,h,v;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!l.isString(n)){t.next=11;break}return f=M(u.loader),t.t0=JSON,t.next=7,f.load(n);case 7:t.t1=t.sent,c=t.t0.parse.call(t.t0,t.t1),t.next=12;break;case 11:c=n;case 12:return d=B(c).loader,f&&!d||(f=M(null!==(r=u.loader)&&void 0!==r?r:d)),t.next=16,P(B(c),f);case 16:return p=t.sent,t.next=19,P(u,f);case 19:return h=t.sent,v=Object.assign(Object.assign({},b(h,p)),{config:l.mergeConfig(null!==(a=h.config)&&void 0!==a?a:{},null!==(o=p.config)&&void 0!==o?o:{})}),t.next=23,j(e,c,v,f);case 23:return t.abrupt("return",t.sent);case 24:case"end":return t.stop()}}),s)})))}})),s.register("gwYJi",(function(e,t){n(e.exports,"applyPatch",(function(){return s("lq2em").applyPatch})),s("lq2em"),s("jDlz8");var r=s("1A7En");s("lq2em"),s("jDlz8");r=s("1A7En"),Object.assign({},$38a664a783d9dd59$import$5ecbb526cd5c0bbc,$38a664a783d9dd59$import$4f1f131d5e9c7574,{JsonPatchError:r.PatchError,deepClone:r._deepClone,escapePathComponent:r.escapePathComponent,unescapePathComponent:r.unescapePathComponent})})),s.register("lq2em",(function(e,t){n(e.exports,"applyPatch",(function(){return l}));var r=s("1A7En"),a=r.PatchError,i=(r._deepClone,{add:function(e,t,n){return e[t]=this.value,{newDocument:n}},remove:function(e,t,n){var r=e[t];return delete e[t],{newDocument:n,removed:r}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:function(e,t,n){var a=u(n,this.path);a&&(a=r._deepClone(a));var i=c(n,{op:"remove",path:this.from}).removed;return c(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:a}},copy:function(e,t,n){var a=u(n,this.from);return c(n,{op:"add",path:this.path,value:r._deepClone(a)}),{newDocument:n}},test:function(e,t,n){return{newDocument:n,test:d(e[t],this.value)}},_get:function(e,t,n){return this.value=e[t],{newDocument:n}}}),o={add:function(e,t,n){return r.isInteger(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:n,index:t}},remove:function(e,t,n){return{newDocument:n,removed:e.splice(t,1)[0]}},replace:function(e,t,n){var r=e[t];return e[t]=this.value,{newDocument:n,removed:r}},move:i.move,copy:i.copy,test:i.test,_get:i._get};function u(e,t){if(""==t)return e;var n={op:"_get",path:t};return c(e,n),n.value}function c(e,t,n,s,c,l){if(void 0===n&&(n=!1),void 0===s&&(s=!0),void 0===c&&(c=!0),void 0===l&&(l=0),n&&("function"==typeof n?n(t,0,e,t.path):f(t,0)),""===t.path){var p={newDocument:e};if("add"===t.op)return p.newDocument=t.value,p;if("replace"===t.op)return p.newDocument=t.value,p.removed=e,p;if("move"===t.op||"copy"===t.op)return p.newDocument=u(e,t.from),"move"===t.op&&(p.removed=e),p;if("test"===t.op){if(p.test=d(e,t.value),!1===p.test)throw new a("Test operation failed","TEST_OPERATION_FAILED",l,t,e);return p.newDocument=e,p}if("remove"===t.op)return p.removed=e,p.newDocument=null,p;if("_get"===t.op)return t.value=e,p;if(n)throw new a("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",l,t,e);return p}s||(e=r._deepClone(e));var h=(t.path||"").split("/"),v=e,g=1,m=h.length,y=void 0,x=void 0,b=void 0;for(b="function"==typeof n?n:f;;){if((x=h[g])&&-1!=x.indexOf("~")&&(x=r.unescapePathComponent(x)),c&&("__proto__"==x||"prototype"==x&&g>0&&"constructor"==h[g-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===y&&(void 0===v[x]?y=h.slice(0,g).join("/"):g==m-1&&(y=t.path),void 0!==y&&b(t,0,e,y)),g++,Array.isArray(v)){if("-"===x)x=v.length;else{if(n&&!r.isInteger(x))throw new a("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",l,t,e);r.isInteger(x)&&(x=~~x)}if(g>=m){if(n&&"add"===t.op&&x>v.length)throw new a("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",l,t,e);if(!1===(p=o[t.op].call(t,v,x,e)).test)throw new a("Test operation failed","TEST_OPERATION_FAILED",l,t,e);return p}}else if(g>=m){if(!1===(p=i[t.op].call(t,v,x,e)).test)throw new a("Test operation failed","TEST_OPERATION_FAILED",l,t,e);return p}if(v=v[x],n&&g<m&&(!v||"object"!=typeof v))throw new a("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",l,t,e)}}function l(e,t,n,i,o){if(void 0===i&&(i=!0),void 0===o&&(o=!0),n&&!Array.isArray(t))throw new a("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");i||(e=r._deepClone(e));for(var u=new Array(t.length),s=0,l=t.length;s<l;s++)u[s]=c(e,t[s],n,!0,o,s),e=u[s].newDocument;return u.newDocument=e,u}function f(e,t,n,o){if("object"!=typeof e||null===e||Array.isArray(e))throw new a("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,n);if(!i[e.op])throw new a("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,n);if("string"!=typeof e.path)throw new a("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,n);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new a('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,n);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new a("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new a("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,n);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&r.hasUndefined(e.value))throw new a("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,n);if(n)if("add"==e.op){var u=e.path.split("/").length,s=o.split("/").length;if(u!==s+1&&u!==s)throw new a("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,n)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==o)throw new a("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,n)}else if("move"===e.op||"copy"===e.op){var c=function(e,t,n){try{if(!Array.isArray(e))throw new a("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)l(r._deepClone(t),r._deepClone(e),n||!0);else{n=n||f;for(var i=0;i<e.length;i++)n(e[i],i,t,void 0)}}catch(e){if(e instanceof a)return e;throw e}}([{op:"_get",path:e.from,value:void 0}],n);if(c&&"OPERATION_PATH_UNRESOLVABLE"===c.name)throw new a("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,n)}}function d(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var n,r,a,i=Array.isArray(e),o=Array.isArray(t);if(i&&o){if((r=e.length)!=t.length)return!1;for(n=r;0!=n--;)if(!d(e[n],t[n]))return!1;return!0}if(i!=o)return!1;var u=Object.keys(e);if((r=u.length)!==Object.keys(t).length)return!1;for(n=r;0!=n--;)if(!t.hasOwnProperty(u[n]))return!1;for(n=r;0!=n--;)if(!d(e[a=u[n]],t[a]))return!1;return!0}return e!=e&&t!=t}})),s.register("1A7En",(function(e,t){n(e.exports,"hasOwnProperty",(function(){return u}),(function(e){return u=e})),n(e.exports,"_objectKeys",(function(){return c}),(function(e){return c=e})),n(e.exports,"_deepClone",(function(){return l}),(function(e){return l=e})),n(e.exports,"isInteger",(function(){return f}),(function(e){return f=e})),n(e.exports,"escapePathComponent",(function(){return d}),(function(e){return d=e})),n(e.exports,"unescapePathComponent",(function(){return p}),(function(e){return p=e})),n(e.exports,"hasUndefined",(function(){return h}),(function(e){return h=e})),n(e.exports,"PatchError",(function(){return g}),(function(e){return g=e})),s("1i51P");var r,a=s("5lcaY"),i=(r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=Object.prototype.hasOwnProperty;
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */function u(e,t){return o.call(e,t)}function c(e){if(Array.isArray(e)){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=""+n;return t}if(Object.keys)return Object.keys(e);var r=[];for(var a in e)u(e,a)&&r.push(a);return r}function l(e){switch(void 0===e?"undefined":a.default(e)){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function f(e){for(var t,n=0,r=e.length;n<r;){if(!((t=e.charCodeAt(n))>=48&&t<=57))return!1;n++}return!0}function d(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function p(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function h(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,n=e.length;t<n;t++)if(h(e[t]))return!0}else if("object"==typeof e)for(var r=c(e),a=r.length,i=0;i<a;i++)if(h(e[r[i]]))return!0;return!1}function v(e,t){var n=[e];for(var r in t){var a="object"==typeof t[r]?JSON.stringify(t[r],null,2):t[r];void 0!==a&&n.push(r+": "+a)}return n.join("\n")}var g=function(e){function t(t,n,r,a,i){var o=this.constructor,u=e.call(this,v(t,{name:n,index:r,operation:a,tree:i}))||this;return u.name=n,u.index=r,u.operation=a,u.tree=i,Object.setPrototypeOf(u,o.prototype),u.message=v(t,{name:n,index:r,operation:a,tree:i}),u}return i(t,e),t}(Error)})),s.register("jDlz8",(function(e,t){s("1A7En"),s("lq2em"),new WeakMap})),s.register("4qDAZ",(function(e,t){"use strict";var n=/("(?:[^\\"]|\\.)*")|[:,]/g;e.exports=function(e,t){var r,a,i;return t=t||{},r=JSON.stringify([1],void 0,void 0===t.indent?2:t.indent).slice(2,-3),a=""===r?1/0:void 0===t.maxLength?80:t.maxLength,i=t.replacer,function e(t,o,u){var s,c,l,f,d,p,h,v,g,m,y,x;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0===(y=JSON.stringify(t,i)))return y;if(h=a-o.length-u,y.length<=h&&(g=y.replace(n,(function(e,t){return t||e+" "}))).length<=h)return g;if(null!=i&&(t=JSON.parse(y),i=void 0),"object"==typeof t&&null!==t){if(v=o+r,l=[],c=0,Array.isArray(t))for(m="[",s="]",h=t.length;c<h;c++)l.push(e(t[c],v,c===h-1?0:1)||"null");else for(m="{",s="}",h=(p=Object.keys(t)).length;c<h;c++)f=p[c],d=JSON.stringify(f)+": ",void 0!==(x=e(t[f],v,d.length+(c===h-1?0:1)))&&l.push(d+x);if(l.length>0)return[m,r+l.join(",\n"+v),s].join("\n"+o)}return y}(e,"",0)}})),s.register("aT3RN",(function(e,t){var n=s("fIoYG");e.exports={re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:s("04SC4").SEMVER_SPEC_VERSION,SemVer:s("5XLlG"),compareIdentifiers:s("anchO").compareIdentifiers,rcompareIdentifiers:s("anchO").rcompareIdentifiers,parse:s("gXH2p"),valid:s("6IN3t"),clean:s("5W1hN"),inc:s("e9Qzx"),diff:s("i1XZS"),major:s("1I1NR"),minor:s("eQ46Y"),patch:s("ikdqK"),prerelease:s("idANB"),compare:s("1Jzy6"),rcompare:s("ePbAX"),compareLoose:s("6Lo7c"),compareBuild:s("gceNf"),sort:s("caxXC"),rsort:s("5HzME"),gt:s("6htvr"),lt:s("hzfVN"),eq:s("BxDGi"),neq:s("4hSPJ"),gte:s("80Uc6"),lte:s("endht"),cmp:s("dU7KT"),coerce:s("3Z2w9"),Comparator:s("jbQwC"),Range:s("1jjlb"),satisfies:s("dprLK"),toComparators:s("cQMJZ"),maxSatisfying:s("1imVF"),minSatisfying:s("hRNHe"),minVersion:s("A9All"),validRange:s("kcsXW"),outside:s("4PBcE"),gtr:s("c8Qmz"),ltr:s("lnepd"),intersects:s("c4Ogw"),simplifyRange:s("gxyvh"),subset:s("TFEG1")}})),s.register("fIoYG",(function(e,t){var n=s("04SC4").MAX_SAFE_COMPONENT_LENGTH,r=s("ewvSg"),a=(t=e.exports={}).re=[],i=t.src=[],o=t.t={},u=0,c=function(e,t,n){var s=u++;r(e,s,t),o[e]=s,i[s]=t,a[s]=new RegExp(t,n?"g":void 0)};c("NUMERICIDENTIFIER","0|[1-9]\\d*"),c("NUMERICIDENTIFIERLOOSE","[0-9]+"),c("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),c("MAINVERSION","(".concat(i[o.NUMERICIDENTIFIER],")\\.")+"(".concat(i[o.NUMERICIDENTIFIER],")\\.")+"(".concat(i[o.NUMERICIDENTIFIER],")")),c("MAINVERSIONLOOSE","(".concat(i[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(i[o.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(i[o.NUMERICIDENTIFIERLOOSE],")")),c("PRERELEASEIDENTIFIER","(?:".concat(i[o.NUMERICIDENTIFIER],"|").concat(i[o.NONNUMERICIDENTIFIER],")")),c("PRERELEASEIDENTIFIERLOOSE","(?:".concat(i[o.NUMERICIDENTIFIERLOOSE],"|").concat(i[o.NONNUMERICIDENTIFIER],")")),c("PRERELEASE","(?:-(".concat(i[o.PRERELEASEIDENTIFIER],"(?:\\.").concat(i[o.PRERELEASEIDENTIFIER],")*))")),c("PRERELEASELOOSE","(?:-?(".concat(i[o.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(i[o.PRERELEASEIDENTIFIERLOOSE],")*))")),c("BUILDIDENTIFIER","[0-9A-Za-z-]+"),c("BUILD","(?:\\+(".concat(i[o.BUILDIDENTIFIER],"(?:\\.").concat(i[o.BUILDIDENTIFIER],")*))")),c("FULLPLAIN","v?".concat(i[o.MAINVERSION]).concat(i[o.PRERELEASE],"?").concat(i[o.BUILD],"?")),c("FULL","^".concat(i[o.FULLPLAIN],"$")),c("LOOSEPLAIN","[v=\\s]*".concat(i[o.MAINVERSIONLOOSE]).concat(i[o.PRERELEASELOOSE],"?").concat(i[o.BUILD],"?")),c("LOOSE","^".concat(i[o.LOOSEPLAIN],"$")),c("GTLT","((?:<|>)?=?)"),c("XRANGEIDENTIFIERLOOSE","".concat(i[o.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),c("XRANGEIDENTIFIER","".concat(i[o.NUMERICIDENTIFIER],"|x|X|\\*")),c("XRANGEPLAIN","[v=\\s]*(".concat(i[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(i[o.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(i[o.XRANGEIDENTIFIER],")")+"(?:".concat(i[o.PRERELEASE],")?").concat(i[o.BUILD],"?")+")?)?"),c("XRANGEPLAINLOOSE","[v=\\s]*(".concat(i[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(i[o.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(i[o.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(i[o.PRERELEASELOOSE],")?").concat(i[o.BUILD],"?")+")?)?"),c("XRANGE","^".concat(i[o.GTLT],"\\s*").concat(i[o.XRANGEPLAIN],"$")),c("XRANGELOOSE","^".concat(i[o.GTLT],"\\s*").concat(i[o.XRANGEPLAINLOOSE],"$")),c("COERCE","(^|[^\\d])(\\d{1,".concat(n,"})")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:\\.(\\d{1,".concat(n,"}))?")+"(?:$|[^\\d])"),c("COERCERTL",i[o.COERCE],!0),c("LONETILDE","(?:~>?)"),c("TILDETRIM","(\\s*)".concat(i[o.LONETILDE],"\\s+"),!0),t.tildeTrimReplace="$1~",c("TILDE","^".concat(i[o.LONETILDE]).concat(i[o.XRANGEPLAIN],"$")),c("TILDELOOSE","^".concat(i[o.LONETILDE]).concat(i[o.XRANGEPLAINLOOSE],"$")),c("LONECARET","(?:\\^)"),c("CARETTRIM","(\\s*)".concat(i[o.LONECARET],"\\s+"),!0),t.caretTrimReplace="$1^",c("CARET","^".concat(i[o.LONECARET]).concat(i[o.XRANGEPLAIN],"$")),c("CARETLOOSE","^".concat(i[o.LONECARET]).concat(i[o.XRANGEPLAINLOOSE],"$")),c("COMPARATORLOOSE","^".concat(i[o.GTLT],"\\s*(").concat(i[o.LOOSEPLAIN],")$|^$")),c("COMPARATOR","^".concat(i[o.GTLT],"\\s*(").concat(i[o.FULLPLAIN],")$|^$")),c("COMPARATORTRIM","(\\s*)".concat(i[o.GTLT],"\\s*(").concat(i[o.LOOSEPLAIN],"|").concat(i[o.XRANGEPLAIN],")"),!0),t.comparatorTrimReplace="$1$2$3",c("HYPHENRANGE","^\\s*(".concat(i[o.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(i[o.XRANGEPLAIN],")")+"\\s*$"),c("HYPHENRANGELOOSE","^\\s*(".concat(i[o.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(i[o.XRANGEPLAINLOOSE],")")+"\\s*$"),c("STAR","(<|>)?=?\\s*\\*"),c("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),c("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})),s.register("04SC4",(function(e,t){var n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:n,MAX_SAFE_COMPONENT_LENGTH:16}})),s.register("ewvSg",(function(e,t){var n=s("dJYM3"),r=("object"==typeof n&&n.env,function(){});e.exports=r})),s.register("5XLlG",(function(e,t){s("1i51P");var n=s("3QOYJ"),r=s("2tuUj"),a=s("ewvSg"),i=s("04SC4"),o=i.MAX_LENGTH,u=i.MAX_SAFE_INTEGER,c=s("fIoYG"),l=c.re,f=c.t,d=s("iG2iD"),p=s("anchO").compareIdentifiers,h=function(){"use strict";function e(t,r){if(n.default(this,e),r=d(r),t instanceof e){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if("string"!=typeof t)throw new TypeError("Invalid Version: ".concat(t));if(t.length>o)throw new TypeError("version is longer than ".concat(o," characters"));a("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;var i=t.trim().match(r.loose?l[f.LOOSE]:l[f.FULL]);if(!i)throw new TypeError("Invalid Version: ".concat(t));if(this.raw=t,this.major=+i[1],this.minor=+i[2],this.patch=+i[3],this.major>u||this.major<0)throw new TypeError("Invalid major version");if(this.minor>u||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>u||this.patch<0)throw new TypeError("Invalid patch version");i[4]?this.prerelease=i[4].split(".").map((function(e){if(/^[0-9]+$/.test(e)){var t=+e;if(t>=0&&t<u)return t}return e})):this.prerelease=[],this.build=i[5]?i[5].split("."):[],this.format()}return r.default(e,[{key:"format",value:function(){return this.version="".concat(this.major,".").concat(this.minor,".").concat(this.patch),this.prerelease.length&&(this.version+="-".concat(this.prerelease.join("."))),this.version}},{key:"toString",value:function(){return this.version}},{key:"compare",value:function(t){if(a("SemVer.compare",this.version,this.options,t),!(t instanceof e)){if("string"==typeof t&&t===this.version)return 0;t=new e(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}},{key:"compareMain",value:function(t){return t instanceof e||(t=new e(t,this.options)),p(this.major,t.major)||p(this.minor,t.minor)||p(this.patch,t.patch)}},{key:"comparePre",value:function(t){if(t instanceof e||(t=new e(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var n=0;do{var r=this.prerelease[n],i=t.prerelease[n];if(a("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return p(r,i)}while(++n)}},{key:"compareBuild",value:function(t){t instanceof e||(t=new e(t,this.options));var n=0;do{var r=this.build[n],i=t.build[n];if(a("prerelease compare",n,r,i),void 0===r&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===r)return-1;if(r!==i)return p(r,i)}while(++n)}},{key:"inc",value:function(e,t){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t),this.inc("pre",t);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t),this.inc("pre",t);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":if(0===this.prerelease.length)this.prerelease=[0];else{for(var n=this.prerelease.length;--n>=0;)"number"==typeof this.prerelease[n]&&(this.prerelease[n]++,n=-2);-1===n&&this.prerelease.push(0)}t&&(0===p(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=[t,0]):this.prerelease=[t,0]);break;default:throw new Error("invalid increment argument: ".concat(e))}return this.format(),this.raw=this.version,this}}]),e}();e.exports=h})),s.register("iG2iD",(function(e,t){var n=["includePrerelease","loose","rtl"];e.exports=function(e){return e?"object"!=typeof e?{loose:!0}:n.filter((function(t){return e[t]})).reduce((function(e,t){return e[t]=!0,e}),{}):{}}})),s.register("anchO",(function(e,t){var n=/^[0-9]+$/,r=function(e,t){var r=n.test(e),a=n.test(t);return r&&a&&(e=+e,t=+t),e===t?0:r&&!a?-1:a&&!r?1:e<t?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:function(e,t){return r(t,e)}}})),s.register("gXH2p",(function(e,t){var n=s("04SC4").MAX_LENGTH,r=s("fIoYG"),a=r.re,i=r.t,o=s("5XLlG"),u=s("iG2iD");e.exports=function(e,t){if(t=u(t),e instanceof o)return e;if("string"!=typeof e)return null;if(e.length>n)return null;if(!(t.loose?a[i.LOOSE]:a[i.FULL]).test(e))return null;try{return new o(e,t)}catch(e){return null}}})),s.register("6IN3t",(function(e,t){var n=s("gXH2p");e.exports=function(e,t){var r=n(e,t);return r?r.version:null}})),s.register("5W1hN",(function(e,t){var n=s("gXH2p");e.exports=function(e,t){var r=n(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null}})),s.register("e9Qzx",(function(e,t){var n=s("5XLlG");e.exports=function(e,t,r,a){"string"==typeof r&&(a=r,r=void 0);try{return new n(e instanceof n?e.version:e,r).inc(t,a).version}catch(e){return null}}})),s.register("i1XZS",(function(e,t){var n=s("gXH2p"),r=s("BxDGi");e.exports=function(e,t){if(r(e,t))return null;var a=n(e),i=n(t),o=a.prerelease.length||i.prerelease.length,u=o?"pre":"",s=o?"prerelease":"";for(var c in a)if(("major"===c||"minor"===c||"patch"===c)&&a[c]!==i[c])return u+c;return s}})),s.register("BxDGi",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return 0===n(e,t,r)}})),s.register("1Jzy6",(function(e,t){var n=s("5XLlG");e.exports=function(e,t,r){return new n(e,r).compare(new n(t,r))}})),s.register("1I1NR",(function(e,t){var n=s("5XLlG");e.exports=function(e,t){return new n(e,t).major}})),s.register("eQ46Y",(function(e,t){var n=s("5XLlG");e.exports=function(e,t){return new n(e,t).minor}})),s.register("ikdqK",(function(e,t){var n=s("5XLlG");e.exports=function(e,t){return new n(e,t).patch}})),s.register("idANB",(function(e,t){var n=s("gXH2p");e.exports=function(e,t){var r=n(e,t);return r&&r.prerelease.length?r.prerelease:null}})),s.register("ePbAX",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return n(t,e,r)}})),s.register("6Lo7c",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t){return n(e,t,!0)}})),s.register("gceNf",(function(e,t){var n=s("5XLlG");e.exports=function(e,t,r){var a=new n(e,r),i=new n(t,r);return a.compare(i)||a.compareBuild(i)}})),s.register("caxXC",(function(e,t){var n=s("gceNf");e.exports=function(e,t){return e.sort((function(e,r){return n(e,r,t)}))}})),s.register("5HzME",(function(e,t){var n=s("gceNf");e.exports=function(e,t){return e.sort((function(e,r){return n(r,e,t)}))}})),s.register("6htvr",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return n(e,t,r)>0}})),s.register("hzfVN",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return n(e,t,r)<0}})),s.register("4hSPJ",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return 0!==n(e,t,r)}})),s.register("80Uc6",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return n(e,t,r)>=0}})),s.register("endht",(function(e,t){var n=s("1Jzy6");e.exports=function(e,t,r){return n(e,t,r)<=0}})),s.register("dU7KT",(function(e,t){var n=s("BxDGi"),r=s("4hSPJ"),a=s("6htvr"),i=s("80Uc6"),o=s("hzfVN"),u=s("endht");e.exports=function(e,t,s,c){switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e===s;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof s&&(s=s.version),e!==s;case"":case"=":case"==":return n(e,s,c);case"!=":return r(e,s,c);case">":return a(e,s,c);case">=":return i(e,s,c);case"<":return o(e,s,c);case"<=":return u(e,s,c);default:throw new TypeError("Invalid operator: ".concat(t))}}})),s.register("3Z2w9",(function(e,t){var n=s("5XLlG"),r=s("gXH2p"),a=s("fIoYG"),i=a.re,o=a.t;e.exports=function(e,t){if(e instanceof n)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;var a=null;if((t=t||{}).rtl){for(var u;(u=i[o.COERCERTL].exec(e))&&(!a||a.index+a[0].length!==e.length);)a&&u.index+u[0].length===a.index+a[0].length||(a=u),i[o.COERCERTL].lastIndex=u.index+u[1].length+u[2].length;i[o.COERCERTL].lastIndex=-1}else a=e.match(i[o.COERCE]);return null===a?null:r("".concat(a[2],".").concat(a[3]||"0",".").concat(a[4]||"0"),t)}})),s.register("jbQwC",(function(e,t){s("1i51P");var n=s("3QOYJ"),r=s("2tuUj"),a=Symbol("SemVer ANY"),i=function(){"use strict";function e(t,r){if(n.default(this,e),r=o(r),t instanceof e){if(t.loose===!!r.loose)return t;t=t.value}d("comparator",t,r),this.options=r,this.loose=!!r.loose,this.parse(t),this.semver===a?this.value="":this.value=this.operator+this.semver.version,d("comp",this)}return r.default(e,[{key:"parse",value:function(e){var t=this.options.loose?c[l.COMPARATORLOOSE]:c[l.COMPARATOR],n=e.match(t);if(!n)throw new TypeError("Invalid comparator: ".concat(e));this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new p(n[2],this.options.loose):this.semver=a}},{key:"toString",value:function(){return this.value}},{key:"test",value:function(e){if(d("Comparator.test",e,this.options.loose),this.semver===a||e===a)return!0;if("string"==typeof e)try{e=new p(e,this.options)}catch(e){return!1}return f(e,this.operator,this.semver,this.options)}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Comparator is required");if(n&&"object"==typeof n||(n={loose:!!n,includePrerelease:!1}),""===this.operator)return""===this.value||new h(t.value,n).test(this.value);if(""===t.operator)return""===t.value||new h(this.value,n).test(t.semver);var r=!(">="!==this.operator&&">"!==this.operator||">="!==t.operator&&">"!==t.operator),a=!("<="!==this.operator&&"<"!==this.operator||"<="!==t.operator&&"<"!==t.operator),i=this.semver.version===t.semver.version,o=!(">="!==this.operator&&"<="!==this.operator||">="!==t.operator&&"<="!==t.operator),u=f(this.semver,"<",t.semver,n)&&(">="===this.operator||">"===this.operator)&&("<="===t.operator||"<"===t.operator),s=f(this.semver,">",t.semver,n)&&("<="===this.operator||"<"===this.operator)&&(">="===t.operator||">"===t.operator);return r||a||i&&o||u||s}}],[{key:"ANY",get:function(){return a}}]),e}();e.exports=i;var o=s("iG2iD"),u=s("fIoYG"),c=u.re,l=u.t,f=s("dU7KT"),d=s("ewvSg"),p=s("5XLlG"),h=s("1jjlb")})),s.register("1jjlb",(function(e,t){s("1i51P");var n=s("3QOYJ"),r=s("2tuUj"),a=s("9M1dW"),i=function(){"use strict";function e(t,r){var a=this;if(n.default(this,e),r=u(r),t instanceof e)return t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease?t:new e(t.raw,r);if(t instanceof c)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=t,this.set=t.split("||").map((function(e){return a.parseRange(e.trim())})).filter((function(e){return e.length})),!this.set.length)throw new TypeError("Invalid SemVer Range: ".concat(t));if(this.set.length>1){var i=this.set[0];if(this.set=this.set.filter((function(e){return!y(e[0])})),0===this.set.length)this.set=[i];else if(this.set.length>1){var o=!0,s=!1,l=void 0;try{for(var f,d=this.set[Symbol.iterator]();!(o=(f=d.next()).done);o=!0){var p=f.value;if(1===p.length&&x(p[0])){this.set=[p];break}}}catch(e){s=!0,l=e}finally{try{o||null==d.return||d.return()}finally{if(s)throw l}}}}this.format()}return r.default(e,[{key:"format",value:function(){return this.range=this.set.map((function(e){return e.join(" ").trim()})).join("||").trim(),this.range}},{key:"toString",value:function(){return this.range}},{key:"parseRange",value:function(e){var t=this;e=e.trim();var n=Object.keys(this.options).join(","),r="parseRange:".concat(n,":").concat(e),i=o.get(r);if(i)return i;var u=this.options.loose,s=u?p[h.HYPHENRANGELOOSE]:p[h.HYPHENRANGE];e=e.replace(s,O(this.options.includePrerelease)),l("hyphen replace",e),e=e.replace(p[h.COMPARATORTRIM],v),l("comparator trim",e);var f=(e=(e=(e=e.replace(p[h.TILDETRIM],g)).replace(p[h.CARETTRIM],m)).split(/\s+/).join(" ")).split(" ").map((function(e){return k(e,t.options)})).join(" ").split(/\s+/).map((function(e){return F(e,t.options)}));u&&(f=f.filter((function(e){return l("loose invalid filter",e,t.options),!!e.match(p[h.COMPARATORLOOSE])}))),l("range list",f);var d=new Map,x=f.map((function(e){return new c(e,t.options)})),b=!0,w=!1,A=void 0;try{for(var E,C=x[Symbol.iterator]();!(b=(E=C.next()).done);b=!0){var S=E.value;if(y(S))return[S];d.set(S.value,S)}}catch(e){w=!0,A=e}finally{try{b||null==C.return||C.return()}finally{if(w)throw A}}d.size>1&&d.has("")&&d.delete("");var N=a.default(d.values());return o.set(r,N),N}},{key:"intersects",value:function(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((function(e){return b(e,n)&&t.set.some((function(t){return b(t,n)&&e.every((function(e){return t.every((function(t){return e.intersects(t,n)}))}))}))}))}},{key:"test",value:function(e){if(!e)return!1;if("string"==typeof e)try{e=new f(e,this.options)}catch(e){return!1}for(var t=0;t<this.set.length;t++)if(_(this.set[t],e,this.options))return!0;return!1}}]),e}();e.exports=i;var o=new(s("6YYtw"))({max:1e3}),u=s("iG2iD"),c=s("jbQwC"),l=s("ewvSg"),f=s("5XLlG"),d=s("fIoYG"),p=d.re,h=d.t,v=d.comparatorTrimReplace,g=d.tildeTrimReplace,m=d.caretTrimReplace,y=function(e){return"<0.0.0-0"===e.value},x=function(e){return""===e.value},b=function(e,t){for(var n=!0,r=e.slice(),a=r.pop();n&&r.length;)n=r.every((function(e){return a.intersects(e,t)})),a=r.pop();return n},k=function(e,t){return l("comp",e,t),e=C(e,t),l("caret",e),e=A(e,t),l("tildes",e),e=N(e,t),l("xrange",e),e=D(e,t),l("stars",e),e},w=function(e){return!e||"x"===e.toLowerCase()||"*"===e},A=function(e,t){return e.trim().split(/\s+/).map((function(e){return E(e,t)})).join(" ")},E=function(e,t){var n=t.loose?p[h.TILDELOOSE]:p[h.TILDE];return e.replace(n,(function(t,n,r,a,i){var o;return l("tilde",e,t,n,r,a,i),w(n)?o="":w(r)?o=">=".concat(n,".0.0 <").concat(+n+1,".0.0-0"):w(a)?o=">=".concat(n,".").concat(r,".0 <").concat(n,".").concat(+r+1,".0-0"):i?(l("replaceTilde pr",i),o=">=".concat(n,".").concat(r,".").concat(a,"-").concat(i," <").concat(n,".").concat(+r+1,".0-0")):o=">=".concat(n,".").concat(r,".").concat(a," <").concat(n,".").concat(+r+1,".0-0"),l("tilde return",o),o}))},C=function(e,t){return e.trim().split(/\s+/).map((function(e){return S(e,t)})).join(" ")},S=function(e,t){l("caret",e,t);var n=t.loose?p[h.CARETLOOSE]:p[h.CARET],r=t.includePrerelease?"-0":"";return e.replace(n,(function(t,n,a,i,o){var u;return l("caret",e,t,n,a,i,o),w(n)?u="":w(a)?u=">=".concat(n,".0.0").concat(r," <").concat(+n+1,".0.0-0"):w(i)?u="0"===n?">=".concat(n,".").concat(a,".0").concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".0").concat(r," <").concat(+n+1,".0.0-0"):o?(l("replaceCaret pr",o),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i,"-").concat(o," <").concat(+n+1,".0.0-0")):(l("no pr"),u="0"===n?"0"===a?">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(a,".").concat(+i+1,"-0"):">=".concat(n,".").concat(a,".").concat(i).concat(r," <").concat(n,".").concat(+a+1,".0-0"):">=".concat(n,".").concat(a,".").concat(i," <").concat(+n+1,".0.0-0")),l("caret return",u),u}))},N=function(e,t){return l("replaceXRanges",e,t),e.split(/\s+/).map((function(e){return T(e,t)})).join(" ")},T=function(e,t){e=e.trim();var n=t.loose?p[h.XRANGELOOSE]:p[h.XRANGE];return e.replace(n,(function(n,r,a,i,o,u){l("xRange",e,n,r,a,i,o,u);var s=w(a),c=s||w(i),f=c||w(o),d=f;return"="===r&&d&&(r=""),u=t.includePrerelease?"-0":"",s?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&d?(c&&(i=0),o=0,">"===r?(r=">=",c?(a=+a+1,i=0,o=0):(i=+i+1,o=0)):"<="===r&&(r="<",c?a=+a+1:i=+i+1),"<"===r&&(u="-0"),n="".concat(r+a,".").concat(i,".").concat(o).concat(u)):c?n=">=".concat(a,".0.0").concat(u," <").concat(+a+1,".0.0-0"):f&&(n=">=".concat(a,".").concat(i,".0").concat(u," <").concat(a,".").concat(+i+1,".0-0")),l("xRange return",n),n}))},D=function(e,t){return l("replaceStars",e,t),e.trim().replace(p[h.STAR],"")},F=function(e,t){return l("replaceGTE0",e,t),e.trim().replace(p[t.includePrerelease?h.GTE0PRE:h.GTE0],"")},O=function(e){return function(t,n,r,a,i,o,u,s,c,l,f,d,p){return n=w(r)?"":w(a)?">=".concat(r,".0.0").concat(e?"-0":""):w(i)?">=".concat(r,".").concat(a,".0").concat(e?"-0":""):o?">=".concat(n):">=".concat(n).concat(e?"-0":""),s=w(c)?"":w(l)?"<".concat(+c+1,".0.0-0"):w(f)?"<".concat(c,".").concat(+l+1,".0-0"):d?"<=".concat(c,".").concat(l,".").concat(f,"-").concat(d):e?"<".concat(c,".").concat(l,".").concat(+f+1,"-0"):"<=".concat(s),"".concat(n," ").concat(s).trim()}},_=function(e,t,n){for(var r=0;r<e.length;r++)if(!e[r].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(var a=0;a<e.length;a++)if(l(e[a].semver),e[a].semver!==c.ANY&&e[a].semver.prerelease.length>0){var i=e[a].semver;if(i.major===t.major&&i.minor===t.minor&&i.patch===t.patch)return!0}return!1}return!0}})),s.register("6YYtw",(function(e,t){s("1i51P");var n=s("3QOYJ"),r=s("2tuUj"),a=s("2sCeK"),i=Symbol("max"),o=Symbol("length"),u=Symbol("lengthCalculator"),c=Symbol("allowStale"),l=Symbol("maxAge"),f=Symbol("dispose"),d=Symbol("noDisposeOnSet"),p=Symbol("lruList"),h=Symbol("cache"),v=Symbol("updateAgeOnGet"),g=function(){return 1},m=function(){function e(t){if(n.default(this,e),"number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[i]=t.max||1/0;var r=t.length||g;if(this[u]="function"!=typeof r?g:r,this[c]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[l]=t.maxAge||0,this[f]=t.dispose,this[d]=t.noDisposeOnSet||!1,this[v]=t.updateAgeOnGet||!1,this.reset()}return r.default(e,[{key:"max",get:function(){return this[i]},set:function(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,b(this)}},{key:"allowStale",get:function(){return this[c]},set:function(e){this[c]=!!e}},{key:"maxAge",get:function(){return this[l]},set:function(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,b(this)}},{key:"lengthCalculator",get:function(){return this[u]},set:function(e){if("function"!=typeof e&&(e=g),e!==this[u]){var t=this;this[u]=e,this[o]=0,this[p].forEach((function(e){e.length=t[u](e.value,e.key),t[o]+=e.length}))}b(this)}},{key:"length",get:function(){return this[o]}},{key:"itemCount",get:function(){return this[p].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var n=this[p].tail;null!==n;){var r=n.prev;A(this,e,n,t),n=r}}},{key:"forEach",value:function(e,t){t=t||this;for(var n=this[p].head;null!==n;){var r=n.next;A(this,e,n,t),n=r}}},{key:"keys",value:function(){return this[p].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[p].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[f]&&this[p]&&this[p].length&&this[p].forEach((function(t){return e[f](t.key,t.value)})),this[h]=new Map,this[p]=new a,this[o]=0}},{key:"dump",value:function(){var e=this;return this[p].map((function(t){return!x(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[p]}},{key:"set",value:function(e,t,n){if((n=n||this[l])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");var r=n?Date.now():0,a=this[u](t,e);if(this[h].has(e)){if(a>this[i])return k(this,this[h].get(e)),!1;var s=this[h].get(e).value;return this[f]&&(this[d]||this[f](e,s.value)),s.now=r,s.maxAge=n,s.value=t,this[o]+=a-s.length,s.length=a,this.get(e),b(this),!0}var c=new w(e,t,a,r,n);return c.length>this[i]?(this[f]&&this[f](e,t),!1):(this[o]+=c.length,this[p].unshift(c),this[h].set(e,this[p].head),b(this),!0)}},{key:"has",value:function(e){if(!this[h].has(e))return!1;var t=this[h].get(e).value;return!x(this,t)}},{key:"get",value:function(e){return y(this,e,!0)}},{key:"peek",value:function(e){return y(this,e,!1)}},{key:"pop",value:function(){var e=this[p].tail;return e?(k(this,e),e.value):null}},{key:"del",value:function(e){k(this,this[h].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),n=e.length-1;n>=0;n--){var r=e[n],a=r.e||0;if(0===a)this.set(r.k,r.v);else{var i=a-t;i>0&&this.set(r.k,r.v,i)}}}},{key:"prune",value:function(){var e=this;this[h].forEach((function(t,n){return y(e,n,!1)}))}}]),e}(),y=function(e,t,n){var r=e[h].get(t);if(r){var a=r.value;if(x(e,a)){if(k(e,r),!e[c])return}else n&&(e[v]&&(r.value.now=Date.now()),e[p].unshiftNode(r));return a.value}},x=function(e,t){if(!t||!t.maxAge&&!e[l])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},b=function(e){if(e[o]>e[i])for(var t=e[p].tail;e[o]>e[i]&&null!==t;){var n=t.prev;k(e,t),t=n}},k=function(e,t){if(t){var n=t.value;e[f]&&e[f](n.key,n.value),e[o]-=n.length,e[h].delete(n.key),e[p].removeNode(t)}},w=function e(t,r,a,i,o){n.default(this,e),this.key=t,this.value=r,this.length=a,this.now=i,this.maxAge=o||0},A=function(e,t,n,r){var a=n.value;x(e,a)&&(k(e,n),e[c]||(a=void 0)),a&&t.call(r,a.value,a.key,e)};e.exports=m})),s.register("2sCeK",(function(e,t){"use strict";function n(e){var t=this;if(t instanceof n||(t=new n),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var r=0,a=arguments.length;r<a;r++)t.push(arguments[r]);return t}function r(e,t,n){var r=t===e.head?new o(n,null,t,e):new o(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function a(e,t){e.tail=new o(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function i(e,t){e.head=new o(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function o(e,t,n,r){if(!(this instanceof o))return new o(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=n,n.Node=o,n.create=n,n.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},n.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},n.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},n.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)a(this,arguments[e]);return this.length},n.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)i(this,arguments[e]);return this.length},n.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},n.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},n.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},n.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},n.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},n.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},n.prototype.map=function(e,t){t=t||this;for(var r=new n,a=this.head;null!==a;)r.push(e.call(t,a.value,this)),a=a.next;return r},n.prototype.mapReverse=function(e,t){t=t||this;for(var r=new n,a=this.tail;null!==a;)r.push(e.call(t,a.value,this)),a=a.prev;return r},n.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var a=0;null!==r;a++)n=e(n,r.value,a),r=r.next;return n},n.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var a=this.length-1;null!==r;a--)n=e(n,r.value,a),r=r.prev;return n},n.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},n.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},n.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=0,i=this.head;null!==i&&a<e;a++)i=i.next;for(;null!==i&&a<t;a++,i=i.next)r.push(i.value);return r},n.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var r=new n;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var a=this.length,i=this.tail;null!==i&&a>t;a--)i=i.prev;for(;null!==i&&a>e;a--,i=i.prev)r.push(i.value);return r},n.prototype.splice=function(e,t){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var o=0,u=this.head;null!==u&&o<e;o++)u=u.next;var s=[];for(o=0;u&&o<t;o++)s.push(u.value),u=this.removeNode(u);null===u&&(u=this.tail),u!==this.head&&u!==this.tail&&(u=u.prev);for(o=0;o<a.length;o++)u=r(this,u,a[o]);return s},n.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{s("hS0Vb")(n)}catch(e){}})),s.register("hS0Vb",(function(e,n){var r=s("40Zzs");e.exports=function(e){e.prototype[Symbol.iterator]=t(r).mark((function e(){var n;return t(r).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.head;case 1:if(!n){e.next=7;break}return e.next=4,n.value;case 4:n=n.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}})),s.register("dprLK",(function(e,t){var n=s("1jjlb");e.exports=function(e,t,r){try{t=new n(t,r)}catch(e){return!1}return t.test(e)}})),s.register("cQMJZ",(function(e,t){var n=s("1jjlb");e.exports=function(e,t){return new n(e,t).set.map((function(e){return e.map((function(e){return e.value})).join(" ").trim().split(" ")}))}})),s.register("1imVF",(function(e,t){var n=s("5XLlG"),r=s("1jjlb");e.exports=function(e,t,a){var i=null,o=null,u=null;try{u=new r(t,a)}catch(e){return null}return e.forEach((function(e){u.test(e)&&(i&&-1!==o.compare(e)||(o=new n(i=e,a)))})),i}})),s.register("hRNHe",(function(e,t){var n=s("5XLlG"),r=s("1jjlb");e.exports=function(e,t,a){var i=null,o=null,u=null;try{u=new r(t,a)}catch(e){return null}return e.forEach((function(e){u.test(e)&&(i&&1!==o.compare(e)||(o=new n(i=e,a)))})),i}})),s.register("A9All",(function(e,t){var n=s("5XLlG"),r=s("1jjlb"),a=s("6htvr");e.exports=function(e,t){e=new r(e,t);var i=new n("0.0.0");if(e.test(i))return i;if(i=new n("0.0.0-0"),e.test(i))return i;i=null;for(var o=0;o<e.set.length;++o){var u=e.set[o],s=null;u.forEach((function(e){var t=new n(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!a(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: ".concat(e.operator))}})),!s||i&&!a(i,s)||(i=s)}return i&&e.test(i)?i:null}})),s.register("kcsXW",(function(e,t){var n=s("1jjlb");e.exports=function(e,t){try{return new n(e,t).range||"*"}catch(e){return null}}})),s.register("4PBcE",(function(e,t){var n=s("5XLlG"),r=s("jbQwC"),a=r.ANY,i=s("1jjlb"),o=s("dprLK"),u=s("6htvr"),c=s("hzfVN"),l=s("endht"),f=s("80Uc6");e.exports=function(e,t,s,d){var p,h,v,g,m;switch(e=new n(e,d),t=new i(t,d),s){case">":p=u,h=l,v=c,g=">",m=">=";break;case"<":p=c,h=f,v=u,g="<",m="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,d))return!1;for(var y=0;y<t.set.length;++y){var x=t.set[y],b=null,k=null;if(x.forEach((function(e){e.semver===a&&(e=new r(">=0.0.0")),b=b||e,k=k||e,p(e.semver,b.semver,d)?b=e:v(e.semver,k.semver,d)&&(k=e)})),b.operator===g||b.operator===m)return!1;if((!k.operator||k.operator===g)&&h(e,k.semver))return!1;if(k.operator===m&&v(e,k.semver))return!1}return!0}})),s.register("c8Qmz",(function(e,t){var n=s("4PBcE");e.exports=function(e,t,r){return n(e,t,">",r)}})),s.register("lnepd",(function(e,t){var n=s("4PBcE");e.exports=function(e,t,r){return n(e,t,"<",r)}})),s.register("c4Ogw",(function(e,t){var n=s("1jjlb");e.exports=function(e,t,r){return e=new n(e,r),t=new n(t,r),e.intersects(t)}})),s.register("gxyvh",(function(e,t){s("1i51P");var n=s("6vecG"),r=s("dprLK"),a=s("1Jzy6");e.exports=function(e,t,i){var o=[],u=null,s=null,c=e.sort((function(e,t){return a(e,t,i)})),l=!0,f=!1,d=void 0;try{for(var p,h=c[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;r(v,t,i)?(s=v,u||(u=v)):(s&&o.push([u,s]),s=null,u=null)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}u&&o.push([u,null]);var g=[],m=!0,y=!1,x=void 0;try{for(var b,k=o[Symbol.iterator]();!(m=(b=k.next()).done);m=!0){var w=n.default(b.value,2),A=w[0],E=w[1];A===E?g.push(A):E||A!==c[0]?E?A===c[0]?g.push("<=".concat(E)):g.push("".concat(A," - ").concat(E)):g.push(">=".concat(A)):g.push("*")}}catch(e){y=!0,x=e}finally{try{m||null==k.return||k.return()}finally{if(y)throw x}}var C=g.join(" || "),S="string"==typeof t.raw?t.raw:String(t);return C.length<S.length?C:t}})),s.register("TFEG1",(function(e,t){var n=s("1jjlb"),r=s("jbQwC"),a=r.ANY,i=s("dprLK"),o=s("1Jzy6"),u=function(e,t,n){if(e===t)return!0;if(1===e.length&&e[0].semver===a){if(1===t.length&&t[0].semver===a)return!0;e=n.includePrerelease?[new r(">=0.0.0-0")]:[new r(">=0.0.0")]}if(1===t.length&&t[0].semver===a){if(n.includePrerelease)return!0;t=[new r(">=0.0.0")]}var u,s,f,d=new Set,p=!0,h=!1,v=void 0;try{for(var g,m=e[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=g.value;">"===y.operator||">="===y.operator?u=c(u,y,n):"<"===y.operator||"<="===y.operator?s=l(s,y,n):d.add(y.semver)}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}if(d.size>1)return null;if(u&&s){if((f=o(u.semver,s.semver,n))>0)return null;if(0===f&&(">="!==u.operator||"<="!==s.operator))return null}var x,b,k,w,A=!0,E=!1,C=void 0;try{for(var S,N=d[Symbol.iterator]();!(A=(S=N.next()).done);A=!0){var T=S.value;if(u&&!i(T,String(u),n))return null;if(s&&!i(T,String(s),n))return null;var D=!0,F=!1,O=void 0;try{for(var _,I=t[Symbol.iterator]();!(D=(_=I.next()).done);D=!0){var R=_.value;if(!i(T,String(R),n))return!1}}catch(e){F=!0,O=e}finally{try{D||null==I.return||I.return()}finally{if(F)throw O}}return!0}}catch(e){E=!0,C=e}finally{try{A||null==N.return||N.return()}finally{if(E)throw C}}var M=!(!s||n.includePrerelease||!s.semver.prerelease.length)&&s.semver,B=!(!u||n.includePrerelease||!u.semver.prerelease.length)&&u.semver;M&&1===M.prerelease.length&&"<"===s.operator&&0===M.prerelease[0]&&(M=!1);var P=!0,L=!1,j=void 0;try{for(var z,U=t[Symbol.iterator]();!(P=(z=U.next()).done);P=!0){var V=z.value;if(w=w||">"===V.operator||">="===V.operator,k=k||"<"===V.operator||"<="===V.operator,u)if(B&&V.semver.prerelease&&V.semver.prerelease.length&&V.semver.major===B.major&&V.semver.minor===B.minor&&V.semver.patch===B.patch&&(B=!1),">"===V.operator||">="===V.operator){if((x=c(u,V,n))===V&&x!==u)return!1}else if(">="===u.operator&&!i(u.semver,String(V),n))return!1;if(s)if(M&&V.semver.prerelease&&V.semver.prerelease.length&&V.semver.major===M.major&&V.semver.minor===M.minor&&V.semver.patch===M.patch&&(M=!1),"<"===V.operator||"<="===V.operator){if((b=l(s,V,n))===V&&b!==s)return!1}else if("<="===s.operator&&!i(s.semver,String(V),n))return!1;if(!V.operator&&(s||u)&&0!==f)return!1}}catch(e){L=!0,j=e}finally{try{P||null==U.return||U.return()}finally{if(L)throw j}}return!(u&&k&&!s&&0!==f)&&(!(s&&w&&!u&&0!==f)&&(!B&&!M))},c=function(e,t,n){if(!e)return t;var r=o(e.semver,t.semver,n);return r>0?e:r<0||">"===t.operator&&">="===e.operator?t:e},l=function(e,t,n){if(!e)return t;var r=o(e.semver,t.semver,n);return r<0?e:r>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;e=new n(e,r),t=new n(t,r);var a=!1,i=!0,o=!1,s=void 0;try{e:for(var c,l=e.set[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value,d=!0,p=!1,h=void 0;try{for(var v,g=t.set[Symbol.iterator]();!(d=(v=g.next()).done);d=!0){var m=v.value,y=u(f,m,r);if(a=a||null!==y,y)continue e}}catch(e){p=!0,h=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw h}}if(a)return!1}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}return!0}})),s.register("eBb9L",(function(t,r){n(t.exports,"version",(function(){return A})),n(t.exports,"Dataflow",(function(){return s("euljU").Dataflow})),n(t.exports,"EventStream",(function(){return s("euljU").EventStream})),n(t.exports,"MultiPulse",(function(){return s("euljU").MultiPulse})),n(t.exports,"Operator",(function(){return s("euljU").Operator})),n(t.exports,"Parameters",(function(){return s("euljU").Parameters})),n(t.exports,"Pulse",(function(){return s("euljU").Pulse})),n(t.exports,"Transform",(function(){return s("euljU").Transform})),n(t.exports,"changeset",(function(){return s("euljU").changeset})),n(t.exports,"definition",(function(){return s("euljU").definition})),n(t.exports,"ingest",(function(){return s("euljU").ingest})),n(t.exports,"isTuple",(function(){return s("euljU").isTuple})),n(t.exports,"transform",(function(){return s("euljU").transform})),n(t.exports,"transforms",(function(){return s("euljU").transforms})),n(t.exports,"tupleid",(function(){return s("euljU").tupleid})),n(t.exports,"interpolate",(function(){return s("ilkKT").interpolate})),n(t.exports,"interpolateColors",(function(){return s("ilkKT").interpolateColors})),n(t.exports,"interpolateRange",(function(){return s("ilkKT").interpolateRange})),n(t.exports,"quantizeInterpolator",(function(){return s("ilkKT").quantizeInterpolator})),n(t.exports,"scale",(function(){return s("ilkKT").scale})),n(t.exports,"scheme",(function(){return s("ilkKT").scheme})),n(t.exports,"projection",(function(){return s("d0DSv").projection})),n(t.exports,"View",(function(){return s("8Li02").View})),n(t.exports,"defaultLocale",(function(){return s("7aVEe").defaultLocale})),n(t.exports,"formatLocale",(function(){return s("7aVEe").numberFormatDefaultLocale})),n(t.exports,"locale",(function(){return s("7aVEe").locale})),n(t.exports,"resetDefaultLocale",(function(){return s("7aVEe").resetDefaultLocale})),n(t.exports,"timeFormatLocale",(function(){return s("7aVEe").timeFormatDefaultLocale})),n(t.exports,"expressionFunction",(function(){return s("7ZKwa").expressionFunction})),n(t.exports,"parse",(function(){return s("be3FW").parse})),n(t.exports,"runtimeContext",(function(){return s("gziXg").context})),n(t.exports,"codegenExpression",(function(){return s("gvNfD").codegen})),n(t.exports,"parseExpression",(function(){return s("gvNfD").parse})),n(t.exports,"parseSelector",(function(){return s("A0mT6").selector}));var a=s("caNzv"),i=s("euljU"),o=s("1OL6m"),u=s("fhCNY"),c=s("31JGW"),l=s("iBn57"),f=s("k5dJ4"),d=s("6QlYq"),p=s("8HbfX"),h=s("l9F60"),v=s("lRAno"),g=s("lF15u"),m=s("2cOQf"),y=(a=s("caNzv"),i=s("euljU"),s("3okBY")),x=s("2U08m"),b=s("mn9nW"),k=s("aVGvL"),w=(s("ilkKT"),s("d0DSv"),s("8Li02"),s("7aVEe"),s("7ZKwa"),s("be3FW"),s("gziXg"),s("gvNfD"),s("A0mT6"),"5.20.0");a.extend(i.transforms,o,u,c,l,f,p,d,h,v,g,m);var A=w;e(t.exports,a),e(t.exports,y),e(t.exports,x),e(t.exports,b),e(t.exports,k)})),s.register("caNzv",(function(e,t){function r(e,t,n){return e.fields=t||[],e.fname=n,e}function a(e){return null==e?null:e.fname}function i(e){return null==e?null:e.fields}function o(e){return 1===e.length?u(e[0]):s(e)}n(e.exports,"accessor",(function(){return r})),n(e.exports,"accessorName",(function(){return a})),n(e.exports,"accessorFields",(function(){return i})),n(e.exports,"field",(function(){return f})),n(e.exports,"error",(function(){return c})),n(e.exports,"splitAccessPath",(function(){return l})),n(e.exports,"id",(function(){return d})),n(e.exports,"identity",(function(){return p})),n(e.exports,"zero",(function(){return h})),n(e.exports,"one",(function(){return v})),n(e.exports,"truthy",(function(){return g})),n(e.exports,"falsy",(function(){return m})),n(e.exports,"None",(function(){return x})),n(e.exports,"Error",(function(){return b})),n(e.exports,"Warn",(function(){return k})),n(e.exports,"Info",(function(){return w})),n(e.exports,"Debug",(function(){return A})),n(e.exports,"logger",(function(){return E})),n(e.exports,"isArray",(function(){return C})),n(e.exports,"isObject",(function(){return S})),n(e.exports,"key",(function(){return we})),n(e.exports,"mergeConfig",(function(){return T})),n(e.exports,"writeConfig",(function(){return D})),n(e.exports,"peek",(function(){return O})),n(e.exports,"array",(function(){return Y})),n(e.exports,"toNumber",(function(){return _})),n(e.exports,"panLinear",(function(){return j})),n(e.exports,"panLog",(function(){return z})),n(e.exports,"panPow",(function(){return U})),n(e.exports,"panSymlog",(function(){return V})),n(e.exports,"constant",(function(){return ae})),n(e.exports,"zoomLinear",(function(){return G})),n(e.exports,"zoomLog",(function(){return H})),n(e.exports,"zoomPow",(function(){return q})),n(e.exports,"zoomSymlog",(function(){return J})),n(e.exports,"quarter",(function(){return K})),n(e.exports,"utcquarter",(function(){return X})),n(e.exports,"clampRange",(function(){return Q})),n(e.exports,"span",(function(){return Te})),n(e.exports,"isFunction",(function(){return Z})),n(e.exports,"compare",(function(){return $})),n(e.exports,"ascending",(function(){return ee})),n(e.exports,"debounce",(function(){return ie})),n(e.exports,"extend",(function(){return oe})),n(e.exports,"extent",(function(){return ue})),n(e.exports,"extentIndex",(function(){return se})),n(e.exports,"hasOwnProperty",(function(){return le})),n(e.exports,"fastmap",(function(){return de})),n(e.exports,"flush",(function(){return pe})),n(e.exports,"inherits",(function(){return he})),n(e.exports,"inrange",(function(){return ve})),n(e.exports,"isBoolean",(function(){return ge})),n(e.exports,"isDate",(function(){return me})),n(e.exports,"isIterable",(function(){return ye})),n(e.exports,"isNumber",(function(){return xe})),n(e.exports,"isRegExp",(function(){return be})),n(e.exports,"isString",(function(){return ke})),n(e.exports,"lerp",(function(){return Ae})),n(e.exports,"lruCache",(function(){return Ee})),n(e.exports,"merge",(function(){return Ce})),n(e.exports,"repeat",(function(){return Se})),n(e.exports,"pad",(function(){return Ne})),n(e.exports,"stringValue",(function(){return De})),n(e.exports,"toBoolean",(function(){return Fe})),n(e.exports,"toDate",(function(){return _e})),n(e.exports,"toString",(function(){return Ie})),n(e.exports,"toSet",(function(){return Re})),n(e.exports,"truncate",(function(){return Me})),n(e.exports,"visitArray",(function(){return Be}));var u=function(e){return function(t){return t[e]}},s=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function c(e){throw Error(e)}function l(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function l(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)l(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&l(),u=t=n+1):"]"===r&&(u||c("Access path missing open bracket: "+e),u>0&&l(),u=0,t=n+1):n>t?l():t=n+1}return u&&c("Access path missing closing bracket: "+e),o&&c("Access path missing closing quote: "+e),n>t&&(n++,l()),a}function f(e,t,n){var a=l(e);return e=1===a.length?a[0]:e,r((n&&n.get||o)(a),[e],t||e)}var d=f("id"),p=r((function(e){return e}),[],"identity"),h=r((function(){return 0}),[],"zero"),v=r((function(){return 1}),[],"one"),g=r((function(){return!0}),[],"true"),m=r((function(){return!1}),[],"false");function y(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}var x=0,b=1,k=2,w=3,A=4;function E(e,t){var n=e||x;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=b&&y(t||"error","ERROR",arguments),this},warn:function(){return n>=k&&y(t||"warn","WARN",arguments),this},info:function(){return n>=w&&y(t||"log","INFO",arguments),this},debug:function(){return n>=A&&y(t||"log","DEBUG",arguments),this}}}var C=Array.isArray;function S(e){return e===Object(e)}var N=function(e){return"__proto__"!==e};function T(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=F(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;D(e,n,t[n],r)}return e}),{})}function D(e,t,n,r){var a,i;if(N(t))if(S(n)&&!C(n))for(a in i=S(e[t])?e[t]:e[t]={},n)r&&(!0===r||r[a])?D(i,a,n[a]):N(a)&&(i[a]=n[a]);else e[t]=n}function F(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}function O(e){return e[e.length-1]}function _(e){return null==e||""===e?null:+e}var I=function(e){return function(t){return e*Math.exp(t)}},R=function(e){return function(t){return Math.log(e*t)}},M=function(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}},B=function(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}},P=function(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}};function L(e,t,n,r){var a=n(e[0]),i=n(O(e)),o=(i-a)*t;return[r(a-o),r(i-o)]}function j(e,t){return L(e,t,_,p)}function z(e,t){var n=Math.sign(e[0]);return L(e,t,R(n),I(n))}function U(e,t,n){return L(e,t,P(n),P(1/n))}function V(e,t,n){return L(e,t,M(n),B(n))}function W(e,t,n,r,a){var i=r(e[0]),o=r(O(e)),u=null!=t?r(t):(i+o)/2;return[a(u+(i-u)*n),a(u+(o-u)*n)]}function G(e,t,n){return W(e,t,n,_,p)}function H(e,t,n){var r=Math.sign(e[0]);return W(e,t,n,R(r),I(r))}function q(e,t,n,r){return W(e,t,n,P(r),P(1/r))}function J(e,t,n,r){return W(e,t,n,M(r),B(r))}function K(e){return 1+~~(new Date(e).getMonth()/3)}function X(e){return 1+~~(new Date(e).getUTCMonth()/3)}function Y(e){return null!=e?C(e)?e:[e]:[]}function Q(e,t,n){var r,a=e[0],i=e[1];return i<a&&(r=i,i=a,a=r),(r=i-a)>=n-t?[t,n]:[a=Math.min(Math.max(a,t),n-r),a+r]}function Z(e){return"function"==typeof e}function $(e,t,n){n=n||{},t=Y(t)||[];var a=[],o=[],u={},s=n.comparator||te;return Y(e).forEach((function(e,r){null!=e&&(a.push("descending"===t[r]?-1:1),o.push(e=Z(e)?e:f(e,null,n)),(i(e)||[]).forEach((function(e){return u[e]=1})))})),0===o.length?null:r(s(o,a),Object.keys(u))}var ee=function(e,t){return(e<t||null==e)&&null!=t?-1:(e>t||null==t)&&null!=e?1:(t=t instanceof Date?+t:t,(e=e instanceof Date?+e:e)!==e&&t==t?-1:t!=t&&e==e?1:0)},te=function(e,t){return 1===e.length?ne(e[0],t[0]):re(e,t,e.length)},ne=function(e,t){return function(n,r){return ee(e(n),e(r))*t}},re=function(e,t,n){return t.push(0),function(r,a){for(var i,o=0,u=-1;0===o&&++u<n;)i=e[u],o=ee(i(r),i(a));return o*t[u]}};function ae(e){return Z(e)?e:function(){return e}}function ie(e,t){var n;return function(r){n&&clearTimeout(n),n=setTimeout((function(){return t(r),n=null}),e)}}function oe(e){for(var t,n,r=1,a=arguments.length;r<a;++r)for(n in t=arguments[r])e[n]=t[n];return e}function ue(e,t){var n,r,a,i,o=0;if(e&&(n=e.length))if(null==t){for(r=e[o];o<n&&(null==r||r!=r);r=e[++o]);for(a=i=r;o<n;++o)null!=(r=e[o])&&(r<a&&(a=r),r>i&&(i=r))}else{for(r=t(e[o]);o<n&&(null==r||r!=r);r=t(e[++o]));for(a=i=r;o<n;++o)null!=(r=t(e[o]))&&(r<a&&(a=r),r>i&&(i=r))}return[a,i]}function se(e,t){var n,r,a,i,o,u=e.length,s=-1;if(null==t){for(;++s<u;)if(null!=(r=e[s])&&r>=r){n=a=r;break}if(s===u)return[-1,-1];for(i=o=s;++s<u;)null!=(r=e[s])&&(n>r&&(n=r,i=s),a<r&&(a=r,o=s))}else{for(;++s<u;)if(null!=(r=t(e[s],s,e))&&r>=r){n=a=r;break}if(s===u)return[-1,-1];for(i=o=s;++s<u;)null!=(r=t(e[s],s,e))&&(n>r&&(n=r,i=s),a<r&&(a=r,o=s))}return[i,o]}var ce=Object.prototype.hasOwnProperty;function le(e,t){return ce.call(e,t)}var fe={};function de(e){var t,n={};function r(e){return le(n,e)&&n[e]!==fe}var a={size:0,empty:0,object:n,has:r,get:function(e){return r(e)?n[e]:void 0},set:function(e,t){return r(e)||(++a.size,n[e]===fe&&--a.empty),n[e]=t,this},delete:function(e){return r(e)&&(--a.size,++a.empty,n[e]=fe),this},clear:function(){a.size=a.empty=0,a.object=n={}},test:function(e){return arguments.length?(t=e,a):t},clean:function(){var e={},r=0;for(var i in n){var o=n[i];o===fe||t&&t(o)||(e[i]=o,++r)}a.size=r,a.empty=0,a.object=n=e}};return e&&Object.keys(e).forEach((function(t){a.set(t,e[t])})),a}function pe(e,t,n,r,a,i){if(!n&&0!==n)return i;var o,u=+n,s=e[0],c=O(e);c<s&&(o=s,s=c,c=o),o=Math.abs(t-s);var l=Math.abs(c-t);return o<l&&o<=u?r:l<=u?a:i}function he(e,t,n){var r=e.prototype=Object.create(t.prototype);return Object.defineProperty(r,"constructor",{value:e,writable:!0,enumerable:!0,configurable:!0}),oe(r,n)}function ve(e,t,n,r){var a,i=t[0],o=t[t.length-1];return i>o&&(a=i,i=o,o=a),r=void 0===r||r,((n=void 0===n||n)?i<=e:i<e)&&(r?e<=o:e<o)}function ge(e){return"boolean"==typeof e}function me(e){return"[object Date]"===Object.prototype.toString.call(e)}function ye(e){return e&&Z(e[Symbol.iterator])}function xe(e){return"number"==typeof e}function be(e){return"[object RegExp]"===Object.prototype.toString.call(e)}function ke(e){return"string"==typeof e}function we(e,t,n){e&&(e=t?Y(e).map((function(e){return e.replace(/\\(.)/g,"$1")})):Y(e));var a,i=e&&e.length,u=n&&n.get||o,s=function(e){return u(t?[e]:l(e))};if(i)if(1===i){var c=s(e[0]);a=function(e){return""+c(e)}}else{var f=e.map(s);a=function(e){for(var t=""+f[0](e),n=0;++n<i;)t+="|"+f[n](e);return t}}else a=function(){return""};return r(a,e,"key")}function Ae(e,t){var n=e[0],r=O(e),a=+t;return a?1===a?r:n+a*(r-n):n}function Ee(e){var t,n,r;e=+e||1e4;var a=function(){t={},n={},r=0},i=function(a,i){return++r>e&&(n=t,t={},r=1),t[a]=i};return a(),{clear:a,has:function(e){return le(t,e)||le(n,e)},get:function(e){return le(t,e)?t[e]:le(n,e)?i(e,n[e]):void 0},set:function(e,n){return le(t,e)?t[e]=n:i(e,n)}}}function Ce(e,t,n,r){var a=t.length,i=n.length;if(!i)return t;if(!a)return n;for(var o=r||new t.constructor(a+i),u=0,s=0,c=0;u<a&&s<i;++c)o[c]=e(t[u],n[s])>0?n[s++]:t[u++];for(;u<a;++u,++c)o[c]=t[u];for(;s<i;++s,++c)o[c]=n[s];return o}function Se(e,t){for(var n="";--t>=0;)n+=e;return n}function Ne(e,t,n,r){var a=n||" ",i=e+"",o=t-i.length;return o<=0?i:"left"===r?Se(a,o)+i:"center"===r?Se(a,~~(o/2))+i+Se(a,Math.ceil(o/2)):i+Se(a,o)}function Te(e){return e&&O(e)-e[0]||0}function De(e){return C(e)?"["+e.map(De)+"]":S(e)||ke(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function Fe(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e)&&!!e}var Oe=function(e){return xe(e)||me(e)?e:Date.parse(e)};function _e(e,t){return t=t||Oe,null==e||""===e?null:t(e)}function Ie(e){return null==e||""===e?null:e+""}function Re(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}function Me(e,t,n,r){var a=null!=r?r:"",i=e+"",o=i.length,u=Math.max(0,t-a.length);return o<=t?i:"left"===n?a+i.slice(o-u):"center"===n?i.slice(0,Math.ceil(u/2))+a+i.slice(o-~~(u/2)):i.slice(0,u)+a}function Be(e,t,n){if(e)if(t)for(var r=e.length,a=0;a<r;++a){var i=t(e[a]);i&&n(i,a,e)}else e.forEach(n)}})),s.register("euljU",(function(e,r){n(e.exports,"asyncCallback",(function(){return f})),n(e.exports,"isTuple",(function(){return v})),n(e.exports,"tupleid",(function(){return g})),n(e.exports,"ingest",(function(){return y})),n(e.exports,"derive",(function(){return x})),n(e.exports,"rederive",(function(){return b})),n(e.exports,"replace",(function(){return k})),n(e.exports,"stableCompare",(function(){return w})),n(e.exports,"isChangeSet",(function(){return A})),n(e.exports,"changeset",(function(){return E})),n(e.exports,"Parameters",(function(){return S})),n(e.exports,"Operator",(function(){return D})),n(e.exports,"EventStream",(function(){return _})),n(e.exports,"Pulse",(function(){return U})),n(e.exports,"MultiPulse",(function(){return H})),n(e.exports,"Dataflow",(function(){return Z})),n(e.exports,"Transform",(function(){return ee})),n(e.exports,"transforms",(function(){return te})),n(e.exports,"definition",(function(){return ne})),n(e.exports,"transform",(function(){return re})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("caNzv"),u=s("mn9nW"),c=s("7aVEe");function l(e){var t=e||o.identity,n=[],r={};return n.add=function(e){var a=t(e);return r[a]||(r[a]=1,n.push(e)),n},n.remove=function(e){var a=t(e);if(r[a]){r[a]=0;var i=n.indexOf(e);i>=0&&n.splice(i,1)}return n},n}function f(e,t){return d.apply(this,arguments)}function d(){return(d=a.default(t(i).mark((function e(n,r){return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r(n);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),n.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}var p=Symbol("vega_id"),h=1;function v(e){return!(!e||!g(e))}function g(e){return e[p]}function m(e,t){return e[p]=t,e}function y(e){var t=e===Object(e)?e:{data:e};return g(t)?t:m(t,h++)}function x(e){return b(e,y({}))}function b(e,t){for(var n in e)t[n]=e[n];return t}function k(e,t){return m(t,g(e))}function w(e,t){return e?t?function(n,r){return e(n,r)||g(t(n))-g(t(r))}:function(t,n){return e(t,n)||g(t)-g(n)}:null}function A(e){return e&&e.constructor===E}function E(){var e=[],t=[],n=[],r=[],a=[],i=null,u=!1;return{constructor:E,insert:function(t){for(var n=o.array(t),r=n.length,a=0;a<r;++a)e.push(n[a]);return this},remove:function(e){for(var n=o.isFunction(e)?r:t,a=o.array(e),i=a.length,u=0;u<i;++u)n.push(a[u]);return this},modify:function(e,t,r){var i={field:t,value:o.constant(r)};return o.isFunction(e)?(i.filter=e,a.push(i)):(i.tuple=e,n.push(i)),this},encode:function(e,t){return o.isFunction(e)?a.push({filter:e,field:t}):n.push({tuple:e,field:t}),this},clean:function(e){return i=e,this},reflow:function(){return u=!0,this},pulse:function(o,s){var c,l,f,d,p,h,v={},m={};for(c=0,l=s.length;c<l;++c)v[g(s[c])]=1;for(c=0,l=t.length;c<l;++c)v[g(p=t[c])]=-1;for(c=0,l=r.length;c<l;++c)d=r[c],s.forEach((function(e){d(e)&&(v[g(e)]=-1)}));for(c=0,l=e.length;c<l;++c)h=g(p=e[c]),v[h]?v[h]=1:o.add.push(y(e[c]));for(c=0,l=s.length;c<l;++c)p=s[c],v[g(p)]<0&&o.rem.push(p);function x(e,t,n){n?e[t]=n(e):o.encode=t,u||(m[g(e)]=e)}for(c=0,l=n.length;c<l;++c)p=(f=n[c]).tuple,d=f.field,(h=v[g(p)])>0&&(x(p,d,f.value),o.modifies(d));for(c=0,l=a.length;c<l;++c)f=a[c],d=f.filter,s.forEach((function(e){d(e)&&v[g(e)]>0&&x(e,f.field,f.value)})),o.modifies(f.field);if(u)o.mod=t.length||r.length?s.filter((function(e){return v[g(e)]>0})):s.slice();else for(h in m)o.mod.push(m[h]);return(i||null==i&&(t.length||r.length))&&o.clean(!0),o}}}var C="_:mod:_";function S(){Object.defineProperty(this,C,{writable:!0,value:{}})}S.prototype={set:function(e,t,n,r){var a=this,i=a[e],u=a["_:mod:_"];return null!=t&&t>=0?(i[t]!==n||r)&&(i[t]=n,u[t+":"+e]=-1,u[e]=-1):(i!==n||r)&&(a[e]=n,u[e]=o.isArray(n)?1+n.length:-1),a},modified:function(e,t){var n=this["_:mod:_"];if(!arguments.length){for(var r in n)if(n[r])return!0;return!1}if(o.isArray(e)){for(var a=0;a<e.length;++a)if(n[e[a]])return!0;return!1}return null!=t&&t>=0?t+1<n[e]||!!n[t+":"+e]:!!n[e]},clear:function(){return this["_:mod:_"]={},this}};var N=0,T=new S;function D(e,t,n,r){this.id=++N,this.value=e,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,t&&(this._update=t),n&&this.parameters(n,r)}function F(e){return function(t){var n=this.flags;return 0===arguments.length?!!(n&e):(this.flags=t?n|e:n&~e,this)}}D.prototype={targets:function(){return this._targets||(this._targets=l(o.id))},set:function(e){return this.value!==e?(this.value=e,1):0},skip:F(1),modified:F(2),parameters:function(e,t,n){var r=this;t=!1!==t;var a,i,u,s,c=this._argval=this._argval||new S,l=this._argops=this._argops||[],f=[],d=function(e,n,a){a instanceof D?(a!==r&&(t&&a.targets().add(r),f.push(a)),l.push({op:a,name:e,index:n})):c.set(e,n,a)};for(a in e)if(i=e[a],"pulse"===a){var p=this;o.array(i).forEach((function(e){e instanceof D?e!==p&&(e.targets().add(p),f.push(e)):o.error("Pulse parameters must be operator instances.")})),this.source=i}else if(o.isArray(i))for(c.set(a,-1,Array(u=i.length)),s=0;s<u;++s)d(a,s,i[s]);else d(a,-1,i);return this.marshall().clear(),n&&(l.initonly=!0),f},marshall:function(e){var t,n,r,a,i=this._argval||T,o=this._argops;if(o){var u=o.length;for(n=0;n<u;++n)a=(r=(t=o[n]).op).modified()&&r.stamp===e,i.set(t.name,t.index,r.value,a);if(o.initonly){for(n=0;n<u;++n)(t=o[n]).op.targets().remove(this);this._argops=null,this._update=null}}return i},detach:function(){var e,t,n,r=this._argops;if(r)for(e=0,t=r.length;e<t;++e)(n=r[e].op)._targets&&n._targets.remove(this);this.pulse=null,this.source=null},evaluate:function(e){var t=this._update;if(t){var n=this.marshall(e.stamp),r=t.call(this,n,e);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return e.StopPropagation}},run:function(e){return e.stamp<this.stamp?e.StopPropagation:(this.skip()?(this.skip(!1),t=0):t=this.evaluate(e),this.pulse=t||e);var t}};var O=0;function _(e,t,n){this.id=++O,this.value=null,n&&(this.receive=n),e&&(this._filter=e),t&&(this._apply=t)}function I(e,t,n){return new _(e,t,n)}function R(){return R=a.default(t(i).mark((function e(n,r){var a,o,s;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this,o=0,e.prev=2,e.next=5,a.loader().load(n,{context:"dataflow",response:u.responseType(r&&r.type)});case 5:s=e.sent;try{s=a.parse(s,r)}catch(e){o=-2,a.warn("Data ingestion failed",n,e)}e.next=13;break;case 9:e.prev=9,e.t0=e.catch(2),o=-1,a.warn("Loading failed",n,e.t0);case 13:return e.abrupt("return",{data:s,status:o});case 14:case"end":return e.stop()}}),e,this,[[2,9]])}))),R.apply(this,arguments)}function M(){return M=a.default(t(i).mark((function e(n,r,a){var u,s,c;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(s=(u=this)._pending||B(u)).requests+=1,e.next=4,u.request(r,a);case 4:return c=e.sent,u.pulse(n,u.changeset().remove(o.truthy).insert(c.data||[])),s.done(),e.abrupt("return",c);case 8:case"end":return e.stop()}}),e,this)}))),M.apply(this,arguments)}function B(e){var t,n=new Promise((function(e){return t=e}));return n.requests=0,n.done=function(){0==--n.requests&&(e._pending=null,t(e))},e._pending=n}_.prototype={_filter:o.truthy,_apply:o.identity,targets:function(){return this._targets||(this._targets=l(o.id))},consume:function(e){return arguments.length?(this._consume=!!e,this):!!this._consume},receive:function(e){if(this._filter(e)){for(var t=this.value=this._apply(e),n=this._targets,r=n?n.length:0,a=0;a<r;++a)n[a].receive(t);this._consume&&(e.preventDefault(),e.stopPropagation())}},filter:function(e){var t=I(e);return this.targets().add(t),t},apply:function(e){var t=I(null,e);return this.targets().add(t),t},merge:function(){var e=I();this.targets().add(e);for(var t=0,n=arguments.length;t<n;++t)arguments[t].targets().add(e);return e},throttle:function(e){var t=-1;return this.filter((function(){var n=Date.now();return n-t>e?(t=n,1):0}))},debounce:function(e){var t=I();return this.targets().add(I(null,null,o.debounce(e,(function(e){var n=e.dataflow;t.receive(e),n&&n.run&&n.run()})))),t},between:function(e,t){var n=!1;return e.targets().add(I(null,null,(function(){return n=!0}))),t.targets().add(I(null,null,(function(){return n=!1}))),this.filter((function(){return n}))},detach:function(){this._filter=o.truthy,this._targets=null}};var P={skip:!0};function L(e,t,n,r,a,i){var u,s,c=o.extend({},i,P);o.isFunction(n)||(n=o.constant(n)),void 0===r?u=function(t){return e.touch(n(t))}:o.isFunction(r)?(s=new D(null,r,a,!1),u=function(t){s.evaluate(t);var r=n(t),a=s.value;A(a)?e.pulse(r,a,i):e.update(r,a,c)}):u=function(t){return e.update(n(t),r,c)},t.apply(u)}function j(e,t,n,r,a,i){if(void 0===r)t.targets().add(n);else{var u=i||{},s=new D(null,function(e,t){return t=o.isFunction(t)?t:o.constant(t),e?function(n,r){var a=t(n,r);return e.skip()||(e.skip(a!==this.value).value=a),a}:t}(n,r),a,!1);s.modified(u.force),s.rank=t.rank,t.targets().add(s),n&&(s.skip(!0),s.value=n.value,s.targets().add(n),e.connect(n,[s]))}}var z={};function U(e,t,n){this.dataflow=e,this.stamp=null==t?-1:t,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function V(e,t){var n=[];return o.visitArray(e,t,(function(e){return n.push(e)})),n}function W(e,t){var n={};return e.visit(t,(function(e){n[g(e)]=1})),function(e){return n[g(e)]?null:e}}function G(e,t){return e?function(n,r){return e(n,r)&&t(n,r)}:t}function H(e,t,n,r){var a=this,i=n.length,o=0;this.dataflow=e,this.stamp=t,this.fields=null,this.encode=r||null,this.pulses=n;for(var u=0;u<i;++u){var s=n[u];if(s.stamp===t){if(s.fields){var c=a.fields||(a.fields={});for(var l in s.fields)c[l]=1}s.changed(a.ADD)&&(o|=a.ADD),s.changed(a.REM)&&(o|=a.REM),s.changed(a.MOD)&&(o|=a.MOD)}}this.changes=o}function q(){return(q=a.default(t(i).mark((function e(n,r,a){var u,s,c,d,p,h,v,g,m;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],!(u=this)._pulse){e.next=3;break}return e.abrupt("return",K(u));case 3:if(!u._pending){e.next=6;break}return e.next=6,u._pending;case 6:if(!r){e.next=9;break}return e.next=9,f(u,r);case 9:if(u._touched.length){e.next=12;break}return u.debug("Dataflow invoked, but nothing to do."),e.abrupt("return",u);case 12:c=++u._clock,u._pulse=new U(u,c,n),u._touched.forEach((function(e){return u._enqueue(e,!0)})),u._touched=l(o.id),d=0,e.prev=17;case 18:if(!(u._heap.size()>0)){e.next=35;break}if((p=u._heap.pop()).rank===p.qrank){e.next=23;break}return u._enqueue(p,!0),e.abrupt("continue",18);case 23:if(!(h=p.run(u._getPulse(p,n))).then){e.next=30;break}return e.next=27,h;case 27:h=e.sent,e.next=31;break;case 30:h.async&&(s.push(h.async),h=z);case 31:h!==z&&p._targets&&p._targets.forEach((function(e){return u._enqueue(e)})),++d,e.next=18;break;case 35:e.next=41;break;case 37:e.prev=37,e.t0=e.catch(17),u._heap.clear(),v=e.t0;case 41:if(u._input={},u._pulse=null,u.debug("Pulse ".concat(c,": ").concat(d," operators")),v&&(u._postrun=[],u.error(v)),!u._postrun.length){e.next=55;break}g=u._postrun.sort((function(e,t){return t.priority-e.priority})),u._postrun=[],m=0;case 49:if(!(m<g.length)){e.next=55;break}return e.next=52,f(u,g[m].callback);case 52:++m,e.next=49;break;case 55:if(!a){e.next=58;break}return e.next=58,f(u,a);case 58:return s.length&&Promise.all(s).then((function(e){return u.runAsync(null,(function(){e.forEach((function(e){try{e(u)}catch(e){u.error(e)}}))}))})),e.abrupt("return",u);case 60:case"end":return e.stop()}}),e,this,[[17,37]])})))).apply(this,arguments)}function J(){return(J=a.default(t(i).mark((function e(n,r,a){var o,u;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=this;case 1:if(!this._running){e.next=6;break}return e.next=4,this._running;case 4:e.next=1;break;case 6:return u=function(){return o._running=null},(this._running=this.evaluate(n,r,a)).then(u,u),e.abrupt("return",this._running);case 9:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function K(e){return e.error("Dataflow already running. Use runAsync() to chain invocations."),e}U.prototype={StopPropagation:z,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork:function(e){return new U(this.dataflow).init(this,e)},clone:function(){var e=this.fork(7);return e.add=e.add.slice(),e.rem=e.rem.slice(),e.mod=e.mod.slice(),e.source&&(e.source=e.source.slice()),e.materialize(23)},addAll:function(){var e=this;return!e.source||e.add===e.rem||!e.rem.length&&e.source.length===e.add.length||((e=new U(this.dataflow).init(this)).add=e.source,e.rem=[]),e},init:function(e,t){var n=this;return n.stamp=e.stamp,n.encode=e.encode,!e.fields||64&t||(n.fields=e.fields),1&t?(n.addF=e.addF,n.add=e.add):(n.addF=null,n.add=[]),2&t?(n.remF=e.remF,n.rem=e.rem):(n.remF=null,n.rem=[]),4&t?(n.modF=e.modF,n.mod=e.mod):(n.modF=null,n.mod=[]),32&t?(n.srcF=null,n.source=null):(n.srcF=e.srcF,n.source=e.source,e.cleans&&(n.cleans=e.cleans)),n},runAfter:function(e){this.dataflow.runAfter(e)},changed:function(e){var t=e||7;return 1&t&&this.add.length||2&t&&this.rem.length||4&t&&this.mod.length},reflow:function(e){if(e)return this.fork(7).reflow();var t=this.add.length,n=this.source&&this.source.length;return n&&n!==t&&(this.mod=this.source,t&&this.filter(4,W(this,1))),this},clean:function(e){return arguments.length?(this.cleans=!!e,this):this.cleans},modifies:function(e){var t=this.fields||(this.fields={});return o.isArray(e)?e.forEach((function(e){return t[e]=!0})):t[e]=!0,this},modified:function(e,t){var n=this.fields;return!(!t&&!this.mod.length||!n)&&(arguments.length?o.isArray(e)?e.some((function(e){return n[e]})):n[e]:!!n)},filter:function(e,t){var n=this;return 1&e&&(n.addF=G(n.addF,t)),2&e&&(n.remF=G(n.remF,t)),4&e&&(n.modF=G(n.modF,t)),16&e&&(n.srcF=G(n.srcF,t)),n},materialize:function(e){var t=this;return 1&(e=e||7)&&t.addF&&(t.add=V(t.add,t.addF),t.addF=null),2&e&&t.remF&&(t.rem=V(t.rem,t.remF),t.remF=null),4&e&&t.modF&&(t.mod=V(t.mod,t.modF),t.modF=null),16&e&&t.srcF&&(t.source=t.source.filter(t.srcF),t.srcF=null),t},visit:function(e,t){var n=this,r=t;if(16&e)return o.visitArray(n.source,n.srcF,r),n;1&e&&o.visitArray(n.add,n.addF,r),2&e&&o.visitArray(n.rem,n.remF,r),4&e&&o.visitArray(n.mod,n.modF,r);var a=n.source;if(8&e&&a){var i=n.add.length+n.mod.length;i===a.length||(i?o.visitArray(a,W(n,5),r):o.visitArray(a,n.srcF,r))}return n}},o.inherits(H,U,{fork:function(e){var t=new U(this.dataflow).init(this,e&this.NO_FIELDS);return void 0!==e&&(e&t.ADD&&this.visit(t.ADD,(function(e){return t.add.push(e)})),e&t.REM&&this.visit(t.REM,(function(e){return t.rem.push(e)})),e&t.MOD&&this.visit(t.MOD,(function(e){return t.mod.push(e)}))),t},changed:function(e){return this.changes&e},modified:function(e){var t=this,n=t.fields;return n&&t.changes&t.MOD?o.isArray(e)?e.some((function(e){return n[e]})):n[e]:0},filter:function(){o.error("MultiPulse does not support filtering.")},materialize:function(){o.error("MultiPulse does not support materialization.")},visit:function(e,t){var n=this,r=n.pulses,a=r.length,i=0;if(e&n.SOURCE)for(;i<a;++i)r[i].visit(e,t);else for(;i<a;++i)r[i].stamp===n.stamp&&r[i].visit(e,t);return n}});var X={skip:!1,force:!1};function Y(e){var t=[];return{clear:function(){return t=[]},size:function(){return t.length},peek:function(){return t[0]},push:function(n){return t.push(n),Q(t,0,t.length-1,e)},pop:function(){var n,r=t.pop();return t.length?(n=t[0],t[0]=r,function(e,t,n){var r,a=t,i=e.length,o=e[t],u=1+(t<<1);for(;u<i;)(r=u+1)<i&&n(e[u],e[r])>=0&&(u=r),e[t]=e[u],u=1+((t=u)<<1);e[t]=o,Q(e,a,t,n)}(t,0,e)):n=r,n}}}function Q(e,t,n,r){for(var a,i,o=e[n];n>t&&r(o,a=e[i=n-1>>1])<0;)e[n]=a,n=i;return e[n]=o}function Z(){this.logger(o.logger()),this.logLevel(o.Error),this._clock=0,this._rank=0,this._locale=c.defaultLocale();try{this._loader=u.loader()}catch(e){}this._touched=l(o.id),this._input={},this._pulse=null,this._heap=Y((function(e,t){return e.qrank-t.qrank})),this._postrun=[]}function $(e){return function(){return this._log[e].apply(this,arguments)}}function ee(e,t){D.call(this,e,null,t)}Z.prototype={stamp:function(){return this._clock},loader:function(e){return arguments.length?(this._loader=e,this):this._loader},locale:function(e){return arguments.length?(this._locale=e,this):this._locale},logger:function(e){return arguments.length?(this._log=e,this):this._log},error:$("error"),warn:$("warn"),info:$("info"),debug:$("debug"),logLevel:$("level"),cleanThreshold:1e4,add:function(e,t,n,r){var a,i=1;return e instanceof D?a=e:e&&e.prototype instanceof D?a=new e:o.isFunction(e)?a=new D(null,e):(i=0,a=new D(e,t)),this.rank(a),i&&(r=n,n=t),n&&this.connect(a,a.parameters(n,r)),this.touch(a),a},connect:function(e,t){for(var n=e.rank,r=t.length,a=0;a<r;++a)if(n<t[a].rank)return void this.rerank(e)},rank:function(e){e.rank=++this._rank},rerank:function(e){for(var t,n,r,a=[e];a.length;)if(this.rank(t=a.pop()),n=t._targets)for(r=n.length;--r>=0;)a.push(t=n[r]),t===e&&o.error("Cycle detected in dataflow graph.")},pulse:function(e,t,n){this.touch(e,n||X);var r=new U(this,this._clock+(this._pulse?0:1)),a=e.pulse&&e.pulse.source||[];return r.target=e,this._input[e.id]=t.pulse(r,a),this},touch:function(e,t){var n=t||X;return this._pulse?this._enqueue(e):this._touched.add(e),n.skip&&e.skip(!0),this},update:function(e,t,n){var r=n||X;return(e.set(t)||r.force)&&this.touch(e,r),this},changeset:E,ingest:function(e,t,n){return t=this.parse(t,n),this.pulse(e,this.changeset().insert(t))},parse:function(e,t){var n=this.locale();return u.read(e,t,n.timeParse,n.utcParse)},preload:function(e,t,n){return M.apply(this,arguments)},request:function(e,t){return R.apply(this,arguments)},events:function(e,t,n,r){for(var a,i=this,u=I(n,r),s=function(e){e.dataflow=i;try{u.receive(e)}catch(e){i.error(e)}finally{i.run()}},c=(a="string"==typeof e&&"undefined"!=typeof document?document.querySelectorAll(e):o.array(e)).length,l=0;l<c;++l)a[l].addEventListener(t,s);return u},on:function(e,t,n,r,a){return(e instanceof D?j:L)(this,e,t,n,r,a),this},evaluate:function(e,t,n){return q.apply(this,arguments)},run:function(e,t,n){return this._pulse?K(this):(this.evaluate(e,t,n),this)},runAsync:function(e,t,n){return J.apply(this,arguments)},runAfter:function(e,t,n){if(this._pulse||t)this._postrun.push({priority:n||0,callback:e});else try{e(this)}catch(e){this.error(e)}},_enqueue:function(e,t){var n=e.stamp<this._clock;n&&(e.stamp=this._clock),(n||t)&&(e.qrank=e.rank,this._heap.push(e))},_getPulse:function(e,t){var n=e.source,r=this._clock;return n&&o.isArray(n)?new H(this,r,n.map((function(e){return e.pulse})),t):this._input[e.id]||function(e,t){if(t&&t.stamp===e.stamp)return t;e=e.fork(),t&&t!==z&&(e.source=t.source);return e}(this._pulse,n&&n.pulse)}},o.inherits(ee,D,{run:function(e){var t,n=this;return e.stamp<this.stamp?e.StopPropagation:(this.skip()?this.skip(!1):t=this.evaluate(e),(t=t||e).then?t=t.then((function(e){return n.pulse=e})):t!==e.StopPropagation&&(this.pulse=t),t)},evaluate:function(e){var t=this.marshall(e.stamp),n=this.transform(t,e);return t.clear(),n},transform:function(){}});var te={};function ne(e){var t=re(e);return t&&t.Definition||null}function re(e){return e=e&&e.toLowerCase(),o.hasOwnProperty(te,e)?te[e]:null}})),s.register("mn9nW",(function(e,r){n(e.exports,"typeParsers",(function(){return D})),n(e.exports,"inferType",(function(){return _})),n(e.exports,"inferTypes",(function(){return I})),n(e.exports,"format",(function(){return j})),n(e.exports,"formats",(function(){return z})),n(e.exports,"responseType",(function(){return U})),n(e.exports,"read",(function(){return V})),n(e.exports,"loader",(function(){return W})),s("1i51P");var a=s("e3nFV"),i=s("9M1dW"),o=s("40Zzs"),u=s("caNzv"),c=s("a5XgS");s("4AwQ4");var l=s("a9oal"),f=s("a03wW"),d=s("7aVEe"),p=s("1mtJC").Buffer,h=/^(data:|([A-Za-z]+:)?\/\/)/,v=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,g=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,m="file://";function y(e,t){return x.apply(this,arguments)}function x(){return(x=a.default(t(o).mark((function e(n,r){var a,i;return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sanitize(n,r);case 2:return a=e.sent,i=a.href,e.abrupt("return",a.localFile?this.file(i):this.http(i,r));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function b(e,t){return k.apply(this,arguments)}function k(){return(k=a.default(t(o).mark((function e(n,r){var a,i,s,c,l,f,d;return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.extend({},this.options,r),a=this.fileAccess,i={href:null},f=v.test(n.replace(g,"")),null!=n&&"string"==typeof n&&f||u.error("Sanitize failure, invalid URI: "+u.stringValue(n)),d=h.test(n),(l=r.baseURL)&&!d&&(n.startsWith("/")||l.endsWith("/")||(n="/"+n),n=l+n),c=(s=n.startsWith(m))||"file"===r.mode||"http"!==r.mode&&!d&&a,s?n=n.slice(m.length):n.startsWith("//")&&("file"===r.defaultProtocol?(n=n.slice(2),c=!0):n=(r.defaultProtocol||"http")+":"+n),Object.defineProperty(i,"localFile",{value:!!c}),i.href=n,r.target&&(i.target=r.target+""),r.rel&&(i.rel=r.rel+""),"image"===r.context&&r.crossOrigin&&(i.crossOrigin=r.crossOrigin+""),e.abrupt("return",i);case 15:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function w(e){return e?function(t){return new Promise((function(n,r){e.readFile(t,(function(e,t){e?r(e):n(t)}))}))}:A}function A(){return E.apply(this,arguments)}function E(){return(E=a.default(t(o).mark((function e(){return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.error("No file system access.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function C(e){return e?(n=a.default(t(o).mark((function n(r,a){var i,s,c;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=u.extend({},this.options.http,a),s=a&&a.response,t.next=4,e(r,i);case 4:return c=t.sent,t.abrupt("return",c.ok?u.isFunction(c[s])?c[s]():c.text():u.error(c.status+""+c.statusText));case 6:case"end":return t.stop()}}),n,this)}))),function(e,t){return n.apply(this,arguments)}):S;var n}function S(){return N.apply(this,arguments)}function N(){return(N=a.default(t(o).mark((function e(){return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u.error("No HTTP fetch method available.");case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var T=function(e){return!(Number.isNaN(+e)||e instanceof Date)},D={boolean:u.toBoolean,integer:u.toNumber,number:u.toNumber,date:u.toDate,string:u.toString,unknown:u.identity},F=[function(e){return"true"===e||"false"===e||!0===e||!1===e},function(e){return T(e)&&Number.isInteger(+e)},T,function(e){return!Number.isNaN(Date.parse(e))}],O=["boolean","integer","number","date"];function _(e,t){if(!e||!e.length)return"unknown";for(var n,r,a,i=e.length,o=F.length,u=F.map((function(e,t){return t+1})),s=0,c=0;s<i;++s)for(r=t?e[s][t]:e[s],n=0;n<o;++n)if(u[n]&&(null!=(a=r)&&a==a)&&!F[n](r)&&(u[n]=0,++c===F.length))return"string";return O[u.reduce((function(e,t){return 0===e?t:e}),0)-1]}function I(e,t){return t.reduce((function(t,n){return t[n]=_(e,n),t}),{})}function R(e){var t=function(t,n){var r={delimiter:e};return M(t,n?u.extend(n,r):r)};return t.responseType="text",t}function M(e,t){return t.header&&(e=t.header.map(u.stringValue).join(t.delimiter)+"\n"+e),c.default(t.delimiter).parse(e+"")}function B(e,t){var n,r=t&&t.property?u.field(t.property):u.identity;return!u.isObject(e)||(n=e,"function"==typeof p&&u.isFunction(p.isBuffer)&&p.isBuffer(n))?r(JSON.parse(e)):function(e,t){!u.isArray(e)&&u.isIterable(e)&&(e=i.default(e));return t&&t.copy?JSON.parse(JSON.stringify(e)):e}(r(e),t)}M.responseType="text",B.responseType="json";var P={interior:function(e,t){return e!==t},exterior:function(e,t){return e===t}};function L(e,t){var n,r,a,i;return e=B(e,t),t&&t.feature?(n=l.default,a=t.feature):t&&t.mesh?(n=f.default,a=t.mesh,i=P[t.filter]):u.error("Missing TopoJSON feature or mesh parameter."),(r=(r=e.objects[a])?n(e,r,i):u.error("Invalid TopoJSON object: "+a))&&r.features||[r]}L.responseType="json";var j={dsv:M,csv:R(","),tsv:R("\t"),json:B,topojson:L};function z(e,t){return arguments.length>1?(j[e]=t,this):u.hasOwnProperty(j,e)?j[e]:null}function U(e){var t=z(e);return t&&t.responseType||"text"}function V(e,t,n,r){var a=z((t=t||{}).type||"json");return a||u.error("Unknown data format type: "+t.type),e=a(e,t),t.parse&&function(e,t,n,r){if(!e.length)return;var a=d.timeFormatDefaultLocale();n=n||a.timeParse,r=r||a.utcParse;var i,o,u,s,c,l,f=e.columns||Object.keys(e[0]);"auto"===t&&(t=I(e,f));var p=(f=Object.keys(t)).map((function(e){var a,i,o=t[e];if(o&&(o.startsWith("date:")||o.startsWith("utc:")))return("'"===(i=(a=o.split(/:(.+)?/,2))[1])[0]&&"'"===i[i.length-1]||'"'===i[0]&&'"'===i[i.length-1])&&(i=i.slice(1,-1)),("utc"===a[0]?r:n)(i);if(!D[o])throw Error("Illegal format pattern: "+e+":"+o);return D[o]}));for(u=0,c=e.length,l=f.length;u<c;++u)for(i=e[u],s=0;s<l;++s)i[o=f[s]]=p[s](i[o])}(e,t.parse,n,r),u.hasOwnProperty(e,"columns")&&delete e.columns,e}var W=function(e,t){return function(n){return{options:n||{},sanitize:b,load:y,fileAccess:!!t,file:w(t),http:C(e)}}}("undefined"!=typeof fetch&&fetch,null)})),s.register("a5XgS",(function(e,t){n(e.exports,"default",(function(){return c}));var r={},a={};function i(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function o(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function u(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function s(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),a=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+u(-t,6):t>9999?"+"+u(t,6):u(t,4))+"-"+u(e.getUTCMonth()+1,2)+"-"+u(e.getUTCDate(),2)+(i?"T"+u(n,2)+":"+u(r,2)+":"+u(a,2)+"."+u(i,3)+"Z":a?"T"+u(n,2)+":"+u(r,2)+":"+u(a,2)+"Z":r||n?"T"+u(n,2)+":"+u(r,2)+"Z":"")}function c(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function u(e,t){var i,o=[],u=e.length,s=0,c=0,l=u<=0,f=!1;function d(){if(l)return a;if(f)return f=!1,r;var t,i,o=s;if(34===e.charCodeAt(o)){for(;s++<u&&34!==e.charCodeAt(s)||34===e.charCodeAt(++s););return(t=s)>=u?l=!0:10===(i=e.charCodeAt(s++))?f=!0:13===i&&(f=!0,10===e.charCodeAt(s)&&++s),e.slice(o+1,t-1).replace(/""/g,'"')}for(;s<u;){if(10===(i=e.charCodeAt(t=s++)))f=!0;else if(13===i)f=!0,10===e.charCodeAt(s)&&++s;else if(i!==n)continue;return e.slice(o,t)}return l=!0,e.slice(o,u)}for(10===e.charCodeAt(u-1)&&--u,13===e.charCodeAt(u-1)&&--u;(i=d())!==a;){for(var p=[];i!==r&&i!==a;)p.push(i),i=d();t&&null==(p=t(p,c++))||o.push(p)}return o}function c(t,n){return t.map((function(t){return n.map((function(e){return f(t[e])})).join(e)}))}function l(t){return t.map(f).join(e)}function f(e){return null==e?"":e instanceof Date?s(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,r,a=u(e,(function(e,a){if(n)return n(e,a-1);r=e,n=t?function(e,t){var n=i(e);return function(r,a){return t(n(r),a,e)}}(e,t):i(e)}));return a.columns=r||[],a},parseRows:u,format:function(t,n){return null==n&&(n=o(t)),[n.map(f).join(e)].concat(c(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=o(e)),c(e,t).join("\n")},formatRows:function(e){return e.map(l).join("\n")},formatRow:l,formatValue:f}}})),s.register("4AwQ4",(function(e,t){n(e.exports,"feature",(function(){return s("a9oal").default})),n(e.exports,"mesh",(function(){return s("a03wW").default}));s("9NJ6F"),s("a9oal"),s("a03wW"),s("lVgru"),s("gjshS"),s("jHoic"),s("5cAJr"),s("jdvl4")})),s.register("9NJ6F",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("5cAJr");function a(e){var t,n=r.default(e.transform),a=1/0,i=a,o=-a,u=-a;function s(e){(e=n(e))[0]<a&&(a=e[0]),e[0]>o&&(o=e[0]),e[1]<i&&(i=e[1]),e[1]>u&&(u=e[1])}function c(e){switch(e.type){case"GeometryCollection":e.geometries.forEach(c);break;case"Point":s(e.coordinates);break;case"MultiPoint":e.coordinates.forEach(s)}}for(t in e.arcs.forEach((function(e){for(var t,r=-1,s=e.length;++r<s;)(t=n(e[r],r))[0]<a&&(a=t[0]),t[0]>o&&(o=t[0]),t[1]<i&&(i=t[1]),t[1]>u&&(u=t[1])})),e.objects)c(e.objects[t]);return[a,i,o,u]}})),s.register("5cAJr",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("2cl3z");function a(e){if(null==e)return r.default;var t,n,a=e.scale[0],i=e.scale[1],o=e.translate[0],u=e.translate[1];return function(e,r){r||(t=n=0);var s=2,c=e.length,l=new Array(c);for(l[0]=(t+=e[0])*a+o,l[1]=(n+=e[1])*i+u;s<c;)l[s]=e[s],++s;return l}}})),s.register("2cl3z",(function(e,t){function r(e){return e}n(e.exports,"default",(function(){return r}))})),s.register("a9oal",(function(e,t){n(e.exports,"default",(function(){return i})),n(e.exports,"object",(function(){return u}));var r=s("jYghf"),a=s("5cAJr");function i(e,t){return"string"==typeof t&&(t=e.objects[t]),"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map((function(t){return o(e,t)}))}:o(e,t)}function o(e,t){var n=t.id,r=t.bbox,a=null==t.properties?{}:t.properties,i=u(e,t);return null==n&&null==r?{type:"Feature",properties:a,geometry:i}:null==r?{type:"Feature",id:n,properties:a,geometry:i}:{type:"Feature",id:n,bbox:r,properties:a,geometry:i}}function u(e,t){var n=a.default(e.transform),i=e.arcs;function o(e,t){t.length&&t.pop();for(var a=i[e<0?~e:e],o=0,u=a.length;o<u;++o)t.push(n(a[o],o));e<0&&r.default(t,u)}function u(e){return n(e)}function s(e){for(var t=[],n=0,r=e.length;n<r;++n)o(e[n],t);return t.length<2&&t.push(t[0]),t}function c(e){for(var t=s(e);t.length<4;)t.push(t[0]);return t}function l(e){return e.map(c)}return function e(t){var n,r=t.type;switch(r){case"GeometryCollection":return{type:r,geometries:t.geometries.map(e)};case"Point":n=u(t.coordinates);break;case"MultiPoint":n=t.coordinates.map(u);break;case"LineString":n=s(t.arcs);break;case"MultiLineString":n=t.arcs.map(s);break;case"Polygon":n=l(t.arcs);break;case"MultiPolygon":n=t.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(t)}})),s.register("jYghf",(function(e,t){function r(e,t){for(var n,r=e.length,a=r-t;a<--r;)n=e[a],e[a++]=e[r],e[r]=n}n(e.exports,"default",(function(){return r}))})),s.register("a03wW",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("a9oal"),a=s("jogND");function i(e){return r.object(e,o.apply(this,arguments))}function o(e,t,n){var r,i,o;if(arguments.length>1)r=u(e,t,n);else for(i=0,r=new Array(o=e.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:a.default(e,r)}}function u(e,t,n){var r,a=[],i=[];function o(e){var t=e<0?~e:e;(i[t]||(i[t]=[])).push({i:e,g:r})}function u(e){e.forEach(o)}function s(e){e.forEach(u)}return function e(t){switch(r=t,t.type){case"GeometryCollection":t.geometries.forEach(e);break;case"LineString":u(t.arcs);break;case"MultiLineString":case"Polygon":s(t.arcs);break;case"MultiPolygon":t.arcs.forEach(s)}}(t),i.forEach(null==n?function(e){a.push(e[0].i)}:function(e){n(e[0].g,e[e.length-1].g)&&a.push(e[0].i)}),a}})),s.register("jogND",(function(e,t){function r(e,t){var n={},r={},a={},i=[],o=-1;function u(e,t){for(var r in e){var a=e[r];delete t[a.start],delete a.start,delete a.end,a.forEach((function(e){n[e<0?~e:e]=1})),i.push(a)}}return t.forEach((function(n,r){var a,i=e.arcs[n<0?~n:n];i.length<3&&!i[1][0]&&!i[1][1]&&(a=t[++o],t[o]=n,t[r]=a)})),t.forEach((function(t){var n,i,o=function(t){var n,r=e.arcs[t<0?~t:t],a=r[0];e.transform?(n=[0,0],r.forEach((function(e){n[0]+=e[0],n[1]+=e[1]}))):n=r[r.length-1];return t<0?[n,a]:[a,n]}(t),u=o[0],s=o[1];if(n=a[u])if(delete a[n.end],n.push(t),n.end=s,i=r[s]){delete r[i.start];var c=i===n?n:n.concat(i);r[c.start=n.start]=a[c.end=i.end]=c}else r[n.start]=a[n.end]=n;else if(n=r[s])if(delete r[n.start],n.unshift(t),n.start=u,i=a[u]){delete a[i.end];var l=i===n?n:i.concat(n);r[l.start=i.start]=a[l.end=n.end]=l}else r[n.start]=a[n.end]=n;else r[(n=[t]).start=u]=a[n.end=s]=n})),u(a,r),u(r,a),t.forEach((function(e){n[e<0?~e:e]||i.push([e])})),i}n(e.exports,"default",(function(){return r}))})),s.register("lVgru",(function(e,t){s("a9oal"),s("jogND")})),s.register("gjshS",(function(e,t){s("4ohhs")})),s.register("4ohhs",(function(e,t){function r(e,t){for(var n=0,r=e.length;n<r;){var a=n+r>>>1;e[a]<t?n=a+1:r=a}return n}n(e.exports,"default",(function(){return r}))})),s.register("jHoic",(function(e,t){s("9NJ6F"),s("jdvl4")})),s.register("jdvl4",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("2cl3z");function a(e){if(null==e)return r.default;var t,n,a=e.scale[0],i=e.scale[1],o=e.translate[0],u=e.translate[1];return function(e,r){r||(t=n=0);var s=2,c=e.length,l=new Array(c),f=Math.round((e[0]-o)/a),d=Math.round((e[1]-u)/i);for(l[0]=f-t,t=f,l[1]=d-n,n=d;s<c;)l[s]=e[s],++s;return l}}})),s.register("7aVEe",(function(e,t){n(e.exports,"locale",(function(){return T})),n(e.exports,"numberFormatDefaultLocale",(function(){return k})),n(e.exports,"timeFormatDefaultLocale",(function(){return S})),n(e.exports,"defaultLocale",(function(){return D})),n(e.exports,"resetDefaultLocale",(function(){return F}));var r,a,i=s("hdht0"),o=s("2HHbk"),u=s("jV6Hh"),c=s("fGyo4"),l=s("db8as"),f=s("cY0Q7"),d=s("9OWUd"),p=s("2U08m"),h=s("caNzv"),v=s("3iupp"),g=s("5rlIi");function m(e){var t={};return function(n){return t[n]||(t[n]=e(n))}}function y(e){var t=m(e.format),n=e.formatPrefix;return{format:t,formatPrefix:n,formatFloat:function(e){var n,r,a=o.default(e||",");if(null==a.precision){switch(a.precision=12,a.type){case"%":a.precision-=2;break;case"e":a.precision-=1}return n=t(a),r=t(".1f")(1)[1],function(e){var t=n(e),a=t.indexOf(r);if(a<0)return t;for(var i=function(e,t){var n,r=e.lastIndexOf("e");if(r>0)return r;for(r=e.length;--r>t;)if((n=e.charCodeAt(r))>=48&&n<=57)return r+1}(t,a),o=i<t.length?t.slice(i):"";--i>a;)if("0"!==t[i]){++i;break}return t.slice(0,i)+o}}return t(a)},formatSpan:function(e,r,a,s){s=o.default(null==s?",f":s);var f,d=i.tickStep(e,r,a),p=Math.max(Math.abs(e),Math.abs(r));if(null==s.precision)switch(s.type){case"s":return isNaN(f=u.default(d,p))||(s.precision=f),n(s,p);case"":case"e":case"g":case"p":case"r":isNaN(f=c.default(d,p))||(s.precision=f-("e"===s.type));break;case"f":case"%":isNaN(f=l.default(d))||(s.precision=f-2*("%"===s.type))}return t(s)}}}function x(){return r=y({format:f.format,formatPrefix:f.formatPrefix})}function b(e){return y(d.default(e))}function k(e){return arguments.length?r=b(e):r}function w(e,t,n){n=n||{},h.isObject(n)||h.error("Invalid time multi-format specifier: ".concat(n));var r=t(p.SECONDS),a=t(p.MINUTES),i=t(p.HOURS),o=t(p.DATE),u=t(p.WEEK),s=t(p.MONTH),c=t(p.QUARTER),l=t(p.YEAR),f=e(n[p.MILLISECONDS]||".%L"),d=e(n[p.SECONDS]||":%S"),v=e(n[p.MINUTES]||"%I:%M"),g=e(n[p.HOURS]||"%I %p"),m=e(n[p.DATE]||n[p.DAY]||"%a %d"),y=e(n[p.WEEK]||"%b %d"),x=e(n[p.MONTH]||"%B"),b=e(n[p.QUARTER]||"%B"),k=e(n[p.YEAR]||"%Y");return function(e){return(r(e)<e?f:a(e)<e?d:i(e)<e?v:o(e)<e?g:s(e)<e?u(e)<e?m:y:l(e)<e?c(e)<e?x:b:k)(e)}}function A(e){var t=m(e.format),n=m(e.utcFormat);return{timeFormat:function(e){return h.isString(e)?t(e):w(t,p.timeInterval,e)},utcFormat:function(e){return h.isString(e)?n(e):w(n,p.utcInterval,e)},timeParse:m(e.parse),utcParse:m(e.utcParse)}}function E(){return a=A({format:v.timeFormat,parse:v.timeParse,utcFormat:v.utcFormat,utcParse:v.utcParse})}function C(e){return A(g.default(e))}function S(e){return arguments.length?a=C(e):a}x(),E();var N=function(e,t){return h.extend({},e,t)};function T(e,t){var n=e?b(e):k(),r=t?C(t):S();return N(n,r)}function D(e,t){var n=arguments.length;return n&&2!==n&&h.error("defaultLocale expects either zero or two arguments."),n?N(k(e),S(t)):N(k(),S())}function F(){return x(),E(),D()}})),s.register("4YaFt",(function(e,t){n(e.exports,"bisectRight",(function(){return u})),n(e.exports,"bisectLeft",(function(){return c})),n(e.exports,"default",(function(){return l}));var r=s("35HQC"),a=s("9ZJHk"),i=s("4HyJP"),o=a.default(r.default),u=o.right,c=o.left,l=(a.default(i.default).center,u)})),s.register("35HQC",(function(e,t){function r(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}n(e.exports,"default",(function(){return r}))})),s.register("9ZJHk",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("35HQC");function a(e){var t=e,n=e;function a(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)<0?r=i+1:a=i}return r}return 1===e.length&&(t=function(t,n){return e(t)-n},n=function(e){return function(t,n){return r.default(e(t),n)}}(e)),{left:a,center:function(e,n,r,i){null==r&&(r=0),null==i&&(i=e.length);var o=a(e,n,r,i-1);return o>r&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,r,a){for(null==r&&(r=0),null==a&&(a=e.length);r<a;){var i=r+a>>>1;n(e[i],t)>0?a=i:r=i+1}return r}}}})),s.register("4HyJP",(function(e,r){n(e.exports,"numbers",(function(){return u})),n(e.exports,"default",(function(){return o}));var a=s("40Zzs"),i=t(a).mark(u);function o(e){return null===e?NaN:+e}function u(e,n){var r,o,u,s,c,l,f,d,p,h,v,g,m;return t(a).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==n){t.next=28;break}r=!0,o=!1,u=void 0,t.prev=2,s=e[Symbol.iterator]();case 4:if(r=(c=s.next()).done){t.next=12;break}if(!(null!=(l=c.value)&&(l=+l)>=l)){t.next=9;break}return t.next=9,l;case 9:r=!0,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),o=!0,u=t.t0;case 18:t.prev=18,t.prev=19,r||null==s.return||s.return();case 21:if(t.prev=21,!o){t.next=24;break}throw u;case 24:return t.finish(21);case 25:return t.finish(18);case 26:t.next=54;break;case 28:f=-1,d=!0,p=!1,h=void 0,t.prev=30,v=e[Symbol.iterator]();case 32:if(d=(g=v.next()).done){t.next=40;break}if(m=g.value,!(null!=(m=n(m,++f,e))&&(m=+m)>=m)){t.next=37;break}return t.next=37,m;case 37:d=!0,t.next=32;break;case 40:t.next=46;break;case 42:t.prev=42,t.t1=t.catch(30),p=!0,h=t.t1;case 46:t.prev=46,t.prev=47,d||null==v.return||v.return();case 49:if(t.prev=49,!p){t.next=52;break}throw h;case 52:return t.finish(49);case 53:return t.finish(46);case 54:case"end":return t.stop()}}),i,null,[[2,14,18,26],[19,,21,25],[30,42,46,54],[47,,49,53]])}})),s.register("jTJ6X",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("7zzSj");function a(e,t){var n=r.default(e,t);return n?Math.sqrt(n):n}})),s.register("7zzSj",(function(e,t){function r(e,t){var n,r=0,a=0,i=0;if(void 0===t){var o=!0,u=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;null!=f&&(f=+f)>=f&&(i+=(n=f-a)*(f-(a+=n/++r)))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}}else{var d=-1,p=!0,h=!1,v=void 0;try{for(var g,m=e[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=g.value;null!=(y=t(y,++d,e))&&(y=+y)>=y&&(i+=(n=y-a)*(y-(a+=n/++r)))}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}}if(r>1)return i/(r-1)}n(e.exports,"default",(function(){return r}))})),s.register("cFqjn",(function(e,t){n(e.exports,"Adder",(function(){return i})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=function(){"use strict";function e(){r.default(this,e),this._partials=new Float64Array(32),this._n=0}return a.default(e,[{key:"add",value:function(e){for(var t=this._partials,n=0,r=0;r<this._n&&r<32;r++){var a=t[r],i=e+a,o=Math.abs(e)<Math.abs(a)?e-(i-a):a-(i-e);o&&(t[n++]=o),e=i}return t[n]=e,this._n=n+1,this}},{key:"valueOf",value:function(){var e,t,n,r=this._partials,a=this._n,i=0;if(a>0){for(i=r[--a];a>0&&(e=i,!(n=(t=r[--a])-((i=e+t)-e))););a>0&&(n<0&&r[a-1]<0||n>0&&r[a-1]>0)&&(t=2*n)==(e=i+t)-i&&(i=e)}return i}}]),e}()})),s.register("5wp2C",(function(e,t){function r(e,t){var n;if(void 0===t){var r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n<s||void 0===n&&s>=s)&&(n=s)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}else{var c=-1,l=!0,f=!1,d=void 0;try{for(var p,h=e[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;null!=(v=t(v,++c,e))&&(n<v||void 0===n&&v>=v)&&(n=v)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}}return n}n(e.exports,"default",(function(){return r}))})),s.register("dxL8E",(function(e,t){function r(e,t){var n=0,r=0;if(void 0===t){var a=!0,i=!1,o=void 0;try{for(var u,s=e[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;null!=c&&(c=+c)>=c&&(++n,r+=c)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}}else{var l=-1,f=!0,d=!1,p=void 0;try{for(var h,v=e[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var g=h.value;null!=(g=t(g,++l,e))&&(g=+g)>=g&&(++n,r+=g)}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}}if(n)return r/n}n(e.exports,"default",(function(){return r}))})),s.register("lUWZp",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bQzCL");function a(e,t){return r.default(e,.5,t)}})),s.register("bQzCL",(function(e,t){n(e.exports,"default",(function(){return u})),n(e.exports,"quantileSorted",(function(){return c}));var r=s("5wp2C"),a=s("3FUhS"),i=s("b8Ipr"),o=s("4HyJP");function u(e,t,n){if(u=(e=Float64Array.from(o.numbers(e,n))).length){if((t=+t)<=0||u<2)return a.default(e);if(t>=1)return r.default(e);var u,s=(u-1)*t,c=Math.floor(s),l=r.default(i.default(e,c).subarray(0,c+1));return l+(a.default(e.subarray(c+1))-l)*(s-c)}}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.default;if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,a=(r-1)*t,i=Math.floor(a),u=+n(e[i],i,e),s=+n(e[i+1],i+1,e);return u+(s-u)*(a-i)}}})),s.register("3FUhS",(function(e,t){function r(e,t){var n;if(void 0===t){var r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&(n>s||void 0===n&&s>=s)&&(n=s)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}else{var c=-1,l=!0,f=!1,d=void 0;try{for(var p,h=e[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;null!=(v=t(v,++c,e))&&(n>v||void 0===n&&v>=v)&&(n=v)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}}return n}n(e.exports,"default",(function(){return r}))})),s.register("b8Ipr",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("35HQC");function a(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length-1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:r.default;o>n;){if(o-n>600){var s=o-n+1,c=t-n+1,l=Math.log(s),f=.5*Math.exp(2*l/3),d=.5*Math.sqrt(l*f*(s-f)/s)*(c-s/2<0?-1:1),p=Math.max(n,Math.floor(t-c*f/s+d)),h=Math.min(o,Math.floor(t+(s-c)*f/s+d));a(e,t,p,h,u)}var v=e[t],g=n,m=o;for(i(e,n,t),u(e[o],v)>0&&i(e,n,o);g<m;){for(i(e,g,m),++g,--m;u(e[g],v)<0;)++g;for(;u(e[m],v)>0;)--m}0===u(e[n],v)?i(e,n,m):i(e,++m,o),m<=t&&(n=m+1),t<=m&&(o=m-1)}return e}function i(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}})),s.register("548Lj",(function(e,r){n(e.exports,"default",(function(){return u}));var a=s("40Zzs"),i=t(a).mark(o);function o(e){var n,r,o,u,s,c;return t(a).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=!0,r=!1,o=void 0,t.prev=1,u=e[Symbol.iterator]();case 3:if(n=(s=u.next()).done){t.next=9;break}return c=s.value,t.delegateYield(c,"t0",6);case 6:n=!0,t.next=3;break;case 9:t.next=15;break;case 11:t.prev=11,t.t1=t.catch(1),r=!0,o=t.t1;case 15:t.prev=15,t.prev=16,n||null==u.return||u.return();case 18:if(t.prev=18,!r){t.next=21;break}throw o;case 21:return t.finish(18);case 22:return t.finish(15);case 23:case"end":return t.stop()}}),i,null,[[1,11,15,23],[16,,18,22]])}function u(e){return Array.from(o(e))}})),s.register("3XOxy",(function(e,t){function r(e,t){return Array.from(t,(function(t){return e[t]}))}n(e.exports,"default",(function(){return r}))})),s.register("jTUhZ",(function(e,t){function r(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((t-e)/n)),i=new Array(a);++r<a;)i[r]=e+r*n;return i}n(e.exports,"default",(function(){return r}))})),s.register("5OZVX",(function(e,t){function r(e,t){var n=0;if(void 0===t){var r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;(s=+s)&&(n+=s)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}else{var c=-1,l=!0,f=!1,d=void 0;try{for(var p,h=e[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;(v=+t(v,++c,e))&&(n+=v)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}}return n}n(e.exports,"default",(function(){return r}))})),s.register("hdht0",(function(e,t){n(e.exports,"default",(function(){return o})),n(e.exports,"tickIncrement",(function(){return u})),n(e.exports,"tickStep",(function(){return s}));var r=Math.sqrt(50),a=Math.sqrt(10),i=Math.sqrt(2);function o(e,t,n){var r,a,i,o,s=-1;if(n=+n,(e=+e)===(t=+t)&&n>0)return[e];if((r=t<e)&&(a=e,e=t,t=a),0===(o=u(e,t,n))||!isFinite(o))return[];if(o>0){var c=Math.round(e/o),l=Math.round(t/o);for(c*o<e&&++c,l*o>t&&--l,i=new Array(a=l-c+1);++s<a;)i[s]=(c+s)*o}else{o=-o;var f=Math.round(e*o),d=Math.round(t*o);for(f/o<e&&++f,d/o>t&&--d,i=new Array(a=d-f+1);++s<a;)i[s]=(f+s)/o}return r&&i.reverse(),i}function u(e,t,n){var o=(t-e)/Math.max(0,n),u=Math.floor(Math.log(o)/Math.LN10),s=o/Math.pow(10,u);return u>=0?(s>=r?10:s>=a?5:s>=i?2:1)*Math.pow(10,u):-Math.pow(10,-u)/(s>=r?10:s>=a?5:s>=i?2:1)}function s(e,t,n){var o=Math.abs(t-e)/Math.max(0,n),u=Math.pow(10,Math.floor(Math.log(o)/Math.LN10)),s=o/u;return s>=r?u*=10:s>=a?u*=5:s>=i&&(u*=2),t<e?-u:u}})),s.register("cY0Q7",(function(e,t){n(e.exports,"format",(function(){return a})),n(e.exports,"formatPrefix",(function(){return i}));var r,a,i,o,u=s("9OWUd");o={thousands:",",grouping:[3],currency:["$",""]},r=u.default(o),a=r.format,i=r.formatPrefix})),s.register("9OWUd",(function(e,t){n(e.exports,"default",(function(){return h}));var r=s("e9UPf"),a=s("gqJ9V"),i=s("ggffQ"),o=s("2HHbk"),u=s("kdP6v"),c=s("jw7Pr"),l=s("kdJP4"),f=s("r4sQK"),d=Array.prototype.map,p=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function h(e){var t=void 0===e.grouping||void 0===e.thousands?f.default:a.default(d.call(e.grouping,Number),e.thousands+""),n=void 0===e.currency?"":e.currency[0]+"",s=void 0===e.currency?"":e.currency[1]+"",h=void 0===e.decimal?".":e.decimal+"",v=void 0===e.numerals?f.default:i.default(d.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",m=void 0===e.minus?"":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function x(e){var r=(e=o.default(e)).fill,a=e.align,i=e.sign,f=e.symbol,d=e.zero,x=e.width,b=e.comma,k=e.precision,w=e.trim,A=e.type;"n"===A?(b=!0,A="g"):c.default[A]||(void 0===k&&(k=12),w=!0,A="g"),(d||"0"===r&&"="===a)&&(d=!0,r="0",a="=");var E="$"===f?n:"#"===f&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",C="$"===f?s:/[%p]/.test(A)?g:"",S=c.default[A],N=/[defgprs%]/.test(A);function T(e){var n,o,s,c=E,f=C;if("c"===A)f=S(e)+f,e="";else{var g=(e=+e)<0||1/e<0;if(e=isNaN(e)?y:S(Math.abs(e),k),w&&(e=u.default(e)),g&&0==+e&&"+"!==i&&(g=!1),c=(g?"("===i?i:m:"-"===i||"("===i?"":i)+c,f=("s"===A?p[8+l.prefixExponent/3]:"")+f+(g&&"("===i?")":""),N)for(n=-1,o=e.length;++n<o;)if(48>(s=e.charCodeAt(n))||s>57){f=(46===s?h+e.slice(n+1):e.slice(n))+f,e=e.slice(0,n);break}}b&&!d&&(e=t(e,1/0));var T=c.length+e.length+f.length,D=T<x?new Array(x-T+1).join(r):"";switch(b&&d&&(e=t(D+e,D.length?x-f.length:1/0),D=""),a){case"<":e=c+e+f+D;break;case"=":e=c+D+e+f;break;case"^":e=D.slice(0,T=D.length>>1)+c+e+f+D.slice(T);break;default:e=D+c+e+f}return v(e)}return k=void 0===k?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k)),T.toString=function(){return e+""},T}return{format:x,formatPrefix:function(e,t){var n=x(((e=o.default(e)).type="f",e)),a=3*Math.max(-8,Math.min(8,Math.floor(r.default(t)/3))),i=Math.pow(10,-a),u=p[8+a/3];return function(e){return n(i*e)+u}}}}})),s.register("e9UPf",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("7QqqE");function a(e){return(e=r.formatDecimalParts(Math.abs(e)))?e[1]:NaN}})),s.register("7QqqE",(function(e,t){function r(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function a(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}n(e.exports,"default",(function(){return r})),n(e.exports,"formatDecimalParts",(function(){return a}))})),s.register("gqJ9V",(function(e,t){function r(e,t){return function(n,r){for(var a=n.length,i=[],o=0,u=e[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(n.substring(a-=u,a+u)),!((s+=u+1)>r));)u=e[o=(o+1)%e.length];return i.reverse().join(t)}}n(e.exports,"default",(function(){return r}))})),s.register("ggffQ",(function(e,t){function r(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}n(e.exports,"default",(function(){return r}))})),s.register("2HHbk",(function(e,t){n(e.exports,"default",(function(){return a}));var r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(e){if(!(t=r.exec(e)))throw new Error("invalid format: "+e);var t;return new i({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function i(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}a.prototype=i.prototype,i.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}})),s.register("kdP6v",(function(e,t){function r(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(!+e[r])break e;a>0&&(a=0)}return a>0?e.slice(0,a)+e.slice(t+1):e}n(e.exports,"default",(function(){return r}))})),s.register("jw7Pr",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("7QqqE"),a=s("kdJP4"),i=s("8slji"),o={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:r.default,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return i.default(100*e,t)},r:i.default,s:a.default,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}}})),s.register("kdJP4",(function(e,t){n(e.exports,"prefixExponent",(function(){return r})),n(e.exports,"default",(function(){return i}));var r,a=s("7QqqE");function i(e,t){var n=a.formatDecimalParts(e,t);if(!n)return e+"";var i=n[0],o=n[1],u=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=i.length;return u===s?i:u>s?i+new Array(u-s+1).join("0"):u>0?i.slice(0,u)+"."+i.slice(u):"0."+new Array(1-u).join("0")+a.formatDecimalParts(e,Math.max(0,t+u-1))[0]}})),s.register("8slji",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("7QqqE");function a(e,t){var n=r.formatDecimalParts(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}})),s.register("r4sQK",(function(e,t){function r(e){return e}n(e.exports,"default",(function(){return r}))})),s.register("db8as",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("e9UPf");function a(e){return Math.max(0,-r.default(Math.abs(e)))}})),s.register("jV6Hh",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("e9UPf");function a(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(r.default(t)/3)))-r.default(Math.abs(e)))}})),s.register("fGyo4",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("e9UPf");function a(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,r.default(t)-r.default(e))+1}})),s.register("2U08m",(function(e,t){n(e.exports,"YEAR",(function(){return A})),n(e.exports,"QUARTER",(function(){return E})),n(e.exports,"MONTH",(function(){return C})),n(e.exports,"WEEK",(function(){return S})),n(e.exports,"DATE",(function(){return N})),n(e.exports,"DAY",(function(){return T})),n(e.exports,"DAYOFYEAR",(function(){return D})),n(e.exports,"HOURS",(function(){return F})),n(e.exports,"MINUTES",(function(){return O})),n(e.exports,"SECONDS",(function(){return _})),n(e.exports,"MILLISECONDS",(function(){return I})),n(e.exports,"TIME_UNITS",(function(){return R})),n(e.exports,"timeUnits",(function(){return B})),n(e.exports,"timeUnitSpecifier",(function(){return L})),n(e.exports,"dayofyear",(function(){return V})),n(e.exports,"week",(function(){return W})),n(e.exports,"utcdayofyear",(function(){return K})),n(e.exports,"utcweek",(function(){return X})),n(e.exports,"timeFloor",(function(){return oe})),n(e.exports,"utcFloor",(function(){return fe})),n(e.exports,"timeInterval",(function(){return ve})),n(e.exports,"utcInterval",(function(){return ge})),n(e.exports,"timeOffset",(function(){return ye})),n(e.exports,"utcOffset",(function(){return xe})),n(e.exports,"timeSequence",(function(){return ke})),n(e.exports,"utcSequence",(function(){return we})),n(e.exports,"timeBin",(function(){return Pe})),s("1i51P");var r,a=s("4Ui3v"),i=s("caNzv"),o=s("ddiTx"),u=s("7yUGY"),c=s("9t3Va"),l=s("euQv8"),f=s("imkHR"),d=s("81VW3"),p=s("cT5Vi"),h=s("1Ddjq"),v=s("eBY9l"),g=s("j90y6"),m=s("730hp"),y=s("cB2pD"),x=s("7tkqA"),b=s("9ig5K"),k=s("9ZJHk"),w=s("hdht0"),A="year",E="quarter",C="month",S="week",N="date",T="day",D="dayofyear",F="hours",O="minutes",_="seconds",I="milliseconds",R=[A,E,C,S,N,T,D,F,O,_,I],M=R.reduce((function(e,t,n){return e[t]=1+n,e}),{});function B(e){var t=i.array(e).slice(),n={};return t.length||i.error("Missing time unit."),t.forEach((function(e){i.hasOwnProperty(M,e)?n[e]=1:i.error("Invalid time unit: ".concat(e,"."))})),(n[S]||n[T]?1:0)+(n[E]||n[C]||n[N]?1:0)+(n[D]?1:0)>1&&i.error("Incompatible time units: ".concat(e)),t.sort((function(e,t){return M[e]-M[t]})),t}var P=(r={},a.default(r,A,"%Y "),a.default(r,E,"Q%q "),a.default(r,C,"%b "),a.default(r,N,"%d "),a.default(r,S,"W%U "),a.default(r,T,"%a "),a.default(r,D,"%j "),a.default(r,F,"%H:00"),a.default(r,O,"00:%M"),a.default(r,_,":%S"),a.default(r,I,".%L"),a.default(r,"".concat(A,"-").concat(C),"%Y-%m "),a.default(r,"".concat(A,"-").concat(C,"-").concat(N),"%Y-%m-%d "),a.default(r,"".concat(F,"-").concat(O),"%H:%M"),r);function L(e,t){var n,r,a=i.extend({},P,t),o=B(e),u=o.length,s="",c=0;for(c=0;c<u;)for(n=o.length;n>c;--n)if(null!=a[r=o.slice(c,n).join("-")]){s+=a[r],c=n;break}return s.trim()}var j,z=new Date;function U(e){return z.setFullYear(e),z.setMonth(0),z.setDate(1),z.setHours(0,0,0,0),z}function V(e){return G(new Date(e))}function W(e){return H(new Date(e))}function G(e){return o.default.count(U(e.getFullYear())-1,e)}function H(e){return u.sunday.count(U(e.getFullYear())-1,e)}function q(e){return U(e).getDay()}function J(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(-1,t,n,r,a,i,o);return u.setFullYear(e),u}return new Date(e,t,n,r,a,i,o)}function K(e){return Y(new Date(e))}function X(e){return Q(new Date(e))}function Y(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return c.default.count(t-1,e)}function Q(e){var t=Date.UTC(e.getUTCFullYear(),0,1);return l.utcSunday.count(t-1,e)}function Z(e){return z.setTime(Date.UTC(e,0,1)),z.getUTCDay()}function $(e,t,n,r,a,i,o){if(0<=e&&e<100){var u=new Date(Date.UTC(-1,t,n,r,a,i,o));return u.setUTCFullYear(n.y),u}return new Date(Date.UTC(e,t,n,r,a,i,o))}function ee(e,t,n,r,a){var o=t||1,u=i.peek(e),s=function(e,t,a){return function(e,t,n,r){var a=n<=1?e:r?function(t,a){return r+n*Math.floor((e(t,a)-r)/n)}:function(t,r){return n*Math.floor(e(t,r)/n)};return t?function(e,n){return t(a(e,n),n)}:a}(n[a=a||e],r[a],e===u&&o,t)},c=new Date,l=i.toSet(e),f=l[A]?s(A):i.constant(2012),d=l[C]?s(C):l[E]?s(E):i.zero,p=l[S]&&l[T]?s(T,1,S+T):l[S]?s(S,1):l[T]?s(T,1):l[N]?s(N,1):l[D]?s(D,1):i.one,h=l[F]?s(F):i.zero,v=l[O]?s(O):i.zero,g=l[_]?s(_):i.zero,m=l[I]?s(I):i.zero;return function(e){c.setTime(+e);var t=f(c);return a(t,d(c),p(c,t),h(c),v(c),g(c),m(c))}}function te(e,t,n){return t+7*e-(n+6)%7}var ne,re,ae=(j={},a.default(j,A,(function(e){return e.getFullYear()})),a.default(j,E,(function(e){return Math.floor(e.getMonth()/3)})),a.default(j,C,(function(e){return e.getMonth()})),a.default(j,N,(function(e){return e.getDate()})),a.default(j,F,(function(e){return e.getHours()})),a.default(j,O,(function(e){return e.getMinutes()})),a.default(j,_,(function(e){return e.getSeconds()})),a.default(j,I,(function(e){return e.getMilliseconds()})),a.default(j,D,(function(e){return G(e)})),a.default(j,S,(function(e){return H(e)})),a.default(j,S+T,(function(e,t){return te(H(e),e.getDay(),q(t))})),a.default(j,T,(function(e,t){return te(1,e.getDay(),q(t))})),j),ie=(ne={},a.default(ne,E,(function(e){return 3*e})),a.default(ne,S,(function(e,t){return te(e,0,q(t))})),ne);function oe(e,t){return ee(e,t||1,ae,ie,J)}var ue,se,ce=(re={},a.default(re,A,(function(e){return e.getUTCFullYear()})),a.default(re,E,(function(e){return Math.floor(e.getUTCMonth()/3)})),a.default(re,C,(function(e){return e.getUTCMonth()})),a.default(re,N,(function(e){return e.getUTCDate()})),a.default(re,F,(function(e){return e.getUTCHours()})),a.default(re,O,(function(e){return e.getUTCMinutes()})),a.default(re,_,(function(e){return e.getUTCSeconds()})),a.default(re,I,(function(e){return e.getUTCMilliseconds()})),a.default(re,D,(function(e){return Y(e)})),a.default(re,S,(function(e){return Q(e)})),a.default(re,T,(function(e,t){return te(1,e.getUTCDay(),Z(t))})),a.default(re,S+T,(function(e,t){return te(Q(e),e.getUTCDay(),Z(t))})),re),le=(ue={},a.default(ue,E,(function(e){return 3*e})),a.default(ue,S,(function(e,t){return te(e,0,Z(t))})),ue);function fe(e,t){return ee(e,t||1,ce,le,$)}var de,pe=(se={},a.default(se,A,f.default),a.default(se,E,d.default.every(3)),a.default(se,C,d.default),a.default(se,S,u.sunday),a.default(se,N,o.default),a.default(se,T,o.default),a.default(se,D,o.default),a.default(se,F,p.default),a.default(se,O,h.default),a.default(se,_,v.default),a.default(se,I,g.default),se),he=(de={},a.default(de,A,m.default),a.default(de,E,y.default.every(3)),a.default(de,C,y.default),a.default(de,S,l.utcSunday),a.default(de,N,c.default),a.default(de,T,c.default),a.default(de,D,c.default),a.default(de,F,x.default),a.default(de,O,b.default),a.default(de,_,v.default),a.default(de,I,g.default),de);function ve(e){return pe[e]}function ge(e){return he[e]}function me(e,t,n){return e?e.offset(t,n):void 0}function ye(e,t,n){return me(ve(e),t,n)}function xe(e,t,n){return me(ge(e),t,n)}function be(e,t,n,r){return e?e.range(t,n,r):void 0}function ke(e,t,n,r){return be(ve(e),t,n,r)}function we(e,t,n,r){return be(ge(e),t,n,r)}var Ae=1e3,Ee=6e4,Ce=36e5,Se=864e5,Ne=2592e6,Te=31536e6,De=[A,C,N,F,O,_,I],Fe=De.slice(0,-1),Oe=Fe.slice(0,-1),_e=Oe.slice(0,-1),Ie=_e.slice(0,-1),Re=[A,C],Me=[A],Be=[[Fe,1,Ae],[Fe,5,5e3],[Fe,15,15e3],[Fe,30,3e4],[Oe,1,Ee],[Oe,5,3e5],[Oe,15,9e5],[Oe,30,18e5],[_e,1,Ce],[_e,3,108e5],[_e,6,216e5],[_e,12,432e5],[Ie,1,Se],[[A,S],1,6048e5],[Re,1,Ne],[Re,3,7776e6],[Me,1,Te]];function Pe(e){var t,n,r=e.extent,a=e.maxbins||40,o=Math.abs(i.span(r))/a,u=k.default((function(e){return e[2]})).right(Be,o);return u===Be.length?(t=Me,n=w.tickStep(r[0]/Te,r[1]/Te,a)):u?(t=(u=Be[o/Be[u-1][2]<Be[u][2]/o?u-1:u])[0],n=u[1]):(t=De,n=Math.max(w.tickStep(r[0],r[1],a),1)),{units:t,step:n}}})),s.register("j90y6",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("2KsOu"),a=r.default((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));a.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r.default((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,n){t.setTime(+t+n*e)}),(function(t,n){return(n-t)/e})):a:null};var i=a;a.range})),s.register("2KsOu",(function(e,t){n(e.exports,"default",(function(){return i}));var r=new Date,a=new Date;function i(e,t,n,o){function u(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return u.floor=function(t){return e(t=new Date(+t)),t},u.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},u.round=function(e){var t=u(e),n=u.ceil(e);return e-t<n-e?t:n},u.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},u.range=function(n,r,a){var i,o=[];if(n=u.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return o;do{o.push(i=new Date(+n)),t(n,a),e(n)}while(i<n&&n<r);return o},u.filter=function(n){return i((function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),(function(e,r){if(e>=e)if(r<0)for(;++r<=0;)for(;t(e,-1),!n(e););else for(;--r>=0;)for(;t(e,1),!n(e););}))},n&&(u.count=function(t,i){return r.setTime(+t),a.setTime(+i),e(r),e(a),Math.floor(n(r,a))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(t){return o(t)%e==0}:function(t){return u.count(0,t)%e==0}):u:null}),u}})),s.register("eBY9l",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*a.durationSecond)}),(function(e,t){return(t-e)/a.durationSecond}),(function(e){return e.getUTCSeconds()})),o=i;i.range})),s.register("ailNF",(function(e,t){n(e.exports,"durationSecond",(function(){return r})),n(e.exports,"durationMinute",(function(){return a})),n(e.exports,"durationHour",(function(){return i})),n(e.exports,"durationDay",(function(){return o})),n(e.exports,"durationWeek",(function(){return u})),n(e.exports,"durationMonth",(function(){return s})),n(e.exports,"durationYear",(function(){return c}));var r=1e3,a=60*r,i=60*a,o=24*i,u=7*o,s=30*o,c=365*o})),s.register("1Ddjq",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*a.durationSecond)}),(function(e,t){e.setTime(+e+t*a.durationMinute)}),(function(e,t){return(t-e)/a.durationMinute}),(function(e){return e.getMinutes()})),o=i;i.range})),s.register("cT5Vi",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*a.durationSecond-e.getMinutes()*a.durationMinute)}),(function(e,t){e.setTime(+e+t*a.durationHour)}),(function(e,t){return(t-e)/a.durationHour}),(function(e){return e.getHours()})),o=i;i.range})),s.register("ddiTx",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){return e.setHours(0,0,0,0)}),(function(e,t){return e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*a.durationMinute)/a.durationDay}),(function(e){return e.getDate()-1})),o=i;i.range})),s.register("7yUGY",(function(e,t){n(e.exports,"sunday",(function(){return o})),n(e.exports,"monday",(function(){return u})),n(e.exports,"thursday",(function(){return f}));var r=s("2KsOu"),a=s("ailNF");function i(e){return r.default((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*a.durationMinute)/a.durationWeek}))}var o=i(0),u=i(1),c=i(2),l=i(3),f=i(4),d=i(5),p=i(6);o.range,u.range,c.range,l.range,f.range,d.range,p.range})),s.register("81VW3",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("2KsOu").default((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),a=r;r.range})),s.register("imkHR",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("2KsOu"),a=r.default((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));a.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r.default((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,n){t.setFullYear(t.getFullYear()+n*e)})):null};var i=a;a.range})),s.register("9ig5K",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*a.durationMinute)}),(function(e,t){return(t-e)/a.durationMinute}),(function(e){return e.getUTCMinutes()})),o=i;i.range})),s.register("7tkqA",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*a.durationHour)}),(function(e,t){return(t-e)/a.durationHour}),(function(e){return e.getUTCHours()})),o=i;i.range})),s.register("9t3Va",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2KsOu"),a=s("ailNF"),i=r.default((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/a.durationDay}),(function(e){return e.getUTCDate()-1})),o=i;i.range})),s.register("euQv8",(function(e,t){n(e.exports,"utcSunday",(function(){return o})),n(e.exports,"utcMonday",(function(){return u})),n(e.exports,"utcThursday",(function(){return f}));var r=s("2KsOu"),a=s("ailNF");function i(e){return r.default((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/a.durationWeek}))}var o=i(0),u=i(1),c=i(2),l=i(3),f=i(4),d=i(5),p=i(6);o.range,u.range,c.range,l.range,f.range,d.range,p.range})),s.register("cB2pD",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("2KsOu").default((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),a=r;r.range})),s.register("730hp",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("2KsOu"),a=r.default((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));a.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r.default((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null};var i=a;a.range})),s.register("3dgBB",(function(e,t){n(e.exports,"utcTicks",(function(){return E})),n(e.exports,"utcTickInterval",(function(){return C})),n(e.exports,"timeTicks",(function(){return N})),n(e.exports,"timeTickInterval",(function(){return T})),s("1i51P");var r=s("6vecG"),a=s("9ZJHk"),i=s("hdht0"),o=s("ailNF"),u=s("j90y6"),c=s("eBY9l"),l=s("1Ddjq"),f=s("cT5Vi"),d=s("ddiTx"),p=s("7yUGY"),h=s("81VW3"),v=s("imkHR"),g=s("9ig5K"),m=s("7tkqA"),y=s("9t3Va"),x=s("euQv8"),b=s("cB2pD"),k=s("730hp");function w(e,t,n,s,l,f){var d=[[c.default,1,o.durationSecond],[c.default,5,5*o.durationSecond],[c.default,15,15*o.durationSecond],[c.default,30,30*o.durationSecond],[f,1,o.durationMinute],[f,5,5*o.durationMinute],[f,15,15*o.durationMinute],[f,30,30*o.durationMinute],[l,1,o.durationHour],[l,3,3*o.durationHour],[l,6,6*o.durationHour],[l,12,12*o.durationHour],[s,1,o.durationDay],[s,2,2*o.durationDay],[n,1,o.durationWeek],[t,1,o.durationMonth],[t,3,3*o.durationMonth],[e,1,o.durationYear]];function p(t,n,s){var c=Math.abs(n-t)/s,l=a.default((function(e){return r.default(e,3)[2]})).right(d,c);if(l===d.length)return e.every(i.tickStep(t/o.durationYear,n/o.durationYear,s));if(0===l)return u.default.every(Math.max(i.tickStep(t,n,s),1));var f=r.default(d[c/d[l-1][2]<d[l][2]/c?l-1:l],2),p=f[0],h=f[1];return p.every(h)}return[function(e,t,n){var r,a=t<e;a&&(e=(r=[t,e])[0],t=r[1]);var i=n&&"function"==typeof n.range?n:p(e,t,n),o=i?i.range(e,+t+1):[];return a?o.reverse():o},p]}var A=r.default(w(k.default,b.default,x.utcSunday,y.default,m.default,g.default),2),E=A[0],C=A[1],S=r.default(w(v.default,h.default,p.sunday,d.default,f.default,l.default),2),N=S[0],T=S[1]})),s.register("3iupp",(function(e,t){n(e.exports,"timeFormat",(function(){return a})),n(e.exports,"timeParse",(function(){return i})),n(e.exports,"utcFormat",(function(){return o})),n(e.exports,"utcParse",(function(){return u}));var r,a,i,o,u,c,l=s("5rlIi");c={dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},r=l.default(c),a=r.format,i=r.parse,o=r.utcFormat,u=r.utcParse})),s.register("5rlIi",(function(e,t){n(e.exports,"default",(function(){return p}));var r=s("euQv8"),a=s("9t3Va"),i=s("7yUGY"),o=s("ddiTx"),u=s("imkHR"),c=s("730hp");function l(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function f(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function d(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function p(e){var t=e.dateTime,n=e.date,u=e.time,s=e.periods,c=e.days,p=e.shortDays,v=e.months,g=e.shortMonths,m=b(s),y=k(s),x=b(c),$=k(c),xe=b(p),Oe=k(p),_e=b(v),Ie=k(v),Re=b(g),Me=k(g),Be={a:function(e){return p[e.getDay()]},A:function(e){return c[e.getDay()]},b:function(e){return g[e.getMonth()]},B:function(e){return v[e.getMonth()]},c:null,d:V,e:V,f:J,g:ae,G:oe,H:W,I:G,j:H,L:q,m:K,M:X,p:function(e){return s[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:De,s:Fe,S:Y,u:Q,U:Z,V:ee,w:te,W:ne,x:null,X:null,y:re,Y:ie,Z:ue,"%":Te},Pe={a:function(e){return p[e.getUTCDay()]},A:function(e){return c[e.getUTCDay()]},b:function(e){return g[e.getUTCMonth()]},B:function(e){return v[e.getUTCMonth()]},c:null,d:se,e:se,f:pe,g:Ee,G:Se,H:ce,I:le,j:fe,L:de,m:he,M:ve,p:function(e){return s[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:De,s:Fe,S:ge,u:me,U:ye,V:be,w:ke,W:we,x:null,X:null,y:Ae,Y:Ce,Z:Ne,"%":Te},Le={a:function(e,t,n){var r=xe.exec(t.slice(n));return r?(e.w=Oe.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(e,t,n){var r=x.exec(t.slice(n));return r?(e.w=$.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(e,t,n){var r=Re.exec(t.slice(n));return r?(e.m=Me.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(e,t,n){var r=_e.exec(t.slice(n));return r?(e.m=Ie.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(e,n,r){return Ue(e,t,n,r)},d:_,e:_,f:L,g:T,G:N,H:R,I:R,j:I,L:P,m:O,M:M,p:function(e,t,n){var r=m.exec(t.slice(n));return r?(e.p=y.get(r[0].toLowerCase()),n+r[0].length):-1},q:F,Q:z,s:U,S:B,u:A,U:E,V:C,w:w,W:S,x:function(e,t,r){return Ue(e,n,t,r)},X:function(e,t,n){return Ue(e,u,t,n)},y:T,Y:N,Z:D,"%":j};function je(e,t){return function(n){var r,a,i,o=[],u=-1,s=0,c=e.length;for(n instanceof Date||(n=new Date(+n));++u<c;)37===e.charCodeAt(u)&&(o.push(e.slice(s,u)),null!=(a=h[r=e.charAt(++u)])?r=e.charAt(++u):a="e"===r?" ":"0",(i=t[r])&&(r=i(n,a)),o.push(r),s=u+1);return o.push(e.slice(s,u)),o.join("")}}function ze(e,t){return function(n){var u,s,c=d(1900,void 0,1);if(Ue(c,e,n+="",0)!=n.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(t&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(s=(u=f(d(c.y,0,1))).getUTCDay(),u=s>4||0===s?r.utcMonday.ceil(u):r.utcMonday(u),u=a.default.offset(u,7*(c.V-1)),c.y=u.getUTCFullYear(),c.m=u.getUTCMonth(),c.d=u.getUTCDate()+(c.w+6)%7):(s=(u=l(d(c.y,0,1))).getDay(),u=s>4||0===s?i.monday.ceil(u):i.monday(u),u=o.default.offset(u,7*(c.V-1)),c.y=u.getFullYear(),c.m=u.getMonth(),c.d=u.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),s="Z"in c?f(d(c.y,0,1)).getUTCDay():l(d(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(s+5)%7:c.w+7*c.U-(s+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,f(c)):l(c)}}function Ue(e,t,n,r){for(var a,i,o=0,u=t.length,s=n.length;o<u;){if(r>=s)return-1;if(37===(a=t.charCodeAt(o++))){if(a=t.charAt(o++),!(i=Le[a in h?t.charAt(o++):a])||(r=i(e,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return Be.x=je(n,Be),Be.X=je(u,Be),Be.c=je(t,Be),Pe.x=je(n,Pe),Pe.X=je(u,Pe),Pe.c=je(t,Pe),{format:function(e){var t=je(e+="",Be);return t.toString=function(){return e},t},parse:function(e){var t=ze(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=je(e+="",Pe);return t.toString=function(){return e},t},utcParse:function(e){var t=ze(e+="",!0);return t.toString=function(){return e},t}}}var h={"-":"",_:" ",0:"0"},v=/^\s*\d+/,g=/^%/,m=/[\\^$*+?|[\]().{}]/g;function y(e,t,n){var r=e<0?"-":"",a=(r?-e:e)+"",i=a.length;return r+(i<n?new Array(n-i+1).join(t)+a:a)}function x(e){return e.replace(m,"\\$&")}function b(e){return new RegExp("^(?:"+e.map(x).join("|")+")","i")}function k(e){return new Map(e.map((function(e,t){return[e.toLowerCase(),t]})))}function w(e,t,n){var r=v.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function A(e,t,n){var r=v.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function E(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function C(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function S(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function N(e,t,n){var r=v.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function T(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function D(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function F(e,t,n){var r=v.exec(t.slice(n,n+1));return r?(e.q=3*r[0]-3,n+r[0].length):-1}function O(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function _(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function I(e,t,n){var r=v.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function R(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function M(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function B(e,t,n){var r=v.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function P(e,t,n){var r=v.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function L(e,t,n){var r=v.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function j(e,t,n){var r=g.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function z(e,t,n){var r=v.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function U(e,t,n){var r=v.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function V(e,t){return y(e.getDate(),t,2)}function W(e,t){return y(e.getHours(),t,2)}function G(e,t){return y(e.getHours()%12||12,t,2)}function H(e,t){return y(1+o.default.count(u.default(e),e),t,3)}function q(e,t){return y(e.getMilliseconds(),t,3)}function J(e,t){return q(e,t)+"000"}function K(e,t){return y(e.getMonth()+1,t,2)}function X(e,t){return y(e.getMinutes(),t,2)}function Y(e,t){return y(e.getSeconds(),t,2)}function Q(e){var t=e.getDay();return 0===t?7:t}function Z(e,t){return y(i.sunday.count(u.default(e)-1,e),t,2)}function $(e){var t=e.getDay();return t>=4||0===t?i.thursday(e):i.thursday.ceil(e)}function ee(e,t){return e=$(e),y(i.thursday.count(u.default(e),e)+(4===u.default(e).getDay()),t,2)}function te(e){return e.getDay()}function ne(e,t){return y(i.monday.count(u.default(e)-1,e),t,2)}function re(e,t){return y(e.getFullYear()%100,t,2)}function ae(e,t){return y((e=$(e)).getFullYear()%100,t,2)}function ie(e,t){return y(e.getFullYear()%1e4,t,4)}function oe(e,t){var n=e.getDay();return y((e=n>=4||0===n?i.thursday(e):i.thursday.ceil(e)).getFullYear()%1e4,t,4)}function ue(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+y(t/60|0,"0",2)+y(t%60,"0",2)}function se(e,t){return y(e.getUTCDate(),t,2)}function ce(e,t){return y(e.getUTCHours(),t,2)}function le(e,t){return y(e.getUTCHours()%12||12,t,2)}function fe(e,t){return y(1+a.default.count(c.default(e),e),t,3)}function de(e,t){return y(e.getUTCMilliseconds(),t,3)}function pe(e,t){return de(e,t)+"000"}function he(e,t){return y(e.getUTCMonth()+1,t,2)}function ve(e,t){return y(e.getUTCMinutes(),t,2)}function ge(e,t){return y(e.getUTCSeconds(),t,2)}function me(e){var t=e.getUTCDay();return 0===t?7:t}function ye(e,t){return y(r.utcSunday.count(c.default(e)-1,e),t,2)}function xe(e){var t=e.getUTCDay();return t>=4||0===t?r.utcThursday(e):r.utcThursday.ceil(e)}function be(e,t){return e=xe(e),y(r.utcThursday.count(c.default(e),e)+(4===c.default(e).getUTCDay()),t,2)}function ke(e){return e.getUTCDay()}function we(e,t){return y(r.utcMonday.count(c.default(e)-1,e),t,2)}function Ae(e,t){return y(e.getUTCFullYear()%100,t,2)}function Ee(e,t){return y((e=xe(e)).getUTCFullYear()%100,t,2)}function Ce(e,t){return y(e.getUTCFullYear()%1e4,t,4)}function Se(e,t){var n=e.getUTCDay();return y((e=n>=4||0===n?r.utcThursday(e):r.utcThursday.ceil(e)).getUTCFullYear()%1e4,t,4)}function Ne(){return"+0000"}function Te(){return"%"}function De(e){return+e}function Fe(e){return Math.floor(+e/1e3)}})),s.register("1OL6m",(function(e,t){n(e.exports,"aggregate",(function(){return F})),n(e.exports,"bin",(function(){return O})),n(e.exports,"collect",(function(){return I})),n(e.exports,"compare",(function(){return R})),n(e.exports,"countpattern",(function(){return B})),n(e.exports,"cross",(function(){return P})),n(e.exports,"density",(function(){return U})),n(e.exports,"dotbin",(function(){return q})),n(e.exports,"expression",(function(){return J})),n(e.exports,"extent",(function(){return X})),n(e.exports,"subflow",(function(){return Y})),n(e.exports,"facet",(function(){return Q})),n(e.exports,"field",(function(){return Z})),n(e.exports,"filter",(function(){return ee})),n(e.exports,"flatten",(function(){return te})),n(e.exports,"fold",(function(){return ne})),n(e.exports,"formula",(function(){return re})),n(e.exports,"generate",(function(){return ae})),n(e.exports,"impute",(function(){return ue})),n(e.exports,"joinaggregate",(function(){return se})),n(e.exports,"kde",(function(){return ce})),n(e.exports,"key",(function(){return le})),n(e.exports,"load",(function(){return de})),n(e.exports,"lookup",(function(){return he})),n(e.exports,"multiextent",(function(){return ve})),n(e.exports,"multivalues",(function(){return me})),n(e.exports,"params",(function(){return xe})),n(e.exports,"pivot",(function(){return be})),n(e.exports,"prefacet",(function(){return ke})),n(e.exports,"project",(function(){return we})),n(e.exports,"proxy",(function(){return Ae})),n(e.exports,"quantile",(function(){return Ee})),n(e.exports,"relay",(function(){return Ce})),n(e.exports,"sample",(function(){return Se})),n(e.exports,"sequence",(function(){return Ne})),n(e.exports,"sieve",(function(){return Te})),n(e.exports,"timeunit",(function(){return De})),n(e.exports,"tupleindex",(function(){return Oe})),n(e.exports,"values",(function(){return _e})),n(e.exports,"window",(function(){return Pe})),s("1i51P");var r=s("5lcaY"),a=s("caNzv"),i=s("euljU"),o=s("3okBY"),u=s("lUWZp"),c=s("dxL8E"),l=s("3FUhS"),f=s("5wp2C"),d=s("jTUhZ"),p=s("9ZJHk"),h=s("2U08m");function v(e){return e&&e.length?1===e.length?e[0]:(t=e,function(e){for(var n=t.length,r=1,a=String(t[0](e));r<n;++r)a+="|"+t[r](e);return a}):function(){return""};var t}function g(e,t,n){return n||e+(t?"_"+t:"")}var m=function(){},y={init:m,add:m,rem:m,idx:0},x={values:{init:function(e){return e.cell.store=!0},value:function(e){return e.cell.data.values()},idx:-1},count:{value:function(e){return e.cell.num}},__count__:{value:function(e){return e.missing+e.valid}},missing:{value:function(e){return e.missing}},valid:{value:function(e){return e.valid}},sum:{init:function(e){return e.sum=0},value:function(e){return e.sum},add:function(e,t){return e.sum+=+t},rem:function(e,t){return e.sum-=t}},product:{init:function(e){return e.product=1},value:function(e){return e.valid?e.product:void 0},add:function(e,t){return e.product*=t},rem:function(e,t){return e.product/=t}},mean:{init:function(e){return e.mean=0},value:function(e){return e.valid?e.mean:void 0},add:function(e,t){return e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:function(e,t){return e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}},average:{value:function(e){return e.valid?e.mean:void 0},req:["mean"],idx:1},variance:{init:function(e){return e.dev=0},value:function(e){return e.valid>1?e.dev/(e.valid-1):void 0},add:function(e,t){return e.dev+=e.mean_d*(t-e.mean)},rem:function(e,t){return e.dev-=e.mean_d*(t-e.mean)},req:["mean"],idx:1},variancep:{value:function(e){return e.valid>1?e.dev/e.valid:void 0},req:["variance"],idx:2},stdev:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid-1)):void 0},req:["variance"],idx:2},stdevp:{value:function(e){return e.valid>1?Math.sqrt(e.dev/e.valid):void 0},req:["variance"],idx:2},stderr:{value:function(e){return e.valid>1?Math.sqrt(e.dev/(e.valid*(e.valid-1))):void 0},req:["variance"],idx:2},distinct:{value:function(e){return e.cell.data.distinct(e.get)},req:["values"],idx:3},ci0:{value:function(e){return e.cell.data.ci0(e.get)},req:["values"],idx:3},ci1:{value:function(e){return e.cell.data.ci1(e.get)},req:["values"],idx:3},median:{value:function(e){return e.cell.data.q2(e.get)},req:["values"],idx:3},q1:{value:function(e){return e.cell.data.q1(e.get)},req:["values"],idx:3},q3:{value:function(e){return e.cell.data.q3(e.get)},req:["values"],idx:3},min:{init:function(e){return e.min=void 0},value:function(e){return e.min=Number.isNaN(e.min)?e.cell.data.min(e.get):e.min},add:function(e,t){(t<e.min||void 0===e.min)&&(e.min=t)},rem:function(e,t){t<=e.min&&(e.min=NaN)},req:["values"],idx:4},max:{init:function(e){return e.max=void 0},value:function(e){return e.max=Number.isNaN(e.max)?e.cell.data.max(e.get):e.max},add:function(e,t){(t>e.max||void 0===e.max)&&(e.max=t)},rem:function(e,t){t>=e.max&&(e.max=NaN)},req:["values"],idx:4},argmin:{init:function(e){return e.argmin=void 0},value:function(e){return e.argmin||e.cell.data.argmin(e.get)},add:function(e,t,n){t<e.min&&(e.argmin=n)},rem:function(e,t){t<=e.min&&(e.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:function(e){return e.argmax=void 0},value:function(e){return e.argmax||e.cell.data.argmax(e.get)},add:function(e,t,n){t>e.max&&(e.argmax=n)},rem:function(e,t){t>=e.max&&(e.argmax=void 0)},req:["max","values"],idx:3}},b=Object.keys(x);function k(e,t){return x[e](t)}function w(e,t){return e.idx-t.idx}function A(){var e=this;this.valid=0,this.missing=0,this._ops.forEach((function(t){return t.init(e)}))}function E(e,t){var n=this;null!=e&&""!==e?e==e&&(++this.valid,this._ops.forEach((function(r){return r.add(n,e,t)}))):++this.missing}function C(e,t){var n=this;null!=e&&""!==e?e==e&&(--this.valid,this._ops.forEach((function(r){return r.rem(n,e,t)}))):--this.missing}function S(e){var t=this;return this._out.forEach((function(n){return e[n.out]=n.value(t)})),e}function N(e,t){var n=t||a.identity,r=function(e){var t={};e.forEach((function(e){return t[e.name]=e}));var n=function(e){e.req&&e.req.forEach((function(e){t[e]||n(t[e]=x[e]())}))};return e.forEach(n),Object.values(t).sort(w)}(e),i=e.slice().sort(w);function o(e){this._ops=r,this._out=i,this.cell=e,this.init()}return o.prototype.init=A,o.prototype.add=E,o.prototype.rem=C,o.prototype.set=S,o.prototype.get=n,o.fields=e.map((function(e){return e.out})),o}function T(e){this._key=e?a.field(e):i.tupleid,this.reset()}b.forEach((function(e){x[e]=function(e,t){return function(n){return a.extend({name:e,out:n||e},y,t)}}(e,x[e])}));var D=T.prototype;function F(e){i.Transform.call(this,null,e),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}D.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},D.add=function(e){this._add.push(e)},D.rem=function(e){this._rem.push(e)},D.values=function(){if(this._get=null,0===this._rem.length)return this._add;var e,t,n,r=this._add,a=this._rem,i=this._key,o=r.length,u=a.length,s=Array(o-u),c={};for(e=0;e<u;++e)c[i(a[e])]=1;for(e=0,t=0;e<o;++e)c[i(n=r[e])]?c[i(n)]=0:s[t++]=n;return this._rem=[],this._add=s},D.distinct=function(e){for(var t,n=this.values(),r={},i=n.length,o=0;--i>=0;)t=e(n[i])+"",a.hasOwnProperty(r,t)||(r[t]=1,++o);return o},D.extent=function(e){if(this._get!==e||!this._ext){var t=this.values(),n=a.extentIndex(t,e);this._ext=[t[n[0]],t[n[1]]],this._get=e}return this._ext},D.argmin=function(e){return this.extent(e)[0]||{}},D.argmax=function(e){return this.extent(e)[1]||{}},D.min=function(e){var t=this.extent(e)[0];return null!=t?e(t):void 0},D.max=function(e){var t=this.extent(e)[1];return null!=t?e(t):void 0},D.quartile=function(e){return this._get===e&&this._q||(this._q=o.quartiles(this.values(),e),this._get=e),this._q},D.q1=function(e){return this.quartile(e)[0]},D.q2=function(e){return this.quartile(e)[1]},D.q3=function(e){return this.quartile(e)[2]},D.ci=function(e){return this._get===e&&this._ci||(this._ci=o.bootstrapCI(this.values(),1e3,.05,e),this._get=e),this._ci},D.ci0=function(e){return this.ci(e)[0]},D.ci1=function(e){return this.ci(e)[1]},F.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:b},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},a.inherits(F,i.Transform,{transform:function(e,t){var n=this,r=this,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.modified();return r.stamp=a.stamp,r.value&&(i||t.modified(r._inputs,!0))?(r._prev=r.value,r.value=i?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(r.value=r.value||r.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),a.modifies(r._outputs),r._drop=!1!==e.drop,e.cross&&r._dims.length>1&&(r._drop=!1,r.cross()),t.clean()&&r._drop&&a.clean(!0).runAfter((function(){return n.clean()})),r.changes(a)},cross:function(){var e=this,t=e.value,n=e._dnames,r=n.map((function(){return{}})),a=n.length;function i(e){var t,i,o,u;for(t in e)for(o=e[t].tuple,i=0;i<a;++i)r[i][u=o[n[i]]]=u}i(e._prev),i(t),function i(o,u,s){var c=n[s],l=r[s++];for(var f in l){var d=o?o+"|"+f:f;u[c]=l[f],s<a?i(d,u,s):t[d]||e.cell(d,u)}}("",{},0)},init:function(e){var t=this._inputs=[],n=this._outputs=[],r={};function i(e){for(var n,i=a.array(a.accessorFields(e)),o=i.length,u=0;u<o;++u)r[n=i[u]]||(r[n]=1,t.push(n))}this._dims=a.array(e.groupby),this._dnames=this._dims.map((function(e){var t=a.accessorName(e);return i(e),n.push(t),t})),this.cellkey=e.key?e.key:v(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];var o,u,s,c,l,f,d=e.fields||[null],p=e.ops||["count"],h=e.as||[],m=d.length,y={};for(m!==p.length&&a.error("Unmatched number of fields and aggregate ops."),f=0;f<m;++f)o=d[f],u=p[f],null==o&&"count"!==u&&a.error("Null aggregate field specified."),l=g(u,c=a.accessorName(o),h[f]),n.push(l),"count"!==u?((s=y[c])||(i(o),(s=y[c]=[]).field=o,this._measures.push(s)),"count"!==u&&(this._countOnly=!1),s.push(k(u,l))):this._counts.push(l);return this._measures=this._measures.map((function(e){return N(e,e.field)})),{}},cellkey:v(),cell:function(e,t){var n=this.value[e];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[e]=this.newcell(e,t),this._adds[this._alen++]=n),n},newcell:function(e,t){var n={key:e,num:0,agg:null,tuple:this.newtuple(t,this._prev&&this._prev[e]),stamp:this.stamp,store:!1};if(!this._countOnly){var r=this._measures,a=r.length;n.agg=Array(a);for(var i=0;i<a;++i)n.agg[i]=new r[i](n)}return n.store&&(n.data=new T),n},newtuple:function(e,t){for(var n=this._dnames,r=this._dims,a=r.length,o={},u=0;u<a;++u)o[n[u]]=r[u](e);return t?i.replace(t.tuple,o):i.ingest(o)},clean:function(){var e=this.value;for(var t in e)0===e[t].num&&delete e[t]},add:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num+=1,!this._countOnly){n.store&&n.data.add(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].add(r[a].get(e),e)}},rem:function(e){var t=this.cellkey(e),n=this.cell(t,e);if(n.num-=1,!this._countOnly){n.store&&n.data.rem(e);for(var r=n.agg,a=0,i=r.length;a<i;++a)r[a].rem(r[a].get(e),e)}},celltuple:function(e){var t=e.tuple,n=this._counts;e.store&&e.data.values();for(var r=0,a=n.length;r<a;++r)t[n[r]]=e.num;if(!this._countOnly)for(var i=e.agg,o=0,u=i.length;o<u;++o)i[o].set(t);return t},changes:function(e){var t,n,r,a,i=this._adds,o=this._mods,u=this._prev,s=this._drop,c=e.add,l=e.rem,f=e.mod;if(u)for(n in u)t=u[n],s&&!t.num||l.push(t.tuple);for(r=0,a=this._alen;r<a;++r)c.push(this.celltuple(i[r])),i[r]=null;for(r=0,a=this._mlen;r<a;++r)(0===(t=o[r]).num&&s?l:f).push(this.celltuple(t)),o[r]=null;return this._alen=this._mlen=0,this._prev=null,e}});function O(e){i.Transform.call(this,null,e)}function _(e,t,n){var r=e,i=t||[],o=n||[],u={},s=0;return{add:function(e){return o.push(e)},remove:function(e){return u[r(e)]=++s},size:function(){return i.length},data:function(e,t){return s&&(i=i.filter((function(e){return!u[r(e)]})),u={},s=0),t&&e&&i.sort(e),o.length&&(i=e?a.merge(e,i,o.sort(e)):i.concat(o),o=[]),i}}}function I(e){i.Transform.call(this,[],e)}function R(e){i.Operator.call(this,null,M,e)}function M(e){return this.value&&!e.modified()?this.value:a.compare(e.fields,e.orders)}function B(e){i.Transform.call(this,null,e)}function P(e){i.Transform.call(this,null,e)}O.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},a.inherits(O,i.Transform,{transform:function(e,t){var n,r=!1!==e.interval,i=this._bins(e),o=i.start,u=i.step,s=e.as||["bin0","bin1"],c=s[0],l=s[1];return n=e.modified()?(t=t.reflow(!0)).SOURCE:t.modified(a.accessorFields(e.field))?t.ADD_MOD:t.ADD,t.visit(n,r?function(e){var t=i(e);e[c]=t,e[l]=null==t?null:o+u*(1+(t-o)/u)}:function(e){return e[c]=i(e)}),t.modifies(r?s:c)},_bins:function(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.field,i=o.bin(e),u=i.step,s=i.start,c=s+Math.ceil((i.stop-s)/u)*u;null!=(t=e.anchor)&&(n=t-(s+u*Math.floor((t-s)/u)),s+=n,c+=n);var l=function(e){var t=a.toNumber(r(e));return null==t?null:t<s?-1/0:t>c?1/0:(t=Math.max(s,Math.min(t,c-u)),s+u*Math.floor(1e-14+(t-s)/u))};return l.start=s,l.stop=i.stop,l.step=u,this.value=a.accessor(l,a.accessorFields(r),e.name||"bin_"+a.accessorName(r))}}),I.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},a.inherits(I,i.Transform,{transform:function(e,t){var n=t.fork(t.ALL),r=_(i.tupleid,this.value,n.materialize(n.ADD).add),a=e.sort,o=t.changed()||a&&(e.modified("sort")||t.modified(a.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(i.stableCompare(a),o),t.source&&t.source.root&&(this.value.root=t.source.root),n}}),a.inherits(R,i.Operator),B.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},a.inherits(B,i.Transform,{transform:function(e,t){var n=function(t){return function(n){for(var r,a=function(e,t,n){switch(t){case"upper":e=e.toUpperCase();break;case"lower":e=e.toLowerCase()}return e.match(n)}(u(n),e.case,i)||[],s=0,c=a.length;s<c;++s)o.test(r=a[s])||t(r)}},r=this._parameterCheck(e,t),a=this._counts,i=this._match,o=this._stop,u=e.field,s=e.as||["text","count"],c=n((function(e){return a[e]=1+(a[e]||0)})),l=n((function(e){return a[e]-=1}));return r?t.visit(t.SOURCE,c):(t.visit(t.ADD,c),t.visit(t.REM,l)),this._finish(t,s)},_parameterCheck:function(e,t){var n=!1;return!e.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(e.stopwords||"")+"$","i"),n=!0),!e.modified("pattern")&&this._match||(this._match=new RegExp(e.pattern||"[\\w']+","g"),n=!0),(e.modified("field")||t.modified(e.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish:function(e,t){var n,r,a,o=this._counts,u=this._tuples||(this._tuples={}),s=t[0],c=t[1],l=e.fork(e.NO_SOURCE|e.NO_FIELDS);for(n in o)r=u[n],a=o[n]||0,!r&&a?(u[n]=r=i.ingest({}),r[s]=n,r[c]=a,l.add.push(r)):0===a?(r&&l.rem.push(r),o[n]=null,u[n]=null):r[c]!==a&&(r[c]=a,l.mod.push(r));return l.modifies(t)}}),P.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},a.inherits(P,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.as||["a","b"],o=r[0],u=r[1],s=!this.value||t.changed(t.ADD_REM)||e.modified("as")||e.modified("filter"),c=this.value;return s?(c&&(n.rem=c),c=t.materialize(t.SOURCE).source,n.add=this.value=function(e,t,n,r){for(var a,o,u=[],s={},c=e.length,l=0;l<c;++l)for(s[t]=o=e[l],a=0;a<c;++a)s[n]=e[a],r(s)&&(u.push(i.ingest(s)),(s={})[t]=o);return u}(c,o,u,e.filter||a.truthy)):n.mod=c,n.source=this.value,n.modifies(r)}});var L={kde:o.randomKDE,mixture:o.randomMixture,normal:o.randomNormal,lognormal:o.randomLogNormal,uniform:o.randomUniform},j="function";function z(e,t){var n=e.function;a.hasOwnProperty(L,n)||a.error("Unknown distribution function: "+n);var i=L[n]();for(var o in e)"field"===o?i.data((e.from||t()).map(e[o])):"distributions"===o?i[o](e[o].map((function(e){return z(e,t)}))):r.default(i[o])===j&&i[o](e[o]);return i}function U(e){i.Transform.call(this,null,e)}var V=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],W={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:V},{name:"weights",type:"number",array:!0}]};function G(e,t){return e?e.map((function(e,n){return t[n]||a.accessorName(e)})):null}function H(e,t,n){var r,a,i,o,u,s,c=[],l=function(e){return e(o)};if(null==t)c.push(e.map(n));else for(r={},a=0,i=e.length;a<i;++a)o=e[a],(s=r[u=t.map(l)])||(r[u]=s=[],s.dims=u,c.push(s)),s.push(n(o));return c}U.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:V.concat(W)},{name:"as",type:"string",array:!0,default:["value","density"]}]},a.inherits(U,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=z(e.distribution,function(e){return function(){return e.materialize(e.SOURCE).source}}(t)),u=e.steps||e.minsteps||25,s=e.steps||e.maxsteps||200,c=e.method||"pdf";"pdf"!==c&&"cdf"!==c&&a.error("Invalid density method: "+c),e.extent||r.data||a.error("Missing density extent parameter."),c=r[c];var l=e.as||["value","density"],f=e.extent||a.extent(r.data()),d=o.sampleCurve(c,f,u,s).map((function(e){var t={};return t[l[0]]=e[0],t[l[1]]=e[1],i.ingest(t)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}});function q(e){i.Transform.call(this,null,e)}q.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]};function J(e){i.Operator.call(this,null,K,e),this.modified(!0)}function K(e){var t=e.expr;return this.value&&!e.modified("expr")?this.value:a.accessor((function(n){return t(n,e)}),a.accessorFields(t),a.accessorName(t))}function X(e){i.Transform.call(this,[void 0,void 0],e)}function Y(e,t){i.Operator.call(this,e),this.parent=t,this.count=0}function Q(e){i.Transform.call(this,{},e),this._keys=a.fastmap();var t=this._targets=[];t.active=0,t.forEach=function(e){for(var n=0,r=t.active;n<r;++n)e(t[n],n,t)}}function Z(e){i.Operator.call(this,null,$,e)}function $(e){return this.value&&!e.modified()?this.value:a.isArray(e.name)?a.array(e.name).map((function(e){return a.field(e)})):a.field(e.name,e.as)}function ee(e){i.Transform.call(this,a.fastmap(),e)}function te(e){i.Transform.call(this,[],e)}function ne(e){i.Transform.call(this,[],e)}function re(e){i.Transform.call(this,null,e)}function ae(e){i.Transform.call(this,[],e)}a.inherits(q,i.Transform,{transform:function(e,t){if(this.value&&!e.modified()&&!t.changed())return t;for(var n,r=t.materialize(t.SOURCE).source,u=H(t.source,e.groupby,a.identity),s=e.smooth||!1,c=e.field,l=e.step||function(e,t){return a.span(a.extent(e,t))/30}(r,c),f=i.stableCompare((function(e,t){return c(e)-c(t)})),d=e.as||"bin",p=u.length,h=1/0,v=-1/0,g=0;g<p;++g){var m=u[g].sort(f);n=-1;var y=!0,x=!1,b=void 0;try{for(var k,w=o.dotbin(m,l,s,c)[Symbol.iterator]();!(y=(k=w.next()).done);y=!0){var A=k.value;A<h&&(h=A),A>v&&(v=A),m[++n][d]=A}}catch(e){x=!0,b=e}finally{try{y||null==w.return||w.return()}finally{if(x)throw b}}}return this.value={start:h,stop:v,step:l},t.reflow(!0).modifies(d)}}),a.inherits(J,i.Operator),X.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},a.inherits(X,i.Transform,{transform:function(e,t){var n=this.value,r=e.field,i=t.changed()||t.modified(r.fields)||e.modified("field"),o=n[0],u=n[1];if((i||null==o)&&(o=1/0,u=-1/0),t.visit(i?t.SOURCE:t.ADD,(function(e){var t=a.toNumber(r(e));null!=t&&(t<o&&(o=t),t>u&&(u=t))})),!Number.isFinite(o)||!Number.isFinite(u)){var s=a.accessorName(r);s&&(s=' for field "'.concat(s,'"')),t.dataflow.warn("Infinite extent".concat(s,": [").concat(o,", ").concat(u,"]")),o=u=void 0}this.value=[o,u]}}),a.inherits(Y,i.Operator,{connect:function(e){return this.detachSubflow=e.detachSubflow,this.targets().add(e),e.source=this},add:function(e){this.count+=1,this.value.add.push(e)},rem:function(e){this.count-=1,this.value.rem.push(e)},mod:function(e){this.value.mod.push(e)},init:function(e){this.value.init(e,e.NO_SOURCE)},evaluate:function(){return this.value}}),a.inherits(Q,i.Transform,{activate:function(e){this._targets[this._targets.active++]=e},subflow:function(e,t,n,r){var i,o,u=this.value,s=a.hasOwnProperty(u,e)&&u[e];return s?s.value.stamp<n.stamp&&(s.init(n),this.activate(s)):(o=r||(o=this._group[e])&&o.tuple,i=n.dataflow,s=new Y(n.fork(n.NO_SOURCE),this),i.add(s).connect(t(i,e,o)),u[e]=s,this.activate(s)),s},clean:function(){var e=this.value,t=0;for(var n in e)if(0===e[n].count){var r=e[n].detachSubflow;r&&r(),delete e[n],++t}if(t){var a=this._targets.filter((function(e){return e&&e.count>0}));this.initTargets(a)}},initTargets:function(e){for(var t=this._targets,n=t.length,r=e?e.length:0,a=0;a<r;++a)t[a]=e[a];for(;a<n&&null!=t[a];++a)t[a]=null;t.active=r},transform:function(e,t){var n=this,r=t.dataflow,a=e.key,o=e.subflow,u=this._keys,s=e.modified("key"),c=function(e){return n.subflow(e,o,t)};return this._group=e.group||{},this.initTargets(),t.visit(t.REM,(function(e){var t=i.tupleid(e),n=u.get(t);void 0!==n&&(u.delete(t),c(n).rem(e))})),t.visit(t.ADD,(function(e){var t=a(e);u.set(i.tupleid(e),t),c(t).add(e)})),s||t.modified(a.fields)?t.visit(t.MOD,(function(e){var t=i.tupleid(e),n=u.get(t),r=a(e);n===r?c(r).mod(e):(u.set(t,r),c(n).rem(e),c(r).add(e))})):t.changed(t.MOD)&&t.visit(t.MOD,(function(e){c(u.get(i.tupleid(e))).mod(e)})),s&&t.visit(t.REFLOW,(function(e){var t=i.tupleid(e),n=u.get(t),r=a(e);n!==r&&(u.set(t,r),c(n).rem(e),c(r).add(e))})),t.clean()?r.runAfter((function(){n.clean(),u.clean()})):u.empty>r.cleanThreshold&&r.runAfter(u.clean),t}}),a.inherits(Z,i.Operator),ee.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},a.inherits(ee,i.Transform,{transform:function(e,t){var n=t.dataflow,r=this.value,a=t.fork(),o=a.add,u=a.rem,s=a.mod,c=e.expr,l=!0;function f(t){var n=i.tupleid(t),a=c(t,e),f=r.get(n);a&&f?(r.delete(n),o.push(t)):a||f?l&&a&&!f&&s.push(t):(r.set(n,1),u.push(t))}return t.visit(t.REM,(function(e){var t=i.tupleid(e);r.has(t)?r.delete(t):u.push(e)})),t.visit(t.ADD,(function(t){c(t,e)?o.push(t):r.set(i.tupleid(t),1)})),t.visit(t.MOD,f),e.modified()&&(l=!1,t.visit(t.REFLOW,f)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),a}}),te.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},a.inherits(te,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,a=G(r,e.as||[]),o=e.index||null,u=a.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,s,c,l=r.map((function(t){return t(e)})),f=l.reduce((function(e,t){return Math.max(e,t.length)}),0),d=0;d<f;++d){for(s=i.derive(e),t=0;t<u;++t)s[a[t]]=null==(c=l[t][d])?null:c;o&&(s[o]=d),n.add.push(s)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(a)}}),ne.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},a.inherits(ne,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.fields,o=r.map(a.accessorName),u=e.as||["key","value"],s=u[0],c=u[1],l=r.length;return n.rem=this.value,t.visit(t.SOURCE,(function(e){for(var t,a=0;a<l;++a)(t=i.derive(e))[s]=o[a],t[c]=r[a](e),n.add.push(t)})),this.value=n.source=n.add,n.modifies(u)}}),re.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},a.inherits(re,i.Transform,{transform:function(e,t){var n=e.expr,r=e.as,a=e.modified(),i=e.initonly?t.ADD:a?t.SOURCE:t.modified(n.fields)||t.modified(r)?t.ADD_MOD:t.ADD;return a&&(t=t.materialize().reflow(!0)),e.initonly||t.modifies(r),t.visit(i,(function(t){return t[r]=n(t,e)}))}}),a.inherits(ae,i.Transform,{transform:function(e,t){var n,r,a,o=t.fork(t.ALL),u=e.generator,s=this.value,c=e.size-s.length;if(c>0){for(n=[];--c>=0;)n.push(a=i.ingest(u(e))),s.push(a);o.add=o.add.length?o.materialize(o.ADD).add.concat(n):n}else r=s.slice(0,-c),o.rem=o.rem.length?o.materialize(o.REM).rem.concat(r):r,s=s.slice(-c);return o.source=this.value=s,o}});var ie={value:"value",median:u.default,mean:c.default,min:l.default,max:f.default},oe=[];function ue(e){i.Transform.call(this,[],e)}function se(e){F.call(this,e)}function ce(e){i.Transform.call(this,null,e)}function le(e){i.Operator.call(this,null,fe,e)}function fe(e){return this.value&&!e.modified()?this.value:a.key(e.fields,e.flat)}function de(e){i.Transform.call(this,[],e),this._pending=null}function pe(e,t,n){n.forEach(i.ingest);var r=t.fork(t.NO_FIELDS&t.NO_SOURCE);return r.rem=e.value,e.value=r.source=r.add=n,e._pending=null,r.rem.length&&r.clean(!0),r}function he(e){i.Transform.call(this,{},e)}function ve(e){i.Operator.call(this,null,ge,e)}function ge(e){if(this.value&&!e.modified())return this.value;var t,n,r=e.extents,a=r.length,i=1/0,o=-1/0;for(t=0;t<a;++t)(n=r[t])[0]<i&&(i=n[0]),n[1]>o&&(o=n[1]);return[i,o]}function me(e){i.Operator.call(this,null,ye,e)}function ye(e){return this.value&&!e.modified()?this.value:e.values.reduce((function(e,t){return e.concat(t)}),[])}function xe(e){i.Transform.call(this,null,e)}function be(e){F.call(this,e)}function ke(e){Q.call(this,e)}function we(e){i.Transform.call(this,null,e)}function Ae(e){i.Transform.call(this,null,e)}function Ee(e){i.Transform.call(this,null,e)}ue.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},a.inherits(ue,i.Transform,{transform:function(e,t){var n,r,o,u,s,c,l,f,d,p,h=t.fork(t.ALL),v=function(e){var t,n=e.method||ie.value;if(null!=ie[n])return n===ie.value?(t=void 0!==e.value?e.value:0,function(){return t}):ie[n];a.error("Unrecognized imputation method: "+n)}(e),g=function(e){var t=e.field;return function(e){return e?t(e):NaN}}(e),m=a.accessorName(e.field),y=a.accessorName(e.key),x=(e.groupby||[]).map(a.accessorName),b=function(e,t,n,r){var a,i,o,u,s,c,l,f,d=function(e){return e(f)},p=[],h=r?r.slice():[],v={},g={};for(h.forEach((function(e,t){return v[e]=t+1})),u=0,l=e.length;u<l;++u)c=n(f=e[u]),s=v[c]||(v[c]=h.push(c)),(o=g[i=(a=t?t.map(d):oe)+""])||(o=g[i]=[],p.push(o),o.values=a),o[s-1]=f;return p.domain=h,p}(t.source,e.groupby,e.key,e.keyvals),k=[],w=this.value,A=b.domain.length;for(s=0,f=b.length;s<f;++s)for(o=(n=b[s]).values,r=NaN,l=0;l<A;++l)if(null==n[l]){for(u=b.domain[l],p={_impute:!0},c=0,d=o.length;c<d;++c)p[x[c]]=o[c];p[y]=u,p[m]=Number.isNaN(r)?r=v(n,g):r,k.push(i.ingest(p))}return k.length&&(h.add=h.materialize(h.ADD).add.concat(k)),w.length&&(h.rem=h.materialize(h.REM).rem.concat(w)),this.value=k,h}}),se.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:b},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},a.inherits(se,F,{transform:function(e,t){var n,r=this,i=e.modified();return r.value&&(i||t.modified(r._inputs,!0))?(n=r.value=i?r.init(e):{},t.visit(t.SOURCE,(function(e){return r.add(e)}))):(n=r.value=r.value||this.init(e),t.visit(t.REM,(function(e){return r.rem(e)})),t.visit(t.ADD,(function(e){return r.add(e)}))),r.changes(),t.visit(t.SOURCE,(function(e){a.extend(e,n[r.cellkey(e)].tuple)})),t.reflow(i).modifies(this._outputs)},changes:function(){var e,t,n=this._adds,r=this._mods;for(e=0,t=this._alen;e<t;++e)this.celltuple(n[e]),n[e]=null;for(e=0,t=this._mlen;e<t;++e)this.celltuple(r[e]),r[e]=null;this._alen=this._mlen=0}}),ce.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},a.inherits(ce,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var r=t.materialize(t.SOURCE).source,u=H(r,e.groupby,e.field),s=(e.groupby||[]).map(a.accessorName),c=e.bandwidth,l=e.cumulative?"cdf":"pdf",f=e.as||["value","density"],d=[],p=e.extent,h=e.steps||e.minsteps||25,v=e.steps||e.maxsteps||200;"pdf"!==l&&"cdf"!==l&&a.error("Invalid density method: "+l),"shared"===e.resolve&&(p||(p=a.extent(r,e.field)),h=v=e.steps||v),u.forEach((function(t){var n=o.randomKDE(t,c)[l],r=e.counts?t.length:1,u=p||a.extent(t);o.sampleCurve(n,u,h,v).forEach((function(e){for(var n={},a=0;a<s.length;++a)n[s[a]]=t.dims[a];n[f[0]]=e[0],n[f[1]]=e[1]*r,d.push(i.ingest(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=d}return n}}),a.inherits(le,i.Operator),a.inherits(de,i.Transform,{transform:function(e,t){var n=this,r=t.dataflow;if(this._pending)return pe(this,t,this._pending);if(function(e){return e.modified("async")&&!(e.modified("values")||e.modified("url")||e.modified("format"))}(e))return t.StopPropagation;if(e.values)return pe(this,t,r.parse(e.values,e.format));if(e.async){var i=this;return{async:r.request(e.url,e.format).then((function(e){var t=i;return i._pending=a.array(e.data),function(e){return e.touch(t)}}))}}return r.request(e.url,e.format).then((function(e){return pe(n,t,a.array(e.data))}))}}),he.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},a.inherits(he,i.Transform,{transform:function(e,t){var n,r,i=e.fields,o=e.index,u=e.values,s=null==e.default?null:e.default,c=e.modified(),l=i.length,f=c?t.SOURCE:t.ADD,d=t,p=e.as;return u?(r=u.length,l>1&&!p&&a.error('Multi-field lookup requires explicit "as" parameter.'),p&&p.length!==l*r&&a.error('The "as" parameter has too few output field names.'),p=p||u.map(a.accessorName),n=function(e){for(var t,n,a=0,c=0;a<l;++a)if(null==(n=o.get(i[a](e))))for(t=0;t<r;++t,++c)e[p[c]]=s;else for(t=0;t<r;++t,++c)e[p[c]]=u[t](n)}):(p||a.error("Missing output field names."),n=function(e){for(var t,n=0;n<l;++n)t=o.get(i[n](e)),e[p[n]]=null==t?s:t}),c?d=t.reflow(!0):f|=i.some((function(e){return t.modified(e.fields)}))?t.MOD:0,t.visit(f,n),d.modifies(p)}}),a.inherits(ve,i.Operator),a.inherits(me,i.Operator),a.inherits(xe,i.Transform,{transform:function(e,t){return this.modified(e.modified()),this.value=e,t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),be.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:b,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},a.inherits(be,F,{_transform:F.prototype.transform,transform:function(e,t){return this._transform(function(e,t){var n=e.field,r=e.value,i=("count"===e.op?"__count__":e.op)||"sum",o=a.accessorFields(n).concat(a.accessorFields(r)),u=function(e,t,n){var r={},i=[];return n.visit(n.SOURCE,(function(t){var n=e(t);r[n]||(r[n]=1,i.push(n))})),i.sort(a.ascending),t?i.slice(0,t):i}(n,e.limit||0,t);t.changed()&&e.set("__pivot__",null,null,!0);return{key:e.key,groupby:e.groupby,ops:u.map((function(){return i})),fields:u.map((function(e){return function(e,t,n,r){return a.accessor((function(r){return t(r)===e?n(r):NaN}),r,e+"")}(e,n,r,o)})),as:u.map((function(e){return e+""})),modified:e.modified.bind(e)}}(e,t),t)}}),a.inherits(ke,Q,{transform:function(e,t){var n=this,r=e.subflow,o=e.field,u=function(e){return n.subflow(i.tupleid(e),r,t,e)};return(e.modified("field")||o&&t.modified(a.accessorFields(o)))&&a.error("PreFacet does not support field modification."),this.initTargets(),o?(t.visit(t.MOD,(function(e){var t=u(e);o(e).forEach((function(e){return t.mod(e)}))})),t.visit(t.ADD,(function(e){var t=u(e);o(e).forEach((function(e){return t.add(i.ingest(e))}))})),t.visit(t.REM,(function(e){var t=u(e);o(e).forEach((function(e){return t.rem(e)}))}))):(t.visit(t.MOD,(function(e){return u(e).mod(e)})),t.visit(t.ADD,(function(e){return u(e).add(e)})),t.visit(t.REM,(function(e){return u(e).rem(e)}))),t.clean()&&t.runAfter((function(){return n.clean()})),t}}),we.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},a.inherits(we,i.Transform,{transform:function(e,t){var n,r=t.fork(t.NO_SOURCE),a=e.fields,o=G(e.fields,e.as||[]),u=a?function(e,t){return function(e,t,n,r){for(var a=0,i=n.length;a<i;++a)t[r[a]]=n[a](e);return t}(e,t,a,o)}:i.rederive;return this.value?n=this.value:(t=t.addAll(),n=this.value={}),t.visit(t.REM,(function(e){var t=i.tupleid(e);r.rem.push(n[t]),n[t]=null})),t.visit(t.ADD,(function(e){var t=u(e,i.ingest({}));n[i.tupleid(e)]=t,r.add.push(t)})),t.visit(t.MOD,(function(e){r.mod.push(u(e,n[i.tupleid(e)]))})),r}}),a.inherits(Ae,i.Transform,{transform:function(e,t){return this.value=e.value,e.modified("value")?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}}),Ee.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]};function Ce(e){i.Transform.call(this,null,e)}function Se(e){i.Transform.call(this,[],e),this.count=0}function Ne(e){i.Transform.call(this,null,e)}function Te(e){i.Transform.call(this,null,e),this.modified(!0)}function De(e){i.Transform.call(this,null,e)}a.inherits(Ee,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),r=e.as||["prob","value"];if(this.value&&!e.modified()&&!t.changed())return n.source=this.value,n;var u=H(t.materialize(t.SOURCE).source,e.groupby,e.field),s=(e.groupby||[]).map(a.accessorName),c=[],l=e.step||.01,f=e.probs||d.default(l/2,1-1e-14,l),p=f.length;return u.forEach((function(e){for(var t=o.quantiles(e,f),n=0;n<p;++n){for(var a={},u=0;u<s.length;++u)a[s[u]]=e.dims[u];a[r[0]]=f[n],a[r[1]]=t[n],c.push(i.ingest(a))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c,n}}),a.inherits(Ce,i.Transform,{transform:function(e,t){var n,r;return this.value?r=this.value:(n=t=t.addAll(),r=this.value={}),e.derive&&(n=t.fork(t.NO_SOURCE),t.visit(t.REM,(function(e){var t=i.tupleid(e);n.rem.push(r[t]),r[t]=null})),t.visit(t.ADD,(function(e){var t=i.derive(e);r[i.tupleid(e)]=t,n.add.push(t)})),t.visit(t.MOD,(function(e){var t=r[i.tupleid(e)];for(var a in e)t[a]=e[a],n.modifies(a);n.mod.push(t)}))),n}}),Se.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},a.inherits(Se,i.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE),r=e.modified("size"),a=e.size,u=this.value.reduce((function(e,t){return e[i.tupleid(t)]=1,e}),{}),s=this.value,c=this.count,l=0;function f(e){var t,r;s.length<a?s.push(e):(r=~~((c+1)*o.random()))<s.length&&r>=l&&(t=s[r],u[i.tupleid(t)]&&n.rem.push(t),s[r]=e),++c}if(t.rem.length&&(t.visit(t.REM,(function(e){var t=i.tupleid(e);u[t]&&(u[t]=-1,n.rem.push(e)),--c})),s=s.filter((function(e){return-1!==u[i.tupleid(e)]}))),(t.rem.length||r)&&s.length<a&&t.source&&(l=c=s.length,t.visit(t.SOURCE,(function(e){u[i.tupleid(e)]||f(e)})),l=-1),r&&s.length>a){for(var d=s.length-a,p=0;p<d;++p)u[i.tupleid(s[p])]=-1,n.rem.push(s[p]);s=s.slice(d)}return t.mod.length&&t.visit(t.MOD,(function(e){u[i.tupleid(e)]&&n.mod.push(e)})),t.add.length&&t.visit(t.ADD,f),(t.add.length||l<0)&&(n.add=s.filter((function(e){return!u[i.tupleid(e)]}))),this.count=c,this.value=n.source=s,n}}),Ne.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},a.inherits(Ne,i.Transform,{transform:function(e,t){if(!this.value||e.modified()){var n=t.materialize().fork(t.MOD),r=e.as||"data";return n.rem=this.value?t.rem.concat(this.value):t.rem,this.value=d.default(e.start,e.stop,e.step||1).map((function(e){var t={};return t[r]=e,i.ingest(t)})),n.add=t.add.concat(this.value),n}}}),a.inherits(Te,i.Transform,{transform:function(e,t){return this.value=t.source,t.changed()?t.fork(t.NO_SOURCE|t.NO_FIELDS):t.StopPropagation}});var Fe=["unit0","unit1"];function Oe(e){i.Transform.call(this,a.fastmap(),e)}function _e(e){i.Transform.call(this,null,e)}De.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:h.TIME_UNITS,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Fe}]},a.inherits(De,i.Transform,{transform:function(e,t){var n=e.field,r=!1!==e.interval,i="utc"===e.timezone,o=this._floor(e,t),u=(i?h.utcInterval:h.timeInterval)(o.unit).offset,s=e.as||Fe,c=s[0],l=s[1],f=o.step,d=o.start||1/0,p=o.stop||-1/0,v=t.ADD;return(e.modified()||t.modified(a.accessorFields(n)))&&(v=(t=t.reflow(!0)).SOURCE,d=1/0,p=-1/0),t.visit(v,(function(e){var t,a,i=n(e);null==i?(e[c]=null,r&&(e[l]=null)):(e[c]=t=a=o(i),r&&(e[l]=a=u(t,f)),t<d&&(d=t),a>p&&(p=a))})),o.start=d,o.stop=p,t.modifies(r?s:c)},_floor:function(e,t){var n="utc"===e.timezone,r=e.units?{units:e.units,step:e.step||1}:h.timeBin({extent:e.extent||a.extent(t.materialize(t.SOURCE).source,e.field),maxbins:e.maxbins}),i=r.units,o=r.step,u=h.timeUnits(i),s=this.value||{},c=(n?h.utcFloor:h.timeFloor)(u,o);return c.unit=a.peek(u),c.units=u,c.step=o,c.start=s.start,c.stop=s.stop,this.value=c}}),a.inherits(Oe,i.Transform,{transform:function(e,t){var n=t.dataflow,r=e.field,a=this.value,i=function(e){return a.set(r(e),e)},o=!0;return e.modified("field")||t.modified(r.fields)?(a.clear(),t.visit(t.SOURCE,i)):t.changed()?(t.visit(t.REM,(function(e){return a.delete(r(e))})),t.visit(t.ADD,i)):o=!1,this.modified(o),a.empty>n.cleanThreshold&&n.runAfter(a.clean),t.fork()}}),a.inherits(_e,i.Transform,{transform:function(e,t){(!this.value||e.modified("field")||e.modified("sort")||t.changed()||e.sort&&t.modified(e.sort.fields))&&(this.value=(e.sort?t.source.slice().sort(i.stableCompare(e.sort)):t.source).map(e.field))}});var Ie={row_number:function(){return{next:function(e){return e.index+1}}},rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?e=n+1:e}}},dense_rank:function(){var e;return{init:function(){return e=1},next:function(t){var n=t.index,r=t.data;return n&&t.compare(r[n-1],r[n])?++e:e}}},percent_rank:function(){var e=Ie.rank(),t=e.next;return{init:e.init,next:function(e){return(t(e)-1)/(e.data.length-1)}}},cume_dist:function(){var e;return{init:function(){return e=0},next:function(t){var n=t.data,r=t.compare,a=t.index;if(e<a){for(;a+1<n.length&&!r(n[a],n[a+1]);)++a;e=a}return(1+e)/n.length}}},ntile:function(e,t){(t=+t)>0||a.error("ntile num must be greater than zero.");var n=Ie.cume_dist(),r=n.next;return{init:n.init,next:function(e){return Math.ceil(t*r(e))}}},lag:function(e,t){return t=+t||1,{next:function(n){var r=n.index-t;return r>=0?e(n.data[r]):null}}},lead:function(e,t){return t=+t||1,{next:function(n){var r=n.index+t,a=n.data;return r<a.length?e(a[r]):null}}},first_value:function(e){return{next:function(t){return e(t.data[t.i0])}}},last_value:function(e){return{next:function(t){return e(t.data[t.i1-1])}}},nth_value:function(e,t){return(t=+t)>0||a.error("nth_value nth must be greater than zero."),{next:function(n){var r=n.i0+(t-1);return r<n.i1?e(n.data[r]):null}}},prev_value:function(e){var t;return{init:function(){return t=null},next:function(n){var r=e(n.data[n.index]);return null!=r?t=r:t}}},next_value:function(e){var t,n;return{init:function(){return t=null,n=-1},next:function(r){var a=r.data;return r.index<=n?t:(n=function(e,t,n){for(var r=t.length;n<r;++n){if(null!=e(t[n]))return n}return-1}(e,a,r.index))<0?(n=a.length,t=null):t=e(a[n])}}}};var Re=Object.keys(Ie);function Me(e){var t=a.array(e.ops),n=a.array(e.fields),r=a.array(e.params),i=a.array(e.as),o=this.outputs=[],u=this.windows=[],s={},c={},l=[],f=[],d=!0;function p(e){a.array(a.accessorFields(e)).forEach((function(e){return s[e]=1}))}p(e.sort),t.forEach((function(e,t){var s=n[t],h=a.accessorName(s),v=g(e,h,i[t]);if(p(s),o.push(v),a.hasOwnProperty(Ie,e))u.push(function(e,t,n,r){var i=Ie[e](t,n);return{init:i.init||a.zero,update:function(e,t){t[r]=i.next(e)}}}(e,n[t],r[t],v));else{if(null==s&&"count"!==e&&a.error("Null aggregate field specified."),"count"===e)return void l.push(v);d=!1;var m=c[h];m||((m=c[h]=[]).field=s,f.push(m)),m.push(k(e,v))}})),(l.length||f.length)&&(this.cell=function(e,t,n){e=e.map((function(e){return N(e,e.field)}));var r={num:0,agg:null,store:!1,count:t};if(!n)for(var a=e.length,i=r.agg=Array(a),o=0;o<a;++o)i[o]=new e[o](r);if(r.store)var u=r.data=new T;return r.add=function(e){if(r.num+=1,!n){u&&u.add(e);for(var t=0;t<a;++t)i[t].add(i[t].get(e),e)}},r.rem=function(e){if(r.num-=1,!n){u&&u.rem(e);for(var t=0;t<a;++t)i[t].rem(i[t].get(e),e)}},r.set=function(e){var a,o;for(u&&u.values(),a=0,o=t.length;a<o;++a)e[t[a]]=r.num;if(!n)for(a=0,o=i.length;a<o;++a)i[a].set(e)},r.init=function(){r.num=0,u&&u.reset();for(var e=0;e<a;++e)i[e].init()},r}(f,l,d)),this.inputs=Object.keys(s)}var Be=Me.prototype;function Pe(e){i.Transform.call(this,{},e),this._mlen=0,this._mods=[]}function Le(e,t,n,r){var i=r.sort,o=i&&!r.ignorePeers,u=r.frame||[null,0],s=e.data(n),c=s.length,l=o?p.default(i):null,f={i0:0,i1:0,p0:0,p1:0,index:0,data:s,compare:i||a.constant(-1)};t.init();for(var d=0;d<c;++d)je(f,u,d,c),o&&ze(f,l),t.update(f,s[d])}function je(e,t,n,r){e.p0=e.i0,e.p1=e.i1,e.i0=null==t[0]?0:Math.max(0,n-Math.abs(t[0])),e.i1=null==t[1]?r:Math.min(r,n+Math.abs(t[1])+1),e.index=n}function ze(e,t){var n=e.i0,r=e.i1-1,a=e.compare,i=e.data,o=i.length-1;n>0&&!a(i[n],i[n-1])&&(e.i0=t.left(i,i[n])),r<o&&!a(i[r],i[r+1])&&(e.i1=t.right(i,i[r]))}Be.init=function(){this.windows.forEach((function(e){return e.init()})),this.cell&&this.cell.init()},Be.update=function(e,t){var n,r=this.cell,a=this.windows,i=e.data,o=a&&a.length;if(r){for(n=e.p0;n<e.i0;++n)r.rem(i[n]);for(n=e.p1;n<e.i1;++n)r.add(i[n]);r.set(t)}for(n=0;n<o;++n)a[n].update(e,t)},Pe.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Re.concat(b)},{name:"params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},a.inherits(Pe,i.Transform,{transform:function(e,t){var n=this;this.stamp=t.stamp;var r=e.modified(),a=i.stableCompare(e.sort),o=v(e.groupby),u=function(e){return n.group(o(e))},s=this.state;s&&!r||(s=this.state=new Me(e)),r||t.modified(s.inputs)?(this.value={},t.visit(t.SOURCE,(function(e){return u(e).add(e)}))):(t.visit(t.REM,(function(e){return u(e).remove(e)})),t.visit(t.ADD,(function(e){return u(e).add(e)})));for(var c=0,l=this._mlen;c<l;++c)Le(this._mods[c],s,a,e);return this._mlen=0,this._mods=[],t.reflow(r).modifies(s.outputs)},group:function(e){var t=this.value[e];return t||((t=this.value[e]=_(i.tupleid)).stamp=-1),t.stamp<this.stamp&&(t.stamp=this.stamp,this._mods[this._mlen++]=t),t}})})),s.register("3okBY",(function(e,r){n(e.exports,"quantiles",(function(){return p})),n(e.exports,"quartiles",(function(){return h})),n(e.exports,"bandwidthNRD",(function(){return v})),n(e.exports,"bin",(function(){return g})),n(e.exports,"random",(function(){return m})),n(e.exports,"setRandom",(function(){return y})),n(e.exports,"bootstrapCI",(function(){return x})),n(e.exports,"dotbin",(function(){return b})),n(e.exports,"randomLCG",(function(){return k})),n(e.exports,"randomInteger",(function(){return w})),n(e.exports,"sampleNormal",(function(){return S})),n(e.exports,"densityNormal",(function(){return N})),n(e.exports,"cumulativeNormal",(function(){return T})),n(e.exports,"regressionExp",(function(){return X})),n(e.exports,"quantileNormal",(function(){return D})),n(e.exports,"randomNormal",(function(){return F})),n(e.exports,"randomKDE",(function(){return O})),n(e.exports,"sampleLogNormal",(function(){return _})),n(e.exports,"densityLogNormal",(function(){return I})),n(e.exports,"cumulativeLogNormal",(function(){return R})),n(e.exports,"quantileLogNormal",(function(){return M})),n(e.exports,"randomLogNormal",(function(){return B})),n(e.exports,"randomMixture",(function(){return P})),n(e.exports,"sampleUniform",(function(){return L})),n(e.exports,"densityUniform",(function(){return j})),n(e.exports,"cumulativeUniform",(function(){return z})),n(e.exports,"quantileUniform",(function(){return U})),n(e.exports,"randomUniform",(function(){return V})),n(e.exports,"regressionLinear",(function(){return J})),n(e.exports,"regressionLog",(function(){return K})),n(e.exports,"regressionPow",(function(){return Y})),n(e.exports,"regressionQuad",(function(){return Q})),n(e.exports,"regressionPoly",(function(){return Z})),n(e.exports,"regressionLoess",(function(){return ee})),n(e.exports,"sampleCurve",(function(){return ae})),s("1i51P");var a=s("6vecG"),i=s("40Zzs"),o=s("35HQC"),u=s("bQzCL"),c=s("jTJ6X"),l=s("lUWZp"),f=t(i).mark(d);function d(e,n){var r,a,o,u,s,c,l,d,p,h,v,g,m;return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=n){t.next=28;break}r=!0,a=!1,o=void 0,t.prev=2,u=e[Symbol.iterator]();case 4:if(r=(s=u.next()).done){t.next=12;break}if(!(null!=(c=s.value)&&""!==c&&(c=+c)>=c)){t.next=9;break}return t.next=9,c;case 9:r=!0,t.next=4;break;case 12:t.next=18;break;case 14:t.prev=14,t.t0=t.catch(2),a=!0,o=t.t0;case 18:t.prev=18,t.prev=19,r||null==u.return||u.return();case 21:if(t.prev=21,!a){t.next=24;break}throw o;case 24:return t.finish(21);case 25:return t.finish(18);case 26:t.next=55;break;case 28:l=-1,d=!0,p=!1,h=void 0,t.prev=30,v=e[Symbol.iterator]();case 32:if(d=(g=v.next()).done){t.next=41;break}if(m=g.value,!(null!=(m=n(m,++l,e))&&""!==m&&(m=+m)>=m)){t.next=38;break}return t.next=38,m;case 38:d=!0,t.next=32;break;case 41:t.next=47;break;case 43:t.prev=43,t.t1=t.catch(30),p=!0,h=t.t1;case 47:t.prev=47,t.prev=48,d||null==v.return||v.return();case 50:if(t.prev=50,!p){t.next=53;break}throw h;case 53:return t.finish(50);case 54:return t.finish(47);case 55:case"end":return t.stop()}}),f,null,[[2,14,18,26],[19,,21,25],[30,43,47,55],[48,,50,54]])}function p(e,t,n){var r=Float64Array.from(d(e,n));return r.sort(o.default),t.map((function(e){return u.quantileSorted(r,e)}))}function h(e,t){return p(e,[.25,.5,.75],t)}function v(e,t){var n=e.length,r=c.default(e,t),a=h(e,t),i=(a[2]-a[0])/1.34;return 1.06*(Math.min(r,i)||r||Math.abs(a[0])||1)*Math.pow(n,-.2)}function g(e){var t,n,r,a,i,o,u=e.maxbins||20,s=e.base||10,c=Math.log(s),l=e.divide||[5,2],f=e.extent[0],d=e.extent[1],p=e.span||d-f||Math.abs(f)||1;if(e.step)t=e.step;else if(e.steps){for(a=p/u,i=0,o=e.steps.length;i<o&&e.steps[i]<a;++i);t=e.steps[Math.max(0,i-1)]}else{for(n=Math.ceil(Math.log(u)/c),r=e.minstep||0,t=Math.max(r,Math.pow(s,Math.round(Math.log(p)/c)-n));Math.ceil(p/t)>u;)t*=s;for(i=0,o=l.length;i<o;++i)(a=t/l[i])>=r&&p/a<=u&&(t=a)}var h=(a=Math.log(t))>=0?0:1+~~(-a/c),v=Math.pow(s,-h-1);return(e.nice||void 0===e.nice)&&(f=f<(a=Math.floor(f/t+v)*t)?a-t:a,d=Math.ceil(d/t)*t),{start:f,stop:d===f?f+t:d,step:t}}var m=Math.random;function y(e){m=e}function x(e,t,n,r){if(!e.length)return[void 0,void 0];var a,i,s,c,l=Float64Array.from(d(e,r)),f=l.length,p=t;for(s=0,c=Array(p);s<p;++s){for(a=0,i=0;i<f;++i)a+=l[~~(m()*f)];c[s]=a/f}return c.sort(o.default),[u.default(c,n/2),u.default(c,1-n/2)]}function b(e,t,n,r){r=r||function(e){return e};for(var a,i=e.length,o=new Float64Array(i),u=0,s=1,c=r(e[0]),l=c,f=c+t;s<i;++s){if((a=r(e[s]))>=f){for(l=(c+l)/2;u<s;++u)o[u]=l;f=a+t,c=a}l=a}for(l=(c+l)/2;u<s;++u)o[u]=l;return n?function(e,t){var n,r,a=e.length,i=0,o=1;for(;e[i]===e[o];)++o;for(;o<a;){for(n=o+1;e[o]===e[n];)++n;if(e[o]-e[o-1]<t){for(r=o+(i+n-o-o>>1);r<o;)e[r++]=e[o];for(;r>o;)e[r--]=e[i]}i=o,o=n}return e}(o,t+t/4):o}function k(e){return function(){return(e=(1103515245*e+12345)%2147483647)/2147483647}}function w(e,t){var n,r,a;null==t&&(t=e,e=0);var i={min:function(e){return arguments.length?(a=r-(n=e||0),i):n},max:function(e){return arguments.length?(a=(r=e||0)-n,i):r},sample:function(){return n+Math.floor(a*m())},pdf:function(e){return e===Math.floor(e)&&e>=n&&e<r?1/a:0},cdf:function(e){var t=Math.floor(e);return t<n?0:t>=r?1:(t-n+1)/a},icdf:function(e){return e>=0&&e<=1?n-1+Math.floor(e*a):NaN}};return i.min(e).max(t)}var A=Math.sqrt(2*Math.PI),E=Math.SQRT2,C=NaN;function S(e,t){e=e||0,t=null==t?1:t;var n,r,a=0,i=0;if(C==C)a=C,C=NaN;else{do{n=(a=2*m()-1)*a+(i=2*m()-1)*i}while(0===n||n>1);a*=r=Math.sqrt(-2*Math.log(n)/n),C=i*r}return e+a*t}function N(e,t,n){var r=(e-(t||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*A)}function T(e,t,n){var r,a=(e-(t=t||0))/(n=null==n?1:n),i=Math.abs(a);if(i>37)r=0;else{var o=Math.exp(-i*i/2);i<7.07106781186547?(r=o*((((((.0352624965998911*i+.700383064443688)*i+6.37396220353165)*i+33.912866078383)*i+112.079291497871)*i+221.213596169931)*i+220.206867912376),r/=((((((.0883883476483184*i+1.75566716318264)*i+16.064177579207)*i+86.7807322029461)*i+296.564248779674)*i+637.333633378831)*i+793.826512519948)*i+440.413735824752):r=o/(i+1/(i+2/(i+3/(i+4/(i+.65)))))/2.506628274631}return a>0?1-r:r}function D(e,t,n){return e<0||e>1?NaN:(t||0)+(null==n?1:n)*E*function(e){var t,n=-Math.log((1-e)*(1+e));t=n<6.25?1.6536545626831027+(t=.24015818242558962+(t=(t=(t=.00018673420803405714+(t=(t=(t=4.2347877827932404e-7+(t=(t=(t=1.0512122733215323e-9+(t=(t=(t=26335093153082323e-28+(t=(t=(t=6637638134358324e-30+(t=20972767875968562e-33+(t=(t=11157877678025181e-33+(t=128584807152564e-32+(t=(t=-364441206401782e-35)*(n-=3.125)-16850591381820166e-35)*n)*n)*n-1333171662854621e-31)*n)*n)*n-4054566272975207e-29)*n-8151934197605472e-29)*n)*n-12975133253453532e-27)*n-5415412054294628e-26)*n)*n-4.112633980346984e-9)*n-2.9070369957882005e-8)*n)*n-13654692000834679e-22)*n-13882523362786469e-21)*n)*n-.000740702534166267)*n-.006033670871430149)*n)*n:n<16?3.0838856104922208+(t=1.0052589676941592+(t=.005370914553590064+(t=(t=.002491442096107851+(t=(t=.0009532893797373805+(t=(t=24031110387097894e-21+(t=6828485145957318e-20+(t=(t=12475304481671779e-21+(t=29234449089955446e-22+(t=(t=15027403968909828e-22+(t=1.8239629214389228e-8+(t=(t=9.075656193888539e-8+(t=2.2137376921775787e-9)*(n=Math.sqrt(n)-3.25))*n-2.7517406297064545e-7)*n)*n)*n-4013867526981546e-21)*n)*n)*n-47318229009055734e-21)*n)*n)*n-.0003550375203628475)*n)*n-.0016882755560235047)*n)*n-.003751208507569241)*n)*n)*n:Number.isFinite(n)?4.849906401408584+(t=1.0103004648645344+(t=(t=(t=7599527703001776e-20+(t=(t=4526062597223154e-21+(t=(t=2.2900482228026655e-7+(t=(t=2.914795345090108e-8+(t=(t=7.61570120807834e-9+(t=(t=1.5076572693500548e-9+(t=(t=-27109920616438573e-27)*(n=Math.sqrt(n)-5)-2.555641816996525e-10)*n)*n-3.789465440126737e-9)*n)*n-1.496002662714924e-8)*n)*n-6.771199775845234e-8)*n)*n-9.9298272942317e-7)*n)*n-1968177810553167e-20)*n)*n-.00021503011930044477)*n-.00013871931833623122)*n)*n:1/0;return t*e}(2*e-1)}function F(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return S(n,r)},pdf:function(e){return N(e,n,r)},cdf:function(e){return T(e,n,r)},icdf:function(e){return D(e,n,r)}};return a.mean(e).stdev(t)}function O(e,t){var n=F(),r=0,a={data:function(n){return arguments.length?(e=n,r=n?n.length:0,a.bandwidth(t)):e},bandwidth:function(n){return arguments.length?(!(t=n)&&e&&(t=v(e)),a):t},sample:function(){return e[~~(m()*r)]+t*n.sample()},pdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.pdf((a-e[o])/t);return i/t/r},cdf:function(a){for(var i=0,o=0;o<r;++o)i+=n.cdf((a-e[o])/t);return i/r},icdf:function(){throw Error("KDE icdf not supported.")}};return a.data(e)}function _(e,t){return e=e||0,t=null==t?1:t,Math.exp(e+S()*t)}function I(e,t,n){if(e<=0)return 0;t=t||0,n=null==n?1:n;var r=(Math.log(e)-t)/n;return Math.exp(-.5*r*r)/(n*A*e)}function R(e,t,n){return T(Math.log(e),t,n)}function M(e,t,n){return Math.exp(D(e,t,n))}function B(e,t){var n,r,a={mean:function(e){return arguments.length?(n=e||0,a):n},stdev:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return _(n,r)},pdf:function(e){return I(e,n,r)},cdf:function(e){return R(e,n,r)},icdf:function(e){return M(e,n,r)}};return a.mean(e).stdev(t)}function P(e,t){var n,r=0;function a(e){var t,n=[],a=0;for(t=0;t<r;++t)a+=n[t]=null==e[t]?1:+e[t];for(t=0;t<r;++t)n[t]/=a;return n}var i={weights:function(e){return arguments.length?(n=a(t=e||[]),i):t},distributions:function(n){return arguments.length?(n?(r=n.length,e=n):(r=0,e=[]),i.weights(t)):e},sample:function(){for(var t=m(),a=e[r-1],i=n[0],o=0;o<r-1;i+=n[++o])if(t<i){a=e[o];break}return a.sample()},pdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].pdf(t);return a},cdf:function(t){for(var a=0,i=0;i<r;++i)a+=n[i]*e[i].cdf(t);return a},icdf:function(){throw Error("Mixture icdf not supported.")}};return i.distributions(e).weights(t)}function L(e,t){return null==t&&(t=null==e?1:e,e=0),e+(t-e)*m()}function j(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=t&&e<=n?1/(n-t):0}function z(e,t,n){return null==n&&(n=null==t?1:t,t=0),e<t?0:e>n?1:(e-t)/(n-t)}function U(e,t,n){return null==n&&(n=null==t?1:t,t=0),e>=0&&e<=1?t+e*(n-t):NaN}function V(e,t){var n,r,a={min:function(e){return arguments.length?(n=e||0,a):n},max:function(e){return arguments.length?(r=null==e?1:e,a):r},sample:function(){return L(n,r)},pdf:function(e){return j(e,n,r)},cdf:function(e){return z(e,n,r)},icdf:function(e){return U(e,n,r)}};return null==t&&(t=null==e?1:e,e=0),a.min(e).max(t)}function W(e,t,n,r){var a=r-e*e,i=Math.abs(a)<1e-24?0:(n-e*t)/a;return[t-i*e,i]}function G(e,t,n,r){e=e.filter((function(e){var r=t(e),a=n(e);return null!=r&&(r=+r)>=r&&null!=a&&(a=+a)>=a})),r&&e.sort((function(e,n){return t(e)-t(n)}));var a,i,o,u=e.length,s=new Float64Array(u),c=new Float64Array(u),l=0,f=0,d=0,p=!0,h=!1,v=void 0;try{for(var g,m=e[Symbol.iterator]();!(p=(g=m.next()).done);p=!0)o=g.value,s[l]=a=+t(o),c[l]=i=+n(o),f+=(a-f)/++l,d+=(i-d)/l}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}for(l=0;l<u;++l)s[l]-=f,c[l]-=d;return[s,c,f,d]}function H(e,t,n,r){var a,i,o=-1,u=!0,s=!1,c=void 0;try{for(var l,f=e[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;a=t(d),i=n(d),null!=a&&(a=+a)>=a&&null!=i&&(i=+i)>=i&&r(a,i,++o)}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}}function q(e,t,n,r,a){var i=0,o=0;return H(e,t,n,(function(e,t){var n=t-a(e),u=t-r;i+=n*n,o+=u*u})),1-i/o}function J(e,t,n){var r=0,a=0,i=0,o=0,u=0;H(e,t,n,(function(e,t){++u,r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var s=W(r,a,i,o),c=function(e){return s[0]+s[1]*e};return{coef:s,predict:c,rSquared:q(e,t,n,a,c)}}function K(e,t,n){var r=0,a=0,i=0,o=0,u=0;H(e,t,n,(function(e,t){++u,e=Math.log(e),r+=(e-r)/u,a+=(t-a)/u,i+=(e*t-i)/u,o+=(e*e-o)/u}));var s=W(r,a,i,o),c=function(e){return s[0]+s[1]*Math.log(e)};return{coef:s,predict:c,rSquared:q(e,t,n,a,c)}}function X(e,t,n){var r,i,o,u=a.default(G(e,t,n),4),s=u[0],c=(u[1],u[2]),l=u[3],f=0,d=0,p=0,h=0,v=0;H(e,t,n,(function(e,t){r=s[v++],i=Math.log(t),f+=(t*i-f)/v,d+=((o=r*t)-d)/v,p+=(o*i-p)/v,h+=(r*o-h)/v}));var g=a.default(W(d/l,f/l,p/l,h/l),2),m=g[0],y=g[1],x=function(e){return Math.exp(m+y*(e-c))};return{coef:[Math.exp(m-y*c),y],predict:x,rSquared:q(e,t,n,l,x)}}function Y(e,t,n){var r=0,a=0,i=0,o=0,u=0,s=0;H(e,t,n,(function(e,t){var n=Math.log(e),c=Math.log(t);++s,r+=(n-r)/s,a+=(c-a)/s,i+=(n*c-i)/s,o+=(n*n-o)/s,u+=(t-u)/s}));var c=W(r,a,i,o),l=function(e){return c[0]*Math.pow(e,c[1])};return c[0]=Math.exp(c[0]),{coef:c,predict:l,rSquared:q(e,t,n,u,l)}}function Q(e,t,n){var r,i,o,u,s=a.default(G(e,t,n),4),c=s[0],l=s[1],f=s[2],d=s[3],p=c.length,h=0,v=0,g=0,m=0,y=0;for(r=0;r<p;)i=c[r],o=l[r++],h+=((u=i*i)-h)/r,v+=(u*i-v)/r,g+=(u*u-g)/r,m+=(i*o-m)/r,y+=(u*o-y)/r;var x=g-h*h,b=h*x-v*v,k=(y*h-m*v)/b,w=(m*x-y*v)/b,A=-k*h,E=function(e){return k*(e-=f)*e+w*e+A+d};return{coef:[A-w*f+k*f*f+d,w-2*k*f,k],predict:E,rSquared:q(e,t,n,d,E)}}function Z(e,t,n,r){if(1===r)return J(e,t,n);if(2===r)return Q(e,t,n);var i,o,u,s,c,l=a.default(G(e,t,n),4),f=l[0],d=l[1],p=l[2],h=l[3],v=f.length,g=[],m=[],y=r+1;for(i=0;i<y;++i){for(u=0,s=0;u<v;++u)s+=Math.pow(f[u],i)*d[u];for(g.push(s),c=new Float64Array(y),o=0;o<y;++o){for(u=0,s=0;u<v;++u)s+=Math.pow(f[u],i+o);c[o]=s}m.push(c)}m.push(g);var x=function(e){var t,n,r,a,i,o=e.length-1,u=[];for(t=0;t<o;++t){for(a=t,n=t+1;n<o;++n)Math.abs(e[t][n])>Math.abs(e[t][a])&&(a=n);for(r=t;r<o+1;++r)i=e[r][t],e[r][t]=e[r][a],e[r][a]=i;for(n=t+1;n<o;++n)for(r=o;r>=t;r--)e[r][n]-=e[r][t]*e[t][n]/e[t][t]}for(n=o-1;n>=0;--n){for(i=0,r=n+1;r<o;++r)i+=e[r][n]*u[r];u[n]=(e[o][n]-i)/e[n][n]}return u}(m),b=function(e){e-=p;var t=h+x[0]+x[1]*e+x[2]*e*e;for(i=3;i<y;++i)t+=x[i]*Math.pow(e,i);return t};return{coef:$(y,x,-p,h),predict:b,rSquared:q(e,t,n,h,b)}}function $(e,t,n,r){var a,i,o,u,s=Array(e);for(a=0;a<e;++a)s[a]=0;for(a=e-1;a>=0;--a)for(o=t[a],u=1,s[a]+=o,i=1;i<=a;++i)u*=(a+1-i)/i,s[a-i]+=o*Math.pow(n,i)*u;return s[0]+=r,s}function ee(e,t,n,r){for(var i=a.default(G(e,t,n,!0),4),o=i[0],u=i[1],s=i[2],c=i[3],f=o.length,d=Math.max(2,~~(r*f)),p=new Float64Array(f),h=new Float64Array(f),v=new Float64Array(f).fill(1),g=-1;++g<=2;){for(var m=[0,d-1],y=0;y<f;++y){for(var x=o[y],b=m[0],k=m[1],w=x-o[b]>o[k]-x?b:k,A=0,E=0,C=0,S=0,N=0,T=1/Math.abs(o[w]-x||1),D=b;D<=k;++D){var F=o[D],O=u[D],_=te(Math.abs(x-F)*T)*v[D],I=F*_;A+=_,E+=I,C+=O*_,S+=O*I,N+=F*I}var R=a.default(W(E/A,C/A,S/A,N/A),2),M=R[0],B=R[1];p[y]=M+B*x,h[y]=Math.abs(u[y]-p[y]),ne(o,y+1,m)}if(2===g)break;var P=l.default(h);if(Math.abs(P)<1e-12)break;for(var L=0,j=void 0,z=void 0;L<f;++L)j=h[L]/(6*P),v[L]=j>=1?1e-12:(z=1-j*j)*z}return function(e,t,n,r){for(var a,i=e.length,o=[],u=0,s=0,c=[];u<i;++u)a=e[u]+n,c[0]===a?c[1]+=(t[u]-c[1])/++s:(s=0,c[1]+=r,c=[a,t[u]],o.push(c));return c[1]+=r,o}(o,p,s,c)}function te(e){return(e=1-e*e*e)*e*e}function ne(e,t,n){var r=e[t],a=n[0],i=n[1]+1;if(!(i>=e.length))for(;t>a&&e[i]-r<=r-e[a];)n[0]=++a,n[1]=i,++i}var re=.5*Math.PI/180;function ae(e,t,n,r){n=n||25,r=Math.max(n,r||200);var a=function(t){return[t,e(t)]},i=t[0],o=t[1],u=o-i,s=u/r,c=[a(i)],l=[];if(n===r){for(var f=1;f<r;++f)c.push(a(i+f/n*u));return c.push(a(o)),c}l.push(a(o));for(var d=n;--d>0;)l.push(a(i+d/n*u));for(var p=c[0],h=l[l.length-1],v=1/u,g=function(e,t){for(var n=e,r=e,a=t.length,i=0;i<a;++i){var o=t[i][1];o<n&&(n=o),o>r&&(r=o)}return 1/(r-n)}(p[1],l);h;){var m=a((p[0]+h[0])/2);m[0]-p[0]>=s&&ie(p,m,h,v,g)>re?l.push(m):(p=h,c.push(h),l.pop()),h=l[l.length-1]}return c}function ie(e,t,n,r,a){var i=Math.atan2(a*(n[1]-e[1]),r*(n[0]-e[0])),o=Math.atan2(a*(t[1]-e[1]),r*(t[0]-e[0]));return Math.abs(i-o)}})),s.register("fhCNY",(function(e,t){n(e.exports,"bound",(function(){return P})),n(e.exports,"identifier",(function(){return j})),n(e.exports,"mark",(function(){return z})),n(e.exports,"overlap",(function(){return U})),n(e.exports,"render",(function(){return K})),n(e.exports,"viewlayout",(function(){return ge})),s("1i51P");var r=s("9M1dW"),a=s("euljU"),i=s("aVGvL"),o=s("caNzv"),u="top",c="left",l="right",f="bottom",d="start",p="middle",h="end",v="group",g="axis",m="title",y="frame",x="scope",b="legend",k="row-header",w="row-footer",A="row-title",E="column-header",C="column-footer",S="column-title",N="padding",T="fit",D="fit-x",F="fit-y",O="none",_="all",I="each",R="flush",M="column",B="row";function P(e){a.Transform.call(this,null,e)}function L(e,t,n){return t(e.bounds.clear(),e,n)}o.inherits(P,a.Transform,{transform:function(e,t){var n,r=t.dataflow,a=e.mark,o=a.marktype,u=i.Marks[o],s=u.bound,c=a.bounds;if(u.nested)a.items.length&&r.dirty(a.items[0]),c=L(a,s),a.items.forEach((function(e){e.bounds.clear().union(c)}));else if(o===v||e.modified())switch(t.visit(t.MOD,(function(e){return r.dirty(e)})),c.clear(),a.items.forEach((function(e){return c.union(L(e,s))})),a.role){case g:case b:case m:t.reflow()}else n=t.changed(t.REM),t.visit(t.ADD,(function(e){c.union(L(e,s))})),t.visit(t.MOD,(function(e){n=n||c.alignsWith(e.bounds),r.dirty(e),c.union(L(e,s))})),n&&(c.clear(),a.items.forEach((function(e){return c.union(e.bounds)})));return i.boundClip(a),t.modifies("bounds")}});function j(e){a.Transform.call(this,0,e)}function z(e){a.Transform.call(this,null,e)}function U(e){a.Transform.call(this,null,e)}j.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},o.inherits(j,a.Transform,{transform:function(e,t){var n,r=(n=t.dataflow)._signals[":vega_identifier:"]||(n._signals[":vega_identifier:"]=n.add(0)),a=e.as,i=r.value;return t.visit(t.ADD,(function(e){return e[a]=e[a]||++i})),r.set(this.value=i),t}}),o.inherits(z,a.Transform,{transform:function(e,t){var n=this.value;n||((n=t.dataflow.scenegraph().mark(e.markdef,function(e){var t=e.groups,n=e.parent;return t&&1===t.size?t.get(Object.keys(t.object)[0]):t&&n?t.lookup(n):null}(e),e.index)).group.context=e.context,e.context.group||(e.context.group=n.group),n.source=this.source,n.clip=e.clip,n.interactive=e.interactive,this.value=n);var r=n.marktype===v?i.GroupItem:i.Item;return t.visit(t.ADD,(function(e){return r.call(e,n)})),(e.modified("clip")||e.modified("interactive"))&&(n.clip=e.clip,n.interactive=!!e.interactive,n.zdirty=!0,t.reflow()),n.items=t.source,t}});var V={parity:function(e){return e.filter((function(e,t){return t%2?e.opacity=0:1}))},greedy:function(e,t){var n;return e.filter((function(e,r){return r&&W(n.bounds,e.bounds,t)?e.opacity=0:(n=e,1)}))}},W=function(e,t,n){return n>Math.max(t.x1-e.x2,e.x1-t.x2,t.y1-e.y2,e.y1-t.y2)},G=function(e,t){for(var n,r=1,a=e.length,i=e[0].bounds;r<a;i=n,++r)if(W(i,n=e[r].bounds,t))return!0},H=function(e){var t=e.bounds;return t.width()>1&&t.height()>1},q=function(e){return e.forEach((function(e){return e.opacity=1})),e},J=function(e,t){return e.reflow(t.modified()).modifies("opacity")};function K(e){a.Transform.call(this,null,e)}o.inherits(U,a.Transform,{transform:function(e,t){var n,r,a=V[e.method]||V.parity,s=e.separation||0,c=t.materialize(t.SOURCE).source;if(c&&c.length){if(!e.method)return e.modified("method")&&(q(c),t=J(t,e)),t;if((c=c.filter(H)).length){if(e.sort&&(c=c.slice().sort(e.sort)),n=q(c),t=J(t,e),n.length>=3&&G(n,s)){do{n=a(n,s)}while(n.length>=3&&G(n,s));n.length<3&&!o.peek(c).opacity&&(n.length>1&&(o.peek(n).opacity=0),o.peek(c).opacity=1)}var l,d,p,h,v;e.boundScale&&e.boundTolerance>=0&&(l=e.boundScale,d=e.boundOrient,p=+e.boundTolerance,h=l.range(),v=new i.Bounds,d===u||d===f?v.set(h[0],-1/0,h[1],1/0):v.set(-1/0,h[0],1/0,h[1]),v.expand(p||1),r=function(e){return v.encloses(e.bounds)},c.forEach((function(e){r(e)||(e.opacity=0)})));var g=n[0].mark.bounds.clear();return c.forEach((function(e){e.opacity&&g.union(e.bounds)})),t}}}}),o.inherits(K,a.Transform,{transform:function(e,t){var n=t.dataflow;if(t.visit(t.ALL,(function(e){return n.dirty(e)})),t.fields&&t.fields.zindex){var r=t.source&&t.source[0];r&&(r.mark.zdirty=!0)}}});var X=new i.Bounds;function Y(e,t,n){return e[t]===n?0:(e[t]=n,1)}function Q(e){var t=e.items[0].orient;return t===c||t===l}function Z(e,t,n,r){var a,o,s=t.items[0],d=s.datum,p=null!=s.translate?s.translate:.5,h=s.orient,v=function(e){var t=+e.grid;return[e.ticks?t++:-1,e.labels?t++:-1,t+ +e.domain]}(d),g=s.range,m=s.offset,y=s.position,x=s.minExtent,b=s.maxExtent,k=d.title&&s.items[v[2]].items[0],w=s.titlePadding,A=s.bounds,E=k&&i.multiLineOffset(k),C=0,S=0;switch(X.clear().union(A),A.clear(),(a=v[0])>-1&&A.union(s.items[a].bounds),(a=v[1])>-1&&A.union(s.items[a].bounds),h){case u:C=y||0,S=-m,o=Math.max(x,Math.min(b,-A.y1)),A.add(0,-o).add(g,0),k&&$(e,k,o,w,E,0,-1,A);break;case c:C=-m,S=y||0,o=Math.max(x,Math.min(b,-A.x1)),A.add(-o,0).add(0,g),k&&$(e,k,o,w,E,1,-1,A);break;case l:C=n+m,S=y||0,o=Math.max(x,Math.min(b,A.x2)),A.add(0,0).add(o,g),k&&$(e,k,o,w,E,1,1,A);break;case f:C=y||0,S=r+m,o=Math.max(x,Math.min(b,A.y2)),A.add(0,0).add(g,o),k&&$(e,k,o,w,0,0,1,A);break;default:C=s.x,S=s.y}return i.boundStroke(A.translate(C,S),s),Y(s,"x",C+p)|Y(s,"y",S+p)&&(s.bounds=X,e.dirty(s),s.bounds=A,e.dirty(s)),s.mark.bounds.clear().union(A)}function $(e,t,n,r,a,i,o,u){var s=t.bounds;if(t.auto){var c=o*(n+a+r),l=0,f=0;e.dirty(t),i?l=(t.x||0)-(t.x=c):f=(t.y||0)-(t.y=c),t.mark.bounds.clear().union(s.translate(-l,-f)),e.dirty(t)}u.union(s)}var ee=function(e,t){return Math.floor(Math.min(e,t))},te=function(e,t){return Math.ceil(Math.max(e,t))};function ne(e){return(new i.Bounds).set(0,0,e.width||0,e.height||0)}function re(e){var t=e.bounds.clone();return t.empty()?t.set(0,0,0,0):t.translate(-(e.x||0),-(e.y||0))}function ae(e,t,n){var r=o.isObject(e)?e[t]:e;return null!=r?r:void 0!==n?n:0}function ie(e){return e<0?Math.ceil(-e):0}function oe(e,t,n){var r,a,i,o,u,s,c,l,f,d,v,g=!n.nodirty,m=n.bounds===R?ne:re,y=X.set(0,0,0,0),x=ae(n.align,M),b=ae(n.align,B),k=ae(n.padding,M),w=ae(n.padding,B),A=n.columns||t.length,E=A<=0?1:Math.ceil(t.length/A),C=t.length,S=Array(C),N=Array(A),T=0,D=Array(C),F=Array(E),O=0,P=Array(C),L=Array(C),j=Array(C);for(a=0;a<A;++a)N[a]=0;for(a=0;a<E;++a)F[a]=0;for(a=0;a<C;++a)s=t[a],u=j[a]=m(s),s.x=s.x||0,P[a]=0,s.y=s.y||0,L[a]=0,i=a%A,o=~~(a/A),T=Math.max(T,c=Math.ceil(u.x2)),O=Math.max(O,l=Math.ceil(u.y2)),N[i]=Math.max(N[i],c),F[o]=Math.max(F[o],l),S[a]=k+ie(u.x1),D[a]=w+ie(u.y1),g&&e.dirty(t[a]);for(a=0;a<C;++a)a%A==0&&(S[a]=0),a<A&&(D[a]=0);if(x===I)for(i=1;i<A;++i){for(v=0,a=i;a<C;a+=A)v<S[a]&&(v=S[a]);for(a=i;a<C;a+=A)S[a]=v+N[i-1]}else if(x===_){for(v=0,a=0;a<C;++a)a%A&&v<S[a]&&(v=S[a]);for(a=0;a<C;++a)a%A&&(S[a]=v+T)}else for(x=!1,i=1;i<A;++i)for(a=i;a<C;a+=A)S[a]+=N[i-1];if(b===I)for(o=1;o<E;++o){for(v=0,r=(a=o*A)+A;a<r;++a)v<D[a]&&(v=D[a]);for(a=o*A;a<r;++a)D[a]=v+F[o-1]}else if(b===_){for(v=0,a=A;a<C;++a)v<D[a]&&(v=D[a]);for(a=A;a<C;++a)D[a]=v+O}else for(b=!1,o=1;o<E;++o)for(r=(a=o*A)+A;a<r;++a)D[a]+=F[o-1];for(f=0,a=0;a<C;++a)f=S[a]+(a%A?f:0),P[a]+=f-t[a].x;for(i=0;i<A;++i)for(d=0,a=i;a<C;a+=A)d+=D[a],L[a]+=d-t[a].y;if(x&&ae(n.center,M)&&E>1)for(a=0;a<C;++a)(f=(u=x===_?T:N[a%A])-j[a].x2-t[a].x-P[a])>0&&(P[a]+=f/2);if(b&&ae(n.center,B)&&1!==A)for(a=0;a<C;++a)(d=(u=b===_?O:F[~~(a/A)])-j[a].y2-t[a].y-L[a])>0&&(L[a]+=d/2);for(a=0;a<C;++a)y.union(j[a].translate(P[a],L[a]));switch(f=ae(n.anchor,"x"),d=ae(n.anchor,"y"),ae(n.anchor,M)){case h:f-=y.width();break;case p:f-=y.width()/2}switch(ae(n.anchor,B)){case h:d-=y.height();break;case p:d-=y.height()/2}for(f=Math.round(f),d=Math.round(d),y.clear(),a=0;a<C;++a)t[a].mark.bounds.clear();for(a=0;a<C;++a)(s=t[a]).x+=P[a]+=f,s.y+=L[a]+=d,y.union(s.mark.bounds.union(s.bounds.translate(P[a],L[a]))),g&&e.dirty(s);return y}function ue(e,t,n){var a,i,o,u,s,c,l,f=function(e){for(var t,n,a=e.items,i=a.length,o=0,u={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};o<i;++o)if(n=(t=a[o]).items,t.marktype===v)switch(t.role){case g:case b:case m:break;case k:var s;(s=u.rowheaders).push.apply(s,r.default(n));break;case w:var c;(c=u.rowfooters).push.apply(c,r.default(n));break;case E:var l;(l=u.colheaders).push.apply(l,r.default(n));break;case C:var f;(f=u.colfooters).push.apply(f,r.default(n));break;case A:u.rowtitle=n[0];break;case S:u.coltitle=n[0];break;default:var d;(d=u.marks).push.apply(d,r.default(n))}return u}(t),d=f.marks,p=n.bounds===R?se:ce,y=n.offset,x=n.columns||d.length,N=x<=0?1:Math.ceil(d.length/x),T=N*x,D=oe(e,d,n);D.empty()&&D.set(0,0,0,0),f.rowheaders&&(c=ae(n.headerBand,B,null),a=le(e,f.rowheaders,d,x,N,-ae(y,"rowHeader"),ee,0,p,"x1",0,x,1,c)),f.colheaders&&(c=ae(n.headerBand,M,null),i=le(e,f.colheaders,d,x,x,-ae(y,"columnHeader"),ee,1,p,"y1",0,1,x,c)),f.rowfooters&&(c=ae(n.footerBand,B,null),o=le(e,f.rowfooters,d,x,N,ae(y,"rowFooter"),te,0,p,"x2",x-1,x,1,c)),f.colfooters&&(c=ae(n.footerBand,M,null),u=le(e,f.colfooters,d,x,x,ae(y,"columnFooter"),te,1,p,"y2",T-x,1,x,c)),f.rowtitle&&(s=ae(n.titleAnchor,B),l=ae(y,"rowTitle"),l=s===h?o+l:a-l,c=ae(n.titleBand,B,.5),fe(e,f.rowtitle,l,0,D,c)),f.coltitle&&(s=ae(n.titleAnchor,M),l=ae(y,"columnTitle"),l=s===h?u+l:i-l,c=ae(n.titleBand,M,.5),fe(e,f.coltitle,l,1,D,c))}function se(e,t){return"x1"===t?e.x||0:"y1"===t?e.y||0:"x2"===t?(e.x||0)+(e.width||0):"y2"===t?(e.y||0)+(e.height||0):void 0}function ce(e,t){return e.bounds[t]}function le(e,t,n,r,a,i,o,u,s,c,l,f,d,p){var h,v,g,m,y,x,b,k,w,A=n.length,E=0,C=0;if(!A)return E;for(h=l;h<A;h+=f)n[h]&&(E=o(E,s(n[h],c)));if(!t.length)return E;for(t.length>a&&(e.warn("Grid headers exceed limit: "+a),t=t.slice(0,a)),E+=i,v=0,m=t.length;v<m;++v)e.dirty(t[v]),t[v].mark.bounds.clear();for(h=l,v=0,m=t.length;v<m;++v,h+=f){for(y=(x=t[v]).mark.bounds,g=h;g>=0&&null==(b=n[g]);g-=d);u?(k=null==p?b.x:Math.round(b.bounds.x1+p*b.bounds.width()),w=E):(k=E,w=null==p?b.y:Math.round(b.bounds.y1+p*b.bounds.height())),y.union(x.bounds.translate(k-(x.x||0),w-(x.y||0))),x.x=k,x.y=w,e.dirty(x),C=o(C,y[c])}return C}function fe(e,t,n,r,a,i){if(t){e.dirty(t);var o=n,u=n;r?o=Math.round(a.x1+i*a.width()):u=Math.round(a.y1+i*a.height()),t.bounds.translate(o-(t.x||0),u-(t.y||0)),t.mark.bounds.clear().union(t.bounds),t.x=o,t.y=u,e.dirty(t)}}function de(e,t,n,r,a,i,o){var s=function(e,t){var n=e[t]||{};return function(t,r){return null!=n[t]?n[t]:null!=e[t]?e[t]:r}}(n,t),v=function(e,t){var n=-1/0;return e.forEach((function(e){null!=e.offset&&(n=Math.max(n,e.offset))})),n>-1/0?n:t}(e,s("offset",0)),g=s("anchor",d),m=g===h?1:g===p?.5:0,y={align:I,bounds:s("bounds",R),columns:"vertical"===s("direction")?1:e.length,padding:s("margin",8),center:s("center"),nodirty:!0};switch(t){case c:y.anchor={x:Math.floor(r.x1)-v,column:h,y:m*(o||r.height()+2*r.y1),row:g};break;case l:y.anchor={x:Math.ceil(r.x2)+v,y:m*(o||r.height()+2*r.y1),row:g};break;case u:y.anchor={y:Math.floor(a.y1)-v,row:h,x:m*(i||a.width()+2*a.x1),column:g};break;case f:y.anchor={y:Math.ceil(a.y2)+v,x:m*(i||a.width()+2*a.x1),column:g};break;case"top-left":y.anchor={x:v,y:v};break;case"top-right":y.anchor={x:i-v,y:v,column:h};break;case"bottom-left":y.anchor={x:v,y:o-v,row:h};break;case"bottom-right":y.anchor={x:i-v,y:o-v,column:h,row:h}}return y}function pe(e,t){var n,r,a,o,u=t.items[0],s=u.datum,d=u.orient,p=u.bounds,v=u.x,g=u.y;return u._bounds?u._bounds.clear().union(p):u._bounds=p.clone(),p.clear(),function(e,t,n){var r=t.padding,a=r-n.x,i=r-n.y;if(t.datum.title){var o=t.items[1].items[0],u=o.anchor,s=t.titlePadding||0,d=r-o.x,p=r-o.y;switch(o.orient){case c:a+=Math.ceil(o.bounds.width())+s;break;case l:case f:break;default:i+=o.bounds.height()+s}switch((a||i)&&ve(e,n,a,i),o.orient){case c:p+=he(t,n,o,u,1,1);break;case l:d+=he(t,n,o,h,0,0)+s,p+=he(t,n,o,u,1,1);break;case f:d+=he(t,n,o,u,0,0),p+=he(t,n,o,h,-1,0,1)+s;break;default:d+=he(t,n,o,u,0,0)}(d||p)&&ve(e,o,d,p),(d=Math.round(o.bounds.x1-r))<0&&(ve(e,n,-d,0),ve(e,o,-d,0))}else(a||i)&&ve(e,n,a,i)}(e,u,u.items[0].items[0]),p=function(e,t){return e.items.forEach((function(e){return t.union(e.bounds)})),t.x1=e.padding,t.y1=e.padding,t}(u,p),n=2*u.padding,r=2*u.padding,p.empty()||(n=Math.ceil(p.width()+n),r=Math.ceil(p.height()+r)),"symbol"===s.type&&(a=u.items[0].items[0].items[0].items,o=a.reduce((function(e,t){return e[t.column]=Math.max(t.bounds.x2-t.x,e[t.column]||0),e}),{}),a.forEach((function(e){e.width=o[e.column],e.height=e.bounds.y2-e.y}))),d!==O&&(u.x=v=0,u.y=g=0),u.width=n,u.height=r,i.boundStroke(p.set(v,g,v+n,g+r),u),u.mark.bounds.clear().union(p),u}function he(e,t,n,r,a,o,u){var s="symbol"!==e.datum.type,c=n.datum.vgrad,l=(!s||!o&&c||u?t:t.items[0]).bounds[a?"y2":"x2"]-e.padding,f=c&&o?l:0,p=c&&o?0:l,v=a<=0?0:i.multiLineOffset(n);return Math.round(r===d?f:r===h?p-v:.5*(l-v))}function ve(e,t,n,r){t.x+=n,t.y+=r,t.bounds.translate(n,r),t.mark.bounds.translate(n,r),e.dirty(t)}function ge(e){a.Transform.call(this,null,e)}o.inherits(ge,a.Transform,{transform:function(e,t){var n,r=t.dataflow;return e.mark.items.forEach((function(t){e.layout&&ue(r,t,e.layout),function(e,t,n){var r,a,o,s,p,_=t.items,I=Math.max(0,t.width||0),R=Math.max(0,t.height||0),M=(new i.Bounds).set(0,0,I,R),B=M.clone(),P=M.clone(),L=[];for(s=0,p=_.length;s<p;++s)switch((a=_[s]).role){case g:(Q(a)?B:P).union(Z(e,a,I,R));break;case m:r=a;break;case b:L.push(pe(e,a));break;case y:case x:case k:case w:case A:case E:case C:case S:B.union(a.bounds),P.union(a.bounds);break;default:M.union(a.bounds)}if(L.length){var j={};for(var z in L.forEach((function(e){(o=e.orient||l)!==O&&(j[o]||(j[o]=[])).push(e)})),j){var U=j[z];oe(e,U,de(U,z,n.legends,B,P,I,R))}L.forEach((function(t){var r=t.bounds;if(r.equals(t._bounds)||(t.bounds=t._bounds,e.dirty(t),t.bounds=r,e.dirty(t)),n.autosize&&n.autosize.type===T)switch(t.orient){case c:case l:M.add(r.x1,0).add(r.x2,0);break;case u:case f:M.add(0,r.y1).add(0,r.y2)}else M.union(r)}))}M.union(B).union(P),r&&M.union(function(e,t,n,r,a){var i,o=t.items[0],s=o.frame,p=o.orient,g=o.anchor,m=o.offset,y=o.padding,x=o.items[0].items[0],b=o.items[1]&&o.items[1].items[0],k=p===c||p===l?r:n,w=0,A=0,E=0,C=0,S=0;if(s!==v?p===c?(w=a.y2,k=a.y1):p===l?(w=a.y1,k=a.y2):(w=a.x1,k=a.x2):p===c&&(w=r,k=0),i=g===d?w:g===h?k:(w+k)/2,b&&b.text){switch(p){case u:case f:S=x.bounds.height()+y;break;case c:C=x.bounds.width()+y;break;case l:C=-x.bounds.width()-y}X.clear().union(b.bounds),X.translate(C-(b.x||0),S-(b.y||0)),Y(b,"x",C)|Y(b,"y",S)&&(e.dirty(b),b.bounds.clear().union(X),b.mark.bounds.clear().union(X),e.dirty(b)),X.clear().union(b.bounds)}else X.clear();switch(X.union(x.bounds),p){case u:A=i,E=a.y1-X.height()-m;break;case c:A=a.x1-X.width()-m,E=i;break;case l:A=a.x2+X.width()+m,E=i;break;case f:A=i,E=a.y2+m;break;default:A=o.x,E=o.y}return Y(o,"x",A)|Y(o,"y",E)&&(X.translate(A,E),e.dirty(o),o.bounds.clear().union(X),t.bounds.clear().union(X),e.dirty(o)),o.bounds}(e,r,I,R,M));t.clip&&M.set(0,0,t.width||0,t.height||0);!function(e,t,n,r){var a=r.autosize||{},i=a.type;if(e._autosize<1||!i)return;var o=e._width,u=e._height,s=Math.max(0,t.width||0),c=Math.max(0,Math.ceil(-n.x1)),l=Math.max(0,t.height||0),f=Math.max(0,Math.ceil(-n.y1)),d=Math.max(0,Math.ceil(n.x2-s)),p=Math.max(0,Math.ceil(n.y2-l));if(a.contains===N){var h=e.padding();o-=h.left+h.right,u-=h.top+h.bottom}i===O?(c=0,f=0,s=o,l=u):i===T?(s=Math.max(0,o-c-d),l=Math.max(0,u-f-p)):i===D?(s=Math.max(0,o-c-d),u=l+f+p):i===F?(o=s+c+d,l=Math.max(0,u-f-p)):"pad"===i&&(o=s+c+d,u=l+f+p);e._resizeView(o,u,s,l,[c,f],a.resize)}(e,t,M,n)}(r,t,e)})),(n=e.mark.group)&&"legend-entry"!==n.mark.role?t.reflow():t}})})),s.register("aVGvL",(function(e,t){n(e.exports,"Gradient",(function(){return B})),n(e.exports,"pathCurves",(function(){return L})),n(e.exports,"pathParse",(function(){return U})),n(e.exports,"pathRender",(function(){return Z})),n(e.exports,"pathSymbols",(function(){return ne})),n(e.exports,"pathRectangle",(function(){return fe})),n(e.exports,"pathTrail",(function(){return de})),n(e.exports,"point",(function(){return zn})),n(e.exports,"resetSVGClipId",(function(){return Ne})),n(e.exports,"Bounds",(function(){return De})),n(e.exports,"Item",(function(){return Fe})),n(e.exports,"GroupItem",(function(){return Oe})),n(e.exports,"ResourceLoader",(function(){return _e})),n(e.exports,"boundStroke",(function(){return Me})),n(e.exports,"boundContext",(function(){return $e})),n(e.exports,"intersectPath",(function(){return ot})),n(e.exports,"intersectPoint",(function(){return ut})),n(e.exports,"intersectRule",(function(){return ct})),n(e.exports,"intersectBoxLine",(function(){return lt})),n(e.exports,"sceneZOrder",(function(){return xt})),n(e.exports,"sceneVisit",(function(){return bt})),n(e.exports,"scenePickVisit",(function(){return kt})),n(e.exports,"textMetrics",(function(){return on})),n(e.exports,"fontSize",(function(){return dn})),n(e.exports,"font",(function(){return yn})),n(e.exports,"lineHeight",(function(){return pn})),n(e.exports,"multiLineOffset",(function(){return vn})),n(e.exports,"fontFamily",(function(){return mn})),n(e.exports,"Marks",(function(){return Cn})),n(e.exports,"boundItem",(function(){return Sn})),n(e.exports,"boundMark",(function(){return Tn})),n(e.exports,"sceneToJSON",(function(){return Fn})),n(e.exports,"sceneFromJSON",(function(){return On})),n(e.exports,"Scenegraph",(function(){return In})),n(e.exports,"domCreate",(function(){return Mn})),n(e.exports,"domFind",(function(){return Bn})),n(e.exports,"domChild",(function(){return Pn})),n(e.exports,"domClear",(function(){return Ln})),n(e.exports,"Handler",(function(){return Un})),n(e.exports,"Renderer",(function(){return Wn})),n(e.exports,"CanvasHandler",(function(){return or})),n(e.exports,"CanvasRenderer",(function(){return fr})),n(e.exports,"SVGHandler",(function(){return pr})),n(e.exports,"markup",(function(){return Fr})),n(e.exports,"serializeXML",(function(){return Or})),n(e.exports,"SVGRenderer",(function(){return Pr})),n(e.exports,"SVGStringRenderer",(function(){return Qr})),n(e.exports,"RenderType",(function(){return ea})),n(e.exports,"renderModule",(function(){return na})),n(e.exports,"intersect",(function(){return ra})),n(e.exports,"boundClip",(function(){return sa})),n(e.exports,"sceneEqual",(function(){return ca})),n(e.exports,"pathEqual",(function(){return la})),n(e.exports,"resetSVGDefIds",(function(){return fa})),s("1i51P");var r=s("9M1dW"),a=s("4Ui3v"),i=s("5lcaY"),o=s("caNzv"),u=s("k3ufy"),c=s("hQfwC"),l=s("hFLSz"),f=s("4Ovem"),d=s("gopn7"),p=s("bMTFD"),h=s("2HW9q"),v=s("f0CZg"),g=s("gwehU"),m=s("fTHwG"),y=s("3PltN"),x=s("jbOTG"),b=s("5inWz"),k=s("jcAHJ"),w=s("jdzTX"),A=s("gkjyK"),E=s("kEEJc"),C=s("7iEVm"),S=s("gn8Iu"),N=s("hmGuu");s("juhb3");var T=s("a3wIG"),D=s("mn9nW"),F=s("ilkKT"),O=0;var _="p_";function I(e){return e&&e.gradient}function R(e,t,n){var r=e.gradient,a=e.id,i="radial"===r?_:"";return a||(a=e.id="gradient_"+O++,"radial"===r?(e.x1=M(e.x1,.5),e.y1=M(e.y1,.5),e.r1=M(e.r1,0),e.x2=M(e.x2,.5),e.y2=M(e.y2,.5),e.r2=M(e.r2,.5),i=_):(e.x1=M(e.x1,0),e.y1=M(e.y1,0),e.x2=M(e.x2,1),e.y2=M(e.y2,0))),t[a]=e,"url("+(n||"")+"#"+i+a+")"}function M(e,t){return null!=e?e:t}function B(e,t){var n,r=[];return n={gradient:"linear",x1:e?e[0]:0,y1:e?e[1]:0,x2:t?t[0]:1,y2:t?t[1]:0,stops:r,stop:function(e,t){return r.push({offset:e,color:t}),n}}}var P={basis:{curve:u.default},"basis-closed":{curve:c.default},"basis-open":{curve:l.default},bundle:{curve:f.default,tension:"beta",value:.85},cardinal:{curve:d.default,tension:"tension",value:0},"cardinal-open":{curve:p.default,tension:"tension",value:0},"cardinal-closed":{curve:h.default,tension:"tension",value:0},"catmull-rom":{curve:v.default,tension:"alpha",value:.5},"catmull-rom-closed":{curve:g.default,tension:"alpha",value:.5},"catmull-rom-open":{curve:m.default,tension:"alpha",value:.5},linear:{curve:y.default},"linear-closed":{curve:x.default},monotone:{horizontal:b.monotoneY,vertical:b.monotoneX},natural:{curve:k.default},step:{curve:w.default},"step-after":{curve:w.stepAfter},"step-before":{curve:w.stepBefore}};function L(e,t,n){var r=o.hasOwnProperty(P,e)&&P[e],a=null;return r&&(a=r.curve||r[t||"vertical"],r.tension&&null!=n&&(a=a[r.tension](n))),a}var j={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},z=[/([MLHVCSQTAZmlhvcsqtaz])/g,/###/,/(\.\d+)(\.\d)/g,/(\d)([-+])/g,/\s|,|###/];function U(e){var t,n,r,a,i,o,u,s,c,l,f=[],d=e.slice().replace(z[0],"###$1").split(z[1]).slice(1);for(u=0,c=d.length;u<c;++u){for(n=(t=d[u]).slice(1).trim().replace(z[2],"$1###$2").replace(z[3],"$1###$2").split(z[4]),r=[i=t.charAt(0)],s=0,l=n.length;s<l;++s)(a=+n[s])===a&&r.push(a);if(o=j[i.toLowerCase()],r.length-1>o){var p=r.length;for(s=1,f.push([i].concat(r.slice(s,s+=o))),i="M"===i?"L":"m"===i?"l":i;s<p;s+=o)f.push([i].concat(r.slice(s,s+o)))}else f.push(r)}return f}var V=Math.PI/180,W=Math.PI/2,G=2*Math.PI,H=Math.sqrt(3)/2,q={},J={},K=[].join;function X(e){var t=K.call(e);if(J[t])return J[t];var n=e[0],r=e[1],a=e[2],i=e[3],o=e[4],u=e[5],s=e[6],c=e[7],l=c*o,f=-s*u,d=s*o,p=c*u,h=Math.cos(a),v=Math.sin(a),g=Math.cos(i),m=Math.sin(i),y=.5*(i-a),x=Math.sin(.5*y),b=8/3*x*x/Math.sin(y),k=n+h-b*v,w=r+v+b*h,A=n+g,E=r+m,C=A+b*m,S=E-b*g;return J[t]=[l*k+f*w,d*k+p*w,l*C+f*S,d*C+p*S,l*A+f*E,d*A+p*E]}var Y=["l",0,0,0,0,0,0,0];function Q(e,t,n){var r=Y[0]=e[0];if("a"===r||"A"===r)Y[1]=t*e[1],Y[2]=n*e[2],Y[3]=e[3],Y[4]=e[4],Y[5]=e[5],Y[6]=t*e[6],Y[7]=n*e[7];else if("h"===r||"H"===r)Y[1]=t*e[1];else if("v"===r||"V"===r)Y[1]=n*e[1];else for(var a=1,i=e.length;a<i;++a)Y[a]=(a%2==1?t:n)*e[a];return Y}function Z(e,t,n,r,a,i){var o,u,s,c,l,f=null,d=0,p=0,h=0,v=0;null==n&&(n=0),null==r&&(r=0),null==a&&(a=1),null==i&&(i=a),e.beginPath&&e.beginPath();for(var g=0,m=t.length;g<m;++g){switch(o=t[g],1===a&&1===i||(o=Q(o,a,i)),o[0]){case"l":d+=o[1],p+=o[2],e.lineTo(d+n,p+r);break;case"L":d=o[1],p=o[2],e.lineTo(d+n,p+r);break;case"h":d+=o[1],e.lineTo(d+n,p+r);break;case"H":d=o[1],e.lineTo(d+n,p+r);break;case"v":p+=o[1],e.lineTo(d+n,p+r);break;case"V":p=o[1],e.lineTo(d+n,p+r);break;case"m":d+=o[1],p+=o[2],e.moveTo(d+n,p+r);break;case"M":d=o[1],p=o[2],e.moveTo(d+n,p+r);break;case"c":u=d+o[5],s=p+o[6],h=d+o[3],v=p+o[4],e.bezierCurveTo(d+o[1]+n,p+o[2]+r,h+n,v+r,u+n,s+r),d=u,p=s;break;case"C":d=o[5],p=o[6],h=o[3],v=o[4],e.bezierCurveTo(o[1]+n,o[2]+r,h+n,v+r,d+n,p+r);break;case"s":u=d+o[3],s=p+o[4],h=2*d-h,v=2*p-v,e.bezierCurveTo(h+n,v+r,d+o[1]+n,p+o[2]+r,u+n,s+r),h=d+o[1],v=p+o[2],d=u,p=s;break;case"S":u=o[3],s=o[4],h=2*d-h,v=2*p-v,e.bezierCurveTo(h+n,v+r,o[1]+n,o[2]+r,u+n,s+r),d=u,p=s,h=o[1],v=o[2];break;case"q":u=d+o[3],s=p+o[4],h=d+o[1],v=p+o[2],e.quadraticCurveTo(h+n,v+r,u+n,s+r),d=u,p=s;break;case"Q":u=o[3],s=o[4],e.quadraticCurveTo(o[1]+n,o[2]+r,u+n,s+r),d=u,p=s,h=o[1],v=o[2];break;case"t":u=d+o[1],s=p+o[2],null===f[0].match(/[QqTt]/)?(h=d,v=p):"t"===f[0]?(h=2*d-c,v=2*p-l):"q"===f[0]&&(h=2*d-h,v=2*p-v),c=h,l=v,e.quadraticCurveTo(h+n,v+r,u+n,s+r),p=s,h=(d=u)+o[1],v=p+o[2];break;case"T":u=o[1],s=o[2],h=2*d-h,v=2*p-v,e.quadraticCurveTo(h+n,v+r,u+n,s+r),d=u,p=s;break;case"a":$(e,d+n,p+r,[o[1],o[2],o[3],o[4],o[5],o[6]+d+n,o[7]+p+r]),d+=o[6],p+=o[7];break;case"A":$(e,d+n,p+r,[o[1],o[2],o[3],o[4],o[5],o[6]+n,o[7]+r]),d=o[6],p=o[7];break;case"z":case"Z":e.closePath()}f=o}}function $(e,t,n,r){for(var a=function(e,t,n,r,a,i,o,u,s){var c=K.call(arguments);if(q[c])return q[c];var l=o*V,f=Math.sin(l),d=Math.cos(l),p=d*(u-e)*.5+f*(s-t)*.5,h=d*(s-t)*.5-f*(u-e)*.5,v=p*p/((n=Math.abs(n))*n)+h*h/((r=Math.abs(r))*r);v>1&&(n*=v=Math.sqrt(v),r*=v);var g=d/n,m=f/n,y=-f/r,x=d/r,b=g*u+m*s,k=y*u+x*s,w=g*e+m*t,A=y*e+x*t,E=1/((w-b)*(w-b)+(A-k)*(A-k))-.25;E<0&&(E=0);var C=Math.sqrt(E);i==a&&(C=-C);var S=.5*(b+w)-C*(A-k),N=.5*(k+A)+C*(w-b),T=Math.atan2(k-N,b-S),D=Math.atan2(A-N,w-S)-T;D<0&&1===i?D+=G:D>0&&0===i&&(D-=G);for(var F=Math.ceil(Math.abs(D/(W+.001))),O=[],_=0;_<F;++_){var I=T+_*D/F,R=T+(_+1)*D/F;O[_]=[S,N,I,R,n,r,f,d]}return q[c]=O}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],t,n),i=0;i<a.length;++i){var o=X(a[i]);e.bezierCurveTo(o[0],o[1],o[2],o[3],o[4],o[5])}}var ee=.5773502691896257,te={circle:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(n,0),e.arc(0,0,n,0,G)}},cross:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/2.5;e.moveTo(-n,-r),e.lineTo(-n,r),e.lineTo(-r,r),e.lineTo(-r,n),e.lineTo(r,n),e.lineTo(r,r),e.lineTo(n,r),e.lineTo(n,-r),e.lineTo(r,-r),e.lineTo(r,-n),e.lineTo(-r,-n),e.lineTo(-r,-r),e.closePath()}},diamond:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(0,-n),e.lineTo(n,0),e.lineTo(0,n),e.closePath()}},square:{draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}},arrow:{draw:function(e,t){var n=Math.sqrt(t)/2,r=n/7,a=n/2.5,i=n/8;e.moveTo(-r,n),e.lineTo(r,n),e.lineTo(r,-i),e.lineTo(a,-i),e.lineTo(0,-n),e.lineTo(-a,-i),e.lineTo(-r,-i),e.closePath()}},wedge:{draw:function(e,t){var n=Math.sqrt(t)/2,r=H*n,a=r-n*ee,i=n/4;e.moveTo(0,-r-a),e.lineTo(-i,r-a),e.lineTo(i,r-a),e.closePath()}},triangle:{draw:function(e,t){var n=Math.sqrt(t)/2,r=H*n,a=r-n*ee;e.moveTo(0,-r-a),e.lineTo(-n,r-a),e.lineTo(n,r-a),e.closePath()}},"triangle-up":{draw:function(e,t){var n=Math.sqrt(t)/2,r=H*n;e.moveTo(0,-r),e.lineTo(-n,r),e.lineTo(n,r),e.closePath()}},"triangle-down":{draw:function(e,t){var n=Math.sqrt(t)/2,r=H*n;e.moveTo(0,r),e.lineTo(-n,-r),e.lineTo(n,-r),e.closePath()}},"triangle-right":{draw:function(e,t){var n=Math.sqrt(t)/2,r=H*n;e.moveTo(r,0),e.lineTo(-r,-n),e.lineTo(-r,n),e.closePath()}},"triangle-left":{draw:function(e,t){var n=Math.sqrt(t)/2,r=H*n;e.moveTo(-r,0),e.lineTo(r,-n),e.lineTo(r,n),e.closePath()}},stroke:{draw:function(e,t){var n=Math.sqrt(t)/2;e.moveTo(-n,0),e.lineTo(n,0)}}};function ne(e){return o.hasOwnProperty(te,e)?te[e]:function(e){if(!o.hasOwnProperty(re,e)){var t=U(e);re[e]={draw:function(e,n){Z(e,t,0,0,Math.sqrt(n)/2)}}}return re[e]}(e)}var re={};var ae=.448084975506;function ie(e){return e.x}function oe(e){return e.y}function ue(e){return e.width}function se(e){return e.height}function ce(e){return"function"==typeof e?e:function(){return+e}}function le(e,t,n){return Math.max(t,Math.min(e,n))}function fe(){var e=ie,t=oe,n=ue,r=se,a=ce(0),i=a,o=a,u=a,s=null;function c(c,l,f){var d,p=null!=l?l:+e.call(this,c),h=null!=f?f:+t.call(this,c),v=+n.call(this,c),g=+r.call(this,c),m=Math.min(v,g)/2,y=le(+a.call(this,c),0,m),x=le(+i.call(this,c),0,m),b=le(+o.call(this,c),0,m),k=le(+u.call(this,c),0,m);if(s||(s=d=N.default()),y<=0&&x<=0&&b<=0&&k<=0)s.rect(p,h,v,g);else{var w=p+v,A=h+g;s.moveTo(p+y,h),s.lineTo(w-x,h),s.bezierCurveTo(w-ae*x,h,w,h+ae*x,w,h+x),s.lineTo(w,A-k),s.bezierCurveTo(w,A-ae*k,w-ae*k,A,w-k,A),s.lineTo(p+b,A),s.bezierCurveTo(p+ae*b,A,p,A-ae*b,p,A-b),s.lineTo(p,h+y),s.bezierCurveTo(p,h+ae*y,p+ae*y,h,p+y,h),s.closePath()}if(d)return s=null,d+""||null}return c.x=function(t){return arguments.length?(e=ce(t),c):e},c.y=function(e){return arguments.length?(t=ce(e),c):t},c.width=function(e){return arguments.length?(n=ce(e),c):n},c.height=function(e){return arguments.length?(r=ce(e),c):r},c.cornerRadius=function(e,t,n,r){return arguments.length?(a=ce(e),i=null!=t?ce(t):a,u=null!=n?ce(n):a,o=null!=r?ce(r):i,c):a},c.context=function(e){return arguments.length?(s=null==e?null:e,c):s},c}function de(){var e,t,n,r,a,i,o,u,s=null;function c(e,t,n){var r=n/2;if(a){var c=o-t,l=e-i;if(c||l){var f=Math.sqrt(c*c+l*l),d=(c/=f)*u,p=(l/=f)*u,h=Math.atan2(l,c);s.moveTo(i-d,o-p),s.lineTo(e-c*r,t-l*r),s.arc(e,t,r,h-Math.PI,h),s.lineTo(i+d,o+p),s.arc(i,o,u,h,h+Math.PI)}else s.arc(e,t,r,0,G);s.closePath()}else a=1;i=e,o=t,u=r}function l(i){var o,u,l,f=i.length,d=!1;for(null==s&&(s=l=N.default()),o=0;o<=f;++o)!(o<f&&r(u=i[o],o,i))===d&&(d=!d)&&(a=0),d&&c(+e(u,o,i),+t(u,o,i),+n(u,o,i));if(l)return s=null,l+""||null}return l.x=function(t){return arguments.length?(e=t,l):e},l.y=function(e){return arguments.length?(t=e,l):t},l.size=function(e){return arguments.length?(n=e,l):n},l.defined=function(e){return arguments.length?(r=e,l):r},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}function pe(e,t){return null!=e?e:t}var he=function(e){return e.x||0},ve=function(e){return e.y||0},ge=function(e){return!(!1===e.defined)},me=A.default().startAngle((function(e){return e.startAngle||0})).endAngle((function(e){return e.endAngle||0})).padAngle((function(e){return e.padAngle||0})).innerRadius((function(e){return e.innerRadius||0})).outerRadius((function(e){return e.outerRadius||0})).cornerRadius((function(e){return e.cornerRadius||0})),ye=E.default().x(he).y1(ve).y0((function(e){return(e.y||0)+(e.height||0)})).defined(ge),xe=E.default().y(ve).x1(he).x0((function(e){return(e.x||0)+(e.width||0)})).defined(ge),be=C.default().x(he).y(ve).defined(ge),ke=fe().x(he).y(ve).width((function(e){return e.width||0})).height((function(e){return e.height||0})).cornerRadius((function(e){return pe(e.cornerRadiusTopLeft,e.cornerRadius)||0}),(function(e){return pe(e.cornerRadiusTopRight,e.cornerRadius)||0}),(function(e){return pe(e.cornerRadiusBottomRight,e.cornerRadius)||0}),(function(e){return pe(e.cornerRadiusBottomLeft,e.cornerRadius)||0})),we=S.default().type((function(e){return ne(e.shape||"circle")})).size((function(e){return pe(e.size,64)})),Ae=de().x(he).y(ve).defined(ge).size((function(e){return e.size||1}));function Ee(e){return e.cornerRadius||e.cornerRadiusTopLeft||e.cornerRadiusTopRight||e.cornerRadiusBottomRight||e.cornerRadiusBottomLeft}function Ce(e,t,n,r){return ke.context(e)(t,n,r)}var Se=1;function Ne(){Se=1}function Te(e,t,n){var r=t.clip,a=e._defs,i=t.clip_id||(t.clip_id="clip"+Se++),u=a.clipping[i]||(a.clipping[i]={id:i});return o.isFunction(r)?u.path=r(null):Ee(n)?u.path=Ce(null,n,0,0):(u.width=n.width||0,u.height=n.height||0),"url(#"+i+")"}function De(e){this.clear(),e&&this.union(e)}function Fe(e){this.mark=e,this.bounds=this.bounds||new De}function Oe(e){Fe.call(this,e),this.items=this.items||[]}function _e(e){this._pending=0,this._loader=e||D.loader()}function Ie(e){e._pending+=1}function Re(e){e._pending-=1}function Me(e,t,n){if(t.stroke&&0!==t.opacity&&0!==t.strokeOpacity){var r=null!=t.strokeWidth?+t.strokeWidth:1;e.expand(r+(n?function(e,t){return e.strokeJoin&&"miter"!==e.strokeJoin?0:t}(t,r):0))}return e}De.prototype={clone:function(){return new De(this)},clear:function(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty:function(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals:function(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2},set:function(e,t,n,r){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),r<t?(this.y2=t,this.y1=r):(this.y1=t,this.y2=r),this},add:function(e,t){return e<this.x1&&(this.x1=e),t<this.y1&&(this.y1=t),e>this.x2&&(this.x2=e),t>this.y2&&(this.y2=t),this},expand:function(e){return this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e,this},round:function(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale:function(e){return this.x1*=e,this.y1*=e,this.x2*=e,this.y2*=e,this},translate:function(e,t){return this.x1+=e,this.x2+=e,this.y1+=t,this.y2+=t,this},rotate:function(e,t,n){var r=this.rotatedPoints(e,t,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints:function(e,t,n){var r=this,a=r.x1,i=r.y1,o=r.x2,u=r.y2,s=Math.cos(e),c=Math.sin(e),l=t-t*s+n*c,f=n-t*c-n*s;return[s*a-c*i+l,c*a+s*i+f,s*a-c*u+l,c*a+s*u+f,s*o-c*i+l,c*o+s*i+f,s*o-c*u+l,c*o+s*u+f]},union:function(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this},intersect:function(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this},encloses:function(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2},alignsWith:function(e){return e&&(this.x1==e.x1||this.x2==e.x2||this.y1==e.y1||this.y2==e.y2)},intersects:function(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)},contains:function(e,t){return!(e<this.x1||e>this.x2||t<this.y1||t>this.y2)},width:function(){return this.x2-this.x1},height:function(){return this.y2-this.y1}},o.inherits(Oe,Fe),_e.prototype={pending:function(){return this._pending},sanitizeURL:function(e){var t=this;return Ie(t),t._loader.sanitize(e,{context:"href"}).then((function(e){return Re(t),e})).catch((function(){return Re(t),null}))},loadImage:function(e){var t=this,n=T.domImage();return Ie(t),t._loader.sanitize(e,{context:"image"}).then((function(e){var r=e.href;if(!r||!n)throw{url:r};var a=new n,i=o.hasOwnProperty(e,"crossOrigin")?e.crossOrigin:"anonymous";return null!=i&&(a.crossOrigin=i),a.onload=function(){return Re(t)},a.onerror=function(){return Re(t)},a.src=r,a})).catch((function(e){return Re(t),{complete:!1,width:0,height:0,src:e&&e.url||""}}))},ready:function(){var e=this;return new Promise((function(t){!function n(r){e.pending()?setTimeout((function(){n(!0)}),10):t(r)}(!1)}))}};var Be,Pe,Le,je,ze,Ue,Ve,We,Ge=G-1e-8,He=function(e,t){return Be.add(e,t)},qe=function(e,t){return He(Pe=e,Le=t)},Je=function(e){return He(e,Be.y1)},Ke=function(e){return He(Be.x1,e)},Xe=function(e,t){return ze*e+Ve*t},Ye=function(e,t){return Ue*e+We*t},Qe=function(e,t){return He(Xe(e,t),Ye(e,t))},Ze=function(e,t){return qe(Xe(e,t),Ye(e,t))};function $e(e,t){return Be=e,t?(je=t*V,ze=We=Math.cos(je),Ue=Math.sin(je),Ve=-Ue):(ze=We=1,je=Ue=Ve=0),et}var et={beginPath:function(){},closePath:function(){},moveTo:Ze,lineTo:Ze,rect:function(e,t,n,r){je?(Qe(e+n,t),Qe(e+n,t+r),Qe(e,t+r),Ze(e,t)):(He(e+n,t+r),qe(e,t))},quadraticCurveTo:function(e,t,n,r){var a=Xe(e,t),i=Ye(e,t),o=Xe(n,r),u=Ye(n,r);tt(Pe,a,o,Je),tt(Le,i,u,Ke),qe(o,u)},bezierCurveTo:function(e,t,n,r,a,i){var o=Xe(e,t),u=Ye(e,t),s=Xe(n,r),c=Ye(n,r),l=Xe(a,i),f=Ye(a,i);nt(Pe,o,s,l,Je),nt(Le,u,c,f,Ke),qe(l,f)},arc:function(e,t,n,r,a,i){if(r+=je,a+=je,Pe=n*Math.cos(a)+e,Le=n*Math.sin(a)+t,Math.abs(a-r)>Ge)He(e-n,t-n),He(e+n,t+n);else{var o,u,s=function(r){return He(n*Math.cos(r)+e,n*Math.sin(r)+t)};if(s(r),s(a),a!==r)if((r%=G)<0&&(r+=G),(a%=G)<0&&(a+=G),a<r&&(i=!i,o=r,r=a,a=o),i)for(a-=G,o=r-r%W,u=0;u<4&&o>a;++u,o-=W)s(o);else for(o=r-r%W+W,u=0;u<4&&o<a;++u,o+=W)s(o)}}};function tt(e,t,n,r){var a=(e-t)/(e+n-2*t);0<a&&a<1&&r(e+(t-e)*a)}function nt(e,t,n,r,a){var i,o=r-e+3*t-3*n,u=e+n-2*t,s=e-t,c=0,l=0;Math.abs(o)>1e-14?(i=u*u+s*o)>=0&&(c=(-u+(i=Math.sqrt(i)))/o,l=(-u-i)/o):c=.5*s/u,0<c&&c<1&&a(rt(c,e,t,n,r)),0<l&&l<1&&a(rt(l,e,t,n,r))}function rt(e,t,n,r,a){var i=1-e,o=i*i,u=e*e;return o*i*t+3*o*e*n+3*i*u*r+u*e*a}var at=(at=T.domCanvas(1,1))?at.getContext("2d"):null,it=new De;function ot(e){return function(t,n){if(!at)return!0;e(at,t),it.clear().union(t.bounds).intersect(n).round();for(var r=it.x1,a=it.y1,i=it.x2,o=it.y2,u=a;u<=o;++u)for(var s=r;s<=i;++s)if(at.isPointInPath(s,u))return!0;return!1}}function ut(e,t){return t.contains(e.x||0,e.y||0)}function st(e,t){var n=e.x||0,r=e.y||0,a=e.width||0,i=e.height||0;return t.intersects(it.set(n,r,n+a,r+i))}function ct(e,t){var n=e.x||0,r=e.y||0;return lt(t,n,r,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r)}function lt(e,t,n,r,a){var i,o,u,s,c=e.x1,l=e.y1,f=e.x2,d=e.y2,p=r-t,h=a-n,v=0,g=1;for(s=0;s<4;++s){if(0===s&&(i=-p,o=-(c-t)),1===s&&(i=p,o=f-t),2===s&&(i=-h,o=-(l-n)),3===s&&(i=h,o=d-n),Math.abs(i)<1e-10&&o<0)return!1;if(u=o/i,i<0){if(u>g)return!1;u>v&&(v=u)}else if(i>0){if(u<v)return!1;u<g&&(g=u)}}return!0}function ft(e,t){e.globalCompositeOperation=t.blend||"source-over"}function dt(e,t){return null==e?t:e}function pt(e,t){for(var n=t.length,r=0;r<n;++r)e.addColorStop(t[r].offset,t[r].color);return e}function ht(e,t,n){return I(n)?function(e,t,n){var r,a=n.width(),i=n.height();if("radial"===t.gradient)r=e.createRadialGradient(n.x1+dt(t.x1,.5)*a,n.y1+dt(t.y1,.5)*i,Math.max(a,i)*dt(t.r1,0),n.x1+dt(t.x2,.5)*a,n.y1+dt(t.y2,.5)*i,Math.max(a,i)*dt(t.r2,.5));else{var o=dt(t.x1,0),u=dt(t.y1,0),s=dt(t.x2,1),c=dt(t.y2,0);if(o!==s&&u!==c&&a!==i){var l=T.domCanvas(Math.ceil(a),Math.ceil(i)),f=l.getContext("2d");return f.scale(a,i),f.fillStyle=pt(f.createLinearGradient(o,u,s,c),t.stops),f.fillRect(0,0,a,i),e.createPattern(l,"no-repeat")}r=e.createLinearGradient(n.x1+o*a,n.y1+u*i,n.x1+s*a,n.y1+c*i)}return pt(r,t.stops)}(e,n,t.bounds):n}function vt(e,t,n){return(n*=null==t.fillOpacity?1:t.fillOpacity)>0&&(e.globalAlpha=n,e.fillStyle=ht(e,t,t.fill),!0)}var gt=[];function mt(e,t,n){var r=null!=(r=t.strokeWidth)?r:1;return!(r<=0)&&((n*=null==t.strokeOpacity?1:t.strokeOpacity)>0&&(e.globalAlpha=n,e.strokeStyle=ht(e,t,t.stroke),e.lineWidth=r,e.lineCap=t.strokeCap||"butt",e.lineJoin=t.strokeJoin||"miter",e.miterLimit=t.strokeMiterLimit||10,e.setLineDash&&(e.setLineDash(t.strokeDash||gt),e.lineDashOffset=t.strokeDashOffset||0),!0))}function yt(e,t){return e.zindex-t.zindex||e.index-t.index}function xt(e){if(!e.zdirty)return e.zitems;var t,n,r,a=e.items,i=[];for(n=0,r=a.length;n<r;++n)(t=a[n]).index=n,t.zindex&&i.push(t);return e.zdirty=!1,e.zitems=i.sort(yt)}function bt(e,t){var n,r,a=e.items;if(a&&a.length){var i=xt(e);if(i&&i.length){for(n=0,r=a.length;n<r;++n)a[n].zindex||t(a[n]);a=i}for(n=0,r=a.length;n<r;++n)t(a[n])}}function kt(e,t){var n,r,a=e.items;if(!a||!a.length)return null;var i=xt(e);for(i&&i.length&&(a=i),r=a.length;--r>=0;)if(n=t(a[r]))return n;if(a===i)for(r=(a=e.items).length;--r>=0;)if(!a[r].zindex&&(n=t(a[r])))return n;return null}function wt(e){return function(t,n,r){bt(n,(function(n){r&&!r.intersects(n.bounds)||At(e,t,n,n)}))}}function At(e,t,n,r){var a=null==n.opacity?1:n.opacity;0!==a&&(e(t,r)||(ft(t,n),n.fill&&vt(t,n,a)&&t.fill(),n.stroke&&mt(t,n,a)&&t.stroke()))}function Et(e){return e=e||o.truthy,function(t,n,r,a,i,o){return r*=t.pixelRatio,a*=t.pixelRatio,kt(n,(function(n){var u=n.bounds;if((!u||u.contains(i,o))&&u)return e(t,n,r,a,i,o)?n:void 0}))}}function Ct(e,t){return function(n,r,a,i){var o,u,s=Array.isArray(r)?r[0]:r,c=null==t?s.fill:t,l=s.stroke&&n.isPointInStroke;return l&&(o=s.strokeWidth,u=s.strokeCap,n.lineWidth=null!=o?o:1,n.lineCap=null!=u?u:"butt"),!e(n,r)&&(c&&n.isPointInPath(a,i)||l&&n.isPointInStroke(a,i))}}function St(e){return Et(Ct(e))}function Nt(e,t){return"translate("+e+","+t+")"}function Tt(e){return"rotate("+e+")"}function Dt(e){return Nt(e.x||0,e.y||0)}function Ft(e,t,n){function r(e,n){var r=n.x||0,a=n.y||0,i=n.angle||0;e.translate(r,a),i&&e.rotate(i*=V),e.beginPath(),t(e,n),i&&e.rotate(-i),e.translate(-r,-a)}return{type:e,tag:"path",nested:!1,attr:function(e,n){e("transform",function(e){return Nt(e.x||0,e.y||0)+(e.angle?" "+Tt(e.angle):"")}(n)),e("d",t(null,n))},bound:function(e,n){return t($e(e,n.angle),n),Me(e,n).translate(n.x||0,n.y||0)},draw:wt(r),pick:St(r),isect:n||ot(r)}}var Ot=Ft("arc",(function(e,t){return me.context(e)(t)}));function _t(e,t,n){function r(e,n){e.beginPath(),t(e,n)}var a,i=Ct(r);return{type:e,tag:"path",nested:!0,attr:function(e,n){var r=n.mark.items;r.length&&e("d",t(null,r))},bound:function(e,n){var r=n.items;return 0===r.length?e:(t($e(e),r),Me(e,r[0]))},draw:(a=r,function(e,t,n){!t.items.length||n&&!n.intersects(t.bounds)||At(a,e,t.items[0],t.items)}),pick:function(e,t,n,r,a,o){var u=t.items,s=t.bounds;return!u||!u.length||s&&!s.contains(a,o)?null:(n*=e.pixelRatio,r*=e.pixelRatio,i(e,u,n,r)?u[0]:null)},isect:ut,tip:n}}var It=_t("area",(function(e,t){var n=t[0],r=n.interpolate||"linear";return("horizontal"===n.orient?xe:ye).curve(L(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a="horizontal"===e[0].orient?t[1]:t[0],i="horizontal"===e[0].orient?"y":"x",o=e.length,u=1/0;--o>=0;)!1!==e[o].defined&&(r=Math.abs(e[o][i]-a))<u&&(u=r,n=e[o]);return n}));function Rt(e,t){e.beginPath(),Ee(t)?Ce(e,t,0,0):e.rect(0,0,t.width||0,t.height||0),e.clip()}function Mt(e){var t=dt(e.strokeWidth,1);return null!=e.strokeOffset?e.strokeOffset:e.stroke&&t>.5&&t<1.5?.5-Math.abs(t-1):0}function Bt(e,t){var n=Mt(t);e("d",Ce(null,t,n,n))}function Pt(e,t,n,r){var a=Mt(t);e.beginPath(),Ce(e,t,(n||0)+a,(r||0)+a)}var Lt=Ct(Pt),jt=Ct(Pt,!1),zt=Ct(Pt,!0);var Ut={type:"group",tag:"g",nested:!1,attr:function(e,t){e("transform",Dt(t))},bound:function(e,t){if(!t.clip&&t.items)for(var n=t.items,r=n.length,a=0;a<r;++a)e.union(n[a].bounds);return(t.clip||t.width||t.height)&&!t.noBound&&e.add(0,0).add(t.width||0,t.height||0),Me(e,t),e.translate(t.x||0,t.y||0)},draw:function(e,t,n){var r=this;bt(t,(function(t){var a=r,i=t.x||0,o=t.y||0,u=t.strokeForeground,s=null==t.opacity?1:t.opacity;(t.stroke||t.fill)&&s&&(Pt(e,t,i,o),ft(e,t),t.fill&&vt(e,t,s)&&e.fill(),t.stroke&&!u&&mt(e,t,s)&&e.stroke()),e.save(),e.translate(i,o),t.clip&&Rt(e,t),n&&n.translate(-i,-o),bt(t,(function(t){a.draw(e,t,n)})),n&&n.translate(i,o),e.restore(),u&&t.stroke&&s&&(Pt(e,t,i,o),ft(e,t),mt(e,t,s)&&e.stroke())}))},pick:function(e,t,n,r,a,i){var o=this;if(t.bounds&&!t.bounds.contains(a,i)||!t.items)return null;var u=n*e.pixelRatio,s=r*e.pixelRatio;return kt(t,(function(c){var l,f,d,p=o,h=c.bounds;if(!h||h.contains(a,i)){f=c.x||0,d=c.y||0;var v=f+(c.width||0),g=d+(c.height||0),m=c.clip;if(!m||!(a<f||a>v||i<d||i>g)){if(e.save(),e.translate(f,d),f=a-f,d=i-d,m&&Ee(c)&&!zt(e,c,u,s))return e.restore(),null;var y=c.strokeForeground,x=!1!==t.interactive;return x&&y&&c.stroke&&jt(e,c,u,s)?(e.restore(),c):(!(l=kt(c,(function(e){return function(e,t,n){return(!1!==e.interactive||"group"===e.marktype)&&e.bounds&&e.bounds.contains(t,n)}(e,f,d)?p.pick(e,n,r,f,d):null})))&&x&&(c.fill||!y&&c.stroke)&&Lt(e,c,u,s)&&(l=c),e.restore(),l||null)}}}))},isect:st,content:function(e,t,n){e("clip-path",t.clip?Te(n,t,t):null)},background:function(e,t){e("class","background"),e("aria-hidden",!0),Bt(e,t)},foreground:function(e,t){e("class","foreground"),e("aria-hidden",!0),t.strokeForeground?Bt(e,t):e("d","")}},Vt={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function Wt(e,t){var n=e.image;return(!n||e.url&&e.url!==n.url)&&(n={complete:!1,width:0,height:0},t.loadImage(e.url).then((function(t){e.image=t,e.image.url=e.url}))),n}function Gt(e,t){return null!=e.width?e.width:t&&t.width?!1!==e.aspect&&e.height?e.height*t.width/t.height:t.width:0}function Ht(e,t){return null!=e.height?e.height:t&&t.height?!1!==e.aspect&&e.width?e.width*t.height/t.width:t.height:0}function qt(e,t){return"center"===e?t/2:"right"===e?t:0}function Jt(e,t){return"middle"===e?t/2:"bottom"===e?t:0}var Kt={type:"image",tag:"image",nested:!1,attr:function(e,t,n){var r=Wt(t,n),a=Gt(t,r),i=Ht(t,r),o=(t.x||0)-qt(t.align,a),u=(t.y||0)-Jt(t.baseline,i);e("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",Vt["xmlns:xlink"],"xlink:href"),e("transform",Nt(o,u)),e("width",a),e("height",i),e("preserveAspectRatio",!1===t.aspect?"none":"xMidYMid")},bound:function(e,t){var n=t.image,r=Gt(t,n),a=Ht(t,n),i=(t.x||0)-qt(t.align,r),o=(t.y||0)-Jt(t.baseline,a);return e.set(i,o,i+r,o+a)},draw:function(e,t,n){var r=this;bt(t,(function(t){if(!n||n.intersects(t.bounds)){var a=Wt(t,r),i=Gt(t,a),o=Ht(t,a);if(0!==i&&0!==o){var u,s,c,l,f=(t.x||0)-qt(t.align,i),d=(t.y||0)-Jt(t.baseline,o);!1!==t.aspect&&(s=a.width/a.height,c=t.width/t.height,s==s&&c==c&&s!==c&&(c<s?(d+=(o-(l=i/s))/2,o=l):(f+=(i-(l=o*s))/2,i=l))),(a.complete||a.toDataURL)&&(ft(e,t),e.globalAlpha=null!=(u=t.opacity)?u:1,e.imageSmoothingEnabled=!1!==t.smooth,e.drawImage(a,f,d,i,o))}}}))},pick:Et(),isect:o.truthy,get:Wt,xOffset:qt,yOffset:Jt},Xt=_t("line",(function(e,t){var n=t[0],r=n.interpolate||"linear";return be.curve(L(r,n.orient,n.tension)).context(e)(t)}),(function(e,t){for(var n,r,a=Math.pow(e[0].strokeWidth||1,2),i=e.length;--i>=0;)if(!1!==e[i].defined&&(n=e[i].x-t[0])*n+(r=e[i].y-t[1])*r<a)return e[i];return null}));function Yt(e,t){var n=t.path;if(null==n)return!0;var r=t.x||0,a=t.y||0,i=t.scaleX||1,o=t.scaleY||1,u=(t.angle||0)*V,s=t.pathCache;s&&s.path===n||((t.pathCache=s=U(n)).path=n),u&&e.rotate&&e.translate?(e.translate(r,a),e.rotate(u),Z(e,s,0,0,i,o),e.rotate(-u),e.translate(-r,-a)):Z(e,s,r,a,i,o)}var Qt={type:"path",tag:"path",nested:!1,attr:function(e,t){var n=t.scaleX||1,r=t.scaleY||1;1===n&&1===r||e("vector-effect","non-scaling-stroke"),e("transform",function(e){return Nt(e.x||0,e.y||0)+(e.angle?" "+Tt(e.angle):"")+(e.scaleX||e.scaleY?" "+(t=e.scaleX||1,n=e.scaleY||1,"scale("+t+","+n+")"):"");var t,n}(t)),e("d",t.path)},bound:function(e,t){return Yt($e(e,t.angle),t)?e.set(0,0,0,0):Me(e,t,!0)},draw:wt(Yt),pick:St(Yt),isect:ot(Yt)};function Zt(e,t){e.beginPath(),Ce(e,t)}var $t={type:"rect",tag:"path",nested:!1,attr:function(e,t){e("d",Ce(null,t))},bound:function(e,t){var n,r;return Me(e.set(n=t.x||0,r=t.y||0,n+t.width||0,r+t.height||0),t)},draw:wt(Zt),pick:St(Zt),isect:st};function en(e,t,n){var r,a,i,o;return!(!t.stroke||!mt(e,t,n))&&(r=t.x||0,a=t.y||0,i=null!=t.x2?t.x2:r,o=null!=t.y2?t.y2:a,e.beginPath(),e.moveTo(r,a),e.lineTo(i,o),!0)}var tn={type:"rule",tag:"line",nested:!1,attr:function(e,t){e("transform",Dt(t)),e("x2",null!=t.x2?t.x2-(t.x||0):0),e("y2",null!=t.y2?t.y2-(t.y||0):0)},bound:function(e,t){var n,r;return Me(e.set(n=t.x||0,r=t.y||0,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r),t)},draw:function(e,t,n){bt(t,(function(t){if(!n||n.intersects(t.bounds)){var r=null==t.opacity?1:t.opacity;r&&en(e,t,r)&&(ft(e,t),e.stroke())}}))},pick:Et((function(e,t,n,r){return!!e.isPointInStroke&&(en(e,t,1)&&e.isPointInStroke(n,r))})),isect:ct},nn=Ft("shape",(function(e,t){return(t.mark.shape||t.shape).context(e)(t)})),rn=Ft("symbol",(function(e,t){return we.context(e)(t)}),ut),an=o.lruCache(),on={height:dn,measureWidth:ln,estimateWidth:sn,width:sn,canvas:un};function un(e){on.width=e&&at?ln:sn}function sn(e,t){return cn(gn(e,t),dn(e))}function cn(e,t){return~~(.8*e.length*t)}function ln(e,t){return dn(e)<=0||!(t=gn(e,t))?0:fn(t,yn(e))}function fn(e,t){var n="(".concat(t,") ").concat(e),r=an.get(n);return void 0===r&&(at.font=t,r=at.measureText(e).width,an.set(n,r)),r}function dn(e){return null!=e.fontSize?+e.fontSize||0:11}function pn(e){return null!=e.lineHeight?e.lineHeight:dn(e)+2}function hn(e){return t=e.lineBreak&&e.text&&!o.isArray(e.text)?e.text.split(e.lineBreak):e.text,o.isArray(t)?t.length>1?t:t[0]:t;var t}function vn(e){var t=hn(e);return(o.isArray(t)?t.length-1:0)*pn(e)}function gn(e,t){var n=null==t?"":(t+"").trim();return e.limit>0&&n.length?function(e,t){var n=+e.limit,r=function(e){if(on.width===ln){var t=yn(e);return function(e){return fn(e,t)}}var n=dn(e);return function(e){return cn(e,n)}}(e);if(r(t)<n)return t;var a,i=e.ellipsis||"",o="rtl"===e.dir,u=0,s=t.length;if(n-=r(i),o){for(;u<s;)a=u+s>>>1,r(t.slice(a))>n?u=a+1:s=a;return i+t.slice(u)}for(;u<s;)a=1+(u+s>>>1),r(t.slice(0,a))<n?u=a:s=a-1;return t.slice(0,u)+i}(e,n):n}function mn(e,t){var n=e.font;return(t&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function yn(e,t){return(e.fontStyle?e.fontStyle+" ":"")+(e.fontVariant?e.fontVariant+" ":"")+(e.fontWeight?e.fontWeight+" ":"")+dn(e)+"px "+mn(e,t)}function xn(e){var t=e.baseline,n=dn(e);return Math.round("top"===t?.79*n:"middle"===t?.3*n:"bottom"===t?-.21*n:"line-top"===t?.29*n+.5*pn(e):"line-bottom"===t?.29*n-.5*pn(e):0)}un(!0);var bn={left:"start",center:"middle",right:"end"},kn=new De;function wn(e){var t,n=e.x||0,r=e.y||0,a=e.radius||0;return a&&(t=(e.theta||0)-W,n+=a*Math.cos(t),r+=a*Math.sin(t)),kn.x1=n,kn.y1=r,kn}function An(e,t,n){var r,a=on.height(t),i=t.align,u=wn(t),s=u.x1,c=u.y1,l=t.dx||0,f=(t.dy||0)+xn(t)-Math.round(.8*a),d=hn(t);if(o.isArray(d)?(a+=pn(t)*(d.length-1),r=d.reduce((function(e,n){return Math.max(e,on.width(t,n))}),0)):r=on.width(t,d),"center"===i?l-=r/2:"right"===i&&(l-=r),e.set(l+=s,f+=c,l+r,f+a),t.angle&&!n)e.rotate(t.angle*V,s,c);else if(2===n)return e.rotatedPoints(t.angle*V,s,c);return e}var En={type:"text",tag:"text",nested:!1,attr:function(e,t){var n,r=t.dx||0,a=(t.dy||0)+xn(t),i=wn(t),o=i.x1,u=i.y1,s=t.angle||0;e("text-anchor",bn[t.align]||"start"),s?(n=Nt(o,u)+" "+Tt(s),(r||a)&&(n+=" "+Nt(r,a))):n=Nt(o+r,u+a),e("transform",n)},bound:An,draw:function(e,t,n){bt(t,(function(t){var r,a,i,u,s,c,l,f=null==t.opacity?1:t.opacity;if(!(n&&!n.intersects(t.bounds)||0===f||t.fontSize<=0||null==t.text||0===t.text.length)){if(e.font=yn(t),e.textAlign=t.align||"left",a=(r=wn(t)).x1,i=r.y1,t.angle&&(e.save(),e.translate(a,i),e.rotate(t.angle*V),a=i=0),a+=t.dx||0,i+=(t.dy||0)+xn(t),c=hn(t),ft(e,t),o.isArray(c))for(s=pn(t),u=0;u<c.length;++u)l=gn(t,c[u]),t.fill&&vt(e,t,f)&&e.fillText(l,a,i),t.stroke&&mt(e,t,f)&&e.strokeText(l,a,i),i+=s;else l=gn(t,c),t.fill&&vt(e,t,f)&&e.fillText(l,a,i),t.stroke&&mt(e,t,f)&&e.strokeText(l,a,i);t.angle&&e.restore()}}))},pick:Et((function(e,t,n,r,a,i){if(t.fontSize<=0)return!1;if(!t.angle)return!0;var o=wn(t),u=o.x1,s=o.y1,c=An(kn,t,1),l=-t.angle*V,f=Math.cos(l),d=Math.sin(l),p=f*a-d*i+(u-f*u+d*s),h=d*a+f*i+(s-d*u-f*s);return c.contains(p,h)})),isect:function(e,t){var n=An(kn,e,2);return lt(t,n[0],n[1],n[2],n[3])||lt(t,n[0],n[1],n[4],n[5])||lt(t,n[4],n[5],n[6],n[7])||lt(t,n[2],n[3],n[6],n[7])}},Cn={arc:Ot,area:It,group:Ut,image:Kt,line:Xt,path:Qt,rect:$t,rule:tn,shape:nn,symbol:rn,text:En,trail:_t("trail",(function(e,t){return Ae.context(e)(t)}),(function(e,t){for(var n,r,a=e.length;--a>=0;)if(!1!==e[a].defined&&(n=e[a].x-t[0])*n+(r=e[a].y-t[1])*r<(n=e[a].size||1)*n)return e[a];return null}))};function Sn(e,t,n){var r=Cn[e.mark.marktype],a=t||r.bound;return r.nested&&(e=e.mark),a(e.bounds||(e.bounds=new De),e,n)}var Nn={mark:null};function Tn(e,t,n){var r,a,i,o,u=Cn[e.marktype],s=u.bound,c=e.items,l=c&&c.length;if(u.nested)return l?i=c[0]:(Nn.mark=e,i=Nn),o=Sn(i,s,n),t=t&&t.union(o)||o;if(t=t||e.bounds&&e.bounds.clear()||new De,l)for(r=0,a=c.length;r<a;++r)t.union(Sn(c[r],s,n));return e.bounds=t}var Dn=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function Fn(e,t){return JSON.stringify(e,Dn,t)}function On(e){return _n("string"==typeof e?JSON.parse(e):e)}function _n(e){var t,n,r,a=e.marktype,i=e.items;if(i)for(n=0,r=i.length;n<r;++n)t=a?"mark":"group",i[n][t]=e,i[n].zindex&&(i[n][t].zdirty=!0),"group"===(a||t)&&_n(i[n]);return a&&Tn(e),e}function In(e){arguments.length?this.root=On(e):(this.root=Rn({marktype:"group",name:"root",role:"frame"}),this.root.items=[new Oe(this.root)])}function Rn(e,t){var n={bounds:new De,clip:!!e.clip,group:t,interactive:!1!==e.interactive,items:[],marktype:e.marktype,name:e.name||void 0,role:e.role||void 0,zindex:e.zindex||0};return null!=e.aria&&(n.aria=e.aria),e.description&&(n.description=e.description),n}function Mn(e,t,n){return!e&&"undefined"!=typeof document&&document.createElement&&(e=document),e?n?e.createElementNS(n,t):e.createElement(t):null}function Bn(e,t){t=t.toLowerCase();for(var n=e.childNodes,r=0,a=n.length;r<a;++r)if(n[r].tagName.toLowerCase()===t)return n[r]}function Pn(e,t,n,r){var a,i=e.childNodes[t];return i&&i.tagName.toLowerCase()===n.toLowerCase()||(a=i||null,i=Mn(e.ownerDocument,n,r),e.insertBefore(i,a)),i}function Ln(e,t){for(var n=e.childNodes,r=n.length;r>t;)e.removeChild(n[--r]);return e}function jn(e){return"mark-"+e.marktype+(e.role?" role-"+e.role:"")+(e.name?" "+e.name:"")}function zn(e,t){var n=t.getBoundingClientRect();return[e.clientX-n.left-(t.clientLeft||0),e.clientY-n.top-(t.clientTop||0)]}function Un(e,t){this._active=null,this._handlers={},this._loader=e||D.loader(),this._tooltip=t||Vn}function Vn(e,t,n,r){e.element().setAttribute("title",r||"")}function Wn(e){this._el=null,this._bgcolor=null,this._loader=new _e(e)}In.prototype={toJSON:function(e){return Fn(this.root,e||0)},mark:function(e,t,n){var r=Rn(e,t=t||this.root.items[0]);return t.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}},Un.prototype={initialize:function(e,t,n){return this._el=e,this._obj=n||null,this.origin(t)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},origin:function(e){return arguments.length?(this._origin=e||[0,0],this):this._origin.slice()},scene:function(e){return arguments.length?(this._scene=e,this):this._scene},on:function(){},off:function(){},_handlerIndex:function(e,t,n){for(var r=e?e.length:0;--r>=0;)if(e[r].type===t&&(!n||e[r].handler===n))return r;return-1},handlers:function(e){var t,n,a=this._handlers,i=[];if(e)(t=i).push.apply(t,r.default(a[this.eventName(e)]));else for(var o in a)(n=i).push.apply(n,r.default(a[o]));return i},eventName:function(e){var t=e.indexOf(".");return t<0?e:e.slice(0,t)},handleHref:function(e,t,n){this._loader.sanitize(n,{context:"href"}).then((function(t){var n=new MouseEvent(e.type,e),r=Mn(null,"a");for(var a in t)r.setAttribute(a,t[a]);r.dispatchEvent(n)})).catch((function(){}))},handleTooltip:function(e,t,n){if(t&&null!=t.tooltip){t=function(e,t,n,r){var a,i,o=e&&e.mark;if(o&&(a=Cn[o.marktype]).tip){for((i=zn(t,n))[0]-=r[0],i[1]-=r[1];e=e.mark.group;)i[0]-=e.x||0,i[1]-=e.y||0;e=a.tip(o.items,i)}return e}(t,e,this.canvas(),this._origin);var r=n&&t&&t.tooltip||null;this._tooltip.call(this._obj,this,e,t,r)}},getItemBoundingClientRect:function(e){var t=this.canvas();if(t){for(var n=t.getBoundingClientRect(),r=this._origin,a=e.bounds,i=a.width(),o=a.height(),u=a.x1+r[0]+n.left,s=a.y1+r[1]+n.top;e.mark&&(e=e.mark.group);)u+=e.x||0,s+=e.y||0;return{x:u,y:s,width:i,height:o,left:u,top:s,right:u+i,bottom:s+o}}}},Wn.prototype={initialize:function(e,t,n,r,a){return this._el=e,this.resize(t,n,r,a)},element:function(){return this._el},canvas:function(){return this._el&&this._el.firstChild},background:function(e){return 0===arguments.length?this._bgcolor:(this._bgcolor=e,this)},resize:function(e,t,n,r){return this._width=e,this._height=t,this._origin=n||[0,0],this._scale=r||1,this},dirty:function(){},render:function(e){var t=this;return t._call=function(){t._render(e)},t._call(),t._call=null,t},_render:function(){},renderAsync:function(e){var t=this.render(e);return this._ready?this._ready.then((function(){return t})):Promise.resolve(t)},_load:function(e,t){var n=this,r=n._loader[e](t);if(!n._ready){var a=n._call;n._ready=n._loader.ready().then((function(e){e&&a(),n._ready=null}))}return r},sanitizeURL:function(e){return this._load("sanitizeURL",e)},loadImage:function(e){return this._load("loadImage",e)}};var Gn="dragenter",Hn="dragleave",qn="dragover",Jn="mousedown",Kn="mousemove",Xn="mouseout",Yn="mouseover",Qn="click",Zn="mousewheel",$n="touchstart",er="touchmove",tr="touchend",nr=["keydown","keypress","keyup",Gn,Hn,qn,Jn,"mouseup",Kn,Xn,Yn,Qn,"dblclick","wheel",Zn,$n,er,tr],rr=Kn,ar=Xn,ir=Qn;function or(e,t){Un.call(this,e,t),this._down=null,this._touch=null,this._first=!0,this._events={}}function ur(e,t){(function(e){return e===$n||e===er||e===tr?[$n,er,tr]:[e]})(t).forEach((function(t){return function(e,t){var n=e.canvas();n&&!e._events[t]&&(e._events[t]=1,n.addEventListener(t,e[t]?function(n){return e[t](n)}:function(n){return e.fire(t,n)}))}(e,t)}))}function sr(e,t,n){return function(r){var a=this._active,i=this.pickEvent(r);i===a||(a&&a.exit||this.fire(n,r),this._active=i,this.fire(t,r)),this.fire(e,r)}}function cr(e){return function(t){this.fire(e,t),this._active=null}}o.inherits(or,Un,{initialize:function(e,t,n){var r=this;return this._canvas=e&&Bn(e,"canvas"),[Qn,Jn,Kn,Xn,Hn].forEach((function(e){return ur(r,e)})),Un.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._canvas},context:function(){return this._canvas.getContext("2d")},events:nr,DOMMouseScroll:function(e){this.fire(Zn,e)},mousemove:sr(Kn,Yn,Xn),dragover:sr(qn,Gn,Hn),mouseout:cr(Xn),dragleave:cr(Hn),mousedown:function(e){this._down=this._active,this.fire(Jn,e)},click:function(e){this._down===this._active&&(this.fire(Qn,e),this._down=null)},touchstart:function(e){this._touch=this.pickEvent(e.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire($n,e,!0)},touchmove:function(e){this.fire(er,e,!0)},touchend:function(e){this.fire(tr,e,!0),this._touch=null},fire:function(e,t,n){var r=n?this._touch:this._active,a=this._handlers[e];if(t.vegaType=e,e===ir&&r&&r.href?this.handleHref(t,r,r.href):e!==rr&&e!==ar||this.handleTooltip(t,r,e!==ar),a)for(var i=0,o=a.length;i<o;++i)a[i].handler.call(this._obj,t,r)},on:function(e,t){var n=this.eventName(e),r=this._handlers;return this._handlerIndex(r[n],e,t)<0&&(ur(this,e),(r[n]||(r[n]=[])).push({type:e,handler:t})),this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&r.splice(a,1),this},pickEvent:function(e){var t=zn(e,this._canvas),n=this._origin;return this.pick(this._scene,t[0],t[1],t[0]-n[0],t[1]-n[1])},pick:function(e,t,n,r,a){var i=this.context();return Cn[e.marktype].pick.call(this,i,e,t,n,r,a)}});var lr="undefined"!=typeof window&&window.devicePixelRatio||1;function fr(e){Wn.call(this,e),this._options={},this._redraw=!1,this._dirty=new De,this._tempb=new De}var dr=Wn.prototype;function pr(e,t){Un.call(this,e,t);var n=this;n._hrefHandler=hr(n,(function(e,t){t&&t.href&&n.handleHref(e,t,t.href)})),n._tooltipHandler=hr(n,(function(e,t){n.handleTooltip(e,t,e.type!==ar)}))}o.inherits(fr,Wn,{initialize:function(e,t,n,r,a,i){return this._options=i||{},this._canvas=this._options.externalContext?null:T.domCanvas(1,1,this._options.type),e&&this._canvas&&(Ln(e,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),dr.initialize.call(this,e,t,n,r,a)},resize:function(e,t,n,r){if(dr.resize.call(this,e,t,n,r),this._canvas)!function(e,t,n,r,a,i){var o="undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&null!=e.parentNode,u=e.getContext("2d"),s=o?lr:a;for(var c in e.width=t*s,e.height=n*s,i)u[c]=i[c];o&&1!==s&&(e.style.width=t+"px",e.style.height=n+"px"),u.pixelRatio=s,u.setTransform(s,0,0,s,s*r[0],s*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{var a=this._options.externalContext;a||o.error("CanvasRenderer is missing a valid canvas or context"),a.scale(this._scale,this._scale),a.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this},canvas:function(){return this._canvas},context:function(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)},dirty:function(e){for(var t=this._tempb.clear().union(e.bounds),n=e.mark.group;n;)t.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(t)},_render:function(e){var t,n,r,a=this.context(),i=this._origin,o=this._width,u=this._height,s=this._dirty,c=(t=i,n=o,r=u,(new De).set(0,0,n,r).translate(-t[0],-t[1]));a.save();var l=this._redraw||s.empty()?(this._redraw=!1,c.expand(1)):function(e,t,n){return t.expand(1).round(),e.pixelRatio%1&&t.scale(e.pixelRatio).round().scale(1/e.pixelRatio),t.translate(-n[0]%1,-n[1]%1),e.beginPath(),e.rect(t.x1,t.y1,t.width(),t.height()),e.clip(),t}(a,c.intersect(s),i);return this.clear(-i[0],-i[1],o,u),this.draw(a,e,l),a.restore(),s.clear(),this},draw:function(e,t,n){var r=Cn[t.marktype];t.clip&&function(e,t){var n=t.clip;e.save(),o.isFunction(n)?(e.beginPath(),n(e),e.clip()):Rt(e,t.group)}(e,t),r.draw.call(this,e,t,n),t.clip&&e.restore()},clear:function(e,t,n,r){var a=this._options,i=this.context();"pdf"===a.type||a.externalContext||i.clearRect(e,t,n,r),null!=this._bgcolor&&(i.fillStyle=this._bgcolor,i.fillRect(e,t,n,r))}});var hr=function(e,t){return function(n){var r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,t.call(e._obj,n,r)}};o.inherits(pr,Un,{initialize:function(e,t,n){var r=this._svg;return r&&(r.removeEventListener(ir,this._hrefHandler),r.removeEventListener(rr,this._tooltipHandler),r.removeEventListener(ar,this._tooltipHandler)),this._svg=r=e&&Bn(e,"svg"),r&&(r.addEventListener(ir,this._hrefHandler),r.addEventListener(rr,this._tooltipHandler),r.addEventListener(ar,this._tooltipHandler)),Un.prototype.initialize.call(this,e,t,n)},canvas:function(){return this._svg},on:function(e,t){var n=this.eventName(e),r=this._handlers;if(this._handlerIndex(r[n],e,t)<0){var a={type:e,handler:t,listener:hr(this,t)};(r[n]||(r[n]=[])).push(a),this._svg&&this._svg.addEventListener(n,a.listener)}return this},off:function(e,t){var n=this.eventName(e),r=this._handlers[n],a=this._handlerIndex(r,e,t);return a>=0&&(this._svg&&this._svg.removeEventListener(n,r[a].listener),r.splice(a,1)),this}});var vr="aria-hidden",gr="aria-label",mr="role",yr="aria-roledescription",xr="graphics-object",br="graphics-symbol",kr=function(e,t,n){var r;return r={},a.default(r,mr,e),a.default(r,yr,t),a.default(r,gr,n||void 0),r},wr=o.toSet(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),Ar={axis:{desc:"axis",caption:function(e){var t=e.datum,n=e.orient,r=t.title?Tr(e):null,a=e.context,i=a.scales[t.scale].value,o=a.dataflow.locale(),u=i.type;return"".concat("left"===n||"right"===n?"Y":"X","-axis")+(r?" titled '".concat(r,"'"):"")+" for a ".concat(F.isDiscrete(u)?"discrete":u," scale")+" with ".concat(F.domainCaption(o,i,e))}},legend:{desc:"legend",caption:function(e){var t=e.datum,n=t.title?Tr(e):null,r="".concat(t.type||""," legend").trim(),a=t.scales,i=Object.keys(a),u=e.context,s=u.scales[a[i[0]]].value,c=u.dataflow.locale();return l=r,(l.length?l[0].toUpperCase()+l.slice(1):l)+(n?" titled '".concat(n,"'"):"")+" for ".concat(function(e){return(e=e.map((function(e){return e+("fill"===e||"stroke"===e?" color":"")}))).length<2?e[0]:e.slice(0,-1).join(", ")+" and "+o.peek(e)}(i))+" with ".concat(F.domainCaption(c,s,e));var l}},"title-text":{desc:"title",caption:function(e){return"Title text '".concat(Nr(e),"'")}},"title-subtitle":{desc:"subtitle",caption:function(e){return"Subtitle text '".concat(Nr(e),"'")}}},Er={ariaRole:mr,ariaRoleDescription:yr,description:gr};function Cr(e,t){var n=!1===t.aria;if(e(vr,n||void 0),n||null==t.description)for(var r in Er)e(Er[r],void 0);else{var a=t.mark.marktype;e(gr,t.description),e(mr,t.ariaRole||("group"===a?xr:br)),e(yr,t.ariaRoleDescription||"".concat(a," mark"))}}function Sr(e){return!1===e.aria?a.default({},vr,!0):wr[e.role]?null:Ar[e.role]?function(e,t){try{var n=e.items[0],r=t.caption||function(){return""};return kr(t.role||br,t.desc,n.description||r(n))}catch(e){return null}}(e,Ar[e.role]):function(e){var t=e.marktype,n="group"===t||"text"===t||e.items.some((function(e){return null!=e.description&&!1!==e.aria}));return kr(n?xr:br,"".concat(t," mark container"),e.description)}(e)}function Nr(e){return o.array(e.text).join(" ")}function Tr(e){try{return o.array(o.peek(e.items).items[0].text).join(" ")}catch(e){return null}}var Dr=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};function Fr(){var e="",t="",n="",r=[],a=function(){return t=n=""},i=function(i){t&&(e+="".concat(t,">").concat(n),a()),r.push(i)},o=function(e,n){return null!=n&&(t+=" ".concat(e,'="').concat(Dr(n).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;"),'"')),u},u={open:function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];i(e),t="<"+e;var s=!0,c=!1,l=void 0;try{for(var f,d=r[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;for(var h in p)o(h,p[h])}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return u},close:function(){var i=r.pop();return e+=t?t+(n?">".concat(n,"</").concat(i,">"):"/>"):"</".concat(i,">"),a(),u},attr:o,text:function(e){return n+=Dr(e),u},toString:function(){return e}};return u}var Or=function(e){return _r(Fr(),e)+""};function _r(e,t){if(e.open(t.tagName),t.hasAttributes())for(var n=t.attributes,r=n.length,a=0;a<r;++a)e.attr(n[a].name,n[a].value);if(t.hasChildNodes())for(var i=t.childNodes,o=i.length,u=0;u<o;u++){var s=i[u];3===s.nodeType?e.text(s.nodeValue):_r(e,s)}return e.close()}var Ir={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity",blend:"mix-blend-mode"},Rr={fill:"none","stroke-miterlimit":10},Mr="http://www.w3.org/2000/xmlns/",Br=Vt.xmlns;function Pr(e){Wn.call(this,e),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}var Lr=Wn.prototype;function jr(e,t){for(;e&&e.dirty!==t;e=e.mark.group){if(e.dirty=t,!e.mark||e.mark.dirty===t)return;e.mark.dirty=t}}function zr(e,t,n){var r,a,i;if("radial"===t.gradient){var o=Pn(e,n++,"pattern",Br);Kr(o,{id:_+t.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),Kr(o=Pn(o,0,"rect",Br),{width:1,height:1,fill:"url(".concat(Yr(),"#").concat(t.id,")")}),Kr(e=Pn(e,n++,"radialGradient",Br),{id:t.id,fx:t.x1,fy:t.y1,fr:t.r1,cx:t.x2,cy:t.y2,r:t.r2})}else Kr(e=Pn(e,n++,"linearGradient",Br),{id:t.id,x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2});for(r=0,a=t.stops.length;r<a;++r)(i=Pn(e,r,"stop",Br)).setAttribute("offset",t.stops[r].offset),i.setAttribute("stop-color",t.stops[r].color);return Ln(e,r),n}function Ur(e,t,n){return(e=Pn(e,n,"clipPath",Br)).setAttribute("id",t.id),t.path?Pn(e,0,"path",Br).setAttribute("d",t.path):Kr(Pn(e,0,"rect",Br),{x:0,y:0,width:t.width,height:t.height}),Ln(e,1),n+1}function Vr(e,t,n,r,a){var i,o=e._svg;if(!o&&(o=Mn(i=t.ownerDocument,r,Br),e._svg=o,e.mark&&(o.__data__=e,o.__values__={fill:"default"},"g"===r))){var u=Mn(i,"path",Br);o.appendChild(u),u.__data__=e;var s=Mn(i,"g",Br);o.appendChild(s),s.__data__=e;var c=Mn(i,"path",Br);o.appendChild(c),c.__data__=e,c.__values__={fill:"default"}}return(o.ownerSVGElement!==a||function(e,t){return e.parentNode&&e.parentNode.childNodes.length>1&&e.previousSibling!=t}(o,n))&&t.insertBefore(o,n?n.nextSibling:t.firstChild),o}o.inherits(Pr,Wn,{initialize:function(e,t,n,r,a){return this._defs={},this._clearDefs(),e&&(this._svg=Pn(e,0,"svg",Br),this._svg.setAttributeNS(Mr,"xmlns",Br),this._svg.setAttributeNS(Mr,"xmlns:xlink",Vt["xmlns:xlink"]),this._svg.setAttribute("version",Vt.version),this._svg.setAttribute("class","marks"),Ln(e,1),this._root=Pn(this._svg,0,"g",Br),Kr(this._root,Rr),Ln(this._svg,1)),this.background(this._bgcolor),Lr.initialize.call(this,e,t,n,r,a)},background:function(e){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",e),Lr.background.apply(this,arguments)},resize:function(e,t,n,r){return Lr.resize.call(this,e,t,n,r),this._svg&&(Kr(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}),this._root.setAttribute("transform","translate(".concat(this._origin,")"))),this._dirty=[],this},canvas:function(){return this._svg},svg:function(){var e,t=this._svg,n=this._bgcolor;if(!t)return null;n&&(t.removeAttribute("style"),Kr(e=Pn(t,0,"rect",Br),{width:this._width,height:this._height,fill:n}));var r=Or(t);return n&&(t.removeChild(e),this._svg.style.setProperty("background-color",n)),r},_render:function(e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,e),Ln(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this},dirty:function(e){e.dirty!==this._dirtyID&&(e.dirty=this._dirtyID,this._dirty.push(e))},isDirty:function(e){return this._dirtyAll||!e._svg||e.dirty===this._dirtyID},_dirtyCheck:function(){this._dirtyAll=!0;var e=this._dirty;if(!e.length||!this._dirtyID)return!0;var t,n,r,a,i,o,u,s=++this._dirtyID;for(i=0,o=e.length;i<o;++i)(n=(t=e[i]).mark).marktype!==r&&(r=n.marktype,a=Cn[r]),n.zdirty&&n.dirty!==s&&(this._dirtyAll=!1,jr(t,s),n.items.forEach((function(e){e.dirty=s}))),n.zdirty||(t.exit?(a.nested&&n.items.length?(u=n.items[0])._svg&&this._update(a,u._svg,u):t._svg&&(u=t._svg.parentNode)&&u.removeChild(t._svg),t._svg=null):(t=a.nested?n.items[0]:t)._update!==s&&(t._svg&&t._svg.ownerSVGElement?this._update(a,t._svg,t):(this._dirtyAll=!1,jr(t,s)),t._update=s));return!this._dirtyAll},mark:function(e,t,n){var r=this;if(!this.isDirty(t))return t._svg;var a=this._svg,i=Cn[t.marktype],o=!1===t.interactive?"none":null,u="g"===i.tag,s=null,c=0,l=Vr(t,e,n,"g",a);l.setAttribute("class",jn(t));var f=Sr(t);for(var d in f)Xr(l,d,f[d]);u||Xr(l,"pointer-events",o),Xr(l,"clip-path",t.clip?Te(this,t,t.group):null);var p=function(e){var t=r.isDirty(e),n=Vr(e,l,s,i.tag,a);t&&(r._update(i,n,e),u&&function(e,t,n){t=t.lastChild.previousSibling;var r,a=0;bt(n,(function(n){r=e.mark(t,n,r),++a})),Ln(t,1+a)}(r,n,e)),s=n,++c};return i.nested?t.items.length&&p(t.items[0]):bt(t,p),Ln(l,c),l},_update:function(e,t,n){Wr=t,Gr=t.__values__,Cr(qr,n),e.attr(qr,n,this);var r=Hr[e.type];r&&r.call(this,e,t,n),Wr&&this.style(Wr,n)},style:function(e,t){if(null!=t)for(var n in Ir){var r="font"===n?mn(t):t[n];if(r!==Gr[n]){var a=Ir[n];null==r?e.removeAttribute(a):(I(r)&&(r=R(r,this._defs.gradient,Yr())),e.setAttribute(a,r+"")),Gr[n]=r}}},defs:function(){var e=this._svg,t=this._defs,n=t.el,r=0;for(var a in t.gradient)n||(t.el=n=Pn(e,1,"defs",Br)),r=zr(n,t.gradient[a],r);for(var i in t.clipping)n||(t.el=n=Pn(e,1,"defs",Br)),r=Ur(n,t.clipping[i],r);n&&(0===r?(e.removeChild(n),t.el=null):Ln(n,r))},_clearDefs:function(){var e=this._defs;e.gradient={},e.clipping={}}});var Wr=null,Gr=null,Hr={group:function(e,t,n){var r=Wr=t.childNodes[2];Gr=r.__values__,e.foreground(qr,n,this),Gr=t.__values__,Wr=t.childNodes[1],e.content(qr,n,this);var a=Wr=t.childNodes[0];e.background(qr,n,this);var i=!1===n.mark.interactive?"none":null;if(i!==Gr.events&&(Xr(r,"pointer-events",i),Xr(a,"pointer-events",i),Gr.events=i),n.strokeForeground&&n.stroke){var o=n.fill;Xr(r,"display",null),this.style(a,n),Xr(a,"stroke",null),o&&(n.fill=null),Gr=r.__values__,this.style(r,n),o&&(n.fill=o),Wr=null}else Xr(r,"display","none")},image:function(e,t,n){!1===n.smooth?(Jr(t,"image-rendering","optimizeSpeed"),Jr(t,"image-rendering","pixelated")):Jr(t,"image-rendering",null)},text:function(e,t,n){var r,a,i,u,s=hn(n);o.isArray(s)?(r=(a=s.map((function(e){return gn(n,e)}))).join("\n"))!==Gr.text&&(Ln(t,0),i=t.ownerDocument,u=pn(n),a.forEach((function(e,r){var a=Mn(i,"tspan",Br);a.__data__=n,a.textContent=e,r&&(a.setAttribute("x",0),a.setAttribute("dy",u)),t.appendChild(a)})),Gr.text=r):(a=gn(n,s))!==Gr.text&&(t.textContent=a,Gr.text=a),Xr(t,"font-family",mn(n)),Xr(t,"font-size",dn(n)+"px"),Xr(t,"font-style",n.fontStyle),Xr(t,"font-variant",n.fontVariant),Xr(t,"font-weight",n.fontWeight)}};function qr(e,t,n){t!==Gr[e]&&(n?function(e,t,n,r){null!=n?e.setAttributeNS(r,t,n):e.removeAttributeNS(r,t)}(Wr,e,t,n):Xr(Wr,e,t),Gr[e]=t)}function Jr(e,t,n){n!==Gr[t]&&(null==n?e.style.removeProperty(t):e.style.setProperty(t,n+""),Gr[t]=n)}function Kr(e,t){for(var n in t)Xr(e,n,t[n])}function Xr(e,t,n){null!=n?e.setAttribute(t,n):e.removeAttribute(t)}function Yr(){var e;return"undefined"==typeof window?"":(e=window.location).hash?e.href.slice(0,-e.hash.length):e.href}function Qr(e){Wn.call(this,e),this._text=null,this._defs={gradient:{},clipping:{}}}o.inherits(Qr,Wn,{svg:function(){return this._text},_render:function(e){var t=Fr();t.open("svg",o.extend({},Vt,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:"0 0 ".concat(this._width," ").concat(this._height)}));var n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&t.open("rect",{width:this._width,height:this._height,fill:n}).close(),t.open("g",Rr,{transform:"translate("+this._origin+")"}),this.mark(t,e),t.close(),this.defs(t),this._text=t.close()+"",this},mark:function(e,t){var n=this,r=Cn[t.marktype],a=r.tag,i=[Cr,r.attr];e.open("g",{class:jn(t),"clip-path":t.clip?Te(this,t,t.group):null},Sr(t),{"pointer-events":"g"!==a&&!1===t.interactive?"none":null});var u=function(u){var s=n.href(u);if(s&&e.open("a",s),e.open(a,n.attr(t,u,i,"g"!==a?a:null)),"text"===a){var c=hn(u);if(o.isArray(c))for(var l={x:0,dy:pn(u)},f=0;f<c.length;++f)e.open("tspan",f?l:null).text(gn(u,c[f])).close();else e.text(gn(u,c))}else if("g"===a){var d=n,p=u.strokeForeground,h=u.fill,v=u.stroke;p&&v&&(u.stroke=null),e.open("path",n.attr(t,u,r.background,"bgrect")).close(),e.open("g",n.attr(t,u,r.content)),bt(u,(function(t){return d.mark(e,t)})),e.close(),p&&v?(h&&(u.fill=null),u.stroke=v,e.open("path",n.attr(t,u,r.foreground,"bgrect")).close(),h&&(u.fill=h)):e.open("path",n.attr(t,u,r.foreground,"bgfore")).close()}e.close(),s&&e.close()};return r.nested?t.items&&t.items.length&&u(t.items[0]):bt(t,u),e.close()},href:function(e){var t,n=e.href;if(n){var r=this;if(t=this._hrefs&&this._hrefs[n])return t;this.sanitizeURL(n).then((function(e){e["xlink:href"]=e.href,e.href=null,(r._hrefs||(r._hrefs={}))[n]=e}))}return null},attr:function(e,t,n,r){var a=this,i={},o=function(e,t,n,r){i[r||e]=t};return Array.isArray(n)?n.forEach((function(e){return e(o,t,a)})):n(o,t,this),r&&function(e,t,n,r,a){if(null==t)return e;"bgrect"===r&&!1===n.interactive&&(e["pointer-events"]="none");if("bgfore"===r&&(!1===n.interactive&&(e["pointer-events"]="none"),e.display="none",null!==t.fill))return e;"image"===r&&!1===t.smooth&&(e.style="image-rendering: optimizeSpeed; image-rendering: pixelated;");"text"===r&&(e["font-family"]=mn(t),e["font-size"]=dn(t)+"px",e["font-style"]=t.fontStyle,e["font-variant"]=t.fontVariant,e["font-weight"]=t.fontWeight);for(var i in Ir){var o=t[i],u=Ir[i];("transparent"!==o||"fill"!==u&&"stroke"!==u)&&null!=o&&(I(o)&&(o=R(o,a.gradient,"")),e[u]=o)}}(i,t,e,r,this._defs),i},defs:function(e){var t=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(t).length+Object.keys(n).length){for(var r in e.open("defs"),t){var a=t[r],i=a.stops;"radial"===a.gradient?(e.open("pattern",{id:_+r,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),e.open("rect",{width:"1",height:"1",fill:"url(#"+r+")"}).close(),e.close(),e.open("radialGradient",{id:r,fx:a.x1,fy:a.y1,fr:a.r1,cx:a.x2,cy:a.y2,r:a.r2})):e.open("linearGradient",{id:r,x1:a.x1,x2:a.x2,y1:a.y1,y2:a.y2});for(var o=0;o<i.length;++o)e.open("stop",{offset:i[o].offset,"stop-color":i[o].color}).close();e.close()}for(var u in n){var s=n[u];e.open("clipPath",{id:u}),s.path?e.open("path",{d:s.path}).close():e.open("rect",{x:0,y:0,width:s.width,height:s.height}).close(),e.close()}e.close()}}});var Zr="canvas",$r="none",ea={Canvas:Zr,PNG:"png",SVG:"svg",None:$r},ta={};function na(e,t){return e=String(e||"").toLowerCase(),arguments.length>1?(ta[e]=t,this):ta[e]}function ra(e,t,n){var r=[],a=(new De).union(t),i=e.marktype;return i?aa(e,a,n,r):"group"===i?ia(e,a,n,r):o.error("Intersect scene must be mark node or group item.")}function aa(e,t,n,r){if(function(e,t,n){return e.bounds&&t.intersects(e.bounds)&&("group"===e.marktype||!1!==e.interactive&&(!n||n(e)))}(e,t,n)){var a=e.items,i=e.marktype,o=a.length,u=0;if("group"===i)for(;u<o;++u)ia(a[u],t,n,r);else for(var s=Cn[i].isect;u<o;++u){var c=a[u];oa(c,t,s)&&r.push(c)}}return r}function ia(e,t,n,r){n&&n(e.mark)&&oa(e,t,Cn.group.isect)&&r.push(e);var a=e.items,i=a&&a.length;if(i){var o=e.x||0,u=e.y||0;t.translate(-o,-u);for(var s=0;s<i;++s)aa(a[s],t,n,r);t.translate(o,u)}return r}function oa(e,t,n){var r=e.bounds;return t.encloses(r)||t.intersects(r)&&n(e,t)}ta.canvas=ta.png={renderer:fr,headless:fr,handler:or},ta.svg={renderer:Pr,headless:Qr,handler:pr},ta.none={};var ua=new De;function sa(e){var t=e.clip;if(o.isFunction(t))t($e(ua.clear()));else{if(!t)return;ua.set(0,0,e.group.width,e.group.height)}e.bounds.intersect(ua)}function ca(e,t,n){return e===t||("path"===n?la(e,t):e instanceof Date&&t instanceof Date?+e==+t:o.isNumber(e)&&o.isNumber(t)?Math.abs(e-t)<=1e-9:e&&t&&(o.isObject(e)||o.isObject(t))?function(e,t){var n,r,a=Object.keys(e),o=Object.keys(t);if(a.length!==o.length)return!1;for(a.sort(),o.sort(),r=a.length-1;r>=0;r--)if(a[r]!=o[r])return!1;for(r=a.length-1;r>=0;r--)if(!ca(e[n=a[r]],t[n],n))return!1;return(void 0===e?"undefined":i.default(e))===(void 0===t?"undefined":i.default(t))}(e,t):e==t)}function la(e,t){return ca(U(e),U(t))}function fa(){Ne(),O=0}})),s.register("gkjyK",(function(e,t){n(e.exports,"default",(function(){return h}));var r=s("hmGuu"),a=s("kscoZ"),i=s("kn5WO");function o(e){return e.innerRadius}function u(e){return e.outerRadius}function c(e){return e.startAngle}function l(e){return e.endAngle}function f(e){return e&&e.padAngle}function d(e,t,n,r,a,o,u,s){var c=n-e,l=r-t,f=u-a,d=s-o,p=d*c-f*l;if(!(p*p<i.epsilon))return[e+(p=(f*(t-o)-d*(e-a))/p)*c,t+p*l]}function p(e,t,n,r,a,o,u){var s=e-n,c=t-r,l=(u?o:-o)/i.sqrt(s*s+c*c),f=l*c,d=-l*s,p=e+f,h=t+d,v=n+f,g=r+d,m=(p+v)/2,y=(h+g)/2,x=v-p,b=g-h,k=x*x+b*b,w=a-o,A=p*g-v*h,E=(b<0?-1:1)*i.sqrt(i.max(0,w*w*k-A*A)),C=(A*b-x*E)/k,S=(-A*x-b*E)/k,N=(A*b+x*E)/k,T=(-A*x+b*E)/k,D=C-m,F=S-y,O=N-m,_=T-y;return D*D+F*F>O*O+_*_&&(C=N,S=T),{cx:C,cy:S,x01:-f,y01:-d,x11:C*(a/w-1),y11:S*(a/w-1)}}function h(){var e=o,t=u,n=a.default(0),s=null,h=c,v=l,g=f,m=null;function y(){var a,o,u=+e.apply(this,arguments),c=+t.apply(this,arguments),l=h.apply(this,arguments)-i.halfPi,f=v.apply(this,arguments)-i.halfPi,y=i.abs(f-l),x=f>l;if(m||(m=a=r.default()),c<u&&(o=c,c=u,u=o),c>i.epsilon)if(y>i.tau-i.epsilon)m.moveTo(c*i.cos(l),c*i.sin(l)),m.arc(0,0,c,l,f,!x),u>i.epsilon&&(m.moveTo(u*i.cos(f),u*i.sin(f)),m.arc(0,0,u,f,l,x));else{var b,k,w=l,A=f,E=l,C=f,S=y,N=y,T=g.apply(this,arguments)/2,D=T>i.epsilon&&(s?+s.apply(this,arguments):i.sqrt(u*u+c*c)),F=i.min(i.abs(c-u)/2,+n.apply(this,arguments)),O=F,_=F;if(D>i.epsilon){var I=i.asin(D/u*i.sin(T)),R=i.asin(D/c*i.sin(T));(S-=2*I)>i.epsilon?(E+=I*=x?1:-1,C-=I):(S=0,E=C=(l+f)/2),(N-=2*R)>i.epsilon?(w+=R*=x?1:-1,A-=R):(N=0,w=A=(l+f)/2)}var M=c*i.cos(w),B=c*i.sin(w),P=u*i.cos(C),L=u*i.sin(C);if(F>i.epsilon){var j,z=c*i.cos(A),U=c*i.sin(A),V=u*i.cos(E),W=u*i.sin(E);if(y<i.pi&&(j=d(M,B,V,W,z,U,P,L))){var G=M-j[0],H=B-j[1],q=z-j[0],J=U-j[1],K=1/i.sin(i.acos((G*q+H*J)/(i.sqrt(G*G+H*H)*i.sqrt(q*q+J*J)))/2),X=i.sqrt(j[0]*j[0]+j[1]*j[1]);O=i.min(F,(u-X)/(K-1)),_=i.min(F,(c-X)/(K+1))}}N>i.epsilon?_>i.epsilon?(b=p(V,W,M,B,c,_,x),k=p(z,U,P,L,c,_,x),m.moveTo(b.cx+b.x01,b.cy+b.y01),_<F?m.arc(b.cx,b.cy,_,i.atan2(b.y01,b.x01),i.atan2(k.y01,k.x01),!x):(m.arc(b.cx,b.cy,_,i.atan2(b.y01,b.x01),i.atan2(b.y11,b.x11),!x),m.arc(0,0,c,i.atan2(b.cy+b.y11,b.cx+b.x11),i.atan2(k.cy+k.y11,k.cx+k.x11),!x),m.arc(k.cx,k.cy,_,i.atan2(k.y11,k.x11),i.atan2(k.y01,k.x01),!x))):(m.moveTo(M,B),m.arc(0,0,c,w,A,!x)):m.moveTo(M,B),u>i.epsilon&&S>i.epsilon?O>i.epsilon?(b=p(P,L,z,U,u,-O,x),k=p(M,B,V,W,u,-O,x),m.lineTo(b.cx+b.x01,b.cy+b.y01),O<F?m.arc(b.cx,b.cy,O,i.atan2(b.y01,b.x01),i.atan2(k.y01,k.x01),!x):(m.arc(b.cx,b.cy,O,i.atan2(b.y01,b.x01),i.atan2(b.y11,b.x11),!x),m.arc(0,0,u,i.atan2(b.cy+b.y11,b.cx+b.x11),i.atan2(k.cy+k.y11,k.cx+k.x11),x),m.arc(k.cx,k.cy,O,i.atan2(k.y11,k.x11),i.atan2(k.y01,k.x01),!x))):m.arc(0,0,u,C,E,x):m.lineTo(P,L)}else m.moveTo(0,0);if(m.closePath(),a)return m=null,a+""||null}return y.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,r=(+h.apply(this,arguments)+ +v.apply(this,arguments))/2-i.pi/2;return[i.cos(r)*n,i.sin(r)*n]},y.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:a.default(+t),y):e},y.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:a.default(+e),y):t},y.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:a.default(+e),y):n},y.padRadius=function(e){return arguments.length?(s=null==e?null:"function"==typeof e?e:a.default(+e),y):s},y.startAngle=function(e){return arguments.length?(h="function"==typeof e?e:a.default(+e),y):h},y.endAngle=function(e){return arguments.length?(v="function"==typeof e?e:a.default(+e),y):v},y.padAngle=function(e){return arguments.length?(g="function"==typeof e?e:a.default(+e),y):g},y.context=function(e){return arguments.length?(m=null==e?null:e,y):m},y}})),s.register("hmGuu",(function(e,t){n(e.exports,"default",(function(){return c}));var r=Math.PI,a=2*r,i=1e-6,o=a-i;function u(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function s(){return new u}u.prototype=s.prototype={constructor:u,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,a,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(e,t,n,a,o){e=+e,t=+t,n=+n,a=+a,o=+o;var u=this._x1,s=this._y1,c=n-e,l=a-t,f=u-e,d=s-t,p=f*f+d*d;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(p>i)if(Math.abs(d*c-l*f)>i&&o){var h=n-u,v=a-s,g=c*c+l*l,m=h*h+v*v,y=Math.sqrt(g),x=Math.sqrt(p),b=o*Math.tan((r-Math.acos((g+p-m)/(2*y*x)))/2),k=b/x,w=b/y;Math.abs(k-1)>i&&(this._+="L"+(e+k*f)+","+(t+k*d)),this._+="A"+o+","+o+",0,0,"+ +(d*h>f*v)+","+(this._x1=e+w*c)+","+(this._y1=t+w*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t);else;},arc:function(e,t,n,u,s,c){e=+e,t=+t,c=!!c;var l=(n=+n)*Math.cos(u),f=n*Math.sin(u),d=e+l,p=t+f,h=1^c,v=c?u-s:s-u;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+d+","+p:(Math.abs(this._x1-d)>i||Math.abs(this._y1-p)>i)&&(this._+="L"+d+","+p),n&&(v<0&&(v=v%a+a),v>o?this._+="A"+n+","+n+",0,1,"+h+","+(e-l)+","+(t-f)+"A"+n+","+n+",0,1,"+h+","+(this._x1=d)+","+(this._y1=p):v>i&&(this._+="A"+n+","+n+",0,"+ +(v>=r)+","+h+","+(this._x1=e+n*Math.cos(s))+","+(this._y1=t+n*Math.sin(s))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var c=s})),s.register("kscoZ",(function(e,t){function r(e){return function(){return e}}n(e.exports,"default",(function(){return r}))})),s.register("kn5WO",(function(e,t){n(e.exports,"abs",(function(){return r})),n(e.exports,"atan2",(function(){return a})),n(e.exports,"cos",(function(){return i})),n(e.exports,"max",(function(){return o})),n(e.exports,"min",(function(){return u})),n(e.exports,"sin",(function(){return s})),n(e.exports,"sqrt",(function(){return c})),n(e.exports,"epsilon",(function(){return l})),n(e.exports,"pi",(function(){return f})),n(e.exports,"halfPi",(function(){return d})),n(e.exports,"tau",(function(){return p})),n(e.exports,"acos",(function(){return h})),n(e.exports,"asin",(function(){return v}));var r=Math.abs,a=Math.atan2,i=Math.cos,o=Math.max,u=Math.min,s=Math.sin,c=Math.sqrt,l=1e-12,f=Math.PI,d=f/2,p=2*f;function h(e){return e>1?0:e<-1?f:Math.acos(e)}function v(e){return e>=1?d:e<=-1?-d:Math.asin(e)}})),s.register("kEEJc",(function(e,t){n(e.exports,"default",(function(){return l}));var r=s("hmGuu"),a=s("4NvuC"),i=s("kscoZ"),o=s("3PltN"),u=s("7iEVm"),c=s("kC1SP");function l(e,t,n){var s=null,l=i.default(!0),f=null,d=o.default,p=null;function h(i){var o,u,c,h,v,g=(i=a.default(i)).length,m=!1,y=new Array(g),x=new Array(g);for(null==f&&(p=d(v=r.default())),o=0;o<=g;++o){if(!(o<g&&l(h=i[o],o,i))===m)if(m=!m)u=o,p.areaStart(),p.lineStart();else{for(p.lineEnd(),p.lineStart(),c=o-1;c>=u;--c)p.point(y[c],x[c]);p.lineEnd(),p.areaEnd()}m&&(y[o]=+e(h,o,i),x[o]=+t(h,o,i),p.point(s?+s(h,o,i):y[o],n?+n(h,o,i):x[o]))}if(v)return p=null,v+""||null}function v(){return u.default().defined(l).curve(d).context(f)}return e="function"==typeof e?e:void 0===e?c.x:i.default(+e),t="function"==typeof t?t:void 0===t?i.default(0):i.default(+t),n="function"==typeof n?n:void 0===n?c.y:i.default(+n),h.x=function(t){return arguments.length?(e="function"==typeof t?t:i.default(+t),s=null,h):e},h.x0=function(t){return arguments.length?(e="function"==typeof t?t:i.default(+t),h):e},h.x1=function(e){return arguments.length?(s=null==e?null:"function"==typeof e?e:i.default(+e),h):s},h.y=function(e){return arguments.length?(t="function"==typeof e?e:i.default(+e),n=null,h):t},h.y0=function(e){return arguments.length?(t="function"==typeof e?e:i.default(+e),h):t},h.y1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:i.default(+e),h):n},h.lineX0=h.lineY0=function(){return v().x(e).y(t)},h.lineY1=function(){return v().x(e).y(n)},h.lineX1=function(){return v().x(s).y(t)},h.defined=function(e){return arguments.length?(l="function"==typeof e?e:i.default(!!e),h):l},h.curve=function(e){return arguments.length?(d=e,null!=f&&(p=d(f)),h):d},h.context=function(e){return arguments.length?(null==e?f=p=null:p=d(f=e),h):f},h}})),s.register("4NvuC",(function(e,t){n(e.exports,"default",(function(){return r}));Array.prototype.slice;function r(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}})),s.register("3PltN",(function(e,t){function r(e){this._context=e}function a(e){return new r(e)}n(e.exports,"default",(function(){return a})),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}}})),s.register("7iEVm",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("hmGuu"),a=s("4NvuC"),i=s("kscoZ"),o=s("3PltN"),u=s("kC1SP");function c(e,t){var n=i.default(!0),s=null,c=o.default,l=null;function f(i){var o,u,f,d=(i=a.default(i)).length,p=!1;for(null==s&&(l=c(f=r.default())),o=0;o<=d;++o)!(o<d&&n(u=i[o],o,i))===p&&((p=!p)?l.lineStart():l.lineEnd()),p&&l.point(+e(u,o,i),+t(u,o,i));if(f)return l=null,f+""||null}return e="function"==typeof e?e:void 0===e?u.x:i.default(e),t="function"==typeof t?t:void 0===t?u.y:i.default(t),f.x=function(t){return arguments.length?(e="function"==typeof t?t:i.default(+t),f):e},f.y=function(e){return arguments.length?(t="function"==typeof e?e:i.default(+e),f):t},f.defined=function(e){return arguments.length?(n="function"==typeof e?e:i.default(!!e),f):n},f.curve=function(e){return arguments.length?(c=e,null!=s&&(l=c(s)),f):c},f.context=function(e){return arguments.length?(null==e?s=l=null:l=c(s=e),f):s},f}})),s.register("kC1SP",(function(e,t){function r(e){return e[0]}function a(e){return e[1]}n(e.exports,"x",(function(){return r})),n(e.exports,"y",(function(){return a}))})),s.register("gn8Iu",(function(e,t){n(e.exports,"default",(function(){return p}));var r=s("hmGuu"),a=s("g74gR"),i=s("9wJOJ"),o=s("1K6J4"),u=s("6Dwx6"),c=s("kWutU"),l=s("26frq"),f=s("bunON"),d=s("kscoZ");a.default,i.default,o.default,c.default,u.default,l.default,f.default;function p(e,t){var n=null;function i(){var a;if(n||(n=a=r.default()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),a)return n=null,a+""||null}return e="function"==typeof e?e:d.default(e||a.default),t="function"==typeof t?t:d.default(void 0===t?64:+t),i.type=function(t){return arguments.length?(e="function"==typeof t?t:d.default(t),i):e},i.size=function(e){return arguments.length?(t="function"==typeof e?e:d.default(+e),i):t},i.context=function(e){return arguments.length?(n=null==e?null:e,i):n},i}})),s.register("g74gR",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("kn5WO"),a={draw:function(e,t){var n=Math.sqrt(t/r.pi);e.moveTo(n,0),e.arc(0,0,n,0,r.tau)}}})),s.register("9wJOJ",(function(e,t){n(e.exports,"default",(function(){return r}));var r={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}}}));s.register("1K6J4",(function(e,t){n(e.exports,"default",(function(){return i}));var r=Math.sqrt(1/3),a=2*r,i={draw:function(e,t){var n=Math.sqrt(t/a),i=n*r;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}}})),s.register("6Dwx6",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("kn5WO"),a=Math.sin(r.pi/10)/Math.sin(7*r.pi/10),i=Math.sin(r.tau/10)*a,o=-Math.cos(r.tau/10)*a,u={draw:function(e,t){var n=Math.sqrt(.8908130915292852*t),a=i*n,u=o*n;e.moveTo(0,-n),e.lineTo(a,u);for(var s=1;s<5;++s){var c=r.tau*s/5,l=Math.cos(c),f=Math.sin(c);e.lineTo(f*n,-l*n),e.lineTo(l*a-f*u,f*a+l*u)}e.closePath()}}})),s.register("kWutU",(function(e,t){n(e.exports,"default",(function(){return r}));var r={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}}})),s.register("26frq",(function(e,t){n(e.exports,"default",(function(){return a}));var r=Math.sqrt(3),a={draw:function(e,t){var n=-Math.sqrt(t/(3*r));e.moveTo(0,2*n),e.lineTo(-r*n,-n),e.lineTo(r*n,-n),e.closePath()}}})),s.register("bunON",(function(e,t){n(e.exports,"default",(function(){return u}));var r=-.5,a=Math.sqrt(3)/2,i=1/Math.sqrt(12),o=3*(i/2+1),u={draw:function(e,t){var n=Math.sqrt(t/o),u=n/2,s=n*i,c=u,l=n*i+n,f=-c,d=l;e.moveTo(u,s),e.lineTo(c,l),e.lineTo(f,d),e.lineTo(r*u-a*s,a*u+r*s),e.lineTo(r*c-a*l,a*c+r*l),e.lineTo(r*f-a*d,a*f+r*d),e.lineTo(r*u+a*s,r*s-a*u),e.lineTo(r*c+a*l,r*l-a*c),e.lineTo(r*f+a*d,r*d-a*f),e.closePath()}}})),s.register("hQfwC",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("2Z5Un"),a=s("k3ufy");function i(e){this._context=e}function o(e){return new i(e)}i.prototype={areaStart:r.default,areaEnd:r.default,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:a.point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}})),s.register("2Z5Un",(function(e,t){function r(){}n(e.exports,"default",(function(){return r}))})),s.register("k3ufy",(function(e,t){function r(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function a(e){this._context=e}function i(e){return new a(e)}n(e.exports,"point",(function(){return r})),n(e.exports,"Basis",(function(){return a})),n(e.exports,"default",(function(){return i})),a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:r(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function e(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:e(this,t)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=n}}})),s.register("hFLSz",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("k3ufy");function a(e){this._context=e}function i(e){return new a(e)}a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:r.point(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}}})),s.register("4Ovem",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("k3ufy");function a(e,t){this._basis=new r.Basis(e),this._beta=t}a.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r,a=e[0],i=t[0],o=e[n]-a,u=t[n]-i,s=-1;++s<=n;)r=s/n,this._basis.point(this._beta*e[s]+(1-this._beta)*(a+r*o),this._beta*t[s]+(1-this._beta)*(i+r*u));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var i=function e(t){function n(e){return 1===t?new r.Basis(e):new a(e,t)}return n.beta=function(t){return e(+t)},n}(.85)})),s.register("2HW9q",(function(e,t){n(e.exports,"CardinalClosed",(function(){return i})),n(e.exports,"default",(function(){return o}));var r=s("2Z5Un"),a=s("gopn7");function i(e,t){this._context=e,this._k=(1-t)/6}i.prototype={areaStart:r.default,areaEnd:r.default,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:a.point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var o=function e(t){function n(e){return new i(e,t)}return n.tension=function(t){return e(+t)},n}(0)})),s.register("gopn7",(function(e,t){function r(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function a(e,t){this._context=e,this._k=(1-t)/6}n(e.exports,"point",(function(){return r})),n(e.exports,"Cardinal",(function(){return a})),n(e.exports,"default",(function(){return i})),a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:r(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function e(t,n){switch(t=+t,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2,this._x1=t,this._y1=n;break;case 2:this._point=3;default:e(this,t)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var i=function e(t){function n(e){return new a(e,t)}return n.tension=function(t){return e(+t)},n}(0)})),s.register("bMTFD",(function(e,t){n(e.exports,"CardinalOpen",(function(){return a})),n(e.exports,"default",(function(){return i}));var r=s("gopn7");function a(e,t){this._context=e,this._k=(1-t)/6}a.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:r.point(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var i=function e(t){function n(e){return new a(e,t)}return n.tension=function(t){return e(+t)},n}(0)})),s.register("gwehU",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("2HW9q"),a=s("2Z5Un"),i=s("f0CZg");function o(e,t){this._context=e,this._alpha=t}o.prototype={areaStart:a.default,areaEnd:a.default,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:i.point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var u=function e(t){function n(e){return t?new o(e,t):new r.CardinalClosed(e,0)}return n.alpha=function(t){return e(+t)},n}(.5)})),s.register("f0CZg",(function(e,t){n(e.exports,"point",(function(){return i})),n(e.exports,"default",(function(){return u}));var r=s("kn5WO"),a=s("gopn7");function i(e,t,n){var a=e._x1,i=e._y1,o=e._x2,u=e._y2;if(e._l01_a>r.epsilon){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);a=(a*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>r.epsilon){var l=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,f=3*e._l23_a*(e._l23_a+e._l12_a);o=(o*l+e._x1*e._l23_2a-t*e._l12_2a)/f,u=(u*l+e._y1*e._l23_2a-n*e._l12_2a)/f}e._context.bezierCurveTo(a,i,o,u,e._x2,e._y2)}function o(e,t){this._context=e,this._alpha=t}o.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function e(t,n){if(t=+t,n=+n,this._point){var r=this._x2-t,a=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break;case 1:this._point=2;break;case 2:this._point=3;default:e(this,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=n}};var u=function e(t){function n(e){return t?new o(e,t):new a.Cardinal(e,0)}return n.alpha=function(t){return e(+t)},n}(.5)})),s.register("fTHwG",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("bMTFD"),a=s("f0CZg");function i(e,t){this._context=e,this._alpha=t}i.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:a.point(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var o=function e(t){function n(e){return t?new i(e,t):new r.CardinalOpen(e,0)}return n.alpha=function(t){return e(+t)},n}(.5)})),s.register("jbOTG",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("2Z5Un");function a(e){this._context=e}function i(e){return new a(e)}a.prototype={areaStart:r.default,areaEnd:r.default,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}}})),s.register("5inWz",(function(e,t){function r(e){return e<0?-1:1}function a(e,t,n){var a=e._x1-e._x0,i=t-e._x1,o=(e._y1-e._y0)/(a||i<0&&-0),u=(n-e._y1)/(i||a<0&&-0),s=(o*i+u*a)/(a+i);return(r(o)+r(u))*Math.min(Math.abs(o),Math.abs(u),.5*Math.abs(s))||0}function i(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function o(e,t,n){var r=e._x0,a=e._y0,i=e._x1,o=e._y1,u=(i-r)/3;e._context.bezierCurveTo(r+u,a+u*t,i-u,o-u*n,i,o)}function u(e){this._context=e}function s(e){this._context=new c(e)}function c(e){this._context=e}function l(e){return new u(e)}function f(e){return new s(e)}n(e.exports,"monotoneX",(function(){return l})),n(e.exports,"monotoneY",(function(){return f})),u.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:o(this,this._t0,i(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,o(this,i(this,n=a(this,e,t)),n);break;default:o(this,this._t0,n=a(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(s.prototype=Object.create(u.prototype)).point=function(e,t){u.prototype.point.call(this,t,e)},c.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,a,i){this._context.bezierCurveTo(t,e,r,n,i,a)}}})),s.register("jcAHJ",(function(e,t){function r(e){this._context=e}function a(e){var t,n,r=e.length-1,a=new Array(r),i=new Array(r),o=new Array(r);for(a[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,o[t]-=n*o[t-1];for(a[r-1]=o[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(o[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function i(e){return new r(e)}n(e.exports,"default",(function(){return i})),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var r=a(e),i=a(t),o=0,u=1;u<n;++o,++u)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],e[u],t[u]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}}})),s.register("jdzTX",(function(e,t){function r(e,t){this._context=e,this._t=t}function a(e){return new r(e,.5)}function i(e){return new r(e,0)}function o(e){return new r(e,1)}n(e.exports,"default",(function(){return a})),n(e.exports,"stepBefore",(function(){return i})),n(e.exports,"stepAfter",(function(){return o})),r.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}}})),s.register("juhb3",(function(e,t){n(e.exports,"canvas",(function(){return s("a3wIG").domCanvas})),n(e.exports,"image",(function(){return s("a3wIG").domImage}));s("a3wIG")})),s.register("a3wIG",(function(e,t){function r(e,t){if("undefined"!=typeof document&&document.createElement){var n=document.createElement("canvas");if(n&&n.getContext)return n.width=e,n.height=t,n}return null}n(e.exports,"domCanvas",(function(){return r})),n(e.exports,"domImage",(function(){return a}));var a=function(){return"undefined"!=typeof Image?Image:null}})),s.register("ilkKT",(function(e,t){n(e.exports,"bandSpace",(function(){return C})),n(e.exports,"Linear",(function(){return S})),n(e.exports,"Log",(function(){return N})),n(e.exports,"Pow",(function(){return T})),n(e.exports,"Sqrt",(function(){return D})),n(e.exports,"Symlog",(function(){return F})),n(e.exports,"Time",(function(){return O})),n(e.exports,"UTC",(function(){return _})),n(e.exports,"Sequential",(function(){return I})),n(e.exports,"Diverging",(function(){return R})),n(e.exports,"Quantile",(function(){return M})),n(e.exports,"Quantize",(function(){return B})),n(e.exports,"Threshold",(function(){return P})),n(e.exports,"Ordinal",(function(){return L})),n(e.exports,"Point",(function(){return j})),n(e.exports,"Band",(function(){return z})),n(e.exports,"BinOrdinal",(function(){return U})),n(e.exports,"scale",(function(){return ee})),n(e.exports,"isValidScaleType",(function(){return te})),n(e.exports,"isContinuous",(function(){return re})),n(e.exports,"isDiscrete",(function(){return ae})),n(e.exports,"isDiscretizing",(function(){return ie})),n(e.exports,"isLogarithmic",(function(){return oe})),n(e.exports,"isInterpolating",(function(){return ue})),n(e.exports,"isQuantile",(function(){return se})),n(e.exports,"interpolateRange",(function(){return le})),n(e.exports,"interpolateColors",(function(){return fe})),n(e.exports,"interpolate",(function(){return he})),n(e.exports,"quantizeInterpolator",(function(){return de})),n(e.exports,"scaleFraction",(function(){return pe})),n(e.exports,"scheme",(function(){return ye})),n(e.exports,"SymbolLegend",(function(){return be})),n(e.exports,"GradientLegend",(function(){return ke})),n(e.exports,"tickCount",(function(){return Ce})),n(e.exports,"validTicks",(function(){return Se})),n(e.exports,"tickValues",(function(){return Ne})),n(e.exports,"tickFormat",(function(){return Te})),n(e.exports,"labelValues",(function(){return Ie})),n(e.exports,"labelFormat",(function(){return Re})),n(e.exports,"labelFraction",(function(){return ze})),n(e.exports,"domainCaption",(function(){return Ve})),n(e.exports,"scaleImplicit",(function(){return s("ka173").implicit})),s("1i51P");var r=s("4Ui3v"),a=s("caNzv"),i=s("jTUhZ"),o=s("4YaFt"),u=s("ka173"),c=s("jfY1m"),l=s("iUNAe"),f=s("iQDLo"),d=s("cr58D"),p=s("iWpor"),h=s("1OZ4S"),v=s("iBzRu"),g=s("9OpB9"),m=s("ensPk"),y=s("4ujx4"),x=s("4beD9"),b=s("eHKzB"),k=s("7kfTt");s("4CugC");var w=s("4QoRL"),A=s("4CugC");s("4CugC");w=s("4QoRL"),A=s("4CugC");var E=s("2U08m");u=s("ka173"),c=s("jfY1m"),l=s("iUNAe"),f=s("iQDLo"),d=s("cr58D"),p=s("iWpor"),h=s("1OZ4S"),v=s("iBzRu"),g=s("9OpB9"),m=s("ensPk"),y=s("4ujx4"),x=s("4beD9"),b=s("eHKzB"),k=s("7kfTt");function C(e,t,n){var r=e-t+2*n;return e?r>0?r:1:0}var S="linear",N="log",T="pow",D="sqrt",F="symlog",O="time",_="utc",I="sequential",R="diverging",M="quantile",B="quantize",P="threshold",L="ordinal",j="point",z="band",U="bin-ordinal",V="continuous",W="discrete",G="discretizing",H="interpolating",q="temporal";function J(){var e,t,n=u.default().unknown(void 0),r=n.domain,a=n.range,s=[0,1],c=!1,l=0,f=0,d=.5;function p(){var n=r().length,o=s[1]<s[0],u=s[1-o],p=C(n,l,f),h=s[o-0];e=(u-h)/(p||1),c&&(e=Math.floor(e)),h+=(u-h-e*(n-l))*d,t=e*(1-l),c&&(h=Math.round(h),t=Math.round(t));var v=i.default(n).map((function(t){return h+e*t}));return a(o?v.reverse():v)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),p()):r()},n.range=function(e){return arguments.length?(s=[+e[0],+e[1]],p()):s.slice()},n.rangeRound=function(e){return s=[+e[0],+e[1]],c=!0,p()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(c=!!e,p()):c},n.padding=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),l=f,p()):l},n.paddingInner=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),p()):l},n.paddingOuter=function(e){return arguments.length?(f=Math.max(0,Math.min(1,e)),p()):f},n.align=function(e){return arguments.length?(d=Math.max(0,Math.min(1,e)),p()):d},n.invertRange=function(e){if(null!=e[0]&&null!=e[1]){var n,i,u,c=s[1]<s[0],l=c?a().reverse():a(),f=l.length-1,d=+e[0],p=+e[1];if(d==d&&p==p&&(p<d&&(u=d,d=p,p=u),!(p<l[0]||d>s[1-c])))return n=Math.max(0,o.bisectRight(l,d)-1),i=d===p?n:o.bisectRight(l,p)-1,d-l[n]>t+1e-10&&++n,c&&(u=n,n=f-i,i=f-u),n>i?void 0:r().slice(n,i+1)}},n.invert=function(e){var t=n.invertRange([e,e]);return t?t[0]:t},n.copy=function(){return J().domain(r()).range(s).round(c).paddingInner(l).paddingOuter(f).align(d)},p()}function K(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,e.copy=function(){return K(t())},e}var X=Array.prototype.map;function Y(e){return X.call(e,a.toNumber)}var Q=Array.prototype.slice;var Z={};function $(e,t,n){var r=function(){var n=t();return n.invertRange||(n.invertRange=n.invert?function(e){return function(t){var n,r=t[0],a=t[1];return a<r&&(n=r,r=a,a=n),[e.invert(r),e.invert(a)]}}(n):n.invertExtent?function(e){return function(t){var n,r,a,i,o=e.range(),u=t[0],s=t[1],c=-1;for(s<u&&(r=u,u=s,s=r),a=0,i=o.length;a<i;++a)o[a]>=u&&o[a]<=s&&(c<0&&(c=a),n=a);if(!(c<0))return u=e.invertExtent(o[c]),s=e.invertExtent(o[n]),[void 0===u[0]?u[1]:u[0],void 0===s[1]?s[0]:s[1]]}}(n):void 0),n.type=e,n};return r.metadata=a.toSet(a.array(n)),r}function ee(e,t,n){return arguments.length>1?(Z[e]=$(e,t,n),this):te(e)?Z[e]:void 0}function te(e){return a.hasOwnProperty(Z,e)}function ne(e,t){var n=Z[e];return n&&n.metadata[t]}function re(e){return ne(e,V)}function ae(e){return ne(e,W)}function ie(e){return ne(e,G)}function oe(e){return ne(e,N)}function ue(e){return ne(e,H)}function se(e){return ne(e,M)}ee("identity",l.default),ee(S,f.default,V),ee(N,d.default,[V,N]),ee(T,p.default,V),ee(D,p.sqrt,V),ee(F,h.default,V),ee(O,v.default,[V,q]),ee(_,g.default,[V,q]),ee(I,m.default,[V,H]),ee("".concat(I,"-").concat(S),m.default,[V,H]),ee("".concat(I,"-").concat(N),m.sequentialLog,[V,H,N]),ee("".concat(I,"-").concat(T),m.sequentialPow,[V,H]),ee("".concat(I,"-").concat(D),m.sequentialSqrt,[V,H]),ee("".concat(I,"-").concat(F),m.sequentialSymlog,[V,H]),ee("".concat(R,"-").concat(S),y.default,[V,H]),ee("".concat(R,"-").concat(N),y.divergingLog,[V,H,N]),ee("".concat(R,"-").concat(T),y.divergingPow,[V,H]),ee("".concat(R,"-").concat(D),y.divergingSqrt,[V,H]),ee("".concat(R,"-").concat(F),y.divergingSymlog,[V,H]),ee(M,x.default,[G,M]),ee(B,b.default,G),ee(P,k.default,G),ee(U,(function e(){var t=[],n=[];function r(e){return null==e||e!=e?void 0:n[(o.default(t,e)-1)%n.length]}return r.domain=function(e){return arguments.length?(t=Y(e),r):t.slice()},r.range=function(e){return arguments.length?(n=Q.call(e),r):n.slice()},r.tickFormat=function(e,n){return c.default(t[0],a.peek(t),null==e?10:e,n)},r.copy=function(){return e().domain(r.domain()).range(r.range())},r}),[W,G]),ee(L,u.default,W),ee(z,J,W),ee(j,(function(){return K(J().paddingInner(1))}),W);var ce=["clamp","base","constant","exponent"];function le(e,t){var n=t[0],r=a.peek(t)-n;return function(t){return e(n+t*r)}}function fe(e,t,n){return w.default(he(t||"rgb",n),e)}function de(e,t){for(var n=new Array(t),r=t+1,a=0;a<t;)n[a]=e(++a/r);return n}function pe(e,t,n){var r,i,o,u=n-t;return u&&Number.isFinite(u)?(r=(i=e.type).indexOf("-"),i=r<0?i:i.slice(r+1),o=ee(i)().domain([t,n]).range([0,1]),ce.forEach((function(t){return e[t]?o[t](e[t]()):0})),o):a.constant(.5)}function he(e,t){var n=A[function(e){return"interpolate"+e.toLowerCase().split("-").map((function(e){return e[0].toUpperCase()+e.slice(1)})).join("")}(e)];return null!=t&&n&&n.gamma?n.gamma(t):n}function ve(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(6*r,6*++r);return n}function ge(e,t){for(var n in e)ye(n,t(e[n]))}var me={};function ye(e,t){return e=e&&e.toLowerCase(),arguments.length>1?(me[e]=t,this):me[e]}ge({category10:"1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf",category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5",accent:"7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666",dark2:"1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666",paired:"a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928",pastel1:"fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2",pastel2:"b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc",set1:"e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999",set2:"66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3",set3:"8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"},ve),ge({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(function(e){return fe(ve(e))}));var xe,be="symbol",ke="gradient",we=function(e){return a.isArray(e)?e.map((function(e){return String(e)})):String(e)},Ae=function(e,t){return e[1]-t[1]},Ee=function(e,t){return t[1]-e[1]};function Ce(e,t,n){var r;return a.isNumber(t)&&(e.bins&&(t=Math.max(t,e.bins.length)),null!=n&&(t=Math.min(t,Math.floor(a.span(e.domain())/n||1)))),a.isObject(t)&&(r=t.step,t=t.interval),a.isString(t)&&(t=e.type===O?E.timeInterval(t):e.type==_?E.utcInterval(t):a.error("Only time and utc scales accept interval strings."),r&&(t=t.every(r))),t}function Se(e,t,n){var r=e.range(),i=r[0],o=a.peek(r),u=Ae;if(i>o&&(r=o,o=i,i=r,u=Ee),i=Math.floor(i),o=Math.ceil(o),t=t.map((function(t){return[t,e(t)]})).filter((function(e){return i<=e[1]&&e[1]<=o})).sort(u).map((function(e){return e[0]})),n>0&&t.length>1){for(var s=[t[0],a.peek(t)];t.length>n&&t.length>=3;)t=t.filter((function(e,t){return!(t%2)}));t.length<3&&(t=s)}return t}function Ne(e,t){return e.bins?Se(e,e.bins):e.ticks?e.ticks(t):e.domain()}function Te(e,t,n,r,a,i){var o=t.type,u=we;if(o===O||a===O)u=e.timeFormat(r);else if(o===_||a===_)u=e.utcFormat(r);else if(oe(o)){var s=e.formatFloat(r);if(i||t.bins)u=s;else{var c=De(t,n,!1);u=function(e){return c(e)?s(e):""}}}else if(t.tickFormat){var l=t.domain();u=e.formatSpan(l[0],l[l.length-1],n,r)}else r&&(u=e.format(r));return u}function De(e,t,n){var r=Ne(e,t),a=e.base(),i=Math.log(a),o=Math.max(1,a*t/r.length),u=function(e){var t=e/Math.pow(a,Math.round(Math.log(e)/i));return t*a<a-.5&&(t*=a),t<=o};return n?r.filter(u):u}var Fe,Oe=(xe={},r.default(xe,M,"quantiles"),r.default(xe,B,"thresholds"),r.default(xe,P,"domain"),xe),_e=(Fe={},r.default(Fe,M,"quantiles"),r.default(Fe,B,"domain"),Fe);function Ie(e,t){return e.bins?(n=e.bins,(r=n.slice(0,-1)).max=a.peek(n),r):e.type===N?De(e,t,!0):Oe[e.type]?function(e){var t=[-1/0].concat(e);return t.max=1/0,t}(e[Oe[e.type]]()):Ne(e,t);var n,r}function Re(e,t,n,r,a,i,o){var u=_e[t.type]&&i!==O&&i!==_?function(e,t,n){var r,a=t[_e[t.type]](),i=a.length,o=i>1?a[1]-a[0]:a[0];for(r=1;r<i;++r)o=Math.min(o,a[r]-a[r-1]);return e.formatSpan(0,o,30,n)}(e,t,a):Te(e,t,n,a,i,o);return r===be&&function(e){return Oe[e.type]||e.bins}(t)?Me(u):"discrete"===r?Pe(u):Le(u)}var Me=function(e){return function(t,n,r){var a=Be(r[n+1],Be(r.max,1/0)),i=je(t,e),o=je(a,e);return i&&o?i+"  "+o:o?"< "+o:" "+i}},Be=function(e,t){return null!=e?e:t},Pe=function(e){return function(t,n){return n?e(t):null}},Le=function(e){return function(t){return e(t)}},je=function(e,t){return Number.isFinite(e)?t(e):null};function ze(e){var t=e.domain(),n=t.length-1,r=+t[0],i=+a.peek(t),o=i-r;if(e.type===P){var u=n?o/n:.1;o=(i+=u)-(r-=u)}return function(e){return(e-r)/o}}function Ue(e,t,n,r){var i=r||t.type;return a.isString(n)&&ne(i,q)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==O?n||i!==_?Re(e,t,5,null,n,r,!0):e.utcFormat("%A, %d %B %Y, %X UTC"):e.timeFormat("%A, %d %B %Y, %X")}function Ve(e,t,n){n=n||{};var r=Math.max(3,n.maxlen||7),i=Ue(e,t,n.format,n.formatType);if(ie(t.type)){var o=Ie(t).slice(1).map(i),u=o.length;return"".concat(u," boundar").concat(1===u?"y":"ies",": ").concat(o.join(", "))}if(ae(t.type)){var s=t.domain(),c=s.length,l=c>r?s.slice(0,r-2).map(i).join(", ")+", ending with "+s.slice(-1).map(i):s.map(i).join(", ");return"".concat(c," value").concat(1===c?"":"s",": ").concat(l)}var f=t.domain();return"values from ".concat(i(f[0])," to ").concat(i(a.peek(f)))}})),s.register("iUNAe",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("iQDLo"),a=s("kirzH");function i(e){var t;function n(e){return null==e||isNaN(e=+e)?t:e}return n.invert=n,n.domain=n.range=function(t){return arguments.length?(e=Array.from(t,a.default),n):e.slice()},n.unknown=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return i(e).unknown(t)},e=arguments.length?Array.from(e,a.default):[0,1],r.linearish(n)}})),s.register("iQDLo",(function(e,t){n(e.exports,"linearish",(function(){return u})),n(e.exports,"default",(function(){return c}));var r=s("hdht0"),a=s("aDMvI"),i=s("hRqMy"),o=s("jfY1m");function u(e){var t=e.domain;return e.ticks=function(e){var n=t();return r.default(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var r=t();return o.default(r[0],r[r.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var a,i,o=t(),u=0,s=o.length-1,c=o[u],l=o[s],f=10;for(l<c&&(i=c,c=l,l=i,i=u,u=s,s=i);f-- >0;){if((i=r.tickIncrement(c,l,n))===a)return o[u]=c,o[s]=l,t(o);if(i>0)c=Math.floor(c/i)*i,l=Math.ceil(l/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,l=Math.floor(l*i)/i}a=i}return e},e}function c(){var e=a.default();return e.copy=function(){return a.copy(e,c())},i.initRange.apply(e,arguments),u(e)}})),s.register("aDMvI",(function(e,t){n(e.exports,"identity",(function(){return f})),n(e.exports,"copy",(function(){return v})),n(e.exports,"transformer",(function(){return g})),n(e.exports,"default",(function(){return m}));var r=s("4YaFt");s("4CugC");var a=s("7viow"),i=s("6n6Ih"),o=s("dvaXC"),u=s("bSXUK"),c=s("kirzH"),l=[0,1];function f(e){return e}function d(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:u.default(isNaN(t)?NaN:.5)}function p(e,t,n){var r=e[0],a=e[1],i=t[0],o=t[1];return a<r?(r=d(a,r),i=n(o,i)):(r=d(r,a),i=n(i,o)),function(e){return i(r(e))}}function h(e,t,n){var a=Math.min(e.length,t.length)-1,i=new Array(a),o=new Array(a),u=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++u<a;)i[u]=d(e[u],e[u+1]),o[u]=n(t[u],t[u+1]);return function(t){var n=r.default(e,t,1,a)-1;return o[n](i[n](t))}}function v(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function g(){var e,t,n,r,u,s,d=l,v=l,g=a.default,m=f;function y(){var e,t,n,a=Math.min(d.length,v.length);return m!==f&&(e=d[0],t=d[a-1],e>t&&(n=e,e=t,t=n),m=function(n){return Math.max(e,Math.min(t,n))}),r=a>2?h:p,u=s=null,x}function x(t){return null==t||isNaN(t=+t)?n:(u||(u=r(d.map(e),v,g)))(e(m(t)))}return x.invert=function(n){return m(t((s||(s=r(v,d.map(e),i.default)))(n)))},x.domain=function(e){return arguments.length?(d=Array.from(e,c.default),y()):d.slice()},x.range=function(e){return arguments.length?(v=Array.from(e),y()):v.slice()},x.rangeRound=function(e){return v=Array.from(e),g=o.default,y()},x.clamp=function(e){return arguments.length?(m=!!e||f,y()):m!==f},x.interpolate=function(e){return arguments.length?(g=e,y()):g},x.unknown=function(e){return arguments.length?(n=e,x):n},function(n,r){return e=n,t=r,y()}}function m(){return g()(f,f)}})),s.register("4CugC",(function(e,t){n(e.exports,"interpolate",(function(){return s("7viow").default})),n(e.exports,"interpolateArray",(function(){return s("ROJMv").default})),n(e.exports,"interpolateBasis",(function(){return s("cjgVm").default})),n(e.exports,"interpolateBasisClosed",(function(){return s("cYBl3").default})),n(e.exports,"interpolateDate",(function(){return s("eKYoP").default})),n(e.exports,"interpolateDiscrete",(function(){return s("hGFpl").default})),n(e.exports,"interpolateHue",(function(){return s("8M4kS").default})),n(e.exports,"interpolateNumber",(function(){return s("6n6Ih").default})),n(e.exports,"interpolateNumberArray",(function(){return s("fWPa6").default})),n(e.exports,"interpolateObject",(function(){return s("5RFsp").default})),n(e.exports,"interpolateRound",(function(){return s("dvaXC").default})),n(e.exports,"interpolateString",(function(){return s("i3eWx").default})),n(e.exports,"interpolateTransformCss",(function(){return s("3hC8m").interpolateTransformCss})),n(e.exports,"interpolateTransformSvg",(function(){return s("3hC8m").interpolateTransformSvg})),n(e.exports,"interpolateZoom",(function(){return s("fvKWF").default})),n(e.exports,"interpolateRgb",(function(){return s("6xrLS").default})),n(e.exports,"interpolateRgbBasis",(function(){return s("6xrLS").rgbBasis})),n(e.exports,"interpolateRgbBasisClosed",(function(){return s("6xrLS").rgbBasisClosed})),n(e.exports,"interpolateHsl",(function(){return s("ixmS4").default})),n(e.exports,"interpolateHslLong",(function(){return s("ixmS4").hslLong})),n(e.exports,"interpolateLab",(function(){return s("3k8du").default})),n(e.exports,"interpolateHcl",(function(){return s("5RXn1").default})),n(e.exports,"interpolateHclLong",(function(){return s("5RXn1").hclLong})),n(e.exports,"interpolateCubehelix",(function(){return s("alrpN").default})),n(e.exports,"interpolateCubehelixLong",(function(){return s("alrpN").cubehelixLong})),n(e.exports,"piecewise",(function(){return s("4QoRL").default})),n(e.exports,"quantize",(function(){return s("8P3vV").default}));s("7viow"),s("ROJMv"),s("cjgVm"),s("cYBl3"),s("eKYoP"),s("hGFpl"),s("8M4kS"),s("6n6Ih"),s("fWPa6"),s("5RFsp"),s("dvaXC"),s("i3eWx"),s("3hC8m"),s("fvKWF"),s("6xrLS"),s("ixmS4"),s("3k8du"),s("5RXn1"),s("alrpN"),s("4QoRL"),s("8P3vV")})),s.register("7viow",(function(e,t){n(e.exports,"default",(function(){return h})),s("1i51P");var r=s("5lcaY"),a=s("eRnrt"),i=s("6xrLS"),o=s("ROJMv"),u=s("eKYoP"),c=s("6n6Ih"),l=s("5RFsp"),f=s("i3eWx"),d=s("gzawD"),p=s("fWPa6");function h(e,t){var n,s=void 0===t?"undefined":r.default(t);return null==t||"boolean"===s?d.default(t):("number"===s?c.default:"string"===s?(n=a.default(t))?(t=n,i.default):f.default:t instanceof a.default?i.default:t instanceof Date?u.default:p.isNumberArray(t)?p.default:Array.isArray(t)?o.genericArray:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?l.default:c.default)(e,t)}})),s.register("eRnrt",(function(e,t){n(e.exports,"Color",(function(){return a})),n(e.exports,"darker",(function(){return i})),n(e.exports,"brighter",(function(){return o})),n(e.exports,"default",(function(){return k})),n(e.exports,"Rgb",(function(){return S})),n(e.exports,"rgbConvert",(function(){return E})),n(e.exports,"rgb",(function(){return C})),n(e.exports,"hsl",(function(){return _}));var r=s("atE1t");function a(){}var i=.7,o=1/i,u="\\s*([+-]?\\d+)\\s*",c="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",f=/^#([0-9a-f]{3,8})$/,d=new RegExp("^rgb\\("+[u,u,u]+"\\)$"),p=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),h=new RegExp("^rgba\\("+[u,u,u,c]+"\\)$"),v=new RegExp("^rgba\\("+[l,l,l,c]+"\\)$"),g=new RegExp("^hsl\\("+[c,l,l]+"\\)$"),m=new RegExp("^hsla\\("+[c,l,l,c]+"\\)$"),y={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function x(){return this.rgb().formatHex()}function b(){return this.rgb().formatRgb()}function k(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=f.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?w(t):3===n?new S(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?A(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?A(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=d.exec(e))?new S(t[1],t[2],t[3],1):(t=p.exec(e))?new S(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=h.exec(e))?A(t[1],t[2],t[3],t[4]):(t=v.exec(e))?A(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=g.exec(e))?F(t[1],t[2]/100,t[3]/100,1):(t=m.exec(e))?F(t[1],t[2]/100,t[3]/100,t[4]):y.hasOwnProperty(e)?w(y[e]):"transparent"===e?new S(NaN,NaN,NaN,0):null}function w(e){return new S(e>>16&255,e>>8&255,255&e,1)}function A(e,t,n,r){return r<=0&&(e=t=n=NaN),new S(e,t,n,r)}function E(e){return e instanceof a||(e=k(e)),e?new S((e=e.rgb()).r,e.g,e.b,e.opacity):new S}function C(e,t,n,r){return 1===arguments.length?E(e):new S(e,t,n,null==r?1:r)}function S(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}function N(){return"#"+D(this.r)+D(this.g)+D(this.b)}function T(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function D(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function F(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new I(e,t,n,r)}function O(e){if(e instanceof I)return new I(e.h,e.s,e.l,e.opacity);if(e instanceof a||(e=k(e)),!e)return new I;if(e instanceof I)return e;var t=(e=e.rgb()).r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),o=Math.max(t,n,r),u=NaN,s=o-i,c=(o+i)/2;return s?(u=t===o?(n-r)/s+6*(n<r):n===o?(r-t)/s+2:(t-n)/s+4,s/=c<.5?o+i:2-o-i,u*=60):s=c>0&&c<1?0:u,new I(u,s,c,e.opacity)}function _(e,t,n,r){return 1===arguments.length?O(e):new I(e,t,n,null==r?1:r)}function I(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}function R(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}r.default(a,k,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:x,formatHex:x,formatHsl:function(){return O(this).formatHsl()},formatRgb:b,toString:b}),r.default(S,C,r.extend(a,{brighter:function e(t){return t=null==t?e:Math.pow(e,t),new S(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function e(t){return t=null==t?e:Math.pow(e,t),new S(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:N,formatHex:N,formatRgb:T,toString:T})),r.default(I,_,r.extend(a,{brighter:function e(t){return t=null==t?e:Math.pow(e,t),new I(this.h,this.s,this.l*t,this.opacity)},darker:function e(t){return t=null==t?e:Math.pow(e,t),new I(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,a=2*n-r;return new S(R(e>=240?e-240:e+120,a,r),R(e,a,r),R(e<120?e+240:e-120,a,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}))})),s.register("atE1t",(function(e,t){function r(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function a(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}n(e.exports,"default",(function(){return r})),n(e.exports,"extend",(function(){return a}))})),s.register("jNgKw",(function(e,t){n(e.exports,"default",(function(){return p})),n(e.exports,"hcl",(function(){return b}));var r=s("atE1t"),a=s("eRnrt"),i=s("3ni7E"),o=.96422,u=.82521,c=4/29,l=6/29,f=.12841854934601665;function d(e){if(e instanceof h)return new h(e.l,e.a,e.b,e.opacity);if(e instanceof k)return w(e);e instanceof a.Rgb||(e=a.rgbConvert(e));var t,n,r=y(e.r),i=y(e.g),s=y(e.b),c=v((.2225045*r+.7168786*i+.0606169*s)/1);return r===i&&i===s?t=n=c:(t=v((.4360747*r+.3850649*i+.1430804*s)/o),n=v((.0139322*r+.0971045*i+.7141733*s)/u)),new h(116*c-16,500*(t-c),200*(c-n),e.opacity)}function p(e,t,n,r){return 1===arguments.length?d(e):new h(e,t,n,null==r?1:r)}function h(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}function v(e){return e>.008856451679035631?Math.pow(e,1/3):e/f+c}function g(e){return e>l?e*e*e:f*(e-c)}function m(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function y(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function x(e){if(e instanceof k)return new k(e.h,e.c,e.l,e.opacity);if(e instanceof h||(e=d(e)),0===e.a&&0===e.b)return new k(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*i.degrees;return new k(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function b(e,t,n,r){return 1===arguments.length?x(e):new k(e,t,n,null==r?1:r)}function k(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function w(e){if(isNaN(e.h))return new h(e.l,0,0,e.opacity);var t=e.h*i.radians;return new h(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}r.default(h,p,r.extend(a.Color,{brighter:function(e){return new h(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new h(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=o*g(t),e=1*g(e),n=u*g(n),new a.Rgb(m(3.1338561*t-1.6168667*e-.4906146*n),m(-.9787684*t+1.9161415*e+.033454*n),m(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),r.default(k,b,r.extend(a.Color,{brighter:function(e){return new k(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new k(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return w(this).rgb()}}))})),s.register("3ni7E",(function(e,t){n(e.exports,"radians",(function(){return r})),n(e.exports,"degrees",(function(){return a}));var r=Math.PI/180,a=180/Math.PI})),s.register("9xkUr",(function(e,t){n(e.exports,"default",(function(){return g}));var r=s("atE1t"),a=s("eRnrt"),i=s("3ni7E"),o=-.14861,u=1.78277,c=-.29227,l=-.90649,f=1.97294,d=-1.7884503806,p=3.5172982438,h=-.6557636667999999;function v(e){if(e instanceof m)return new m(e.h,e.s,e.l,e.opacity);e instanceof a.Rgb||(e=a.rgbConvert(e));var t=e.r/255,n=e.g/255,r=e.b/255,o=(h*r+d*t-p*n)/-5.9615122912,u=r-o,s=(f*(n-o)-c*u)/l,v=Math.sqrt(s*s+u*u)/(f*o*(1-o)),g=v?Math.atan2(s,u)*i.degrees-120:NaN;return new m(g<0?g+360:g,v,o,e.opacity)}function g(e,t,n,r){return 1===arguments.length?v(e):new m(e,t,n,null==r?1:r)}function m(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}r.default(m,g,r.extend(a.Color,{brighter:function(e){return e=null==e?a.brighter:Math.pow(a.brighter,e),new m(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?a.darker:Math.pow(a.darker,e),new m(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*i.radians,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),s=Math.sin(e);return new a.Rgb(255*(t+n*(o*r+u*s)),255*(t+n*(c*r+l*s)),255*(t+n*(f*r)),this.opacity)}}))})),s.register("6xrLS",(function(e,t){n(e.exports,"default",(function(){return u})),n(e.exports,"rgbBasis",(function(){return l})),n(e.exports,"rgbBasisClosed",(function(){return f}));var r=s("eRnrt"),a=s("cjgVm"),i=s("cYBl3"),o=s("8FJzM"),u=function e(t){var n=o.gamma(t);function a(e,t){var a=n((e=r.rgb(e)).r,(t=r.rgb(t)).r),i=n(e.g,t.g),u=n(e.b,t.b),s=o.default(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=i(t),e.b=u(t),e.opacity=s(t),e+""}}return a.gamma=e,a}(1);function c(e){return function(t){var n,a,i=t.length,o=new Array(i),u=new Array(i),s=new Array(i);for(n=0;n<i;++n)a=r.rgb(t[n]),o[n]=a.r||0,u[n]=a.g||0,s[n]=a.b||0;return o=e(o),u=e(u),s=e(s),a.opacity=1,function(e){return a.r=o(e),a.g=u(e),a.b=s(e),a+""}}}var l=c(a.default),f=c(i.default)})),s.register("cjgVm",(function(e,t){function r(e,t,n,r,a){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*n+(1+3*e+3*i-3*o)*r+o*a)/6}function a(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[a],o=e[a+1],u=a>0?e[a-1]:2*i-o,s=a<t-1?e[a+2]:2*o-i;return r((n-a/t)*t,u,i,o,s)}}n(e.exports,"basis",(function(){return r})),n(e.exports,"default",(function(){return a}))})),s.register("cYBl3",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("cjgVm");function a(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),i=e[(a+t-1)%t],o=e[a%t],u=e[(a+1)%t],s=e[(a+2)%t];return r.basis((n-a/t)*t,i,o,u,s)}}})),s.register("8FJzM",(function(e,t){n(e.exports,"hue",(function(){return i})),n(e.exports,"gamma",(function(){return o})),n(e.exports,"default",(function(){return u}));var r=s("gzawD");function a(e,t){return function(n){return e+n*t}}function i(e,t){var n=t-e;return n?a(e,n>180||n<-180?n-360*Math.round(n/360):n):r.default(isNaN(e)?t:e)}function o(e){return 1==(e=+e)?u:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}(t,n,e):r.default(isNaN(t)?n:t)}}function u(e,t){var n=t-e;return n?a(e,n):r.default(isNaN(e)?t:e)}})),s.register("gzawD",(function(e,t){n(e.exports,"default",(function(){return r}));var r=function(e){return function(){return e}}})),s.register("ROJMv",(function(e,t){n(e.exports,"default",(function(){return i})),n(e.exports,"genericArray",(function(){return o}));var r=s("7viow"),a=s("fWPa6");function i(e,t){return(a.isNumberArray(t)?a.default:o)(e,t)}function o(e,t){var n,a=t?t.length:0,i=e?Math.min(a,e.length):0,o=new Array(i),u=new Array(a);for(n=0;n<i;++n)o[n]=r.default(e[n],t[n]);for(;n<a;++n)u[n]=t[n];return function(e){for(n=0;n<i;++n)u[n]=o[n](e);return u}}})),s.register("fWPa6",(function(e,t){function r(e,t){t||(t=[]);var n,r=e?Math.min(t.length,e.length):0,a=t.slice();return function(i){for(n=0;n<r;++n)a[n]=e[n]*(1-i)+t[n]*i;return a}}function a(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}n(e.exports,"default",(function(){return r})),n(e.exports,"isNumberArray",(function(){return a}))})),s.register("eKYoP",(function(e,t){function r(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}n(e.exports,"default",(function(){return r}))})),s.register("6n6Ih",(function(e,t){function r(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}n(e.exports,"default",(function(){return r}))})),s.register("5RFsp",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("7viow");function a(e,t){var n,a={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?a[n]=r.default(e[n],t[n]):i[n]=t[n];return function(e){for(n in a)i[n]=a[n](e);return i}}})),s.register("i3eWx",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("6n6Ih"),a=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,i=new RegExp(a.source,"g");function o(e,t){var n,o,u,s=a.lastIndex=i.lastIndex=0,c=-1,l=[],f=[];for(e+="",t+="";(n=a.exec(e))&&(o=i.exec(t));)(u=o.index)>s&&(u=t.slice(s,u),l[c]?l[c]+=u:l[++c]=u),(n=n[0])===(o=o[0])?l[c]?l[c]+=o:l[++c]=o:(l[++c]=null,f.push({i:c,x:r.default(n,o)})),s=i.lastIndex;return s<t.length&&(u=t.slice(s),l[c]?l[c]+=u:l[++c]=u),l.length<2?f[0]?function(e){return function(t){return e(t)+""}}(f[0].x):function(e){return function(){return e}}(t):(t=f.length,function(e){for(var n,r=0;r<t;++r)l[(n=f[r]).i]=n.x(e);return l.join("")})}})),s.register("hGFpl",(function(e,t){function r(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}n(e.exports,"default",(function(){return r}))})),s.register("8M4kS",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("8FJzM");function a(e,t){var n=r.hue(+e,+t);return function(e){var t=n(e);return t-360*Math.floor(t/360)}}})),s.register("dvaXC",(function(e,t){function r(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}n(e.exports,"default",(function(){return r}))})),s.register("3hC8m",(function(e,t){n(e.exports,"interpolateTransformCss",(function(){return o})),n(e.exports,"interpolateTransformSvg",(function(){return u}));var r=s("6n6Ih"),a=s("3B5ZB");function i(e,t,n,a){function i(e){return e.length?e.pop()+" ":""}return function(o,u){var s=[],c=[];return o=e(o),u=e(u),function(e,a,i,o,u,s){if(e!==i||a!==o){var c=u.push("translate(",null,t,null,n);s.push({i:c-4,x:r.default(e,i)},{i:c-2,x:r.default(a,o)})}else(i||o)&&u.push("translate("+i+t+o+n)}(o.translateX,o.translateY,u.translateX,u.translateY,s,c),function(e,t,n,o){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),o.push({i:n.push(i(n)+"rotate(",null,a)-2,x:r.default(e,t)})):t&&n.push(i(n)+"rotate("+t+a)}(o.rotate,u.rotate,s,c),function(e,t,n,o){e!==t?o.push({i:n.push(i(n)+"skewX(",null,a)-2,x:r.default(e,t)}):t&&n.push(i(n)+"skewX("+t+a)}(o.skewX,u.skewX,s,c),function(e,t,n,a,o,u){if(e!==n||t!==a){var s=o.push(i(o)+"scale(",null,",",null,")");u.push({i:s-4,x:r.default(e,n)},{i:s-2,x:r.default(t,a)})}else 1===n&&1===a||o.push(i(o)+"scale("+n+","+a+")")}(o.scaleX,o.scaleY,u.scaleX,u.scaleY,s,c),o=u=null,function(e){for(var t,n=-1,r=c.length;++n<r;)s[(t=c[n]).i]=t.x(e);return s.join("")}}}var o=i(a.parseCss,"px, ","px)","deg)"),u=i(a.parseSvg,", ",")",")")})),s.register("3B5ZB",(function(e,t){n(e.exports,"parseCss",(function(){return i})),n(e.exports,"parseSvg",(function(){return o}));var r,a=s("hJqAJ");function i(e){var t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?a.identity:a.default(t.a,t.b,t.c,t.d,t.e,t.f)}function o(e){return null==e?a.identity:(r||(r=document.createElementNS("http://www.w3.org/2000/svg","g")),r.setAttribute("transform",e),(e=r.transform.baseVal.consolidate())?(e=e.matrix,a.default(e.a,e.b,e.c,e.d,e.e,e.f)):a.identity)}})),s.register("hJqAJ",(function(e,t){n(e.exports,"identity",(function(){return a})),n(e.exports,"default",(function(){return i}));var r=180/Math.PI,a={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function i(e,t,n,a,i,o){var u,s,c;return(u=Math.sqrt(e*e+t*t))&&(e/=u,t/=u),(c=e*n+t*a)&&(n-=e*c,a-=t*c),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,c/=s),e*a<t*n&&(e=-e,t=-t,c=-c,u=-u),{translateX:i,translateY:o,rotate:Math.atan2(t,e)*r,skewX:Math.atan(c)*r,scaleX:u,scaleY:s}}})),s.register("fvKWF",(function(e,t){n(e.exports,"default",(function(){return a}));function r(e){return((e=Math.exp(e))+1/e)/2}var a=function e(t,n,a){function i(e,i){var o,u,s=e[0],c=e[1],l=e[2],f=i[0],d=i[1],p=i[2],h=f-s,v=d-c,g=h*h+v*v;if(g<1e-12)u=Math.log(p/l)/t,o=function(e){return[s+e*h,c+e*v,l*Math.exp(t*e*u)]};else{var m=Math.sqrt(g),y=(p*p-l*l+a*g)/(2*l*n*m),x=(p*p-l*l-a*g)/(2*p*n*m),b=Math.log(Math.sqrt(y*y+1)-y),k=Math.log(Math.sqrt(x*x+1)-x);u=(k-b)/t,o=function(e){var a=e*u,i=r(b),o=l/(n*m)*(i*function(e){return((e=Math.exp(2*e))-1)/(e+1)}(t*a+b)-function(e){return((e=Math.exp(e))-1/e)/2}(b));return[s+o*h,c+o*v,l*i/r(t*a+b)]}}return o.duration=1e3*u*t/Math.SQRT2,o}return i.rho=function(t){var n=Math.max(.001,+t),r=n*n;return e(n,r,r*r)},i}(Math.SQRT2,2,4)})),s.register("ixmS4",(function(e,t){n(e.exports,"default",(function(){return o})),n(e.exports,"hslLong",(function(){return u}));var r=s("eRnrt"),a=s("8FJzM");function i(e){return function(t,n){var i=e((t=r.hsl(t)).h,(n=r.hsl(n)).h),o=a.default(t.s,n.s),u=a.default(t.l,n.l),s=a.default(t.opacity,n.opacity);return function(e){return t.h=i(e),t.s=o(e),t.l=u(e),t.opacity=s(e),t+""}}}var o=i(a.hue),u=i(a.default)})),s.register("3k8du",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("jNgKw"),a=s("8FJzM");function i(e,t){var n=a.default((e=r.default(e)).l,(t=r.default(t)).l),i=a.default(e.a,t.a),o=a.default(e.b,t.b),u=a.default(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=o(t),e.opacity=u(t),e+""}}})),s.register("5RXn1",(function(e,t){n(e.exports,"default",(function(){return o})),n(e.exports,"hclLong",(function(){return u}));var r=s("jNgKw"),a=s("8FJzM");function i(e){return function(t,n){var i=e((t=r.hcl(t)).h,(n=r.hcl(n)).h),o=a.default(t.c,n.c),u=a.default(t.l,n.l),s=a.default(t.opacity,n.opacity);return function(e){return t.h=i(e),t.c=o(e),t.l=u(e),t.opacity=s(e),t+""}}}var o=i(a.hue),u=i(a.default)})),s.register("alrpN",(function(e,t){n(e.exports,"default",(function(){return o})),n(e.exports,"cubehelixLong",(function(){return u}));var r=s("9xkUr"),a=s("8FJzM");function i(e){return function t(n){function i(t,i){var o=e((t=r.default(t)).h,(i=r.default(i)).h),u=a.default(t.s,i.s),s=a.default(t.l,i.l),c=a.default(t.opacity,i.opacity);return function(e){return t.h=o(e),t.s=u(e),t.l=s(Math.pow(e,n)),t.opacity=c(e),t+""}}return n=+n,i.gamma=t,i}(1)}var o=i(a.hue),u=i(a.default)})),s.register("4QoRL",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("7viow");function a(e,t){void 0===t&&(t=e,e=r.default);for(var n=0,a=t.length-1,i=t[0],o=new Array(a<0?0:a);n<a;)o[n]=e(i,i=t[++n]);return function(e){var t=Math.max(0,Math.min(a-1,Math.floor(e*=a)));return o[t](e-t)}}})),s.register("8P3vV",(function(e,t){function r(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}n(e.exports,"default",(function(){return r}))})),s.register("bSXUK",(function(e,t){function r(e){return function(){return e}}n(e.exports,"default",(function(){return r}))})),s.register("kirzH",(function(e,t){function r(e){return+e}n(e.exports,"default",(function(){return r}))})),s.register("hRqMy",(function(e,t){function r(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function a(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}n(e.exports,"initRange",(function(){return r})),n(e.exports,"initInterpolator",(function(){return a}))})),s.register("jfY1m",(function(e,t){n(e.exports,"default",(function(){return l}));var r=s("hdht0");s("cftDg");var a=s("hluxZ"),i=s("jCsLA"),o=s("l2BE5"),u=s("aX2pO"),c=s("4im57");function l(e,t,n,s){var l,f=r.tickStep(e,t,n);switch((s=a.default(null==s?",f":s)).type){case"s":var d=Math.max(Math.abs(e),Math.abs(t));return null!=s.precision||isNaN(l=i.default(f,d))||(s.precision=l),o.formatPrefix(s,d);case"":case"e":case"g":case"p":case"r":null!=s.precision||isNaN(l=u.default(f,Math.max(Math.abs(e),Math.abs(t))))||(s.precision=l-("e"===s.type));break;case"f":case"%":null!=s.precision||isNaN(l=c.default(f))||(s.precision=l-2*("%"===s.type))}return o.format(s)}})),s.register("cftDg",(function(e,t){n(e.exports,"format",(function(){return s("l2BE5").format})),n(e.exports,"formatPrefix",(function(){return s("l2BE5").formatPrefix})),n(e.exports,"formatSpecifier",(function(){return s("hluxZ").default})),n(e.exports,"precisionFixed",(function(){return s("4im57").default})),n(e.exports,"precisionPrefix",(function(){return s("jCsLA").default})),n(e.exports,"precisionRound",(function(){return s("aX2pO").default}));s("l2BE5"),s("19X1J"),s("hluxZ"),s("4im57"),s("jCsLA"),s("aX2pO")})),s.register("l2BE5",(function(e,t){n(e.exports,"format",(function(){return a})),n(e.exports,"formatPrefix",(function(){return i}));var r,a,i,o,u=s("19X1J");o={decimal:".",thousands:",",grouping:[3],currency:["$",""]},r=u.default(o),a=r.format,i=r.formatPrefix})),s.register("19X1J",(function(e,t){n(e.exports,"default",(function(){return p}));var r=s("bELVp"),a=s("eXOaO"),i=s("j4viJ"),o=s("hluxZ"),u=s("y4kSZ"),c=s("ldNU8"),l=s("68raU"),f=s("ircAt"),d=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function p(e){var t=e.grouping&&e.thousands?a.default(e.grouping,e.thousands):f.default,n=e.currency,s=e.decimal,p=e.numerals?i.default(e.numerals):f.default,h=e.percent||"%";function v(e){var r=(e=o.default(e)).fill,a=e.align,i=e.sign,f=e.symbol,v=e.zero,g=e.width,m=e.comma,y=e.precision,x=e.trim,b=e.type;"n"===b?(m=!0,b="g"):c.default[b]||(null==y&&(y=12),x=!0,b="g"),(v||"0"===r&&"="===a)&&(v=!0,r="0",a="=");var k="$"===f?n[0]:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===f?n[1]:/[%p]/.test(b)?h:"",A=c.default[b],E=/[defgprs%]/.test(b);function C(e){var n,o,c,f=k,h=w;if("c"===b)h=A(e)+h,e="";else{var C=(e=+e)<0;if(e=A(Math.abs(e),y),x&&(e=u.default(e)),C&&0==+e&&(C=!1),f=(C?"("===i?i:"-":"-"===i||"("===i?"":i)+f,h=("s"===b?d[8+l.prefixExponent/3]:"")+h+(C&&"("===i?")":""),E)for(n=-1,o=e.length;++n<o;)if(48>(c=e.charCodeAt(n))||c>57){h=(46===c?s+e.slice(n+1):e.slice(n))+h,e=e.slice(0,n);break}}m&&!v&&(e=t(e,1/0));var S=f.length+e.length+h.length,N=S<g?new Array(g-S+1).join(r):"";switch(m&&v&&(e=t(N+e,N.length?g-h.length:1/0),N=""),a){case"<":e=f+e+h+N;break;case"=":e=f+N+e+h;break;case"^":e=N.slice(0,S=N.length>>1)+f+e+h+N.slice(S);break;default:e=N+f+e+h}return p(e)}return y=null==y?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,y)):Math.max(0,Math.min(20,y)),C.toString=function(){return e+""},C}return{format:v,formatPrefix:function(e,t){var n=v(((e=o.default(e)).type="f",e)),a=3*Math.max(-8,Math.min(8,Math.floor(r.default(t)/3))),i=Math.pow(10,-a),u=d[8+a/3];return function(e){return n(i*e)+u}}}}})),s.register("bELVp",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("hMVea");function a(e){return(e=r.default(Math.abs(e)))?e[1]:NaN}})),s.register("hMVea",(function(e,t){function r(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}n(e.exports,"default",(function(){return r}))})),s.register("eXOaO",(function(e,t){function r(e,t){return function(n,r){for(var a=n.length,i=[],o=0,u=e[0],s=0;a>0&&u>0&&(s+u+1>r&&(u=Math.max(1,r-s)),i.push(n.substring(a-=u,a+u)),!((s+=u+1)>r));)u=e[o=(o+1)%e.length];return i.reverse().join(t)}}n(e.exports,"default",(function(){return r}))})),s.register("j4viJ",(function(e,t){function r(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}n(e.exports,"default",(function(){return r}))})),s.register("hluxZ",(function(e,t){n(e.exports,"default",(function(){return a}));var r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function a(e){return new i(e)}function i(e){if(!(t=r.exec(e)))throw new Error("invalid format: "+e);var t;this.fill=t[1]||" ",this.align=t[2]||">",this.sign=t[3]||"-",this.symbol=t[4]||"",this.zero=!!t[5],this.width=t[6]&&+t[6],this.comma=!!t[7],this.precision=t[8]&&+t[8].slice(1),this.trim=!!t[9],this.type=t[10]||""}a.prototype=i.prototype,i.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}})),s.register("y4kSZ",(function(e,t){function r(e){e:for(var t,n=e.length,r=1,a=-1;r<n;++r)switch(e[r]){case".":a=t=r;break;case"0":0===a&&(a=r),t=r;break;default:if(a>0){if(!+e[r])break e;a=0}}return a>0?e.slice(0,a)+e.slice(t+1):e}n(e.exports,"default",(function(){return r}))})),s.register("ldNU8",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("68raU"),a=s("AlBNF"),i={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return a.default(100*e,t)},r:a.default,s:r.default,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}}})),s.register("68raU",(function(e,t){n(e.exports,"prefixExponent",(function(){return r})),n(e.exports,"default",(function(){return i}));var r,a=s("hMVea");function i(e,t){var n=a.default(e,t);if(!n)return e+"";var i=n[0],o=n[1],u=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,s=i.length;return u===s?i:u>s?i+new Array(u-s+1).join("0"):u>0?i.slice(0,u)+"."+i.slice(u):"0."+new Array(1-u).join("0")+a.default(e,Math.max(0,t+u-1))[0]}})),s.register("AlBNF",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("hMVea");function a(e,t){var n=r.default(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}})),s.register("ircAt",(function(e,t){function r(e){return e}n(e.exports,"default",(function(){return r}))})),s.register("4im57",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bELVp");function a(e){return Math.max(0,-r.default(Math.abs(e)))}})),s.register("jCsLA",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bELVp");function a(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(r.default(t)/3)))-r.default(Math.abs(e)))}})),s.register("aX2pO",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bELVp");function a(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,r.default(t)-r.default(e))+1}})),s.register("cr58D",(function(e,t){n(e.exports,"loggish",(function(){return v})),n(e.exports,"default",(function(){return g}));var r=s("hdht0");s("cftDg");var a=s("l2BE5"),i=s("i8HMO"),o=s("aDMvI"),u=s("hRqMy");function c(e){return Math.log(e)}function l(e){return Math.exp(e)}function f(e){return-Math.log(-e)}function d(e){return-Math.exp(-e)}function p(e){return isFinite(e)?+("1e"+e):e<0?0:e}function h(e){return function(t){return-e(-t)}}function v(e){var t,n,o=e(c,l),u=o.domain,s=10;function v(){return t=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(s),n=function(e){return 10===e?p:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(s),u()[0]<0?(t=h(t),n=h(n),e(f,d)):e(c,l),o}return o.base=function(e){return arguments.length?(s=+e,v()):s},o.domain=function(e){return arguments.length?(u(e),v()):u()},o.ticks=function(e){var a,i=u(),o=i[0],c=i[i.length-1];(a=c<o)&&(p=o,o=c,c=p);var l,f,d,p=t(o),h=t(c),v=null==e?10:+e,g=[];if(!(s%1)&&h-p<v){if(p=Math.floor(p),h=Math.ceil(h),o>0){for(;p<=h;++p)for(f=1,l=n(p);f<s;++f)if(!((d=l*f)<o)){if(d>c)break;g.push(d)}}else for(;p<=h;++p)for(f=s-1,l=n(p);f>=1;--f)if(!((d=l*f)<o)){if(d>c)break;g.push(d)}2*g.length<v&&(g=r.default(o,c,v))}else g=r.default(p,h,Math.min(h-p,v)).map(n);return a?g.reverse():g},o.tickFormat=function(e,r){if(null==r&&(r=10===s?".0e":","),"function"!=typeof r&&(r=a.format(r)),e===1/0)return r;null==e&&(e=10);var i=Math.max(1,s*e/o.ticks().length);return function(e){var a=e/n(Math.round(t(e)));return a*s<s-.5&&(a*=s),a<=i?r(e):""}},o.nice=function(){return u(i.default(u(),{floor:function(e){return n(Math.floor(t(e)))},ceil:function(e){return n(Math.ceil(t(e)))}}))},o}function g(){var e=v(o.transformer()).domain([1,10]);return e.copy=function(){return o.copy(e,g()).base(e.base())},u.initRange.apply(e,arguments),e}})),s.register("i8HMO",(function(e,t){function r(e,t){var n,r=0,a=(e=e.slice()).length-1,i=e[r],o=e[a];return o<i&&(n=r,r=a,a=n,n=i,i=o,o=n),e[r]=t.floor(i),e[a]=t.ceil(o),e}n(e.exports,"default",(function(){return r}))})),s.register("1OZ4S",(function(e,t){n(e.exports,"symlogish",(function(){return c})),n(e.exports,"default",(function(){return l}));var r=s("iQDLo"),a=s("aDMvI"),i=s("hRqMy");function o(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function u(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function c(e){var t=1,n=e(o(t),u(t));return n.constant=function(n){return arguments.length?e(o(t=+n),u(t)):t},r.linearish(n)}function l(){var e=c(a.transformer());return e.copy=function(){return a.copy(e,l()).constant(e.constant())},i.initRange.apply(e,arguments)}})),s.register("ka173",(function(e,t){n(e.exports,"implicit",(function(){return a})),n(e.exports,"default",(function(){return i}));var r=s("hRqMy"),a=Symbol("implicit");function i(){var e=new Map,t=[],n=[],o=a;function u(r){var i=r+"",u=e.get(i);if(!u){if(o!==a)return o;e.set(i,u=t.push(r))}return n[(u-1)%n.length]}return u.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Map;var r=!0,a=!1,i=void 0;try{for(var o,s=n[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value,l=c+"";e.has(l)||e.set(l,t.push(c))}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return u},u.range=function(e){return arguments.length?(n=Array.from(e),u):n.slice()},u.unknown=function(e){return arguments.length?(o=e,u):o},u.copy=function(){return i(t,n).unknown(o)},r.initRange.apply(u,arguments),u}})),s.register("iWpor",(function(e,t){n(e.exports,"powish",(function(){return l})),n(e.exports,"default",(function(){return f})),n(e.exports,"sqrt",(function(){return d}));var r=s("iQDLo"),a=s("aDMvI"),i=s("hRqMy");function o(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function u(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function c(e){return e<0?-e*e:e*e}function l(e){var t=e(a.identity,a.identity),n=1;function i(){return 1===n?e(a.identity,a.identity):.5===n?e(u,c):e(o(n),o(1/n))}return t.exponent=function(e){return arguments.length?(n=+e,i()):n},r.linearish(t)}function f(){var e=l(a.transformer());return e.copy=function(){return a.copy(e,f()).exponent(e.exponent())},i.initRange.apply(e,arguments),e}function d(){return f.apply(null,arguments).exponent(.5)}})),s.register("4beD9",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("bQzCL"),a=s("4YaFt"),i=s("35HQC"),o=s("hRqMy");function u(){var e,t=[],n=[],s=[];function c(){var e=0,a=Math.max(1,n.length);for(s=new Array(a-1);++e<a;)s[e-1]=r.quantileSorted(t,e/a);return l}function l(t){return null==t||isNaN(t=+t)?e:n[a.default(s,t)]}return l.invertExtent=function(e){var r=n.indexOf(e);return r<0?[NaN,NaN]:[r>0?s[r-1]:t[0],r<s.length?s[r]:t[t.length-1]]},l.domain=function(e){if(!arguments.length)return t.slice();t=[];var n=!0,r=!1,a=void 0;try{for(var o,u=e[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;null==s||isNaN(s=+s)||t.push(s)}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}return t.sort(i.default),c()},l.range=function(e){return arguments.length?(n=Array.from(e),c()):n.slice()},l.unknown=function(t){return arguments.length?(e=t,l):e},l.quantiles=function(){return s.slice()},l.copy=function(){return u().domain(t).range(n).unknown(e)},o.initRange.apply(l,arguments)}})),s.register("eHKzB",(function(e,t){n(e.exports,"default",(function(){return u})),s("1i51P");var r=s("6vecG"),a=s("4YaFt"),i=s("iQDLo"),o=s("hRqMy");function u(){var e,t=0,n=1,s=1,c=[.5],l=[0,1];function f(t){return null!=t&&t<=t?l[a.default(c,t,0,s)]:e}function d(){var e=-1;for(c=new Array(s);++e<s;)c[e]=((e+1)*n-(e-s)*t)/(s+1);return f}return f.domain=function(e){var a;return arguments.length?(a=r.default(e,2),t=a[0],n=a[1],t=+t,n=+n,d()):[t,n]},f.range=function(e){return arguments.length?(s=(l=Array.from(e)).length-1,d()):l.slice()},f.invertExtent=function(e){var r=l.indexOf(e);return r<0?[NaN,NaN]:r<1?[t,c[0]]:r>=s?[c[s-1],n]:[c[r-1],c[r]]},f.unknown=function(t){return arguments.length?(e=t,f):f},f.thresholds=function(){return c.slice()},f.copy=function(){return u().domain([t,n]).range(l).unknown(e)},o.initRange.apply(i.linearish(f),arguments)}})),s.register("7kfTt",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("4YaFt"),a=s("hRqMy");function i(){var e,t=[.5],n=[0,1],o=1;function u(a){return null!=a&&a<=a?n[r.default(t,a,0,o)]:e}return u.domain=function(e){return arguments.length?(t=Array.from(e),o=Math.min(t.length,n.length-1),u):t.slice()},u.range=function(e){return arguments.length?(n=Array.from(e),o=Math.min(t.length,n.length-1),u):n.slice()},u.invertExtent=function(e){var r=n.indexOf(e);return[t[r-1],t[r]]},u.unknown=function(t){return arguments.length?(e=t,u):e},u.copy=function(){return i().domain(t).range(n).unknown(e)},a.initRange.apply(u,arguments)}})),s.register("iBzRu",(function(e,t){n(e.exports,"calendar",(function(){return y})),n(e.exports,"default",(function(){return x}));var r=s("3dgBB"),a=s("imkHR"),i=s("81VW3"),o=s("7yUGY"),u=s("ddiTx"),c=s("cT5Vi"),l=s("1Ddjq"),f=s("eBY9l"),d=s("3iupp"),p=s("aDMvI"),h=s("hRqMy"),v=s("i8HMO");function g(e){return new Date(e)}function m(e){return e instanceof Date?+e:+new Date(+e)}function y(e,t,n,r,a,i,o,u,s,c){var l=p.default(),f=l.invert,d=l.domain,h=c(".%L"),x=c(":%S"),b=c("%I:%M"),k=c("%I %p"),w=c("%a %d"),A=c("%b %d"),E=c("%B"),C=c("%Y");function S(e){return(s(e)<e?h:u(e)<e?x:o(e)<e?b:i(e)<e?k:r(e)<e?a(e)<e?w:A:n(e)<e?E:C)(e)}return l.invert=function(e){return new Date(f(e))},l.domain=function(e){return arguments.length?d(Array.from(e,m)):d().map(g)},l.ticks=function(t){var n=d();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?S:c(t)},l.nice=function(e){var n=d();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?d(v.default(n,e)):l},l.copy=function(){return p.copy(l,y(e,t,n,r,a,i,o,u,s,c))},l}function x(){return h.initRange.apply(y(r.timeTicks,r.timeTickInterval,a.default,i.default,o.sunday,u.default,c.default,l.default,f.default,d.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}})),s.register("9OpB9",(function(e,t){n(e.exports,"default",(function(){return v}));var r=s("3dgBB"),a=s("730hp"),i=s("cB2pD"),o=s("euQv8"),u=s("9t3Va"),c=s("7tkqA"),l=s("9ig5K"),f=s("eBY9l"),d=s("3iupp"),p=s("iBzRu"),h=s("hRqMy");function v(){return h.initRange.apply(p.calendar(r.utcTicks,r.utcTickInterval,a.default,i.default,o.utcSunday,u.default,c.default,l.default,f.default,d.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}})),s.register("ensPk",(function(e,t){n(e.exports,"copy",(function(){return h})),n(e.exports,"default",(function(){return v})),n(e.exports,"sequentialLog",(function(){return g})),n(e.exports,"sequentialSymlog",(function(){return m})),n(e.exports,"sequentialPow",(function(){return y})),n(e.exports,"sequentialSqrt",(function(){return x})),s("1i51P");var r=s("6vecG");s("4CugC");var a=s("7viow"),i=s("dvaXC"),o=s("aDMvI"),u=s("hRqMy"),c=s("iQDLo"),l=s("cr58D"),f=s("1OZ4S"),d=s("iWpor");function p(){var e,t,n,u,s,c=0,l=1,f=o.identity,d=!1;function p(t){return null==t||isNaN(t=+t)?s:f(0===n?.5:(t=(u(t)-e)*n,d?Math.max(0,Math.min(1,t)):t))}function h(e){return function(t){var n,a,i;return arguments.length?(n=(i=r.default(t,2))[0],a=i[1],f=e(n,a),p):[f(0),f(1)]}}return p.domain=function(a){var i;return arguments.length?(i=r.default(a,2),c=i[0],l=i[1],e=u(c=+c),t=u(l=+l),n=e===t?0:1/(t-e),p):[c,l]},p.clamp=function(e){return arguments.length?(d=!!e,p):d},p.interpolator=function(e){return arguments.length?(f=e,p):f},p.range=h(a.default),p.rangeRound=h(i.default),p.unknown=function(e){return arguments.length?(s=e,p):s},function(r){return u=r,e=r(c),t=r(l),n=e===t?0:1/(t-e),p}}function h(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function v(){var e=c.linearish(p()(o.identity));return e.copy=function(){return h(e,v())},u.initInterpolator.apply(e,arguments)}function g(){var e=l.loggish(p()).domain([1,10]);return e.copy=function(){return h(e,g()).base(e.base())},u.initInterpolator.apply(e,arguments)}function m(){var e=f.symlogish(p());return e.copy=function(){return h(e,m()).constant(e.constant())},u.initInterpolator.apply(e,arguments)}function y(){var e=d.powish(p());return e.copy=function(){return h(e,y()).exponent(e.exponent())},u.initInterpolator.apply(e,arguments)}function x(){return y.apply(null,arguments).exponent(.5)}})),s.register("4ujx4",(function(e,t){n(e.exports,"default",(function(){return g})),n(e.exports,"divergingLog",(function(){return m})),n(e.exports,"divergingSymlog",(function(){return y})),n(e.exports,"divergingPow",(function(){return x})),n(e.exports,"divergingSqrt",(function(){return b})),s("1i51P");var r=s("6vecG");s("4CugC");var a=s("4QoRL"),i=s("7viow"),o=s("dvaXC"),u=s("aDMvI"),c=s("hRqMy"),l=s("iQDLo"),f=s("cr58D"),d=s("ensPk"),p=s("1OZ4S"),h=s("iWpor");function v(){var e,t,n,s,c,l,f,d=0,p=.5,h=1,v=1,g=u.identity,m=!1;function y(e){return isNaN(e=+e)?f:(e=.5+((e=+l(e))-t)*(v*e<v*t?s:c),g(m?Math.max(0,Math.min(1,e)):e))}function x(e){return function(t){var n,i,o,u;return arguments.length?(n=(u=r.default(t,3))[0],i=u[1],o=u[2],g=a.default(e,[n,i,o]),y):[g(0),g(.5),g(1)]}}return y.domain=function(a){var i;return arguments.length?(i=r.default(a,3),d=i[0],p=i[1],h=i[2],e=l(d=+d),t=l(p=+p),n=l(h=+h),s=e===t?0:.5/(t-e),c=t===n?0:.5/(n-t),v=t<e?-1:1,y):[d,p,h]},y.clamp=function(e){return arguments.length?(m=!!e,y):m},y.interpolator=function(e){return arguments.length?(g=e,y):g},y.range=x(i.default),y.rangeRound=x(o.default),y.unknown=function(e){return arguments.length?(f=e,y):f},function(r){return l=r,e=r(d),t=r(p),n=r(h),s=e===t?0:.5/(t-e),c=t===n?0:.5/(n-t),v=t<e?-1:1,y}}function g(){var e=l.linearish(v()(u.identity));return e.copy=function(){return d.copy(e,g())},c.initInterpolator.apply(e,arguments)}function m(){var e=f.loggish(v()).domain([.1,1,10]);return e.copy=function(){return d.copy(e,m()).base(e.base())},c.initInterpolator.apply(e,arguments)}function y(){var e=p.symlogish(v());return e.copy=function(){return d.copy(e,y()).constant(e.constant())},c.initInterpolator.apply(e,arguments)}function x(){var e=h.powish(v());return e.copy=function(){return d.copy(e,x()).exponent(e.exponent())},c.initInterpolator.apply(e,arguments)}function b(){return x.apply(null,arguments).exponent(.5)}})),s.register("31JGW",(function(e,t){n(e.exports,"axisticks",(function(){return d})),n(e.exports,"datajoin",(function(){return p})),n(e.exports,"encode",(function(){return v})),n(e.exports,"legendentries",(function(){return g})),n(e.exports,"linkpath",(function(){return k})),n(e.exports,"pie",(function(){return S})),n(e.exports,"scale",(function(){return D})),n(e.exports,"sortitems",(function(){return I})),n(e.exports,"stack",(function(){return L}));var r=s("euljU"),a=s("ilkKT"),i=s("ka173"),o=s("caNzv"),u=s("5OZVX"),c=s("jTUhZ");s("4CugC");var l=s("dvaXC"),f=s("7viow");function d(e){r.Transform.call(this,null,e)}function p(e){r.Transform.call(this,null,e)}function h(){return r.ingest({})}function v(e){r.Transform.call(this,null,e)}function g(e){r.Transform.call(this,[],e)}o.inherits(d,r.Transform,{transform:function(e,t){if(this.value&&!e.modified())return t.StopPropagation;var n=t.dataflow.locale(),i=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=this.value,u=e.scale,s=null==e.count?e.values?e.values.length:10:e.count,c=a.tickCount(u,s,e.minstep),l=e.format||a.tickFormat(n,u,c,e.formatSpecifier,e.formatType,!!e.values),f=e.values?a.validTicks(u,e.values,c):a.tickValues(u,c);return o&&(i.rem=o),o=f.map((function(e,t){return r.ingest({index:t/(f.length-1||1),value:e,label:l(e)})})),e.extra&&o.length&&o.push(r.ingest({index:-1,extra:{value:o[0].value},label:""})),i.source=o,i.add=o,this.value=o,i}}),o.inherits(p,r.Transform,{transform:function(e,t){var n=t.dataflow,a=t.fork(t.NO_SOURCE|t.NO_FIELDS),i=e.item||h,u=e.key||r.tupleid,s=this.value;return o.isArray(a.encode)&&(a.encode=null),s&&(e.modified("key")||t.modified(u))&&o.error("DataJoin does not support modified key function or fields."),s||(t=t.addAll(),this.value=s=function(e){var t=o.fastmap().test((function(e){return e.exit}));return t.lookup=function(n){return t.get(e(n))},t}(u)),t.visit(t.ADD,(function(e){var t=u(e),n=s.get(t);n?n.exit?(s.empty--,a.add.push(n)):a.mod.push(n):(n=i(e),s.set(t,n),a.add.push(n)),n.datum=e,n.exit=!1})),t.visit(t.MOD,(function(e){var t=u(e),n=s.get(t);n&&(n.datum=e,a.mod.push(n))})),t.visit(t.REM,(function(e){var t=u(e),n=s.get(t);e!==n.datum||n.exit||(a.rem.push(n),n.exit=!0,++s.empty)})),t.changed(t.ADD_MOD)&&a.modifies("datum"),(t.clean()||e.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),a}}),o.inherits(v,r.Transform,{transform:function(e,t){var n=t.fork(t.ADD_REM),r=e.mod||!1,a=e.encoders,i=t.encode;if(o.isArray(i)){if(!n.changed()&&!i.every((function(e){return a[e]})))return t.StopPropagation;i=i[0],n.encode=null}var u="enter"===i,s=a.update||o.falsy,c=a.enter||o.falsy,l=a.exit||o.falsy,f=(i&&!u?a[i]:s)||o.falsy;if(t.changed(t.ADD)&&(t.visit(t.ADD,(function(t){c(t,e),s(t,e)})),n.modifies(c.output),n.modifies(s.output),f!==o.falsy&&f!==s&&(t.visit(t.ADD,(function(t){f(t,e)})),n.modifies(f.output))),t.changed(t.REM)&&l!==o.falsy&&(t.visit(t.REM,(function(t){l(t,e)})),n.modifies(l.output)),u||f!==o.falsy){var d=t.MOD|(e.modified()?t.REFLOW:0);u?(t.visit(d,(function(t){var a=c(t,e)||r;(f(t,e)||a)&&n.mod.push(t)})),n.mod.length&&n.modifies(c.output)):t.visit(d,(function(t){(f(t,e)||r)&&n.mod.push(t)})),n.mod.length&&n.modifies(f.output)}return n.changed()?n:t.StopPropagation}}),o.inherits(g,r.Transform,{transform:function(e,t){if(null!=this.value&&!e.modified())return t.StopPropagation;var n,i,u,s,c,l=t.dataflow.locale(),f=t.fork(t.NO_SOURCE|t.NO_FIELDS),d=this.value,p=e.type||a.SymbolLegend,h=e.scale,v=+e.limit,g=a.tickCount(h,null==e.count?5:e.count,e.minstep),m=!!e.values||p===a.SymbolLegend,y=e.format||a.labelFormat(l,h,g,p,e.formatSpecifier,e.formatType,m),x=e.values||a.labelValues(h,g);return d&&(f.rem=d),p===a.SymbolLegend?(v&&x.length>v?(t.dataflow.warn("Symbol legend count exceeds limit, filtering items."),d=x.slice(0,v-1),c=!0):d=x,o.isFunction(u=e.size)?(e.values||0!==h(d[0])||(d=d.slice(1)),s=d.reduce((function(t,n){return Math.max(t,u(n,e))}),0)):u=o.constant(s=u||8),d=d.map((function(t,n){return r.ingest({index:n,label:y(t,n,d),value:t,offset:s,size:u(t,e)})})),c&&(c=x[d.length],d.push(r.ingest({index:d.length,label:"".concat(x.length-d.length," entries"),value:c,offset:s,size:u(c,e)})))):p===a.GradientLegend?(n=h.domain(),i=a.scaleFraction(h,n[0],o.peek(n)),x.length<3&&!e.values&&n[0]!==o.peek(n)&&(x=[n[0],o.peek(n)]),d=x.map((function(e,t){return r.ingest({index:t,label:y(e,t,x),value:e,perc:i(e)})}))):(u=x.length-1,i=a.labelFraction(h),d=x.map((function(e,t){return r.ingest({index:t,label:y(e,t,x),value:e,perc:t?i(e):0,perc2:t===u?1:i(x[t+1])})}))),f.source=d,f.add=d,this.value=d,f}});var m=function(e){return e.source.x},y=function(e){return e.source.y},x=function(e){return e.target.x},b=function(e){return e.target.y};function k(e){r.Transform.call(this,{},e)}k.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},o.inherits(k,r.Transform,{transform:function(e,t){var n=e.sourceX||m,r=e.sourceY||y,a=e.targetX||x,i=e.targetY||b,u=e.as||"path",s=e.orient||"vertical",c=e.shape||"line",l=C.get(c+"-"+s)||C.get(c);return l||o.error("LinkPath unsupported type: "+e.shape+(e.orient?"-"+e.orient:"")),t.visit(t.SOURCE,(function(e){e[u]=l(n(e),r(e),a(e),i(e))})),t.reflow(e.modified()).modifies(u)}});var w=function(e,t,n,r){return"M"+e+","+t+"L"+n+","+r},A=function(e,t,n,r){var a=n-e,i=r-t,o=Math.sqrt(a*a+i*i)/2;return"M"+e+","+t+"A"+o+","+o+" "+180*Math.atan2(i,a)/Math.PI+" 0 1 "+n+","+r},E=function(e,t,n,r){var a=n-e,i=r-t,o=.2*(a+i),u=.2*(i-a);return"M"+e+","+t+"C"+(e+o)+","+(t+u)+" "+(n+u)+","+(r-o)+" "+n+","+r},C=o.fastmap({line:w,"line-radial":function(e,t,n,r){return w(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},arc:A,"arc-radial":function(e,t,n,r){return A(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},curve:E,"curve-radial":function(e,t,n,r){return E(t*Math.cos(e),t*Math.sin(e),r*Math.cos(n),r*Math.sin(n))},"orthogonal-horizontal":function(e,t,n,r){return"M"+e+","+t+"V"+r+"H"+n},"orthogonal-vertical":function(e,t,n,r){return"M"+e+","+t+"H"+n+"V"+r},"orthogonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n);return"M"+t*a+","+t*i+"A"+t+","+t+" 0 0,"+((Math.abs(n-e)>Math.PI?n<=e:n>e)?1:0)+" "+t*o+","+t*u+"L"+r*o+","+r*u},"diagonal-horizontal":function(e,t,n,r){var a=(e+n)/2;return"M"+e+","+t+"C"+a+","+t+" "+a+","+r+" "+n+","+r},"diagonal-vertical":function(e,t,n,r){var a=(t+r)/2;return"M"+e+","+t+"C"+e+","+a+" "+n+","+a+" "+n+","+r},"diagonal-radial":function(e,t,n,r){var a=Math.cos(e),i=Math.sin(e),o=Math.cos(n),u=Math.sin(n),s=(t+r)/2;return"M"+t*a+","+t*i+"C"+s*a+","+s*i+" "+s*o+","+s*u+" "+r*o+","+r*u}});function S(e){r.Transform.call(this,null,e)}S.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},o.inherits(S,r.Transform,{transform:function(e,t){var n,r,a,i=e.as||["startAngle","endAngle"],s=i[0],l=i[1],f=e.field||o.one,d=e.startAngle||0,p=null!=e.endAngle?e.endAngle:2*Math.PI,h=t.source,v=h.map(f),g=v.length,m=d,y=(p-d)/u.default(v),x=c.default(g);for(e.sort&&x.sort((function(e,t){return v[e]-v[t]})),n=0;n<g;++n)a=v[x[n]],(r=h[x[n]])[s]=m,r[l]=m+=a*y;return this.value=v,t.reflow(e.modified()).modifies(i)}});function N(e){return a.isContinuous(e)&&e!==a.Sequential}var T=o.toSet(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function D(e){r.Transform.call(this,null,e),this.modified(!0)}function F(e,t,n){a.isLogarithmic(e)&&(Math.abs(t.reduce((function(e,t){return e+(t<0?-1:t>0?1:0)}),0))!==t.length&&n.warn("Log scale domain includes zero: "+o.stringValue(t)));return t}function O(e,t,n){return o.isFunction(e)&&(t||n)?a.interpolateRange(e,_(t||[0,1],n)):e}function _(e,t){return t?e.slice().reverse():e}function I(e){r.Transform.call(this,null,e)}o.inherits(D,r.Transform,{transform:function(e,t){var n=t.dataflow,r=this.value,u=function(e){var t,n=e.type,r="";if(n===a.Sequential)return a.Sequential+"-"+a.Linear;(function(e){var t=e.type;return a.isContinuous(t)&&t!==a.Time&&t!==a.UTC&&(e.scheme||e.range&&e.range.length&&e.range.every(o.isString))})(e)&&(r=2===(t=e.rawDomain?e.rawDomain.length:e.domain?e.domain.length+ +(null!=e.domainMid):0)?a.Sequential+"-":3===t?a.Diverging+"-":"");return(r+n||a.Linear).toLowerCase()}(e);for(u in r&&u===r.type||(this.value=r=a.scale(u)()),e)if(!T[u]){if("padding"===u&&N(r.type))continue;o.isFunction(r[u])?r[u](e[u]):n.warn("Unsupported scale property: "+u)}return function(e,t,n){var r=e.type,i=t.round||!1,u=t.range;if(null!=t.rangeStep)u=function(e,t,n){e!==a.Band&&e!==a.Point&&o.error("Only band and point scales support rangeStep.");var r=(null!=t.paddingOuter?t.paddingOuter:t.padding)||0,i=e===a.Point?1:(null!=t.paddingInner?t.paddingInner:t.padding)||0;return[0,t.rangeStep*a.bandSpace(n,i,r)]}(r,t,n);else if(t.scheme&&(u=function(e,t,n){var r,i,u=t.schemeExtent;o.isArray(t.scheme)?i=a.interpolateColors(t.scheme,t.interpolate,t.interpolateGamma):(r=t.scheme.toLowerCase(),(i=a.scheme(r))||o.error("Unrecognized scheme name: ".concat(t.scheme)));return n=e===a.Threshold?n+1:e===a.BinOrdinal?n-1:e===a.Quantile||e===a.Quantize?+t.schemeCount||5:n,a.isInterpolating(e)?O(i,u,t.reverse):o.isFunction(i)?a.quantizeInterpolator(O(i,u),n):e===a.Ordinal?i:i.slice(0,n)}(r,t,n),o.isFunction(u))){if(e.interpolator)return e.interpolator(u);o.error("Scale type ".concat(r," does not support interpolating color schemes."))}if(u&&a.isInterpolating(r))return e.interpolator(a.interpolateColors(_(u,t.reverse),t.interpolate,t.interpolateGamma));u&&t.interpolate&&e.interpolate?e.interpolate(a.interpolate(t.interpolate,t.interpolateGamma)):o.isFunction(e.round)?e.round(i):o.isFunction(e.rangeRound)&&e.interpolate(i?l.default:f.default);u&&e.range(_(u,t.reverse))}(r,e,function(e,t,n){var r=t.bins;if(r&&!o.isArray(r)){var i=e.domain(),u=i[0],s=o.peek(i),l=r.step,f=null==r.start?u:r.start,d=null==r.stop?s:r.stop;l||o.error("Scale bins parameter missing step property."),f<u&&(f=l*Math.ceil(u/l)),d>s&&(d=l*Math.floor(s/l)),r=c.default(f,d+l/2,l)}r?e.bins=r:e.bins&&delete e.bins;e.type===a.BinOrdinal&&(r?t.domain||t.domainRaw||(e.domain(r),n=r.length):e.bins=e.domain());return n}(r,e,function(e,t,n){var r=function(e,t,n){return t?(e.domain(F(e.type,t,n)),t.length):-1}(e,t.domainRaw,n);if(r>-1)return r;var u,s,c=t.domain,l=e.type,f=t.zero||void 0===t.zero&&function(e){var t=e.type;return!e.bins&&(t===a.Linear||t===a.Pow||t===a.Sqrt)}(e);if(!c)return 0;N(l)&&t.padding&&c[0]!==o.peek(c)&&(c=function(e,t,n,r,i,u){var s=Math.abs(o.peek(n)-n[0]),c=s/(s-2*r),l=e===a.Log?o.zoomLog(t,null,c):e===a.Sqrt?o.zoomPow(t,null,c,.5):e===a.Pow?o.zoomPow(t,null,c,i||1):e===a.Symlog?o.zoomSymlog(t,null,c,u||1):o.zoomLinear(t,null,c);return(t=t.slice())[0]=l[0],t[t.length-1]=l[1],t}(l,c,t.range,t.padding,t.exponent,t.constant));if((f||null!=t.domainMin||null!=t.domainMax||null!=t.domainMid)&&(u=(c=c.slice()).length-1||1,f&&(c[0]>0&&(c[0]=0),c[u]<0&&(c[u]=0)),null!=t.domainMin&&(c[0]=t.domainMin),null!=t.domainMax&&(c[u]=t.domainMax),null!=t.domainMid)){var d=(s=t.domainMid)>c[u]?u+1:s<c[0]?0:u;d!==u&&n.warn("Scale domainMid exceeds domain min or max.",s),c.splice(d,0,s)}e.domain(F(l,c,n)),l===a.Ordinal&&e.unknown(t.domainImplicit?i.implicit:void 0);t.nice&&e.nice&&e.nice(!0!==t.nice&&a.tickCount(e,t.nice)||null);return c.length}(r,e,n))),t.fork(t.NO_SOURCE|t.NO_FIELDS)}}),o.inherits(I,r.Transform,{transform:function(e,t){var n=e.modified("sort")||t.changed(t.ADD)||t.modified(e.sort.fields)||t.modified("datum");return n&&t.source.sort(r.stableCompare(e.sort)),this.modified(n),t}});var R="zero",M="center",B="normalize",P=["y0","y1"];function L(e){r.Transform.call(this,null,e)}function j(e,t,n,r,a){for(var i,o=(t-e.sum)/2,u=e.length,s=0;s<u;++s)(i=e[s])[r]=o,i[a]=o+=Math.abs(n(i))}function z(e,t,n,r,a){for(var i,o=1/e.sum,u=0,s=e.length,c=0,l=0;c<s;++c)(i=e[c])[r]=u,i[a]=u=o*(l+=Math.abs(n(i)))}function U(e,t,n,r,a){for(var i,o,u=0,s=0,c=e.length,l=0;l<c;++l)(i=+n(o=e[l]))<0?(o[r]=s,o[a]=s+=i):(o[r]=u,o[a]=u+=i)}L.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:R,values:[R,M,B]},{name:"as",type:"string",array:!0,length:2,default:P}]},o.inherits(L,r.Transform,{transform:function(e,t){var n,a,i,u,s=e.as||P,c=s[0],l=s[1],f=r.stableCompare(e.sort),d=e.field||o.one,p=e.offset===M?j:e.offset===B?z:U;for(n=function(e,t,n,r){var a,i,o,u,s,c,l,f,d,p=[],h=function(e){return e(s)};if(null==t)p.push(e.slice());else for(a={},i=0,o=e.length;i<o;++i)s=e[i],(l=a[c=t.map(h)])||(a[c]=l=[],p.push(l)),l.push(s);for(c=0,d=0,u=p.length;c<u;++c){for(i=0,f=0,o=(l=p[c]).length;i<o;++i)f+=Math.abs(r(l[i]));l.sum=f,f>d&&(d=f),n&&l.sort(n)}return p.max=d,p}(t.source,e.groupby,f,d),a=0,i=n.length,u=n.max;a<i;++a)p(n[a],u,d,c,l);return t.reflow(e.modified()).modifies(s)}})})),s.register("iBn57",(function(e,t){n(e.exports,"isocontour",(function(){return A})),n(e.exports,"kde2d",(function(){return F})),n(e.exports,"contour",(function(){return I})),n(e.exports,"geojson",(function(){return B})),n(e.exports,"geopath",(function(){return P})),n(e.exports,"geopoint",(function(){return L})),n(e.exports,"geoshape",(function(){return j})),n(e.exports,"graticule",(function(){return z})),n(e.exports,"heatmap",(function(){return U})),n(e.exports,"projection",(function(){return W})),s("1i51P");var r=s("4Ui3v"),a=s("euljU"),i=s("caNzv"),o=s("hdht0"),u=s("jTUhZ"),c=s("5wp2C"),l=s("5OZVX"),f=s("3okBY"),d=s("d0DSv"),p=s("inMQ4"),h=s("eRnrt");s("juhb3");var v=s("a3wIG");function g(){}var m=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function y(){var e=1,t=1,n=u;function r(e,t){return t.map((function(t){return a(e,t)}))}function a(r,a){var i=[],u=[];return function(n,r,a){var i,u,s,c,l,f,d=new Array,p=new Array;i=u=-1,c=n[0]>=r,m[c<<1].forEach(h);for(;++i<e-1;)s=c,c=n[i+1]>=r,m[s|c<<1].forEach(h);m[c<<0].forEach(h);for(;++u<t-1;){for(i=-1,c=n[u*e+e]>=r,l=n[u*e]>=r,m[c<<1|l<<2].forEach(h);++i<e-1;)s=c,c=n[u*e+e+i+1]>=r,f=l,l=n[u*e+i+1]>=r,m[s|c<<1|l<<2|f<<3].forEach(h);m[c|l<<3].forEach(h)}i=-1,l=n[u*e]>=r,m[l<<2].forEach(h);for(;++i<e-1;)f=l,l=n[u*e+i+1]>=r,m[l<<2|f<<3].forEach(h);function h(e){var t,n,r=[e[0][0]+i,e[0][1]+u],s=[e[1][0]+i,e[1][1]+u],c=o(r),l=o(s);(t=p[c])?(n=d[l])?(delete p[t.end],delete d[n.start],t===n?(t.ring.push(s),a(t.ring)):d[t.start]=p[n.end]={start:t.start,end:n.end,ring:t.ring.concat(n.ring)}):(delete p[t.end],t.ring.push(s),p[t.end=l]=t):(t=d[l])?(n=p[c])?(delete d[t.start],delete p[n.end],t===n?(t.ring.push(s),a(t.ring)):d[n.start]=p[t.end]={start:n.start,end:t.end,ring:n.ring.concat(t.ring)}):(delete d[t.start],t.ring.unshift(r),d[t.start=c]=t):d[c]=p[l]={start:c,end:l,ring:[r,s]}}m[l<<3].forEach(h)}(r,a,(function(e){n(e,r,a),function(e){var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];for(;++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}(e)>0?i.push([e]):u.push(e)})),u.forEach((function(e){for(var t,n=0,r=i.length;n<r;++n)if(-1!==x((t=i[n])[0],e))return void t.push(e)})),{type:"MultiPolygon",value:a,coordinates:i}}function o(t){return 2*t[0]+t[1]*(e+1)*4}function u(n,r,a){n.forEach((function(n){var i,o=n[0],u=n[1],s=0|o,c=0|u,l=r[c*e+s];o>0&&o<e&&s===o&&(i=r[c*e+s-1],n[0]=o+(a-i)/(l-i)-.5),u>0&&u<t&&c===u&&(i=r[(c-1)*e+s],n[1]=u+(a-i)/(l-i)-.5)}))}return r.contour=a,r.size=function(n){if(!arguments.length)return[e,t];var a=Math.floor(n[0]),o=Math.floor(n[1]);return a>=0&&o>=0||i.error("invalid size"),e=a,t=o,r},r.smooth=function(e){return arguments.length?(n=e?u:g,r):n===u},r}function x(e,t){for(var n,r=-1,a=t.length;++r<a;)if(n=b(e,t[r]))return n;return 0}function b(e,t){for(var n=t[0],r=t[1],a=-1,i=0,o=e.length,u=o-1;i<o;u=i++){var s=e[i],c=s[0],l=s[1],f=e[u],d=f[0],p=f[1];if(k(s,f,t))return 0;l>r!=p>r&&n<(d-c)*(r-l)/(p-l)+c&&(a=-a)}return a}function k(e,t,n){var r,a,i,o;return function(e,t,n){return(t[0]-e[0])*(n[1]-e[1])==(n[0]-e[0])*(t[1]-e[1])}(e,t,n)&&(a=e[r=+(e[0]===t[0])],i=n[r],o=t[r],a<=i&&i<=o||o<=i&&i<=a)}function w(e,t,n){return function(r){var a=i.extent(r),s=n?Math.min(a[0],0):a[0],c=a[1],l=c-s,f=t?o.tickStep(s,c,e):l/(e+1);return u.default(s+f,c,f)}}function A(e){a.Transform.call(this,null,e)}function E(e,t,n,r,a){var i=e.x1||0,o=e.y1||0,u=t*n<0;function s(e){e.forEach(c)}function c(e){u&&e.reverse(),e.forEach(l)}function l(e){e[0]=(e[0]-i)*t+r,e[1]=(e[1]-o)*n+a}return function(e){return e.coordinates.forEach(s),e}}function C(e,t,n){var r=e>=0?e:f.bandwidthNRD(t,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function S(e){return i.isFunction(e)?e:i.constant(+e)}function N(){var e=function(e){return e[0]},t=function(e){return e[1]},n=i.one,r=[-1,-1],a=960,o=500,u=2;function s(i,s){var c=C(r[0],i,e)>>u,f=C(r[1],i,t)>>u,d=c?c+2:0,p=f?f+2:0,h=2*d+(a>>u),v=2*p+(o>>u),g=new Float32Array(h*v),m=new Float32Array(h*v),y=g;i.forEach((function(r){var a=d+(+e(r)>>u),i=p+(+t(r)>>u);a>=0&&a<h&&i>=0&&i<v&&(g[a+i*h]+=+n(r))})),c>0&&f>0?(T(h,v,g,m,c),D(h,v,m,g,f),T(h,v,g,m,c),D(h,v,m,g,f),T(h,v,g,m,c),D(h,v,m,g,f)):c>0?(T(h,v,g,m,c),T(h,v,m,g,c),T(h,v,g,m,c),y=m):f>0&&(D(h,v,g,m,f),D(h,v,m,g,f),D(h,v,g,m,f),y=m);for(var x=s?Math.pow(2,-2*u):1/l.default(y),b=0,k=h*v;b<k;++b)y[b]*=x;return{values:y,scale:1<<u,width:h,height:v,x1:d,y1:p,x2:d+(a>>u),y2:p+(o>>u)}}return s.x=function(t){return arguments.length?(e=S(t),s):e},s.y=function(e){return arguments.length?(t=S(e),s):t},s.weight=function(e){return arguments.length?(n=S(e),s):n},s.size=function(e){if(!arguments.length)return[a,o];var t=+e[0],n=+e[1];return t>=0&&n>=0||i.error("invalid size"),a=t,o=n,s},s.cellSize=function(e){return arguments.length?((e=+e)>=1||i.error("invalid cell size"),u=Math.floor(Math.log(e)/Math.LN2),s):1<<u},s.bandwidth=function(e){return arguments.length?(1===(e=i.array(e)).length&&(e=[+e[0],+e[0]]),2!==e.length&&i.error("invalid bandwidth"),r=e,s):r},s}function T(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<t;++o)for(var u=0,s=0;u<e+a;++u)u<e&&(s+=n[u+o*e]),u>=a&&(u>=i&&(s-=n[u-i+o*e]),r[u-a+o*e]=s/Math.min(u+1,e-1+i-u,i))}function D(e,t,n,r,a){for(var i=1+(a<<1),o=0;o<e;++o)for(var u=0,s=0;u<t+a;++u)u<t&&(s+=n[o+u*e]),u>=a&&(u>=i&&(s-=n[o+(u-i)*e]),r[o+(u-a)*e]=s/Math.min(u+1,t-1+i-u,i))}function F(e){a.Transform.call(this,null,e)}A.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},i.inherits(A,a.Transform,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n=t.fork(t.NO_SOURCE|t.NO_FIELDS),o=t.materialize(t.SOURCE).source,u=e.field||i.identity,s=y().smooth(!1!==e.smooth),l=e.thresholds||function(e,t,n){var r=w(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(e.map((function(e){return c.default(t(e).values)})))}(o,u,e),f=null===e.as?null:e.as||"contour",d=[];return o.forEach((function(t){var n=u(t),o=s.size([n.width,n.height])(n.values,i.isArray(l)?l:l(n.values));!function(e,t,n,r){var a=r.scale||t.scale,o=r.translate||t.translate;i.isFunction(a)&&(a=a(n,r));i.isFunction(o)&&(o=o(n,r));if((1===a||null==a)&&!o)return;var u=(i.isNumber(a)?a:a[0])||1,s=(i.isNumber(a)?a:a[1])||1,c=o&&o[0]||0,l=o&&o[1]||0;e.forEach(E(t,u,s,c,l))}(o,n,t,e),o.forEach((function(e){d.push(a.rederive(t,a.ingest(null!=f?r.default({},f,e):e)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=d,n}}),F.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};var O=["x","y","weight","size","cellSize","bandwidth"];function _(e,t){return O.forEach((function(n){return null!=t[n]?e[n](t[n]):0})),e}function I(e){a.Transform.call(this,null,e)}i.inherits(F,a.Transform,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,o=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=function(e,t){var n,r,a,i,o,u,s=[],c=function(e){return e(i)};if(null==t)s.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(c)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s}(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(i.accessorName),c=_(N(),e),l=e.as||"grid";return n=u.map((function(t){return a.ingest(function(e,t){for(var n=0;n<s.length;++n)e[s[n]]=t[n];return e}(r.default({},l,c(t,e.counts)),t.dims))})),this.value&&(o.rem=this.value),this.value=o.source=o.add=n,o}}),I.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},i.inherits(I,a.Transform,{transform:function(e,t){if(this.value&&!t.changed()&&!e.modified())return t.StopPropagation;var n,r,o=t.fork(t.NO_SOURCE|t.NO_FIELDS),u=y().smooth(!1!==e.smooth),s=e.values,c=e.thresholds||w(e.count||10,e.nice,!!s),l=e.size;return s||(s=t.materialize(t.SOURCE).source,r=E(n=_(N(),e)(s,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],s=n.values),c=i.isArray(c)?c:c(s),s=u.size(l)(s,c),r&&s.forEach(r),this.value&&(o.rem=this.value),this.value=o.source=o.add=(s||[]).map(a.ingest),o}});var R="Feature",M="FeatureCollection";function B(e){a.Transform.call(this,null,e)}function P(e){a.Transform.call(this,null,e)}function L(e){a.Transform.call(this,null,e)}function j(e){a.Transform.call(this,null,e)}function z(e){a.Transform.call(this,[],e),this.generator=p.default()}function U(e){a.Transform.call(this,null,e)}function V(e){if(!i.isFunction(e))return!1;var t=i.toSet(i.accessorFields(e));return t.$x||t.$y||t.$value||t.$max}function W(e){a.Transform.call(this,null,e),this.modified(!0)}function G(e,t,n){i.isFunction(e[t])&&e[t](n)}B.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},i.inherits(B,a.Transform,{transform:function(e,t){var n,r=this._features,a=this._points,o=e.fields,u=o&&o[0],s=o&&o[1],c=e.geojson||!o&&i.identity,l=t.ADD;n=e.modified()||t.changed(t.REM)||t.modified(i.accessorFields(c))||u&&t.modified(i.accessorFields(u))||s&&t.modified(i.accessorFields(s)),this.value&&!n||(l=t.SOURCE,this._features=r=[],this._points=a=[]),c&&t.visit(l,(function(e){return r.push(c(e))})),u&&s&&(t.visit(l,(function(e){var t=u(e),n=s(e);null!=t&&null!=n&&(t=+t)===t&&(n=+n)===n&&a.push([t,n])})),r=r.concat({type:R,geometry:{type:"MultiPoint",coordinates:a}})),this.value={type:M,features:r}}}),P.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},i.inherits(P,a.Transform,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.field||i.identity,o=e.as||"path",u=n.SOURCE;!r||e.modified()?(this.value=r=d.getProjectionPath(e.projection),n.materialize().reflow()):u=a===i.identity||t.modified(a.fields)?n.ADD_MOD:n.ADD;var s=function(e,t){var n=e.pointRadius();e.context(null),null!=t&&e.pointRadius(t);return n}(r,e.pointRadius);return n.visit(u,(function(e){return e[o]=r(a(e))})),r.pointRadius(s),n.modifies(o)}}),L.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},i.inherits(L,a.Transform,{transform:function(e,t){var n,r=e.projection,a=e.fields[0],i=e.fields[1],o=e.as||["x","y"],u=o[0],s=o[1];function c(e){var t=r([a(e),i(e)]);t?(e[u]=t[0],e[s]=t[1]):(e[u]=void 0,e[s]=void 0)}return e.modified()?t=t.materialize().reflow(!0).visit(t.SOURCE,c):(n=t.modified(a.fields)||t.modified(i.fields),t.visit(n?t.ADD_MOD:t.ADD,c)),t.modifies(o)}}),j.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},i.inherits(j,a.Transform,{transform:function(e,t){var n=t.fork(t.ALL),r=this.value,a=e.as||"shape",o=n.ADD;return r&&!e.modified()||(this.value=r=function(e,t,n){var r=null==n?function(n){return e(t(n))}:function(r){var a=e.pointRadius(),i=e.pointRadius(n)(t(r));return e.pointRadius(a),i};return r.context=function(t){return e.context(t),r},r}(d.getProjectionPath(e.projection),e.field||i.field("datum"),e.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(function(e){return e[a]=r})),n.modifies(a)}}),z.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},i.inherits(z,a.Transform,{transform:function(e,t){var n,r=this.value,o=this.generator;if(!r.length||e.modified())for(var u in e)i.isFunction(o[u])&&o[u](e[u]);return n=o(),r.length?t.mod.push(a.replace(r[0],n)):t.add.push(a.ingest(n)),r[0]=n,t}}),U.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},i.inherits(U,a.Transform,{transform:function(e,t){if(!t.changed()&&!e.modified())return t.StopPropagation;var n=t.materialize(t.SOURCE).source,r="shared"===e.resolve,a=e.field||i.identity,o=function(e,t){var n;i.isFunction(e)?(n=function(n){return e(n,t)},n.dep=V(e)):e?n=i.constant(e):(n=function(e){return e.$value/e.$max||0},n.dep=!0);return n}(e.opacity,e),u=function(e,t){var n;i.isFunction(e)?(n=function(n){return h.rgb(e(n,t))},n.dep=V(e)):n=i.constant(h.rgb(e||"#888"));return n}(e.color,e),s=e.as||"image",l={$x:0,$y:0,$value:0,$max:r?c.default(n.map((function(e){return c.default(a(e).values)}))):0};return n.forEach((function(e){var t=a(e),n=i.extend({},e,l);r||(n.$max=c.default(t.values||[])),e[s]=function(e,t,n,r){for(var a=e.width,o=e.height,u=e.x1||0,s=e.y1||0,c=e.x2||a,l=e.y2||o,f=e.values,d=f?function(e){return f[e]}:i.zero,p=v.domCanvas(c-u,l-s),h=p.getContext("2d"),g=h.getImageData(0,0,c-u,l-s),m=g.data,y=s,x=0;y<l;++y){t.$y=y-s;for(var b=u,k=y*a;b<c;++b,x+=4){t.$x=b-u,t.$value=d(b+k);var w=n(t);m[x+0]=w.r,m[x+1]=w.g,m[x+2]=w.b,m[x+3]=~~(255*r(t))}}return h.putImageData(g,0,0),p}(t,n,u.dep?u:i.constant(u(n)),o.dep?o:i.constant(o(n)))})),t.reflow(!0).modifies(s)}}),i.inherits(W,a.Transform,{transform:function(e,t){var n=this.value;return!n||e.modified("type")?(this.value=n=function(e){var t=d.projection((e||"mercator").toLowerCase());t||i.error("Unrecognized projection type: "+e);return t()}(e.type),d.projectionProperties.forEach((function(t){null!=e[t]&&G(n,t,e[t])}))):d.projectionProperties.forEach((function(t){e.modified(t)&&G(n,t,e[t])})),null!=e.pointRadius&&n.path.pointRadius(e.pointRadius),e.fit&&function(e,t){var n=function(e){return 1===(e=i.array(e)).length?e[0]:{type:M,features:e.reduce((function(e,t){return e.concat(function(e){return e.type===M?e.features:i.array(e).filter((function(e){return null!=e})).map((function(e){return e.type===R?e:{type:R,geometry:e}}))}(t))}),[])}}(t.fit);t.extent?e.fitExtent(t.extent,n):t.size&&e.fitSize(t.size,n)}(n,e),t.fork(t.NO_SOURCE|t.NO_FIELDS)}})})),s.register("d0DSv",(function(e,t){n(e.exports,"projectionProperties",(function(){return A})),n(e.exports,"projection",(function(){return C})),n(e.exports,"getProjectionPath",(function(){return S}));var r=s("idENL"),a=s("87CUp"),i=s("geBq9"),o=s("fLCuv"),u=s("gOqAq"),c=s("f6wqr"),l=s("jvnfM"),f=s("4MaDd"),d=s("er73T"),p=s("lroq6"),h=s("2wv80"),v=s("2fmpG"),g=s("faGV4"),m=s("heWTN"),y=s("aT9Fh"),x=s("fCGi5"),b=s("IdGG3"),k=s("cADqr"),w=r.default(),A=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function E(e,t){return function n(){var a=t();return a.type=e,a.path=r.default().projection(a),a.copy=a.copy||function(){var e=n();return A.forEach((function(t){a[t]&&e[t](a[t]())})),e.path.pointRadius(a.path.pointRadius()),e},a}}function C(e,t){if(!e||"string"!=typeof e)throw new Error("Projection type must be a name string.");return e=e.toLowerCase(),arguments.length>1?(N[e]=E(e,t),this):N[e]||null}function S(e){return e&&e.path||w}var N={albers:a.default,albersusa:i.default,azimuthalequalarea:o.default,azimuthalequidistant:u.default,conicconformal:c.default,conicequalarea:l.default,conicequidistant:f.default,equalEarth:d.default,equirectangular:p.default,gnomonic:h.default,identity:v.default,mercator:g.default,mollweide:k.default,naturalEarth1:m.default,orthographic:y.default,stereographic:x.default,transversemercator:b.default};for(var T in N)C(T,N[T])})),s.register("EMifa",(function(e,t){n(e.exports,"areaRingSum",(function(){return p})),n(e.exports,"areaStream",(function(){return v})),n(e.exports,"default",(function(){return b}));var r,a,i,o,u,c=s("cFqjn"),l=s("5ABrm"),f=s("c7WJq"),d=s("5uBsW"),p=new c.Adder,h=new c.Adder,v={point:f.default,lineStart:f.default,lineEnd:f.default,polygonStart:function(){p=new c.Adder,v.lineStart=g,v.lineEnd=m},polygonEnd:function(){var e=+p;h.add(e<0?l.tau+e:e),this.lineStart=this.lineEnd=this.point=f.default},sphere:function(){h.add(l.tau)}};function g(){v.point=y}function m(){x(r,a)}function y(e,t){v.point=x,r=e,a=t,e*=l.radians,t*=l.radians,i=e,o=l.cos(t=t/2+l.quarterPi),u=l.sin(t)}function x(e,t){e*=l.radians,t=(t*=l.radians)/2+l.quarterPi;var n=e-i,r=n>=0?1:-1,a=r*n,s=l.cos(t),c=l.sin(t),f=u*c,d=o*s+f*l.cos(a),h=f*r*l.sin(a);p.add(l.atan2(h,d)),i=e,o=s,u=c}function b(e){return h=new c.Adder,d.default(e,v),2*h}})),s.register("5ABrm",(function(e,t){n(e.exports,"epsilon",(function(){return r})),n(e.exports,"epsilon2",(function(){return a})),n(e.exports,"pi",(function(){return i})),n(e.exports,"halfPi",(function(){return o})),n(e.exports,"quarterPi",(function(){return u})),n(e.exports,"tau",(function(){return s})),n(e.exports,"degrees",(function(){return c})),n(e.exports,"radians",(function(){return l})),n(e.exports,"abs",(function(){return f})),n(e.exports,"atan",(function(){return d})),n(e.exports,"atan2",(function(){return p})),n(e.exports,"cos",(function(){return h})),n(e.exports,"ceil",(function(){return v})),n(e.exports,"exp",(function(){return g})),n(e.exports,"hypot",(function(){return m})),n(e.exports,"log",(function(){return y})),n(e.exports,"pow",(function(){return x})),n(e.exports,"sin",(function(){return b})),n(e.exports,"sign",(function(){return k})),n(e.exports,"sqrt",(function(){return w})),n(e.exports,"tan",(function(){return A})),n(e.exports,"acos",(function(){return E})),n(e.exports,"asin",(function(){return C}));var r=1e-6,a=1e-12,i=Math.PI,o=i/2,u=i/4,s=2*i,c=180/i,l=i/180,f=Math.abs,d=Math.atan,p=Math.atan2,h=Math.cos,v=Math.ceil,g=Math.exp,m=(Math.floor,Math.hypot),y=Math.log,x=Math.pow,b=Math.sin,k=Math.sign||function(e){return e>0?1:e<0?-1:0},w=Math.sqrt,A=Math.tan;function E(e){return e>1?0:e<-1?i:Math.acos(e)}function C(e){return e>1?o:e<-1?-o:Math.asin(e)}})),s.register("c7WJq",(function(e,t){function r(){}n(e.exports,"default",(function(){return r}))})),s.register("5uBsW",(function(e,t){function r(e,t){e&&i.hasOwnProperty(e.type)&&i[e.type](e,t)}n(e.exports,"default",(function(){return s}));var a={Feature:function(e,t){r(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,a=-1,i=n.length;++a<i;)r(n[a].geometry,t)}},i={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){o(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)o(n[r],t,0)},Polygon:function(e,t){u(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,a=n.length;++r<a;)u(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,a=-1,i=n.length;++a<i;)r(n[a],t)}};function o(e,t,n){var r,a=-1,i=e.length-n;for(t.lineStart();++a<i;)r=e[a],t.point(r[0],r[1],r[2]);t.lineEnd()}function u(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)o(e[n],t,1);t.polygonEnd()}function s(e,t){e&&a.hasOwnProperty(e.type)?a[e.type](e,t):r(e,t)}})),s.register("7EWyw",(function(e,t){n(e.exports,"default",(function(){return O}));var r,a,i,o,u,c,l,f,d,p,h,v=s("cFqjn"),g=s("EMifa"),m=s("1348I"),y=s("5ABrm"),x=s("5uBsW"),b={point:k,lineStart:A,lineEnd:E,polygonStart:function(){b.point=C,b.lineStart=S,b.lineEnd=N,d=new v.Adder,g.areaStream.polygonStart()},polygonEnd:function(){g.areaStream.polygonEnd(),b.point=k,b.lineStart=A,b.lineEnd=E,g.areaRingSum<0?(r=-(i=180),a=-(o=90)):d>y.epsilon?o=90:d<-y.epsilon&&(a=-90),h[0]=r,h[1]=i},sphere:function(){r=-(i=180),a=-(o=90)}};function k(e,t){p.push(h=[r=e,i=e]),t<a&&(a=t),t>o&&(o=t)}function w(e,t){var n=m.cartesian([e*y.radians,t*y.radians]);if(f){var s=m.cartesianCross(f,n),c=[s[1],-s[0],0],l=m.cartesianCross(c,s);m.cartesianNormalizeInPlace(l),l=m.spherical(l);var d,v=e-u,g=v>0?1:-1,x=l[0]*y.degrees*g,b=y.abs(v)>180;b^(g*u<x&&x<g*e)?(d=l[1]*y.degrees)>o&&(o=d):b^(g*u<(x=(x+360)%360-180)&&x<g*e)?(d=-l[1]*y.degrees)<a&&(a=d):(t<a&&(a=t),t>o&&(o=t)),b?e<u?T(r,e)>T(r,i)&&(i=e):T(e,i)>T(r,i)&&(r=e):i>=r?(e<r&&(r=e),e>i&&(i=e)):e>u?T(r,e)>T(r,i)&&(i=e):T(e,i)>T(r,i)&&(r=e)}else p.push(h=[r=e,i=e]);t<a&&(a=t),t>o&&(o=t),f=n,u=e}function A(){b.point=w}function E(){h[0]=r,h[1]=i,b.point=k,f=null}function C(e,t){if(f){var n=e-u;d.add(y.abs(n)>180?n+(n>0?360:-360):n)}else c=e,l=t;g.areaStream.point(e,t),w(e,t)}function S(){g.areaStream.lineStart()}function N(){C(c,l),g.areaStream.lineEnd(),y.abs(d)>y.epsilon&&(r=-(i=180)),h[0]=r,h[1]=i,f=null}function T(e,t){return(t-=e)<0?t+360:t}function D(e,t){return e[0]-t[0]}function F(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function O(e){var t,n,u,s,c,l,f;if(o=i=-(r=a=1/0),p=[],x.default(e,b),n=p.length){for(p.sort(D),t=1,c=[u=p[0]];t<n;++t)F(u,(s=p[t])[0])||F(u,s[1])?(T(u[0],s[1])>T(u[0],u[1])&&(u[1]=s[1]),T(s[0],u[1])>T(u[0],u[1])&&(u[0]=s[0])):c.push(u=s);for(l=-1/0,t=0,u=c[n=c.length-1];t<=n;u=s,++t)s=c[t],(f=T(u[1],s[0]))>l&&(l=f,r=s[0],i=u[1])}return p=h=null,r===1/0||a===1/0?[[NaN,NaN],[NaN,NaN]]:[[r,a],[i,o]]}})),s.register("1348I",(function(e,t){n(e.exports,"spherical",(function(){return a})),n(e.exports,"cartesian",(function(){return i})),n(e.exports,"cartesianDot",(function(){return o})),n(e.exports,"cartesianCross",(function(){return u})),n(e.exports,"cartesianAddInPlace",(function(){return c})),n(e.exports,"cartesianScale",(function(){return l})),n(e.exports,"cartesianNormalizeInPlace",(function(){return f}));var r=s("5ABrm");function a(e){return[r.atan2(e[1],e[0]),r.asin(e[2])]}function i(e){var t=e[0],n=e[1],a=r.cos(n);return[a*r.cos(t),a*r.sin(t),r.sin(n)]}function o(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function u(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function c(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function l(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function f(e){var t=r.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}})),s.register("2SNQA",(function(e,t){n(e.exports,"default",(function(){return M}));var r,a,i,o,u,c,l,f,d,p,h,v,g,m,y,x,b=s("cFqjn"),k=s("5ABrm"),w=s("c7WJq"),A=s("5uBsW"),E={sphere:w.default,point:C,lineStart:N,lineEnd:F,polygonStart:function(){E.lineStart=O,E.lineEnd=_},polygonEnd:function(){E.lineStart=N,E.lineEnd=F}};function C(e,t){e*=k.radians,t*=k.radians;var n=k.cos(t);S(n*k.cos(e),n*k.sin(e),k.sin(t))}function S(e,t,n){++r,i+=(e-i)/r,o+=(t-o)/r,u+=(n-u)/r}function N(){E.point=T}function T(e,t){e*=k.radians,t*=k.radians;var n=k.cos(t);m=n*k.cos(e),y=n*k.sin(e),x=k.sin(t),E.point=D,S(m,y,x)}function D(e,t){e*=k.radians,t*=k.radians;var n=k.cos(t),r=n*k.cos(e),i=n*k.sin(e),o=k.sin(t),u=k.atan2(k.sqrt((u=y*o-x*i)*u+(u=x*r-m*o)*u+(u=m*i-y*r)*u),m*r+y*i+x*o);a+=u,c+=u*(m+(m=r)),l+=u*(y+(y=i)),f+=u*(x+(x=o)),S(m,y,x)}function F(){E.point=C}function O(){E.point=I}function _(){R(v,g),E.point=C}function I(e,t){v=e,g=t,e*=k.radians,t*=k.radians,E.point=R;var n=k.cos(t);m=n*k.cos(e),y=n*k.sin(e),x=k.sin(t),S(m,y,x)}function R(e,t){e*=k.radians,t*=k.radians;var n=k.cos(t),r=n*k.cos(e),i=n*k.sin(e),o=k.sin(t),u=y*o-x*i,s=x*r-m*o,v=m*i-y*r,g=k.hypot(u,s,v),b=k.asin(g),w=g&&-b/g;d.add(w*u),p.add(w*s),h.add(w*v),a+=b,c+=b*(m+(m=r)),l+=b*(y+(y=i)),f+=b*(x+(x=o)),S(m,y,x)}function M(e){r=a=i=o=u=c=l=f=0,d=new b.Adder,p=new b.Adder,h=new b.Adder,A.default(e,E);var t=+d,n=+p,s=+h,v=k.hypot(t,n,s);return v<k.epsilon2&&(t=c,n=l,s=f,a<k.epsilon&&(t=i,n=o,s=u),(v=k.hypot(t,n,s))<k.epsilon2)?[NaN,NaN]:[k.atan2(n,t)*k.degrees,k.asin(s/v)*k.degrees]}})),s.register("inMQ4",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("jTUhZ"),a=s("5ABrm");function i(e,t,n){var i=r.default(e,t-a.epsilon,n).concat(t);return function(e){return i.map((function(t){return[e,t]}))}}function o(e,t,n){var i=r.default(e,t-a.epsilon,n).concat(t);return function(e){return i.map((function(t){return[t,e]}))}}function u(){var e,t,n,u,s,c,l,f,d,p,h,v,g=10,m=g,y=90,x=360,b=2.5;function k(){return{type:"MultiLineString",coordinates:w()}}function w(){return r.default(a.ceil(u/y)*y,n,y).map(h).concat(r.default(a.ceil(f/x)*x,l,x).map(v)).concat(r.default(a.ceil(t/g)*g,e,g).filter((function(e){return a.abs(e%y)>a.epsilon})).map(d)).concat(r.default(a.ceil(c/m)*m,s,m).filter((function(e){return a.abs(e%x)>a.epsilon})).map(p))}return k.lines=function(){return w().map((function(e){return{type:"LineString",coordinates:e}}))},k.outline=function(){return{type:"Polygon",coordinates:[h(u).concat(v(l).slice(1),h(n).reverse().slice(1),v(f).reverse().slice(1))]}},k.extent=function(e){return arguments.length?k.extentMajor(e).extentMinor(e):k.extentMinor()},k.extentMajor=function(e){return arguments.length?(u=+e[0][0],n=+e[1][0],f=+e[0][1],l=+e[1][1],u>n&&(e=u,u=n,n=e),f>l&&(e=f,f=l,l=e),k.precision(b)):[[u,f],[n,l]]},k.extentMinor=function(n){return arguments.length?(t=+n[0][0],e=+n[1][0],c=+n[0][1],s=+n[1][1],t>e&&(n=t,t=e,e=n),c>s&&(n=c,c=s,s=n),k.precision(b)):[[t,c],[e,s]]},k.step=function(e){return arguments.length?k.stepMajor(e).stepMinor(e):k.stepMinor()},k.stepMajor=function(e){return arguments.length?(y=+e[0],x=+e[1],k):[y,x]},k.stepMinor=function(e){return arguments.length?(g=+e[0],m=+e[1],k):[g,m]},k.precision=function(r){return arguments.length?(b=+r,d=i(c,s,90),p=o(t,e,b),h=i(f,l,90),v=o(u,n,b),k):b},k.extentMajor([[-180,-90+a.epsilon],[180,90-a.epsilon]]).extentMinor([[-180,-80-a.epsilon],[180,80+a.epsilon]])}})),s.register("idENL",(function(e,t){n(e.exports,"default",(function(){return d}));var r=s("6pWJw"),a=s("5uBsW"),i=s("kMaj2"),o=s("cqds6"),u=s("4pTKC"),c=s("bfjKT"),l=s("epKud"),f=s("8Oobd");function d(e,t){var n,s,d=4.5;function p(e){return e&&("function"==typeof d&&s.pointRadius(+d.apply(this,arguments)),a.default(e,n(s))),s.result()}return p.area=function(e){return a.default(e,n(i.default)),i.default.result()},p.measure=function(e){return a.default(e,n(l.default)),l.default.result()},p.bounds=function(e){return a.default(e,n(o.default)),o.default.result()},p.centroid=function(e){return a.default(e,n(u.default)),u.default.result()},p.projection=function(t){return arguments.length?(n=null==t?(e=null,r.default):(e=t).stream,p):e},p.context=function(e){return arguments.length?(s=null==e?(t=null,new f.default):new c.default(t=e),"function"!=typeof d&&s.pointRadius(d),p):t},p.pointRadius=function(e){return arguments.length?(d="function"==typeof e?e:(s.pointRadius(+e),+e),p):d},p.projection(e).context(t)}})),s.register("6pWJw",(function(e,t){n(e.exports,"default",(function(){return r}));var r=function(e){return e}})),s.register("kMaj2",(function(e,t){n(e.exports,"default",(function(){return y}));var r,a,i,o,u=s("cFqjn"),c=s("5ABrm"),l=s("c7WJq"),f=new u.Adder,d=new u.Adder,p={point:l.default,lineStart:l.default,lineEnd:l.default,polygonStart:function(){p.lineStart=h,p.lineEnd=m},polygonEnd:function(){p.lineStart=p.lineEnd=p.point=l.default,f.add(c.abs(d)),d=new u.Adder},result:function(){var e=f/2;return f=new u.Adder,e}};function h(){p.point=v}function v(e,t){p.point=g,r=i=e,a=o=t}function g(e,t){d.add(o*e-i*t),i=e,o=t}function m(){g(r,a)}var y=p})),s.register("cqds6",(function(e,t){n(e.exports,"default",(function(){return l}));var r=s("c7WJq"),a=1/0,i=a,o=-a,u=o,c={point:function(e,t){e<a&&(a=e);e>o&&(o=e);t<i&&(i=t);t>u&&(u=t)},lineStart:r.default,lineEnd:r.default,polygonStart:r.default,polygonEnd:r.default,result:function(){var e=[[a,i],[o,u]];return o=u=-(i=a=1/0),e}};var l=c})),s.register("4pTKC",(function(e,t){n(e.exports,"default",(function(){return T}));var r,a,i,o,u=s("5ABrm"),c=0,l=0,f=0,d=0,p=0,h=0,v=0,g=0,m=0,y={point:x,lineStart:b,lineEnd:A,polygonStart:function(){y.lineStart=E,y.lineEnd=C},polygonEnd:function(){y.point=x,y.lineStart=b,y.lineEnd=A},result:function(){var e=m?[v/m,g/m]:h?[d/h,p/h]:f?[c/f,l/f]:[NaN,NaN];return c=l=f=d=p=h=v=g=m=0,e}};function x(e,t){c+=e,l+=t,++f}function b(){y.point=k}function k(e,t){y.point=w,x(i=e,o=t)}function w(e,t){var n=e-i,r=t-o,a=u.sqrt(n*n+r*r);d+=a*(i+e)/2,p+=a*(o+t)/2,h+=a,x(i=e,o=t)}function A(){y.point=x}function E(){y.point=S}function C(){N(r,a)}function S(e,t){y.point=N,x(r=i=e,a=o=t)}function N(e,t){var n=e-i,r=t-o,a=u.sqrt(n*n+r*r);d+=a*(i+e)/2,p+=a*(o+t)/2,h+=a,v+=(a=o*e-i*t)*(i+e),g+=a*(o+t),m+=3*a,x(i=e,o=t)}var T=y})),s.register("bfjKT",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("5ABrm"),a=s("c7WJq");function i(e){this._context=e}i.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._context.moveTo(e,t),this._point=1;break;case 1:this._context.lineTo(e,t);break;default:this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,r.tau)}},result:a.default}})),s.register("epKud",(function(e,t){n(e.exports,"default",(function(){return g}));var r,a,i,o,u,c=s("cFqjn"),l=s("5ABrm"),f=s("c7WJq"),d=new c.Adder,p={point:f.default,lineStart:function(){p.point=h},lineEnd:function(){r&&v(a,i),p.point=f.default},polygonStart:function(){r=!0},polygonEnd:function(){r=null},result:function(){var e=+d;return d=new c.Adder,e}};function h(e,t){p.point=v,a=o=e,i=u=t}function v(e,t){o-=e,u-=t,d.add(l.sqrt(o*o+u*u)),o=e,u=t}var g=p})),s.register("8Oobd",(function(e,t){function r(){this._string=[]}function a(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}n(e.exports,"default",(function(){return r})),r.prototype={_radius:4.5,_circle:a(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:this._string.push("M",e,",",t),this._point=1;break;case 1:this._string.push("L",e,",",t);break;default:null==this._circle&&(this._circle=a(this._radius)),this._string.push("M",e,",",t,this._circle)}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}return null}}})),s.register("87CUp",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("jvnfM");function a(){return r.default().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}})),s.register("jvnfM",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("eZMul"),i=s("6HV1D");function o(e,t){var n=r.sin(e),a=(n+r.sin(t))/2;if(r.abs(a)<r.epsilon)return i.cylindricalEqualAreaRaw(e);var o=1+n*(2*a-n),u=r.sqrt(o)/a;function s(e,t){var n=r.sqrt(o-2*a*r.sin(t))/a;return[n*r.sin(e*=a),u-n*r.cos(e)]}return s.invert=function(e,t){var n=u-t,i=r.atan2(e,r.abs(n))*r.sign(n);return n*a<0&&(i-=r.pi*r.sign(e)*r.sign(n)),[i/a,r.asin((o-(e*e+n*n)*a*a)/(2*a))]},s}function u(){return a.conicProjection(o).scale(155.424).center([0,33.6442])}})),s.register("eZMul",(function(e,t){n(e.exports,"conicProjection",(function(){return i}));var r=s("5ABrm"),a=s("lAEFj");function i(e){var t=0,n=r.pi/3,i=a.projectionMutator(e),o=i(t,n);return o.parallels=function(e){return arguments.length?i(t=e[0]*r.radians,n=e[1]*r.radians):[t*r.degrees,n*r.degrees]},o}})),s.register("lAEFj",(function(e,t){n(e.exports,"default",(function(){return g})),n(e.exports,"projectionMutator",(function(){return m}));var r=s("3R4ku"),a=s("dk5Gm"),i=s("2j8hP"),o=s("eVkK2"),u=s("6pWJw"),c=s("5ABrm"),l=s("eS0qV"),f=s("3f9DY"),d=s("h817v"),p=s("aGVly"),h=f.transformer({point:function(e,t){this.stream.point(e*c.radians,t*c.radians)}});function v(e,t,n,r,a,i){if(!i)return function(e,t,n,r,a){function i(i,o){return[t+e*(i*=r),n-e*(o*=a)]}return i.invert=function(i,o){return[(i-t)/e*r,(n-o)/e*a]},i}(e,t,n,r,a);var o=c.cos(i),u=c.sin(i),s=o*e,l=u*e,f=o/e,d=u/e,p=(u*n-o*t)/e,h=(u*t+o*n)/e;function v(e,i){return[s*(e*=r)-l*(i*=a)+t,n-l*e-s*i]}return v.invert=function(e,t){return[r*(f*e-d*t+p),a*(h-d*e-f*t)]},v}function g(e){return m((function(){return e}))()}function m(e){var t,n,s,g,m,y,x,b,k,w,A=150,E=480,C=250,S=0,N=0,T=0,D=0,F=0,O=0,_=1,I=1,R=null,M=r.default,B=null,P=u.default,L=.5;function j(e){return b(e[0]*c.radians,e[1]*c.radians)}function z(e){return(e=b.invert(e[0],e[1]))&&[e[0]*c.degrees,e[1]*c.degrees]}function U(){var e=v(A,0,0,_,I,O).apply(null,t(S,N)),r=v(A,E-e[0],C-e[1],_,I,O);return n=l.rotateRadians(T,D,F),x=o.default(t,r),b=o.default(n,x),y=p.default(x,L),V()}function V(){return k=w=null,j}return j.stream=function(e){return k&&w===e?k:k=h(function(e){return f.transformer({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}(n)(M(y(P(w=e)))))},j.preclip=function(e){return arguments.length?(M=e,R=void 0,V()):M},j.postclip=function(e){return arguments.length?(P=e,B=s=g=m=null,V()):P},j.clipAngle=function(e){return arguments.length?(M=+e?a.default(R=e*c.radians):(R=null,r.default),V()):R*c.degrees},j.clipExtent=function(e){return arguments.length?(P=null==e?(B=s=g=m=null,u.default):i.default(B=+e[0][0],s=+e[0][1],g=+e[1][0],m=+e[1][1]),V()):null==B?null:[[B,s],[g,m]]},j.scale=function(e){return arguments.length?(A=+e,U()):A},j.translate=function(e){return arguments.length?(E=+e[0],C=+e[1],U()):[E,C]},j.center=function(e){return arguments.length?(S=e[0]%360*c.radians,N=e[1]%360*c.radians,U()):[S*c.degrees,N*c.degrees]},j.rotate=function(e){return arguments.length?(T=e[0]%360*c.radians,D=e[1]%360*c.radians,F=e.length>2?e[2]%360*c.radians:0,U()):[T*c.degrees,D*c.degrees,F*c.degrees]},j.angle=function(e){return arguments.length?(O=e%360*c.radians,U()):O*c.degrees},j.reflectX=function(e){return arguments.length?(_=e?-1:1,U()):_<0},j.reflectY=function(e){return arguments.length?(I=e?-1:1,U()):I<0},j.precision=function(e){return arguments.length?(y=p.default(x,L=e*e),V()):c.sqrt(L)},j.fitExtent=function(e,t){return d.fitExtent(j,e,t)},j.fitSize=function(e,t){return d.fitSize(j,e,t)},j.fitWidth=function(e,t){return d.fitWidth(j,e,t)},j.fitHeight=function(e,t){return d.fitHeight(j,e,t)},function(){return t=e.apply(this,arguments),j.invert=t.invert&&z,U()}}})),s.register("3R4ku",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("2RPaV"),a=s("5ABrm"),i=r.default((function(){return!0}),(function(e){var t,n=NaN,r=NaN,i=NaN;return{lineStart:function(){e.lineStart(),t=1},point:function(o,u){var s=o>0?a.pi:-a.pi,c=a.abs(o-n);a.abs(c-a.pi)<a.epsilon?(e.point(n,r=(r+u)/2>0?a.halfPi:-a.halfPi),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),e.point(o,r),t=0):i!==s&&c>=a.pi&&(a.abs(n-i)<a.epsilon&&(n-=i*a.epsilon),a.abs(o-s)<a.epsilon&&(o-=s*a.epsilon),r=function(e,t,n,r){var i,o,u=a.sin(e-n);return a.abs(u)>a.epsilon?a.atan((a.sin(t)*(o=a.cos(r))*a.sin(n)-a.sin(r)*(i=a.cos(t))*a.sin(e))/(i*o*u)):(t+r)/2}(n,r,o,u),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(s,r),t=0),e.point(n=o,r=u),i=s},lineEnd:function(){e.lineEnd(),n=r=NaN},clean:function(){return 2-t}}}),(function(e,t,n,r){var i;if(null==e)i=n*a.halfPi,r.point(-a.pi,i),r.point(0,i),r.point(a.pi,i),r.point(a.pi,0),r.point(a.pi,-i),r.point(0,-i),r.point(-a.pi,-i),r.point(-a.pi,0),r.point(-a.pi,i);else if(a.abs(e[0]-t[0])>a.epsilon){var o=e[0]<t[0]?a.pi:-a.pi;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(t[0],t[1])}),[-a.pi,-a.halfPi])})),s.register("2RPaV",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("aiFVs"),a=s("csi5x"),i=s("5ABrm"),o=s("8Hxfy"),u=s("548Lj");function c(e,t,n,i){return function(s){var c,d,p,h=t(s),v=r.default(),g=t(v),m=!1,y={point:x,lineStart:k,lineEnd:w,polygonStart:function(){y.point=A,y.lineStart=E,y.lineEnd=C,d=[],c=[]},polygonEnd:function(){y.point=x,y.lineStart=k,y.lineEnd=w,d=u.default(d);var e=o.default(c,i);d.length?(m||(s.polygonStart(),m=!0),a.default(d,f,e,n,s)):e&&(m||(s.polygonStart(),m=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),m&&(s.polygonEnd(),m=!1),d=c=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function x(t,n){e(t,n)&&s.point(t,n)}function b(e,t){h.point(e,t)}function k(){y.point=b,h.lineStart()}function w(){y.point=x,h.lineEnd()}function A(e,t){p.push([e,t]),g.point(e,t)}function E(){g.lineStart(),p=[]}function C(){A(p[0][0],p[0][1]),g.lineEnd();var e,t,n,r,a=g.clean(),i=v.result(),o=i.length;if(p.pop(),c.push(p),p=null,o)if(1&a){if((t=(n=i[0]).length-1)>0){for(m||(s.polygonStart(),m=!0),s.lineStart(),e=0;e<t;++e)s.point((r=n[e])[0],r[1]);s.lineEnd()}}else o>1&&2&a&&i.push(i.pop().concat(i.shift())),d.push(i.filter(l))}return y}}function l(e){return e.length>1}function f(e,t){return((e=e.x)[0]<0?e[1]-i.halfPi-i.epsilon:i.halfPi-e[1])-((t=t.x)[0]<0?t[1]-i.halfPi-i.epsilon:i.halfPi-t[1])}})),s.register("aiFVs",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("c7WJq");function a(){var e,t=[];return{point:function(t,n,r){e.push([t,n,r])},lineStart:function(){t.push(e=[])},lineEnd:r.default,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}})),s.register("csi5x",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("4L1Ie"),a=s("5ABrm");function i(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function o(e,t,n,o,s){var c,l,f=[],d=[];if(e.forEach((function(e){if(!((t=e.length-1)<=0)){var t,n,o=e[0],u=e[t];if(r.default(o,u)){if(!o[2]&&!u[2]){for(s.lineStart(),c=0;c<t;++c)s.point((o=e[c])[0],o[1]);return void s.lineEnd()}u[0]+=2*a.epsilon}f.push(n=new i(o,e,null,!0)),d.push(n.o=new i(o,null,n,!1)),f.push(n=new i(u,e,null,!1)),d.push(n.o=new i(u,null,n,!0))}})),f.length){for(d.sort(t),u(f),u(d),c=0,l=d.length;c<l;++c)d[c].e=n=!n;for(var p,h,v=f[0];;){for(var g=v,m=!0;g.v;)if((g=g.n)===v)return;p=g.z,s.lineStart();do{if(g.v=g.o.v=!0,g.e){if(m)for(c=0,l=p.length;c<l;++c)s.point((h=p[c])[0],h[1]);else o(g.x,g.n.x,1,s);g=g.n}else{if(m)for(p=g.p.z,c=p.length-1;c>=0;--c)s.point((h=p[c])[0],h[1]);else o(g.x,g.p.x,-1,s);g=g.p}p=(g=g.o).z,m=!m}while(!g.v);s.lineEnd()}}}function u(e){if(t=e.length){for(var t,n,r=0,a=e[0];++r<t;)a.n=n=e[r],n.p=a,a=n;a.n=n=e[0],n.p=a}}})),s.register("4L1Ie",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("5ABrm");function a(e,t){return r.abs(e[0]-t[0])<r.epsilon&&r.abs(e[1]-t[1])<r.epsilon}})),s.register("8Hxfy",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("cFqjn"),a=s("1348I"),i=s("5ABrm");function o(e){return i.abs(e[0])<=i.pi?e[0]:i.sign(e[0])*((i.abs(e[0])+i.pi)%i.tau-i.pi)}function u(e,t){var n=o(t),u=t[1],s=i.sin(u),c=[i.sin(n),-i.cos(n),0],l=0,f=0,d=new r.Adder;1===s?u=i.halfPi+i.epsilon:-1===s&&(u=-i.halfPi-i.epsilon);for(var p=0,h=e.length;p<h;++p)if(g=(v=e[p]).length)for(var v,g,m=v[g-1],y=o(m),x=m[1]/2+i.quarterPi,b=i.sin(x),k=i.cos(x),w=0;w<g;++w,y=E,b=S,k=N,m=A){var A=v[w],E=o(A),C=A[1]/2+i.quarterPi,S=i.sin(C),N=i.cos(C),T=E-y,D=T>=0?1:-1,F=D*T,O=F>i.pi,_=b*S;if(d.add(i.atan2(_*D*i.sin(F),k*N+_*i.cos(F))),l+=O?T+D*i.tau:T,O^y>=n^E>=n){var I=a.cartesianCross(a.cartesian(m),a.cartesian(A));a.cartesianNormalizeInPlace(I);var R=a.cartesianCross(c,I);a.cartesianNormalizeInPlace(R);var M=(O^T>=0?-1:1)*i.asin(R[2]);(u>M||u===M&&(I[0]||I[1]))&&(f+=O^T>=0?1:-1)}}return(l<-i.epsilon||l<i.epsilon&&d<-i.epsilon2)^1&f}})),s.register("dk5Gm",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("1348I"),a=s("4MTpW"),i=s("5ABrm"),o=s("4L1Ie"),u=s("2RPaV");function c(e){var t=i.cos(e),n=6*i.radians,s=t>0,c=i.abs(t)>i.epsilon;function l(e,n){return i.cos(e)*i.cos(n)>t}function f(e,n,a){var o=r.cartesian(e),u=r.cartesian(n),s=[1,0,0],c=r.cartesianCross(o,u),l=r.cartesianDot(c,c),f=c[0],d=l-f*f;if(!d)return!a&&e;var p=t*l/d,h=-t*f/d,v=r.cartesianCross(s,c),g=r.cartesianScale(s,p),m=r.cartesianScale(c,h);r.cartesianAddInPlace(g,m);var y=v,x=r.cartesianDot(g,y),b=r.cartesianDot(y,y),k=x*x-b*(r.cartesianDot(g,g)-1);if(!(k<0)){var w=i.sqrt(k),A=r.cartesianScale(y,(-x-w)/b);if(r.cartesianAddInPlace(A,g),A=r.spherical(A),!a)return A;var E,C=e[0],S=n[0],N=e[1],T=n[1];S<C&&(E=C,C=S,S=E);var D=S-C,F=i.abs(D-i.pi)<i.epsilon;if(!F&&T<N&&(E=N,N=T,T=E),F||D<i.epsilon?F?N+T>0^A[1]<(i.abs(A[0]-C)<i.epsilon?N:T):N<=A[1]&&A[1]<=T:D>i.pi^(C<=A[0]&&A[0]<=S)){var O=r.cartesianScale(y,(-x+w)/b);return r.cartesianAddInPlace(O,g),[A,r.spherical(O)]}}}function d(t,n){var r=s?e:i.pi-e,a=0;return t<-r?a|=1:t>r&&(a|=2),n<-r?a|=4:n>r&&(a|=8),a}return u.default(l,(function(e){var t,n,r,a,u;return{lineStart:function(){a=r=!1,u=1},point:function(p,h){var v,g=[p,h],m=l(p,h),y=s?m?0:d(p,h):m?d(p+(p<0?i.pi:-i.pi),h):0;if(!t&&(a=r=m)&&e.lineStart(),m!==r&&(!(v=f(t,g))||o.default(t,v)||o.default(g,v))&&(g[2]=1),m!==r)u=0,m?(e.lineStart(),v=f(g,t),e.point(v[0],v[1])):(v=f(t,g),e.point(v[0],v[1],2),e.lineEnd()),t=v;else if(c&&t&&s^m){var x;y&n||!(x=f(g,t,!0))||(u=0,s?(e.lineStart(),e.point(x[0][0],x[0][1]),e.point(x[1][0],x[1][1]),e.lineEnd()):(e.point(x[1][0],x[1][1]),e.lineEnd(),e.lineStart(),e.point(x[0][0],x[0][1],3)))}!m||t&&o.default(t,g)||e.point(g[0],g[1]),t=g,r=m,n=y},lineEnd:function(){r&&e.lineEnd(),t=null},clean:function(){return u|(a&&r)<<1}}}),(function(t,r,i,o){a.circleStream(o,e,n,i,t,r)}),s?[0,-e]:[-i.pi,e-i.pi])}})),s.register("4MTpW",(function(e,t){n(e.exports,"circleStream",(function(){return i}));var r=s("1348I"),a=(s("cIq8i"),s("5ABrm"));s("eS0qV");function i(e,t,n,i,u,s){if(n){var c=a.cos(t),l=a.sin(t),f=i*n;null==u?(u=t+i*a.tau,s=t-f/2):(u=o(c,u),s=o(c,s),(i>0?u<s:u>s)&&(u+=i*a.tau));for(var d,p=u;i>0?p>s:p<s;p-=f)d=r.spherical([c,-l*a.cos(p),-l*a.sin(p)]),e.point(d[0],d[1])}}function o(e,t){(t=r.cartesian(t))[0]-=e,r.cartesianNormalizeInPlace(t);var n=a.acos(-t[1]);return((-t[2]<0?-n:n)+a.tau-a.epsilon)%a.tau}})),s.register("cIq8i",(function(e,t){function r(e){return function(){return e}}n(e.exports,"default",(function(){return r}))})),s.register("eS0qV",(function(e,t){n(e.exports,"rotateRadians",(function(){return o})),n(e.exports,"default",(function(){return f}));var r=s("eVkK2"),a=s("5ABrm");function i(e,t){return[a.abs(e)>a.pi?e+Math.round(-e/a.tau)*a.tau:e,t]}function o(e,t,n){return(e%=a.tau)?t||n?r.default(c(e),l(t,n)):c(e):t||n?l(t,n):i}function u(e){return function(t,n){return[(t+=e)>a.pi?t-a.tau:t<-a.pi?t+a.tau:t,n]}}function c(e){var t=u(e);return t.invert=u(-e),t}function l(e,t){var n=a.cos(e),r=a.sin(e),i=a.cos(t),o=a.sin(t);function u(e,t){var u=a.cos(t),s=a.cos(e)*u,c=a.sin(e)*u,l=a.sin(t),f=l*n+s*r;return[a.atan2(c*i-f*o,s*n-l*r),a.asin(f*i+c*o)]}return u.invert=function(e,t){var u=a.cos(t),s=a.cos(e)*u,c=a.sin(e)*u,l=a.sin(t),f=l*i-c*o;return[a.atan2(c*i+l*o,s*n+f*r),a.asin(f*n-s*r)]},u}function f(e){function t(t){return(t=e(t[0]*a.radians,t[1]*a.radians))[0]*=a.degrees,t[1]*=a.degrees,t}return e=o(e[0]*a.radians,e[1]*a.radians,e.length>2?e[2]*a.radians:0),t.invert=function(t){return(t=e.invert(t[0]*a.radians,t[1]*a.radians))[0]*=a.degrees,t[1]*=a.degrees,t},t}i.invert=i})),s.register("eVkK2",(function(e,t){function r(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return(n=t.invert(n,r))&&e.invert(n[0],n[1])}),n}n(e.exports,"default",(function(){return r}))})),s.register("2j8hP",(function(e,t){n(e.exports,"default",(function(){return f}));var r=s("5ABrm"),a=s("aiFVs"),i=s("hY2dK"),o=s("csi5x"),u=s("548Lj"),c=1e9,l=-1e9;function f(e,t,n,s){function f(r,a){return e<=r&&r<=n&&t<=a&&a<=s}function d(r,a,i,o){var u=0,c=0;if(null==r||(u=p(r,i))!==(c=p(a,i))||v(r,a)<0^i>0)do{o.point(0===u||3===u?e:n,u>1?s:t)}while((u=(u+i+4)%4)!==c);else o.point(a[0],a[1])}function p(a,i){return r.abs(a[0]-e)<r.epsilon?i>0?0:3:r.abs(a[0]-n)<r.epsilon?i>0?2:1:r.abs(a[1]-t)<r.epsilon?i>0?1:0:i>0?3:2}function h(e,t){return v(e.x,t.x)}function v(e,t){var n=p(e,1),r=p(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}return function(r){var p,v,g,m,y,x,b,k,w,A,E,C=r,S=a.default(),N={point:T,lineStart:function(){N.point=D,v&&v.push(g=[]);A=!0,w=!1,b=k=NaN},lineEnd:function(){p&&(D(m,y),x&&w&&S.rejoin(),p.push(S.result()));N.point=T,w&&C.lineEnd()},polygonStart:function(){C=S,p=[],v=[],E=!0},polygonEnd:function(){var t=function(){for(var t=0,n=0,r=v.length;n<r;++n)for(var a,i,o=v[n],u=1,c=o.length,l=o[0],f=l[0],d=l[1];u<c;++u)a=f,i=d,f=(l=o[u])[0],d=l[1],i<=s?d>s&&(f-a)*(s-i)>(d-i)*(e-a)&&++t:d<=s&&(f-a)*(s-i)<(d-i)*(e-a)&&--t;return t}(),n=E&&t,a=(p=u.default(p)).length;(n||a)&&(r.polygonStart(),n&&(r.lineStart(),d(null,null,1,r),r.lineEnd()),a&&o.default(p,h,t,d,r),r.polygonEnd());C=r,p=v=g=null}};function T(e,t){f(e,t)&&C.point(e,t)}function D(r,a){var o=f(r,a);if(v&&g.push([r,a]),A)m=r,y=a,x=o,A=!1,o&&(C.lineStart(),C.point(r,a));else if(o&&w)C.point(r,a);else{var u=[b=Math.max(l,Math.min(c,b)),k=Math.max(l,Math.min(c,k))],d=[r=Math.max(l,Math.min(c,r)),a=Math.max(l,Math.min(c,a))];i.default(u,d,e,t,n,s)?(w||(C.lineStart(),C.point(u[0],u[1])),C.point(d[0],d[1]),o||C.lineEnd(),E=!1):o&&(C.lineStart(),C.point(r,a),E=!1)}b=r,k=a,w=o}return N}}})),s.register("hY2dK",(function(e,t){function r(e,t,n,r,a,i){var o,u=e[0],s=e[1],c=0,l=1,f=t[0]-u,d=t[1]-s;if(o=n-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<l&&(l=o)}else if(f>0){if(o>l)return;o>c&&(c=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>l)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<l&&(l=o)}if(o=r-s,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<l&&(l=o)}else if(d>0){if(o>l)return;o>c&&(c=o)}if(o=i-s,d||!(o<0)){if(o/=d,d<0){if(o>l)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<l&&(l=o)}return c>0&&(e[0]=u+c*f,e[1]=s+c*d),l<1&&(t[0]=u+l*f,t[1]=s+l*d),!0}}}}}n(e.exports,"default",(function(){return r}))})),s.register("3f9DY",(function(e,t){function r(e){return function(t){var n=new a;for(var r in e)n[r]=e[r];return n.stream=t,n}}function a(){}n(e.exports,"transformer",(function(){return r})),a.prototype={constructor:a,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}}})),s.register("h817v",(function(e,t){n(e.exports,"fitExtent",(function(){return o})),n(e.exports,"fitSize",(function(){return u})),n(e.exports,"fitWidth",(function(){return c})),n(e.exports,"fitHeight",(function(){return l}));var r=s("5uBsW"),a=s("cqds6");function i(e,t,n){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),null!=i&&e.clipExtent(null),r.default(n,e.stream(a.default)),t(a.default.result()),null!=i&&e.clipExtent(i),e}function o(e,t,n){return i(e,(function(n){var r=t[1][0]-t[0][0],a=t[1][1]-t[0][1],i=Math.min(r/(n[1][0]-n[0][0]),a/(n[1][1]-n[0][1])),o=+t[0][0]+(r-i*(n[1][0]+n[0][0]))/2,u=+t[0][1]+(a-i*(n[1][1]+n[0][1]))/2;e.scale(150*i).translate([o,u])}),n)}function u(e,t,n){return o(e,[[0,0],t],n)}function c(e,t,n){return i(e,(function(n){var r=+t,a=r/(n[1][0]-n[0][0]),i=(r-a*(n[1][0]+n[0][0]))/2,o=-a*n[0][1];e.scale(150*a).translate([i,o])}),n)}function l(e,t,n){return i(e,(function(n){var r=+t,a=r/(n[1][1]-n[0][1]),i=-a*n[0][0],o=(r-a*(n[1][1]+n[0][1]))/2;e.scale(150*a).translate([i,o])}),n)}})),s.register("aGVly",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("1348I"),a=s("5ABrm"),i=s("3f9DY"),o=a.cos(30*a.radians);function u(e,t){return+t?function(e,t){function n(r,i,u,s,c,l,f,d,p,h,v,g,m,y){var x=f-r,b=d-i,k=x*x+b*b;if(k>4*t&&m--){var w=s+h,A=c+v,E=l+g,C=a.sqrt(w*w+A*A+E*E),S=a.asin(E/=C),N=a.abs(a.abs(E)-1)<a.epsilon||a.abs(u-p)<a.epsilon?(u+p)/2:a.atan2(A,w),T=e(N,S),D=T[0],F=T[1],O=D-r,_=F-i,I=b*O-x*_;(I*I/k>t||a.abs((x*O+b*_)/k-.5)>.3||s*h+c*v+l*g<o)&&(n(r,i,u,s,c,l,D,F,N,w/=C,A/=C,E,m,y),y.point(D,F),n(D,F,N,w,A,E,f,d,p,h,v,g,m,y))}}return function(t){var a,i,o,u,s,c,l,f,d,p,h,v,g={point:m,lineStart:y,lineEnd:b,polygonStart:function(){t.polygonStart(),g.lineStart=k},polygonEnd:function(){t.polygonEnd(),g.lineStart=y}};function m(n,r){n=e(n,r),t.point(n[0],n[1])}function y(){f=NaN,g.point=x,t.lineStart()}function x(a,i){var o=r.cartesian([a,i]),u=e(a,i);n(f,d,l,p,h,v,f=u[0],d=u[1],l=a,p=o[0],h=o[1],v=o[2],16,t),t.point(f,d)}function b(){g.point=m,t.lineEnd()}function k(){y(),g.point=w,g.lineEnd=A}function w(e,t){x(a=e,t),i=f,o=d,u=p,s=h,c=v,g.point=x}function A(){n(f,d,l,p,h,v,i,o,a,u,s,c,16,t),g.lineEnd=b,b()}return g}}(e,t):function(e){return i.transformer({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}(e)}})),s.register("6HV1D",(function(e,t){n(e.exports,"cylindricalEqualAreaRaw",(function(){return a}));var r=s("5ABrm");function a(e){var t=r.cos(e);function n(e,n){return[e*t,r.sin(n)/t]}return n.invert=function(e,n){return[e/t,r.asin(n*t)]},n}})),s.register("geBq9",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("87CUp"),i=s("jvnfM"),o=s("h817v");function u(){var e,t,n,u,s,c,l=a.default(),f=i.default().rotate([154,0]).center([-2,58.5]).parallels([55,65]),d=i.default().rotate([157,0]).center([-3,19.9]).parallels([8,18]),p={point:function(e,t){c=[e,t]}};function h(e){var t=e[0],r=e[1];return c=null,n.point(t,r),c||(u.point(t,r),c)||(s.point(t,r),c)}function v(){return e=t=null,h}return h.invert=function(e){var t=l.scale(),n=l.translate(),r=(e[0]-n[0])/t,a=(e[1]-n[1])/t;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?f:a>=.166&&a<.234&&r>=-.214&&r<-.115?d:l).invert(e)},h.stream=function(n){return e&&t===n?e:(r=[l.stream(t=n),f.stream(n),d.stream(n)],a=r.length,e={point:function(e,t){for(var n=-1;++n<a;)r[n].point(e,t)},sphere:function(){for(var e=-1;++e<a;)r[e].sphere()},lineStart:function(){for(var e=-1;++e<a;)r[e].lineStart()},lineEnd:function(){for(var e=-1;++e<a;)r[e].lineEnd()},polygonStart:function(){for(var e=-1;++e<a;)r[e].polygonStart()},polygonEnd:function(){for(var e=-1;++e<a;)r[e].polygonEnd()}});var r,a},h.precision=function(e){return arguments.length?(l.precision(e),f.precision(e),d.precision(e),v()):l.precision()},h.scale=function(e){return arguments.length?(l.scale(e),f.scale(.35*e),d.scale(e),h.translate(l.translate())):l.scale()},h.translate=function(e){if(!arguments.length)return l.translate();var t=l.scale(),a=+e[0],i=+e[1];return n=l.translate(e).clipExtent([[a-.455*t,i-.238*t],[a+.455*t,i+.238*t]]).stream(p),u=f.translate([a-.307*t,i+.201*t]).clipExtent([[a-.425*t+r.epsilon,i+.12*t+r.epsilon],[a-.214*t-r.epsilon,i+.234*t-r.epsilon]]).stream(p),s=d.translate([a-.205*t,i+.212*t]).clipExtent([[a-.214*t+r.epsilon,i+.166*t+r.epsilon],[a-.115*t-r.epsilon,i+.234*t-r.epsilon]]).stream(p),v()},h.fitExtent=function(e,t){return o.fitExtent(h,e,t)},h.fitSize=function(e,t){return o.fitSize(h,e,t)},h.fitWidth=function(e,t){return o.fitWidth(h,e,t)},h.fitHeight=function(e,t){return o.fitHeight(h,e,t)},h.scale(1070)}})),s.register("fLCuv",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("d7tEy"),i=s("lAEFj"),o=a.azimuthalRaw((function(e){return r.sqrt(2/(1+e))}));function u(){return i.default(o).scale(124.75).clipAngle(179.999)}o.invert=a.azimuthalInvert((function(e){return 2*r.asin(e/2)}))})),s.register("d7tEy",(function(e,t){n(e.exports,"azimuthalRaw",(function(){return a})),n(e.exports,"azimuthalInvert",(function(){return i}));var r=s("5ABrm");function a(e){return function(t,n){var a=r.cos(t),i=r.cos(n),o=e(a*i);return o===1/0?[2,0]:[o*i*r.sin(t),o*r.sin(n)]}}function i(e){return function(t,n){var a=r.sqrt(t*t+n*n),i=e(a),o=r.sin(i),u=r.cos(i);return[r.atan2(t*o,a*u),r.asin(a&&n*o/a)]}}})),s.register("gOqAq",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("d7tEy"),i=s("lAEFj"),o=a.azimuthalRaw((function(e){return(e=r.acos(e))&&e/r.sin(e)}));function u(){return i.default(o).scale(79.4188).clipAngle(179.999)}o.invert=a.azimuthalInvert((function(e){return e}))})),s.register("f6wqr",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("5ABrm"),a=s("eZMul"),i=s("faGV4");function o(e){return r.tan((r.halfPi+e)/2)}function u(e,t){var n=r.cos(e),a=e===t?r.sin(e):r.log(n/r.cos(t))/r.log(o(t)/o(e)),u=n*r.pow(o(e),a)/a;if(!a)return i.mercatorRaw;function s(e,t){u>0?t<-r.halfPi+r.epsilon&&(t=-r.halfPi+r.epsilon):t>r.halfPi-r.epsilon&&(t=r.halfPi-r.epsilon);var n=u/r.pow(o(t),a);return[n*r.sin(a*e),u-n*r.cos(a*e)]}return s.invert=function(e,t){var n=u-t,i=r.sign(a)*r.sqrt(e*e+n*n),o=r.atan2(e,r.abs(n))*r.sign(n);return n*a<0&&(o-=r.pi*r.sign(e)*r.sign(n)),[o/a,2*r.atan(r.pow(u/i,1/a))-r.halfPi]},s}function c(){return a.conicProjection(u).scale(109.5).parallels([30,30])}})),s.register("faGV4",(function(e,t){n(e.exports,"mercatorRaw",(function(){return o})),n(e.exports,"default",(function(){return u})),n(e.exports,"mercatorProjection",(function(){return c}));var r=s("5ABrm"),a=s("eS0qV"),i=s("lAEFj");function o(e,t){return[e,r.log(r.tan((r.halfPi+t)/2))]}function u(){return c(o).scale(961/r.tau)}function c(e){var t,n,u,s=i.default(e),c=s.center,l=s.scale,f=s.translate,d=s.clipExtent,p=null;function h(){var i=r.pi*l(),c=s(a.default(s.rotate()).invert([0,0]));return d(null==p?[[c[0]-i,c[1]-i],[c[0]+i,c[1]+i]]:e===o?[[Math.max(c[0]-i,p),t],[Math.min(c[0]+i,n),u]]:[[p,Math.max(c[1]-i,t)],[n,Math.min(c[1]+i,u)]])}return s.scale=function(e){return arguments.length?(l(e),h()):l()},s.translate=function(e){return arguments.length?(f(e),h()):f()},s.center=function(e){return arguments.length?(c(e),h()):c()},s.clipExtent=function(e){return arguments.length?(null==e?p=t=n=u=null:(p=+e[0][0],t=+e[0][1],n=+e[1][0],u=+e[1][1]),h()):null==p?null:[[p,t],[n,u]]},h()}o.invert=function(e,t){return[e,2*r.atan(r.exp(t))-r.halfPi]}})),s.register("4MaDd",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("eZMul"),i=s("lroq6");function o(e,t){var n=r.cos(e),a=e===t?r.sin(e):(n-r.cos(t))/(t-e),o=n/a+e;if(r.abs(a)<r.epsilon)return i.equirectangularRaw;function u(e,t){var n=o-t,i=a*e;return[n*r.sin(i),o-n*r.cos(i)]}return u.invert=function(e,t){var n=o-t,i=r.atan2(e,r.abs(n))*r.sign(n);return n*a<0&&(i-=r.pi*r.sign(e)*r.sign(n)),[i/a,o-r.sign(a)*r.sqrt(e*e+n*n)]},u}function u(){return a.conicProjection(o).scale(131.154).center([0,13.9389])}})),s.register("lroq6",(function(e,t){n(e.exports,"equirectangularRaw",(function(){return a})),n(e.exports,"default",(function(){return i}));var r=s("lAEFj");function a(e,t){return[e,t]}function i(){return r.default(a).scale(152.63)}a.invert=a})),s.register("er73T",(function(e,t){n(e.exports,"default",(function(){return d}));var r=s("lAEFj"),a=s("5ABrm"),i=1.340264,o=-.081106,u=893e-6,c=.003796,l=a.sqrt(3)/2;function f(e,t){var n=a.asin(l*a.sin(t)),r=n*n,s=r*r*r;return[e*a.cos(n)/(l*(i+-.24331799999999998*r+s*(.0062510000000000005+.034164*r))),n*(i+o*r+s*(u+c*r))]}function d(){return r.default(f).scale(177.158)}f.invert=function(e,t){for(var n,r=t,s=r*r,f=s*s*s,d=0;d<12&&(f=(s=(r-=n=(r*(i+o*s+f*(u+c*s))-t)/(i+-.24331799999999998*s+f*(.0062510000000000005+.034164*s)))*r)*s*s,!(a.abs(n)<a.epsilon2));++d);return[l*e*(i+-.24331799999999998*s+f*(.0062510000000000005+.034164*s))/a.cos(r),a.asin(a.sin(r)/l)]}})),s.register("2wv80",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("d7tEy"),i=s("lAEFj");function o(e,t){var n=r.cos(t),a=r.cos(e)*n;return[n*r.sin(e)/a,r.sin(t)/a]}function u(){return i.default(o).scale(144.049).clipAngle(60)}o.invert=a.azimuthalInvert(r.atan)})),s.register("2fmpG",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("2j8hP"),a=s("6pWJw"),i=s("3f9DY"),o=s("h817v"),u=s("5ABrm");function c(){var e,t,n,s,c,l,f,d=1,p=0,h=0,v=1,g=1,m=0,y=null,x=1,b=1,k=i.transformer({point:function(e,t){var n=E([e,t]);this.stream.point(n[0],n[1])}}),w=a.default;function A(){return x=d*v,b=d*g,l=f=null,E}function E(n){var r=n[0]*x,a=n[1]*b;if(m){var i=a*e-r*t;r=r*e+a*t,a=i}return[r+p,a+h]}return E.invert=function(n){var r=n[0]-p,a=n[1]-h;if(m){var i=a*e+r*t;r=r*e-a*t,a=i}return[r/x,a/b]},E.stream=function(e){return l&&f===e?l:l=k(w(f=e))},E.postclip=function(e){return arguments.length?(w=e,y=n=s=c=null,A()):w},E.clipExtent=function(e){return arguments.length?(w=null==e?(y=n=s=c=null,a.default):r.default(y=+e[0][0],n=+e[0][1],s=+e[1][0],c=+e[1][1]),A()):null==y?null:[[y,n],[s,c]]},E.scale=function(e){return arguments.length?(d=+e,A()):d},E.translate=function(e){return arguments.length?(p=+e[0],h=+e[1],A()):[p,h]},E.angle=function(n){return arguments.length?(m=n%360*u.radians,t=u.sin(m),e=u.cos(m),A()):m*u.degrees},E.reflectX=function(e){return arguments.length?(v=e?-1:1,A()):v<0},E.reflectY=function(e){return arguments.length?(g=e?-1:1,A()):g<0},E.fitExtent=function(e,t){return o.fitExtent(E,e,t)},E.fitSize=function(e,t){return o.fitSize(E,e,t)},E.fitWidth=function(e,t){return o.fitWidth(E,e,t)},E.fitHeight=function(e,t){return o.fitHeight(E,e,t)},E}})),s.register("heWTN",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("lAEFj"),a=s("5ABrm");function i(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),t*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function o(){return r.default(i).scale(175.295)}i.invert=function(e,t){var n,r=t,i=25;do{var o=r*r,u=o*o;r-=n=(r*(1.007226+o*(.015085+u*(.028874*o-.044475-.005916*u)))-t)/(1.007226+o*(.045255+u*(.259866*o-.311325-.005916*11*u)))}while(a.abs(n)>a.epsilon&&--i>0);return[e/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]}})),s.register("aT9Fh",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("d7tEy"),i=s("lAEFj");function o(e,t){return[r.cos(t)*r.sin(e),r.sin(t)]}function u(){return i.default(o).scale(249.5).clipAngle(90+r.epsilon)}o.invert=a.azimuthalInvert(r.asin)})),s.register("fCGi5",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("5ABrm"),a=s("d7tEy"),i=s("lAEFj");function o(e,t){var n=r.cos(t),a=1+r.cos(e)*n;return[n*r.sin(e)/a,r.sin(t)/a]}function u(){return i.default(o).scale(250).clipAngle(142)}o.invert=a.azimuthalInvert((function(e){return 2*r.atan(e)}))})),s.register("IdGG3",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("5ABrm"),a=s("faGV4");function i(e,t){return[r.log(r.tan((r.halfPi+t)/2)),-e]}function o(){var e=a.mercatorProjection(i),t=e.center,n=e.rotate;return e.center=function(e){return arguments.length?t([-e[1],e[0]]):[(e=t())[1],-e[0]]},e.rotate=function(e){return arguments.length?n([e[0],e[1],e.length>2?e[2]+90:90]):[(e=n())[0],e[1],e[2]-90]},n([0,0,90]).scale(159.155)}i.invert=function(e,t){return[-t,2*r.atan(r.exp(e))-r.halfPi]}})),s.register("cADqr",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("lAEFj"),a=s("bJuPi");function i(e,t){var n,r=e*a.sin(t),i=30;do{t-=n=(t+a.sin(t)-r)/(1+a.cos(t))}while(a.abs(n)>a.epsilon&&--i>0);return t/2}var o=function(e,t,n){function r(r,o){return[e*r*a.cos(o=i(n,o)),t*a.sin(o)]}return r.invert=function(r,i){return i=a.asin(i/t),[r/(e*a.cos(i)),a.asin((2*i+a.sin(2*i))/n)]},r}(a.sqrt2/a.halfPi,a.sqrt2,a.pi);function u(){return r.default(o).scale(169.529)}})),s.register("bJuPi",(function(e,t){n(e.exports,"abs",(function(){return r})),n(e.exports,"cos",(function(){return a})),n(e.exports,"sin",(function(){return i})),n(e.exports,"epsilon",(function(){return o})),n(e.exports,"pi",(function(){return u})),n(e.exports,"halfPi",(function(){return s})),n(e.exports,"sqrt2",(function(){return c})),n(e.exports,"asin",(function(){return l}));var r=Math.abs,a=(Math.atan,Math.atan2,Math.ceil,Math.cos),i=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),o=(Math.tan,1e-6),u=Math.PI,s=u/2,c=(Math.SQRT1_2,f(2));f(u);function l(e){return e>1?s:e<-1?-s:Math.asin(e)}function f(e){return e>0?Math.sqrt(e):0}})),s.register("k5dJ4",(function(e,t){n(e.exports,"force",(function(){return y}));var r=s("euljU"),a=s("caNzv"),i=s("c1mTD"),o=s("i96XE"),u=s("a2NKV"),c=s("6qBEe"),l=s("jkpa9"),f=s("3q5W2"),d=s("Ts38c"),p={center:i.default,collide:o.default,nbody:u.default,link:c.default,x:l.default,y:f.default},h="forces",v=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],g=["static","iterations"],m=["x","y","vx","vy"];function y(e){r.Transform.call(this,null,e)}function x(e,t,n,r){var i,o,u,s,c=a.array(t.forces);for(i=0,o=v.length;i<o;++i)(u=v[i])!==h&&t.modified(u)&&e[u](t[u]);for(i=0,o=c.length;i<o;++i)s=h+i,(u=n||t.modified(h,i)?k(c[i]):r&&b(c[i],r)?e.force(s):null)&&e.force(s,u);for(o=e.numForces||0;i<o;++i)e.force(h+i,null);return e.numForces=c.length,e}function b(e,t){var n,r;for(n in e)if(a.isFunction(r=e[n])&&t.modified(a.accessorFields(r)))return 1;return 0}function k(e){var t,n;for(n in a.hasOwnProperty(p,e.force)||a.error("Unrecognized force: "+e.force),t=p[e.force](),e)a.isFunction(t[n])&&w(t[n],e[n],e);return t}function w(e,t,n){e(a.isFunction(t)?function(e){return t(e,n)}:t)}y.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:m}]},a.inherits(y,r.Transform,{transform:function(e,t){var n,r,a=this.value,i=t.changed(t.ADD_REM),o=e.modified(v),u=e.iterations||300;if(a?(i&&(t.modifies("index"),a.nodes(t.source)),(o||t.changed(t.MOD))&&x(a,e,0,t)):(this.value=a=function(e,t){var n=d.default(e),r=n.stop,a=n.restart,i=!1;return n.stopped=function(){return i},n.restart=function(){return i=!1,a()},n.stop=function(){return i=!0,r()},x(n,t,!0).on("end",(function(){return i=!0}))}(t.source,e),a.on("tick",(n=t.dataflow,r=this,function(){return n.touch(r).run()})),e.static||(i=!0,a.tick()),t.modifies("index")),o||i||e.modified(g)||t.changed()&&e.restart)if(a.alpha(Math.max(a.alpha(),e.alpha||1)).alphaDecay(1-Math.pow(a.alphaMin(),1/u)),e.static)for(a.stop();--u>=0;)a.tick();else if(a.stopped()&&a.restart(),!i)return t.StopPropagation;return this.finish(e,t)},finish:function(e,t){for(var n,r=t.dataflow,a=this._argops,i=0,o=a.length;i<o;++i)if((n=a[i]).name===h&&"link"===n.op._argval.force)for(var u,s=n.op._argops,c=0,l=s.length;c<l;++c)if("links"===s[c].name&&(u=s[c].op.source)){r.pulse(u,r.changeset().reflow());break}return t.reflow(e.modified()).modifies(m)}})})),s.register("c1mTD",(function(e,t){function r(e,t){var n,r=1;function a(){var a,i,o=n.length,u=0,s=0;for(a=0;a<o;++a)u+=(i=n[a]).x,s+=i.y;for(u=(u/o-e)*r,s=(s/o-t)*r,a=0;a<o;++a)(i=n[a]).x-=u,i.y-=s}return null==e&&(e=0),null==t&&(t=0),a.initialize=function(e){n=e},a.x=function(t){return arguments.length?(e=+t,a):e},a.y=function(e){return arguments.length?(t=+e,a):t},a.strength=function(e){return arguments.length?(r=+e,a):r},a}n(e.exports,"default",(function(){return r}))})),s.register("i96XE",(function(e,t){n(e.exports,"default",(function(){return c}));var r=s("hBK8Q"),a=s("9uaNP"),i=s("6ftyq");function o(e){return e.x+e.vx}function u(e){return e.y+e.vy}function c(e){var t,n,s,c=1,l=1;function f(){for(var e,a,f,p,h,v,g,m=t.length,y=0;y<l;++y)for(a=r.default(t,o,u).visitAfter(d),e=0;e<m;++e)f=t[e],v=n[f.index],g=v*v,p=f.x+f.vx,h=f.y+f.vy,a.visit(x);function x(e,t,n,r,a){var o=e.data,u=e.r,l=v+u;if(!o)return t>p+l||r<p-l||n>h+l||a<h-l;if(o.index>f.index){var d=p-o.x-o.vx,m=h-o.y-o.vy,y=d*d+m*m;y<l*l&&(0===d&&(y+=(d=i.default(s))*d),0===m&&(y+=(m=i.default(s))*m),y=(l-(y=Math.sqrt(y)))/y*c,f.vx+=(d*=y)*(l=(u*=u)/(g+u)),f.vy+=(m*=y)*l,o.vx-=d*(l=1-l),o.vy-=m*l)}}}function d(e){if(e.data)return e.r=n[e.data.index];for(var t=e.r=0;t<4;++t)e[t]&&e[t].r>e.r&&(e.r=e[t].r)}function p(){if(t){var r,a,i=t.length;for(n=new Array(i),r=0;r<i;++r)a=t[r],n[a.index]=+e(a,r,t)}}return"function"!=typeof e&&(e=a.default(null==e?1:+e)),f.initialize=function(e,n){t=e,s=n,p()},f.iterations=function(e){return arguments.length?(l=+e,f):l},f.strength=function(e){return arguments.length?(c=+e,f):c},f.radius=function(t){return arguments.length?(e="function"==typeof t?t:a.default(+t),p(),f):e},f}})),s.register("hBK8Q",(function(e,t){n(e.exports,"default",(function(){return g}));var r=s("7vOxs"),a=s("2H7SA"),i=s("ansGX"),o=s("4YqRF"),u=s("jUe6L"),c=s("fAgL1"),l=s("aRvTC"),f=s("5UIFu"),d=s("kxD9j"),p=s("b3UKh"),h=s("lLAnt"),v=s("aPaPN");function g(e,t,n){var r=new m(null==t?h.defaultX:t,null==n?v.defaultY:n,NaN,NaN,NaN,NaN);return null==e?r:r.addAll(e)}function m(e,t,n,r,a,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function y(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var x=g.prototype=m.prototype;x.copy=function(){var e,t,n=new m(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=y(r),n;for(e=[{source:r,target:n._root=new Array(4)}];r=e.pop();)for(var a=0;a<4;++a)(t=r.source[a])&&(t.length?e.push({source:t,target:r.target[a]=new Array(4)}):r.target[a]=y(t));return n},x.add=r.default,x.addAll=r.addAll,x.cover=a.default,x.data=i.default,x.extent=o.default,x.find=u.default,x.remove=c.default,x.removeAll=c.removeAll,x.root=l.default,x.size=f.default,x.visit=d.default,x.visitAfter=p.default,x.x=h.default,x.y=v.default})),s.register("7vOxs",(function(e,t){function r(e){var t=+this._x.call(null,e),n=+this._y.call(null,e);return a(this.cover(t,n),t,n,e)}function a(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var a,i,o,u,s,c,l,f,d,p=e._root,h={data:r},v=e._x0,g=e._y0,m=e._x1,y=e._y1;if(!p)return e._root=h,e;for(;p.length;)if((c=t>=(i=(v+m)/2))?v=i:m=i,(l=n>=(o=(g+y)/2))?g=o:y=o,a=p,!(p=p[f=l<<1|c]))return a[f]=h,e;if(u=+e._x.call(null,p.data),s=+e._y.call(null,p.data),t===u&&n===s)return h.next=p,a?a[f]=h:e._root=h,e;do{a=a?a[f]=new Array(4):e._root=new Array(4),(c=t>=(i=(v+m)/2))?v=i:m=i,(l=n>=(o=(g+y)/2))?g=o:y=o}while((f=l<<1|c)==(d=(s>=o)<<1|u>=i));return a[d]=p,a[f]=h,e}function i(e){var t,n,r,i,o=e.length,u=new Array(o),s=new Array(o),c=1/0,l=1/0,f=-1/0,d=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(u[n]=r,s[n]=i,r<c&&(c=r),r>f&&(f=r),i<l&&(l=i),i>d&&(d=i));if(c>f||l>d)return this;for(this.cover(c,l).cover(f,d),n=0;n<o;++n)a(this,u[n],s[n],e[n]);return this}n(e.exports,"default",(function(){return r})),n(e.exports,"addAll",(function(){return i}))})),s.register("2H7SA",(function(e,t){function r(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var o,u,s=a-n||1,c=this._root;n>e||e>=a||r>t||t>=i;)switch(u=(t<r)<<1|e<n,(o=new Array(4))[u]=c,c=o,s*=2,u){case 0:a=n+s,i=r+s;break;case 1:n=a-s,i=r+s;break;case 2:a=n+s,r=i-s;break;case 3:n=a-s,r=i-s}this._root&&this._root.length&&(this._root=c)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this}n(e.exports,"default",(function(){return r}))})),s.register("ansGX",(function(e,t){function r(){var e=[];return this.visit((function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)})),e}n(e.exports,"default",(function(){return r}))})),s.register("4YqRF",(function(e,t){function r(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}n(e.exports,"default",(function(){return r}))})),s.register("jUe6L",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("fKM4t");function a(e,t,n){var a,i,o,u,s,c,l,f=this._x0,d=this._y0,p=this._x1,h=this._y1,v=[],g=this._root;for(g&&v.push(new r.default(g,f,d,p,h)),null==n?n=1/0:(f=e-n,d=t-n,p=e+n,h=t+n,n*=n);c=v.pop();)if(!(!(g=c.node)||(i=c.x0)>p||(o=c.y0)>h||(u=c.x1)<f||(s=c.y1)<d))if(g.length){var m=(i+u)/2,y=(o+s)/2;v.push(new r.default(g[3],m,y,u,s),new r.default(g[2],i,y,m,s),new r.default(g[1],m,o,u,y),new r.default(g[0],i,o,m,y)),(l=(t>=y)<<1|e>=m)&&(c=v[v.length-1],v[v.length-1]=v[v.length-1-l],v[v.length-1-l]=c)}else{var x=e-+this._x.call(null,g.data),b=t-+this._y.call(null,g.data),k=x*x+b*b;if(k<n){var w=Math.sqrt(n=k);f=e-w,d=t-w,p=e+w,h=t+w,a=g.data}}return a}})),s.register("fKM4t",(function(e,t){function r(e,t,n,r,a){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=a}n(e.exports,"default",(function(){return r}))})),s.register("fAgL1",(function(e,t){function r(e){if(isNaN(i=+this._x.call(null,e))||isNaN(o=+this._y.call(null,e)))return this;var t,n,r,a,i,o,u,s,c,l,f,d,p=this._root,h=this._x0,v=this._y0,g=this._x1,m=this._y1;if(!p)return this;if(p.length)for(;;){if((c=i>=(u=(h+g)/2))?h=u:g=u,(l=o>=(s=(v+m)/2))?v=s:m=s,t=p,!(p=p[f=l<<1|c]))return this;if(!p.length)break;(t[f+1&3]||t[f+2&3]||t[f+3&3])&&(n=t,d=f)}for(;p.data!==e;)if(r=p,!(p=p.next))return this;return(a=p.next)&&delete p.next,r?(a?r.next=a:delete r.next,this):t?(a?t[f]=a:delete t[f],(p=t[0]||t[1]||t[2]||t[3])&&p===(t[3]||t[2]||t[1]||t[0])&&!p.length&&(n?n[d]=p:this._root=p),this):(this._root=a,this)}function a(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}n(e.exports,"default",(function(){return r})),n(e.exports,"removeAll",(function(){return a}))})),s.register("aRvTC",(function(e,t){function r(){return this._root}n(e.exports,"default",(function(){return r}))})),s.register("5UIFu",(function(e,t){function r(){var e=0;return this.visit((function(t){if(!t.length)do{++e}while(t=t.next)})),e}n(e.exports,"default",(function(){return r}))})),s.register("kxD9j",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("fKM4t");function a(e){var t,n,a,i,o,u,s=[],c=this._root;for(c&&s.push(new r.default(c,this._x0,this._y0,this._x1,this._y1));t=s.pop();)if(!e(c=t.node,a=t.x0,i=t.y0,o=t.x1,u=t.y1)&&c.length){var l=(a+o)/2,f=(i+u)/2;(n=c[3])&&s.push(new r.default(n,l,f,o,u)),(n=c[2])&&s.push(new r.default(n,a,f,l,u)),(n=c[1])&&s.push(new r.default(n,l,i,o,f)),(n=c[0])&&s.push(new r.default(n,a,i,l,f))}return this}})),s.register("b3UKh",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("fKM4t");function a(e){var t,n=[],a=[];for(this._root&&n.push(new r.default(this._root,this._x0,this._y0,this._x1,this._y1));t=n.pop();){var i=t.node;if(i.length){var o,u=t.x0,s=t.y0,c=t.x1,l=t.y1,f=(u+c)/2,d=(s+l)/2;(o=i[0])&&n.push(new r.default(o,u,s,f,d)),(o=i[1])&&n.push(new r.default(o,f,s,c,d)),(o=i[2])&&n.push(new r.default(o,u,d,f,l)),(o=i[3])&&n.push(new r.default(o,f,d,c,l))}a.push(t)}for(;t=a.pop();)e(t.node,t.x0,t.y0,t.x1,t.y1);return this}})),s.register("lLAnt",(function(e,t){function r(e){return e[0]}function a(e){return arguments.length?(this._x=e,this):this._x}n(e.exports,"defaultX",(function(){return r})),n(e.exports,"default",(function(){return a}))})),s.register("aPaPN",(function(e,t){function r(e){return e[1]}function a(e){return arguments.length?(this._y=e,this):this._y}n(e.exports,"defaultY",(function(){return r})),n(e.exports,"default",(function(){return a}))})),s.register("9uaNP",(function(e,t){function r(e){return function(){return e}}n(e.exports,"default",(function(){return r}))})),s.register("6ftyq",(function(e,t){function r(e){return 1e-6*(e()-.5)}n(e.exports,"default",(function(){return r}))})),s.register("6qBEe",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("9uaNP"),a=s("6ftyq");function i(e){return e.index}function o(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function u(e){var t,n,u,s,c,l,f=i,d=function(e){return 1/Math.min(s[e.source.index],s[e.target.index])},p=r.default(30),h=1;function v(r){for(var i=0,o=e.length;i<h;++i)for(var u,s,f,d,p,v,g,m=0;m<o;++m)s=(u=e[m]).source,d=(f=u.target).x+f.vx-s.x-s.vx||a.default(l),p=f.y+f.vy-s.y-s.vy||a.default(l),d*=v=((v=Math.sqrt(d*d+p*p))-n[m])/v*r*t[m],p*=v,f.vx-=d*(g=c[m]),f.vy-=p*g,s.vx+=d*(g=1-g),s.vy+=p*g}function g(){if(u){var r,a,i=u.length,l=e.length,d=new Map(u.map((function(e,t){return[f(e,t,u),e]})));for(r=0,s=new Array(i);r<l;++r)(a=e[r]).index=r,"object"!=typeof a.source&&(a.source=o(d,a.source)),"object"!=typeof a.target&&(a.target=o(d,a.target)),s[a.source.index]=(s[a.source.index]||0)+1,s[a.target.index]=(s[a.target.index]||0)+1;for(r=0,c=new Array(l);r<l;++r)a=e[r],c[r]=s[a.source.index]/(s[a.source.index]+s[a.target.index]);t=new Array(l),m(),n=new Array(l),y()}}function m(){if(u)for(var n=0,r=e.length;n<r;++n)t[n]=+d(e[n],n,e)}function y(){if(u)for(var t=0,r=e.length;t<r;++t)n[t]=+p(e[t],t,e)}return null==e&&(e=[]),v.initialize=function(e,t){u=e,l=t,g()},v.links=function(t){return arguments.length?(e=t,g(),v):e},v.id=function(e){return arguments.length?(f=e,v):f},v.iterations=function(e){return arguments.length?(h=+e,v):h},v.strength=function(e){return arguments.length?(d="function"==typeof e?e:r.default(+e),m(),v):d},v.distance=function(e){return arguments.length?(p="function"==typeof e?e:r.default(+e),y(),v):p},v}})),s.register("a2NKV",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("hBK8Q"),a=s("9uaNP"),i=s("6ftyq"),o=s("Ts38c");function u(){var e,t,n,u,s,c=a.default(-30),l=1,f=1/0,d=.81;function p(n){var a,i=e.length,s=r.default(e,o.x,o.y).visitAfter(v);for(u=n,a=0;a<i;++a)t=e[a],s.visit(g)}function h(){if(e){var t,n,r=e.length;for(s=new Array(r),t=0;t<r;++t)n=e[t],s[n.index]=+c(n,t,e)}}function v(e){var t,n,r,a,i,o=0,u=0;if(e.length){for(r=a=i=0;i<4;++i)(t=e[i])&&(n=Math.abs(t.value))&&(o+=t.value,u+=n,r+=n*t.x,a+=n*t.y);e.x=r/u,e.y=a/u}else{(t=e).x=t.data.x,t.y=t.data.y;do{o+=s[t.data.index]}while(t=t.next)}e.value=o}function g(e,r,a,o){if(!e.value)return!0;var c=e.x-t.x,p=e.y-t.y,h=o-r,v=c*c+p*p;if(h*h/d<v)return v<f&&(0===c&&(v+=(c=i.default(n))*c),0===p&&(v+=(p=i.default(n))*p),v<l&&(v=Math.sqrt(l*v)),t.vx+=c*e.value*u/v,t.vy+=p*e.value*u/v),!0;if(!(e.length||v>=f)){(e.data!==t||e.next)&&(0===c&&(v+=(c=i.default(n))*c),0===p&&(v+=(p=i.default(n))*p),v<l&&(v=Math.sqrt(l*v)));do{e.data!==t&&(h=s[e.data.index]*u/v,t.vx+=c*h,t.vy+=p*h)}while(e=e.next)}}return p.initialize=function(t,r){e=t,n=r,h()},p.strength=function(e){return arguments.length?(c="function"==typeof e?e:a.default(+e),h(),p):c},p.distanceMin=function(e){return arguments.length?(l=e*e,p):Math.sqrt(l)},p.distanceMax=function(e){return arguments.length?(f=e*e,p):Math.sqrt(f)},p.theta=function(e){return arguments.length?(d=e*e,p):Math.sqrt(d)},p}})),s.register("Ts38c",(function(e,t){n(e.exports,"x",(function(){return o})),n(e.exports,"y",(function(){return u})),n(e.exports,"default",(function(){return l}));var r=s("gTGd0"),a=s("a3pJs"),i=s("klGEa");function o(e){return e.x}function u(e){return e.y}var c=Math.PI*(3-Math.sqrt(5));function l(e){var t,n=1,o=.001,u=1-Math.pow(o,1/300),s=0,l=.6,f=new Map,d=a.timer(v),p=r.default("tick","end"),h=i.default();function v(){g(),p.call("tick",t),n<o&&(d.stop(),p.call("end",t))}function g(r){var a,i,o=e.length;void 0===r&&(r=1);for(var c=0;c<r;++c)for(n+=(s-n)*u,f.forEach((function(e){e(n)})),a=0;a<o;++a)null==(i=e[a]).fx?i.x+=i.vx*=l:(i.x=i.fx,i.vx=0),null==i.fy?i.y+=i.vy*=l:(i.y=i.fy,i.vy=0);return t}function m(){for(var t,n=0,r=e.length;n<r;++n){if((t=e[n]).index=n,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var a=10*Math.sqrt(.5+n),i=n*c;t.x=a*Math.cos(i),t.y=a*Math.sin(i)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function y(t){return t.initialize&&t.initialize(e,h),t}return null==e&&(e=[]),m(),t={tick:g,restart:function(){return d.restart(v),t},stop:function(){return d.stop(),t},nodes:function(n){return arguments.length?(e=n,m(),f.forEach(y),t):e},alpha:function(e){return arguments.length?(n=+e,t):n},alphaMin:function(e){return arguments.length?(o=+e,t):o},alphaDecay:function(e){return arguments.length?(u=+e,t):+u},alphaTarget:function(e){return arguments.length?(s=+e,t):s},velocityDecay:function(e){return arguments.length?(l=1-e,t):1-l},randomSource:function(e){return arguments.length?(h=e,f.forEach(y),t):h},force:function(e,n){return arguments.length>1?(null==n?f.delete(e):f.set(e,y(n)),t):f.get(e)},find:function(t,n,r){var a,i,o,u,s,c=0,l=e.length;for(null==r?r=1/0:r*=r,c=0;c<l;++c)(o=(a=t-(u=e[c]).x)*a+(i=n-u.y)*i)<r&&(s=u,r=o);return s},on:function(e,n){return arguments.length>1?(p.on(e,n),t):p.on(e)}}}})),s.register("gTGd0",(function(e,t){n(e.exports,"default",(function(){return c}));var r={value:function(){}};function a(){for(var e,t=0,n=arguments.length,r={};t<n;++t){if(!(e=arguments[t]+"")||e in r||/[\s.]/.test(e))throw new Error("illegal type: "+e);r[e]=[]}return new i(r)}function i(e){this._=e}function o(e,t){return e.trim().split(/^|\s+/).map((function(e){var n="",r=e.indexOf(".");if(r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}}))}function u(e,t){for(var n,r=0,a=e.length;r<a;++r)if((n=e[r]).name===t)return n.value}function s(e,t,n){for(var a=0,i=e.length;a<i;++a)if(e[a].name===t){e[a]=r,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}i.prototype=a.prototype={constructor:i,on:function(e,t){var n,r=this._,a=o(e+"",r),i=-1,c=a.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++i<c;)if(n=(e=a[i]).type)r[n]=s(r[n],e.name,t);else if(null==t)for(n in r)r[n]=s(r[n],e.name,null);return this}for(;++i<c;)if((n=(e=a[i]).type)&&(n=u(r[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new i(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=0,n=(r=this._[e]).length;i<n;++i)r[i].value.apply(t,a)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],a=0,i=r.length;a<i;++a)r[a].value.apply(t,n)}};var c=a})),s.register("a3pJs",(function(e,t){n(e.exports,"now",(function(){return p})),n(e.exports,"Timer",(function(){return v})),n(e.exports,"timer",(function(){return g}));var r,a,i=0,o=0,u=0,s=0,c=0,l=0,f="object"==typeof performance&&performance.now?performance:Date,d="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function p(){return c||(d(h),c=f.now()+l)}function h(){c=0}function v(){this._call=this._time=this._next=null}function g(e,t,n){var r=new v;return r.restart(e,t,n),r}function m(){c=(s=f.now())+l,i=o=0;try{!function(){p(),++i;for(var e,t=r;t;)(e=c-t._time)>=0&&t._call.call(null,e),t=t._next;--i}()}finally{i=0,function(){var e,t,n=r,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:r=t);a=e,x(i)}(),c=0}}function y(){var e=f.now(),t=e-s;t>1e3&&(l-=t,s=e)}function x(e){i||(o&&(o=clearTimeout(o)),e-c>24?(e<1/0&&(o=setTimeout(m,e-f.now()-l)),u&&(u=clearInterval(u))):(u||(s=f.now(),u=setInterval(y,1e3)),i=1,d(m)))}v.prototype=g.prototype={constructor:v,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?p():+n)+(null==t?0:+t),this._next||a===this||(a?a._next=this:r=this,a=this),this._call=e,this._time=n,x()},stop:function(){this._call&&(this._call=null,this._time=1/0,x())}}})),s.register("ddnuT",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("a3pJs");function a(e,t,n){var a=new r.Timer,i=t;return null==t?(a.restart(e,t,n),a):(a._restart=a.restart,a.restart=function(e,t,n){t=+t,n=null==n?r.now():+n,a._restart((function r(o){o+=i,a._restart(r,i+=t,n),e(o)}),t,n)},a.restart(e,t,n),a)}})),s.register("klGEa",(function(e,t){n(e.exports,"default",(function(){return a}));var r=4294967296;function a(){var e=1;return function(){return(e=(1664525*e+1013904223)%r)/r}}})),s.register("jkpa9",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("9uaNP");function a(e){var t,n,a,i=r.default(.1);function o(e){for(var r,i=0,o=t.length;i<o;++i)(r=t[i]).vx+=(a[i]-r.x)*n[i]*e}function u(){if(t){var r,o=t.length;for(n=new Array(o),a=new Array(o),r=0;r<o;++r)n[r]=isNaN(a[r]=+e(t[r],r,t))?0:+i(t[r],r,t)}}return"function"!=typeof e&&(e=r.default(null==e?0:+e)),o.initialize=function(e){t=e,u()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:r.default(+e),u(),o):i},o.x=function(t){return arguments.length?(e="function"==typeof t?t:r.default(+t),u(),o):e},o}})),s.register("3q5W2",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("9uaNP");function a(e){var t,n,a,i=r.default(.1);function o(e){for(var r,i=0,o=t.length;i<o;++i)(r=t[i]).vy+=(a[i]-r.y)*n[i]*e}function u(){if(t){var r,o=t.length;for(n=new Array(o),a=new Array(o),r=0;r<o;++r)n[r]=isNaN(a[r]=+e(t[r],r,t))?0:+i(t[r],r,t)}}return"function"!=typeof e&&(e=r.default(null==e?0:+e)),o.initialize=function(e){t=e,u()},o.strength=function(e){return arguments.length?(i="function"==typeof e?e:r.default(+e),u(),o):i},o.y=function(t){return arguments.length?(e="function"==typeof t?t:r.default(+t),u(),o):e},o}})),s.register("6QlYq",(function(e,t){n(e.exports,"nest",(function(){return b})),n(e.exports,"pack",(function(){return S})),n(e.exports,"partition",(function(){return T})),n(e.exports,"stratify",(function(){return D})),n(e.exports,"tree",(function(){return _})),n(e.exports,"treelinks",(function(){return I})),n(e.exports,"treemap",(function(){return B}));var r=s("euljU"),a=s("caNzv"),i=s("1Tr5E"),o=s("2sA6A"),u=s("2A6hC"),c=s("ezRG1"),l=s("liUq3"),f=s("6fZLR"),d=s("6LaYX"),p=s("9rn22"),h=s("4VRoJ"),v=s("eVDvN"),g=s("7nCpL"),m=s("bELYn"),y=s("6l8AR");function x(e,t,n){var r={};return e.each((function(e){var a=e.data;n(a)&&(r[t(a)]=e)})),e.lookup=r,e}function b(e){r.Transform.call(this,null,e)}b.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};var k=function(e){return e.values};function w(){var e=[],t={entries:function(e){return r(n(e,0),0)},key:function(n){return e.push(n),t}};function n(t,r){if(r>=e.length)return t;for(var a,i,o,u=t.length,s=e[r++],c={},l={},f=-1;++f<u;)(o=c[a=s(i=t[f])+""])?o.push(i):c[a]=[i];for(a in c)l[a]=n(c[a],r);return l}function r(t,n){if(++n>e.length)return t;var a=[];for(var i in t)a.push({key:i,values:r(t[i],n)});return a}return t}function A(e){r.Transform.call(this,null,e)}a.inherits(b,r.Transform,{transform:function(e,t){t.source||a.error("Nest transform requires an upstream data source.");var n=e.generate,o=e.modified(),u=t.clone(),s=this.value;return(!s||o||t.changed())&&(s&&s.each((function(e){e.children&&r.isTuple(e.data)&&u.rem.push(e.data)})),this.value=s=i.default({values:a.array(e.keys).reduce((function(e,t){return e.key(t),e}),w()).entries(u.source)},k),n&&s.each((function(e){e.children&&(e=r.ingest(e.data),u.add.push(e),u.source.push(e))})),x(s,r.tupleid,r.tupleid)),u.source.root=s,u}});var E=function(e,t){return e.parent===t.parent?1:2};a.inherits(A,r.Transform,{transform:function(e,t){t.source&&t.source.root||a.error(this.constructor.name+" transform requires a backing tree data source.");var n=this.layout(e.method),i=this.fields,o=t.source.root,u=e.as||i;e.field?o.sum(e.field):o.count(),e.sort&&o.sort(r.stableCompare(e.sort,(function(e){return e.data}))),function(e,t,n){for(var r,a=0,i=t.length;a<i;++a)(r=t[a])in n&&e[r](n[r])}(n,this.params,e),n.separation&&n.separation(!1!==e.separation?E:a.one);try{this.value=n(o)}catch(e){a.error(e)}return o.each((function(e){return function(e,t,n){for(var r=e.data,a=t.length-1,i=0;i<a;++i)r[n[i]]=e[t[i]];r[n[a]]=e.children?e.children.length:0}(e,i,u)})),t.reflow(e.modified()).modifies(u).modifies("leaf")}});var C=["x","y","r","depth","children"];function S(e){A.call(this,e)}S.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:C.length,default:C}]},a.inherits(S,A,{layout:o.default,params:["radius","size","padding"],fields:C});var N=["x0","y0","x1","y1","depth","children"];function T(e){A.call(this,e)}function D(e){r.Transform.call(this,null,e)}T.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:N.length,default:N}]},a.inherits(T,A,{layout:u.default,params:["size","round","padding"],fields:N}),D.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},a.inherits(D,r.Transform,{transform:function(e,t){t.source||a.error("Stratify transform requires an upstream data source.");var n=this.value,r=e.modified(),i=t.fork(t.ALL).materialize(t.SOURCE),o=!n||r||t.changed(t.ADD_REM)||t.modified(e.key.fields)||t.modified(e.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?x(c.default().id(e.key).parentId(e.parentKey)(i.source),e.key,a.truthy):x(c.default()([{}]),e.key,e.key)),i.source.root=this.value=n,i}});var F={tidy:l.default,cluster:f.default},O=["x","y","depth","children"];function _(e){A.call(this,e)}function I(e){r.Transform.call(this,[],e)}_.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:O.length,default:O}]},a.inherits(_,A,{layout:function(e){var t=e||"tidy";if(a.hasOwnProperty(F,t))return F[t]();a.error("Unrecognized Tree layout method: "+t)},params:["size","nodeSize"],fields:O}),I.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},a.inherits(I,r.Transform,{transform:function(e,t){var n=this.value,i=t.source&&t.source.root,o=t.fork(t.NO_SOURCE),u={};return i||a.error("TreeLinks transform requires a tree data source."),t.changed(t.ADD_REM)?(o.rem=n,t.visit(t.SOURCE,(function(e){return u[r.tupleid(e)]=1})),i.each((function(e){var t=e.data,n=e.parent&&e.parent.data;n&&u[r.tupleid(t)]&&u[r.tupleid(n)]&&o.add.push(r.ingest({source:n,target:t}))})),this.value=o.add):t.changed(t.MOD)&&(t.visit(t.MOD,(function(e){return u[r.tupleid(e)]=1})),n.forEach((function(e){(u[r.tupleid(e.source)]||u[r.tupleid(e.target)])&&o.mod.push(e)}))),o}});var R={binary:d.default,dice:p.default,slice:h.default,slicedice:v.default,squarify:g.default,resquarify:m.default},M=["x0","y0","x1","y1","depth","children"];function B(e){A.call(this,e)}B.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:M.length,default:M}]},a.inherits(B,A,{layout:function(){var e=y.default();return e.ratio=function(t){var n=e.tile();n.ratio&&e.tile(n.ratio(t))},e.method=function(t){a.hasOwnProperty(R,t)?e.tile(R[t]):a.error("Unrecognized Treemap layout method: "+t)},e},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:M})})),s.register("6fZLR",(function(e,t){function r(e,t){return e.parent===t.parent?1:2}function a(e,t){return e+t.x}function i(e,t){return Math.max(e,t.y)}function o(){var e=r,t=1,n=1,o=!1;function u(r){var u,s=0;r.eachAfter((function(t){var n=t.children;n?(t.x=function(e){return e.reduce(a,0)/e.length}(n),t.y=function(e){return 1+e.reduce(i,0)}(n)):(t.x=u?s+=e(t,u):0,t.y=0,u=t)}));var c=function(e){for(var t;t=e.children;)e=t[0];return e}(r),l=function(e){for(var t;t=e.children;)e=t[t.length-1];return e}(r),f=c.x-e(c,l)/2,d=l.x+e(l,c)/2;return r.eachAfter(o?function(e){e.x=(e.x-r.x)*t,e.y=(r.y-e.y)*n}:function(e){e.x=(e.x-f)/(d-f)*t,e.y=(1-(r.y?e.y/r.y:1))*n})}return u.separation=function(t){return arguments.length?(e=t,u):e},u.size=function(e){return arguments.length?(o=!1,t=+e[0],n=+e[1],u):o?null:[t,n]},u.nodeSize=function(e){return arguments.length?(o=!0,t=+e[0],n=+e[1],u):o?[t,n]:null},u}n(e.exports,"default",(function(){return o}))})),s.register("1Tr5E",(function(e,t){n(e.exports,"default",(function(){return y})),n(e.exports,"Node",(function(){return A})),n(e.exports,"computeHeight",(function(){return w})),s("1i51P");var r=s("4Ui3v"),a=s("lvoVn"),i=s("fSRxt"),o=s("k2oVO"),u=s("cBbLn"),c=s("310LK"),l=s("bgDFa"),f=s("jdPYF"),d=s("cgsFC"),p=s("l9Wpy"),h=s("gpWSR"),v=s("jc2LL"),g=s("4xdTB"),m=s("fGems");function y(e,t){e instanceof Map?(e=[void 0,e],void 0===t&&(t=b)):void 0===t&&(t=x);for(var n,r,a,i,o,u=new A(e),s=[u];n=s.pop();)if((a=t(n.data))&&(o=(a=Array.from(a)).length))for(n.children=a,i=o-1;i>=0;--i)s.push(r=a[i]=new A(a[i])),r.parent=n,r.depth=n.depth+1;return u.eachBefore(w)}function x(e){return e.children}function b(e){return Array.isArray(e)?e[1]:null}function k(e){void 0!==e.data.value&&(e.value=e.data.value),e.data=e.data.data}function w(e){var t=0;do{e.height=t}while((e=e.parent)&&e.height<++t)}function A(e){this.data=e,this.depth=this.height=0,this.parent=null}A.prototype=y.prototype=r.default({constructor:A,count:a.default,each:i.default,eachAfter:u.default,eachBefore:o.default,find:c.default,sum:l.default,sort:f.default,path:d.default,ancestors:p.default,descendants:h.default,leaves:v.default,links:g.default,copy:function(){return y(this).eachBefore(k)}},Symbol.iterator,m.default)})),s.register("lvoVn",(function(e,t){function r(e){var t=0,n=e.children,r=n&&n.length;if(r)for(;--r>=0;)t+=n[r].value;else t=1;e.value=t}function a(){return this.eachAfter(r)}n(e.exports,"default",(function(){return a}))})),s.register("fSRxt",(function(e,t){function r(e,t){var n=-1,r=!0,a=!1,i=void 0;try{for(var o,u=this[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.call(t,s,++n,this)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return this}n(e.exports,"default",(function(){return r}))})),s.register("k2oVO",(function(e,t){function r(e,t){for(var n,r,a=this,i=[a],o=-1;a=i.pop();)if(e.call(t,a,++o,this),n=a.children)for(r=n.length-1;r>=0;--r)i.push(n[r]);return this}n(e.exports,"default",(function(){return r}))})),s.register("cBbLn",(function(e,t){function r(e,t){for(var n,r,a,i=this,o=[i],u=[],s=-1;i=o.pop();)if(u.push(i),n=i.children)for(r=0,a=n.length;r<a;++r)o.push(n[r]);for(;i=u.pop();)e.call(t,i,++s,this);return this}n(e.exports,"default",(function(){return r}))})),s.register("310LK",(function(e,t){function r(e,t){var n=-1,r=!0,a=!1,i=void 0;try{for(var o,u=this[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(e.call(t,s,++n,this))return s}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}n(e.exports,"default",(function(){return r}))})),s.register("bgDFa",(function(e,t){function r(e){return this.eachAfter((function(t){for(var n=+e(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)n+=r[a].value;t.value=n}))}n(e.exports,"default",(function(){return r}))})),s.register("jdPYF",(function(e,t){function r(e){return this.eachBefore((function(t){t.children&&t.children.sort(e)}))}n(e.exports,"default",(function(){return r}))})),s.register("cgsFC",(function(e,t){function r(e){for(var t=this,n=function(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),a=null;e=n.pop(),t=r.pop();for(;e===t;)a=e,e=n.pop(),t=r.pop();return a}(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var a=r.length;e!==n;)r.splice(a,0,e),e=e.parent;return r}n(e.exports,"default",(function(){return r}))})),s.register("l9Wpy",(function(e,t){function r(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}n(e.exports,"default",(function(){return r}))})),s.register("gpWSR",(function(e,t){function r(){return Array.from(this)}n(e.exports,"default",(function(){return r}))})),s.register("jc2LL",(function(e,t){function r(){var e=[];return this.eachBefore((function(t){t.children||e.push(t)})),e}n(e.exports,"default",(function(){return r}))})),s.register("4xdTB",(function(e,t){function r(){var e=this,t=[];return e.each((function(n){n!==e&&t.push({source:n.parent,target:n})})),t}n(e.exports,"default",(function(){return r}))})),s.register("fGems",(function(e,r){n(e.exports,"default",(function(){return i}));var a=s("40Zzs");function i(){var e,n,r,o,u,s;return t(a).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[e=this];case 1:n=r.reverse(),r=[];case 2:if(!(e=n.pop())){t.next=8;break}return t.next=5,e;case 5:if(o=e.children)for(u=0,s=o.length;u<s;++u)r.push(o[u]);t.next=2;break;case 8:if(r.length){t.next=1;break}case 9:case"end":return t.stop()}}),i,this)}})),s.register("2sA6A",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("lJyMx"),a=s("9GZn0"),i=s("vLu7m");function o(e){return Math.sqrt(e.value)}function u(){var e=null,t=1,n=1,r=i.constantZero;function u(a){return a.x=t/2,a.y=n/2,e?a.eachBefore(c(e)).eachAfter(l(r,.5)).eachBefore(f(1)):a.eachBefore(c(o)).eachAfter(l(i.constantZero,1)).eachAfter(l(r,a.r/Math.min(t,n))).eachBefore(f(Math.min(t,n)/(2*a.r))),a}return u.radius=function(t){return arguments.length?(e=a.optional(t),u):e},u.size=function(e){return arguments.length?(t=+e[0],n=+e[1],u):[t,n]},u.padding=function(e){return arguments.length?(r="function"==typeof e?e:i.default(+e),u):r},u}function c(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function l(e,t){return function(n){if(a=n.children){var a,i,o,u=a.length,s=e(n)*t||0;if(s)for(i=0;i<u;++i)a[i].r+=s;if(o=r.packEnclose(a),s)for(i=0;i<u;++i)a[i].r-=s;n.r=o+s}}}function f(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}})),s.register("lJyMx",(function(e,t){n(e.exports,"packEnclose",(function(){return l}));var r=s("4n3Cc"),a=s("6YOOR");function i(e,t,n){var r,a,i,o,u=e.x-t.x,s=e.y-t.y,c=u*u+s*s;c?(a=t.r+n.r,a*=a,o=e.r+n.r,a>(o*=o)?(r=(c+o-a)/(2*c),i=Math.sqrt(Math.max(0,o/c-r*r)),n.x=e.x-r*u-i*s,n.y=e.y-r*s+i*u):(r=(c+a-o)/(2*c),i=Math.sqrt(Math.max(0,a/c-r*r)),n.x=t.x+r*u-i*s,n.y=t.y+r*s+i*u)):(n.x=t.x+n.r,n.y=t.y)}function o(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function u(e){var t=e._,n=e.next._,r=t.r+n.r,a=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return a*a+i*i}function c(e){this._=e,this.next=null,this.previous=null}function l(e){if(!(l=(e=r.default(e)).length))return 0;var t,n,s,l,f,d,p,h,v,g,m;if((t=e[0]).x=0,t.y=0,!(l>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(l>2))return t.r+n.r;i(n,t,s=e[2]),t=new c(t),n=new c(n),s=new c(s),t.next=s.previous=n,n.next=t.previous=s,s.next=n.previous=t;e:for(p=3;p<l;++p){i(t._,n._,s=e[p]),s=new c(s),h=n.next,v=t.previous,g=n._.r,m=t._.r;do{if(g<=m){if(o(h._,s._)){n=h,t.next=n,n.previous=t,--p;continue e}g+=h._.r,h=h.next}else{if(o(v._,s._)){(t=v).next=n,n.previous=t,--p;continue e}m+=v._.r,v=v.previous}}while(h!==v.next);for(s.previous=t,s.next=n,t.next=n.previous=n=s,f=u(t);(s=s.next)!==n;)(d=u(s))<f&&(t=s,f=d);n=t.next}for(t=[n._],s=n;(s=s.next)!==n;)t.push(s._);for(s=a.default(t),p=0;p<l;++p)(t=e[p]).x-=s.x,t.y-=s.y;return s.r}})),s.register("4n3Cc",(function(e,t){function r(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function a(e){for(var t,n,r=e.length;r;)n=Math.random()*r--|0,t=e[r],e[r]=e[n],e[n]=t;return e}n(e.exports,"default",(function(){return r})),n(e.exports,"shuffle",(function(){return a}))})),s.register("6YOOR",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("4n3Cc");function a(e){for(var t,n,a=0,o=(e=r.shuffle(Array.from(e))).length,s=[];a<o;)t=e[a],n&&u(n,t)?++a:(n=l(s=i(s,t)),a=0);return n}function i(e,t){var n,r;if(c(t,e))return[t];for(n=0;n<e.length;++n)if(o(t,e[n])&&c(f(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(o(f(e[n],e[r]),t)&&o(f(e[n],t),e[r])&&o(f(e[r],t),e[n])&&c(d(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function o(e,t){var n=e.r-t.r,r=t.x-e.x,a=t.y-e.y;return n<0||n*n<r*r+a*a}function u(e,t){var n=e.r-t.r+1e-9*Math.max(e.r,t.r,1),r=t.x-e.x,a=t.y-e.y;return n>0&&n*n>r*r+a*a}function c(e,t){for(var n=0;n<t.length;++n)if(!u(e,t[n]))return!1;return!0}function l(e){switch(e.length){case 1:return{x:(t=e[0]).x,y:t.y,r:t.r};case 2:return f(e[0],e[1]);case 3:return d(e[0],e[1],e[2])}var t}function f(e,t){var n=e.x,r=e.y,a=e.r,i=t.x,o=t.y,u=t.r,s=i-n,c=o-r,l=u-a,f=Math.sqrt(s*s+c*c);return{x:(n+i+s/f*l)/2,y:(r+o+c/f*l)/2,r:(f+a+u)/2}}function d(e,t,n){var r=e.x,a=e.y,i=e.r,o=t.x,u=t.y,s=t.r,c=n.x,l=n.y,f=n.r,d=r-o,p=r-c,h=a-u,v=a-l,g=s-i,m=f-i,y=r*r+a*a-i*i,x=y-o*o-u*u+s*s,b=y-c*c-l*l+f*f,k=p*h-d*v,w=(h*b-v*x)/(2*k)-r,A=(v*g-h*m)/k,E=(p*x-d*b)/(2*k)-a,C=(d*m-p*g)/k,S=A*A+C*C-1,N=2*(i+w*A+E*C),T=w*w+E*E-i*i,D=-(S?(N+Math.sqrt(N*N-4*S*T))/(2*S):T/N);return{x:r+w+A*D,y:a+E+C*D,r:D}}})),s.register("9GZn0",(function(e,t){function r(e){return null==e?null:a(e)}function a(e){if("function"!=typeof e)throw new Error;return e}n(e.exports,"optional",(function(){return r})),n(e.exports,"required",(function(){return a}))})),s.register("vLu7m",(function(e,t){function r(){return 0}function a(e){return function(){return e}}n(e.exports,"constantZero",(function(){return r})),n(e.exports,"default",(function(){return a}))})),s.register("2A6hC",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("8ihYS"),a=s("9rn22");function i(){var e=1,t=1,n=0,i=!1;function o(o){var u=o.height+1;return o.x0=o.y0=n,o.x1=e,o.y1=t/u,o.eachBefore(function(e,t){return function(r){r.children&&a.default(r,r.x0,e*(r.depth+1)/t,r.x1,e*(r.depth+2)/t);var i=r.x0,o=r.y0,u=r.x1-n,s=r.y1-n;u<i&&(i=u=(i+u)/2),s<o&&(o=s=(o+s)/2),r.x0=i,r.y0=o,r.x1=u,r.y1=s}}(t,u)),i&&o.eachBefore(r.default),o}return o.round=function(e){return arguments.length?(i=!!e,o):i},o.size=function(n){return arguments.length?(e=+n[0],t=+n[1],o):[e,t]},o.padding=function(e){return arguments.length?(n=+e,o):n},o}})),s.register("8ihYS",(function(e,t){function r(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}n(e.exports,"default",(function(){return r}))})),s.register("9rn22",(function(e,t){function r(e,t,n,r,a){for(var i,o=e.children,u=-1,s=o.length,c=e.value&&(r-t)/e.value;++u<s;)(i=o[u]).y0=n,i.y1=a,i.x0=t,i.x1=t+=i.value*c}n(e.exports,"default",(function(){return r}))})),s.register("ezRG1",(function(e,t){n(e.exports,"default",(function(){return l}));var r=s("9GZn0"),a=s("1Tr5E"),i={depth:-1},o={};function u(e){return e.id}function c(e){return e.parentId}function l(){var e=u,t=c;function n(n){var r,u,s,c,l,f,d,p=Array.from(n),h=p.length,v=new Map;for(u=0;u<h;++u)r=p[u],l=p[u]=new a.Node(r),null!=(f=e(r,u,n))&&(f+="")&&(d=l.id=f,v.set(d,v.has(d)?o:l)),null!=(f=t(r,u,n))&&(f+="")&&(l.parent=f);for(u=0;u<h;++u)if(f=(l=p[u]).parent){if(!(c=v.get(f)))throw new Error("missing: "+f);if(c===o)throw new Error("ambiguous: "+f);c.children?c.children.push(l):c.children=[l],l.parent=c}else{if(s)throw new Error("multiple roots");s=l}if(!s)throw new Error("no root");if(s.parent=i,s.eachBefore((function(e){e.depth=e.parent.depth+1,--h})).eachBefore(a.computeHeight),s.parent=null,h>0)throw new Error("cycle");return s}return n.id=function(t){return arguments.length?(e=r.required(t),n):e},n.parentId=function(e){return arguments.length?(t=r.required(e),n):t},n}})),s.register("liUq3",(function(e,t){n(e.exports,"default",(function(){return f}));var r=s("1Tr5E");function a(e,t){return e.parent===t.parent?1:2}function i(e){var t=e.children;return t?t[0]:e.t}function o(e){var t=e.children;return t?t[t.length-1]:e.t}function u(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function c(e,t,n){return e.a.parent===t.parent?e.a:n}function l(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}function f(){var e=a,t=1,n=1,r=null;function s(a){var i=function(e){for(var t,n,r,a,i,o=new l(e,0),u=[o];t=u.pop();)if(r=t._.children)for(t.children=new Array(i=r.length),a=i-1;a>=0;--a)u.push(n=t.children[a]=new l(r[a],a)),n.parent=t;return(o.parent=new l(null,0)).children=[o],o}(a);if(i.eachAfter(f),i.parent.m=-i.z,i.eachBefore(d),r)a.eachBefore(p);else{var o=a,u=a,s=a;a.eachBefore((function(e){e.x<o.x&&(o=e),e.x>u.x&&(u=e),e.depth>s.depth&&(s=e)}));var c=o===u?1:e(o,u)/2,h=c-o.x,v=t/(u.x+c+h),g=n/(s.depth||1);a.eachBefore((function(e){e.x=(e.x+h)*v,e.y=e.depth*g}))}return a}function f(t){var n=t.children,r=t.parent.children,a=t.i?r[t.i-1]:null;if(n){!function(e){for(var t,n=0,r=0,a=e.children,i=a.length;--i>=0;)(t=a[i]).z+=n,t.m+=n,n+=t.s+(r+=t.c)}(t);var s=(n[0].z+n[n.length-1].z)/2;a?(t.z=a.z+e(t._,a._),t.m=t.z-s):t.z=s}else a&&(t.z=a.z+e(t._,a._));t.parent.A=function(t,n,r){if(n){for(var a,s=t,l=t,f=n,d=s.parent.children[0],p=s.m,h=l.m,v=f.m,g=d.m;f=o(f),s=i(s),f&&s;)d=i(d),(l=o(l)).a=t,(a=f.z+v-s.z-p+e(f._,s._))>0&&(u(c(f,t,r),t,a),p+=a,h+=a),v+=f.m,p+=s.m,g+=d.m,h+=l.m;f&&!o(l)&&(l.t=f,l.m+=v-h),s&&!i(d)&&(d.t=s,d.m+=p-g,r=t)}return r}(t,a,t.parent.A||r[0])}function d(e){e._.x=e.z+e.parent.m,e.m+=e.parent.m}function p(e){e.x*=t,e.y=e.depth*n}return s.separation=function(t){return arguments.length?(e=t,s):e},s.size=function(e){return arguments.length?(r=!1,t=+e[0],n=+e[1],s):r?null:[t,n]},s.nodeSize=function(e){return arguments.length?(r=!0,t=+e[0],n=+e[1],s):r?[t,n]:null},s}l.prototype=Object.create(r.Node.prototype)})),s.register("6l8AR",(function(e,t){n(e.exports,"default",(function(){return u}));var r=s("8ihYS"),a=s("7nCpL"),i=s("9GZn0"),o=s("vLu7m");function u(){var e=a.default,t=!1,n=1,u=1,s=[0],c=o.constantZero,l=o.constantZero,f=o.constantZero,d=o.constantZero,p=o.constantZero;function h(e){return e.x0=e.y0=0,e.x1=n,e.y1=u,e.eachBefore(v),s=[0],t&&e.eachBefore(r.default),e}function v(t){var n=s[t.depth],r=t.x0+n,a=t.y0+n,i=t.x1-n,o=t.y1-n;i<r&&(r=i=(r+i)/2),o<a&&(a=o=(a+o)/2),t.x0=r,t.y0=a,t.x1=i,t.y1=o,t.children&&(n=s[t.depth+1]=c(t)/2,r+=p(t)-n,a+=l(t)-n,(i-=f(t)-n)<r&&(r=i=(r+i)/2),(o-=d(t)-n)<a&&(a=o=(a+o)/2),e(t,r,a,i,o))}return h.round=function(e){return arguments.length?(t=!!e,h):t},h.size=function(e){return arguments.length?(n=+e[0],u=+e[1],h):[n,u]},h.tile=function(t){return arguments.length?(e=i.required(t),h):e},h.padding=function(e){return arguments.length?h.paddingInner(e).paddingOuter(e):h.paddingInner()},h.paddingInner=function(e){return arguments.length?(c="function"==typeof e?e:o.default(+e),h):c},h.paddingOuter=function(e){return arguments.length?h.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):h.paddingTop()},h.paddingTop=function(e){return arguments.length?(l="function"==typeof e?e:o.default(+e),h):l},h.paddingRight=function(e){return arguments.length?(f="function"==typeof e?e:o.default(+e),h):f},h.paddingBottom=function(e){return arguments.length?(d="function"==typeof e?e:o.default(+e),h):d},h.paddingLeft=function(e){return arguments.length?(p="function"==typeof e?e:o.default(+e),h):p},h}})),s.register("7nCpL",(function(e,t){n(e.exports,"phi",(function(){return i})),n(e.exports,"squarifyRatio",(function(){return o})),n(e.exports,"default",(function(){return u}));var r=s("9rn22"),a=s("4VRoJ"),i=(1+Math.sqrt(5))/2;function o(e,t,n,i,o,u){for(var s,c,l,f,d,p,h,v,g,m,y,x=[],b=t.children,k=0,w=0,A=b.length,E=t.value;k<A;){l=o-n,f=u-i;do{d=b[w++].value}while(!d&&w<A);for(p=h=d,y=d*d*(m=Math.max(f/l,l/f)/(E*e)),g=Math.max(h/y,y/p);w<A;++w){if(d+=c=b[w].value,c<p&&(p=c),c>h&&(h=c),y=d*d*m,(v=Math.max(h/y,y/p))>g){d-=c;break}g=v}x.push(s={value:d,dice:l<f,children:b.slice(k,w)}),s.dice?r.default(s,n,i,o,E?i+=f*d/E:u):a.default(s,n,i,E?n+=l*d/E:o,u),E-=d,k=w}return x}var u=function e(t){function n(e,n,r,a,i){o(t,e,n,r,a,i)}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(i)})),s.register("4VRoJ",(function(e,t){function r(e,t,n,r,a){for(var i,o=e.children,u=-1,s=o.length,c=e.value&&(a-n)/e.value;++u<s;)(i=o[u]).x0=t,i.x1=r,i.y0=n,i.y1=n+=i.value*c}n(e.exports,"default",(function(){return r}))})),s.register("6LaYX",(function(e,t){function r(e,t,n,r,a){var i,o,u=e.children,s=u.length,c=new Array(s+1);for(c[0]=o=i=0;i<s;++i)c[i+1]=o+=u[i].value;!function e(t,n,r,a,i,o,s){if(t>=n-1){var l=u[t];return l.x0=a,l.y0=i,l.x1=o,void(l.y1=s)}var f=c[t],d=r/2+f,p=t+1,h=n-1;for(;p<h;){var v=p+h>>>1;c[v]<d?p=v+1:h=v}d-c[p-1]<c[p]-d&&t+1<p&&--p;var g=c[p]-f,m=r-g;if(o-a>s-i){var y=r?(a*m+o*g)/r:o;e(t,p,g,a,i,y,s),e(p,n,m,y,i,o,s)}else{var x=r?(i*m+s*g)/r:s;e(t,p,g,a,i,o,x),e(p,n,m,a,x,o,s)}}(0,s,e.value,t,n,r,a)}n(e.exports,"default",(function(){return r}))})),s.register("eVDvN",(function(e,t){n(e.exports,"default",(function(){return i}));var r=s("9rn22"),a=s("4VRoJ");function i(e,t,n,i,o){(1&e.depth?a.default:r.default)(e,t,n,i,o)}})),s.register("bELYn",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("9rn22"),a=s("4VRoJ"),i=s("7nCpL"),o=function e(t){function n(e,n,o,u,s){if((c=e._squarify)&&c.ratio===t)for(var c,l,f,d,p,h=-1,v=c.length,g=e.value;++h<v;){for(f=(l=c[h]).children,d=l.value=0,p=f.length;d<p;++d)l.value+=f[d].value;l.dice?r.default(l,n,o,u,g?o+=(s-o)*l.value/g:s):a.default(l,n,o,g?n+=(u-n)*l.value/g:u,s),g-=l.value}else e._squarify=c=i.squarifyRatio(t,e,n,o,u,s),c.ratio=t}return n.ratio=function(t){return e((t=+t)>1?t:1)},n}(i.phi)})),s.register("8HbfX",(function(e,t){n(e.exports,"label",(function(){return D})),s("1i51P");var r=s("6vecG");s("juhb3");var a=s("a3wIG"),i=s("euljU"),o=s("aVGvL"),u=s("caNzv");function c(e,t,n,r){var i=e.width,o=e.height,u=n||r,s=a.domCanvas(i,o).getContext("2d");t.forEach((function(e){return l(s,e,u)}));var c,f,d,p,h,v=new Uint32Array(s.getImageData(0,0,i,o).data.buffer),g=e.bitmap(),m=u&&e.bitmap();for(f=0;f<o;++f)for(c=0;c<i;++c)(h=4278190080&v[f*i+c])&&(d=e(c),p=e(f),r||g.set(d,p),u&&268435456^h&&m.set(d,p));return[g,m]}function l(e,t,n){if(t.length){var r=t[0].mark.marktype;"group"===r?t.forEach((function(t){t.items.forEach((function(t){return l(e,t.items,n)}))})):o.Marks[r].draw(e,{items:n?t.map(f):t})}}function f(e){var t=i.rederive(e,{});return t.stroke&&(t.strokeOpacity=1),t.fill&&(t.fillOpacity=.0625,t.stroke="#000",t.strokeOpacity=1,t.strokeWidth=2),t}var d=31,p=new Uint32Array(33),h=new Uint32Array(33);h[0]=0,p[0]=~h[0];for(var v=1;v<=32;++v)h[v]=h[v-1]<<1|1,p[v]=~h[v];function g(e,t,n){var r=Math.max(1,Math.sqrt(e*t/1e6)),a=~~((e+2*n+r)/r),i=~~((t+2*n+r)/r),o=function(e){return~~((e+n)/r)};return o.invert=function(e){return e*r-n},o.bitmap=function(){return function(e,t){var n=new Uint32Array(~~((e*t+32)/32));function r(e,t){n[e]|=t}function a(e,t){n[e]&=t}return{array:n,get:function(t,r){var a=r*e+t;return n[a>>>5]&1<<(a&d)},set:function(t,n){var a=n*e+t;r(a>>>5,1<<(a&d))},clear:function(t,n){var r=n*e+t;a(r>>>5,~(1<<(r&d)))},getRange:function(t,r,a,i){for(var o,u,s,c,l=i;l>=r;--l)if((s=(o=l*e+t)>>>5)==(c=(u=l*e+a)>>>5)){if(n[s]&p[o&d]&h[1+(u&d)])return!0}else{if(n[s]&p[o&d])return!0;if(n[c]&h[1+(u&d)])return!0;for(var f=s+1;f<c;++f)if(n[f])return!0}return!1},setRange:function(t,n,a,i){for(var o,u,s,c,l;n<=i;++n)if((s=(o=n*e+t)>>>5)==(c=(u=n*e+a)>>>5))r(s,p[o&d]&h[1+(u&d)]);else for(r(s,p[o&d]),r(c,h[1+(u&d)]),l=s+1;l<c;++l)r(l,4294967295)},clearRange:function(t,n,r,i){for(var o,u,s,c,l;n<=i;++n)if((s=(o=n*e+t)>>>5)==(c=(u=n*e+r)>>>5))a(s,h[o&d]|p[1+(u&d)]);else for(a(s,h[o&d]),a(c,p[1+(u&d)]),l=s+1;l<c;++l)a(l,0)},outOfBounds:function(n,r,a,i){return n<0||r<0||i>=t||a>=e}}}(a,i)},o.ratio=r,o.padding=n,o.width=e,o.height=t,o}function m(e,t,n,r,a,i){var o=n/2;return e-o<0||e+o>a||t-(o=r/2)<0||t+o>i}function y(e,t,n,r,a,i,o,u){var s=a*i/(2*r),c=e(t-s),l=e(t+s),f=e(n-(i/=2)),d=e(n+i);return o.outOfBounds(c,f,l,d)||o.getRange(c,f,l,d)||u&&u.getRange(c,f,l,d)}var x=[-1,-1,1,1],b=[-1,1,-1,1];var k=["right","center","left"],w=["bottom","middle","top"];function A(e,t,n,r,a,i,o,u,s,c,l,f){return!(a.outOfBounds(e,n,t,r)||(f&&i?i.getRange(e,n,t,r)||!function(e,t,n,r,a){return a[0]<=e&&n<=a[2]&&a[3]<=t&&r<=a[5]}(o,s,u,c,l):a.getRange(e,n,t,r)))}var E={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},C={naive:function(e,t,n,r){var a=e.width,i=e.height;return function(e){for(var t,n,u,s,c,l,f,d=e.datum.datum.items[r].items,p=d.length,h=e.datum.fontSize,v=o.textMetrics.width(e.datum,e.datum.text),g=0,m=0;m<p;++m)t=d[m].x,u=d[m].y,c=(t+(n=void 0===d[m].x2?t:d[m].x2))/2,l=(u+(s=void 0===d[m].y2?u:d[m].y2))/2,(f=Math.abs(n-t+s-u))>=g&&(g=f,e.x=c,e.y=l);return c=v/2,l=h/2,t=e.x-c,n=e.x+c,u=e.y-l,s=e.y+l,e.align="center",t<0&&n<=a?e.align="left":0<=t&&a<n&&(e.align="right"),e.baseline="middle",u<0&&s<=i?e.baseline="top":0<=u&&i<s&&(e.baseline="bottom"),!0}},"reduced-search":function(e,t,n,a){var i=e.width,u=e.height,s=t[0],c=t[1];function l(t,n,r,a,o){var l,f=e.invert(t),d=e.invert(n),p=r,h=u;if(!m(f,d,a,o,i,u)&&!y(e,f,d,o,a,p,s,c)&&!y(e,f,d,o,a,o,s,null)){for(;h-p>=1;)y(e,f,d,o,a,l=(p+h)/2,s,c)?h=l:p=l;if(p>r)return[f,d,p,!0]}}return function(t){for(var c,f,d,p,h,v,g,x,b,k,w,A,E,C,S,N,T,D=t.datum.datum.items[a].items,F=D.length,O=t.datum.fontSize,_=o.textMetrics.width(t.datum,t.datum.text),I=n?O:0,R=!1,M=!1,B=0,P=0;P<F;++P){for(c=D[P].x,d=D[P].y,c>(f=void 0===D[P].x2?c:D[P].x2)&&(T=c,c=f,f=T),d>(p=void 0===D[P].y2?d:D[P].y2)&&(T=d,d=p,p=T),k=~~(((b=e(c))+(w=e(f)))/2),E=~~(((A=e(d))+(C=e(p)))/2),g=k;g>=b;--g)for(x=E;x>=A;--x){var L;(N=l(g,x,I,_,O))&&(L=r.default(N,4),t.x=L[0],t.y=L[1],I=L[2],R=L[3])}for(g=k;g<=w;++g)for(x=E;x<=C;++x){var j;(N=l(g,x,I,_,O))&&(j=r.default(N,4),t.x=j[0],t.y=j[1],I=j[2],R=j[3])}R||n||(h=(c+f)/2,v=(d+p)/2,(S=Math.abs(f-c+p-d))>=B&&!m(h,v,_,O,i,u)&&!y(e,h,v,O,_,O,s,null)&&(B=S,t.x=h,t.y=v,M=!0))}return!(!R&&!M)&&(h=_/2,v=O/2,s.setRange(e(t.x-h),e(t.y-v),e(t.x+h),e(t.y+v)),t.align="center",t.baseline="middle",!0)}},floodfill:function(e,t,n,a){var i=e.width,u=e.height,s=t[0],c=t[1],l=e.bitmap();return function(t){for(var f,d,p,h,v,g,k,w,A,E,C,S,N=t.datum.datum.items[a].items,T=N.length,D=t.datum.fontSize,F=o.textMetrics.width(t.datum,t.datum.text),O=[],_=n?D:0,I=!1,R=!1,M=0,B=0;B<T;++B){for(f=N[B].x,p=N[B].y,d=void 0===N[B].x2?f:N[B].x2,h=void 0===N[B].y2?p:N[B].y2,O.push([e((f+d)/2),e((p+h)/2)]);O.length;){var P;if(k=(P=r.default(O.pop(),2))[0],w=P[1],!(s.get(k,w)||c.get(k,w)||l.get(k,w))){l.set(k,w);for(var L=0;L<4;++L)v=k+x[L],g=w+b[L],l.outOfBounds(v,g,v,g)||O.push([v,g]);if(v=e.invert(k),g=e.invert(w),A=_,E=u,!m(v,g,F,D,i,u)&&!y(e,v,g,D,F,A,s,c)&&!y(e,v,g,D,F,D,s,null)){for(;E-A>=1;)y(e,v,g,D,F,C=(A+E)/2,s,c)?E=C:A=C;A>_&&(t.x=v,t.y=g,_=A,I=!0)}}}I||n||(v=(f+d)/2,g=(p+h)/2,(S=Math.abs(d-f+h-p))>=M&&!m(v,g,F,D,i,u)&&!y(e,v,g,D,F,D,s,null)&&(M=S,t.x=v,t.y=g,R=!0))}return!(!I&&!R)&&(v=F/2,g=D/2,s.setRange(e(t.x-v),e(t.y-g),e(t.x+v),e(t.y+g)),t.align="center",t.baseline="middle",!0)}}};function S(e,t,n,r,a,i,u,s,l,f,d){if(!e.length)return e;var p,h,v=Math.max(r.length,a.length),m=function(e,t){for(var n=new Float64Array(t),r=e.length,a=0;a<r;++a)n[a]=e[a]||0;for(var i=r;i<t;++i)n[i]=n[r-1];return n}(r,v),y=function(e,t){for(var n=new Int8Array(t),r=e.length,a=0;a<r;++a)n[a]|=E[e[a]];for(var i=r;i<t;++i)n[i]=n[r-1];return n}(a,v),x=(p=e[0].datum)&&p.mark&&p.mark.marktype,b="group"===x&&e[0].datum.items[l].marktype,S="area"===b,N=function(e,t,n,r){var a=function(e){return[e.x,e.x,e.x,e.y,e.y,e.y]};return e?"line"===e||"area"===e?function(e){return a(e.datum)}:"line"===t?function(e){var t=e.datum.items[r].items;return a(t.length?t["start"===n?0:t.length-1]:{x:NaN,y:NaN})}:function(e){var t=e.datum.bounds;return[t.x1,(t.x1+t.x2)/2,t.x2,t.y1,(t.y1+t.y2)/2,t.y2]}:a}(x,b,s,l),T=g(t[0],t[1],f),D=S&&"naive"===d,F=e.map((function(e){return{datum:e,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:N(e)}}));if(!D){n&&F.sort((function(e,t){return n(e.datum,t.datum)}));for(var O=!1,_=0;_<y.length&&!O;++_)O=5===y[_]||m[_]<0;x&&(u||S)&&(i=[e.map((function(e){return e.datum}))].concat(i)),h=i.length?c(T,i,O,S):function(e,t){var n=e.bitmap();return(t||[]).forEach((function(t){return n.set(e(t.boundary[0]),e(t.boundary[3]))})),[n,void 0]}(T,u&&F)}var I=S?C[d](T,h,u,l):function(e,t,n,r){var a=e.width,i=e.height,u=t[0],s=t[1],c=r.length;return function(t){var l=t.boundary,f=t.datum.fontSize;if(l[2]<0||l[5]<0||l[0]>a||l[3]>i)return!1;for(var d,p,h,v,g,m,y,x,b,E,C,S,N,T,D,F=0,O=0;O<c;++O){if(d=(3&n[O])-1,p=(n[O]>>>2&3)-1,h=0===d&&0===p||r[O]<0,v=d&&p?Math.SQRT1_2:1,g=r[O]<0?-1:1,m=l[1+d]+r[O]*d*v,x=(C=l[4+p]+g*f*p/2+r[O]*p*v)-f/2,b=C+f/2,S=e(m),T=e(x),D=e(b),!F){if(!A(S,S,T,D,u,s,m,m,x,b,l,h))continue;F=o.textMetrics.width(t.datum,t.datum.text)}if(y=(E=m+g*F*d/2)+F/2,A(S=e(m=E-F/2),N=e(y),T,D,u,s,m,y,x,b,l,h))return t.x=d?d*g<0?y:m:E,t.y=p?p*g<0?b:x:C,t.align=k[d*g+1],t.baseline=w[p*g+1],u.setRange(S,T,N,D),!0}return!1}}(T,h,y,m);return F.forEach((function(e){return e.opacity=+I(e)})),F}var N=["x","y","opacity","align","baseline"],T=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function D(e){i.Transform.call(this,null,e)}D.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:T},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:N.length,default:N}]},u.inherits(D,i.Transform,{transform:function(e,t){var n=e.modified();if(n||t.changed(t.ADD_REM)||(r=e["sort"],u.isFunction(r)&&t.modified(r.fields))){var r;e.size&&2===e.size.length||u.error("Size parameter should be specified as a [width, height] array.");var a=e.as||N;return S(t.materialize(t.SOURCE).source,e.size,e.sort,u.array(e.offset||1),u.array(e.anchor||T),e.avoidMarks||[],!1!==e.avoidBaseMark,e.lineAnchor||"end",e.markIndex||0,e.padding||0,e.method||"naive").forEach((function(e){var t=e.datum;t[a[0]]=e.x,t[a[1]]=e.y,t[a[2]]=e.opacity,t[a[3]]=e.align,t[a[4]]=e.baseline})),t.reflow(n).modifies(a)}}})})),s.register("l9F60",(function(e,t){n(e.exports,"loess",(function(){return u})),n(e.exports,"regression",(function(){return l}));var r=s("3okBY"),a=s("euljU"),i=s("caNzv");function o(e,t){var n,r,a,i,o,u,s=[],c=function(e){return e(i)};if(null==t)s.push(e);else for(n={},r=0,a=e.length;r<a;++r)i=e[r],(u=n[o=t.map(c)])||(n[o]=u=[],u.dims=o,s.push(u)),u.push(i);return s}function u(e){a.Transform.call(this,null,e)}u.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},i.inherits(u,a.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var u=o(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(i.accessorName),c=s.length,l=e.as||[i.accessorName(e.x),i.accessorName(e.y)],f=[];u.forEach((function(t){r.regressionLoess(t,e.x,e.y,e.bandwidth||.3).forEach((function(e){for(var n={},r=0;r<c;++r)n[s[r]]=t.dims[r];n[l[0]]=e[0],n[l[1]]=e[1],f.push(a.ingest(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=f}return n}});var c={linear:r.regressionLinear,log:r.regressionLog,exp:r.regressionExp,pow:r.regressionPow,quad:r.regressionQuad,poly:r.regressionPoly};function l(e){a.Transform.call(this,null,e)}l.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(c)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},i.inherits(l,a.Transform,{transform:function(e,t){var n=t.fork(t.NO_SOURCE|t.NO_FIELDS);if(!this.value||t.changed()||e.modified()){var u=o(t.materialize(t.SOURCE).source,e.groupby),s=(e.groupby||[]).map(i.accessorName),l=e.method||"linear",f=e.order||3,d=function(e,t){return"poly"===e?t:"quad"===e?2:1}(l,f),p=e.as||[i.accessorName(e.x),i.accessorName(e.y)],h=c[l],v=[],g=e.extent;i.hasOwnProperty(c,l)||i.error("Invalid regression method: "+l),null!=g&&"log"===l&&g[0]<=0&&(t.dataflow.warn("Ignoring extent with values <= 0 for log regression."),g=null),u.forEach((function(n){if(n.length<=d)t.dataflow.warn("Skipping regression with more parameters than data points.");else{var o=h(n,e.x,e.y,f);if(e.params)v.push(a.ingest({keys:n.dims,coef:o.coef,rSquared:o.rSquared}));else{var u=g||i.extent(n,e.x),c=function(e){for(var t={},r=0;r<s.length;++r)t[s[r]]=n.dims[r];t[p[0]]=e[0],t[p[1]]=e[1],v.push(a.ingest(t))};"linear"===l?u.forEach((function(e){return c([e,o.predict(e)])})):r.sampleCurve(o.predict,u,25,200).forEach(c)}}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=v}return n}})})),s.register("lRAno",(function(e,t){n(e.exports,"voronoi",(function(){return o}));var r=s("euljU"),a=s("caNzv"),i=s("eZwRl");function o(e){r.Transform.call(this,null,e)}o.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};var u=[-1e5,-1e5,1e5,1e5];function c(e){for(var t=e[0][0],n=e[0][1],r=e.length-1;e[r][0]===t&&e[r][1]===n;--r);return"M"+e.slice(0,r+1).join("L")+"Z"}a.inherits(o,r.Transform,{transform:function(e,t){var n=e.as||"path",r=t.source;if(!r||!r.length)return t;var a=e.size;a=a?[0,0,a[0],a[1]]:(a=e.extent)?[a[0][0],a[0][1],a[1][0],a[1][1]]:u;for(var o=this.value=i.default.from(r,e.x,e.y).voronoi(a),s=0,l=r.length;s<l;++s){var f=o.cellPolygon(s);r[s][n]=f?c(f):null}return t.reflow(e.modified()).modifies(n)}})})),s.register("eZwRl",(function(e,r){n(e.exports,"default",(function(){return y})),s("1i51P");var a=s("3QOYJ"),i=s("2tuUj"),o=s("40Zzs"),u=s("bL4Jg"),c=s("3RaMq"),l=s("g500X"),f=s("ehUZD"),d=t(o).mark(b),p=2*Math.PI,h=Math.pow;function v(e){return e[0]}function g(e){return e[1]}function m(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}var y=function(){"use strict";function e(t){a.default(this,e),this._delaunator=new u.default(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}return i.default(e,[{key:"update",value:function(){return this._delaunator.update(),this._init(),this}},{key:"_init",value:function(){var e=this._delaunator,t=this.points;if(e.hull&&e.hull.length>2&&function(e){for(var t=e.triangles,n=e.coords,r=0;r<t.length;r+=3){var a=2*t[r],i=2*t[r+1],o=2*t[r+2];if((n[o]-n[a])*(n[i+1]-n[a+1])-(n[i]-n[a])*(n[o+1]-n[a+1])>1e-10)return!1}return!0}(e)){this.collinear=Int32Array.from({length:t.length/2},(function(e,t){return t})).sort((function(e,n){return t[2*e]-t[2*n]||t[2*e+1]-t[2*n+1]}));for(var n=this.collinear[0],r=this.collinear[this.collinear.length-1],a=[t[2*n],t[2*n+1],t[2*r],t[2*r+1]],i=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]),o=0,s=t.length/2;o<s;++o){var c=m(t[2*o],t[2*o+1],i);t[2*o]=c[0],t[2*o+1]=c[1]}this._delaunator=new u.default(t)}else delete this.collinear;for(var l=this.halfedges=this._delaunator.halfedges,f=this.hull=this._delaunator.hull,d=this.triangles=this._delaunator.triangles,p=this.inedges.fill(-1),h=this._hullIndex.fill(-1),v=0,g=l.length;v<g;++v){var y=d[v%3==2?v-2:v+1];-1!==l[v]&&-1!==p[y]||(p[y]=v)}for(var x=0,b=f.length;x<b;++x)h[f[x]]=x;f.length<=2&&f.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=f[0],this.triangles[1]=f[1],this.triangles[2]=f[1],p[f[0]]=1,2===f.length&&(p[f[1]]=0))}},{key:"voronoi",value:function(e){return new f.default(this,e)}},{key:"neighbors",value:t(o).mark((function e(n){var r,a,i,u,s,c,l,f,d,p,h,v;return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(r=this).inedges,i=r.hull,u=r._hullIndex,s=r.halfedges,c=r.triangles,!(l=r.collinear)){e.next=10;break}if(!((f=l.indexOf(n))>0)){e.next=6;break}return e.next=6,l[f-1];case 6:if(!(f<l.length-1)){e.next=9;break}return e.next=9,l[f+1];case 9:return e.abrupt("return");case 10:if(-1!==(d=a[n])){e.next=13;break}return e.abrupt("return");case 13:p=d,h=-1;case 14:return e.next=16,h=c[p];case 16:if(c[p=p%3==2?p-2:p+1]===n){e.next=19;break}return e.abrupt("return");case 19:if(-1!==(p=s[p])){e.next=26;break}if((v=i[(u[n]+1)%i.length])===h){e.next=25;break}return e.next=25,v;case 25:return e.abrupt("return");case 26:if(p!==d){e.next=14;break}case 27:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!=e||(t=+t)!=t)return-1;for(var r,a=n;(r=this._step(n,e,t))>=0&&r!==n&&r!==a;)n=r;return r}},{key:"_step",value:function(e,t,n){var r=this,a=r.inedges,i=r.hull,o=r._hullIndex,u=r.halfedges,s=r.triangles,c=r.points;if(-1===a[e]||!c.length)return(e+1)%(c.length>>1);var l=e,f=h(t-c[2*e],2)+h(n-c[2*e+1],2),d=a[e],p=d;do{var v=s[p],g=h(t-c[2*v],2)+h(n-c[2*v+1],2);if(g<f&&(f=g,l=v),s[p=p%3==2?p-2:p+1]!==e)break;if(-1===(p=u[p])){if((p=i[(o[e]+1)%i.length])!==v&&h(t-c[2*p],2)+h(n-c[2*p+1],2)<f)return p;break}}while(p!==d);return l}},{key:"render",value:function(e){for(var t=null==e?e=new c.default:void 0,n=this,r=n.points,a=n.halfedges,i=n.triangles,o=0,u=a.length;o<u;++o){var s=a[o];if(!(s<o)){var l=2*i[o],f=2*i[s];e.moveTo(r[l],r[l+1]),e.lineTo(r[f],r[f+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new c.default:void 0,r=this.points,a=0,i=r.length;a<i;a+=2){var o=r[a],u=r[a+1];e.moveTo(o+t,u),e.arc(o,u,t,0,p)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new c.default:void 0,n=this.hull,r=this.points,a=2*n[0],i=n.length;e.moveTo(r[a],r[a+1]);for(var o=1;o<i;++o){var u=2*n[o];e.lineTo(r[u],r[u+1])}return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new l.default;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new c.default:void 0,r=this.points,a=this.triangles,i=2*a[e*=3],o=2*a[e+1],u=2*a[e+2];return t.moveTo(r[i],r[i+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[u],r[u+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:t(o).mark((function e(){var n,r,a;return t(o).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.triangles,r=0,a=n.length/3;case 2:if(!(r<a)){e.next=8;break}return e.next=5,this.trianglePolygon(r);case 5:++r,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new l.default;return this.renderTriangle(e,t),t.value()}}],[{key:"from",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g,a=arguments.length>3?arguments[3]:void 0;return new e("length"in t?x(t,n,r,a):Float64Array.from(b(t,n,r,a)))}}]),e}();function x(e,t,n,r){for(var a=e.length,i=new Float64Array(2*a),o=0;o<a;++o){var u=e[o];i[2*o]=t.call(r,u,o,e),i[2*o+1]=n.call(r,u,o,e)}return i}function b(e,n,r,a){var i,u,s,c,l,f,p;return t(o).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=0,u=!0,s=!1,c=void 0,t.prev=2,l=e[Symbol.iterator]();case 4:if(u=(f=l.next()).done){t.next=14;break}return p=f.value,t.next=8,n.call(a,p,i,e);case 8:return t.next=10,r.call(a,p,i,e);case 10:++i;case 11:u=!0,t.next=4;break;case 14:t.next=20;break;case 16:t.prev=16,t.t0=t.catch(2),s=!0,c=t.t0;case 20:t.prev=20,t.prev=21,u||null==l.return||l.return();case 23:if(t.prev=23,!s){t.next=26;break}throw c;case 26:return t.finish(23);case 27:return t.finish(20);case 28:case"end":return t.stop()}}),d,null,[[2,16,20,28],[21,,23,27]])}})),s.register("bL4Jg",(function(e,t){n(e.exports,"default",(function(){return u})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=Math.pow(2,-52),o=new Uint32Array(512),u=function(){"use strict";function e(t){r.default(this,e);var n=t.length>>1;if(n>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;var a=Math.max(2*n-5,0);this._triangles=new Uint32Array(3*a),this._halfedges=new Int32Array(3*a),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}return a.default(e,[{key:"update",value:function(){for(var e=this,t=e.coords,n=e._hullPrev,r=e._hullNext,a=e._hullTri,o=e._hullHash,u=t.length>>1,s=1/0,l=1/0,h=-1/0,v=-1/0,g=0;g<u;g++){var m=t[2*g],y=t[2*g+1];m<s&&(s=m),y<l&&(l=y),m>h&&(h=m),y>v&&(v=y),this._ids[g]=g}for(var x,b,k,w=(s+h)/2,A=(l+v)/2,E=1/0,C=0;C<u;C++){var S=c(w,A,t[2*C],t[2*C+1]);S<E&&(x=C,E=S)}var N=t[2*x],T=t[2*x+1];E=1/0;for(var D=0;D<u;D++)if(D!==x){var F=c(N,T,t[2*D],t[2*D+1]);F<E&&F>0&&(b=D,E=F)}for(var O=t[2*b],_=t[2*b+1],I=1/0,R=0;R<u;R++)if(R!==x&&R!==b){var M=d(N,T,O,_,t[2*R],t[2*R+1]);M<I&&(k=R,I=M)}var B=t[2*k],P=t[2*k+1];if(I===1/0){for(var L=0;L<u;L++)this._dists[L]=t[2*L]-t[0]||t[2*L+1]-t[1];p(this._ids,this._dists,0,u-1);for(var j=new Uint32Array(u),z=0,U=0,V=-1/0;U<u;U++){var W=this._ids[U];this._dists[W]>V&&(j[z++]=W,V=this._dists[W])}return this.hull=j.subarray(0,z),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(f(N,T,O,_,B,P)){var G=b,H=O,q=_;b=k,O=B,_=P,k=G,B=H,P=q}var J=function(e,t,n,r,a,i){var o=n-e,u=r-t,s=a-e,c=i-t,l=o*o+u*u,f=s*s+c*c,d=.5/(o*c-u*s);return{x:e+(c*l-u*f)*d,y:t+(o*f-s*l)*d}}(N,T,O,_,B,P);this._cx=J.x,this._cy=J.y;for(var K=0;K<u;K++)this._dists[K]=c(t[2*K],t[2*K+1],J.x,J.y);p(this._ids,this._dists,0,u-1),this._hullStart=x;var X=3;r[x]=n[k]=b,r[b]=n[x]=k,r[k]=n[b]=x,a[x]=0,a[b]=1,a[k]=2,o.fill(-1),o[this._hashKey(N,T)]=x,o[this._hashKey(O,_)]=b,o[this._hashKey(B,P)]=k,this.trianglesLen=0,this._addTriangle(x,b,k,-1,-1,-1);for(var Y,Q,Z=0;Z<this._ids.length;Z++){var $=this._ids[Z],ee=t[2*$],te=t[2*$+1];if(!(Z>0&&Math.abs(ee-Y)<=i&&Math.abs(te-Q)<=i)&&(Y=ee,Q=te,$!==x&&$!==b&&$!==k)){for(var ne=0,re=0,ae=this._hashKey(ee,te);re<this._hashSize&&(-1===(ne=o[(ae+re)%this._hashSize])||ne===r[ne]);re++);for(var ie=ne=n[ne],oe=void 0;oe=r[ie],!f(ee,te,t[2*ie],t[2*ie+1],t[2*oe],t[2*oe+1]);)if((ie=oe)===ne){ie=-1;break}if(-1!==ie){var ue=this._addTriangle(ie,$,r[ie],-1,-1,a[ie]);a[$]=this._legalize(ue+2),a[ie]=ue,X++;for(var se=r[ie];oe=r[se],f(ee,te,t[2*se],t[2*se+1],t[2*oe],t[2*oe+1]);)ue=this._addTriangle(se,$,oe,a[$],-1,a[se]),a[$]=this._legalize(ue+2),r[se]=se,X--,se=oe;if(ie===ne)for(;f(ee,te,t[2*(oe=n[ie])],t[2*oe+1],t[2*ie],t[2*ie+1]);)ue=this._addTriangle(oe,$,ie,-1,a[ie],a[oe]),this._legalize(ue+2),a[oe]=ue,r[ie]=ie,X--,ie=oe;this._hullStart=n[$]=ie,r[ie]=n[se]=$,r[$]=se,o[this._hashKey(ee,te)]=$,o[this._hashKey(t[2*ie],t[2*ie+1])]=ie}}}this.hull=new Uint32Array(X);for(var ce=0,le=this._hullStart;ce<X;ce++)this.hull[ce]=le,le=r[le];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}},{key:"_hashKey",value:function(e,t){return Math.floor((n=e-this._cx,r=t-this._cy,a=n/(Math.abs(n)+Math.abs(r)),(r>0?3-a:1+a)/4*this._hashSize))%this._hashSize;var n,r,a}},{key:"_legalize",value:function(e){for(var t,n,r,a,i,u,s,c,l,f,d,p,h,v,g,m,y=this,x=y._triangles,b=y._halfedges,k=y.coords,w=0,A=0;;){var E=b[e],C=e-e%3;if(A=C+(e+2)%3,-1!==E){var S=E-E%3,N=C+(e+1)%3,T=S+(E+2)%3,D=x[A],F=x[e],O=x[N],_=x[T];if(t=k[2*D],n=k[2*D+1],r=k[2*F],a=k[2*F+1],i=k[2*O],u=k[2*O+1],s=k[2*_],c=k[2*_+1],l=void 0,f=void 0,d=void 0,p=void 0,h=void 0,v=void 0,void 0,g=void 0,m=void 0,(l=t-s)*((p=a-c)*(m=(h=i-s)*h+(v=u-c)*v)-(g=(d=r-s)*d+p*p)*v)-(f=n-c)*(d*m-g*h)+(l*l+f*f)*(d*v-p*h)<0){x[e]=_,x[E]=D;var I=b[T];if(-1===I){var R=this._hullStart;do{if(this._hullTri[R]===T){this._hullTri[R]=e;break}R=this._hullPrev[R]}while(R!==this._hullStart)}this._link(e,I),this._link(E,b[A]),this._link(A,T);var M=S+(E+1)%3;w<o.length&&(o[w++]=M)}else{if(0===w)break;e=o[--w]}}else{if(0===w)break;e=o[--w]}}return A}},{key:"_link",value:function(e,t){this._halfedges[e]=t,-1!==t&&(this._halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,a,i){var o=this.trianglesLen;return this._triangles[o]=e,this._triangles[o+1]=t,this._triangles[o+2]=n,this._link(o,r),this._link(o+1,a),this._link(o+2,i),this.trianglesLen+=3,o}}],[{key:"from",value:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:g,a=t.length,i=new Float64Array(2*a),o=0;o<a;o++){var u=t[o];i[2*o]=n(u),i[2*o+1]=r(u)}return new e(i)}}]),e}();function c(e,t,n,r){var a=e-n,i=t-r;return a*a+i*i}function l(e,t,n,r,a,i){var o=(r-t)*(a-e),u=(n-e)*(i-t);return Math.abs(o-u)>=33306690738754716e-32*Math.abs(o+u)?o-u:0}function f(e,t,n,r,a,i){return(l(a,i,e,t,n,r)||l(e,t,n,r,a,i)||l(n,r,a,i,e,t))<0}function d(e,t,n,r,a,i){var o=n-e,u=r-t,s=a-e,c=i-t,l=o*o+u*u,f=s*s+c*c,d=.5/(o*c-u*s),p=(c*l-u*f)*d,h=(o*f-s*l)*d;return p*p+h*h}function p(e,t,n,r){if(r-n<=20)for(var a=n+1;a<=r;a++){for(var i=e[a],o=t[i],u=a-1;u>=n&&t[e[u]]>o;)e[u+1]=e[u--];e[u+1]=i}else{var s=n+1,c=r;h(e,n+r>>1,s),t[e[n]]>t[e[r]]&&h(e,n,r),t[e[s]]>t[e[r]]&&h(e,s,r),t[e[n]]>t[e[s]]&&h(e,n,s);for(var l=e[s],f=t[l];;){do{s++}while(t[e[s]]<f);do{c--}while(t[e[c]]>f);if(c<s)break;h(e,s,c)}e[n+1]=e[c],e[c]=l,r-s+1>=c-n?(p(e,t,s,r),p(e,t,n,c-1)):(p(e,t,n,c-1),p(e,t,s,r))}}function h(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e){return e[0]}function g(e){return e[1]}})),s.register("3RaMq",(function(e,t){n(e.exports,"default",(function(){return o})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=1e-6,o=function(){"use strict";function e(){r.default(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return a.default(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),a=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(a):(Math.abs(this._x1-r)>i||Math.abs(this._y1-a)>i)&&(this._+="L"+r+","+a),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=a))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}()})),s.register("g500X",(function(e,t){n(e.exports,"default",(function(){return i})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=function(){"use strict";function e(){r.default(this,e),this._=[]}return a.default(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}()})),s.register("ehUZD",(function(e,r){n(e.exports,"default",(function(){return f})),s("1i51P");var a=s("6vecG"),i=s("3QOYJ"),o=s("2tuUj"),u=s("40Zzs"),c=s("3RaMq"),l=s("g500X"),f=function(){"use strict";function e(t){var n=a.default(arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],4),r=n[0],o=n[1],u=n[2],s=n[3];if(i.default(this,e),!((u=+u)>=(r=+r)&&(s=+s)>=(o=+o)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=u,this.xmin=r,this.ymax=s,this.ymin=o,this._init()}return o.default(e,[{key:"update",value:function(){return this.delaunay.update(),this._init(),this}},{key:"_init",value:function(){for(var e,t,n=this.delaunay,r=n.points,a=n.hull,i=n.triangles,o=this.vectors,u=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2),s=0,c=0,l=i.length;s<l;s+=3,c+=2){var f=2*i[s],d=2*i[s+1],p=2*i[s+2],h=r[f],v=r[f+1],g=r[d],m=r[d+1],y=r[p],x=r[p+1],b=g-h,k=m-v,w=y-h,A=x-v,E=b*b+k*k,C=w*w+A*A,S=2*(b*A-k*w);if(S)if(Math.abs(S)<1e-8)e=(h+y)/2,t=(v+x)/2;else{var N=1/S;e=h+(A*E-k*C)*N,t=v+(b*C-w*E)*N}else e=(h+y)/2-1e8*A,t=(v+x)/2+1e8*w;u[c]=e,u[c+1]=t}var T,D,F,O=a[a.length-1],_=4*O,I=r[2*O],R=r[2*O+1];o.fill(0);for(var M=0;M<a.length;++M)T=_,D=I,F=R,_=4*(O=a[M]),I=r[2*O],R=r[2*O+1],o[T+2]=o[_]=F-R,o[T+3]=o[_+1]=I-D}},{key:"render",value:function(e){var t=null==e?e=new c.default:void 0,n=this,r=n.delaunay,a=r.halfedges,i=r.inedges,o=r.hull,u=n.circumcenters,s=n.vectors;if(o.length<=1)return null;for(var l=0,f=a.length;l<f;++l){var d=a[l];if(!(d<l)){var p=2*Math.floor(l/3),h=2*Math.floor(d/3),v=u[p],g=u[p+1],m=u[h],y=u[h+1];this._renderSegment(v,g,m,y,e)}}for(var x,b=o[o.length-1],k=0;k<o.length;++k){x=b,b=o[k];var w=2*Math.floor(i[b]/3),A=u[w],E=u[w+1],C=4*x,S=this._project(A,E,s[C+2],s[C+3]);S&&this._renderSegment(A,E,S[0],S[1],e)}return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new c.default:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new c.default:void 0,r=this._clip(e);if(null!==r&&r.length){t.moveTo(r[0],r[1]);for(var a=r.length;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(var i=2;i<a;i+=2)r[i]===r[i-2]&&r[i+1]===r[i-1]||t.lineTo(r[i],r[i+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:t(u).mark((function e(){var n,r,a,i;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.delaunay.points,r=0,a=n.length/2;case 2:if(!(r<a)){e.next=11;break}if(!(i=this.cellPolygon(r))){e.next=8;break}return i.index=r,e.next=8,i;case 8:++r,e.next=2;break;case 11:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new l.default;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,a){var i,o=this._regioncode(e,t),u=this._regioncode(n,r);0===o&&0===u?(a.moveTo(e,t),a.lineTo(n,r)):(i=this._clipSegment(e,t,n,r,o,u))&&(a.moveTo(i[0],i[1]),a.lineTo(i[2],i[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)==t&&(n=+n)==n&&this.delaunay._step(e,t,n)===e}},{key:"neighbors",value:t(u).mark((function e(n){var r,a,i,o,s,c,l,f,d,p,h,v;return t(u).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this._clip(n),a=!0,i=!1,o=void 0,!r){e.next=40;break}e.prev=3,s=this.delaunay.neighbors(n)[Symbol.iterator]();case 5:if(a=(c=s.next()).done){e.next=26;break}if(l=c.value,!(f=this._clip(l))){e.next=23;break}d=0,p=r.length;case 10:if(!(d<p)){e.next=23;break}h=0,v=f.length;case 12:if(!(h<v)){e.next=20;break}if(r[d]!=f[h]||r[d+1]!=f[h+1]||r[(d+2)%p]!=f[(h+v-2)%v]||r[(d+3)%p]!=f[(h+v-1)%v]){e.next=17;break}return e.next=16,l;case 16:return e.abrupt("break",23);case 17:h+=2,e.next=12;break;case 20:d+=2,e.next=10;break;case 23:a=!0,e.next=5;break;case 26:e.next=32;break;case 28:e.prev=28,e.t0=e.catch(3),i=!0,o=e.t0;case 32:e.prev=32,e.prev=33,a||null==s.return||s.return();case 35:if(e.prev=35,!i){e.next=38;break}throw o;case 38:return e.finish(35);case 39:return e.finish(32);case 40:case"end":return e.stop()}}),e,this,[[3,28,32,40],[33,,35,39]])}))},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,a=n.halfedges,i=n.triangles,o=r[e];if(-1===o)return null;var u=[],s=o;do{var c=Math.floor(s/3);if(u.push(t[2*c],t[2*c+1]),i[s=s%3==2?s-2:s+1]!==e)break;s=a[s]}while(s!==o&&-1!==s);return u}},{key:"_clip",value:function(e){if(0===e&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,i,o,u,s=t.length,c=null,l=t[s-2],f=t[s-1],d=this._regioncode(l,f),p=0;p<s;p+=2)if(n=l,r=f,l=t[p],f=t[p+1],i=d,d=this._regioncode(l,f),0===i&&0===d)o=u,u=0,c?c.push(l,f):c=[l,f];else{var h=void 0,v=void 0,g=void 0,m=void 0,y=void 0;if(0===i){if(null===(h=this._clipSegment(n,r,l,f,i,d)))continue;var x;v=(x=a.default(h,4))[0],g=x[1],m=x[2],y=x[3]}else{if(null===(h=this._clipSegment(l,f,n,r,d,i)))continue;var b;m=(b=a.default(h,4))[0],y=b[1],v=b[2],g=b[3],o=u,u=this._edgecode(v,g),o&&u&&this._edge(e,o,u,c,c.length),c?c.push(v,g):c=[v,g]}o=u,u=this._edgecode(m,y),o&&u&&this._edge(e,o,u,c,c.length),c?c.push(m,y):c=[m,y]}if(c)o=u,u=this._edgecode(c[0],c[1]),o&&u&&this._edge(e,o,u,c,c.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return c}},{key:"_clipSegment",value:function(e,t,n,r,a,i){for(;;){if(0===a&&0===i)return[e,t,n,r];if(a&i)return null;var o=void 0,u=void 0,s=a||i;8&s?(o=e+(n-e)*(this.ymax-t)/(r-t),u=this.ymax):4&s?(o=e+(n-e)*(this.ymin-t)/(r-t),u=this.ymin):2&s?(u=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(u=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),a?(e=o,t=u,a=this._regioncode(e,t)):(n=o,r=u,i=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,a,i){var o,u=Array.from(t);if((o=this._project(u[0],u[1],n,r))&&u.unshift(o[0],o[1]),(o=this._project(u[u.length-2],u[u.length-1],a,i))&&u.push(o[0],o[1]),u=this._clipFinite(e,u))for(var s,c=0,l=u.length,f=this._edgecode(u[l-2],u[l-1]);c<l;c+=2)s=f,f=this._edgecode(u[c],u[c+1]),s&&f&&(c=this._edge(e,s,f,u,c),l=u.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(u=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return u}},{key:"_edge",value:function(e,t,n,r,a){for(;t!==n;){var i=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,i=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,i=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,i=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,i=this.xmin,o=this.ymin}r[a]===i&&r[a+1]===o||!this.contains(e,i,o)||(r.splice(a,0,i,o),a+=2)}if(r.length>4)for(var u=0;u<r.length;u+=2){var s=(u+2)%r.length,c=(u+4)%r.length;(r[u]===r[s]&&r[s]===r[c]||r[u+1]===r[s+1]&&r[s+1]===r[c+1])&&(r.splice(s,2),u-=2)}return a}},{key:"_project",value:function(e,t,n,r){var a,i,o,u=1/0;if(r<0){if(t<=this.ymin)return null;(a=(this.ymin-t)/r)<u&&(o=this.ymin,i=e+(u=a)*n)}else if(r>0){if(t>=this.ymax)return null;(a=(this.ymax-t)/r)<u&&(o=this.ymax,i=e+(u=a)*n)}if(n>0){if(e>=this.xmax)return null;(a=(this.xmax-e)/n)<u&&(i=this.xmax,o=t+(u=a)*r)}else if(n<0){if(e<=this.xmin)return null;(a=(this.xmin-e)/n)<u&&(i=this.xmin,o=t+(u=a)*r)}return[i,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}()})),s.register("lF15u",(function(e,t){n(e.exports,"wordcloud",(function(){return b})),s("juhb3");var r=s("a3wIG"),a=s("euljU"),i=s("caNzv"),o=s("ilkKT"),u=s("3okBY"),c=Math.PI/180,l=2048;function f(){var e,t,n,a,i,o,u,s=[256,256],c=v,f=[],y=Math.random,x={};function b(e,t,n){for(var r,a,i,o,u,l=t.x,f=t.y,d=Math.sqrt(s[0]*s[0]+s[1]*s[1]),h=c(s),v=y()<.5?1:-1,g=-v;(r=h(g+=v))&&(a=~~r[0],i=~~r[1],!(Math.min(Math.abs(a),Math.abs(i))>=d));)if(t.x=l+a,t.y=f+i,!(t.x+t.x0<0||t.y+t.y0<0||t.x+t.x1>s[0]||t.y+t.y1>s[1]||n&&p(t,e,s[0])||n&&(u=n,!((o=t).x+o.x1>u[0].x&&o.x+o.x0<u[1].x&&o.y+o.y1>u[0].y&&o.y+o.y0<u[1].y)))){for(var m,x=t.sprite,b=t.width>>5,k=s[0]>>5,w=t.x-(b<<4),A=127&w,E=32-A,C=t.y1-t.y0,S=(t.y+t.y0)*k+(w>>5),N=0;N<C;N++){m=0;for(var T=0;T<=b;T++)e[S+T]|=m<<E|(T<b?(m=x[N*b+T])>>>A:0);S+=k}return t.sprite=null,!0}return!1}return x.layout=function(){for(var c=function(e){e.width=e.height=1;var t=Math.sqrt(e.getContext("2d").getImageData(0,0,1,1).data.length>>2);e.width=2048/t,e.height=l/t;var n=e.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:t}}(r.domCanvas()),p=function(e){var t=[],n=-1;for(;++n<e;)t[n]=0;return t}((s[0]>>5)*s[1]),v=null,g=f.length,m=-1,x=[],k=f.map((function(r){return{text:e(r),font:t(r),style:a(r),weight:i(r),rotate:o(r),size:~~(n(r)+1e-14),padding:u(r),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:r}})).sort((function(e,t){return t.size-e.size}));++m<g;){var w=k[m];w.x=s[0]*(y()+.5)>>1,w.y=s[1]*(y()+.5)>>1,d(c,w,k,m),w.hasText&&b(p,w,v)&&(x.push(w),v?h(v,w):v=[{x:w.x+w.x0,y:w.y+w.y0},{x:w.x+w.x1,y:w.y+w.y1}],w.x-=s[0]>>1,w.y-=s[1]>>1)}return x},x.words=function(e){return arguments.length?(f=e,x):f},x.size=function(e){return arguments.length?(s=[+e[0],+e[1]],x):s},x.font=function(e){return arguments.length?(t=g(e),x):t},x.fontStyle=function(e){return arguments.length?(a=g(e),x):a},x.fontWeight=function(e){return arguments.length?(i=g(e),x):i},x.rotate=function(e){return arguments.length?(o=g(e),x):o},x.text=function(t){return arguments.length?(e=g(t),x):e},x.spiral=function(e){return arguments.length?(c=m[e]||e,x):c},x.fontSize=function(e){return arguments.length?(n=g(e),x):n},x.padding=function(e){return arguments.length?(u=g(e),x):u},x.random=function(e){return arguments.length?(y=e,x):y},x}function d(e,t,n,r){if(!t.sprite){var a=e.context,i=e.ratio;a.clearRect(0,0,2048/i,l/i);var o,u,s,f,d,p=0,h=0,v=0,g=n.length;for(--r;++r<g;){if(t=n[r],a.save(),a.font=t.style+" "+t.weight+" "+~~((t.size+1)/i)+"px "+t.font,o=a.measureText(t.text+"m").width*i,s=t.size<<1,t.rotate){var m=Math.sin(t.rotate*c),y=Math.cos(t.rotate*c),x=o*y,b=o*m,k=s*y,w=s*m;o=Math.max(Math.abs(x+w),Math.abs(x-w))+31>>5<<5,s=~~Math.max(Math.abs(b+k),Math.abs(b-k))}else o=o+31>>5<<5;if(s>v&&(v=s),p+o>=2048&&(p=0,h+=v,v=0),h+s>=l)break;a.translate((p+(o>>1))/i,(h+(s>>1))/i),t.rotate&&a.rotate(t.rotate*c),a.fillText(t.text,0,0),t.padding&&(a.lineWidth=2*t.padding,a.strokeText(t.text,0,0)),a.restore(),t.width=o,t.height=s,t.xoff=p,t.yoff=h,t.x1=o>>1,t.y1=s>>1,t.x0=-t.x1,t.y0=-t.y1,t.hasText=!0,p+=o}for(var A=a.getImageData(0,0,2048/i,l/i).data,E=[];--r>=0;)if((t=n[r]).hasText){for(u=(o=t.width)>>5,s=t.y1-t.y0,f=0;f<s*u;f++)E[f]=0;if(null==(p=t.xoff))return;h=t.yoff;var C=0,S=-1;for(d=0;d<s;d++){for(f=0;f<o;f++){var N=u*d+(f>>5),T=A[2048*(h+d)+(p+f)<<2]?1<<31-f%32:0;E[N]|=T,C|=T}C?S=d:(t.y0++,s--,d--,h++)}t.y1=t.y0+S,t.sprite=E.slice(0,(t.y1-t.y0)*u)}}}function p(e,t,n){n>>=5;for(var r,a=e.sprite,i=e.width>>5,o=e.x-(i<<4),u=127&o,s=32-u,c=e.y1-e.y0,l=(e.y+e.y0)*n+(o>>5),f=0;f<c;f++){r=0;for(var d=0;d<=i;d++)if((r<<s|(d<i?(r=a[f*i+d])>>>u:0))&t[l+d])return!0;l+=n}return!1}function h(e,t){var n=e[0],r=e[1];t.x+t.x0<n.x&&(n.x=t.x+t.x0),t.y+t.y0<n.y&&(n.y=t.y+t.y0),t.x+t.x1>r.x&&(r.x=t.x+t.x1),t.y+t.y1>r.y&&(r.y=t.y+t.y1)}function v(e){var t=e[0]/e[1];return function(e){return[t*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function g(e){return"function"==typeof e?e:function(){return e}}var m={archimedean:v,rectangular:function(e){var t=4*e[0]/e[1],n=0,r=0;return function(e){var a=e<0?-1:1;switch(Math.sqrt(1+4*a*e)-a&3){case 0:n+=t;break;case 1:r+=4;break;case 2:n-=t;break;default:r-=4}return[n,r]}}},y=["x","y","font","fontSize","fontStyle","fontWeight","angle"],x=["text","font","rotate","fontSize","fontStyle","fontWeight"];function b(e){a.Transform.call(this,f(),e)}b.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:y}]},i.inherits(b,a.Transform,{transform:function(e,t){!e.size||e.size[0]&&e.size[1]||i.error("Wordcloud size dimensions must be non-zero.");var n=e.modified();if(n||t.changed(t.ADD_REM)||x.some((function(n){var r=e[n];return i.isFunction(r)&&t.modified(r.fields)}))){var r,a=t.materialize(t.SOURCE).source,s=this.value,c=e.as||y,l=e.fontSize||14;if(i.isFunction(l)?r=e.fontSizeRange:l=i.constant(l),r){var f=l,d=o.scale("sqrt")().domain(i.extent(a,f)).range(r);l=function(e){return d(f(e))}}a.forEach((function(e){e[c[0]]=NaN,e[c[1]]=NaN,e[c[3]]=0}));for(var p,h,v=s.words(a).text(e.text).size(e.size||[500,500]).padding(e.padding||1).spiral(e.spiral||"archimedean").rotate(e.rotate||0).font(e.font||"sans-serif").fontStyle(e.fontStyle||"normal").fontWeight(e.fontWeight||"normal").fontSize(l).random(u.random).layout(),g=s.size(),m=g[0]>>1,b=g[1]>>1,k=v.length,w=0;w<k;++w)(h=(p=v[w]).datum)[c[0]]=p.x+m,h[c[1]]=p.y+b,h[c[2]]=p.font,h[c[3]]=p.size,h[c[4]]=p.style,h[c[5]]=p.weight,h[c[6]]=p.rotate;return t.reflow(n).modifies(c)}}})})),s.register("2cOQf",(function(e,t){n(e.exports,"crossfilter",(function(){return h})),n(e.exports,"resolvefilter",(function(){return v}));var r=s("4YaFt"),a=s("3XOxy"),i=s("euljU"),o=s("caNzv"),u=function(e){return new Uint8Array(e)},c=function(e){return new Uint16Array(e)},l=function(e){return new Uint32Array(e)};function f(e,t,n){var r=(t<257?u:t<65537?c:l)(e);return n&&r.set(n),r}function d(e,t,n){var r=1<<t;return{one:r,zero:~r,range:n.slice(),bisect:e.bisect,index:e.index,size:e.size,onAdd:function(e,t){var n,a=this,i=a.bisect(a.range,e.value),o=e.index,u=i[0],s=i[1],c=o.length;for(n=0;n<u;++n)t[o[n]]|=r;for(n=s;n<c;++n)t[o[n]]|=r;return a}}}function p(){var e=l(0),t=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];var u,s,c,f=n,d=i.length,p=l(d),h=Array(d);for(c=0;c<d;++c)h[c]=r(i[c]),p[c]=c;if(h=function(e,t){return e.sort.call(t,(function(t,n){var r=e[t],a=e[n];return r<a?-1:r>a?1:0})),a.default(e,t)}(h,p),f)u=t,s=e,t=Array(f+d),e=l(f+d),function(e,t,n,r,a,i,o,u,s){var c,l=0,f=0;for(c=0;l<r&&f<o;++c)t[l]<a[f]?(u[c]=t[l],s[c]=n[l++]):(u[c]=a[f],s[c]=i[f++]+e);for(;l<r;++l,++c)u[c]=t[l],s[c]=n[l];for(;f<o;++f,++c)u[c]=a[f],s[c]=i[f]+e}(o,u,s,f,h,p,d,t,e);else{if(o>0)for(c=0;c<d;++c)p[c]+=o;t=h,e=p}return n=f+d,{index:p,value:h}},remove:function(r,a){var i,o,u,s=n;for(o=0;!a[e[o]]&&o<s;++o);for(u=o;o<s;++o)a[i=e[o]]||(e[u]=i,t[u]=t[o],++u);n=s-r},bisect:function(e,a){var i;return a?i=a.length:(a=t,i=n),[r.bisectLeft(a,e[0],0,i),r.bisectRight(a,e[1],0,i)]},reindex:function(t){for(var r=0,a=n;r<a;++r)e[r]=t[e[r]]},index:function(){return e},size:function(){return n}}}function h(e){var t,n,r,a,o;i.Transform.call(this,(t=8,n=[],r=l(0),a=f(0,t),o=f(0,t),{data:function(){return n},seen:function(){return e=r,t=n.length,r=e.length>=t?e:((a=a||new e.constructor(t)).set(e),a);var e,t,a},add:function(e){for(var t,r=0,a=n.length,i=e.length;r<i;++r)(t=e[r])._index=a++,n.push(t)},remove:function(e,t){var r,i,u,s=n.length,c=Array(s-e),l=n;for(i=0;!t[i]&&i<s;++i)c[i]=n[i],l[i]=i;for(u=i;i<s;++i)r=n[i],t[i]?l[i]=-1:(l[i]=u,a[u]=a[i],o[u]=o[i],c[u]=r,r._index=u++),a[i]=0;return n=c,l},size:function(){return n.length},curr:function(){return a},prev:function(){return o},reset:function(e){return o[e]=a[e]},all:function(){return t<257?255:t<65537?65535:4294967295},set:function(e,t){a[e]|=t},clear:function(e,t){a[e]&=~t},resize:function(e,n){(e>a.length||n>t)&&(t=Math.max(n,t),a=f(e,t,a),o=f(e,t))}}),e),this._indices=null,this._dims=null}function v(e){i.Transform.call(this,null,e)}h.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},o.inherits(h,i.Transform,{transform:function(e,t){return this._dims?e.modified("fields")||e.fields.some((function(e){return t.modified(e.fields)}))?this.reinit(e,t):this.eval(e,t):this.init(e,t)},init:function(e,t){for(var n,r,a=e.fields,i=e.query,o=this._indices={},u=this._dims=[],s=i.length,c=0;c<s;++c)r=o[n=a[c].fname]||(o[n]=p()),u.push(d(r,c,i[c]));return this.eval(e,t)},reinit:function(e,t){var n,r,a,i,o,u,s,c,l,f=t.materialize().fork(),h=e.fields,v=e.query,g=this._indices,m=this._dims,y=this.value,x=y.curr(),b=y.prev(),k=y.all(),w=f.rem=f.add,A=f.mod,E=v.length,C={};if(b.set(x),t.rem.length&&(o=this.remove(e,t,f)),t.add.length&&y.add(t.add),t.mod.length)for(u={},s=0,c=(i=t.mod).length;s<c;++s)u[i[s]._index]=1;for(s=0;s<E;++s)l=h[s],(!m[s]||e.modified("fields",s)||t.modified(l.fields))&&((n=C[a=l.fname])||(g[a]=r=p(),C[a]=n=r.insert(l,t.source,0)),m[s]=d(r,s,v[s]).onAdd(n,x));for(s=0,c=y.data().length;s<c;++s)o[s]||(b[s]!==x[s]?w.push(s):u[s]&&x[s]!==k&&A.push(s));return y.mask=(1<<E)-1,f},eval:function(e,t){var n=t.materialize().fork(),r=this._dims.length,a=0;return t.rem.length&&(this.remove(e,t,n),a|=(1<<r)-1),e.modified("query")&&!e.modified("fields")&&(a|=this.update(e,t,n)),t.add.length&&(this.insert(e,t,n),a|=(1<<r)-1),t.mod.length&&(this.modify(t,n),a|=(1<<r)-1),this.value.mask=a,n},insert:function(e,t,n){var r,a,i,o=t.add,u=this.value,s=this._dims,c=this._indices,l=e.fields,f={},d=n.add,p=u.size()+o.length,h=s.length,v=u.size();u.resize(p,h),u.add(o);var g=u.curr(),m=u.prev(),y=u.all();for(r=0;r<h;++r)i=f[a=l[r].fname]||(f[a]=c[a].insert(l[r],o,v)),s[r].onAdd(i,g);for(;v<p;++v)m[v]=y,g[v]!==y&&d.push(v)},modify:function(e,t){var n,r,a,i=t.mod,o=this.value,u=o.curr(),s=o.all(),c=e.mod;for(n=0,r=c.length;n<r;++n)u[a=c[n]._index]!==s&&i.push(a)},remove:function(e,t,n){var r,a,i,o,u=this._indices,s=this.value,c=s.curr(),l=s.prev(),f=s.all(),d={},p=n.rem,h=t.rem;for(r=0,a=h.length;r<a;++r)d[i=h[r]._index]=1,l[i]=o=c[i],c[i]=f,o!==f&&p.push(i);for(i in u)u[i].remove(a,d);return this.reindex(t,a,d),d},reindex:function(e,t,n){var r=this._indices,a=this.value;e.runAfter((function(){var e=a.remove(t,n);for(var i in r)r[i].reindex(e)}))},update:function(e,t,n){var r,a,i=this._dims,o=e.query,u=t.stamp,s=i.length,c=0;for(n.filters=0,a=0;a<s;++a)e.modified("query",a)&&(r=a,++c);if(1===c)c=i[r].one,this.incrementOne(i[r],o[r],n.add,n.rem);else for(a=0,c=0;a<s;++a)e.modified("query",a)&&(c|=i[a].one,this.incrementAll(i[a],o[a],u,n.add),n.rem=n.add);return c},incrementAll:function(e,t,n,r){var a,i,o,u=this.value,s=u.seen(),c=u.curr(),l=u.prev(),f=e.index(),d=e.bisect(e.range),p=e.bisect(t),h=p[0],v=p[1],g=d[0],m=d[1],y=e.one;if(h<g)for(a=h,i=Math.min(g,v);a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;else if(h>g)for(a=g,i=Math.min(h,m);a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;if(v>m)for(a=Math.max(h,m),i=v;a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;else if(v<m)for(a=Math.max(g,v),i=m;a<i;++a)s[o=f[a]]!==n&&(l[o]=c[o],s[o]=n,r.push(o)),c[o]^=y;e.range=t.slice()},incrementOne:function(e,t,n,r){var a,i,o,u=this.value.curr(),s=e.index(),c=e.bisect(e.range),l=e.bisect(t),f=l[0],d=l[1],p=c[0],h=c[1],v=e.one;if(f<p)for(a=f,i=Math.min(p,d);a<i;++a)u[o=s[a]]^=v,n.push(o);else if(f>p)for(a=p,i=Math.min(f,h);a<i;++a)u[o=s[a]]^=v,r.push(o);if(d>h)for(a=Math.max(f,h),i=d;a<i;++a)u[o=s[a]]^=v,n.push(o);else if(d<h)for(a=Math.max(p,d),i=h;a<i;++a)u[o=s[a]]^=v,r.push(o);e.range=t.slice()}}),v.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},o.inherits(v,i.Transform,{transform:function(e,t){var n=~(e.ignore||0),r=e.filter,a=r.mask;if(0==(a&n))return t.StopPropagation;var i=t.fork(t.ALL),o=r.data(),u=r.curr(),s=r.prev(),c=function(e){return u[e]&n?null:o[e]};return i.filter(i.MOD,c),a&a-1?(i.filter(i.ADD,(function(e){var t=u[e]&n;return!t&&t^s[e]&n?o[e]:null})),i.filter(i.REM,(function(e){var t=u[e]&n;return t&&!(t^t^s[e]&n)?o[e]:null}))):(i.filter(i.ADD,c),i.filter(i.REM,(function(e){return(u[e]&n)===a?o[e]:null}))),i.filter(i.SOURCE,(function(e){return c(e._index)}))}})})),s.register("8Li02",(function(e,r){n(e.exports,"View",(function(){return ce})),s("1i51P");var a=s("e3nFV"),i=s("40Zzs"),o=s("caNzv"),u=s("euljU"),c=s("aVGvL"),l=s("hdht0"),f=s("7ZKwa"),d=s("gziXg"),p=s("ddnuT"),h=s("7aVEe");function v(e,t){e&&(null==t?e.removeAttribute("aria-label"):e.setAttribute("aria-label",t))}var g="default";function m(e,t){var n=e.globalCursor()?"undefined"!=typeof document&&document.body:e.container();if(n)return null==t?n.style.removeProperty("cursor"):n.style.cursor=t}function y(e,t){var n=e._runtime.data;return o.hasOwnProperty(n,t)||o.error("Unrecognized data set: "+t),n[t]}function x(e,t){u.isChangeSet(t)||o.error("Second argument to changes must be a changeset.");var n=y(this,e);return n.modified=!0,this.pulse(n.input,t)}function b(e){var t=e.padding();return Math.max(0,e._viewWidth+t.left+t.right)}function k(e){var t=e.padding();return Math.max(0,e._viewHeight+t.top+t.bottom)}function w(e){var t=e.padding(),n=e._origin;return[t.left+n[0],t.top+n[1]]}function A(e){var t=w(e),n=b(e),r=k(e);e._renderer.background(e.background()),e._renderer.resize(n,r,t),e._handler.origin(t),e._resizeListeners.forEach((function(t){try{t(n,r)}catch(t){e.error(t)}}))}function E(e,t,n){var r,a,i,u=e._renderer,s=u&&u.canvas();return s&&(i=w(e),a=t.changedTouches?t.changedTouches[0]:t,(r=c.point(a,s))[0]-=i[0],r[1]-=i[1]),t.dataflow=e,t.item=n,t.vega=function(e,t,n){var r=t?"group"===t.mark.marktype?t:t.mark.group:null;function a(e){var n,a=r;if(e)for(n=t;n;n=n.mark.group)if(n.mark.name===e){a=n;break}return a&&a.mark&&a.mark.interactive?a:{}}function i(e){if(!e)return n;o.isString(e)&&(e=a(e));for(var t=n.slice();e;)t[0]-=e.x||0,t[1]-=e.y||0,e=e.mark&&e.mark.group;return t}return{view:o.constant(e),item:o.constant(t||{}),group:a,xy:i,x:function(e){return i(e)[0]},y:function(e){return i(e)[1]}}}(e,n,r),t}var C="view",S={trap:!1};function N(e,t,n,r){e._eventListeners.push({type:n,sources:o.array(t),handler:r})}function T(e,t,n){var r=e._eventConfig&&e._eventConfig[t];return!(!1===r||o.isObject(r)&&!r[n])||(e.warn("Blocked ".concat(t," ").concat(n," event listener.")),!1)}function D(e){return e.item}function F(e){return e.item.mark.source}function O(e){return function(t,n){return n.vega.view().changeset().encode(n.item,e)}}function _(e,t,n){var r=document.createElement(e);for(var a in t)r.setAttribute(a,t[a]);return null!=n&&(r.textContent=n),r}function I(e,t,n,r){var a=n.event||"input",i=function(){return e.update(t.value)};r.signal(n.signal,t.value),t.addEventListener(a,i),N(r,t,a,i),e.set=function(e){t.value=e,t.dispatchEvent(function(e){return"undefined"!=typeof Event?new Event(e):{type:e}}(a))}}function R(e,t,n,r){var a=r.signal(n.signal),i=_("div",{class:"vega-bind"}),o="radio"===n.input?i:i.appendChild(_("label"));o.appendChild(_("span",{class:"vega-bind-name"},n.name||n.signal)),t.appendChild(i);var u=M;switch(n.input){case"checkbox":u=B;break;case"select":u=P;break;case"radio":u=L;break;case"range":u=j}u(e,o,n,a)}function M(e,t,n,r){var a=_("input");for(var i in n)"signal"!==i&&"element"!==i&&a.setAttribute("input"===i?"type":i,n[i]);a.setAttribute("name",n.signal),a.value=r,t.appendChild(a),a.addEventListener("input",(function(){return e.update(a.value)})),e.elements=[a],e.set=function(e){return a.value=e}}function B(e,t,n,r){var a={type:"checkbox",name:n.signal};r&&(a.checked=!0);var i=_("input",a);t.appendChild(i),i.addEventListener("change",(function(){return e.update(i.checked)})),e.elements=[i],e.set=function(e){return i.checked=!!e||null}}function P(e,t,n,r){var a=_("select",{name:n.signal}),i=n.labels||[];n.options.forEach((function(e,t){var n={value:e};z(e,r)&&(n.selected=!0),a.appendChild(_("option",n,(i[t]||e)+""))})),t.appendChild(a),a.addEventListener("change",(function(){e.update(n.options[a.selectedIndex])})),e.elements=[a],e.set=function(e){for(var t=0,r=n.options.length;t<r;++t)if(z(n.options[t],e))return void(a.selectedIndex=t)}}function L(e,t,n,r){var a=_("span",{class:"vega-bind-radio"}),i=n.labels||[];t.appendChild(a),e.elements=n.options.map((function(t,o){var u={type:"radio",name:n.signal,value:t};z(t,r)&&(u.checked=!0);var s=_("input",u);s.addEventListener("change",(function(){return e.update(t)}));var c=_("label",{},(i[o]||t)+"");return c.prepend(s),a.appendChild(c),s})),e.set=function(t){for(var n=e.elements,r=n.length,a=0;a<r;++a)z(n[a].value,t)&&(n[a].checked=!0)}}function j(e,t,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;var a=null!=n.max?n.max:Math.max(100,+r)||100,i=n.min||Math.min(0,a,+r)||0,o=n.step||l.tickStep(i,a,100),u=_("input",{type:"range",name:n.signal,min:i,max:a,step:o});u.value=r;var s=_("span",{},+r);t.appendChild(u),t.appendChild(s);var c=function(){s.textContent=u.value,e.update(+u.value)};u.addEventListener("input",c),u.addEventListener("change",c),e.elements=[u],e.set=function(e){u.value=e,s.textContent=e}}function z(e,t){return e===t||e+""==t+""}function U(e,t,n,r,a,i){return(t=t||new r(e.loader())).initialize(n,b(e),k(e),w(e),a,i).background(e.background())}function V(e,t){return t?function(){try{t.apply(this,arguments)}catch(t){e.error(t)}}:null}function W(e,t,n){if("string"==typeof t){if("undefined"==typeof document)return e.error("DOM document instance not found."),null;if(!(t=document.querySelector(t)))return e.error("Signal bind element not found: "+t),null}if(t&&n)try{t.innerHTML=""}catch(n){t=null,e.error(n)}return t}var G=function(e){return+e||0};function H(e){return o.isObject(e)?{top:G(e.top),bottom:G(e.bottom),left:G(e.left),right:G(e.right)}:function(e){return{top:e,bottom:e,left:e,right:e}}(G(e))}function q(e,t,n,r){return J.apply(this,arguments)}function J(){return J=a.default(t(i).mark((function e(n,r,a,u){var s,l;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=c.renderModule(r),(l=s&&s.headless)||o.error("Unrecognized renderer type: "+r),e.next=4,n.runAsync();case 4:return e.abrupt("return",U(n,null,null,l,a,u).renderAsync(n._scenegraph.root));case 5:case"end":return e.stop()}}),e)}))),J.apply(this,arguments)}function K(){return(K=a.default(t(i).mark((function e(n,r){var a;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n!==c.RenderType.Canvas&&n!==c.RenderType.SVG&&n!==c.RenderType.PNG&&o.error("Unrecognized image type: "+n),e.next=3,q(this,n,r);case 3:return a=e.sent,e.abrupt("return",n===c.RenderType.SVG?X(a.svg(),"image/svg+xml"):a.canvas().toDataURL("image/png"));case 5:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function X(e,t){var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}function Y(){return(Y=a.default(t(i).mark((function e(n,r){var a;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(this,c.RenderType.Canvas,n,r);case 2:return a=e.sent,e.abrupt("return",a.canvas());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}function Q(){return(Q=a.default(t(i).mark((function e(n){var r;return t(i).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q(this,c.RenderType.SVG,n);case 2:return r=e.sent,e.abrupt("return",r.svg());case 4:case"end":return e.stop()}}),e,this)})))).apply(this,arguments)}var Z="width",$="height",ee="padding",te={skip:!0};function ne(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===ee?r.left+r.right:0)}function re(e,t){var n=e.autosize(),r=e.padding();return t-(n&&n.contains===ee?r.top+r.bottom:0)}function ae(e,t){return t.modified&&o.isArray(t.input.value)&&e.indexOf("_:vega:_")}function ie(e,t){return!("parent"===e||t instanceof u.transforms.proxy)}function oe(e,t,n,r){var a=e.element();a&&a.setAttribute("title",function(e){return null==e?"":o.isArray(e)?ue(e):o.isObject(e)&&!o.isDate(e)?(t=e,Object.keys(t).map((function(e){var n=t[e];return e+": "+(o.isArray(n)?ue(n):se(n))})).join("\n")):e+"";var t}(r))}function ue(e){return"["+e.map(se).join(", ")+"]"}function se(e){return o.isArray(e)?"[]":o.isObject(e)&&!o.isDate(e)?"{}":e}function ce(e,t){var n=this;if(t=t||{},u.Dataflow.call(n),t.loader&&n.loader(t.loader),t.logger&&n.logger(t.logger),null!=t.logLevel&&n.logLevel(t.logLevel),t.locale||e.locale){var r=o.extend({},e.locale,t.locale);n.locale(h.locale(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=t.renderer||c.RenderType.Canvas,n._scenegraph=new c.Scenegraph;var a,i,s,l=n._scenegraph.root;n._renderer=null,n._tooltip=t.tooltip||oe,n._redraw=!0,n._handler=(new c.CanvasHandler).scene(l),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=(a=e.eventConfig,i=o.extend({defaults:{}},a),(s=function(e,t){t.forEach((function(t){o.isArray(e[t])&&(e[t]=o.toSet(e[t]))}))})(i.defaults,["prevent","allow"]),s(i,["view","window","selector"]),i),n.globalCursor(n._eventConfig.globalCursor);var p=function(e,t,n){return d.context(e,u.transforms,f.functionContext,n).parse(t)}(n,e,t.expr);n._runtime=p,n._signals=p.signals,n._bind=(e.bindings||[]).map((function(e){return{state:null,param:o.extend({},e)}})),p.root&&p.root.set(l),l.source=p.data.root.input,n.pulse(p.data.root.input,n.changeset().insert(l.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=ne(n,n._width),n._viewHeight=re(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(e){var t=e._signals,n=t.width,r=t.height,a=t.padding;function i(){e._autosize=e._resize=1}e._resizeWidth=e.add(null,(function(t){e._width=t.size,e._viewWidth=ne(e,t.size),i()}),{size:n}),e._resizeHeight=e.add(null,(function(t){e._height=t.size,e._viewHeight=re(e,t.size),i()}),{size:r});var o=e.add(null,i,{pad:a});e._resizeWidth.rank=n.rank+1,e._resizeHeight.rank=r.rank+1,o.rank=a.rank+1}(n),function(e){e.add(null,(function(t){return e._background=t.bg,e._resize=1,t.bg}),{bg:e._signals.background})}(n),function(e){var t=e._signals.cursor||(e._signals.cursor=e.add({user:g,item:null}));e.on(e.events("view","mousemove"),t,(function(e,n){var r=t.value,a=r?o.isString(r)?r:r.user:g,i=n.item&&n.item.cursor||null;return r&&a===r.user&&i==r.item?r:{user:a,item:i}})),e.add(null,(function(t){var n=t.cursor,r=this.value;return o.isString(n)||(r=n.item,n=n.user),m(e,n&&n!==g?n:r||n),r}),{cursor:t})}(n),n.description(e.description),t.hover&&n.hover(),t.container&&n.initialize(t.container,t.bind)}function le(e,t){return o.hasOwnProperty(e._signals,t)?e._signals[t]:o.error("Unrecognized signal name: "+o.stringValue(t))}function fe(e,t){var n=(e._targets||[]).filter((function(e){return e._update&&e._update.handler===t}));return n.length?n[0]:null}function de(e,t,n,r){var a=fe(n,r);return a||((a=V(e,(function(){return r(t,n.value)}))).handler=r,e.on(n,null,a)),e}function pe(e,t,n){var r=fe(t,n);return r&&t._targets.remove(r),e}o.inherits(ce,u.Dataflow,{evaluate:function(e,n,r){return a.default(t(i).mark((function a(){return t(i).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u.Dataflow.prototype.evaluate.call(this,e,n);case 2:if(!this._redraw&&!this._resize){t.next=14;break}if(t.prev=3,!this._renderer){t.next=8;break}return this._resize&&(this._resize=0,A(this)),t.next=8,this._renderer.renderAsync(this._scenegraph.root);case 8:this._redraw=!1,t.next=14;break;case 11:t.prev=11,t.t0=t.catch(3),this.error(t.t0);case 14:return r&&u.asyncCallback(this,r),t.abrupt("return",this);case 16:case"end":return t.stop()}}),a,this,[[3,11]])}))).apply(this)},dirty:function(e){this._redraw=!0,this._renderer&&this._renderer.dirty(e)},description:function(e){if(arguments.length){var t=null!=e?e+"":null;return t!==this._desc&&v(this._el,this._desc=t),this}return this._desc},container:function(){return this._el},scenegraph:function(){return this._scenegraph},origin:function(){return this._origin.slice()},signal:function(e,t,n){var r=le(this,e);return 1===arguments.length?r.value:this.update(r,t,n)},width:function(e){return arguments.length?this.signal("width",e):this.signal("width")},height:function(e){return arguments.length?this.signal("height",e):this.signal("height")},padding:function(e){return arguments.length?this.signal("padding",H(e)):H(this.signal("padding"))},autosize:function(e){return arguments.length?this.signal("autosize",e):this.signal("autosize")},background:function(e){return arguments.length?this.signal("background",e):this.signal("background")},renderer:function(e){return arguments.length?(c.renderModule(e)||o.error("Unrecognized renderer type: "+e),e!==this._renderType&&(this._renderType=e,this._resetRenderer()),this):this._renderType},tooltip:function(e){return arguments.length?(e!==this._tooltip&&(this._tooltip=e,this._resetRenderer()),this):this._tooltip},loader:function(e){return arguments.length?(e!==this._loader&&(u.Dataflow.prototype.loader.call(this,e),this._resetRenderer()),this):this._loader},resize:function(){return this._autosize=1,this.touch(le(this,"autosize"))},_resetRenderer:function(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(e,t,n,r,a,i){this.runAfter((function(o){var u=0;o._autosize=0,o.width()!==n&&(u=1,o.signal(Z,n,te),o._resizeWidth.skip(!0)),o.height()!==r&&(u=1,o.signal($,r,te),o._resizeHeight.skip(!0)),o._viewWidth!==e&&(o._resize=1,o._viewWidth=e),o._viewHeight!==t&&(o._resize=1,o._viewHeight=t),o._origin[0]===a[0]&&o._origin[1]===a[1]||(o._resize=1,o._origin=a),u&&o.run("enter"),i&&o.runAfter((function(e){return e.resize()}))}),!1,1)},addEventListener:function(e,t,n){var r=t;return n&&!1===n.trap||((r=V(this,t)).raw=t),this._handler.on(e,r),this},removeEventListener:function(e,t){for(var n,r,a=this._handler.handlers(e),i=a.length;--i>=0;)if(r=a[i].type,n=a[i].handler,e===r&&(t===n||t===n.raw)){this._handler.off(r,n);break}return this},addResizeListener:function(e){var t=this._resizeListeners;return t.indexOf(e)<0&&t.push(e),this},removeResizeListener:function(e){var t=this._resizeListeners,n=t.indexOf(e);return n>=0&&t.splice(n,1),this},addSignalListener:function(e,t){return de(this,e,le(this,e),t)},removeSignalListener:function(e,t){return pe(this,le(this,e),t)},addDataListener:function(e,t){return de(this,e,y(this,e).values,t)},removeDataListener:function(e,t){return pe(this,y(this,e).values,t)},globalCursor:function(e){if(arguments.length){if(this._globalCursor!==!!e){var t=m(this,null);this._globalCursor=!!e,t&&m(this,t)}return this}return this._globalCursor},preventDefault:function(e){return arguments.length?(this._preventDefault=e,this):this._preventDefault},timer:function(e,t){this._timers.push(p.default((function(t){e({timestamp:Date.now(),elapsed:t})}),t))},events:function(e,t,n){var r,a=this,i=new u.EventStream(n),o=function(n,r){a.runAsync(null,(function(){e===C&&function(e,t){var n=e._eventConfig.defaults,r=n.prevent,a=n.allow;return!1!==r&&!0!==a&&(!0===r||!1===a||(r?r[t]:a?!a[t]:e.preventDefault()))}(a,t)&&n.preventDefault(),i.receive(E(a,n,r))}))};if("timer"===e)T(a,"timer",t)&&a.timer(o,t);else if(e===C)T(a,"view",t)&&a.addEventListener(t,o,S);else if("window"===e?T(a,"window",t)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&T(a,"selector",t)&&(r=document.querySelectorAll(e)),r){for(var s=0,c=r.length;s<c;++s)r[s].addEventListener(t,o);N(a,r,t,o)}else a.warn("Can not resolve event source: "+e);return i},finalize:function(){var e,t,n,r=this._tooltip,a=this._timers,i=this._eventListeners;for(e=a.length;--e>=0;)a[e].stop();for(e=i.length;--e>=0;)for(t=(n=i[e]).sources.length;--t>=0;)n.sources[t].removeEventListener(n.type,n.handler);return r&&r.call(this,this._handler,null,null,null),this},hover:function(e,t){return t=[t||"update",(e=[e||"hover"])[0]],this.on(this.events("view","mouseover",D),F,O(e)),this.on(this.events("view","mouseout",D),F,O(t)),this},data:function(e,t){return arguments.length<2?y(this,e).values.value:x.call(this,e,u.changeset().remove(o.truthy).insert(t))},change:x,insert:function(e,t){return x.call(this,e,u.changeset().insert(t))},remove:function(e,t){return x.call(this,e,u.changeset().remove(t))},scale:function(e){var t=this._runtime.scales;return o.hasOwnProperty(t,e)||o.error("Unrecognized scale or projection: "+e),t[e].value},initialize:function(e,t){var n=this,r=n._renderType,a=n._eventConfig.bind,i=c.renderModule(r);e=n._el=e?W(n,e,!0):null,function(e){var t=e.container();t&&(t.setAttribute("role","graphics-document"),t.setAttribute("aria-roleDescription","visualization"),v(t,e.description()))}(n),i||n.error("Unrecognized renderer type: "+r);var u=i.handler||c.CanvasHandler,s=e?i.renderer:i.headless;return n._renderer=s?U(n,n._renderer,e,s):null,n._handler=function(e,t,n,r){var a=new r(e.loader(),V(e,e.tooltip())).scene(e.scenegraph().root).initialize(n,w(e),e);return t&&t.handlers().forEach((function(e){a.on(e.type,e.handler)})),a}(n,n._handler,e,u),n._redraw=!0,e&&"none"!==a&&(t=t?n._elBind=W(n,t,!0):e.appendChild(_("form",{class:"vega-bindings"})),n._bind.forEach((function(e){e.param.element&&"container"!==a&&(e.element=W(n,e.param.element,!!e.param.input))})),n._bind.forEach((function(e){!function(e,t,n){if(t){var r=n.param,a=n.state;a||(a=n.state={elements:null,active:!1,set:null,update:function(t){t!=e.signal(r.signal)&&e.runAsync(null,(function(){a.source=!0,e.signal(r.signal,t)}))}},r.debounce&&(a.update=o.debounce(r.debounce,a.update))),(null==r.input&&r.element?I:R)(a,t,r,e),a.active||(e.on(e._signals[r.signal],null,(function(){a.source?a.source=!1:a.set(e.signal(r.signal))})),a.active=!0)}}(n,e.element||t,e)}))),n},toImageURL:function(e,t){return K.apply(this,arguments)},toCanvas:function(e,t){return Y.apply(this,arguments)},toSVG:function(e){return Q.apply(this,arguments)},getState:function(e){return this._runtime.getState(e||{data:ae,signals:ie,recurse:!0})},setState:function(e){return this.runAsync(null,(function(t){t._trigger=!1,t._runtime.setState(e)}),(function(e){e._trigger=!0})),this}})})),s.register("7ZKwa",(function(e,t){n(e.exports,"functionContext",(function(){return Y})),n(e.exports,"expressionFunction",(function(){return ne})),n(e.exports,"parseExpression",(function(){return re})),s("1i51P");var r=s("9M1dW"),a=s("6vecG"),i=s("caNzv"),o=s("9K8lQ"),u=s("EMifa"),c=s("7EWyw"),l=s("2SNQA"),f=s("eRnrt"),d=s("jNgKw"),p=s("euljU"),h=s("ilkKT"),v=s("aVGvL"),g=s("6ACSx"),m=s("3okBY"),y=s("2U08m"),x=s("jTUhZ");function b(e){var t=this.context.data[e];return t?t.values.value:[]}var k=function(e){return function(t,n){return this.context.dataflow.locale()[e](n)(t)}},w=k("format"),A=k("timeFormat"),E=k("utcFormat"),C=k("timeParse"),S=k("utcParse"),N=new Date(2e3,0,1);function T(e,t,n){return Number.isInteger(e)&&Number.isInteger(t)?(N.setYear(2e3),N.setMonth(e),N.setDate(t),A.call(this,N,n)):""}function D(e,t,n,r){t[0].type!==o.Literal&&i.error("First argument to data functions must be a string literal.");var a=t[0].value,u=":"+a;if(!i.hasOwnProperty(u,r))try{r[u]=n.getData(a).tuplesRef()}catch(e){}}function F(e,t,n,r){if(t[0].type===o.Literal)O(n,r,t[0].value);else for(e in n.scales)O(n,r,e)}function O(e,t,n){var r="%"+n;if(!i.hasOwnProperty(t,r))try{t[r]=e.scaleRef(n)}catch(e){}}function _(e,t){var n;return i.isFunction(e)?e:i.isString(e)?(n=t.scales[e])&&n.value:void 0}function I(e,t,n){t.__bandwidth=function(e){return e&&e.bandwidth?e.bandwidth():0},n._bandwidth=F,n._range=F,n._scale=F;var r=function(t){return"_["+(t.type===o.Literal?i.stringValue("%"+t.value):i.stringValue("%")+"+"+e(t))+"]"};return{_bandwidth:function(e){return"this.__bandwidth(".concat(r(e[0]),")")},_range:function(e){return"".concat(r(e[0]),".range()")},_scale:function(t){return"".concat(r(t[0]),"(").concat(e(t[1]),")")}}}function R(e,t){return function(n,r,a){if(n){var i=_(n,(a||this).context);return i&&i.path[e](r)}return t(r)}}var M=R("area",u.default),B=R("bounds",c.default),P=R("centroid",l.default);function L(e,t,n){try{e[t].apply(e,["EXPRESSION"].concat([].slice.call(n)))}catch(t){e.warn(t)}return n[n.length-1]}function j(e){var t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}function z(e){var t=f.rgb(e);return.2126*j(t.r)+.7152*j(t.g)+.0722*j(t.b)}function U(e,t){return e===t||e!=e&&t!=t||(i.isArray(e)?!(!i.isArray(t)||e.length!==t.length)&&function(e,t){for(var n=0,r=e.length;n<r;++n)if(!U(e[n],t[n]))return!1;return!0}(e,t):!(!i.isObject(e)||!i.isObject(t))&&V(e,t))}function V(e,t){for(var n in e)if(!U(e[n],t[n]))return!1;return!0}function W(e){return function(t){return V(e,t)}}var G={};function H(e){return i.isArray(e)||ArrayBuffer.isView(e)?e:null}function q(e){return H(e)||(i.isString(e)?e:null)}var J=function(e){return e.data};function K(e,t){var n=b.call(t,e);return n.root&&n.root.lookup||{}}var X=function(){return"undefined"!=typeof window&&window||null};var Y={random:function(){return m.random()},cumulativeNormal:m.cumulativeNormal,cumulativeLogNormal:m.cumulativeLogNormal,cumulativeUniform:m.cumulativeUniform,densityNormal:m.densityNormal,densityLogNormal:m.densityLogNormal,densityUniform:m.densityUniform,quantileNormal:m.quantileNormal,quantileLogNormal:m.quantileLogNormal,quantileUniform:m.quantileUniform,sampleNormal:m.sampleNormal,sampleLogNormal:m.sampleLogNormal,sampleUniform:m.sampleUniform,isArray:i.isArray,isBoolean:i.isBoolean,isDate:i.isDate,isDefined:function(e){return void 0!==e},isNumber:i.isNumber,isObject:i.isObject,isRegExp:i.isRegExp,isString:i.isString,isTuple:p.isTuple,isValid:function(e){return null!=e&&e==e},toBoolean:i.toBoolean,toDate:i.toDate,toNumber:i.toNumber,toString:i.toString,indexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i;return(i=q(e)).indexOf.apply(i,r.default(n))},join:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i;return(i=H(e)).join.apply(i,r.default(n))},lastindexof:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i;return(i=q(e)).lastIndexOf.apply(i,r.default(n))},replace:function(e,t,n){return i.isFunction(n)&&i.error("Function argument passed to replace."),String(e).replace(t,n)},reverse:function(e){return H(e).slice().reverse()},slice:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i;return(i=q(e)).slice.apply(i,r.default(n))},flush:i.flush,lerp:i.lerp,merge:function(){var e=[].slice.call(arguments);return e.unshift({}),i.extend.apply(void 0,r.default(e))},pad:i.pad,peek:i.peek,pluck:function(e,t){var n=G[t]||(G[t]=i.field(t));return i.isArray(e)?e.map(n):n(e)},span:i.span,inrange:i.inrange,truncate:i.truncate,rgb:f.rgb,lab:d.default,hcl:d.hcl,hsl:f.hsl,luminance:z,contrast:function(e,t){var n=z(e),r=z(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:x.default,format:w,utcFormat:E,utcParse:S,utcOffset:y.utcOffset,utcSequence:y.utcSequence,timeFormat:A,timeParse:C,timeOffset:y.timeOffset,timeSequence:y.timeSequence,timeUnitSpecifier:y.timeUnitSpecifier,monthFormat:function(e){return T.call(this,e,1,"%B")},monthAbbrevFormat:function(e){return T.call(this,e,1,"%b")},dayFormat:function(e){return T.call(this,0,2+e,"%A")},dayAbbrevFormat:function(e){return T.call(this,0,2+e,"%a")},quarter:i.quarter,utcquarter:i.utcquarter,week:y.week,utcweek:y.utcweek,dayofyear:y.dayofyear,utcdayofyear:y.utcdayofyear,warn:function(){return L(this.context.dataflow,"warn",arguments)},info:function(){return L(this.context.dataflow,"info",arguments)},debug:function(){return L(this.context.dataflow,"debug",arguments)},extent:i.extent,inScope:function(e){var t=this.context.group,n=!1;if(t)for(;e;){if(e===t){n=!0;break}e=e.mark.group}return n},intersect:function(e,t,n){if(!e)return[];var r=a.default(e,2),o=r[0],u=r[1],s=(new v.Bounds).set(o[0],o[1],u[0],u[1]),c=n||this.context.dataflow.scenegraph().root;return v.intersect(c,s,function(e){var t=null;if(e){var n=i.array(e.marktype),r=i.array(e.markname);t=function(e){return(!n.length||n.some((function(t){return e.marktype===t})))&&(!r.length||r.some((function(t){return e.name===t})))}}return t}(t))},clampRange:i.clampRange,pinchDistance:function(e){var t=e.touches,n=t[0].clientX-t[1].clientX,r=t[0].clientY-t[1].clientY;return Math.sqrt(n*n+r*r)},pinchAngle:function(e){var t=e.touches;return Math.atan2(t[0].clientY-t[1].clientY,t[0].clientX-t[1].clientX)},screen:function(){var e=X();return e?e.screen:{}},containerSize:function(){var e=this.context.dataflow,t=e.container&&e.container();return t?[t.clientWidth,t.clientHeight]:[void 0,void 0]},windowSize:function(){var e=X();return e?[e.innerWidth,e.innerHeight]:[void 0,void 0]},bandspace:function(e,t,n){return h.bandSpace(e||0,t||0,n||0)},setdata:function(e,t){var n=this.context.dataflow,r=this.context.data[e].input;return n.pulse(r,n.changeset().remove(i.truthy).insert(t)),1},pathShape:function(e){var t=null;return function(n){return n?v.pathRender(n,t=t||v.pathParse(e)):e}},panLinear:i.panLinear,panLog:i.panLog,panPow:i.panPow,panSymlog:i.panSymlog,zoomLinear:i.zoomLinear,zoomLog:i.zoomLog,zoomPow:i.zoomPow,zoomSymlog:i.zoomSymlog,encode:function(e,t,n){if(e){var r=this.context.dataflow,a=e.mark.source;r.pulse(a,r.changeset().encode(e,t))}return void 0!==n?n:e},modify:function(e,t,n,r,a,o){var u,s,c=this.context.dataflow,l=this.context.data[e],f=l.input,d=c.stamp(),h=l.changes;if(!1===c._trigger||!(f.value.length||t||r))return 0;if((!h||h.stamp<d)&&(l.changes=h=c.changeset(),h.stamp=d,c.runAfter((function(){l.modified=!0,c.pulse(f,h).run()}),!0,1)),n&&(u=!0===n?i.truthy:i.isArray(n)||p.isTuple(n)?n:W(n),h.remove(u)),t&&h.insert(t),r&&(u=W(r),f.value.some(u)?h.remove(u):h.insert(r)),a)for(s in o)h.modify(a,s,o[s]);return 1}},Q=["view","item","group","xy","x","y"],Z="this.",$={},ee={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:function(e){return"_[".concat(i.stringValue("$"+e),"]")},functions:function(e){var t=o.functions(e);for(var n in Q.forEach((function(e){return t[e]="event.vega."+e})),Y)t[n]=Z+n;return i.extend(t,I(e,Y,$)),t},constants:o.constants,visitors:$},te=o.codegenExpression(ee);function ne(e,t,n){return 1===arguments.length?Y[e]:(Y[e]=t,n&&($[e]=n),te&&(te.functions[e]=Z+e),this)}function re(e,t){var n,r={};try{e=i.isString(e)?e:i.stringValue(e)+"",n=o.parseExpression(e)}catch(t){i.error("Expression parse error: "+e)}n.visit((function(e){if(e.type===o.CallExpression){var n=e.callee.name,a=ee.visitors[n];a&&a(n,e.arguments,t,r)}}));var a=te(n);return a.globals.forEach((function(e){var n="$"+e;!i.hasOwnProperty(r,n)&&t.getSignal(e)&&(r[n]=t.signalRef(e))})),{$expr:i.extend({code:a.code},t.options.ast?{ast:n}:null),$fields:a.fields,$params:r}}ne("bandwidth",(function(e,t){var n=_(e,(t||this).context);return n&&n.bandwidth?n.bandwidth():0}),F),ne("copy",(function(e,t){var n=_(e,(t||this).context);return n?n.copy():void 0}),F),ne("domain",(function(e,t){var n=_(e,(t||this).context);return n?n.domain():[]}),F),ne("range",(function(e,t){var n=_(e,(t||this).context);return n&&n.range?n.range():[]}),F),ne("invert",(function(e,t,n){var r=_(e,(n||this).context);return r?i.isArray(t)?(r.invertRange||r.invert)(t):(r.invert||r.invertExtent)(t):void 0}),F),ne("scale",(function(e,t,n){var r=_(e,(n||this).context);return r?r(t):void 0}),F),ne("gradient",(function(e,t,n,r,a){e=_(e,(a||this).context);var o=v.Gradient(t,n),u=e.domain(),s=u[0],c=i.peek(u),l=i.identity;return c-s?l=h.scaleFraction(e,s,c):e=(e.interpolator?h.scale("sequential")().interpolator(e.interpolator()):h.scale("linear")().interpolate(e.interpolate()).range(e.range())).domain([s=0,c=1]),e.ticks&&(s!==(u=e.ticks(+r||15))[0]&&u.unshift(s),c!==i.peek(u)&&u.push(c)),u.forEach((function(t){return o.stop(l(t),e(t))})),o}),F),ne("geoArea",M,F),ne("geoBounds",B,F),ne("geoCentroid",P,F),ne("geoShape",(function(e,t,n){var r=_(e,(n||this).context);return function(e){return r?r.path.context(e)(t):""}}),F),ne("indata",(function(e,t,n){var r=this.context.data[e]["index:"+t],a=r?r.value.get(n):void 0;return a?a.count:a}),(function(e,t,n,r){t[0].type!==o.Literal&&i.error("First argument to indata must be a string literal."),t[1].type!==o.Literal&&i.error("Second argument to indata must be a string literal.");var a=t[0].value,u=t[1].value,s="@"+u;i.hasOwnProperty(s,r)||(r[s]=n.getData(a).indataRef(n,u))})),ne("data",b,D),ne("treePath",(function(e,t,n){var r=K(e,this),a=r[t],i=r[n];return a&&i?a.path(i).map(J):void 0}),D),ne("treeAncestors",(function(e,t){var n=K(e,this)[t];return n?n.ancestors().map(J):void 0}),D),ne("vlSelectionTest",g.selectionTest,g.selectionVisitor),ne("vlSelectionIdTest",g.selectionIdTest,g.selectionVisitor),ne("vlSelectionResolve",g.selectionResolve,g.selectionVisitor),ne("vlSelectionTuples",g.selectionTuples)})),s.register("9K8lQ",(function(e,t){n(e.exports,"Literal",(function(){return l})),n(e.exports,"CallExpression",(function(){return h})),n(e.exports,"parseExpression",(function(){return ke})),n(e.exports,"constants",(function(){return we})),n(e.exports,"functions",(function(){return Ae})),n(e.exports,"codegenExpression",(function(){return Ee}));var r,a,i,o,u,c=s("caNzv"),l="Literal",f="Property",d="ArrayExpression",p="BinaryExpression",h="CallExpression",v="ConditionalExpression",g="LogicalExpression",m="MemberExpression",y="ObjectExpression",x="UnaryExpression";function b(e){this.type=e}b.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case d:return e.elements;case p:case g:return[e.left,e.right];case h:return[e.callee].concat(e.arguments);case v:return[e.test,e.consequent,e.alternate];case m:return[e.object,e.property];case y:return e.properties;case f:return[e.key,e.value];case x:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(r={})[1]="Boolean",r[2]="<end>",r[3]="Identifier",r[4]="Keyword",r[5]="Null",r[6]="Numeric",r[7]="Punctuator",r[8]="String",r[9]="RegularExpression";var k="Identifier",w="Unexpected token %0",A="Invalid regular expression",E="Invalid regular expression: missing /",C="Octal literals are not allowed in strict mode.",S="ILLEGAL",N="Disabled.",T=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),D=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function F(e,t){if(!e)throw new Error("ASSERT: "+t)}function O(e){return e>=48&&e<=57}function _(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function I(e){return"01234567".indexOf(e)>=0}function R(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function M(e){return 10===e||13===e||8232===e||8233===e}function B(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&T.test(String.fromCharCode(e))}function P(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&D.test(String.fromCharCode(e))}var L={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function j(){for(;i<o;){var e=a.charCodeAt(i);if(!R(e)&&!M(e))break;++i}}function z(e){var t,n,r,u=0;for(n="u"===e?4:2,t=0;t<n;++t)i<o&&_(a[i])?(r=a[i++],u=16*u+"0123456789abcdef".indexOf(r.toLowerCase())):ne({},w,S);return String.fromCharCode(u)}function U(){var e,t,n,r;for(t=0,"}"===(e=a[i])&&ne({},w,S);i<o&&_(e=a[i++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&ne({},w,S),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function V(){var e,t;for(e=a.charCodeAt(i++),t=String.fromCharCode(e),92===e&&(117!==a.charCodeAt(i)&&ne({},w,S),++i,(e=z("u"))&&"\\"!==e&&B(e.charCodeAt(0))||ne({},w,S),t=e);i<o&&P(e=a.charCodeAt(i));)++i,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==a.charCodeAt(i)&&ne({},w,S),++i,(e=z("u"))&&"\\"!==e&&P(e.charCodeAt(0))||ne({},w,S),t+=e);return t}function W(){var e,t;return e=i,t=92===a.charCodeAt(i)?V():function(){var e,t;for(e=i++;i<o;){if(92===(t=a.charCodeAt(i)))return i=e,V();if(!P(t))break;++i}return a.slice(e,i)}(),{type:1===t.length?3:L.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:i}}function G(){var e,t,n,r,o=i,u=a.charCodeAt(i),s=a[i];switch(u){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++i,{type:7,value:String.fromCharCode(u),start:o,end:i};default:if(61===(e=a.charCodeAt(i+1)))switch(u){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return i+=2,{type:7,value:String.fromCharCode(u)+String.fromCharCode(e),start:o,end:i};case 33:case 61:return i+=2,61===a.charCodeAt(i)&&++i,{type:7,value:a.slice(o,i),start:o,end:i}}}return">>>="===(r=a.substr(i,4))?{type:7,value:r,start:o,end:i+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:o,end:i+=3}:s===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===t?{type:7,value:t,start:o,end:i+=2}:("//"===t&&ne({},w,S),"<>=!+-*%&|^/".indexOf(s)>=0?{type:7,value:s,start:o,end:++i}:void ne({},w,S))}function H(){var e,t,n;if(F(O((n=a[i]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=i,e="","."!==n){if(e=a[i++],n=a[i],"0"===e){if("x"===n||"X"===n)return++i,function(e){for(var t="";i<o&&_(a[i]);)t+=a[i++];return 0===t.length&&ne({},w,S),B(a.charCodeAt(i))&&ne({},w,S),{type:6,value:parseInt("0x"+t,16),start:e,end:i}}(t);if(I(n))return function(e){for(var t="0"+a[i++];i<o&&I(a[i]);)t+=a[i++];return(B(a.charCodeAt(i))||O(a.charCodeAt(i)))&&ne({},w,S),{type:6,value:parseInt(t,8),octal:!0,start:e,end:i}}(t);n&&O(n.charCodeAt(0))&&ne({},w,S)}for(;O(a.charCodeAt(i));)e+=a[i++];n=a[i]}if("."===n){for(e+=a[i++];O(a.charCodeAt(i));)e+=a[i++];n=a[i]}if("e"===n||"E"===n)if(e+=a[i++],"+"!==(n=a[i])&&"-"!==n||(e+=a[i++]),O(a.charCodeAt(i)))for(;O(a.charCodeAt(i));)e+=a[i++];else ne({},w,S);return B(a.charCodeAt(i))&&ne({},w,S),{type:6,value:parseFloat(e),start:t,end:i}}function q(){var e,t,n,r;return u=null,j(),e=i,t=function(){var e,t,n,r;for(F("/"===(e=a[i]),"Regular expression literal must start with a slash"),t=a[i++],n=!1,r=!1;i<o;)if(t+=e=a[i++],"\\"===e)M((e=a[i++]).charCodeAt(0))&&ne({},E),t+=e;else if(M(e.charCodeAt(0)))ne({},E);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||ne({},E),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";i<o&&P((e=a[i]).charCodeAt(0));)++i,"\\"===e&&i<o?ne({},w,S):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&ne({},A,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";ne({},A)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){ne({},A)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:i}}function J(){if(j(),i>=o)return{type:2,start:i,end:i};var e=a.charCodeAt(i);return B(e)?W():40===e||41===e||59===e?G():39===e||34===e?function(){var e,t,n,r,u="",s=!1;for(F("'"===(e=a[i])||'"'===e,"String literal must starts with a quote"),t=i,++i;i<o;){if((n=a[i++])===e){e="";break}if("\\"===n)if((n=a[i++])&&M(n.charCodeAt(0)))"\r"===n&&"\n"===a[i]&&++i;else switch(n){case"u":case"x":"{"===a[i]?(++i,u+=U()):u+=z(n);break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:I(n)?(0!==(r="01234567".indexOf(n))&&(s=!0),i<o&&I(a[i])&&(s=!0,r=8*r+"01234567".indexOf(a[i++]),"0123".indexOf(n)>=0&&i<o&&I(a[i])&&(r=8*r+"01234567".indexOf(a[i++]))),u+=String.fromCharCode(r)):u+=n}else{if(M(n.charCodeAt(0)))break;u+=n}}return""!==e&&ne({},w,S),{type:8,value:u,octal:s,start:t,end:i}}():46===e?O(a.charCodeAt(i+1))?H():G():O(e)?H():G()}function K(){var e=u;return i=e.end,u=J(),i=e.end,e}function X(){var e=i;u=J(),i=e}function Y(e,t,n){var r=new b("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function Q(e,t){var n=new b("CallExpression");return n.callee=e,n.arguments=t,n}function Z(e){var t=new b(k);return t.name=e,t}function $(e){var t=new b("Literal");return t.value=e.value,t.raw=a.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function ee(e,t,n){var r=new b("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function te(e,t,n){var r=new b("Property");return r.key=t,r.value=n,r.kind=e,r}function ne(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return F(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=i,n.description=a,n}function re(e){2===e.type&&ne(e,"Unexpected end of input"),6===e.type&&ne(e,"Unexpected number"),8===e.type&&ne(e,"Unexpected string"),3===e.type&&ne(e,"Unexpected identifier"),4===e.type&&ne(e,"Unexpected reserved word"),ne(e,w,e.value)}function ae(e){var t=K();7===t.type&&t.value===e||re(t)}function ie(e){return 7===u.type&&u.value===e}function oe(e){return 4===u.type&&u.value===e}function ue(){var e=[];for(i=u.start,ae("[");!ie("]");)ie(",")?(K(),e.push(null)):(e.push(xe()),ie("]")||ae(","));return K(),function(e){var t=new b("ArrayExpression");return t.elements=e,t}(e)}function se(){i=u.start;var e=K();return 8===e.type||6===e.type?(e.octal&&ne(e,C),$(e)):Z(e.value)}function ce(){var e,t,n;return i=u.start,3===(e=u).type?(n=se(),ae(":"),te("init",n,xe())):2!==e.type&&7!==e.type?(t=se(),ae(":"),te("init",t,xe())):void re(e)}function le(){var e,t,n=[],r={},a=String;for(i=u.start,ae("{");!ie("}");)t="$"+((e=ce()).key.type===k?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?ne({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),ie("}")||ae(",");return ae("}"),function(e){var t=new b("ObjectExpression");return t.properties=e,t}(n)}var fe={if:1};function de(){var e,t,n;if(ie("("))return function(){ae("(");var e=be();return ae(")"),e}();if(ie("["))return ue();if(ie("{"))return le();if(e=u.type,i=u.start,3===e||fe[u.value])n=Z(K().value);else if(8===e||6===e)u.octal&&ne(u,C),n=$(K());else{if(4===e)throw new Error(N);1===e?((t=K()).value="true"===t.value,n=$(t)):5===e?((t=K()).value=null,n=$(t)):ie("/")||ie("/=")?(n=$(q()),X()):re(K())}return n}function pe(){var e=[];if(ae("("),!ie(")"))for(;i<o&&(e.push(xe()),!ie(")"));)ae(",");return ae(")"),e}function he(){return ae("."),function(){i=u.start;var e=K();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||re(e),Z(e.value)}()}function ve(){ae("[");var e=be();return ae("]"),e}function ge(){var e=function(){var e;for(e=de();;)if(ie("."))e=ee(".",e,he());else if(ie("("))e=Q(e,pe());else{if(!ie("["))break;e=ee("[",e,ve())}return e}();if(7===u.type&&(ie("++")||ie("--")))throw new Error(N);return e}function me(){var e,t,n,r,a;if(7!==u.type&&4!==u.type)t=ge();else{if(ie("++")||ie("--"))throw new Error(N);if(ie("+")||ie("-")||ie("~")||ie("!"))e=K(),t=me(),n=e.value,r=t,(a=new b("UnaryExpression")).operator=n,a.argument=r,a.prefix=!0,t=a;else{if(oe("delete")||oe("void")||oe("typeof"))throw new Error(N);t=ge()}}return t}function ye(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function xe(){var e,t;return e=function(){var e,t,n,r,a,i,o,s,c,l;if(e=u,c=me(),0===(a=ye(r=u)))return c;for(r.prec=a,K(),t=[e,u],i=[c,r,o=me()];(a=ye(u))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),s=i.pop().value,c=i.pop(),t.pop(),n=Y(s,c,o),i.push(n);(r=K()).prec=a,i.push(r),t.push(u),n=me(),i.push(n)}for(n=i[l=i.length-1],t.pop();l>1;)t.pop(),n=Y(i[l-1].value,i[l-2],n),l-=2;return n}(),ie("?")&&(K(),t=xe(),ae(":"),e=function(e,t,n){var r=new b("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,xe())),e}function be(){var e=xe();if(ie(","))throw new Error(N);return e}function ke(e){i=0,o=(a=e).length,u=null,X();var t=be();if(2!==u.type)throw new Error("Unexpect token after expression.");return t}var we={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Ae(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&c.error("Missing arguments to clamp function."),t.length>3&&c.error("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&c.error("Missing arguments to if function."),t.length>3&&c.error("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function Ee(e){var t=(e=e||{}).allowed?c.toSet(e.allowed):{},n=e.forbidden?c.toSet(e.forbidden):{},r=e.constants||we,a=(e.functions||Ae)(d),i=e.globalvar,o=e.fieldvar,u=c.isFunction(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},s={},l={},f=0;function d(e){if(c.isString(e))return e;var t=p[e.type];return null==t&&c.error("Unsupported type: "+e.type),t(e)}var p={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return f>0?a:c.hasOwnProperty(n,a)?c.error("Illegal identifier: "+a):c.hasOwnProperty(r,a)?r[a]:c.hasOwnProperty(t,a)?a:(s[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=d(e.object);t&&(f+=1);var r=d(e.property);return n===o&&(l[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(f-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&c.error("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=c.hasOwnProperty(a,t)&&a[t];return r||c.error("Unrecognized function: "+t),c.isFunction(r)?r(n):r+"("+n.map(d).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(d).join(",")+"]"},BinaryExpression:function(e){return"("+d(e.left)+" "+e.operator+" "+d(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+d(e.argument)+")"},ConditionalExpression:function(e){return"("+d(e.test)+"?"+d(e.consequent)+":"+d(e.alternate)+")"},LogicalExpression:function(e){return"("+d(e.left)+e.operator+d(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(d).join(",")+"}"},Property:function(e){f+=1;var t=d(e.key);return f-=1,t+":"+d(e.value)}};function h(e){var t={code:d(e),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},t}return h.functions=a,h.constants=r,h}})),s.register("6ACSx",(function(e,t){n(e.exports,"selectionTest",(function(){return g})),n(e.exports,"selectionIdTest",(function(){return k})),n(e.exports,"selectionTuples",(function(){return w})),n(e.exports,"selectionResolve",(function(){return A})),n(e.exports,"selectionVisitor",(function(){return C})),s("1i51P");var r=s("4Ui3v"),a=s("9M1dW"),i=s("nS2ff"),o=s("5ZIEv"),u=s("2yWAk"),c=s("caNzv"),l=s("8GQK0"),f="intersect",d="union",p="_vgsid_",h=c.field(p);function v(e,t){for(var n,r,a=t.fields,i=t.values,o=a.length,u=0;u<o;++u)if((r=a[u]).getter=c.field.getter||c.field(r.field),n=r.getter(e),c.isDate(n)&&(n=c.toNumber(n)),c.isDate(i[u])&&(i[u]=c.toNumber(i[u])),c.isDate(i[u][0])&&(i[u]=i[u].map(c.toNumber)),"E"===r.type){if(c.isArray(i[u])?i[u].indexOf(n)<0:n!==i[u])return!1}else if("R"===r.type){if(!c.inrange(n,i[u]))return!1}else if("R-RE"===r.type){if(!c.inrange(n,i[u],!0,!1))return!1}else if("R-E"===r.type){if(!c.inrange(n,i[u],!1,!1))return!1}else if("R-LE"===r.type&&!c.inrange(n,i[u],!1,!0))return!1;return!0}function g(e,t,n){for(var r,a,i,o,u,s=this.context.data[e],c=s?s.values.value:[],l=s?s["index:unit"]&&s["index:unit"].value:void 0,d=n===f,p=c.length,h=0;h<p;++h)if(r=c[h],l&&d){if(-1===(i=(a=a||{})[o=r.unit]||0))continue;if(u=v(t,r),a[o]=u?-1:++i,u&&1===l.size)return!0;if(!u&&i===l.get(o).count)return!1}else if(d^(u=v(t,r)))return u;return p&&d}var m,y=i.default(h),x=y.left,b=y.right;function k(e,t,n){var r=this.context.data[e],a=r?r.values.value:[],i=r?r["index:unit"]&&r["index:unit"].value:void 0,o=n===f,u=h(t),s=x(a,u);if(s===a.length)return!1;if(h(a[s])!==u)return!1;if(i&&o){if(1===i.size)return!0;if(b(a,u)-s<i.size)return!1}return!0}function w(e,t){return e.map((function(e){return c.extend(t.fields?{values:t.fields.map((function(t){return(t.getter||(t.getter=c.field(t.field)))(e.datum)}))}:r.default({},p,h(e.datum)),t)}))}function A(e,t,n,i){for(var o,u,s,l,f,v,g,m,y,x,b,k,w,A,C=this.context.data[e],S=C?C.values.value:[],N={},T={},D={},F=S.length,O=0;O<F;++O)if(f=(u=S[O]).unit,s=u.fields,l=u.values,s&&l){for(k=0,w=s.length;k<w;++k)v=s[k],y=(m=N[v.field]||(N[v.field]={}))[f]||(m[f]=[]),D[v.field]=x=v.type.charAt(0),b=E["".concat(x,"_union")],m[f]=b(y,c.array(l[k]));n&&(y=T[f]||(T[f]=[])).push(c.array(l).reduce((function(e,t,n){return e[s[n].field]=t,e}),{}))}else v=p,g=h(u),(y=(m=N[v]||(N[v]={}))[f]||(m[f]=[])).push(g),n&&(y=T[f]||(T[f]=[])).push(r.default({},p,g));(t=t||d,N._vgsid_?N._vgsid_=(o=E)["".concat(p,"_").concat(t)].apply(o,a.default(Object.values(N._vgsid_))):Object.keys(N).forEach((function(e){N[e]=Object.keys(N[e]).map((function(t){return N[e][t]})).reduce((function(n,r){return void 0===n?r:E["".concat(D[e],"_").concat(t)](n,r)}))})),S=Object.keys(T),n&&S.length)&&(N[i?"vlPoint":"vlMulti"]=t===d?r.default({},"or",S.reduce((function(e,t){return(A=e).push.apply(A,a.default(T[t])),e}),[])):r.default({},"and",S.map((function(e){return r.default({},"or",T[e])}))));return N}var E=(m={},r.default(m,"".concat(p,"_union"),o.default),r.default(m,"".concat(p,"_intersect"),u.default),r.default(m,"E_union",(function(e,t){if(!e.length)return t;for(var n=0,r=t.length;n<r;++n)e.indexOf(t[n])<0&&e.push(t[n]);return e})),r.default(m,"E_intersect",(function(e,t){return e.length?e.filter((function(e){return t.indexOf(e)>=0})):t})),r.default(m,"R_union",(function(e,t){var n=c.toNumber(t[0]),r=c.toNumber(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?(e[0]>n&&(e[0]=n),e[1]<r&&(e[1]=r),e):[n,r]})),r.default(m,"R_intersect",(function(e,t){var n=c.toNumber(t[0]),r=c.toNumber(t[1]);return n>r&&(n=t[1],r=t[0]),e.length?r<e[0]||e[1]<n?[]:(e[0]<n&&(e[0]=n),e[1]>r&&(e[1]=r),e):[n,r]})),m);function C(e,t,n,r){t[0].type!==l.Literal&&c.error("First argument to selection functions must be a string literal.");var a=t[0].value,i="unit",o="@unit",u=":"+a;(t.length>=2&&c.peek(t).value)!==f||c.hasOwnProperty(r,o)||(r["@unit"]=n.getData(a).indataRef(n,i)),c.hasOwnProperty(r,u)||(r[u]=n.getData(a).tuplesRef())}})),s.register("nS2ff",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("bf5K2");function a(e){var t=e,n=e,a=e;function i(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(r<i){if(0!==n(t,t))return i;do{var o=r+i>>>1;a(e[o],t)<0?r=o+1:i=o}while(r<i)}return r}return 2!==e.length&&(t=function(t,n){return e(t)-n},n=r.default,a=function(t,n){return r.default(e(t),n)}),{left:i,center:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,o=i(e,n,r,a-1);return o>r&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length;if(r<i){if(0!==n(t,t))return i;do{var o=r+i>>>1;a(e[o],t)<=0?r=o+1:i=o}while(r<i)}return r}}}})),s.register("bf5K2",(function(e,t){function r(e,t){return null==e||null==t?NaN:e<t?-1:e>t?1:e>=t?0:NaN}n(e.exports,"default",(function(){return r}))})),s.register("2yWAk",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("2bKqM");function a(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];e=new r.InternSet(e),n=n.map(i);var o=!0,u=!1,s=void 0;try{e:for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value,d=!0,p=!1,h=void 0;try{for(var v,g=n[Symbol.iterator]();!(d=(v=g.next()).done);d=!0){var m=v.value;if(!m.has(f)){e.delete(f);continue e}}}catch(e){p=!0,h=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw h}}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return e}function i(e){return e instanceof r.InternSet?e:new r.InternSet(e)}})),s.register("2bKqM",(function(e,t){n(e.exports,"InternSet",(function(){return p})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("jZS3C"),u=s("6vecG"),c=s("2tuUj"),l=s("kRKWT"),f=s("eYQ8O"),d=s("4pZGK"),p=(d.default(Map),function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m;i.default(this,n),r=t.call(this),Object.defineProperties(o.default(r),{_intern:{value:new Map},_key:{value:a}});var u=!0,s=!1,c=void 0;if(null!=e)try{for(var l,f=e[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;r.add(d)}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}return r}return c.default(n,[{key:"has",value:function(e){return l.default(f.default(n.prototype),"has",this).call(this,h(this,e))}},{key:"add",value:function(e){return l.default(f.default(n.prototype),"add",this).call(this,v(this,e))}},{key:"delete",value:function(e){return l.default(f.default(n.prototype),"delete",this).call(this,g(this,e))}}]),n}(d.default(Set)));function h(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):t}function v(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function g(e,t){var n=e._intern,r=(0,e._key)(t);return n.has(r)&&(t=n.get(t),n.delete(r)),t}function m(e){return null!==e&&"object"==typeof e?e.valueOf():e}})),s.register("5ZIEv",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("2bKqM");function a(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=new r.InternSet,i=!0,o=!1,u=void 0,s=!0,c=!1,l=void 0;try{for(var f,d=t[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;try{for(var h,v=p[Symbol.iterator]();!(i=(h=v.next()).done);i=!0){var g=h.value;a.add(g)}}catch(e){o=!0,u=e}finally{try{i||null==v.return||v.return()}finally{if(o)throw u}}}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return a}})),s.register("8GQK0",(function(e,t){n(e.exports,"Literal",(function(){return a}));s("caNzv");var r,a="Literal",i="Property",o="ArrayExpression",u="BinaryExpression",c="CallExpression",l="ConditionalExpression",f="LogicalExpression",d="MemberExpression",p="ObjectExpression",h="UnaryExpression";function v(e){this.type=e}v.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case o:return e.elements;case u:case f:return[e.left,e.right];case c:return[e.callee].concat(e.arguments);case l:return[e.test,e.consequent,e.alternate];case d:return[e.object,e.property];case p:return e.properties;case i:return[e.key,e.value];case h:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(r={})[1]="Boolean",r[2]="<end>",r[3]="Identifier",r[4]="Keyword",r[5]="Null",r[6]="Numeric",r[7]="Punctuator",r[8]="String",r[9]="RegularExpression";new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]")})),s.register("gziXg",(function(e,t){n(e.exports,"context",(function(){return v})),s("1i51P");var r=s("9M1dW"),a=s("caNzv"),i=s("euljU");var o=a.toSet(["rule"]),u=a.toSet(["group","image","rect"]);function c(e){return(e+"").toLowerCase()}function l(e,t,n){";"!==n[n.length-1]&&(n="return("+n+");");var a=Function.apply(void 0,r.default(t.concat(n)));return e&&e.functions?a.bind(e.functions):a}var f={operator:function(e,t){return l(e,["_"],t.code)},parameter:function(e,t){return l(e,["datum","_"],t.code)},event:function(e,t){return l(e,["event"],t.code)},handler:function(e,t){return l(e,["_","event"],"var datum=event.item&&event.item.datum;return ".concat(t.code,";"))},encode:function(e,t){var n=t.marktype,r=t.channels,i="var o=item,datum=o.datum,m=0,$;";for(var s in r){var c="o["+a.stringValue(s)+"]";i+="$=".concat(r[s].code,";if(").concat(c,"!==$)").concat(c,"=$,m=1;")}return i+=function(e,t){var n="";return o[t]||(e.x2&&(e.x?(u[t]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),e.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),e.y2&&(e.y?(u[t]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),e.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),l(e,["item","_"],i+="return m;")},codegen:{get:function(e){var t="[".concat(e.map(a.stringValue).join("]["),"]"),n=Function("_","return _".concat(t,";"));return n.path=t,n},comparator:function(e,t){var n,r=Function("a","b","var u, v; return "+e.map((function(e,r){var a,i,o=t[r];return e.path?(a="a".concat(e.path),i="b".concat(e.path)):((n=n||{})["f"+r]=e,a="this.f".concat(r,"(a)"),i="this.f".concat(r,"(b)")),function(e,t,n,r){return"((u = ".concat(e,") < (v = ").concat(t,") || u == null) && v != null ? ").concat(n,"\n  : (u > v || v == null) && u != null ? ").concat(r,"\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ").concat(n,"\n  : v !== v && u === u ? ").concat(r," : ")}(a,i,-o,o)})).join("")+"0;");return n?r.bind(n):r}}};function d(e,t,n){if(!e||!a.isObject(e))return e;for(var r,i=0,o=p.length;i<o;++i)if(r=p[i],a.hasOwnProperty(e,r.key))return r.parse(e,t,n);return e}var p=[{key:"$ref",parse:function(e,t){return t.get(e.$ref)||a.error("Operator not defined: "+e.$ref)}},{key:"$key",parse:function(e,t){var n="k:"+e.$key+"_"+!!e.$flat;return t.fn[n]||(t.fn[n]=a.key(e.$key,e.$flat,t.expr.codegen))}},{key:"$expr",parse:function(e,t,n){e.$params&&t.parseParameters(e.$params,n);var r="e:"+e.$expr.code+"_"+e.$name;return t.fn[r]||(t.fn[r]=a.accessor(t.parameterExpression(e.$expr),e.$fields,e.$name))}},{key:"$field",parse:function(e,t){if(!e.$field)return null;var n="f:"+e.$field+"_"+e.$name;return t.fn[n]||(t.fn[n]=a.field(e.$field,e.$name,t.expr.codegen))}},{key:"$encode",parse:function(e,t){var n=e.$encode,r={};for(var i in n){var o=n[i];r[i]=a.accessor(t.encodeExpression(o.$expr),o.$fields),r[i].output=o.$output}return r}},{key:"$compare",parse:function(e,t){var n="c:"+e.$compare+"_"+e.$order,r=a.array(e.$compare).map((function(e){return e&&e.$tupleid?i.tupleid:e}));return t.fn[n]||(t.fn[n]=a.compare(r,e.$order,t.expr.codegen))}},{key:"$context",parse:function(e,t){return t}},{key:"$subflow",parse:function(e,t){var n=e.$subflow;return function(e,r,a){var i=t.fork().parse(n),o=i.get(n.operators[0].id),u=i.signals.parent;return u&&u.set(a),o.detachSubflow=function(){return t.detach(i)},o}}},{key:"$tupleid",parse:function(){return i.tupleid}}];var h={skip:!0};function v(e,t,n,r){return new g(e,t,n,r)}function g(e,t,n,r){this.dataflow=e,this.transforms=t,this.events=e.events.bind(e),this.expr=r||f,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function m(e){this.dataflow=e.dataflow,this.transforms=e.transforms,this.events=e.events,this.expr=e.expr,this.signals=Object.create(e.signals),this.scales=Object.create(e.scales),this.nodes=Object.create(e.nodes),this.data=Object.create(e.data),this.fn=Object.create(e.fn),e.functions&&(this.functions=Object.create(e.functions),this.functions.context=this)}g.prototype=m.prototype={fork:function(){var e=new m(this);return(this.subcontext||(this.subcontext=[])).push(e),e},detach:function(e){this.subcontext=this.subcontext.filter((function(t){return t!==e}));var t=Object.keys(e.nodes),n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;e.nodes[u]._targets=null}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}var s=!0,c=!1,l=void 0;try{for(var f,d=t[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;e.nodes[p].detach()}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}e.nodes=null},get:function(e){return this.nodes[e]},set:function(e,t){return this.nodes[e]=t},add:function(e,t){var n=function(n){var a=r.data[n]||(r.data[n]={});e.data[n].forEach((function(e){return a[e]=t}))},r=this,a=r.dataflow,i=e.value;if(r.set(e.id,t),"collect"===c(e.type)&&i&&(i.$ingest?a.ingest(t,i.$ingest,i.$format):i.$request?a.preload(t,i.$request,i.$format):a.pulse(t,a.changeset().insert(i))),e.root&&(r.root=t),e.parent){var o=r.get(e.parent.$ref);o?(a.connect(o,[t]),t.targets().add(o)):(r.unresolved=r.unresolved||[]).push((function(){o=r.get(e.parent.$ref),a.connect(o,[t]),t.targets().add(o)}))}if(e.signal&&(r.signals[e.signal]=t),e.scale&&(r.scales[e.scale]=t),e.data)for(var u in e.data)n(u)},resolve:function(){return(this.unresolved||[]).forEach((function(e){return e()})),delete this.unresolved,this},operator:function(e,t){this.add(e,this.dataflow.add(e.value,t))},transform:function(e,t){this.add(e,this.dataflow.add(this.transforms[c(t)]))},stream:function(e,t){this.set(e.id,t)},update:function(e,t,n,r,a){this.dataflow.on(t,n,r,a,e.options)},operatorExpression:function(e){return this.expr.operator(this,e)},parameterExpression:function(e){return this.expr.parameter(this,e)},eventExpression:function(e){return this.expr.event(this,e)},handlerExpression:function(e){return this.expr.handler(this,e)},encodeExpression:function(e){return this.expr.encode(this,e)},parse:function(e){var t=this,n=e.operators||[];return e.background&&(t.background=e.background),e.eventConfig&&(t.eventConfig=e.eventConfig),e.locale&&(t.locale=e.locale),n.forEach((function(e){return t.parseOperator(e)})),n.forEach((function(e){return t.parseOperatorParameters(e)})),(e.streams||[]).forEach((function(e){return t.parseStream(e)})),(e.updates||[]).forEach((function(e){return t.parseUpdate(e)})),t.resolve()},parseOperator:function(e){var t=this;"operator"!==c(e.type)&&e.type?t.transform(e,e.type):t.operator(e,e.update?t.operatorExpression(e.update):null)},parseOperatorParameters:function(e){var t=this;if(e.params){var n=t.get(e.id);n||a.error("Invalid operator id: "+e.id),t.dataflow.connect(n,n.parameters(t.parseParameters(e.params),e.react,e.initonly))}},parseParameters:function(e,t){t=t||{};var n=this;for(var r in e){var i=e[r];t[r]=a.isArray(i)?i.map((function(e){return d(e,n,t)})):d(i,n,t)}return t},parseStream:function(e){var t,n=this,r=null!=e.filter?n.eventExpression(e.filter):void 0,i=null!=e.stream?n.get(e.stream):void 0;e.source?i=n.events(e.source,e.type,r):e.merge&&(i=(t=e.merge.map((function(e){return n.get(e)})))[0].merge.apply(t[0],t.slice(1))),e.between&&(t=e.between.map((function(e){return n.get(e)})),i=i.between(t[0],t[1])),e.filter&&(i=i.filter(r)),null!=e.throttle&&(i=i.throttle(+e.throttle)),null!=e.debounce&&(i=i.debounce(+e.debounce)),null==i&&a.error("Invalid stream definition: "+JSON.stringify(e)),e.consume&&i.consume(!0),n.stream(e,i)},parseUpdate:function(e){var t,n=this,r=a.isObject(r=e.source)?r.$ref:r,i=n.get(r),o=e.update,u=void 0;i||a.error("Source not defined: "+e.source),t=e.target&&e.target.$expr?n.eventExpression(e.target.$expr):n.get(e.target),o&&o.$expr&&(o.$params&&(u=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(e,i,t,o,u)},getState:function(e){var t=this,n={};if(e.signals){var r=n.signals={};Object.keys(t.signals).forEach((function(n){var a=t.signals[n];e.signals(n,a)&&(r[n]=a.value)}))}if(e.data){var a=n.data={};Object.keys(t.data).forEach((function(n){var r=t.data[n];e.data(n,r)&&(a[n]=r.input.value)}))}return t.subcontext&&!1!==e.recurse&&(n.subcontext=t.subcontext.map((function(t){return t.getState(e)}))),n},setState:function(e){var t=this,n=t.dataflow,r=e.data,i=e.signals;Object.keys(i||{}).forEach((function(e){n.update(t.signals[e],i[e],h)})),Object.keys(r||{}).forEach((function(e){n.pulse(t.data[e].input,n.changeset().remove(a.truthy).insert(r[e]))})),(e.subcontext||[]).forEach((function(e,n){var r=t.subcontext[n];r&&r.setState(e)}))}}})),s.register("be3FW",(function(e,t){n(e.exports,"parse",(function(){return tr}));var r=s("caNzv"),a=s("7ZKwa"),i=s("djErq"),o=s("ilkKT"),u=s("euljU");function c(e){return r.isObject(e)?e:{type:e||"pad"}}var l=function(e){return+e||0};function f(e){return r.isObject(e)?e.signal?e:{top:l(e.top),bottom:l(e.bottom),left:l(e.left),right:l(e.right)}:{top:t=l(e),bottom:t,left:t,right:t};var t}var d=function(e){return r.isObject(e)&&!r.isArray(e)?r.extend({},e):{value:e}};function p(e,t,n,a){return null!=n?(r.isObject(n)&&!r.isArray(n)||r.isArray(n)&&n.length&&r.isObject(n[0])?e.update[t]=n:e[a||"enter"][t]={value:n},1):0}function h(e,t,n){for(var r in t)p(e,r,t[r]);for(var a in n)p(e,a,n[a],"update")}function v(e,t,n){for(var a in t)n&&r.hasOwnProperty(n,a)||(e[a]=r.extend(e[a]||{},t[a]));return e}function g(e,t){return t&&(t.enter&&t.enter[e]||t.update&&t.update[e])}var m="mark",y="frame",x="scope",b="legend-label",k="title-text",w="title-subtitle";function A(e,t,n){e[t]=n&&n.signal?{signal:n.signal}:{value:n}}var E=function(e){return r.isString(e)?r.stringValue(e):e.signal?"(".concat(e.signal,")"):T(e)};function C(e){if(null!=e.gradient)return function(e){var t=[e.start,e.stop,e.count].map((function(e){return null==e?null:r.stringValue(e)}));for(;t.length&&null==r.peek(t);)t.pop();return t.unshift(E(e.gradient)),"gradient(".concat(t.join(","),")")}(e);var t=e.signal?"(".concat(e.signal,")"):e.color?function(e){return e.c?S("hcl",e.h,e.c,e.l):e.h||e.s?S("hsl",e.h,e.s,e.l):e.l||e.a?S("lab",e.l,e.a,e.b):e.r||e.g||e.b?S("rgb",e.r,e.g,e.b):null}(e.color):null!=e.field?T(e.field):void 0!==e.value?r.stringValue(e.value):void 0;return null!=e.scale&&(t=function(e,t){var n=E(e.scale);null!=e.range?t="lerp(_range(".concat(n,"), ").concat(+e.range,")"):(void 0!==t&&(t="_scale(".concat(n,", ").concat(t,")")),e.band&&(t=(t?t+"+":"")+"_bandwidth(".concat(n,")")+(1==+e.band?"":"*"+N(e.band)),e.extra&&(t="(datum.extra ? _scale(".concat(n,", datum.extra.value) : ").concat(t,")"))),null==t&&(t="0"));return t}(e,t)),void 0===t&&(t=null),null!=e.exponent&&(t="pow(".concat(t,",").concat(N(e.exponent),")")),null!=e.mult&&(t+="*".concat(N(e.mult))),null!=e.offset&&(t+="+".concat(N(e.offset))),e.round&&(t="round(".concat(t,")")),t}var S=function(e,t,n,r){return"(".concat(e,"(").concat([t,n,r].map(C).join(","),")+'')")};function N(e){return r.isObject(e)?"("+C(e)+")":e}function T(e){return D(r.isObject(e)?e:{datum:e})}function D(e){var t,n,a;if(e.signal)t="datum",a=e.signal;else if(e.group||e.parent){for(n=Math.max(1,e.level||1),t="item";n-- >0;)t+=".mark.group";e.parent?(a=e.parent,t+=".datum"):a=e.group}else e.datum?(t="datum",a=e.datum):r.error("Invalid field reference: "+r.stringValue(e));return e.signal||(a=r.isString(a)?r.splitAccessPath(a).map(r.stringValue).join("]["):D(a)),t+"["+a+"]"}function F(e,t,n,a,i,o){var u={};for(var s in(o=o||{}).encoders={$encode:u},e=function(e,t,n,a,i){var o,u,s,c={},l={};for(u in u="lineBreak","text"!==t||null==i[u]||g(u,e)||A(c,u,i[u]),("legend"==n||String(n).startsWith("axis"))&&(n=null),s=n===y?i.group:n===m?r.extend({},i.mark,i[t]):null)g(u,e)||("fill"===u||"stroke"===u)&&(g("fill",e)||g("stroke",e))||A(c,u,s[u]);for(u in r.array(a).forEach((function(t){var n=i.style&&i.style[t];for(var r in n)g(r,e)||A(c,r,n[r])})),e=r.extend({},e),c)(s=c[u]).signal?(o=o||{})[u]=s:l[u]=s;return e.enter=r.extend(l,e.enter),o&&(e.update=r.extend(o,e.update)),e}(e,t,n,a,i.config),e)u[s]=O(e[s],t,o,i);return o}function O(e,t,n,a){var i,o={},u={};for(var s in e)null!=e[s]&&(o[s]=_((i=e[s],r.isArray(i)?function(e){var t="";return e.forEach((function(e){var n=C(e);t+=e.test?"(".concat(e.test,")?").concat(n,":"):n})),":"===r.peek(t)&&(t+="null"),t}(i):C(i)),a,n,u));return{$expr:{marktype:t,channels:o},$fields:Object.keys(u),$output:Object.keys(e)}}function _(e,t,n,i){var o=a.parseExpression(e,t);return o.$fields.forEach((function(e){return i[e]=1})),r.extend(n,o.$params),o.$expr}var I=["value","update","init","react","bind"];function R(e,t){r.error(e+' for "outer" push: '+r.stringValue(t))}function M(e,t){var n=e.name;if("outer"===e.push)t.signals[n]||R("No prior signal definition",n),I.forEach((function(t){void 0!==e[t]&&R("Invalid property ",t)}));else{var r=t.addSignal(n,e.value);!1===e.react&&(r.react=!1),e.bind&&t.addBinding(n,e.bind)}}function B(e,t,n,r){this.id=-1,this.type=e,this.value=t,this.params=n,r&&(this.parent=r)}function P(e,t,n,r){return new B(e,t,n,r)}function L(e,t){return P("operator",e,t)}function j(e){var t={$ref:e.id};return e.id<0&&(e.refs=e.refs||[]).push(t),t}function z(e,t){return t?{$field:e,$name:t}:{$field:e}}var U=z("key");function V(e,t){return{$compare:e,$order:t}}function W(e,t){return(e&&e.signal?"$"+e.signal:e||"")+(e&&t?"_":"")+(t&&t.signal?"$"+t.signal:t||"")}var G="scope",H="view";function q(e){return e&&e.signal}function J(e){if(q(e))return!0;if(r.isObject(e))for(var t in e)if(J(e[t]))return!0;return!1}function K(e,t){return null!=e?e:t}function X(e){return e&&e.signal||e}var Y="timer";function Q(e,t){return(e.merge?Z:e.stream?$:e.type?ee:r.error("Invalid stream specification: "+r.stringValue(e)))(e,t)}function Z(e,t){var n=te({merge:e.merge.map((function(e){return Q(e,t)}))},e,t);return t.addStream(n).id}function $(e,t){var n=te({stream:Q(e.stream,t)},e,t);return t.addStream(n).id}function ee(e,t){var n,r;e.type===Y?(n=t.event(Y,e.throttle),e={between:e.between,filter:e.filter}):n=t.event((r=e.source)===G?H:r||H,e.type);var a=te({stream:n},e,t);return 1===Object.keys(a).length?n:t.addStream(a).id}function te(e,t,n){var i=t.between;return i&&(2!==i.length&&r.error('Stream "between" parameter must have 2 entries: '+r.stringValue(t)),e.between=[Q(i[0],n),Q(i[1],n)]),i=t.filter?[].concat(t.filter):[],(t.marktype||t.markname||t.markrole)&&i.push(function(e,t,n){var r="event.item";return r+(e&&"*"!==e?"&&"+r+".mark.marktype==='"+e+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(t?"&&"+r+".mark.name==='"+t+"'":"")}(t.marktype,t.markname,t.markrole)),t.source===G&&i.push("inScope(event.item)"),i.length&&(e.filter=a.parseExpression("("+i.join(")&&(")+")",n).$expr),null!=(i=t.throttle)&&(e.throttle=+i),null!=(i=t.debounce)&&(e.debounce=+i),t.consume&&(e.consume=!0),e}var ne={code:"_.$value",ast:{type:"Identifier",value:"value"}};function re(e,t,n){var o=e.encode,u={target:n},s=e.events,c=e.update,l=[];s||r.error("Signal update missing events specification."),r.isString(s)&&(s=i.parseSelector(s,t.isSubscope()?G:H)),s=r.array(s).filter((function(e){return e.signal||e.scale?(l.push(e),0):1})),l.length>1&&(l=[ae(l)]),s.length&&l.push(s.length>1?{merge:s}:s[0]),null!=o&&(c&&r.error("Signal encode and update are mutually exclusive."),c="encode(item(),"+r.stringValue(o)+")"),u.update=r.isString(c)?a.parseExpression(c,t):null!=c.expr?a.parseExpression(c.expr,t):null!=c.value?c.value:null!=c.signal?{$expr:ne,$params:{$value:t.signalRef(c.signal)}}:r.error("Invalid signal update specification."),e.force&&(u.options={force:!0}),l.forEach((function(e){return t.addUpdate(r.extend(function(e,t){return{source:e.signal?t.signalRef(e.signal):e.scale?t.scaleRef(e.scale):Q(e,t)}}(e,t),u))}))}function ae(e){return{signal:"["+e.map((function(e){return e.scale?'scale("'+e.scale+'")':e.signal}))+"]"}}var ie=function(e){return function(t,n,r){return P(e,n,t||void 0,r)}},oe=ie("aggregate"),ue=ie("axisticks"),se=ie("bound"),ce=ie("collect"),le=ie("compare"),fe=ie("datajoin"),de=ie("encode"),pe=ie("expression"),he=ie("facet"),ve=ie("field"),ge=ie("key"),me=ie("legendentries"),ye=ie("load"),xe=ie("mark"),be=ie("multiextent"),ke=ie("multivalues"),we=ie("overlap"),Ae=ie("params"),Ee=ie("prefacet"),Ce=ie("projection"),Se=ie("proxy"),Ne=ie("relay"),Te=ie("render"),De=ie("scale"),Fe=ie("sieve"),Oe=ie("sortitems"),_e=ie("viewlayout"),Ie=ie("values"),Re=0,Me={min:"min",max:"max",count:"sum"};function Be(e,t){var n,a,i=t.getScale(e.name).params;for(n in i.domain=ze(e.domain,e,t),null!=e.range&&(i.range=Ke(e,t,i)),null!=e.interpolate&&function(e,t){t.interpolate=Pe(e.type||e),null!=e.gamma&&(t.interpolateGamma=Pe(e.gamma))}(e.interpolate,i),null!=e.nice&&(i.nice=(a=e.nice,r.isObject(a)?{interval:Pe(a.interval),step:Pe(a.step)}:Pe(a))),null!=e.bins&&(i.bins=function(e,t){return e.signal||r.isArray(e)?Le(e,t):t.objectProperty(e)}(e.bins,t)),e)r.hasOwnProperty(i,n)||"name"===n||(i[n]=Pe(e[n],t))}function Pe(e,t){return r.isObject(e)?e.signal?t.signalRef(e.signal):r.error("Unsupported object: "+r.stringValue(e)):e}function Le(e,t){return e.signal?t.signalRef(e.signal):e.map((function(e){return Pe(e,t)}))}function je(e){r.error("Can not find data set: "+r.stringValue(e))}function ze(e,t,n){if(e)return e.signal?n.signalRef(e.signal):(r.isArray(e)?Ue:e.fields?We:Ve)(e,t,n);null==t.domainMin&&null==t.domainMax||r.error("No scale domain defined for domainMin/domainMax to override.")}function Ue(e,t,n){return e.map((function(e){return Pe(e,n)}))}function Ve(e,t,n){var r=n.getData(e.data);return r||je(e.data),o.isDiscrete(t.type)?r.valuesRef(n,e.field,He(e.sort,!1)):o.isQuantile(t.type)?r.domainRef(n,e.field):r.extentRef(n,e.field)}function We(e,t,n){var a=e.data,i=e.fields.reduce((function(e,t){return t=r.isString(t)?{data:a,field:t}:r.isArray(t)||t.signal?function(e,t){var n="_:vega:_"+Re++,a=ce({});if(r.isArray(e))a.value={$ingest:e};else if(e.signal){var i="setdata("+r.stringValue(n)+","+e.signal+")";a.params.input=t.signalRef(i)}return t.addDataPipeline(n,[a,Fe({})]),{data:n,field:"data"}}(t,n):t,e.push(t),e}),[]);return(o.isDiscrete(t.type)?Ge:o.isQuantile(t.type)?qe:Je)(e,n,i)}function Ge(e,t,n){var r,a,i=He(e.sort,!0),o=n.map((function(e){var n=t.getData(e.data);return n||je(e.data),n.countsRef(t,e.field,i)})),u={groupby:U,pulse:o};i&&(r=i.op||"count",a=i.field?W(r,i.field):"count",u.ops=[Me[r]],u.fields=[t.fieldRef(a)],u.as=[a]),r=t.add(oe(u));var s=t.add(ce({pulse:j(r)}));return a=t.add(Ie({field:U,sort:t.sortRef(i),pulse:j(s)})),j(a)}function He(e,t){return e&&(e.field||e.op?e.field||"count"===e.op?t&&e.field&&e.op&&!Me[e.op]&&r.error("Multiple domain scales can not be sorted using "+e.op):r.error("No field provided for sort aggregate op: "+e.op):r.isObject(e)?e.field="key":e={field:"key"}),e}function qe(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||je(e.data),n.domainRef(t,e.field)}));return j(t.add(ke({values:r})))}function Je(e,t,n){var r=n.map((function(e){var n=t.getData(e.data);return n||je(e.data),n.extentRef(t,e.field)}));return j(t.add(be({extents:r})))}function Ke(e,t,n){var a=t.config.range,i=e.range;if(i.signal)return t.signalRef(i.signal);if(r.isString(i)){if(a&&r.hasOwnProperty(a,i))return Ke(e=r.extend({},e,{range:a[i]}),t,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=o.isDiscrete(e.type)?[0,{signal:"height"}]:[{signal:"height"},0]:r.error("Unrecognized scale range value: "+r.stringValue(i))}else{if(i.scheme)return n.scheme=r.isArray(i.scheme)?Le(i.scheme,t):Pe(i.scheme,t),i.extent&&(n.schemeExtent=Le(i.extent,t)),void(i.count&&(n.schemeCount=Pe(i.count,t)));if(i.step)return void(n.rangeStep=Pe(i.step,t));if(o.isDiscrete(e.type)&&!r.isArray(i))return ze(i,e,t);r.isArray(i)||r.error("Unsupported range type: "+r.stringValue(i))}return i.map((function(e){return(r.isArray(e)?Le:Pe)(e,t)}))}function Xe(e,t,n){return r.isArray(e)?e.map((function(e){return Xe(e,t,n)})):r.isObject(e)?e.signal?n.signalRef(e.signal):"fit"===t?e:r.error("Unsupported parameter object: "+r.stringValue(e)):e}var Ye="top",Qe="left",Ze="right",$e="bottom",et="center",tt="index",nt="label",rt="perc",at="value",it="guide-label",ot="guide-title",ut="group-title",st="group-subtitle",ct="symbol",lt="gradient",ft="discrete",dt="size",pt=[dt,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],ht={name:1,style:1,interactive:1},vt={value:0},gt={value:1},mt="group",yt="rect",xt="rule",bt="text";function kt(e){return e.type=mt,e.interactive=e.interactive||!1,e}function wt(e,t){var n=function(n,r){return K(e[n],K(t[n],r))};return n.isVertical=function(n){return"vertical"===K(e.direction,t.direction||(n?t.symbolDirection:t.gradientDirection))},n.gradientLength=function(){return K(e.gradientLength,t.gradientLength||t.gradientWidth)},n.gradientThickness=function(){return K(e.gradientThickness,t.gradientThickness||t.gradientHeight)},n.entryColumns=function(){return K(e.columns,K(t.columns,+n.isVertical(!0)))},n}function At(e,t){var n=t&&(t.update&&t.update[e]||t.enter&&t.enter[e]);return n&&n.signal?n:n?n.value:null}function Et(e,t,n){return"item.anchor === '".concat("start","' ? ").concat(e," : item.anchor === '").concat("end","' ? ").concat(t," : ").concat(n)}var Ct=Et(r.stringValue(Qe),r.stringValue(Ze),r.stringValue(et));function St(e,t){return t?e?r.isObject(e)?Object.assign({},e,{offset:St(e.offset,t)}):{value:e,offset:t}:t:e}function Nt(e,t){return t?(e.name=t.name,e.style=t.style||e.style,e.interactive=!!t.interactive,e.encode=v(e.encode,t,ht)):e.interactive=!1,e}function Tt(e,t,n,a){var i,o,u,s,c,l=wt(e,n),f=l.isVertical(),p=l.gradientThickness(),v=l.gradientLength();f?(o=[0,1],u=[0,0],s=p,c=v):(o=[0,0],u=[1,0],s=v,c=p);var g={enter:i={opacity:vt,x:vt,y:vt,width:d(s),height:d(c)},update:r.extend({},i,{opacity:gt,fill:{gradient:t,start:o,stop:u}}),exit:{opacity:vt}};return h(g,{stroke:l("gradientStrokeColor"),strokeWidth:l("gradientStrokeWidth")},{opacity:l("gradientOpacity")}),Nt({type:yt,role:"legend-gradient",encode:g},a)}function Dt(e,t,n,a,i){var o,u,s,c,l=wt(e,n),f=l.isVertical(),p=l.gradientThickness(),v=l.gradientLength(),g="";f?(o="y",s="y2",u="x",c="width",g="1-"):(o="x",s="x2",u="y",c="height");var m={opacity:vt,fill:{scale:t,field:at}};m[o]={signal:g+"datum."+rt,mult:v},m[u]=vt,m[s]={signal:g+"datum.perc2",mult:v},m[c]=d(p);var y={enter:m,update:r.extend({},m,{opacity:gt}),exit:{opacity:vt}};return h(y,{stroke:l("gradientStrokeColor"),strokeWidth:l("gradientStrokeWidth")},{opacity:l("gradientOpacity")}),Nt({type:yt,role:"legend-band",key:at,from:i,encode:y},a)}var Ft="datum.".concat(rt,'<=0?"').concat(Qe,'":datum.').concat(rt,'>=1?"').concat(Ze,'":"').concat(et,'"'),Ot="datum.".concat(rt,'<=0?"').concat($e,'":datum.').concat(rt,'>=1?"').concat(Ye,'":"').concat("middle",'"');function _t(e,t,n,r){var a,i,o,u,s=wt(e,t),c=s.isVertical(),l=d(s.gradientThickness()),f=s.gradientLength(),p=s("labelOverlap"),v="",g={enter:a={opacity:vt},update:i={opacity:gt,text:{field:nt}},exit:{opacity:vt}};return h(g,{fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontStyle:s("labelFontStyle"),fontWeight:s("labelFontWeight"),limit:K(e.labelLimit,t.gradientLabelLimit)}),c?(a.align={value:"left"},a.baseline=i.baseline={signal:Ot},o="y",u="x",v="1-"):(a.align=i.align={signal:Ft},a.baseline={value:"top"},o="x",u="y"),a[o]=i[o]={signal:v+"datum."+rt,mult:f},a[u]=i[u]=l,l.offset=K(e.labelOffset,t.gradientLabelOffset)||0,p=p?{separation:s("labelSeparation"),method:p,order:"datum.index"}:void 0,Nt({type:bt,role:b,style:it,key:at,from:r,encode:g,overlap:p},n)}function It(e,t,n,r,a){var i,o,u,s,c,l=wt(e,t),f=n.entries,p=!(!f||!f.interactive),g=f?f.name:void 0,m=l("clipHeight"),y=l("symbolOffset"),k={data:"value"},w="(".concat(a,") ? datum.").concat("offset"," : datum.").concat(dt),A=m?d(m):{field:dt},E="datum.".concat(tt),C="max(1, ".concat(a,")");A.mult=.5,i={enter:o={opacity:vt,x:{signal:w,mult:.5,offset:y},y:A},update:u={opacity:gt,x:o.x,y:o.y},exit:{opacity:vt}};var S=null,N=null;e.fill||(S=t.symbolBaseFillColor,N=t.symbolBaseStrokeColor),h(i,{fill:l("symbolFillColor",S),shape:l("symbolType"),size:l("symbolSize"),stroke:l("symbolStrokeColor",N),strokeDash:l("symbolDash"),strokeDashOffset:l("symbolDashOffset"),strokeWidth:l("symbolStrokeWidth")},{opacity:l("symbolOpacity")}),pt.forEach((function(t){e[t]&&(u[t]=o[t]={scale:e[t],field:at})}));var T=Nt({type:"symbol",role:"legend-symbol",key:at,from:k,clip:!!m||void 0,encode:i},n.symbols),D=d(y);D.offset=l("labelOffset"),h(i={enter:o={opacity:vt,x:{signal:w,offset:D},y:A},update:u={opacity:gt,text:{field:nt},x:o.x,y:o.y},exit:{opacity:vt}},{align:l("labelAlign"),baseline:l("labelBaseline"),fill:l("labelColor"),fillOpacity:l("labelOpacity"),font:l("labelFont"),fontSize:l("labelFontSize"),fontStyle:l("labelFontStyle"),fontWeight:l("labelFontWeight"),limit:l("labelLimit")});var F=Nt({type:bt,role:b,style:it,key:at,from:k,encode:i},n.labels);return i={enter:{noBound:{value:!m},width:vt,height:m?d(m):vt,opacity:vt},exit:{opacity:vt},update:u={opacity:gt,row:{signal:null},column:{signal:null}}},l.isVertical(!0)?(s="ceil(item.mark.items.length / ".concat(C,")"),u.row.signal="".concat(E,"%").concat(s),u.column.signal="floor(".concat(E," / ").concat(s,")"),c={field:["row",E]}):(u.row.signal="floor(".concat(E," / ").concat(C,")"),u.column.signal="".concat(E," % ").concat(C),c={field:E}),u.column.signal="(".concat(a,")?").concat(u.column.signal,":").concat(E),kt({role:x,from:r={facet:{data:r,name:"value",groupby:tt}},encode:v(i,f,ht),marks:[T,F],name:g,interactive:p,sort:c})}var Rt='item.orient === "left"',Mt='item.orient === "right"',Bt="(".concat(Rt," || ").concat(Mt,")"),Pt="datum.vgrad && ".concat(Bt),Lt=Et('"top"','"bottom"','"middle"'),jt=Et('"right"','"left"','"center"'),zt="datum.vgrad && ".concat(Mt," ? (").concat(jt,") : (").concat(Bt," && !(datum.vgrad && ").concat(Rt,')) ? "left" : ').concat(Ct),Ut="item._anchor || (".concat(Bt,' ? "middle" : "start")'),Vt="".concat(Pt," ? (").concat(Rt," ? -90 : 90) : 0"),Wt="".concat(Bt," ? (datum.vgrad ? (").concat(Mt,' ? "bottom" : "top") : ').concat(Lt,') : "top"');function Gt(e,t){var n;return r.isObject(e)&&(e.signal?n=e.signal:e.path?n="pathShape("+Ht(e.path)+")":e.sphere&&(n="geoShape("+Ht(e.sphere)+', {type: "Sphere"})')),n?t.signalRef(n):!!e}function Ht(e){return r.isObject(e)&&e.signal?e.signal:r.stringValue(e)}function qt(e){var t=e.role||"";return t.indexOf("axis")&&t.indexOf("legend")&&t.indexOf("title")?e.type===mt?x:t||m:t}function Jt(e){return{marktype:e.type,name:e.name||void 0,role:e.role||qt(e),zindex:+e.zindex||void 0,aria:e.aria,description:e.description}}function Kt(e,t){return e&&e.signal?t.signalRef(e.signal):!1!==e}function Xt(e,t){var n=u.definition(e.type);n||r.error("Unrecognized transform type: "+r.stringValue(e.type));var a=P(n.type.toLowerCase(),null,Yt(n,e,t));return e.signal&&t.addSignal(e.signal,t.proxy(a)),a.metadata=n.metadata||{},a}function Yt(e,t,n){for(var r={},a=e.params.length,i=0;i<a;++i){var o=e.params[i];r[o.name]=Qt(o,t,n)}return r}function Qt(e,t,n){var a=e.type,i=t[e.name];return"index"===a?function(e,t,n){r.isString(t.from)||r.error('Lookup "from" parameter must be a string literal.');return n.getData(t.from).lookupRef(n,t.key)}(0,t,n):void 0!==i?"param"===a?function(e,t,n){var a=t[e.name];return e.array?(r.isArray(a)||r.error("Expected an array of sub-parameters. Instead: "+r.stringValue(a)),a.map((function(t){return $t(e,t,n)}))):$t(e,a,n)}(e,t,n):"projection"===a?n.projectionRef(t[e.name]):e.array&&!q(i)?i.map((function(t){return Zt(e,t,n)})):Zt(e,i,n):void(e.required&&r.error("Missing required "+r.stringValue(t.type)+" parameter: "+r.stringValue(e.name)))}function Zt(e,t,n){var i=e.type;if(q(t))return rn(i)?r.error("Expression references can not be signals."):an(i)?n.fieldRef(t):on(i)?n.compareRef(t):n.signalRef(t.signal);var o=e.expr||an(i);return o&&en(t)?n.exprRef(t.expr,t.as):o&&tn(t)?z(t.field,t.as):rn(i)?a.parseExpression(t,n):nn(i)?j(n.getData(t).values):an(i)?z(t):on(i)?n.compareRef(t):t}function $t(e,t,n){for(var a,i=e.params.length,o=0;o<i;++o){for(var u in(a=e.params[o]).key)if(a.key[u]!==t[u]){a=null;break}if(a)break}a||r.error("Unsupported parameter: "+r.stringValue(t));var s=r.extend(Yt(a,t,n),a.key);return j(n.add(Ae(s)))}var en=function(e){return e&&e.expr},tn=function(e){return e&&e.field},nn=function(e){return"data"===e},rn=function(e){return"expr"===e},an=function(e){return"field"===e},on=function(e){return"compare"===e};function un(e,t){return e.$ref?e:e.data&&e.data.$ref?e.data:j(t.getData(e.data).output)}function sn(e,t,n,r,a){this.scope=e,this.input=t,this.output=n,this.values=r,this.aggregate=a,this.index={}}function cn(e){return r.isString(e)?e:null}function ln(e,t,n){var r,a=W(n.op,n.field);if(t.ops){for(var i=0,o=t.as.length;i<o;++i)if(t.as[i]===a)return}else t.ops=["count"],t.fields=[null],t.as=["count"];n.op&&(t.ops.push((r=n.op.signal)?e.signalRef(r):n.op),t.fields.push(e.fieldRef(n.field)),t.as.push(a))}function fn(e,t,n,a,i,o,u){var s,c,l=t[n]||(t[n]={}),f=function(e){return r.isObject(e)?("descending"===e.order?"-":"+")+W(e.op,e.field):""}(o),d=cn(i);if(null!=d&&(e=t.scope,s=l[d+=f?"|"+f:""]),!s){var p=o?{field:U,pulse:t.countsRef(e,i,o)}:{field:e.fieldRef(i),pulse:j(t.output)};f&&(p.sort=e.sortRef(o)),c=e.add(P(a,void 0,p)),u&&(t.index[i]=c),s=j(c),null!=d&&(l[d]=s)}return s}function dn(e,t,n){var r=e.remove,i=e.insert,o=e.toggle,u=e.modify,s=e.values,c=t.add(L()),l="if("+e.trigger+',modify("'+n+'",'+[i,r,o,u,s].map((function(e){return null==e?"null":e})).join(",")+"),0)",f=a.parseExpression(l,t);c.update=f.$expr,c.params=f.$params}function pn(e,t){var n,a,i,o,u,s,c,l=qt(e),f=e.type===mt,d=e.from&&e.from.facet,p=e.overlap,h=e.layout||l===x||l===y,v=l===m||h||d,g=function(e,t,n){var a,i,o,u,s;return e?(a=e.facet)&&(t||r.error("Only group marks can be faceted."),null!=a.field?u=s=un(a,n):(e.data?s=j(n.getData(e.data).aggregate):((o=Xt(r.extend({type:"aggregate",groupby:r.array(a.groupby)},a.aggregate),n)).params.key=n.keyRef(a.groupby),o.params.pulse=un(a,n),u=s=j(n.add(o))),i=n.keyRef(a.groupby,!0))):u=j(n.add(ce(null,[{}]))),u||(u=un(e,n)),{key:i,pulse:u,parent:s}}(e.from,f,t),b=j(a=t.add(fe({key:g.key||(e.key?z(e.key):void 0),pulse:g.pulse,clean:!f})));a=i=t.add(ce({pulse:b})),a=t.add(xe({markdef:Jt(e),interactive:Kt(e.interactive,t),clip:Gt(e.clip,t),context:{$context:!0},groups:t.lookup(),parent:t.signals.parent?t.signalRef("parent"):null,index:t.markpath(),pulse:j(a)}));var k=j(a);(a=o=t.add(de(F(e.encode,e.type,l,e.style,t,{mod:!1,pulse:k})))).params.parent=t.encode(),e.transform&&e.transform.forEach((function(e){var n=Xt(e,t),i=n.metadata;(i.generates||i.changes)&&r.error("Mark transforms should not generate new data."),i.nomod||(o.params.mod=!0),n.params.pulse=j(a),t.add(a=n)})),e.sort&&(a=t.add(Oe({sort:t.compareRef(e.sort),pulse:j(a)})));var w=j(a);(d||h)&&(s=j(h=t.add(_e({layout:t.objectProperty(e.layout),legends:t.legends,mark:k,pulse:w}))));var A=t.add(se({mark:k,pulse:s||w}));c=j(A),f&&(v&&((n=t.operators).pop(),h&&n.pop()),t.pushState(w,s||c,b),d?function(e,t,n){var a,i=e.from.facet,o=i.name,u=un(i,t);i.name||r.error("Facet must have a name: "+r.stringValue(i)),i.data||r.error("Facet must reference a data set: "+r.stringValue(i)),i.field?a=t.add(Ee({field:t.fieldRef(i.field),pulse:u})):i.groupby?a=t.add(he({key:t.keyRef(i.groupby),group:j(t.proxy(n.parent)),pulse:u})):r.error("Facet must specify groupby or field: "+r.stringValue(i));var s=t.fork(),c=s.add(ce()),l=s.add(Fe({pulse:j(c)}));s.addData(o,new sn(s,c,c,l)),s.addSignal("parent",null),a.params.subflow={$subflow:s.parse(e).toRuntime()}}(e,t,g):v?function(e,t,n){var r=t.add(Ee({pulse:n.pulse})),a=t.fork();a.add(Fe()),a.addSignal("parent",null),r.params.subflow={$subflow:a.parse(e).toRuntime()}}(e,t,g):t.parse(e),t.popState(),v&&(h&&n.push(h),n.push(A))),p&&(c=function(e,t,n){var r=e.method,a=e.bound,i=e.separation,o={separation:q(i)?n.signalRef(i.signal):i,method:q(r)?n.signalRef(r.signal):r,pulse:t};e.order&&(o.sort=n.compareRef({field:e.order}));if(a){var u=a.tolerance;o.boundTolerance=q(u)?n.signalRef(u.signal):+u,o.boundScale=n.scaleRef(a.scale),o.boundOrient=a.orient}return j(n.add(we(o)))}(p,c,t));var E=t.add(Te({pulse:c})),C=t.add(Fe({pulse:j(E)},void 0,t.parent()));null!=e.name&&(u=e.name,t.addData(u,new sn(t,i,E,C)),e.on&&e.on.forEach((function(e){(e.insert||e.remove||e.toggle)&&r.error("Marks only support modify triggers."),dn(e,t,u)})))}function hn(e,t){var n,i,u,s=t.config.legend,c=e.encode||{},l=wt(e,s),f=c.legend||{},d=f.name||void 0,p=f.interactive,g=f.style,m={},y=0;pt.forEach((function(t){return e[t]?(m[t]=e[t],y=y||e[t]):0})),y||r.error("Missing valid scale for legend.");var x=function(e,t){var n=e.type||ct;e.type||1!==function(e){return pt.reduce((function(t,n){return t+(e[n]?1:0)}),0)}(e)||!e.fill&&!e.stroke||(n=o.isContinuous(t)?lt:o.isDiscretizing(t)?ft:ct);return n!==lt?n:o.isDiscretizing(t)?ft:lt}(e,t.scaleType(y)),b={title:null!=e.title,scales:m,type:x,vgrad:"symbol"!==x&&l.isVertical()},k=j(t.add(ce(null,[b]))),w=j(t.add(me(i={type:x,scale:t.scaleRef(y),count:t.objectProperty(l("tickCount")),limit:t.property(l("symbolLimit")),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)})));return x===lt?(u=[Tt(e,y,s,c.gradient),_t(e,s,c.labels,w)],i.count=i.count||t.signalRef("max(2,2*floor((".concat(X(l.gradientLength()),")/100))"))):x===ft?u=[Dt(e,y,s,c.gradient,w),_t(e,s,c.labels,w)]:(n=function(e,t){var n=wt(e,t);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(e,s),u=[It(e,s,c,w,X(n.columns))],i.size=function(e,t,n){var r=X(gn("size",e,n)),i=X(gn("strokeWidth",e,n)),o=X(function(e,t,n){return At("fontSize",e)||function(e,t,n){var r=t.config.style[n];return r&&r[e]}("fontSize",t,n)}(n[1].encode,t,it));return a.parseExpression("max(ceil(sqrt(".concat(r,")+").concat(i,"),").concat(o,")"),t)}(e,t,u[0].marks)),u=[kt({role:"legend-entry",from:k,encode:{enter:{x:{value:0},y:{value:0}}},marks:u,layout:n,interactive:p})],b.title&&u.push(function(e,t,n,r){var a=wt(e,t),i={enter:{opacity:vt},update:{opacity:gt,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:vt}};return h(i,{orient:a("titleOrient"),_anchor:a("titleAnchor"),anchor:{signal:Ut},angle:{signal:Vt},align:{signal:zt},baseline:{signal:Wt},text:e.title,fill:a("titleColor"),fillOpacity:a("titleOpacity"),font:a("titleFont"),fontSize:a("titleFontSize"),fontStyle:a("titleFontStyle"),fontWeight:a("titleFontWeight"),limit:a("titleLimit"),lineHeight:a("titleLineHeight")},{align:a("titleAlign"),baseline:a("titleBaseline")}),Nt({type:bt,role:"legend-title",style:ot,from:r,encode:i},n)}(e,s,c.title,k)),pn(kt({role:"legend",from:k,encode:v(vn(l,e,s),f,ht),marks:u,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:d,interactive:p,style:g}),t)}function vn(e,t,n){var r={enter:{},update:{}};return h(r,{orient:e("orient"),offset:e("offset"),padding:e("padding"),titlePadding:e("titlePadding"),cornerRadius:e("cornerRadius"),fill:e("fillColor"),stroke:e("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:e("legendX"),y:e("legendY"),format:t.format,formatType:t.formatType}),r}function gn(e,t,n){return t[e]?'scale("'.concat(t[e],'",datum)'):At(e,n[0].encode)}sn.fromEntries=function(e,t){var n=t.length,r=t[n-1],a=t[n-2],i=t[0],o=null,u=1;for(i&&"load"===i.type&&(i=t[1]),e.add(t[0]);u<n;++u)t[u].params.pulse=j(t[u-1]),e.add(t[u]),"aggregate"===t[u].type&&(o=t[u]);return new sn(e,i,a,r,o)},sn.prototype={countsRef:function(e,t,n){var r,a,i,o=this,u=o.counts||(o.counts={}),s=cn(t);return null!=s&&(e=o.scope,r=u[s]),r?n&&n.field&&ln(e,r.agg.params,n):(i={groupby:e.fieldRef(t,"key"),pulse:j(o.output)},n&&n.field&&ln(e,i,n),a=e.add(oe(i)),r=e.add(ce({pulse:j(a)})),r={agg:a,ref:j(r)},null!=s&&(u[s]=r)),r.ref},tuplesRef:function(){return j(this.values)},extentRef:function(e,t){return fn(e,this,"extent","extent",t,!1)},domainRef:function(e,t){return fn(e,this,"domain","values",t,!1)},valuesRef:function(e,t,n){return fn(e,this,"vals","values",t,n||!0)},lookupRef:function(e,t){return fn(e,this,"lookup","tupleindex",t,!1)},indataRef:function(e,t){return fn(e,this,"indata","tupleindex",t,!0,!0)}};var mn='item.orient==="'.concat(Qe,'"?-90:item.orient==="').concat(Ze,'"?90:0');function yn(e,t){var n=wt(e=r.isString(e)?{text:e}:e,t.config.title),a=e.encode||{},i=a.group||{},o=i.name||void 0,u=i.interactive,s=i.style,c=[],l=j(t.add(ce(null,[{}])));return c.push(function(e,t,n,r){var a={value:0},i=e.text,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return h(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("color"),font:t("font"),fontSize:t("fontSize"),fontStyle:t("fontStyle"),fontWeight:t("fontWeight"),lineHeight:t("lineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Nt({type:bt,role:k,style:ut,from:r,encode:o},n)}(e,n,function(e){var t=e.encode;return t&&t.title||r.extend({name:e.name,interactive:e.interactive,style:e.style},t)}(e),l)),e.subtitle&&c.push(function(e,t,n,r){var a={value:0},i=e.subtitle,o={enter:{opacity:a},update:{opacity:{value:1}},exit:{opacity:a}};return h(o,{text:i,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:t("dx"),dy:t("dy"),fill:t("subtitleColor"),font:t("subtitleFont"),fontSize:t("subtitleFontSize"),fontStyle:t("subtitleFontStyle"),fontWeight:t("subtitleFontWeight"),lineHeight:t("subtitleLineHeight")},{align:t("align"),angle:t("angle"),baseline:t("baseline")}),Nt({type:bt,role:w,style:st,from:r,encode:o},n)}(e,n,a.subtitle,l)),pn(kt({role:"title",from:l,encode:xn(n,i),marks:c,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:u,style:s}),t)}function xn(e,t){var n={enter:{},update:{}};return h(n,{orient:e("orient"),anchor:e("anchor"),align:{signal:Ct},angle:{signal:mn},limit:e("limit"),frame:e("frame"),offset:e("offset")||0,padding:e("subtitlePadding")}),v(n,t,ht)}function bn(e,t){var n=[];e.transform&&e.transform.forEach((function(e){n.push(Xt(e,t))})),e.on&&e.on.forEach((function(n){dn(n,t,e.name)})),t.addDataPipeline(e.name,function(e,t,n){var a,i,o,u,s,c=[],l=null,f=!1,d=!1;e.values?q(e.values)||J(e.format)?(c.push(wn(t,e)),c.push(l=kn())):c.push(l=kn({$ingest:e.values,$format:e.format})):e.url?J(e.url)||J(e.format)?(c.push(wn(t,e)),c.push(l=kn())):c.push(l=kn({$request:e.url,$format:e.format})):e.source&&(l=a=r.array(e.source).map((function(e){return j(t.getData(e).output)})),c.push(null));for(i=0,o=n.length;i<o;++i)s=(u=n[i]).metadata,l||s.source||c.push(l=kn()),c.push(u),s.generates&&(d=!0),s.modifies&&!d&&(f=!0),s.source?l=u:s.changes&&(l=null);a&&(o=a.length-1,c[0]=Ne({derive:f,pulse:o?a:a[0]}),(f||o)&&c.splice(1,0,kn()));l||c.push(kn());return c.push(Fe({})),c}(e,t,n))}function kn(e){var t=ce({},e);return t.metadata={source:!0},t}function wn(e,t){return ye({url:t.url?e.property(t.url):void 0,async:t.async?e.property(t.async):void 0,values:t.values?e.property(t.values):void 0,format:e.objectProperty(t.format)})}var An=function(e){return e===$e||e===Ye},En=function(e,t,n){return q(e)?Fn(e.signal,t,n):e===Qe||e===Ye?t:n},Cn=function(e,t,n){return q(e)?Tn(e.signal,t,n):An(e)?t:n},Sn=function(e,t,n){return q(e)?Dn(e.signal,t,n):An(e)?n:t},Nn=function(e,t,n){return q(e)?On(e.signal,t,n):e===Ye?{value:t}:{value:n}},Tn=function(e,t,n){return In("".concat(e," === '").concat(Ye,"' || ").concat(e," === '").concat($e,"'"),t,n)},Dn=function(e,t,n){return In("".concat(e," !== '").concat(Ye,"' && ").concat(e," !== '").concat($e,"'"),t,n)},Fn=function(e,t,n){return Mn("".concat(e," === '").concat(Qe,"' || ").concat(e," === '").concat(Ye,"'"),t,n)},On=function(e,t,n){return Mn("".concat(e," === '").concat(Ye,"'"),t,n)},_n=function(e,t,n){return Mn("".concat(e," === '").concat(Ze,"'"),t,n)},In=function(e,t,n){return t=null!=t?d(t):t,n=null!=n?d(n):n,Rn(t)&&Rn(n)?(t=t?t.signal||r.stringValue(t.value):null,n=n?n.signal||r.stringValue(n.value):null,{signal:"".concat(e," ? (").concat(t,") : (").concat(n,")")}):[r.extend({test:e},t)].concat(n||[])},Rn=function(e){return null==e||1===Object.keys(e).length},Mn=function(e,t,n){return{signal:"".concat(e," ? (").concat(Bn(t),") : (").concat(Bn(n),")")}},Bn=function(e){return q(e)?e.signal:null==e?null:r.stringValue(e)},Pn=function(e,t){var n=e.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+t.signal}:e};function Ln(e,t,n,a){var i;if(t&&r.hasOwnProperty(t,e))return t[e];if(r.hasOwnProperty(n,e))return n[e];if(e.startsWith("title")){switch(e){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=e[5].toLowerCase()+e.slice(6)}return a["guide-title"][i]}if(e.startsWith("label")){switch(e){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=e[5].toLowerCase()+e.slice(6)}return a["guide-label"][i]}return null}function jn(e){var t={},n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;if(u)for(var s in u)t[s]=1}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return Object.keys(t)}function zn(e,t){return{scale:e.scale,range:t}}function Un(e,t,n,a,i){var o,u,s,c=wt(e,t),l=e.orient,f=e.gridScale,d=En(l,1,-1),p=function(e,t){if(1===t);else if(r.isObject(e)){for(var n=e=r.extend({},e);null!=n.mult;){if(!r.isObject(n.mult))return n.mult=q(t)?{signal:"(".concat(n.mult,") * (").concat(t.signal,")")}:n.mult*t,e;n=n.mult=r.extend({},n.mult)}n.mult=t}else e=q(t)?{signal:"(".concat(t.signal,") * (").concat(e||0,")")}:t*(e||0);return e}(e.offset,d),v={enter:o={opacity:vt},update:s={opacity:gt},exit:u={opacity:vt}};h(v,{stroke:c("gridColor"),strokeCap:c("gridCap"),strokeDash:c("gridDash"),strokeDashOffset:c("gridDashOffset"),strokeOpacity:c("gridOpacity"),strokeWidth:c("gridWidth")});var g={scale:e.scale,field:at,band:i.band,extra:i.extra,offset:i.offset,round:c("tickRound")},m=Cn(l,{signal:"height"},{signal:"width"}),y=f?{scale:f,range:0,mult:d,offset:p}:{value:0,offset:p},x=f?{scale:f,range:1,mult:d,offset:p}:r.extend(m,{mult:d,offset:p});return o.x=s.x=Cn(l,g,y),o.y=s.y=Sn(l,g,y),o.x2=s.x2=Sn(l,x),o.y2=s.y2=Cn(l,x),u.x=Cn(l,g),u.y=Sn(l,g),Nt({type:xt,role:"axis-grid",key:at,from:a,encode:v},n)}function Vn(e,t,n,r,a){return{signal:'flush(range("'+e+'"), scale("'+e+'", datum.value), '+t+","+n+","+r+","+a+")"}}function Wn(e,t,n,r,a,i){var o,u=wt(e,t),s=e.orient,c=e.scale,l=En(s,-1,1),f=X(u("labelFlush")),p=X(u("labelFlushOffset")),v=u("labelAlign"),g=u("labelBaseline"),m=0===f||!!f,y=d(a);y.mult=l,y.offset=d(u("labelPadding")||0),y.offset.mult=l;var x={scale:c,field:at,band:.5,offset:St(i.offset,u("labelOffset"))},b=Cn(s,m?Vn(c,f,'"left"','"right"','"center"'):{value:"center"},function(e,t,n){return q(e)?_n(e.signal,t,n):e===Ze?{value:t}:{value:n}}(s,"left","right")),k=Cn(s,Nn(s,"bottom","top"),m?Vn(c,f,'"top"','"bottom"','"middle"'):{value:"middle"}),w=Vn(c,f,"-(".concat(p,")"),p,0);m=m&&p;var A={opacity:vt,x:Cn(s,x,y),y:Sn(s,x,y)},E={enter:A,update:o={opacity:gt,text:{field:nt},x:A.x,y:A.y,align:b,baseline:k},exit:{opacity:vt,x:A.x,y:A.y}};h(E,{dx:!v&&m?Cn(s,w):null,dy:!g&&m?Sn(s,w):null}),h(E,{angle:u("labelAngle"),fill:u("labelColor"),fillOpacity:u("labelOpacity"),font:u("labelFont"),fontSize:u("labelFontSize"),fontWeight:u("labelFontWeight"),fontStyle:u("labelFontStyle"),limit:u("labelLimit"),lineHeight:u("labelLineHeight")},{align:v,baseline:g});var C=u("labelBound"),S=u("labelOverlap");return S=S||C?{separation:u("labelSeparation"),method:S,order:"datum.index",bound:C?{scale:c,orient:s,tolerance:C}:null}:void 0,o.align!==b&&(o.align=Pn(o.align,b)),o.baseline!==k&&(o.baseline=Pn(o.baseline,k)),Nt({type:bt,role:"axis-label",style:it,key:at,from:r,encode:E,overlap:S},n)}function Gn(e,t,n,a){var i,o,u=wt(e,t),s=e.orient,c=En(s,-1,1),l={enter:i={opacity:vt,anchor:d(u("titleAnchor",null)),align:{signal:Ct}},update:o=r.extend({},i,{opacity:gt,text:d(e.title)}),exit:{opacity:vt}},f={signal:'lerp(range("'.concat(e.scale,'"), ').concat(Et(0,1,.5),")")};return o.x=Cn(s,f),o.y=Sn(s,f),i.angle=Cn(s,vt,function(e,t){return 0===t?0:q(e)?{signal:"(".concat(e.signal,") * ").concat(t)}:{value:e*t}}(c,90)),i.baseline=Cn(s,Nn(s,$e,Ye),{value:$e}),o.angle=i.angle,o.baseline=i.baseline,h(l,{fill:u("titleColor"),fillOpacity:u("titleOpacity"),font:u("titleFont"),fontSize:u("titleFontSize"),fontStyle:u("titleFontStyle"),fontWeight:u("titleFontWeight"),limit:u("titleLimit"),lineHeight:u("titleLineHeight")},{align:u("titleAlign"),angle:u("titleAngle"),baseline:u("titleBaseline")}),function(e,t,n,r){var a=function(e,t){return null!=e?(n.update[t]=Pn(d(e),n.update[t]),!1):!g(t,r)},i=a(e("titleX"),"x"),o=a(e("titleY"),"y");n.enter.auto=o===i?d(o):Cn(t,d(o),d(i))}(u,s,l,n),l.update.align=Pn(l.update.align,i.align),l.update.angle=Pn(l.update.angle,i.angle),l.update.baseline=Pn(l.update.baseline,i.baseline),Nt({type:bt,role:"axis-title",style:ot,from:a,encode:l},n)}function Hn(e,t){var n,a=function(e,t){var n,a,i,o,u,s,c,l,f=t.config,d=f.style,p=f.axis,h="band"===t.scaleType(e.scale)&&f.axisBand,v=e.orient;if(q(v)){var g=jn([f.axisX,f.axisY]),m=jn([f.axisTop,f.axisBottom,f.axisLeft,f.axisRight]);n={};var y=!0,x=!1,b=void 0;try{for(var k,w=g[Symbol.iterator]();!(y=(k=w.next()).done);y=!0)n[i=k.value]=Cn(v,Ln(i,f.axisX,p,d),Ln(i,f.axisY,p,d))}catch(e){x=!0,b=e}finally{try{y||null==w.return||w.return()}finally{if(x)throw b}}a={};var A=!0,E=!1,C=void 0;try{for(var S,N=m[Symbol.iterator]();!(A=(S=N.next()).done);A=!0)a[i=S.value]=(o=v.signal,u=Ln(i,f.axisTop,p,d),s=Ln(i,f.axisBottom,p,d),c=Ln(i,f.axisLeft,p,d),l=Ln(i,f.axisRight,p,d),{signal:(null!=c?"".concat(o," === '").concat(Qe,"' ? (").concat(Bn(c),") : "):"")+(null!=s?"".concat(o," === '").concat($e,"' ? (").concat(Bn(s),") : "):"")+(null!=l?"".concat(o," === '").concat(Ze,"' ? (").concat(Bn(l),") : "):"")+(null!=u?"".concat(o," === '").concat(Ye,"' ? (").concat(Bn(u),") : "):"")+"(null)"})}catch(e){E=!0,C=e}finally{try{A||null==N.return||N.return()}finally{if(E)throw C}}}else n=v===Ye||v===$e?f.axisX:f.axisY,a=f["axis"+v[0].toUpperCase()+v.slice(1)];return n||a||h?r.extend({},p,n,a,h):p}(e,t),i=e.encode||{},o=i.axis||{},u=o.name||void 0,s=o.interactive,c=o.style,l=wt(e,a),f=function(e){var t,n,a=e("tickBand"),i=e("tickOffset");return a?a.signal?(t={signal:"(".concat(a.signal,") === 'extent' ? 1 : 0.5")},n={signal:"(".concat(a.signal,") === 'extent'")},r.isObject(i)||(i={signal:"(".concat(a.signal,") === 'extent' ? 0 : ").concat(i)})):"extent"===a?(t=1,n=!0,i=0):(t=.5,n=!1):(t=e("bandPosition"),n=e("tickExtra")),{extra:n,band:t,offset:i}}(l),p={scale:e.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=e.title},g=j(t.add(ce({},[p]))),m=j(t.add(ue({scale:t.scaleRef(e.scale),extra:t.property(f.extra),count:t.objectProperty(e.tickCount),values:t.objectProperty(e.values),minstep:t.property(e.tickMinStep),formatType:t.property(e.formatType),formatSpecifier:t.property(e.format)}))),y=[];return p.grid&&y.push(Un(e,a,i.grid,m,f)),p.ticks&&(n=l("tickSize"),y.push(function(e,t,n,r,a,i){var o,u,s,c=wt(e,t),l=e.orient,f=En(l,-1,1),p={enter:o={opacity:vt},update:s={opacity:gt},exit:u={opacity:vt}};h(p,{stroke:c("tickColor"),strokeCap:c("tickCap"),strokeDash:c("tickDash"),strokeDashOffset:c("tickDashOffset"),strokeOpacity:c("tickOpacity"),strokeWidth:c("tickWidth")});var v=d(a);v.mult=f;var g={scale:e.scale,field:at,band:i.band,extra:i.extra,offset:i.offset,round:c("tickRound")};return s.y=o.y=Cn(l,vt,g),s.y2=o.y2=Cn(l,v),u.x=Cn(l,g),s.x=o.x=Sn(l,vt,g),s.x2=o.x2=Sn(l,v),u.y=Sn(l,g),Nt({type:xt,role:"axis-tick",key:at,from:r,encode:p},n)}(e,a,i.ticks,m,n,f))),p.labels&&(n=p.ticks?n:0,y.push(Wn(e,a,i.labels,m,n,f))),p.domain&&y.push(function(e,t,n,r){var a,i,o=wt(e,t),u=e.orient,s={enter:a={opacity:vt},update:i={opacity:gt},exit:{opacity:vt}};h(s,{stroke:o("domainColor"),strokeCap:o("domainCap"),strokeDash:o("domainDash"),strokeDashOffset:o("domainDashOffset"),strokeWidth:o("domainWidth"),strokeOpacity:o("domainOpacity")});var c=zn(e,0),l=zn(e,1);return a.x=i.x=Cn(u,c,vt),a.x2=i.x2=Cn(u,l),a.y=i.y=Sn(u,c,vt),a.y2=i.y2=Sn(u,l),Nt({type:xt,role:"axis-domain",from:r,encode:s},n)}(e,a,i.domain,g)),p.title&&y.push(Gn(e,a,i.title,g)),pn(kt({role:"axis",from:g,encode:v(qn(l,e),o,ht),marks:y,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:u,interactive:s,style:c}),t)}function qn(e,t){var n={enter:{},update:{}};return h(n,{orient:e("orient"),offset:e("offset")||0,position:K(t.position,0),titlePadding:e("titlePadding"),minExtent:e("minExtent"),maxExtent:e("maxExtent"),range:{signal:'abs(span(range("'.concat(t.scale,'")))')},translate:e("translate"),format:t.format,formatType:t.formatType}),n}function Jn(e,t,n){var i=r.array(e.signals),u=r.array(e.scales);return n||i.forEach((function(e){return M(e,t)})),r.array(e.projections).forEach((function(e){return function(e,t){var n=t.config.projection||{},r={};for(var a in e)"name"!==a&&(r[a]=Xe(e[a],a,t));for(var i in n)null==r[i]&&(r[i]=Xe(n[i],i,t));t.addProjection(e.name,r)}(e,t)})),u.forEach((function(e){return function(e,t){var n=e.type||"linear";o.isValidScaleType(n)||r.error("Unrecognized scale type: "+r.stringValue(n)),t.addScale(e.name,{type:n,domain:void 0})}(e,t)})),r.array(e.data).forEach((function(e){return bn(e,t)})),u.forEach((function(e){return Be(e,t)})),(n||i).forEach((function(e){return function(e,t){var n=t.getSignal(e.name),i=e.update;e.init&&(i?r.error("Signals can not include both init and update expressions."):(i=e.init,n.initonly=!0)),i&&(i=a.parseExpression(i,t),n.update=i.$expr,n.params=i.$params),e.on&&e.on.forEach((function(e){return re(e,t,n.id)}))}(e,t)})),r.array(e.axes).forEach((function(e){return Hn(e,t)})),r.array(e.marks).forEach((function(e){return pn(e,t)})),r.array(e.legends).forEach((function(e){return hn(e,t)})),e.title&&yn(e.title,t),t.parseLambdas(),t}function Kn(e,t){var n=t.config,a=j(t.root=t.add(L())),i=function(e,t){var n=function(n){return K(e[n],t[n])},a=[Xn("background",n("background")),Xn("autosize",c(n("autosize"))),Xn("padding",f(n("padding"))),Xn("width",n("width")||0),Xn("height",n("height")||0)],i=a.reduce((function(e,t){return e[t.name]=t,e}),{}),o={};return r.array(e.signals).forEach((function(e){r.hasOwnProperty(i,e.name)?e=r.extend(i[e.name],e):a.push(e),o[e.name]=e})),r.array(t.signals).forEach((function(e){r.hasOwnProperty(o,e.name)||r.hasOwnProperty(i,e.name)||a.push(e)})),a}(e,n);i.forEach((function(e){return M(e,t)})),t.description=e.description||n.description,t.eventConfig=n.events,t.legends=t.objectProperty(n.legend&&n.legend.layout),t.locale=n.locale;var o=t.add(ce()),u=t.add(de(F(function(e){return v({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},e)}(e.encode),mt,y,e.style,t,{pulse:j(o)}))),s=t.add(_e({layout:t.objectProperty(e.layout),legends:t.legends,autosize:t.signalRef("autosize"),mark:a,pulse:j(u)}));t.operators.pop(),t.pushState(j(u),j(s),null),Jn(e,t,i),t.operators.push(s);var l=t.add(se({mark:a,pulse:j(s)}));return l=t.add(Te({pulse:j(l)})),l=t.add(Fe({pulse:j(l)})),t.addData("root",new sn(t,o,o,l)),t}function Xn(e,t){return t&&t.signal?{name:e,update:t.signal}:{name:e,value:t}}function Yn(e,t){this.config=e||{},this.options=t||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function Qn(e){this.config=e.config,this.options=e.options,this.legends=e.legends,this.field=Object.create(e.field),this.signals=Object.create(e.signals),this.lambdas=Object.create(e.lambdas),this.scales=Object.create(e.scales),this.events=Object.create(e.events),this.data=Object.create(e.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++e._nextsub[0],this._nextsub=e._nextsub,this._parent=e._parent.slice(),this._encode=e._encode.slice(),this._lookup=e._lookup.slice(),this._markpath=e._markpath}function Zn(e){return(r.isArray(e)?$n:er)(e)}function $n(e){for(var t=e.length,n="[",a=0;a<t;++a){var i=e[a];n+=(a>0?",":"")+(r.isObject(i)?i.signal||Zn(i):r.stringValue(i))}return n+"]"}function er(e){var t,n,a="{",i=0;for(t in e)n=e[t],a+=(++i>1?",":"")+r.stringValue(t)+":"+(r.isObject(n)?n.signal||Zn(n):r.stringValue(n));return a+"}"}function tr(e,t,n){var a,i,o,u,s;return r.isObject(e)||r.error("Input Vega specification must be an object."),Kn(e,new Yn(t=r.mergeConfig({description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:i="#4c78a8"},area:{fill:i},image:null,line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},rule:{stroke:o="#000"},shape:{stroke:i},symbol:{fill:i,size:64},text:{fill:o,font:a="sans-serif",fontSize:11},trail:{fill:i,size:2},style:{"guide-label":{fill:o,font:a,fontSize:10},"guide-title":{fill:o,font:a,fontSize:11,fontWeight:"bold"},"group-title":{fill:o,font:a,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:o,font:a,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:s="#ddd"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:u="#888",grid:!1,gridWidth:1,gridColor:s,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:u,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:s,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:u,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}},t,e.config),n)).toRuntime()}Yn.prototype=Qn.prototype={parse:function(e){return Jn(e,this)},fork:function(){return new Qn(this)},isSubscope:function(){return this._subid>0},toRuntime:function(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id:function(){return(this._subid?this._subid+":":0)+this._id++},add:function(e){return this.operators.push(e),e.id=this.id(),e.refs&&(e.refs.forEach((function(t){t.$ref=e.id})),e.refs=null),e},proxy:function(e){var t=e instanceof B?j(e):e;return this.add(Se({value:t}))},addStream:function(e){return this.streams.push(e),e.id=this.id(),e},addUpdate:function(e){return this.updates.push(e),e},finish:function(){var e,t;for(e in this.root&&(this.root.root=!0),this.signals)this.signals[e].signal=e;for(e in this.scales)this.scales[e].scale=e;function n(e,t,n){var r;e&&((r=e.data||(e.data={}))[t]||(r[t]=[])).push(n)}for(e in this.data)for(var r in n((t=this.data[e]).input,e,"input"),n(t.output,e,"output"),n(t.values,e,"values"),t.index)n(t.index[r],e,"index:"+r);return this},pushState:function(e,t,n){this._encode.push(j(this.add(Fe({pulse:e})))),this._parent.push(t),this._lookup.push(n?j(this.proxy(n)):null),this._markpath.push(-1)},popState:function(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent:function(){return r.peek(this._parent)},encode:function(){return r.peek(this._encode)},lookup:function(){return r.peek(this._lookup)},markpath:function(){var e=this._markpath;return++e[e.length-1]},fieldRef:function(e,t){if(r.isString(e))return z(e,t);e.signal||r.error("Unsupported field reference: "+r.stringValue(e));var n=e.signal,a=this.field[n];if(!a){var i={name:this.signalRef(n)};t&&(i.as=t),this.field[n]=a=j(this.add(ve(i)))}return a},compareRef:function(e){var t=this,n=!1,a=function(e){return q(e)?(n=!0,t.signalRef(e.signal)):function(e){return e&&e.expr}(e)?(n=!0,t.exprRef(e.expr)):e},i=r.array(e.field).map(a),o=r.array(e.order).map(a);return n?j(this.add(le({fields:i,orders:o}))):V(i,o)},keyRef:function(e,t){var n=!1,a=this.signals;return e=r.array(e).map((function(e){return q(e)?(n=!0,j(a[e.signal])):e})),n?j(this.add(ge({fields:e,flat:t}))):function(e,t){var n={$key:e};return t&&(n.$flat=!0),n}(e,t)},sortRef:function(e){if(!e)return e;var t=W(e.op,e.field),n=e.order||"ascending";return n.signal?j(this.add(le({fields:t,orders:this.signalRef(n.signal)}))):V(t,n)},event:function(e,t){var n=e+":"+t;if(!this.events[n]){var r=this.id();this.streams.push({id:r,source:e,type:t}),this.events[n]=r}return this.events[n]},hasOwnSignal:function(e){return r.hasOwnProperty(this.signals,e)},addSignal:function(e,t){this.hasOwnSignal(e)&&r.error("Duplicate signal name: "+r.stringValue(e));var n=t instanceof B?t:this.add(L(t));return this.signals[e]=n},getSignal:function(e){return this.signals[e]||r.error("Unrecognized signal name: "+r.stringValue(e)),this.signals[e]},signalRef:function(e){return this.signals[e]?j(this.signals[e]):(r.hasOwnProperty(this.lambdas,e)||(this.lambdas[e]=this.add(L(null))),j(this.lambdas[e]))},parseLambdas:function(){for(var e=Object.keys(this.lambdas),t=0,n=e.length;t<n;++t){var r=e[t],i=a.parseExpression(r,this),o=this.lambdas[r];o.params=i.$params,o.update=i.$expr}},property:function(e){return e&&e.signal?this.signalRef(e.signal):e},objectProperty:function(e){return e&&r.isObject(e)?this.signalRef(e.signal||Zn(e)):e},exprRef:function(e,t){var n={expr:a.parseExpression(e,this)};return t&&(n.expr.$name=t),j(this.add(pe(n)))},addBinding:function(e,t){this.bindings||r.error("Nested signals do not support binding: "+r.stringValue(e)),this.bindings.push(r.extend({signal:e},t))},addScaleProj:function(e,t){r.hasOwnProperty(this.scales,e)&&r.error("Duplicate scale or projection name: "+r.stringValue(e)),this.scales[e]=this.add(t)},addScale:function(e,t){this.addScaleProj(e,De(t))},addProjection:function(e,t){this.addScaleProj(e,Ce(t))},getScale:function(e){return this.scales[e]||r.error("Unrecognized scale name: "+r.stringValue(e)),this.scales[e]},scaleRef:function(e){return j(this.getScale(e))},scaleType:function(e){return this.getScale(e).params.type},projectionRef:function(e){return this.scaleRef(e)},projectionType:function(e){return this.scaleType(e)},addData:function(e,t){return r.hasOwnProperty(this.data,e)&&r.error("Duplicate data set name: "+r.stringValue(e)),this.data[e]=t},getData:function(e){return this.data[e]||r.error("Undefined data set name: "+r.stringValue(e)),this.data[e]},addDataPipeline:function(e,t){return r.hasOwnProperty(this.data,e)&&r.error("Duplicate data set name: "+r.stringValue(e)),this.addData(e,sn.fromEntries(this,t))}}})),s.register("djErq",(function(e,t){n(e.exports,"parseSelector",(function(){return c}));var r,a,i="[",o="]",u=/[[\]{}]/,s={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function c(e,t,n){return r=t||"view",a=n||s,f(e.trim()).map(d)}function l(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function f(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=l(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function d(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if((r=l(e,r,o,i,o))===n)throw"Empty between selector: "+e;if(2!==(t=f(e.substring(1,r))).length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;t=t.map(d);var a=d(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,s={source:r},c=[],f=[0,0],d=0,p=0,h=e.length,v=0;if("}"===e[h-1]){if(!((v=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{f=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!=n)throw e;return n}))}(e.substring(v+1,h-1))}catch(t){throw"Invalid throttle specification: "+e}h=(e=e.slice(0,v).trim()).length,v=0}if(!h)throw e;"@"===e[0]&&(d=++v);(t=l(e,v,":"))<h&&(c.push(e.substring(p,t).trim()),p=v=++t);if((v=l(e,v,i))===h)c.push(e.substring(p,h).trim());else if(c.push(e.substring(p,v).trim()),n=[],(p=++v)===h)throw"Unmatched left bracket: "+e;for(;v<h;){if((v=l(e,v,o))===h)throw"Unmatched left bracket: "+e;if(n.push(e.substring(p,v).trim()),v<h-1&&e[++v]!==i)throw"Expected left bracket: "+e;p=++v}if(!(h=c.length)||u.test(c[h-1]))throw"Invalid event selector: "+e;h>1?(s.type=c[1],d?s.markname=c[0].slice(1):(g=c[0],a[g]?s.marktype=c[0]:s.source=c[0])):s.type=c[0];var g;"!"===s.type.slice(-1)&&(s.consume=!0,s.type=s.type.slice(0,-1));null!=n&&(s.filter=n);f[0]&&(s.throttle=f[0]);f[1]&&(s.debounce=f[1]);return s}(e)}})),s.register("gvNfD",(function(e,t){n(e.exports,"parse",(function(){return be})),n(e.exports,"codegen",(function(){return Ae}));var r,a,i,o,u,c=s("caNzv"),l="Property",f="ArrayExpression",d="BinaryExpression",p="CallExpression",h="ConditionalExpression",v="LogicalExpression",g="MemberExpression",m="ObjectExpression",y="UnaryExpression";function x(e){this.type=e}x.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case f:return e.elements;case d:case v:return[e.left,e.right];case p:return[e.callee].concat(e.arguments);case h:return[e.test,e.consequent,e.alternate];case g:return[e.object,e.property];case m:return e.properties;case l:return[e.key,e.value];case y:return[e.argument];default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};(r={})[1]="Boolean",r[2]="<end>",r[3]="Identifier",r[4]="Keyword",r[5]="Null",r[6]="Numeric",r[7]="Punctuator",r[8]="String",r[9]="RegularExpression";var b="Identifier",k="Unexpected token %0",w="Invalid regular expression",A="Invalid regular expression: missing /",E="Octal literals are not allowed in strict mode.",C="ILLEGAL",S="Disabled.",N=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),T=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function D(e,t){if(!e)throw new Error("ASSERT: "+t)}function F(e){return e>=48&&e<=57}function O(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function _(e){return"01234567".indexOf(e)>=0}function I(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function R(e){return 10===e||13===e||8232===e||8233===e}function M(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&N.test(String.fromCharCode(e))}function B(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&T.test(String.fromCharCode(e))}var P={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function L(){for(;i<o;){var e=a.charCodeAt(i);if(!I(e)&&!R(e))break;++i}}function j(e){var t,n,r,u=0;for(n="u"===e?4:2,t=0;t<n;++t)i<o&&O(a[i])?(r=a[i++],u=16*u+"0123456789abcdef".indexOf(r.toLowerCase())):te({},k,C);return String.fromCharCode(u)}function z(){var e,t,n,r;for(t=0,"}"===(e=a[i])&&te({},k,C);i<o&&O(e=a[i++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&te({},k,C),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function U(){var e,t;for(e=a.charCodeAt(i++),t=String.fromCharCode(e),92===e&&(117!==a.charCodeAt(i)&&te({},k,C),++i,(e=j("u"))&&"\\"!==e&&M(e.charCodeAt(0))||te({},k,C),t=e);i<o&&B(e=a.charCodeAt(i));)++i,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==a.charCodeAt(i)&&te({},k,C),++i,(e=j("u"))&&"\\"!==e&&B(e.charCodeAt(0))||te({},k,C),t+=e);return t}function V(){var e,t;return e=i,t=92===a.charCodeAt(i)?U():function(){var e,t;for(e=i++;i<o;){if(92===(t=a.charCodeAt(i)))return i=e,U();if(!B(t))break;++i}return a.slice(e,i)}(),{type:1===t.length?3:P.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:i}}function W(){var e,t,n,r,o=i,u=a.charCodeAt(i),s=a[i];switch(u){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++i,{type:7,value:String.fromCharCode(u),start:o,end:i};default:if(61===(e=a.charCodeAt(i+1)))switch(u){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return i+=2,{type:7,value:String.fromCharCode(u)+String.fromCharCode(e),start:o,end:i};case 33:case 61:return i+=2,61===a.charCodeAt(i)&&++i,{type:7,value:a.slice(o,i),start:o,end:i}}}return">>>="===(r=a.substr(i,4))?{type:7,value:r,start:o,end:i+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:o,end:i+=3}:s===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===t?{type:7,value:t,start:o,end:i+=2}:("//"===t&&te({},k,C),"<>=!+-*%&|^/".indexOf(s)>=0?{type:7,value:s,start:o,end:++i}:void te({},k,C))}function G(){var e,t,n;if(D(F((n=a[i]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=i,e="","."!==n){if(e=a[i++],n=a[i],"0"===e){if("x"===n||"X"===n)return++i,function(e){for(var t="";i<o&&O(a[i]);)t+=a[i++];return 0===t.length&&te({},k,C),M(a.charCodeAt(i))&&te({},k,C),{type:6,value:parseInt("0x"+t,16),start:e,end:i}}(t);if(_(n))return function(e){for(var t="0"+a[i++];i<o&&_(a[i]);)t+=a[i++];return(M(a.charCodeAt(i))||F(a.charCodeAt(i)))&&te({},k,C),{type:6,value:parseInt(t,8),octal:!0,start:e,end:i}}(t);n&&F(n.charCodeAt(0))&&te({},k,C)}for(;F(a.charCodeAt(i));)e+=a[i++];n=a[i]}if("."===n){for(e+=a[i++];F(a.charCodeAt(i));)e+=a[i++];n=a[i]}if("e"===n||"E"===n)if(e+=a[i++],"+"!==(n=a[i])&&"-"!==n||(e+=a[i++]),F(a.charCodeAt(i)))for(;F(a.charCodeAt(i));)e+=a[i++];else te({},k,C);return M(a.charCodeAt(i))&&te({},k,C),{type:6,value:parseFloat(e),start:t,end:i}}function H(){var e,t,n,r;return u=null,L(),e=i,t=function(){var e,t,n,r;for(D("/"===(e=a[i]),"Regular expression literal must start with a slash"),t=a[i++],n=!1,r=!1;i<o;)if(t+=e=a[i++],"\\"===e)R((e=a[i++]).charCodeAt(0))&&te({},A),t+=e;else if(R(e.charCodeAt(0)))te({},A);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||te({},A),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";i<o&&B((e=a[i]).charCodeAt(0));)++i,"\\"===e&&i<o?te({},k,C):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&te({},w,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";te({},w)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){te({},w)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:i}}function q(){if(L(),i>=o)return{type:2,start:i,end:i};var e=a.charCodeAt(i);return M(e)?V():40===e||41===e||59===e?W():39===e||34===e?function(){var e,t,n,r,u="",s=!1;for(D("'"===(e=a[i])||'"'===e,"String literal must starts with a quote"),t=i,++i;i<o;){if((n=a[i++])===e){e="";break}if("\\"===n)if((n=a[i++])&&R(n.charCodeAt(0)))"\r"===n&&"\n"===a[i]&&++i;else switch(n){case"u":case"x":"{"===a[i]?(++i,u+=z()):u+=j(n);break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:_(n)?(0!==(r="01234567".indexOf(n))&&(s=!0),i<o&&_(a[i])&&(s=!0,r=8*r+"01234567".indexOf(a[i++]),"0123".indexOf(n)>=0&&i<o&&_(a[i])&&(r=8*r+"01234567".indexOf(a[i++]))),u+=String.fromCharCode(r)):u+=n}else{if(R(n.charCodeAt(0)))break;u+=n}}return""!==e&&te({},k,C),{type:8,value:u,octal:s,start:t,end:i}}():46===e?F(a.charCodeAt(i+1))?G():W():F(e)?G():W()}function J(){var e=u;return i=e.end,u=q(),i=e.end,e}function K(){var e=i;u=q(),i=e}function X(e,t,n){var r=new x("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function Y(e,t){var n=new x("CallExpression");return n.callee=e,n.arguments=t,n}function Q(e){var t=new x(b);return t.name=e,t}function Z(e){var t=new x("Literal");return t.value=e.value,t.raw=a.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function $(e,t,n){var r=new x("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function ee(e,t,n){var r=new x("Property");return r.key=t,r.value=n,r.kind=e,r}function te(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return D(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=i,n.description=a,n}function ne(e){2===e.type&&te(e,"Unexpected end of input"),6===e.type&&te(e,"Unexpected number"),8===e.type&&te(e,"Unexpected string"),3===e.type&&te(e,"Unexpected identifier"),4===e.type&&te(e,"Unexpected reserved word"),te(e,k,e.value)}function re(e){var t=J();7===t.type&&t.value===e||ne(t)}function ae(e){return 7===u.type&&u.value===e}function ie(e){return 4===u.type&&u.value===e}function oe(){var e=[];for(i=u.start,re("[");!ae("]");)ae(",")?(J(),e.push(null)):(e.push(ye()),ae("]")||re(","));return J(),function(e){var t=new x("ArrayExpression");return t.elements=e,t}(e)}function ue(){i=u.start;var e=J();return 8===e.type||6===e.type?(e.octal&&te(e,E),Z(e)):Q(e.value)}function se(){var e,t,n;return i=u.start,3===(e=u).type?(n=ue(),re(":"),ee("init",n,ye())):2!==e.type&&7!==e.type?(t=ue(),re(":"),ee("init",t,ye())):void ne(e)}function ce(){var e,t,n=[],r={},a=String;for(i=u.start,re("{");!ae("}");)t="$"+((e=se()).key.type===b?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?te({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),ae("}")||re(",");return re("}"),function(e){var t=new x("ObjectExpression");return t.properties=e,t}(n)}var le={if:1};function fe(){var e,t,n;if(ae("("))return function(){re("(");var e=xe();return re(")"),e}();if(ae("["))return oe();if(ae("{"))return ce();if(e=u.type,i=u.start,3===e||le[u.value])n=Q(J().value);else if(8===e||6===e)u.octal&&te(u,E),n=Z(J());else{if(4===e)throw new Error(S);1===e?((t=J()).value="true"===t.value,n=Z(t)):5===e?((t=J()).value=null,n=Z(t)):ae("/")||ae("/=")?(n=Z(H()),K()):ne(J())}return n}function de(){var e=[];if(re("("),!ae(")"))for(;i<o&&(e.push(ye()),!ae(")"));)re(",");return re(")"),e}function pe(){return re("."),function(){i=u.start;var e=J();return function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e)||ne(e),Q(e.value)}()}function he(){re("[");var e=xe();return re("]"),e}function ve(){var e=function(){var e;for(e=fe();;)if(ae("."))e=$(".",e,pe());else if(ae("("))e=Y(e,de());else{if(!ae("["))break;e=$("[",e,he())}return e}();if(7===u.type&&(ae("++")||ae("--")))throw new Error(S);return e}function ge(){var e,t,n,r,a;if(7!==u.type&&4!==u.type)t=ve();else{if(ae("++")||ae("--"))throw new Error(S);if(ae("+")||ae("-")||ae("~")||ae("!"))e=J(),t=ge(),n=e.value,r=t,(a=new x("UnaryExpression")).operator=n,a.argument=r,a.prefix=!0,t=a;else{if(ie("delete")||ie("void")||ie("typeof"))throw new Error(S);t=ve()}}return t}function me(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function ye(){var e,t;return e=function(){var e,t,n,r,a,i,o,s,c,l;if(e=u,c=ge(),0===(a=me(r=u)))return c;for(r.prec=a,J(),t=[e,u],i=[c,r,o=ge()];(a=me(u))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),s=i.pop().value,c=i.pop(),t.pop(),n=X(s,c,o),i.push(n);(r=J()).prec=a,i.push(r),t.push(u),n=ge(),i.push(n)}for(n=i[l=i.length-1],t.pop();l>1;)t.pop(),n=X(i[l-1].value,i[l-2],n),l-=2;return n}(),ae("?")&&(J(),t=ye(),re(":"),e=function(e,t,n){var r=new x("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,ye())),e}function xe(){var e=ye();if(ae(","))throw new Error(S);return e}function be(e){i=0,o=(a=e).length,u=null,K();var t=xe();if(2!==u.type)throw new Error("Unexpect token after expression.");return t}var ke={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function we(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",r="String",a="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&c.error("Missing arguments to clamp function."),t.length>3&&c.error("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",r,0),lower:t("toLowerCase",r,0),substring:t("substring",r),split:t("split",r),trim:t("trim",r,0),regexp:a,test:t("test",a),if:function(t){t.length<3&&c.error("Missing arguments to if function."),t.length>3&&c.error("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function Ae(e){var t=(e=e||{}).allowed?c.toSet(e.allowed):{},n=e.forbidden?c.toSet(e.forbidden):{},r=e.constants||ke,a=(e.functions||we)(d),i=e.globalvar,o=e.fieldvar,u=c.isFunction(i)?i:function(e){return"".concat(i,'["').concat(e,'"]')},s={},l={},f=0;function d(e){if(c.isString(e))return e;var t=p[e.type];return null==t&&c.error("Unsupported type: "+e.type),t(e)}var p={Literal:function(e){return e.raw},Identifier:function(e){var a=e.name;return f>0?a:c.hasOwnProperty(n,a)?c.error("Illegal identifier: "+a):c.hasOwnProperty(r,a)?r[a]:c.hasOwnProperty(t,a)?a:(s[a]=1,u(a))},MemberExpression:function(e){var t=!e.computed,n=d(e.object);t&&(f+=1);var r=d(e.property);return n===o&&(l[function(e){var t=e&&e.length-1;return t&&('"'===e[0]&&'"'===e[t]||"'"===e[0]&&"'"===e[t])?e.slice(1,-1):e}(r)]=1),t&&(f-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&c.error("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=c.hasOwnProperty(a,t)&&a[t];return r||c.error("Unrecognized function: "+t),c.isFunction(r)?r(n):r+"("+n.map(d).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(d).join(",")+"]"},BinaryExpression:function(e){return"("+d(e.left)+" "+e.operator+" "+d(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+d(e.argument)+")"},ConditionalExpression:function(e){return"("+d(e.test)+"?"+d(e.consequent)+":"+d(e.alternate)+")"},LogicalExpression:function(e){return"("+d(e.left)+e.operator+d(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(d).join(",")+"}"},Property:function(e){f+=1;var t=d(e.key);return f-=1,t+":"+d(e.value)}};function h(e){var t={code:d(e),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},t}return h.functions=a,h.constants=r,h}})),s.register("A0mT6",(function(e,t){n(e.exports,"selector",(function(){return c}));var r,a,i="[",o="]",u=/[[\]{}]/,s={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function c(e,t,n){return r=t||"view",a=n||s,f(e.trim()).map(d)}function l(e,t,n,r,a){for(var i,o=e.length,u=0;t<o;++t){if(i=e[t],!u&&i===n)return t;a&&a.indexOf(i)>=0?--u:r&&r.indexOf(i)>=0&&++u}return t}function f(e){for(var t=[],n=e.length,r=0,a=0;a<n;)a=l(e,a,",","[{","]}"),t.push(e.substring(r,a).trim()),r=++a;if(0===t.length)throw"Empty event selector: "+e;return t}function d(e){return"["===e[0]?function(e){var t,n=e.length,r=1;if((r=l(e,r,o,i,o))===n)throw"Empty between selector: "+e;if(2!==(t=f(e.substring(1,r))).length)throw"Between selector must have two elements: "+e;if(">"!==(e=e.slice(r+1).trim())[0])throw"Expected '>' after between selector: "+e;t=t.map(d);var a=d(e.slice(1).trim());if(a.between)return{between:t,stream:a};a.between=t;return a}(e):function(e){var t,n,s={source:r},c=[],f=[0,0],d=0,p=0,h=e.length,v=0;if("}"===e[h-1]){if(!((v=e.lastIndexOf("{"))>=0))throw"Unmatched right brace: "+e;try{f=function(e){var t=e.split(",");if(!e.length||t.length>2)throw e;return t.map((function(t){var n=+t;if(n!=n)throw e;return n}))}(e.substring(v+1,h-1))}catch(t){throw"Invalid throttle specification: "+e}h=(e=e.slice(0,v).trim()).length,v=0}if(!h)throw e;"@"===e[0]&&(d=++v);(t=l(e,v,":"))<h&&(c.push(e.substring(p,t).trim()),p=v=++t);if((v=l(e,v,i))===h)c.push(e.substring(p,h).trim());else if(c.push(e.substring(p,v).trim()),n=[],(p=++v)===h)throw"Unmatched left bracket: "+e;for(;v<h;){if((v=l(e,v,o))===h)throw"Unmatched left bracket: "+e;if(n.push(e.substring(p,v).trim()),v<h-1&&e[++v]!==i)throw"Expected left bracket: "+e;p=++v}if(!(h=c.length)||u.test(c[h-1]))throw"Invalid event selector: "+e;h>1?(s.type=c[1],d?s.markname=c[0].slice(1):(g=c[0],a[g]?s.marktype=c[0]:s.source=c[0])):s.type=c[0];var g;"!"===s.type.slice(-1)&&(s.consume=!0,s.type=s.type.slice(0,-1));null!=n&&(s.filter=n);f[0]&&(s.throttle=f[0]);f[1]&&(s.debounce=f[1]);return s}(e)}})),s.register("2Wi4c",(function(e,r){n(e.exports,"version",(function(){return i})),n(e.exports,"compile",(function(){return s("3pmRX").compile})),n(e.exports,"extractTransforms",(function(){return s("8ykKy").extractTransforms})),n(e.exports,"normalize",(function(){return s("5oqYo").normalize}));var a=s("aa3ND"),i=(s("5oqYo"),s("3pmRX"),s("8ykKy"),t(a).version)})),s.register("aa3ND",(function(e,t){e.exports=JSON.parse('{"name":"vega-lite","author":"Dominik Moritz, Kanit \\"Ham\\" Wongsuphasawat, Arvind Satyanarayan, Jeffrey Heer","version":"4.13.1","collaborators":["Kanit Wongsuphasawat (http://kanitw.yellowpigz.com)","Dominik Moritz (https://www.domoritz.de)","Arvind Satyanarayan (https://arvindsatya.com)","Jeffrey Heer (https://jheer.org)"],"homepage":"https://vega.github.io/vega-lite/","description":"Vega-Lite is a concise high-level language for interactive visualization.","main":"build/vega-lite.js","unpkg":"build/vega-lite.min.js","jsdelivr":"build/vega-lite.min.js","module":"build/src/index","types":"build/src/index.d.ts","bin":{"vl2png":"./bin/vl2png","vl2svg":"./bin/vl2svg","vl2pdf":"./bin/vl2pdf","vl2vg":"./bin/vl2vg"},"directories":{"test":"test"},"scripts":{"changelog":"conventional-changelog -p angular -r 2","build":"yarn build:only","build:only":"yarn tsc:src && rollup -c","postbuild":"terser build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && yarn schema && babel build/vega-lite.js --out-dir build-es5 --config-file ./babel.config.js","prebuild:examples":"yarn build:only","build:examples":"yarn data && TZ=America/Los_Angeles scripts/build-examples.sh","prebuild:examples-full":"yarn build:only","build:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"yarn build:jekyll && scripts/generate-toc","build:site":"yarn tsc:site && rollup -c site/rollup.config.js","build:jekyll":"pushd site && bundle exec jekyll build -q && popd","build:versions":"scripts/update-version.sh","clean":"find build ! -name \'vega-lite-schema.json\' -type f -delete && rm -rf site/data/* && rm -f examples/compiled/*.png && find site/examples ! -name \'index.md\' ! -name \'data\' -type f -delete","predeploy:site":"yarn presite","deploy:site":"gh-pages -d site","data":"rsync -r node_modules/vega-datasets/data/* site/data","schema":"mkdir -p build && ts-json-schema-generator -f tsconfig.json -p src/index.ts -t TopLevelSpec --no-type-check --no-ref-encode > build/vega-lite-schema.json && yarn renameschema && cp build/vega-lite-schema.json site/_data/","renameschema":"scripts/rename-schema.sh","presite":"yarn data && yarn schema && yarn build:site && yarn build:versions && scripts/create-example-pages.sh","site":"pushd site && bundle exec jekyll serve -I -l && popd","tsc:src":"tsc -b src/tsconfig.src.json","tsc:site":"tsc -b site/tsconfig.site.json","prettierbase":"prettier \'**/*.{md,css,yml}\'","eslintbase":"eslint .","format":"yarn eslintbase --fix && yarn prettierbase --write","lint":"yarn eslintbase && yarn prettierbase --check","test":"jest test/ && yarn lint && yarn schema && jest examples/ && yarn test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":"TZ=America/Los_Angeles jest test-runtime/","test:runtime:generate":"yarn build:only && rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true yarn test:runtime","watch:build":"yarn build:only && concurrently --kill-others -n Typescript,Rollup \'yarn tsc:src -w\' \'rollup -c -w\'","watch:site":"concurrently --kill-others -n Typescript,Rollup \'yarn tsc:site -w\' \'rollup -c site/rollup.config.js -w\'","watch:test":"jest --watch"},"repository":{"type":"git","url":"https://github.com/vega/vega-lite.git"},"license":"BSD-3-Clause","bugs":{"url":"https://github.com/vega/vega-lite/issues"},"devDependencies":{"@babel/cli":"^7.10.1","@babel/core":"^7.10.1","@babel/preset-env":"^7.10.1","@rollup/plugin-commonjs":"12.0.0","@rollup/plugin-json":"^4.0.3","@rollup/plugin-node-resolve":"^8.0.0","@types/chai":"^4.2.11","@types/d3":"^5.7.2","@types/jest":"^25.2.3","@types/mkdirp":"^1.0.0","@types/puppeteer":"^3.0.0","@typescript-eslint/eslint-plugin":"^3.0.2","@typescript-eslint/parser":"^3.0.2","ajv":"^6.12.2","chai":"^4.2.0","cheerio":"^1.0.0-rc.3","codecov":"^3.7.0","concurrently":"^5.2.0","conventional-changelog-cli":"^2.0.34","d3":"^5.16.0","eslint":"^7.1.0","eslint-config-prettier":"^6.11.0","eslint-plugin-jest":"^23.13.2","eslint-plugin-prettier":"^3.1.3","gh-pages":"^2.2.0","highlight.js":"^10.0.3","http-server":"^0.12.3","jest":"^26.0.1","jest-puppeteer":"^4.4.0","mkdirp":"^1.0.4","prettier":"^2.0.5","puppeteer":"^3.1.0","rollup":"^2.11.0","rollup-plugin-sourcemaps":"^0.6.2","rollup-plugin-terser":"^6.1.0","svg2png-many":"^0.0.7","terser":"^4.7.0","ts-jest":"^26.0.0","ts-json-schema-generator":"^0.68.1","typescript":"~3.9.3","vega-cli":"^5.12.1","vega-datasets":"^1.30.2","vega-embed":"^6.8.0","vega-tooltip":"^0.23.0","vega-typings":"^0.17.0","yaml-front-matter":"^4.1.0"},"dependencies":{"@types/clone":"~0.1.30","@types/fast-json-stable-stringify":"^2.0.0","array-flat-polyfill":"^1.0.1","clone":"~2.1.2","fast-deep-equal":"~3.1.1","fast-json-stable-stringify":"~2.1.0","json-stringify-pretty-compact":"~2.0.0","tslib":"~2.0.0","vega-event-selector":"~2.0.3","vega-expression":"~2.6.5","vega-util":"~1.14.0","yargs":"~15.3.1"},"peerDependencies":{"vega":"^5.12.1"},"jest":{"preset":"jest-puppeteer","transform":{"^.+\\\\.tsx?$":"ts-jest"},"testRegex":"(/__tests__/.*|(\\\\.|/)(test|spec))\\\\.(jsx?|tsx?)$","moduleFileExtensions":["ts","tsx","js","jsx","json","node"],"testPathIgnorePatterns":["<rootDir>/node_modules","<rootDir>/build","<rootDir>/_site","<rootDir>/src"],"coverageDirectory":"./coverage/","collectCoverage":false}}')})),s.register("5oqYo",(function(e,t){n(e.exports,"normalize",(function(){return f})),s("iSlfb");var r=s("fCSiB"),a=s("fldOo"),i=s("16rNM"),o=s("2x4HI");s("gLFCo");var u=s("aIH68"),c=s("1sD9J"),l=s("lSb9O");function f(e,t){void 0===t&&(t=a.initConfig(e.config));var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return d.map(e,{config:t})}(e,t),r=function(e,t,n){var r=t.width,a=t.height,s=u.isUnitSpec(e)||c.isLayerSpec(e),f={};s?"container"==r&&"container"==a?(f.type="fit",f.contains="padding"):"container"==r?(f.type="fit-x",f.contains="padding"):"container"==a&&(f.type="fit-y",f.contains="padding"):("container"==r&&(i.warn(o.containerSizeNonSingle("width")),r=void 0),"container"==a&&(i.warn(o.containerSizeNonSingle("height")),a=void 0));var d=Object.assign(Object.assign(Object.assign({type:"pad"},f),n?p(n.autosize):{}),p(e.autosize));"fit"!==d.type||s||(i.warn(o.FIT_NON_SINGLE),d.type="pad");"container"==r&&"fit"!=d.type&&"fit-x"!=d.type&&i.warn(o.containerSizeNotCompatibleWithAutosize("width"));"container"==a&&"fit"!=d.type&&"fit-y"!=d.type&&i.warn(o.containerSizeNotCompatibleWithAutosize("height"));return l.deepEqual(d,{type:"pad"})?void 0:d}(n,{width:e.width,height:e.height,autosize:e.autosize},t);return Object.assign(Object.assign({},n),r?{autosize:r}:{})}var d=new(s("1GdhA").CoreNormalizer);function p(e){return r.default(e)?{type:e}:null!=e?e:{}}})),s.register("iSlfb",(function(e,t){n(e.exports,"identity",(function(){return s("9vONj").identity})),n(e.exports,"logger",(function(){return s("i2vcq").default})),n(e.exports,"Warn",(function(){return s("i2vcq").Warn})),n(e.exports,"mergeConfig",(function(){return s("krpEv").mergeConfig})),n(e.exports,"writeConfig",(function(){return s("krpEv").writeConfig})),n(e.exports,"array",(function(){return s("1Ihp0").default})),n(e.exports,"hasOwnProperty",(function(){return s("b1OzQ").default})),n(e.exports,"isArray",(function(){return s("4ujSI").default})),n(e.exports,"isBoolean",(function(){return s("iRIM1").default})),n(e.exports,"isFunction",(function(){return s("jvEVv").default})),n(e.exports,"isNumber",(function(){return s("8AF0b").default})),n(e.exports,"isObject",(function(){return s("bZ6XL").default})),n(e.exports,"isString",(function(){return s("fCSiB").default})),n(e.exports,"splitAccessPath",(function(){return s("8ozlU").default})),n(e.exports,"stringValue",(function(){return s("1gJgm").default})),n(e.exports,"toSet",(function(){return s("6D24N").default}));s("bj66Z"),s("9vONj"),s("i2vcq"),s("krpEv"),s("433yw"),s("j0P4E"),s("1Ihp0"),s("gns9z"),s("iT3sU"),s("fSGsY"),s("jeSmG"),s("D5xAX"),s("g7Cyk"),s("j2FNI"),s("7sjeZ"),s("7n4D6"),s("5MVZR"),s("kVsnF"),s("b1OzQ"),s("dkMMN"),s("4yBha"),s("4ujSI"),s("iRIM1"),s("9S3AQ"),s("jvEVv"),s("8AF0b"),s("bZ6XL"),s("4IWwB"),s("fCSiB"),s("jh2o0"),s("a0zH8"),s("ftdHC"),s("atjy1"),s("aHVUg"),s("i6BPn"),s("ggckF"),s("9bRRA"),s("8ozlU"),s("1gJgm"),s("4tKgn"),s("iQB5z"),s("4v94d"),s("aJW1g"),s("6D24N"),s("gXjWY"),s("1Q72v")})),s.register("bj66Z",(function(e,t){function r(e,t,n){return e.fields=t||[],e.fname=n,e}function a(e){return null==e?null:e.fields}n(e.exports,"default",(function(){return r})),n(e.exports,"accessorFields",(function(){return a}))})),s.register("9vONj",(function(e,t){n(e.exports,"identity",(function(){return i}));var r=s("bj66Z"),a=[],i=(s("5MVZR").default("id"),r.default((function(e){return e}),a,"identity"));r.default((function(){return 0}),a,"zero"),r.default((function(){return 1}),a,"one"),r.default((function(){return!0}),a,"true"),r.default((function(){return!1}),a,"false")})),s.register("5MVZR",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("bj66Z"),a=s("gAieJ"),i=s("8ozlU");function o(e,t,n){var o=i.default(e);return e=1===o.length?o[0]:e,r.default((n&&n.get||a.default)(o),[e],t||e)}})),s.register("gAieJ",(function(e,t){function r(e){return 1===e.length?a(e[0]):i(e)}n(e.exports,"default",(function(){return r}));var a=function(e){return function(t){return t[e]}},i=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}}})),s.register("8ozlU",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("D5xAX");function a(e){var t,n,a,i=[],o=null,u=0,s=e.length,c="";function l(){i.push(c+e.substring(t,n)),c="",t=n+1}for(e+="",t=n=0;n<s;++n)if("\\"===(a=e[n]))c+=e.substring(t,n),c+=e.substring(++n,++n),t=n;else if(a===o)l(),o=null,u=-1;else{if(o)continue;t===u&&'"'===a||t===u&&"'"===a?(t=n+1,o=a):"."!==a||u?"["===a?(n>t&&l(),u=t=n+1):"]"===a&&(u||r.default("Access path missing open bracket: "+e),u>0&&l(),u=0,t=n+1):n>t?l():t=n+1}return u&&r.default("Access path missing closing bracket: "+e),o&&r.default("Access path missing closing quote: "+e),n>t&&(n++,l()),i}})),s.register("D5xAX",(function(e,t){function r(e){throw Error(e)}n(e.exports,"default",(function(){return r}))})),s.register("i2vcq",(function(e,t){function r(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}n(e.exports,"Warn",(function(){return a})),n(e.exports,"default",(function(){return i}));var a=2;function i(e,t){var n=e||0;return{level:function(e){return arguments.length?(n=+e,this):n},error:function(){return n>=1&&r(t||"error","ERROR",arguments),this},warn:function(){return n>=a&&r(t||"warn","WARN",arguments),this},info:function(){return n>=3&&r(t||"log","INFO",arguments),this},debug:function(){return n>=4&&r(t||"log","DEBUG",arguments),this}}}})),s.register("krpEv",(function(e,t){n(e.exports,"mergeConfig",(function(){return o})),n(e.exports,"writeConfig",(function(){return u}));var r=s("4ujSI"),a=s("bZ6XL"),i=function(e){return"__proto__"!==e};function o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){for(var n in t)if("signals"===n)e.signals=c(e.signals,t.signals);else{var r="legend"===n?{layout:1}:"style"===n||null;u(e,n,t[n],r)}return e}),{})}function u(e,t,n,o){var s,c;if(i(t))if(a.default(n)&&!r.default(n))for(s in c=a.default(e[t])?e[t]:e[t]={},n)o&&(!0===o||o[s])?u(c,s,n[s]):i(s)&&(c[s]=n[s]);else e[t]=n}function c(e,t){if(null==e)return t;var n={},r=[];function a(e){n[e.name]||(n[e.name]=1,r.push(e))}return t.forEach(a),e.forEach(a),r}})),s.register("4ujSI",(function(e,t){n(e.exports,"default",(function(){return r}));var r=Array.isArray})),s.register("bZ6XL",(function(e,t){function r(e){return e===Object(e)}n(e.exports,"default",(function(){return r}))})),s.register("433yw",(function(e,t){s("9vONj"),s("i6BPn"),s("4v94d")})),s.register("i6BPn",(function(e,t){function r(e){return e[e.length-1]}n(e.exports,"default",(function(){return r}))})),s.register("4v94d",(function(e,t){function r(e){return null==e||""===e?null:+e}n(e.exports,"default",(function(){return r}))})),s.register("j0P4E",(function(e,t){})),s.register("1Ihp0",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("4ujSI");function a(e){return null!=e?r.default(e)?e:[e]:[]}})),s.register("gns9z",(function(e,t){})),s.register("iT3sU",(function(e,t){s("bj66Z"),s("1Ihp0"),s("5MVZR"),s("jvEVv")})),s.register("jvEVv",(function(e,t){function r(e){return"function"==typeof e}n(e.exports,"default",(function(){return r}))})),s.register("fSGsY",(function(e,t){s("jvEVv")})),s.register("jeSmG",(function(e,t){})),s.register("g7Cyk",(function(e,t){})),s.register("j2FNI",(function(e,t){})),s.register("7sjeZ",(function(e,t){})),s.register("7n4D6",(function(e,t){s("b1OzQ")})),s.register("b1OzQ",(function(e,t){n(e.exports,"default",(function(){return a}));var r=Object.prototype.hasOwnProperty;function a(e,t){return r.call(e,t)}})),s.register("kVsnF",(function(e,t){s("i6BPn")})),s.register("dkMMN",(function(e,t){})),s.register("4yBha",(function(e,t){})),s.register("iRIM1",(function(e,t){function r(e){return"boolean"==typeof e}n(e.exports,"default",(function(){return r}))})),s.register("9S3AQ",(function(e,t){function r(e){return"[object Date]"===Object.prototype.toString.call(e)}n(e.exports,"default",(function(){return r}))})),s.register("8AF0b",(function(e,t){function r(e){return"number"==typeof e}n(e.exports,"default",(function(){return r}))})),s.register("4IWwB",(function(e,t){})),s.register("fCSiB",(function(e,t){function r(e){return"string"==typeof e}n(e.exports,"default",(function(){return r}))})),s.register("jh2o0",(function(e,t){s("bj66Z"),s("1Ihp0"),s("gAieJ"),s("8ozlU")})),s.register("a0zH8",(function(e,t){s("i6BPn")})),s.register("ftdHC",(function(e,t){s("b1OzQ")})),s.register("atjy1",(function(e,t){})),s.register("aHVUg",(function(e,t){s("ggckF")})),s.register("ggckF",(function(e,t){function r(e,t){for(var n="";--t>=0;)n+=e;return n}n(e.exports,"default",(function(){return r}))})),s.register("9bRRA",(function(e,t){s("i6BPn")})),s.register("1gJgm",(function(e,t){n(e.exports,"default",(function(){return o}));var r=s("4ujSI"),a=s("bZ6XL"),i=s("fCSiB");function o(e){return r.default(e)?"["+e.map(o)+"]":a.default(e)||i.default(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}})),s.register("4tKgn",(function(e,t){})),s.register("iQB5z",(function(e,t){s("9S3AQ"),s("8AF0b")})),s.register("aJW1g",(function(e,t){})),s.register("6D24N",(function(e,t){function r(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}n(e.exports,"default",(function(){return r}))})),s.register("gXjWY",(function(e,t){})),s.register("1Q72v",(function(e,t){})),s.register("fldOo",(function(e,t){n(e.exports,"getViewConfigContinuousSize",(function(){return y})),n(e.exports,"getViewConfigDiscreteStep",(function(){return x})),n(e.exports,"getViewConfigDiscreteSize",(function(){return b})),n(e.exports,"DEFAULT_STEP",(function(){return k})),n(e.exports,"initConfig",(function(){return D})),n(e.exports,"stripAndRedirectConfig",(function(){return I})),s("1i51P");var r=s("9M1dW"),a=s("2lx0N");s("iSlfb");var i=s("bZ6XL"),o=s("krpEv"),u=s("aLoDX"),c=s("imwrT"),l=s("k2bZF"),f=s("9280j"),d=s("4sOzK"),p=(d=s("4sOzK"),s("7J7Lf")),h=s("5XFBz"),v=s("eg4js"),g=s("aiwuu"),m=s("lSb9O");function y(e,t){var n;return null!==(n=e[t])&&void 0!==n?n:e["width"===t?"continuousWidth":"continuousHeight"]}function x(e,t){var n=b(e,t);return v.isStep(n)?n.step:k}function b(e,t){var n,r=null!==(n=e[t])&&void 0!==n?n:e["width"===t?"discreteWidth":"discreteHeight"];return m.getFirstDefined(r,{step:e.step})}var k=20;var w={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:k},mark:d.defaultMarkConfig,arc:{},area:{},bar:d.defaultBarConfig,circle:{},geoshape:{},image:{},line:{},point:{},rect:d.defaultRectConfig,rule:{color:"black"},square:{},text:{color:"black"},tick:d.defaultTickConfig,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:p.defaultScaleConfig,projection:{},legend:f.defaultLegendConfig,header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:h.defaultConfig,style:{},title:{},facet:{spacing:v.DEFAULT_SPACING},concat:{spacing:v.DEFAULT_SPACING}},A=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],E={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},C={blue:A[0],orange:A[1],red:A[2],teal:A[3],green:A[4],yellow:A[5],purple:A[6],pink:A[7],brown:A[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{signals:[{name:"color",value:i.default(e)?Object.assign(Object.assign({},C),e):C}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}function N(e){return{signals:[{name:"fontSize",value:i.default(e)?Object.assign(Object.assign({},E),e):E}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}function T(e){return{text:{font:e},style:{"guide-label":{font:e},"guide-title":{font:e},"group-title":{font:e},"group-subtitle":{font:e}}}}function D(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.color,n=e.font,r=e.fontSize,i=a.__rest(e,["color","font","fontSize"]);return o.mergeConfig({},w,n?T(n):{},t?S(t):{},r?N(r):{},i||{})}var F=["view"].concat(r.default(d.PRIMITIVE_MARKS)),O=["color","fontSize","background","padding","facet","concat","numberFormat","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],_=Object.assign({view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"]},d.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX);function I(e){e=m.duplicate(e);var t=!0,n=!1,r=void 0;try{for(var a,o=O[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){delete e[a.value]}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}if(e.axis)for(var s in e.axis)u.isConditionalAxisValue(e.axis[s])&&delete e.axis[s];var f=!0,p=!1,h=void 0;if(e.legend)try{for(var v,y=l.VL_ONLY_LEGEND_CONFIG[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var x=v.value;delete e.legend[x]}}catch(e){p=!0,h=e}finally{try{f||null==y.return||y.return()}finally{if(p)throw h}}if(e.mark){var b=!0,k=!1,w=void 0;try{for(var A,E=d.VL_ONLY_MARK_CONFIG_PROPERTIES[Symbol.iterator]();!(b=(A=E.next()).done);b=!0){var C=A.value;delete e.mark[C]}}catch(e){k=!0,w=e}finally{try{b||null==E.return||E.return()}finally{if(k)throw w}}e.mark.tooltip&&i.default(e.mark.tooltip)&&delete e.mark.tooltip}var S=!0,N=!1,T=void 0;try{for(var D,I=F[Symbol.iterator]();!(S=(D=I.next()).done);S=!0){var M=D.value,B=!0,P=!1,L=void 0;try{for(var j,z=d.VL_ONLY_MARK_CONFIG_PROPERTIES[Symbol.iterator]();!(B=(j=z.next()).done);B=!0){var U=j.value;delete e[M][U]}}catch(e){P=!0,L=e}finally{try{B||null==z.return||z.return()}finally{if(P)throw L}}var V=_[M],W=!0,G=!1,H=void 0;if(V)try{for(var q,J=V[Symbol.iterator]();!(W=(q=J.next()).done);W=!0){var K=q.value;delete e[M][K]}}catch(e){G=!0,H=e}finally{try{W||null==J.return||J.return()}finally{if(G)throw H}}R(e,M)}}catch(e){N=!0,T=e}finally{try{S||null==I.return||I.return()}finally{if(N)throw T}}var X=!0,Y=!1,Q=void 0;try{for(var Z,$=c.getAllCompositeMarks()[Symbol.iterator]();!(X=(Z=$.next()).done);X=!0){delete e[Z.value]}}catch(e){Y=!0,Q=e}finally{try{X||null==$.return||$.return()}finally{if(Y)throw Q}}for(var ee in function(e){var t=g.extractTitleConfig(e.title),n=t.titleMarkConfig,r=t.subtitleMarkConfig,a=t.subtitle;m.isEmpty(n)||(e.style["group-title"]=Object.assign(Object.assign({},e.style["group-title"]),n));m.isEmpty(r)||(e.style["group-subtitle"]=Object.assign(Object.assign({},e.style["group-subtitle"]),r));m.isEmpty(a)?delete e.title:e.title=a}(e),e)i.default(e[ee])&&m.isEmpty(e[ee])&&delete e[ee];return m.isEmpty(e)?void 0:e}function R(e,t,n,r){var a=r?e[t][r]:e[t];"view"===t&&(n="cell");var i=Object.assign(Object.assign({},a),e.style[null!=n?n:t]);m.isEmpty(i)||(e.style[null!=n?n:t]=i),r||delete e[t]}})),s.register("2lx0N",(function(e,t){n(e.exports,"__rest",(function(){return r}));function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;Object.create})),s.register("aLoDX",(function(e,t){n(e.exports,"CONDITIONAL_AXIS_PROP_INDEX",(function(){return a})),n(e.exports,"isConditionalAxisValue",(function(){return i})),n(e.exports,"AXIS_PARTS",(function(){return o})),n(e.exports,"AXIS_PROPERTY_TYPE",(function(){return u})),n(e.exports,"COMMON_AXIS_PROPERTIES_INDEX",(function(){return c})),n(e.exports,"isAxisProperty",(function(){return f}));var r=s("lSb9O"),a={domainColor:{part:"domain",vgProp:"stroke"},labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDash"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDash"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"},titleColor:{part:"title",vgProp:"fill"},title:null};function i(e){return e&&e.condition}var o=["domain","grid","labels","ticks","title"],u={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"main",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},c={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},l=Object.assign(Object.assign({},c),{style:1,labelExpr:1,encoding:1});function f(e){return!!l[e]}r.keys(l)})),s.register("lSb9O",(function(e,r){n(e.exports,"deepEqual",(function(){return m})),n(e.exports,"duplicate",(function(){return y})),n(e.exports,"pick",(function(){return x})),n(e.exports,"omit",(function(){return b})),n(e.exports,"stringify",(function(){return k})),n(e.exports,"hash",(function(){return w})),n(e.exports,"isNullOrFalse",(function(){return A})),n(e.exports,"contains",(function(){return E})),n(e.exports,"some",(function(){return C})),n(e.exports,"every",(function(){return S})),n(e.exports,"mergeDeep",(function(){return N})),n(e.exports,"keys",(function(){return M})),n(e.exports,"unique",(function(){return D})),n(e.exports,"setEqual",(function(){return F})),n(e.exports,"hasIntersection",(function(){return O})),n(e.exports,"fieldIntersection",(function(){return I})),n(e.exports,"isEmpty",(function(){return R})),n(e.exports,"vals",(function(){return B})),n(e.exports,"entries",(function(){return P})),n(e.exports,"isBoolean",(function(){return L})),n(e.exports,"varName",(function(){return j})),n(e.exports,"logicalExpr",(function(){return z})),n(e.exports,"deleteNestedProperty",(function(){return U})),n(e.exports,"titleCase",(function(){return V})),n(e.exports,"accessPathWithDatum",(function(){return W})),n(e.exports,"flatAccessWithDatum",(function(){return G})),n(e.exports,"replacePathInField",(function(){return q})),n(e.exports,"replaceAll",(function(){return J})),n(e.exports,"removePathFromField",(function(){return K})),n(e.exports,"accessPathDepth",(function(){return X})),n(e.exports,"getFirstDefined",(function(){return Y})),n(e.exports,"uniqueId",(function(){return Z})),n(e.exports,"internalField",(function(){return $})),n(e.exports,"normalizeAngle",(function(){return ee})),n(e.exports,"isNumeric",(function(){return te})),s("1i51P");var a=s("9M1dW"),i=s("6vecG");s("1Cmq6");var o=s("71JfB"),u=s("h3ySq"),c=s("hSVs3");s("iSlfb");var l=s("b1OzQ"),f=s("8AF0b"),d=s("fCSiB"),p=s("krpEv"),h=s("8ozlU"),v=s("1gJgm"),g=s("12Yae"),m=t(u),y=t(o);function x(e,t){var n={},r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;l.default(e,s)&&(n[s]=e[s])}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}function b(e,t){var n=Object.assign({},e),r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){delete n[o.value]}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}Set.prototype.toJSON=function(){return"Set(".concat(a.default(this).map((function(e){return t(c)(e)})).join(","),")")};var k=t(c);function w(e){if(f.default(e))return e;var n=d.default(e)?e:t(c)(e);if(n.length<250)return n;for(var r=0,a=0;a<n.length;a++){r=(r<<5)-r+n.charCodeAt(a),r&=r}return r}function A(e){return!1===e||null===e}function E(e,t){return e.indexOf(t)>-1}function C(e,t){var n=0,r=!0,a=!1,o=void 0;try{for(var u,s=e.entries()[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=i.default(u.value,2),l=c[0];if(t(c[1],l,n++))return!0}}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return!1}function S(e,t){var n=0,r=!0,a=!1,o=void 0;try{for(var u,s=e.entries()[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=i.default(u.value,2),l=c[0];if(!t(c[1],l,n++))return!1}}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return!0}function N(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=!0,i=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;T(e,null!=c?c:{})}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return e}function T(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=M(t)[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;p.writeConfig(e,u,t[u],!0)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}function D(e,t){var n,r=[],a={},i=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;(n=t(l))in a||(a[n]=1,r.push(l))}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}return r}function F(e,t){if(e.size!==t.size)return!1;var n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;if(!t.has(u))return!1}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return!0}function O(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;if(t.has(u))return!0}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return!1}function _(e){var t=new Set,n=!0,r=!1,a=void 0;try{for(var i,o=function(e,n){var r=n.value,a=h.default(r).map((function(e,t){return 0===t?e:"[".concat(e,"]")})),i=a.map((function(e,t){return a.slice(0,t+1).join("")})),o=!0,u=!1,s=void 0;try{for(var c,l=i[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;t.add(f)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}},u=e[Symbol.iterator]();!(n=(i=u.next()).done);n=!0)o(0,i)}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}return t}function I(e,t){return void 0===e||void 0===t||O(_(e),_(t))}function R(e){return 0===M(e).length}var M=Object.keys,B=Object.values;function P(e){var t=[];for(var n in e)l.default(e,n)&&t.push({key:n,value:e[n]});return t}function L(e){return!0===e||!1===e}function j(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t}function z(e,t){return g.isLogicalNot(e)?"!("+z(e.not,t)+")":g.isLogicalAnd(e)?"("+e.and.map((function(e){return z(e,t)})).join(") && (")+")":g.isLogicalOr(e)?"("+e.or.map((function(e){return z(e,t)})).join(") || (")+")":t(e)}function U(e,t){if(0===t.length)return!0;var n=t.shift();return n in e&&U(e[n],t)&&delete e[n],R(e)}function V(e){return e.charAt(0).toUpperCase()+e.substr(1)}function W(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum",n=h.default(e),r=[],a=1;a<=n.length;a++){var i="[".concat(n.slice(0,a).map(v.default).join("]["),"]");r.push("".concat(t).concat(i))}return r.join(" && ")}function G(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"datum";return"".concat(t,"[").concat(v.default(h.default(e).join(".")),"]")}function H(e){return e.replace(/(\[|\]|\.|'|")/g,"\\$1")}function q(e){return"".concat(h.default(e).map(H).join("\\."))}function J(e,t,n){return e.replace(new RegExp(t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function K(e){return"".concat(h.default(e).join("."))}function X(e){return e?h.default(e).length:0}function Y(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(void 0!==s)return s}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}var Q=42;function Z(e){var t=++Q;return e?String(e)+t:t}function $(e){return function(e){return 0===e.indexOf("__")}(e)?e:"__".concat(e)}function ee(e){if(void 0!==e)return(e%360+360)%360}function te(e){return!!f.default(e)||!isNaN(e)&&!isNaN(parseFloat(e))}})),s.register("1Cmq6",(function(e,t){Array.prototype.flat||Object.defineProperty(Array.prototype,"flat",{configurable:!0,value:function e(){var t=isNaN(arguments[0])?1:Number(arguments[0]);return t?Array.prototype.reduce.call(this,(function(n,r){return Array.isArray(r)?n.push.apply(n,e.call(r,t-1)):n.push(r),n}),[]):Array.prototype.slice.call(this)},writable:!0}),Array.prototype.flatMap||Object.defineProperty(Array.prototype,"flatMap",{configurable:!0,value:function(e){return Array.prototype.map.apply(this,arguments).flat()},writable:!0})})),s.register("71JfB",(function(e,t){var n=s("1mtJC").Buffer,r=function(){function e(e,t){return null!=t&&e instanceof t}var t,r,a;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{a=Promise}catch(e){a=function(){}}function i(o,s,c,l,f){"object"==typeof s&&(c=s.depth,l=s.prototype,f=s.includeNonEnumerable,s=s.circular);var d=[],p=[],h=void 0!==n;return void 0===s&&(s=!0),void 0===c&&(c=1/0),function o(c,v){if(null===c)return null;if(0===v)return c;var g,m;if("object"!=typeof c)return c;if(e(c,t))g=new t;else if(e(c,r))g=new r;else if(e(c,a))g=new a((function(e,t){c.then((function(t){e(o(t,v-1))}),(function(e){t(o(e,v-1))}))}));else if(i.__isArray(c))g=[];else if(i.__isRegExp(c))g=new RegExp(c.source,u(c)),c.lastIndex&&(g.lastIndex=c.lastIndex);else if(i.__isDate(c))g=new Date(c.getTime());else{if(h&&n.isBuffer(c))return g=n.allocUnsafe?n.allocUnsafe(c.length):new n(c.length),c.copy(g),g;e(c,Error)?g=Object.create(c):void 0===l?(m=Object.getPrototypeOf(c),g=Object.create(m)):(g=Object.create(l),m=l)}if(s){var y=d.indexOf(c);if(-1!=y)return p[y];d.push(c),p.push(g)}for(var x in e(c,t)&&c.forEach((function(e,t){var n=o(t,v-1),r=o(e,v-1);g.set(n,r)})),e(c,r)&&c.forEach((function(e){var t=o(e,v-1);g.add(t)})),c){var b;m&&(b=Object.getOwnPropertyDescriptor(m,x)),b&&null==b.set||(g[x]=o(c[x],v-1))}if(Object.getOwnPropertySymbols){var k=Object.getOwnPropertySymbols(c);for(x=0;x<k.length;x++){var w=k[x];(!(E=Object.getOwnPropertyDescriptor(c,w))||E.enumerable||f)&&(g[w]=o(c[w],v-1),E.enumerable||Object.defineProperty(g,w,{enumerable:!1}))}}if(f){var A=Object.getOwnPropertyNames(c);for(x=0;x<A.length;x++){var E,C=A[x];(E=Object.getOwnPropertyDescriptor(c,C))&&E.enumerable||(g[C]=o(c[C],v-1),Object.defineProperty(g,C,{enumerable:!1}))}}return g}(o,c)}function o(e){return Object.prototype.toString.call(e)}function u(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return i.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},i.__objToStr=o,i.__isDate=function(e){return"object"==typeof e&&"[object Date]"===o(e)},i.__isArray=function(e){return"object"==typeof e&&"[object Array]"===o(e)},i.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===o(e)},i.__getRegExpFlags=u,i}();e.exports&&(e.exports=r)})),s.register("h3ySq",(function(e,t){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!=a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;0!=a--;){var o=i[a];if(!e(t[o],n[o]))return!1}return!0}return t!=t&&n!=n}})),s.register("hSVs3",(function(e,t){"use strict";e.exports=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var n,r="boolean"==typeof t.cycles&&t.cycles,a=t.cmp&&(n=t.cmp,function(e){return function(t,r){var a={key:t,value:e[t]},i={key:r,value:e[r]};return n(a,i)}}),i=[];return function e(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var n,o;if(Array.isArray(t)){for(o="[",n=0;n<t.length;n++)n&&(o+=","),o+=e(t[n])||"null";return o+"]"}if(null===t)return"null";if(-1!==i.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var u=i.push(t)-1,s=Object.keys(t).sort(a&&a(t));for(o="",n=0;n<s.length;n++){var c=s[n],l=e(t[c]);l&&(o&&(o+=","),o+=JSON.stringify(c)+":"+l)}return i.splice(u,1),"{"+o+"}"}}(e)}})),s.register("12Yae",(function(e,t){function r(e){return!!e.or}function a(e){return!!e.and}function i(e){return!!e.not}function o(e,t){var n=!0,u=!1,s=void 0,c=!0,l=!1,f=void 0;if(i(e))o(e.not,t);else if(a(e))try{for(var d,p=e.and[Symbol.iterator]();!(n=(d=p.next()).done);n=!0){o(d.value,t)}}catch(e){u=!0,s=e}finally{try{n||null==p.return||p.return()}finally{if(u)throw s}}else if(r(e))try{for(var h,v=e.or[Symbol.iterator]();!(c=(h=v.next()).done);c=!0){o(h.value,t)}}catch(e){l=!0,f=e}finally{try{c||null==v.return||v.return()}finally{if(l)throw f}}else t(e)}function u(e,t){return i(e)?{not:u(e.not,t)}:a(e)?{and:e.and.map((function(e){return u(e,t)}))}:r(e)?{or:e.or.map((function(e){return u(e,t)}))}:t(e)}n(e.exports,"isLogicalOr",(function(){return r})),n(e.exports,"isLogicalAnd",(function(){return a})),n(e.exports,"isLogicalNot",(function(){return i})),n(e.exports,"forEachLeaf",(function(){return o})),n(e.exports,"normalizeLogicalComposition",(function(){return u}))})),s.register("imwrT",(function(e,t){n(e.exports,"getAllCompositeMarks",(function(){return f}));var r=s("lSb9O"),a=s("ioRdy"),i=s("ctDl5"),o=s("bY77U"),u=s("jEBxI"),c={};function l(e,t,n){var r=new a.CompositeMarkNormalizer(e,t);c[e]={normalizer:r,parts:n}}function f(){return r.keys(c)}l(i.BOXPLOT,i.normalizeBoxPlot,i.BOXPLOT_PARTS),l(u.ERRORBAR,u.normalizeErrorBar,u.ERRORBAR_PARTS),l(o.ERRORBAND,o.normalizeErrorBand,o.ERRORBAND_PARTS)})),s.register("ioRdy",(function(e,t){n(e.exports,"CompositeMarkNormalizer",(function(){return u})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("4sOzK"),o=s("aIH68"),u=function(){"use strict";function e(t,n){r.default(this,e),this.name=t,this.run=n}return a.default(e,[{key:"hasMatchingType",value:function(e){return!!o.isUnitSpec(e)&&i.getMarkType(e.mark)===this.name}}]),e}()})),s.register("4sOzK",(function(e,t){n(e.exports,"ARC",(function(){return u})),n(e.exports,"AREA",(function(){return c})),n(e.exports,"BAR",(function(){return l})),n(e.exports,"IMAGE",(function(){return f})),n(e.exports,"LINE",(function(){return d})),n(e.exports,"POINT",(function(){return p})),n(e.exports,"RECT",(function(){return h})),n(e.exports,"RULE",(function(){return v})),n(e.exports,"TEXT",(function(){return g})),n(e.exports,"TICK",(function(){return m})),n(e.exports,"TRAIL",(function(){return y})),n(e.exports,"CIRCLE",(function(){return x})),n(e.exports,"SQUARE",(function(){return b})),n(e.exports,"GEOSHAPE",(function(){return k})),n(e.exports,"isPathMark",(function(){return w})),n(e.exports,"isRectBasedMark",(function(){return A})),n(e.exports,"PRIMITIVE_MARKS",(function(){return E})),n(e.exports,"isMarkDef",(function(){return C})),n(e.exports,"FILL_STROKE_CONFIG",(function(){return S})),n(e.exports,"VL_ONLY_MARK_CONFIG_PROPERTIES",(function(){return N})),n(e.exports,"VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX",(function(){return T})),n(e.exports,"defaultMarkConfig",(function(){return D})),n(e.exports,"BAR_CORNER_RADIUS_INDEX",(function(){return F})),n(e.exports,"defaultBarConfig",(function(){return O})),n(e.exports,"defaultRectConfig",(function(){return _})),n(e.exports,"defaultTickConfig",(function(){return I})),n(e.exports,"getMarkType",(function(){return R})),s("1i51P");var r=s("9M1dW");s("iSlfb");var a=s("6D24N"),i=s("lSb9O"),o={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},u=o.arc,c=o.area,l=o.bar,f=o.image,d=o.line,p=o.point,h=o.rect,v=o.rule,g=o.text,m=o.tick,y=o.trail,x=o.circle,b=o.square,k=o.geoshape;function w(e){return i.contains(["line","area","trail"],e)}function A(e){return i.contains(["rect","bar","image","arc"],e)}var E=i.keys(o);function C(e){return e.type}a.default(E);var S=r.default(["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"]).concat(r.default(["fill","fillOpacity"])),N=i.keys({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBand:1,timeUnitBandPosition:1}),T={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],tick:["bandSize","thickness"]},D={color:"#4c78a8",invalid:"filter",timeUnitBand:1},F={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},O={binSpacing:1,continuousBandSize:5,timeUnitBandPosition:.5},_={binSpacing:0,continuousBandSize:5,timeUnitBandPosition:.5},I={thickness:1};function R(e){return C(e)?e.type:e}})),s.register("aIH68",(function(e,t){function r(e){return"mark"in e}n(e.exports,"isUnitSpec",(function(){return r}))})),s.register("ctDl5",(function(e,t){n(e.exports,"BOXPLOT",(function(){return m})),n(e.exports,"BOXPLOT_PARTS",(function(){return y})),n(e.exports,"boxPlotNormalizer",(function(){return x})),n(e.exports,"normalizeBoxPlot",(function(){return k})),s("1i51P");var r=s("9M1dW"),a=s("4Ui3v"),i=s("5lcaY"),o=s("2lx0N");s("iSlfb");var u=s("8AF0b"),c=s("bZ6XL"),l=s("9iwJo"),f=s("jQ4iQ"),d=s("16rNM"),p=s("2x4HI"),h=s("4sOzK"),v=s("ioRdy"),g=s("7iwSx"),m="boxplot",y=["box","median","outliers","rule","ticks"],x=new v.CompositeMarkNormalizer(m,k);function b(e){return u.default(e)?"tukey":e}function k(e,t){var n,u,s=t.config,v=e.mark,y=(e.encoding,e.selection),x=(e.projection,o.__rest(e,["mark","encoding","selection","projection"])),k=h.isMarkDef(v)?v:{type:v};y&&d.warn(p.selectionNotSupported("boxplot"));var A,E=null!==(n=k.extent)&&void 0!==n?n:s.boxplot.extent,C=l.getMarkPropOrConfig("size",k,s),S=b(E),N=function(e,t,n){var a=g.compositeMarkOrient(e,m),u=g.compositeMarkContinuousAxis(e,a,m),s=u.continuousAxisChannelDef,c=u.continuousAxis,l=s.field,d=b(t),p=r.default(w(l)).concat([{op:"median",field:l,as:"mid_box_"+l},{op:"min",field:l,as:("min-max"===d?"lower_whisker_":"min_")+l},{op:"max",field:l,as:("min-max"===d?"upper_whisker_":"max_")+l}]),h="min-max"===d||"tukey"===d?[]:[{calculate:'datum["upper_box_'.concat(l,'"] - datum["lower_box_').concat(l,'"]'),as:"iqr_"+l},{calculate:'min(datum["upper_box_'.concat(l,'"] + datum["iqr_').concat(l,'"] * ').concat(t,', datum["max_').concat(l,'"])'),as:"upper_whisker_"+l},{calculate:'max(datum["lower_box_'.concat(l,'"] - datum["iqr_').concat(l,'"] * ').concat(t,', datum["min_').concat(l,'"])'),as:"lower_whisker_"+l}],v=e.encoding,y=c,x=(v[y],o.__rest(v,["symbol"===(void 0===y?"undefined":i.default(y))?y:y+""])),k=g.filterTooltipWithAggregatedField(x),A=k.customTooltipWithoutAggregatedField,E=k.filteredEncoding,C=f.extractTransformsFromEncoding(E,n),S=C.bins,N=C.timeUnits,T=C.aggregate,D=C.groupby,F=C.encoding,O="vertical"===a?"horizontal":"vertical",_=a;return{transform:r.default(S).concat(r.default(N),[{aggregate:r.default(T).concat(r.default(p)),groupby:D}],r.default(h)),groupby:D,aggregate:T,continuousAxisChannelDef:s,continuousAxis:c,encodingWithoutContinuousAxis:F,ticksOrient:O,boxOrient:_,customTooltipWithoutAggregatedField:A}}(e,E,s),T=N.transform,D=N.continuousAxisChannelDef,F=N.continuousAxis,O=N.groupby,_=N.aggregate,I=N.encodingWithoutContinuousAxis,R=N.ticksOrient,M=N.boxOrient,B=N.customTooltipWithoutAggregatedField,P=(I.color,I.size),L=o.__rest(I,["color","size"]),j=function(e){return g.makeCompositeAggregatePartFactory(k,F,D,e,s.boxplot)},z=j(L),U=j(I),V=j(Object.assign(Object.assign({},L),P?{size:P}:{})),W=g.getCompositeMarkTooltip([{fieldPrefix:"min-max"===S?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===S?"lower_whisker_":"min_",titlePrefix:"Min"}],D,I),G={type:"tick",color:"black",opacity:1,orient:R,invalid:null},H="min-max"===S?W:g.getCompositeMarkTooltip([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],D,I),q=r.default(z({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",aria:!1,extraEncoding:H})).concat(r.default(z({partName:"rule",mark:{type:"rule",invalid:null},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",aria:!1,extraEncoding:H})),r.default(z({partName:"ticks",mark:G,positionPrefix:"lower_whisker",aria:!1,extraEncoding:H})),r.default(z({partName:"ticks",mark:G,positionPrefix:"upper_whisker",aria:!1,extraEncoding:H}))),J=r.default("tukey"!==S?q:[]).concat(r.default(U({partName:"box",mark:Object.assign(Object.assign({type:"bar"},C?{size:C}:{}),{orient:M,invalid:null}),positionPrefix:"lower_box",endPositionPrefix:"upper_box",aria:!1,extraEncoding:W})),r.default(V({partName:"median",mark:Object.assign(Object.assign(Object.assign({type:"tick",invalid:null},c.default(s.boxplot.median)&&s.boxplot.median.color?{color:s.boxplot.median.color}:{}),C?{size:C}:{}),{orient:R,ariaRoleDescription:"box"}),positionPrefix:"mid_box",extraEncoding:W})));if("min-max"!==S){var K='datum["lower_box_'.concat(D.field,'"]'),X='datum["upper_box_'.concat(D.field,'"]'),Y="(".concat(X," - ").concat(K,")"),Q="".concat(K," - ").concat(E," * ").concat(Y),Z="".concat(X," + ").concat(E," * ").concat(Y),$='datum["'.concat(D.field,'"]'),ee={joinaggregate:w(D.field),groupby:O},te=void 0;"tukey"===S&&(te={transform:[{filter:"(".concat(Q," <= ").concat($,") && (").concat($," <= ").concat(Z,")")},{aggregate:[{op:"min",field:D.field,as:"lower_whisker_"+D.field},{op:"max",field:D.field,as:"upper_whisker_"+D.field},{op:"min",field:"lower_box_"+D.field,as:"lower_box_"+D.field},{op:"max",field:"upper_box_"+D.field,as:"upper_box_"+D.field}].concat(r.default(_)),groupby:O}],layer:q});L.tooltip;var ne=o.__rest(L,["tooltip"]),re=D.scale,ae=D.axis,ie=g.getTitle(D),oe=g.partLayerMixins(k,"outliers",s.boxplot,!0,{transform:[{filter:"(".concat($," < ").concat(Q,") || (").concat($," > ").concat(Z,")")}],mark:"point",encoding:Object.assign(Object.assign(a.default({},F,Object.assign(Object.assign(Object.assign({field:D.field,type:D.type},void 0!==ie?{title:ie}:{}),void 0!==re?{scale:re}:{}),void 0!==ae?{axis:ae}:{})),ne),B?{tooltip:B}:{})})[0];oe&&te?A={transform:[ee],layer:[oe,te]}:oe?(A=oe).transform.unshift(ee):te&&(A=te).transform.unshift(ee)}return A?Object.assign(Object.assign({},x),{layer:[A,{transform:T,layer:J}]}):Object.assign(Object.assign({},x),{transform:(null!==(u=x.transform)&&void 0!==u?u:[]).concat(T),layer:J})}function w(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}})),s.register("9iwJo",(function(e,t){n(e.exports,"signalOrValueRef",(function(){return f})),n(e.exports,"exprFromValueOrSignalRef",(function(){return d})),n(e.exports,"signalOrStringValue",(function(){return p})),n(e.exports,"applyMarkConfig",(function(){return h})),n(e.exports,"getMarkConfig",(function(){return m})),n(e.exports,"getStyles",(function(){return v})),n(e.exports,"getMarkPropOrConfig",(function(){return g})),n(e.exports,"getMarkStyleConfig",(function(){return y})),n(e.exports,"getStyleConfig",(function(){return x})),n(e.exports,"sortParams",(function(){return b})),n(e.exports,"mergeTitleFieldDefs",(function(){return k})),n(e.exports,"mergeTitle",(function(){return w})),n(e.exports,"mergeTitleComponent",(function(){return A})),s("1i51P");var r=s("9M1dW");s("iSlfb");var a=s("1gJgm"),i=s("1Ihp0"),o=s("iooJ7"),u=s("aiwuu"),c=s("lSb9O"),l=s("7T458");function f(e){return l.isSignalRef(e)?e:void 0!==e?{value:e}:void 0}function d(e){return l.isSignalRef(e)?e.signal:a.default(e.value)}function p(e){return l.isSignalRef(e)?e.signal:null==e?null:a.default(e)}function h(e,t,n){var r=!0,a=!1,i=void 0;try{for(var o,u=n[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,c=m(s,t.markDef,t.config);void 0!==c&&(e[s]=f(c))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return e}function v(e){var t;return[].concat(e.type,null!==(t=e.style)&&void 0!==t?t:[])}function g(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=r.vgChannel,i=r.ignoreVgConfig;return a&&void 0!==t[a]?t[a]:void 0!==t[e]?t[e]:!i||a&&a!==e?m(e,t,n,r):void 0}function m(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).vgChannel;return c.getFirstDefined(r?y(e,t,n.style):void 0,y(e,t,n.style),r?n[t.type][r]:void 0,n[t.type][e],r?n.mark[r]:n.mark[e])}function y(e,t,n){return x(e,v(t),n)}function x(e,t,n){var r;t=i.default(t);var a=!0,o=!1,u=void 0;try{for(var s,c=t[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=n[s.value];l&&void 0!==l[e]&&(r=l[e])}}catch(e){o=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(o)throw u}}return r}function b(e,t){return i.default(e).reduce((function(e,n){var r;return e.field.push(o.vgField(n,t)),e.order.push(null!==(r=n.sort)&&void 0!==r?r:"ascending"),e}),{field:[],order:[]})}function k(e,t){var n=r.default(e);return t.forEach((function(e){var t=!0,r=!1,a=void 0;try{for(var i,o=n[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value;if(c.deepEqual(u,e))return}}catch(e){r=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw a}}n.push(e)})),n}function w(e,t){return c.deepEqual(e,t)||!t?e:e?r.default(i.default(e)).concat(r.default(i.default(t))).join(", "):t}function A(e,t){var n=e.value,r=t.value;if(null==n||null===r)return{explicit:e.explicit,value:null};if((u.isText(n)||l.isSignalRef(n))&&(u.isText(r)||l.isSignalRef(r)))return{explicit:e.explicit,value:w(n,r)};if(u.isText(n)||l.isSignalRef(n))return{explicit:e.explicit,value:n};if(u.isText(r)||l.isSignalRef(r))return{explicit:e.explicit,value:r};if(!(u.isText(n)||l.isSignalRef(n)||u.isText(r)||l.isSignalRef(r)))return{explicit:e.explicit,value:k(n,r)};throw new Error("It should never reach here")}})),s.register("iooJ7",(function(e,t){n(e.exports,"isConditionalSelection",(function(){return C})),n(e.exports,"isRepeatRef",(function(){return S})),n(e.exports,"toFieldDefBase",(function(){return N})),n(e.exports,"isSortableFieldDef",(function(){return T})),n(e.exports,"isTypedFieldDef",(function(){return U})),n(e.exports,"getBand",(function(){return D})),n(e.exports,"isFieldOrDatumDef",(function(){return z})),n(e.exports,"isFieldDef",(function(){return M})),n(e.exports,"hasBand",(function(){return F})),n(e.exports,"isConditionalDef",(function(){return O})),n(e.exports,"hasConditionalFieldDef",(function(){return _})),n(e.exports,"hasConditionalFieldOrDatumDef",(function(){return I})),n(e.exports,"hasConditionalValueDef",(function(){return R})),n(e.exports,"isValueDef",(function(){return V})),n(e.exports,"channelDefType",(function(){return B})),n(e.exports,"isDatumDef",(function(){return P})),n(e.exports,"isContinuousFieldOrDatumDef",(function(){return L})),n(e.exports,"isNumericDataDef",(function(){return j})),n(e.exports,"isScaleFieldDef",(function(){return W})),n(e.exports,"isPositionFieldOrDatumDef",(function(){return G})),n(e.exports,"vgField",(function(){return K})),n(e.exports,"isDiscrete",(function(){return X})),n(e.exports,"setTitleFormatter",(function(){return ee})),n(e.exports,"resetTitleFormatter",(function(){return te})),n(e.exports,"title",(function(){return ne})),n(e.exports,"getGuide",(function(){return re})),n(e.exports,"defaultTitle",(function(){return ae})),n(e.exports,"getFormatMixins",(function(){return ie})),n(e.exports,"getFieldDef",(function(){return oe})),n(e.exports,"getFieldOrDatumDef",(function(){return ue})),n(e.exports,"initChannelDef",(function(){return se})),n(e.exports,"initFieldDef",(function(){return le})),n(e.exports,"normalizeBin",(function(){return fe})),n(e.exports,"isFieldOrDatumDefForTimeFormat",(function(){return pe})),n(e.exports,"valueExpr",(function(){return he})),n(e.exports,"valueArray",(function(){return ve})),n(e.exports,"binRequiresRange",(function(){return ge})),s("1i51P");var r=s("4Ui3v"),a=s("2lx0N");s("iSlfb");var i=s("fCSiB"),o=s("4ujSI"),u=s("8AF0b"),c=s("iRIM1"),l=s("6jZCp"),f=s("61RXI"),d=s("e3OyN"),p=s("9iwJo"),h=s("ixH3E"),v=s("ggS1y");s("16rNM");var g=s("2x4HI"),m=s("16rNM"),y=s("4sOzK"),x=s("2V3EF"),b=s("pZnnI"),k=s("gQOdy"),w=s("4jgmF"),A=s("lSb9O"),E=s("7T458");function C(e){return e.selection}function S(e){return e&&!i.default(e)&&"repeat"in e}function N(e){var t=e.field,n=e.timeUnit,r=e.bin,a=e.aggregate;return Object.assign(Object.assign(Object.assign(Object.assign({},n?{timeUnit:n}:{}),r?{bin:r}:{}),a?{aggregate:a}:{}),{field:t})}function T(e){return U(e)&&"sort"in e}function D(e){var t=e.channel,n=e.fieldDef,r=e.fieldDef2,a=e.markDef,i=e.stack,o=e.config,u=e.isMidPoint;if(z(n)&&void 0!==n.band)return n.band;if(M(n)){var s=n.timeUnit,c=n.bin;if(s&&!r)return u?p.getMarkConfig("timeUnitBandPosition",a,o):y.isRectBasedMark(a.type)?p.getMarkConfig("timeUnitBand",a,o):0;if(f.isBinning(c))return y.isRectBasedMark(a.type)&&!u?1:.5}return(null==i?void 0:i.fieldChannel)===t&&u?.5:void 0}function F(e,t,n,r,a,i){return!!(f.isBinning(t.bin)||t.timeUnit&&U(t)&&"temporal"===t.type)&&!!D({channel:e,fieldDef:t,fieldDef2:n,stack:r,markDef:a,config:i})}function O(e){return!!e&&"condition"in e}function _(e){var t=e&&e.condition;return!!t&&!o.default(t)&&M(t)}function I(e){var t=e&&e.condition;return!!t&&!o.default(t)&&z(t)}function R(e){var t=e&&e.condition;return!!t&&(o.default(t)||V(t))}function M(e){return!(!e||!e.field&&"count"!==e.aggregate)}function B(e){return e&&e.type}function P(e){return!!e&&"datum"in e}function L(e){return U(e)&&Y(e)||j(e)}function j(e){return P(e)&&u.default(e.datum)}function z(e){return M(e)||P(e)}function U(e){return!!e&&("field"in e&&"type"in e||"count"===e.aggregate)}function V(e){return e&&"value"in e&&"value"in e}function W(e){return!!e&&("scale"in e||"sort"in e)}function G(e){return e&&("axis"in e||"stack"in e||"impute"in e)}function H(e){return!!e&&"legend"in e}function q(e){return!!e&&("format"in e||"formatType"in e)}function J(e){return"op"in e}function K(e){var t,n,r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.field,o=a.prefix,u=a.suffix,s="";if(Q(e))i=A.internalField("count");else{var c;if(!a.nofn)if(J(e))c=e.op;else{var d=e.bin,p=e.aggregate,h=e.timeUnit;f.isBinning(d)?(c=f.binToString(d),u=(null!==(t=a.binSuffix)&&void 0!==t?t:"")+(null!==(n=a.suffix)&&void 0!==n?n:"")):p?l.isArgmaxDef(p)?(s='["'.concat(i,'"]'),i="argmax_".concat(p.argmax)):l.isArgminDef(p)?(s='["'.concat(i,'"]'),i="argmin_".concat(p.argmin)):c=String(p):h&&(c=k.timeUnitToString(h),u=(!A.contains(["range","mid"],a.binSuffix)&&a.binSuffix||"")+(null!==(r=a.suffix)&&void 0!==r?r:""))}c&&(i=i?"".concat(c,"_").concat(i):c)}return u&&(i="".concat(i,"_").concat(u)),o&&(i="".concat(o,"_").concat(i)),a.forAs?A.removePathFromField(i):a.expr?A.flatAccessWithDatum(i,a.expr)+s:A.replacePathInField(i)+s}function X(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return M(e)&&!!e.bin;case"temporal":return!1}throw new Error(g.invalidFieldType(e.type))}function Y(e){return!X(e)}function Q(e){return"count"===e.aggregate}var Z=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return function(e){var t=e.aggregate,n=e.bin,r=e.timeUnit,a=e.field;if(l.isArgmaxDef(t))return"".concat(a," for argmax(").concat(t.argmax,")");if(l.isArgminDef(t))return"".concat(a," for argmin(").concat(t.argmin,")");var i=k.normalizeTimeUnit(r),o=t||(null==i?void 0:i.unit)||(null==i?void 0:i.maxbins)&&"timeunit"||f.isBinning(n)&&"bin";return o?o.toUpperCase()+"("+a+")":a}(e);default:return function(e,t){var n,r=e.field,a=e.bin,i=e.timeUnit,o=e.aggregate;if("count"===o)return t.countTitle;if(f.isBinning(a))return"".concat(r," (binned)");if(i){var u=null===(n=k.normalizeTimeUnit(i))||void 0===n?void 0:n.unit;if(u)return"".concat(r," (").concat(k.getTimeUnitParts(u).join("-"),")")}else if(o)return l.isArgmaxDef(o)?"".concat(r," for max ").concat(o.argmax):l.isArgminDef(o)?"".concat(r," for min ").concat(o.argmin):"".concat(A.titleCase(o)," of ").concat(r);return r}(e,t)}},$=Z;function ee(e){$=e}function te(){ee(Z)}function ne(e,t,n){var r,a,i=n.allowDisabling,o=n.includeDefault,u=void 0===o||o,s=(null!==(r=re(e))&&void 0!==r?r:{}).title;if(!M(e))return s;var c=e,l=u?ae(c,t):void 0;return i?A.getFirstDefined(s,c.title,l):null!==(a=null!=s?s:c.title)&&void 0!==a?a:l}function re(e){return G(e)&&e.axis?e.axis:H(e)&&e.legend?e.legend:b.isFacetFieldDef(e)&&e.header?e.header:void 0}function ae(e,t){return $(e,t)}function ie(e){var t;if(q(e))return{format:e.format,formatType:e.formatType};var n=null!==(t=re(e))&&void 0!==t?t:{};return{format:n.format,formatType:n.formatType}}function oe(e){return M(e)?e:_(e)?e.condition:void 0}function ue(e){return z(e)?e:I(e)?e.condition:void 0}function se(e,t,n){if(i.default(e)||u.default(e)||c.default(e)){var r=i.default(e)?"string":u.default(e)?"number":"boolean";return m.warn(g.primitiveChannelDef(t,r,e)),{value:e}}return z(e)?ce(e,t,n):I(e)?Object.assign(Object.assign({},e),{condition:ce(e.condition,t,n)}):e}function ce(e,t,n){if(q(e)){e.format;var o=e.formatType,s=a.__rest(e,["format","formatType"]);if(h.isCustomFormatType(o)&&!n.customFormatTypes)return m.warn(g.customFormatTypeNotAllowed(t)),ce(s,t,n)}else{var c=G(e)?"axis":H(e)?"legend":b.isFacetFieldDef(e)?"header":null;if(c&&e[c]){var l=e[c],f=(l.format,l.formatType),d=a.__rest(l,["format","formatType"]);if(h.isCustomFormatType(f)&&!n.customFormatTypes)return m.warn(g.customFormatTypeNotAllowed(t)),ce(Object.assign(Object.assign({},e),r.default({},c,d)),t,n)}}return M(e)?le(e,t):function(e){var t=e.type;if(t)return e;var n=e.datum;return t=u.default(n)?"quantitative":i.default(n)?"nominal":v.isDateTime(n)?"temporal":void 0,Object.assign(Object.assign({},e),{type:t})}(e)}function le(e,t){var n=e.aggregate,r=e.timeUnit,o=e.bin,u=e.field,s=Object.assign({},e);if(!n||l.isAggregateOp(n)||l.isArgmaxDef(n)||l.isArgminDef(n)||(m.warn(g.invalidAggregate(n)),delete s.aggregate),r&&(s.timeUnit=k.normalizeTimeUnit(r)),u&&(s.field="".concat(u)),f.isBinning(o)&&(s.bin=fe(o,t)),f.isBinned(o)&&!d.isXorY(t)&&m.warn("Channel ".concat(t,' should not be used with "binned" bin.')),U(s)){var c=s.type,p=w.getFullName(c);c!==p&&(s.type=p),"quantitative"!==c&&l.isCountingAggregateOp(n)&&(m.warn(g.invalidFieldTypeForCountAggregate(c,n)),s.type="quantitative")}else if(!d.isSecondaryRangeChannel(t)){var h=function(e,t){if(e.timeUnit)return"temporal";if(f.isBinning(e.bin))return"quantitative";switch(d.rangeType(t)){case"continuous":default:return"quantitative";case"discrete":case"flexible":return"nominal"}}(s,t);m.warn(g.missingFieldType(t,h)),s.type=h}if(U(s)){var v=function(e,t){var n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:"Channel ".concat(t," should not be used with a geojson data.")};switch(t){case d.ROW:case d.COLUMN:case d.FACET:return Y(e)?{compatible:!1,warning:g.facetChannelShouldBeDiscrete(t)}:de;case d.X:case d.Y:case d.COLOR:case d.FILL:case d.STROKE:case d.TEXT:case d.DETAIL:case d.KEY:case d.TOOLTIP:case d.HREF:case d.URL:case d.ANGLE:case d.THETA:case d.RADIUS:case d.DESCRIPTION:return de;case d.LONGITUDE:case d.LONGITUDE2:case d.LATITUDE:case d.LATITUDE2:return n!==w.QUANTITATIVE?{compatible:!1,warning:"Channel ".concat(t," should be used with a quantitative field only, not ").concat(e.type," field.")}:de;case d.OPACITY:case d.FILLOPACITY:case d.STROKEOPACITY:case d.STROKEWIDTH:case d.SIZE:case d.THETA2:case d.RADIUS2:case d.X2:case d.Y2:return"nominal"!==n||e.sort?de:{compatible:!1,warning:"Channel ".concat(t," should not be used with an unsorted discrete field.")};case d.STROKEDASH:return A.contains(["ordinal","nominal"],e.type)?de:{compatible:!1,warning:"StrokeDash channel should be used with only discrete data."};case d.SHAPE:return A.contains(["ordinal","nominal","geojson"],e.type)?de:{compatible:!1,warning:"Shape channel should be used with only either discrete or geojson data."};case d.ORDER:return"nominal"!==e.type||"sort"in e?de:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(s,t),y=v.compatible,E=v.warning;y||m.warn(E)}if(T(s)&&i.default(s.sort)){var C=s.sort;if(x.isSortByChannel(C))return Object.assign(Object.assign({},s),{sort:{encoding:C}});var S=C.substr(1);if("-"===C.charAt(0)&&x.isSortByChannel(S))return Object.assign(Object.assign({},s),{sort:{encoding:S,order:"descending"}})}if(b.isFacetFieldDef(s)){var N=s.header,D=N.orient,F=a.__rest(N,["orient"]);if(D)return Object.assign(Object.assign({},s),{header:Object.assign(Object.assign({},F),{labelOrient:N.labelOrient||D,titleOrient:N.titleOrient||D})})}return s}function fe(e,t){return c.default(e)?{maxbins:f.autoMaxBins(t)}:"binned"===e?{binned:!0}:e.maxbins||e.step?e:Object.assign(Object.assign({},e),{maxbins:f.autoMaxBins(t)})}var de={compatible:!0};function pe(e){var t,n=ie(e).formatType;return"time"===n||!n&&((t=e)&&("temporal"===t.type||M(t)&&!!t.timeUnit))}function he(e,t){var n,a,o=t.timeUnit,s=t.type,c=t.wrapTime,l=t.undefinedIfExprNotRequired,f=o&&(null===(n=k.normalizeTimeUnit(o))||void 0===n?void 0:n.unit),d=f||"temporal"===s;return E.isSignalRef(e)?a=e.signal:v.isDateTime(e)?(d=!0,a=v.dateTimeToExpr(e)):(i.default(e)||u.default(e))&&d&&(a="datetime(".concat(JSON.stringify(e),")"),k.isLocalSingleTimeUnit(f)&&(u.default(e)&&e<1e4||i.default(e)&&isNaN(Date.parse(e)))&&(a=v.dateTimeToExpr(r.default({},f,e)))),a?c&&d?"time(".concat(a,")"):a:l?void 0:JSON.stringify(e)}function ve(e,t){var n=e.type;return t.map((function(t){var r=he(t,{timeUnit:M(e)?e.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:t}))}function ge(e,t){return f.isBinning(e.bin)?d.isScaleChannel(t)&&A.contains(["ordinal","nominal"],e.type):(console.warn("Only call this method for binned field defs."),!1)}})),s.register("6jZCp",(function(e,t){n(e.exports,"MULTIDOMAIN_SORT_OP_INDEX",(function(){return u})),n(e.exports,"isArgminDef",(function(){return c})),n(e.exports,"isArgmaxDef",(function(){return l})),n(e.exports,"isAggregateOp",(function(){return f})),n(e.exports,"isCountingAggregateOp",(function(){return p})),n(e.exports,"isMinMaxOp",(function(){return h})),n(e.exports,"SUM_OPS",(function(){return v})),n(e.exports,"SHARED_DOMAIN_OP_INDEX",(function(){return g})),s("iSlfb");var r=s("fCSiB"),a=s("6D24N"),i=s("lSb9O"),o={argmax:1,argmin:1,average:1,count:1,distinct:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},u={count:1,min:1,max:1};function c(e){return!!e&&!!e.argmin}function l(e){return!!e&&!!e.argmax}i.keys(o);function f(e){return r.default(e)&&!!o[e]}var d=["count","valid","missing","distinct"];function p(e){return r.default(e)&&i.contains(d,e)}function h(e){return r.default(e)&&i.contains(["min","max"],e)}var v=["count","sum","distinct","valid","missing"],g=a.default(["mean","average","median","q1","q3","min","max"])})),s.register("61RXI",(function(e,t){n(e.exports,"binToString",(function(){return c})),n(e.exports,"isSelectionExtent",(function(){return p})),n(e.exports,"isBinning",(function(){return l})),n(e.exports,"isBinParams",(function(){return d})),n(e.exports,"isBinned",(function(){return f})),n(e.exports,"autoMaxBins",(function(){return h})),s("iSlfb");var r=s("iRIM1"),a=s("bZ6XL"),i=s("e3OyN"),o=s("iooJ7"),u=s("lSb9O");function c(e){return r.default(e)&&(e=o.normalizeBin(e,void 0)),"bin"+u.keys(e).map((function(t){return p(e[t])?u.varName("_".concat(t,"_").concat(Object.entries(e[t]))):u.varName("_".concat(t,"_").concat(e[t]))})).join("")}function l(e){return!0===e||d(e)&&!e.binned}function f(e){return"binned"===e||d(e)&&!0===e.binned}function d(e){return a.default(e)}function p(e){return null==e?void 0:e.selection}function h(e){switch(e){case i.ROW:case i.COLUMN:case i.SIZE:case i.COLOR:case i.FILL:case i.STROKE:case i.STROKEWIDTH:case i.OPACITY:case i.FILLOPACITY:case i.STROKEOPACITY:case i.SHAPE:return 6;case i.STROKEDASH:return 4;default:return 10}}})),s.register("e3OyN",(function(e,t){n(e.exports,"ROW",(function(){return i})),n(e.exports,"COLUMN",(function(){return o})),n(e.exports,"FACET",(function(){return u})),n(e.exports,"X",(function(){return c})),n(e.exports,"Y",(function(){return l})),n(e.exports,"X2",(function(){return f})),n(e.exports,"Y2",(function(){return d})),n(e.exports,"RADIUS",(function(){return p})),n(e.exports,"RADIUS2",(function(){return h})),n(e.exports,"THETA",(function(){return v})),n(e.exports,"THETA2",(function(){return g})),n(e.exports,"LATITUDE",(function(){return m})),n(e.exports,"LONGITUDE",(function(){return y})),n(e.exports,"LATITUDE2",(function(){return x})),n(e.exports,"LONGITUDE2",(function(){return b})),n(e.exports,"COLOR",(function(){return k})),n(e.exports,"FILL",(function(){return w})),n(e.exports,"STROKE",(function(){return A})),n(e.exports,"SHAPE",(function(){return E})),n(e.exports,"SIZE",(function(){return C})),n(e.exports,"ANGLE",(function(){return S})),n(e.exports,"OPACITY",(function(){return N})),n(e.exports,"FILLOPACITY",(function(){return T})),n(e.exports,"STROKEOPACITY",(function(){return D})),n(e.exports,"STROKEWIDTH",(function(){return F})),n(e.exports,"STROKEDASH",(function(){return O})),n(e.exports,"TEXT",(function(){return _})),n(e.exports,"ORDER",(function(){return I})),n(e.exports,"DETAIL",(function(){return R})),n(e.exports,"KEY",(function(){return M})),n(e.exports,"TOOLTIP",(function(){return B})),n(e.exports,"HREF",(function(){return P})),n(e.exports,"URL",(function(){return L})),n(e.exports,"DESCRIPTION",(function(){return j})),n(e.exports,"isPolarPositionChannel",(function(){return U})),n(e.exports,"getPositionChannelFromLatLong",(function(){return W})),n(e.exports,"isGeoPositionChannel",(function(){return G})),n(e.exports,"GEOPOSITION_CHANNELS",(function(){return H})),n(e.exports,"isColorChannel",(function(){return J})),n(e.exports,"FACET_CHANNELS",(function(){return X})),n(e.exports,"CHANNELS",(function(){return Q})),n(e.exports,"isSingleDefUnitChannel",(function(){return ee})),n(e.exports,"isChannel",(function(){return te})),n(e.exports,"SECONDARY_RANGE_CHANNEL",(function(){return ne})),n(e.exports,"isSecondaryRangeChannel",(function(){return re})),n(e.exports,"getMainRangeChannel",(function(){return ae})),n(e.exports,"getVgPositionChannel",(function(){return ie})),n(e.exports,"getSecondaryRangeChannel",(function(){return oe})),n(e.exports,"getSizeChannel",(function(){return ue})),n(e.exports,"getOffsetChannel",(function(){return se})),n(e.exports,"NONPOSITION_CHANNELS",(function(){return le})),n(e.exports,"POSITION_SCALE_CHANNEL_INDEX",(function(){return fe})),n(e.exports,"POSITION_SCALE_CHANNELS",(function(){return de})),n(e.exports,"isXorY",(function(){return pe})),n(e.exports,"POLAR_POSITION_SCALE_CHANNEL_INDEX",(function(){return he})),n(e.exports,"POLAR_POSITION_SCALE_CHANNELS",(function(){return ve})),n(e.exports,"getPositionScaleChannel",(function(){return ge})),n(e.exports,"NONPOSITION_SCALE_CHANNELS",(function(){return ye})),n(e.exports,"isNonPositionScaleChannel",(function(){return xe})),n(e.exports,"supportLegend",(function(){return be})),n(e.exports,"SCALE_CHANNELS",(function(){return we})),n(e.exports,"isScaleChannel",(function(){return Ae})),n(e.exports,"supportMark",(function(){return Ee})),n(e.exports,"rangeType",(function(){return Ne}));var r=s("2lx0N"),a=s("lSb9O"),i="row",o="column",u="facet",c="x",l="y",f="x2",d="y2",p="radius",h="radius2",v="theta",g="theta2",m="latitude",y="longitude",x="latitude2",b="longitude2",k="color",w="fill",A="stroke",E="shape",C="size",S="angle",N="opacity",T="fillOpacity",D="strokeOpacity",F="strokeWidth",O="strokeDash",_="text",I="order",R="detail",M="key",B="tooltip",P="href",L="url",j="description",z={theta:1,theta2:1,radius:1,radius2:1};function U(e){return e in z}var V={longitude:1,longitude2:1,latitude:1,latitude2:1};function W(e){switch(e){case m:return"y";case x:return"y2";case y:return"x";case b:return"x2"}}function G(e){return e in V}var H=a.keys(V),q=Object.assign(Object.assign(Object.assign(Object.assign({},{x:1,y:1,x2:1,y2:1}),z),V),{color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1});function J(e){return e===k||e===w||e===A}var K={row:1,column:1,facet:1},X=a.keys(K),Y=Object.assign(Object.assign({},q),K),Q=a.keys(Y),Z=(Y.order,Y.detail,Y.tooltip,r.__rest(Y,["order","detail","tooltip"])),$=(Z.row,Z.column,Z.facet,r.__rest(Z,["row","column","facet"]));a.keys(Z),a.keys($);function ee(e){return!!$[e]}function te(e){return!!Y[e]}var ne=[f,d,x,b,g,h];function re(e){return ae(e)!==e}function ae(e){switch(e){case f:return c;case d:return l;case x:return m;case b:return y;case g:return v;case h:return p}return e}function ie(e){if(U(e))switch(e){case v:return"startAngle";case g:return"endAngle";case p:return"outerRadius";case h:return"innerRadius"}return e}function oe(e){switch(e){case c:return f;case l:return d;case m:return x;case y:return b;case v:return g;case p:return h}}function ue(e){switch(e){case c:case f:return"width";case l:case d:return"height"}}function se(e){switch(e){case c:return"xOffset";case l:return"yOffset";case f:return"x2Offset";case d:return"y2Offset";case v:return"thetaOffset";case p:return"radiusOffset";case g:return"theta2Offset";case h:return"radius2Offset"}}a.keys(q),q.x,q.y,q.x2,q.y2,q.latitude,q.longitude,q.latitude2,q.longitude2,q.theta,q.theta2,q.radius,q.radius2;var ce=r.__rest(q,["x","y","x2","y2","latitude","longitude","latitude2","longitude2","theta","theta2","radius","radius2"]),le=a.keys(ce),fe={x:1,y:1},de=a.keys(fe);function pe(e){return e in fe}var he={theta:1,radius:1},ve=a.keys(he);function ge(e){return"width"===e?c:l}ce.text,ce.tooltip,ce.href,ce.url,ce.description,ce.detail,ce.key,ce.order;var me=r.__rest(ce,["text","tooltip","href","url","description","detail","key","order"]),ye=a.keys(me);function xe(e){return!!ce[e]}function be(e){switch(e){case k:case w:case A:case C:case E:case N:case F:case O:return!0;case T:case D:case S:return!1}}var ke=Object.assign(Object.assign(Object.assign({},fe),he),me),we=a.keys(ke);function Ae(e){return!!ke[e]}function Ee(e,t){return function(e){switch(e){case k:case w:case A:case j:case R:case M:case B:case P:case I:case N:case T:case D:case F:case u:case i:case o:return Ce;case c:case l:case m:case y:return Se;case f:case d:case x:case b:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case C:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case O:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case E:return{point:"always",geoshape:"always"};case _:return{text:"always"};case S:return{point:"always",square:"always",text:"always"};case L:return{image:"always"};case v:case p:return{text:"always",arc:"always"};case g:case h:return{arc:"always"}}}(e)[t]}var Ce={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},Se=r.__rest(Ce,["geoshape"]);function Ne(e){switch(e){case c:case l:case v:case p:case C:case S:case F:case N:case T:case D:case f:case d:case g:case h:return;case u:case i:case o:case E:case O:case _:case B:case P:case L:case j:return"discrete";case k:case w:case A:return"flexible";case m:case y:case x:case b:case R:case M:case I:return}}})),s.register("ixH3E",(function(e,t){n(e.exports,"isCustomFormatType",(function(){return p})),n(e.exports,"formatSignalRef",(function(){return v})),n(e.exports,"formatCustomType",(function(){return m})),n(e.exports,"binFormatExpression",(function(){return A})),n(e.exports,"guideFormat",(function(){return y})),n(e.exports,"guideFormatType",(function(){return x})),s("iSlfb");var r=s("fCSiB"),a=s("61RXI"),i=s("iooJ7"),o=s("ceGn0"),u=s("7J7Lf"),c=s("gQOdy"),l=s("4jgmF"),f=s("7T458"),d=s("5PVWc");function p(e){return e&&"number"!==e&&"time"!==e}function h(e,t,n){return"".concat(e,"(").concat(t).concat(n?", ".concat(JSON.stringify(n)):"",")")}function v(e){var t,n,o=e.fieldOrDatumDef,s=e.format,l=e.formatType,f=e.expr,d=e.normalizeStack,h=e.config;if(p(l))return m({fieldOrDatumDef:o,format:s,formatType:l,expr:f,config:h});var v=g(o,f,d);if(i.isFieldOrDatumDefForTimeFormat(o)){var y=function(e,t,n,a,i){return!t||n?(n=r.default(n)?n:a,"".concat(i?"utc":"time","Format(").concat(e,", '").concat(n,"')")):c.formatExpression(t,e,i)}(v,i.isFieldDef(o)?null===(t=c.normalizeTimeUnit(o.timeUnit))||void 0===t?void 0:t.unit:void 0,s,h.timeFormat,i.isScaleFieldDef(o)&&(null===(n=o.scale)||void 0===n?void 0:n.type)===u.ScaleType.UTC);return y?{signal:y}:void 0}return s=b(i.channelDefType(o),s,h),i.isFieldDef(o)&&a.isBinning(o.bin)?{signal:A(v,i.vgField(o,{expr:f,binSuffix:"end"}),s,l,h)}:s||"quantitative"===i.channelDefType(o)?{signal:"".concat(k(v,s))}:{signal:"isValid(".concat(v,") ? ").concat(v,' : ""+').concat(v)}}function g(e,t,n){return i.isFieldDef(e)?n?"".concat(i.vgField(e,{expr:t,suffix:"end"}),"-").concat(i.vgField(e,{expr:t,suffix:"start"})):i.vgField(e,{expr:t}):d.datumDefToExpr(e)}function m(e){var t=e.fieldOrDatumDef,n=e.format,r=e.formatType,o=e.expr,u=e.normalizeStack,s=e.config,c=e.field;return c=null!=c?c:g(t,o,u),i.isFieldDef(t)&&a.isBinning(t.bin)?{signal:A(c,i.vgField(t,{expr:o,binSuffix:"end"}),n,r,s)}:{signal:h(r,c,n)}}function y(e,t,n,r,a,o){var u;if(!p(r))return i.isFieldOrDatumDefForTimeFormat(e)?function(e,t,n,r){return e||(t?{signal:c.timeUnitSpecifierExpression(t)}:r?void 0:n.timeFormat)}(n,i.isFieldDef(e)?null===(u=c.normalizeTimeUnit(e.timeUnit))||void 0===u?void 0:u.unit:void 0,a,o):b(t,n,a)}function x(e,t,n){return e&&(f.isSignalRef(e)||"number"===e||"time"===e)?e:i.isFieldOrDatumDefForTimeFormat(t)&&"time"!==n&&"utc"!==n?"time":void 0}function b(e,t,n){return r.default(t)?t:e===l.QUANTITATIVE?n.numberFormat:void 0}function k(e,t){return"format(".concat(e,', "').concat(t||"",'")')}function w(e,t,n,a){var i;return p(n)?h(n,e,t):k(e,null!==(i=r.default(t)?t:void 0)&&void 0!==i?i:a.numberFormat)}function A(e,t,n,r,a){var i=w(e,n,r,a),u=w(t,n,r,a);return"".concat(o.fieldValidPredicate(e,!1),' ? "null" : ').concat(i,' + "').concat("  ",'" + ').concat(u)}})),s.register("ceGn0",(function(e,t){n(e.exports,"isSelectionPredicate",(function(){return u})),n(e.exports,"isFieldEqualPredicate",(function(){return c})),n(e.exports,"isFieldRangePredicate",(function(){return h})),n(e.exports,"isFieldOneOfPredicate",(function(){return v})),n(e.exports,"isFieldPredicate",(function(){return m})),n(e.exports,"fieldFilterExpression",(function(){return b})),n(e.exports,"fieldValidPredicate",(function(){return k})),n(e.exports,"normalizePredicate",(function(){return w})),s("iSlfb");var r=s("4ujSI"),a=s("iooJ7"),i=s("gQOdy"),o=s("7T458");function u(e){return null==e?void 0:e.selection}function c(e){return e&&!!e.field&&void 0!==e.equal}function l(e){return e&&!!e.field&&void 0!==e.lt}function f(e){return e&&!!e.field&&void 0!==e.lte}function d(e){return e&&!!e.field&&void 0!==e.gt}function p(e){return e&&!!e.field&&void 0!==e.gte}function h(e){if(e&&e.field){if(r.default(e.range)&&2===e.range.length)return!0;if(o.isSignalRef(e.range))return!0}return!1}function v(e){return e&&!!e.field&&(r.default(e.oneOf)||r.default(e.in))}function g(e){return e&&!!e.field&&void 0!==e.valid}function m(e){return v(e)||c(e)||h(e)||l(e)||d(e)||f(e)||p(e)}function y(e,t){return a.valueExpr(e,{timeUnit:t,wrapTime:!0})}function x(e,t){return e.map((function(e){return y(e,t)}))}function b(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.field,u=null===(t=i.normalizeTimeUnit(e.timeUnit))||void 0===t?void 0:t.unit,s=u?"time("+i.fieldExpr(u,r)+")":a.vgField(e,{expr:"datum"});if(c(e))return s+"==="+y(e.equal,u);if(l(e)){var m=e.lt;return"".concat(s,"<").concat(y(m,u))}if(d(e)){var b=e.gt;return"".concat(s,">").concat(y(b,u))}if(f(e)){var w=e.lte;return"".concat(s,"<=").concat(y(w,u))}if(p(e)){var A=e.gte;return"".concat(s,">=").concat(y(A,u))}if(v(e))return"indexof([".concat(x(e.oneOf,u).join(","),"], ").concat(s,") !== -1");if(g(e))return k(s,e.valid);if(h(e)){var E=e.range,C=o.isSignalRef(E)?{signal:"".concat(E.signal,"[0]")}:E[0],S=o.isSignalRef(E)?{signal:"".concat(E.signal,"[1]")}:E[1];if(null!==C&&null!==S&&n)return"inrange("+s+", ["+y(C,u)+", "+y(S,u)+"])";var N=[];return null!==C&&N.push("".concat(s," >= ").concat(y(C,u))),null!==S&&N.push("".concat(s," <= ").concat(y(S,u))),N.length>0?N.join(" && "):"true"}throw new Error("Invalid field predicate: ".concat(JSON.stringify(e)))}function k(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t?"isValid(".concat(e,") && isFinite(+").concat(e,")"):"!isValid(".concat(e,") || !isFinite(+").concat(e,")")}function w(e){var t;return m(e)&&e.timeUnit?Object.assign(Object.assign({},e),{timeUnit:null===(t=i.normalizeTimeUnit(e.timeUnit))||void 0===t?void 0:t.unit}):e}})),s.register("gQOdy",(function(e,r){n(e.exports,"TIMEUNIT_PARTS",(function(){return d})),n(e.exports,"isLocalSingleTimeUnit",(function(){return p})),n(e.exports,"getTimeUnitParts",(function(){return g})),n(e.exports,"fieldExpr",(function(){return y})),n(e.exports,"timeUnitSpecifierExpression",(function(){return x})),n(e.exports,"formatExpression",(function(){return b})),n(e.exports,"normalizeTimeUnit",(function(){return k})),n(e.exports,"timeUnitToString",(function(){return w}));var a=s("2lx0N"),i=s("hSVs3");s("iSlfb");var o=s("fCSiB"),u=s("bZ6XL"),c=s("ggS1y"),l=s("lSb9O"),f={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},d=l.keys(f);function p(e){return!!f[e]}function h(e){return e.startsWith("utc")}var v={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function g(e){var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=d[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;m(e,u)&&t.push(u)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}function m(e,t){var n=e.indexOf(t);return!(n<0)&&(!(n>0&&"seconds"===t&&"i"===e.charAt(n-1))&&(!(e.length>n+3&&"day"===t&&"o"===e.charAt(n+3))&&!(n>0&&"year"===t&&"f"===e.charAt(n-1))))}function y(e,t){var n,r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{end:!1}).end,a=l.accessPathWithDatum(t),i=h(e)?"utc":"";function o(e){return"quarter"===e?"(".concat(i,"quarter(").concat(a,")-1)"):"".concat(i).concat(e,"(").concat(a,")")}var u={},s=!0,f=!1,p=void 0;try{for(var v,g=d[Symbol.iterator]();!(s=(v=g.next()).done);s=!0){var y=v.value;m(e,y)&&(u[y]=o(y),n=y)}}catch(e){f=!0,p=e}finally{try{s||null==g.return||g.return()}finally{if(f)throw p}}return r&&(u[n]+="+1"),c.dateTimeExprToExpr(u)}function x(e){if(e){var n=g(e);return"timeUnitSpecifier(".concat(t(i)(n),", ").concat(t(i)(v),")")}}function b(e,t,n){if(e){var r=x(e),a=n||h(e);return"".concat(a?"utc":"time","Format(").concat(t,", ").concat(r,")")}}function k(e){var t;if(e)return o.default(e)?t={unit:e}:u.default(e)&&(t=Object.assign(Object.assign({},e),e.unit?{unit:e.unit}:{})),h(t.unit)&&(t.utc=!0,t.unit=t.unit.substr(3)),t}function w(e){var t=k(e),n=t.utc,r=a.__rest(t,["utc"]);return r.unit?(n?"utc":"")+l.keys(r).map((function(e){return l.varName("".concat("unit"===e?"":"_".concat(e,"_")).concat(r[e]))})).join(""):(n?"utc":"")+"timeunit"+l.keys(r).map((function(e){return l.varName("_".concat(e,"_").concat(r[e]))})).join("")}})),s.register("ggS1y",(function(e,t){n(e.exports,"isDateTime",(function(){return d})),n(e.exports,"dateTimeToExpr",(function(){return y})),n(e.exports,"dateTimeExprToExpr",(function(){return x})),n(e.exports,"dateTimeToTimestamp",(function(){return b})),s("1i51P");var r=s("9M1dW"),a=s("9DJxQ");s("iSlfb");var i=s("bZ6XL"),o=s("8AF0b"),u=s("16rNM"),c=s("2x4HI"),l=s("gQOdy"),f=s("lSb9O");function d(e){var t=!0,n=!1,r=void 0;if(e&&i.default(e))try{for(var a,o=l.TIMEUNIT_PARTS[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){if(a.value in e)return!0}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}return!1}var p=["january","february","march","april","may","june","july","august","september","october","november","december"],h=p.map((function(e){return e.substr(0,3)})),v=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],g=v.map((function(e){return e.substr(0,3)}));function m(e,t){var n=[];if(t&&void 0!==e.day&&f.keys(e).length>1&&(u.warn(c.droppedDay(e)),delete(e=f.duplicate(e)).day),void 0!==e.year?n.push(e.year):n.push(2012),void 0!==e.month){var r=t?function(e){if(f.isNumeric(e)&&(e=+e),o.default(e))return e-1;var t=e.toLowerCase(),n=p.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=h.indexOf(r);if(-1!==a)return a;throw new Error(c.invalidTimeUnit("month",e))}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){var a=t?function(e){if(f.isNumeric(e)&&(e=+e),o.default(e))return e>4&&u.warn(c.invalidTimeUnit("quarter",e)),e-1;throw new Error(c.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(o.default(a)?3*a:a+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){var i=t?function(e){if(f.isNumeric(e)&&(e=+e),o.default(e))return e%7;var t=e.toLowerCase(),n=v.indexOf(t);if(-1!==n)return n;var r=t.substr(0,3),a=g.indexOf(r);if(-1!==a)return a;throw new Error(c.invalidTimeUnit("day",e))}(e.day):e.day;n.push(o.default(i)?i+1:i+"+1")}else n.push(1);var s=!0,l=!1,d=void 0;try{for(var m,y=["hours","minutes","seconds","milliseconds"][Symbol.iterator]();!(s=(m=y.next()).done);s=!0){var x=e[m.value];n.push(void 0===x?0:x)}}catch(e){l=!0,d=e}finally{try{s||null==y.return||y.return()}finally{if(l)throw d}}return n}function y(e){var t=m(e,!0).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function x(e){var t=m(e,!1).join(", ");return e.utc?"utc(".concat(t,")"):"datetime(".concat(t,")")}function b(e){var t,n=m(e,!0);return e.utc?+new Date((t=Date).UTC.apply(t,r.default(n))):+a.default(Date,r.default(n))}})),s.register("16rNM",(function(e,t){n(e.exports,"warn",(function(){return l})),n(e.exports,"debug",(function(){return f})),n(e.exports,"reset",(function(){return c})),n(e.exports,"set",(function(){return u})),n(e.exports,"message",(function(){return s("2x4HI")})),s("1i51P");s("3QOYJ"),s("2tuUj");var r=s("9M1dW");s("iSlfb");var a=s("i2vcq"),i=(s("2x4HI"),a.default(a.Warn)),o=i;function u(e){return o=e}function c(){return o=i}function l(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a;(a=o).warn.apply(a,r.default(t))}function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a;(a=o).debug.apply(a,r.default(t))}})),s.register("2x4HI",(function(e,t){n(e.exports,"invalidSpec",(function(){return i})),n(e.exports,"FIT_NON_SINGLE",(function(){return o})),n(e.exports,"containerSizeNonSingle",(function(){return u})),n(e.exports,"containerSizeNotCompatibleWithAutosize",(function(){return c})),n(e.exports,"droppingFit",(function(){return l})),n(e.exports,"cannotProjectOnChannelWithoutField",(function(){return f})),n(e.exports,"cannotProjectAggregate",(function(){return d})),n(e.exports,"nearestNotSupportForContinuous",(function(){return p})),n(e.exports,"selectionNotSupported",(function(){return h})),n(e.exports,"selectionNotFound",(function(){return v})),n(e.exports,"SCALE_BINDINGS_CONTINUOUS",(function(){return g})),n(e.exports,"LEGEND_BINDINGS_PROJECT_LENGTH",(function(){return m})),n(e.exports,"noSameUnitLookup",(function(){return y})),n(e.exports,"noSuchRepeatedValue",(function(){return x})),n(e.exports,"columnsNotSupportByRowCol",(function(){return b})),n(e.exports,"CONCAT_CANNOT_SHARE_AXIS",(function(){return k})),n(e.exports,"unrecognizedParse",(function(){return w})),n(e.exports,"differentParse",(function(){return A})),n(e.exports,"invalidTransformIgnored",(function(){return E})),n(e.exports,"NO_FIELDS_NEEDS_AS",(function(){return C})),n(e.exports,"customFormatTypeNotAllowed",(function(){return S})),n(e.exports,"encodingOverridden",(function(){return N})),n(e.exports,"projectionOverridden",(function(){return T})),n(e.exports,"REPLACE_ANGLE_WITH_THETA",(function(){return D})),n(e.exports,"primitiveChannelDef",(function(){return F})),n(e.exports,"invalidFieldType",(function(){return O})),n(e.exports,"invalidFieldTypeForCountAggregate",(function(){return _})),n(e.exports,"invalidAggregate",(function(){return I})),n(e.exports,"missingFieldType",(function(){return R})),n(e.exports,"droppingColor",(function(){return M})),n(e.exports,"emptyFieldDef",(function(){return B})),n(e.exports,"latLongDeprecated",(function(){return P})),n(e.exports,"LINE_WITH_VARYING_SIZE",(function(){return L})),n(e.exports,"incompatibleChannel",(function(){return j})),n(e.exports,"invalidEncodingChannel",(function(){return z})),n(e.exports,"facetChannelShouldBeDiscrete",(function(){return U})),n(e.exports,"facetChannelDropped",(function(){return V})),n(e.exports,"discreteChannelCannotEncode",(function(){return W})),n(e.exports,"lineWithRange",(function(){return G})),n(e.exports,"orientOverridden",(function(){return H})),n(e.exports,"CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN",(function(){return q})),n(e.exports,"RANGE_STEP_DEPRECATED",(function(){return J})),n(e.exports,"cannotUseScalePropertyWithNonColor",(function(){return K})),n(e.exports,"unaggregateDomainHasNoEffectForRawField",(function(){return X})),n(e.exports,"unaggregateDomainWithNonSharedDomainOp",(function(){return Y})),n(e.exports,"unaggregatedDomainWithLogScale",(function(){return Q})),n(e.exports,"cannotApplySizeToNonOrientedMark",(function(){return Z})),n(e.exports,"scaleTypeNotWorkWithChannel",(function(){return $})),n(e.exports,"scaleTypeNotWorkWithFieldDef",(function(){return ee})),n(e.exports,"scalePropertyNotWorkWithScaleType",(function(){return te})),n(e.exports,"scaleTypeNotWorkWithMark",(function(){return ne})),n(e.exports,"stepDropped",(function(){return re})),n(e.exports,"mergeConflictingProperty",(function(){return ae})),n(e.exports,"mergeConflictingDomainProperty",(function(){return ie})),n(e.exports,"independentScaleMeansIndependentGuide",(function(){return oe})),n(e.exports,"domainSortDropped",(function(){return ue})),n(e.exports,"MORE_THAN_ONE_SORT",(function(){return se})),n(e.exports,"FACETED_INDEPENDENT_DIFFERENT_SOURCES",(function(){return ce})),n(e.exports,"FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES",(function(){return le})),n(e.exports,"FACETED_INDEPENDENT_SAME_SOURCE",(function(){return fe})),n(e.exports,"INVALID_CHANNEL_FOR_AXIS",(function(){return de})),n(e.exports,"cannotStackRangedMark",(function(){return pe})),n(e.exports,"cannotStackNonLinearScale",(function(){return he})),n(e.exports,"stackNonSummativeAggregate",(function(){return ve})),n(e.exports,"invalidTimeUnit",(function(){return ge})),n(e.exports,"droppedDay",(function(){return me})),n(e.exports,"errorBarCenterAndExtentAreNotNeeded",(function(){return ye})),n(e.exports,"errorBarCenterIsUsedWithWrongExtent",(function(){return xe})),n(e.exports,"errorBarContinuousAxisHasCustomizedAggregate",(function(){return be})),n(e.exports,"errorBarCenterIsNotNeeded",(function(){return ke})),n(e.exports,"errorBand1DNotSupport",(function(){return we})),n(e.exports,"channelRequiredForBinned",(function(){return Ae})),n(e.exports,"domainRequiredForThresholdScale",(function(){return Ee}));var r=s("e3OyN"),a=s("lSb9O");function i(e){return"Invalid specification ".concat(JSON.stringify(e),'. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".')}var o='Autosize "fit" only works for single views and layered views.';function u(e){return"".concat("width"==e?"Width":"Height",' "container" only works for single views and layered views.')}function c(e){var t="width"==e?"x":"y";return"".concat("width"==e?"Width":"Height",' "container" only works well with autosize "fit" or "fit-').concat(t,'".')}function l(e){return e?'Dropping "fit-'.concat(e,'" because spec has discrete ').concat(r.getSizeChannel(e),"."):'Dropping "fit" because spec has discrete size.'}function f(e){return'Cannot project a selection on encoding channel "'.concat(e,'", which has no field.')}function d(e,t){return'Cannot project a selection on encoding channel "'.concat(e,'" as it uses an aggregate function ("').concat(t,'").')}function p(e){return'The "nearest" transform is not supported for '.concat(e," marks.")}function h(e){return"Selection not supported for ".concat(e," yet.")}function v(e){return'Cannot find a selection named "'.concat(e,'".')}var g="Scale bindings are currently only supported for scales with unbinned, continuous domains.",m="Legend bindings are only supported for selections over an individual field or encoding channel.";function y(e){return'Cannot define and lookup the "'.concat(e,'" selection in the same view. ')+"Try moving the lookup into a second, layered view?"}function x(e){return'Unknown repeated value "'.concat(e,'".')}function b(e){return'The "columns" property cannot be used when "'.concat(e,'" has nested row/column.')}var k="Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415).";function w(e){return'Unrecognized parse "'.concat(e,'".')}function A(e,t,n){return'An ancestor parsed field "'.concat(e,'" as ').concat(n," but a child wants to parse the field as ").concat(t,".")}function E(e){return"Ignoring an invalid transform: ".concat(a.stringify(e),".")}var C='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.';function S(e){return"Config.customFormatTypes is not true, thus custom format type and format for channel ".concat(e," are dropped.")}function N(e){return"Layer's shared ".concat(e.join(",")," channel ").concat(1===e.length?"is":"are"," overriden.")}function T(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection ".concat(a.stringify(t)," is overridden by a child projection ").concat(a.stringify(n),".")}var D="Arc marks uses theta channel rather than angle, replacing angle with theta.";function F(e,t,n){return"Channel ".concat(e," is a ").concat(t,". Converted to {value: ").concat(a.stringify(n),"}.")}function O(e){return'Invalid field type "'.concat(e,'".')}function _(e,t){return'Invalid field type "'.concat(e,'" for aggregate: "').concat(t,'", using "quantitative" instead.')}function I(e){return'Invalid aggregation operator "'.concat(e,'".')}function R(e,t){return'Missing type for channel "'.concat(e,'", using "').concat(t,'" instead.')}function M(e,t){var n=t.fill,r=t.stroke;return"Dropping color ".concat(e," as the plot also has ").concat(n&&r?"fill and stroke":n?"fill":"stroke",".")}function B(e,t){return"Dropping ".concat(a.stringify(e),' from channel "').concat(t,'" since it does not contain any data field, datum, value, or signal.')}function P(e,t,n){return"".concat(e,"-encoding with type ").concat(t," is deprecated. Replacing with ").concat(n,"-encoding.")}var L="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.";function j(e,t,n){return"".concat(e,' dropped as it is incompatible with "').concat(t,'"').concat(n?" when ".concat(n):"",".")}function z(e){return"".concat(e,"-encoding is dropped as ").concat(e," is not a valid encoding channel.")}function U(e){return"".concat(e," encoding should be discrete (ordinal / nominal / binned).")}function V(e){return"Facet encoding dropped as ".concat(e.join(" and ")," ").concat(e.length>1?"are":"is"," also specified.")}function W(e,t){return'Using discrete channel "'.concat(e,'" to encode "').concat(t,'" field can be misleading as it does not encode ').concat("ordinal"===t?"order":"magnitude",".")}function G(e,t){return"Line mark is for continuous lines and thus cannot be used with ".concat(e&&t?"x2 and y2":e?"x2":"y2",". We will use the rule mark (line segments) instead.")}function H(e,t){return'Specified orient "'.concat(e,'" overridden with "').concat(t,'".')}var q="Custom domain scale cannot be unioned with default field-based domain.",J='Scale\'s "rangeStep" is deprecated and will be removed in Vega-Lite 5.0. Please use "width"/"height": {"step": ...} instead. See https://vega.github.io/vega-lite/docs/size.html.';function K(e){return'Cannot use the scale property "'.concat(e,'" with non-color channel.')}function X(e){return"Using unaggregated domain with raw field has no effect (".concat(a.stringify(e),").")}function Y(e){return'Unaggregated domain not applicable for "'.concat(e,'" since it produces values outside the origin domain of the source data.')}function Q(e){return"Unaggregated domain is currently unsupported for log scale (".concat(a.stringify(e),").")}function Z(e){return'Cannot apply size to non-oriented mark "'.concat(e,'".')}function $(e,t,n){return'Channel "'.concat(e,'" does not work with "').concat(t,'" scale. We are using "').concat(n,'" scale instead.')}function ee(e,t){return'FieldDef does not work with "'.concat(e,'" scale. We are using "').concat(t,'" scale instead.')}function te(e,t,n){return"".concat(n,"-scale's \"").concat(t,'" is dropped as it does not work with ').concat(e," scale.")}function ne(e,t){return'Scale type "'.concat(t,'" does not work with mark "').concat(e,'".')}function re(e){return'The step for "'.concat(e,'" is dropped because the ').concat("width"===e?"x":"y"," is continuous.")}function ae(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(a.stringify(n)," and ").concat(a.stringify(r),"). Using ").concat(a.stringify(n),".")}function ie(e,t,n,r){return"Conflicting ".concat(t.toString(),' property "').concat(e.toString(),'" (').concat(a.stringify(n)," and ").concat(a.stringify(r),"). Using the union of the two domains.")}function oe(e){return'Setting the scale to be independent for "'.concat(e,'" means we also have to set the guide (axis or legend) to be independent.')}function ue(e){return"Dropping sort property ".concat(a.stringify(e),' as unioned domains only support boolean or op "count", "min", and "max".')}var se="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",ce="Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect.",le="Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect.",fe="Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.",de="Invalid channel for axis.";function pe(e){return'Cannot stack "'.concat(e,'" if there is already "').concat(e,'2".')}function he(e){return"Cannot stack non-linear scale (".concat(e,").")}function ve(e){return'Stacking is applied even though the aggregate function is non-summative ("'.concat(e,'").')}function ge(e,t){return"Invalid ".concat(e,": ").concat(a.stringify(t),".")}function me(e){return"Dropping day from datetime ".concat(a.stringify(e)," as day cannot be combined with other units.")}function ye(e,t){return"".concat(t?"extent ":"").concat(t&&e?"and ":"").concat(e?"center ":"").concat(t&&e?"are ":"is ","not needed when data are aggregated.")}function xe(e,t,n){return"".concat(e," is not usually used with ").concat(t," for ").concat(n,".")}function be(e,t){return"Continuous axis should not have customized aggregation function ".concat(e,"; ").concat(t," already agregates the axis.")}function ke(e,t){return"Center is not needed to be specified in ".concat(t," when extent is ").concat(e,".")}function we(e){return"1D error band does not support ".concat(e,".")}function Ae(e){return"Channel ".concat(e,' is required for "binned" bin.')}function Ee(e){return"Domain for ".concat(e," is required for threshold scale.")}})),s.register("7T458",(function(e,t){n(e.exports,"isSignalRef",(function(){return a})),n(e.exports,"isVgRangeStep",(function(){return i})),n(e.exports,"isDataRefUnionedDomain",(function(){return o})),n(e.exports,"isFieldRefUnionDomain",(function(){return u})),n(e.exports,"isDataRefDomain",(function(){return c})),n(e.exports,"VG_MARK_CONFIGS",(function(){return l})),n(e.exports,"VG_MARK_INDEX",(function(){return f})),n(e.exports,"VG_CORNERRADIUS_CHANNELS",(function(){return d})),s("iSlfb");var r=s("4ujSI");function a(e){return e&&!!e.signal}function i(e){return!!e.step}function o(e){return!r.default(e)&&("fields"in e&&!("data"in e))}function u(e){return!r.default(e)&&("fields"in e&&"data"in e)}function c(e){return!r.default(e)&&("field"in e&&"data"in e)}var l=s("lSb9O").keys({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1}),f={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},d=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"]})),s.register("7J7Lf",(function(e,t){n(e.exports,"ScaleType",(function(){return f})),n(e.exports,"scaleCompatible",(function(){return h})),n(e.exports,"scaleTypePrecedence",(function(){return g})),n(e.exports,"isQuantitative",(function(){return b})),n(e.exports,"hasDiscreteDomain",(function(){return C})),n(e.exports,"hasContinuousDomain",(function(){return S})),n(e.exports,"isContinuousToContinuous",(function(){return N})),n(e.exports,"isContinuousToDiscrete",(function(){return T})),n(e.exports,"defaultScaleConfig",(function(){return D})),n(e.exports,"isExtendedScheme",(function(){return F})),n(e.exports,"isSelectionDomain",(function(){return O})),n(e.exports,"isDomainUnionWith",(function(){return _})),n(e.exports,"NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES",(function(){return M})),n(e.exports,"scaleTypeSupportProperty",(function(){return B})),n(e.exports,"channelScalePropertyIncompatability",(function(){return P})),n(e.exports,"scaleTypeSupportDataType",(function(){return L})),n(e.exports,"channelSupportScaleType",(function(){return j}));var r=s("2lx0N");s("iSlfb");var a=s("6D24N"),i=s("fCSiB"),o=s("e3OyN");o=s("e3OyN");s("16rNM");var u=s("2x4HI"),c=s("4jgmF"),l=s("lSb9O"),f={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},d={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"},p=l.keys(d);function h(e,t){var n=d[e],r=d[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}var v={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function g(e){return v[e]}var m=["linear","log","pow","sqrt","symlog","time","utc"],y=a.default(m),x=a.default(["linear","log","pow","sqrt","symlog"]);function b(e){return e in x}var k=a.default(["quantile","quantize","threshold"]),w=m.concat(["quantile","quantize","threshold","sequential","identity"]),A=a.default(w),E=a.default(["ordinal","bin-ordinal","point","band"]);function C(e){return e in E}function S(e){return e in A}function N(e){return e in y}function T(e){return e in k}var D={pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4};function F(e){return!i.default(e)&&!!e.name}function O(e){return null==e?void 0:e.selection}function _(e){return e&&e.unionWith}var I={type:1,domain:1,domainMid:1,align:1,range:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},R=(l.keys(I),r.__rest(I,["type","domain","range","scheme"])),M=l.keys(R);!function(){var e,t={},n=!0,r=!1,a=void 0;try{for(var i,u=o.CHANNELS[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var s=i.value,l=!0,f=!1,d=void 0,h=!0,v=!1,g=void 0;try{for(var m,y=c.TYPES[Symbol.iterator]();!(h=(m=y.next()).done);h=!0){var x=m.value;try{for(var b,k=p[Symbol.iterator]();!(l=(b=k.next()).done);l=!0){var w=b.value,A=z(s,x);j(s,w)&&L(w,x)&&(t[A]=null!==(e=t[A])&&void 0!==e?e:[],t[A].push(w))}}catch(e){f=!0,d=e}finally{try{l||null==k.return||k.return()}finally{if(f)throw d}}}}catch(e){v=!0,g=e}finally{try{h||null==y.return||y.return()}finally{if(v)throw g}}}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}}();function B(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!l.contains(["point","band","identity"],e);case"bins":return!l.contains(["point","band","identity","ordinal"],e);case"round":return N(e)||"band"===e||"point"===e;case"padding":return N(e)||l.contains(["point","band"],e);case"paddingOuter":case"align":return l.contains(["point","band"],e);case"paddingInner":return"band"===e;case"domainMid":case"clamp":return N(e);case"nice":return N(e)||"quantize"===e||"threshold"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"constant":return"symlog"===e;case"zero":return S(e)&&!l.contains(["log","time","utc","threshold","quantile"],e)}}function P(e,t){switch(t){case"interpolate":case"scheme":case"domainMid":return o.isColorChannel(e)?void 0:u.cannotUseScalePropertyWithNonColor(e);case"align":case"type":case"bins":case"domain":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"reverse":case"round":case"clamp":case"zero":return}}function L(e,t){return l.contains([c.ORDINAL,c.NOMINAL],t)?void 0===e||C(e):t===c.TEMPORAL?l.contains([f.TIME,f.UTC,void 0],e):t!==c.QUANTITATIVE||l.contains([f.LOG,f.POW,f.SQRT,f.SYMLOG,f.QUANTILE,f.QUANTIZE,f.THRESHOLD,f.LINEAR,void 0],e)}function j(e,t){if(!o.isScaleChannel(e))return!1;switch(e){case o.X:case o.Y:case o.THETA:case o.RADIUS:return N(t)||l.contains(["band","point"],t);case o.SIZE:case o.STROKEWIDTH:case o.OPACITY:case o.FILLOPACITY:case o.STROKEOPACITY:case o.ANGLE:return N(t)||T(t)||l.contains(["band","point","ordinal"],t);case o.COLOR:case o.FILL:case o.STROKE:return"band"!==t;case o.STROKEDASH:return"ordinal"===t||T(t);case o.SHAPE:return"ordinal"===t}}function z(e,t){return e+"_"+t}})),s.register("4jgmF",(function(e,t){n(e.exports,"QUANTITATIVE",(function(){return i})),n(e.exports,"ORDINAL",(function(){return o})),n(e.exports,"TEMPORAL",(function(){return u})),n(e.exports,"NOMINAL",(function(){return c})),n(e.exports,"GEOJSON",(function(){return l})),n(e.exports,"TYPES",(function(){return f})),n(e.exports,"getFullName",(function(){return d}));var r=s("lSb9O"),a={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};var i=a.quantitative,o=a.ordinal,u=a.temporal,c=a.nominal,l=a.geojson,f=r.keys(a);function d(e){if(e)switch(e=e.toLowerCase()){case"q":case i:return"quantitative";case"t":case u:return"temporal";case"o":case o:return"ordinal";case"n":case c:return"nominal";case l:return"geojson"}}})),s.register("5PVWc",(function(e,t){n(e.exports,"midPointRefWithPositionInvalidTest",(function(){return b})),n(e.exports,"midPoint",(function(){return N})),n(e.exports,"wrapPositionInvalidTest",(function(){return k})),n(e.exports,"fieldInvalidPredicate",(function(){return A})),n(e.exports,"datumDefToExpr",(function(){return E})),n(e.exports,"valueRefForFieldOrDatumDef",(function(){return C})),n(e.exports,"interpolatedSignalRef",(function(){return S})),n(e.exports,"widthHeightValueOrSignalRef",(function(){return T})),s("iSlfb");var r=s("fCSiB"),a=s("jvEVv"),i=s("6jZCp"),o=s("61RXI"),u=s("e3OyN"),c=s("iooJ7"),l=s("ggS1y"),f=s("16rNM"),d=s("2x4HI"),p=s("4sOzK"),h=s("ceGn0"),v=s("7J7Lf"),g=s("4jgmF"),m=s("lSb9O"),y=s("7T458"),x=s("9iwJo");function b(e){var t=e.channel,n=e.channelDef,r=e.markDef,a=e.scale,o=e.config,u=N(e);return c.isFieldDef(n)&&!i.isCountingAggregateOp(n.aggregate)&&a&&v.isContinuousToContinuous(a.get("type"))&&!1===a.get("zero")?k({fieldDef:n,channel:t,markDef:r,ref:u,config:o}):u}function k(e){var t=e.fieldDef,n=e.channel,r=e.markDef,a=e.ref,i=e.config;return p.isPathMark(r.type)||null===x.getMarkPropOrConfig("invalid",r,i)?a:[w(t,n),a]}function w(e,t){var n=A(e,!0),r="y"===u.getMainRangeChannel(t)?{field:{group:"height"}}:{value:0};return Object.assign({test:n},r)}function A(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return h.fieldValidPredicate(r.default(e)?e:c.vgField(e,{expr:"datum"}),!t)}function E(e){var t=e.datum;return l.isDateTime(t)?l.dateTimeToExpr(t):"".concat(JSON.stringify(t))}function C(e,t,n,r){var a={};if(t&&(a.scale=t),c.isDatumDef(e)){var i=e.datum;l.isDateTime(i)?a.signal=l.dateTimeToExpr(i):y.isSignalRef(i)?a.signal=i.signal:a.value=i}else a.field=c.vgField(e,n);if(r){var o=r.offset,u=r.band;o&&(a.offset=o),u&&(a.band=u)}return a}function S(e){var t=e.scaleName,n=e.fieldOrDatumDef,r=e.fieldOrDatumDef2,a=e.offset,i=e.startSuffix,o=e.band,u=void 0===o?.5:o,s=0<u&&u<1?"datum":void 0,l=c.vgField(n,{expr:s,suffix:i}),f=void 0!==r?c.vgField(r,{expr:s}):c.vgField(n,{suffix:"end",expr:s}),d={};if(0===u||1===u){d.scale=t;var p=0===u?l:f;d.field=p}else{var h="".concat(u," * ").concat(l," + ").concat(1-u," * ").concat(f);d.signal='scale("'.concat(t,'", ').concat(h,")")}return a&&(d.offset=a),d}function N(e){var t,n=e.channel,r=e.channelDef,i=e.channel2Def,s=e.markDef,l=e.config,p=e.scaleName,h=e.scale,m=e.stack,y=e.offset,x=e.defaultRef,b=e.band;if(r){if(c.isFieldOrDatumDef(r)){if(c.isTypedFieldDef(r)){b=null!=b?b:c.getBand({channel:n,fieldDef:r,fieldDef2:i,markDef:s,stack:m,config:l,isMidPoint:!0});var k=r.bin,w=r.timeUnit,A=r.type;if(o.isBinning(k)||b&&w&&A===g.TEMPORAL)return m&&m.impute?C(r,p,{binSuffix:"mid"},{offset:y}):b?S({scaleName:p,fieldOrDatumDef:r,band:b,offset:y}):C(r,p,c.binRequiresRange(r,n)?{binSuffix:"range"}:{},{offset:y});if(o.isBinned(k)){if(c.isFieldDef(i))return S({scaleName:p,fieldOrDatumDef:r,fieldOrDatumDef2:i,band:b,offset:y});var E=n===u.X?u.X2:u.Y2;f.warn(d.channelRequiredForBinned(E))}}var N=null==h?void 0:h.get("type");return C(r,p,v.hasDiscreteDomain(N)?{binSuffix:"range"}:{},{offset:y,band:"band"===N?null!==(t=null!=b?b:r.band)&&void 0!==t?t:.5:void 0})}if(c.isValueDef(r)){var D=r.value,F=y?{offset:y}:{};return Object.assign(Object.assign({},T(n,D)),F)}}return a.default(x)&&(x=x()),x?Object.assign(Object.assign({},x),y?{offset:y}:{}):x}function T(e,t){return m.contains(["x","x2"],e)&&"width"===t?{field:{group:"width"}}:m.contains(["y","y2"],e)&&"height"===t?{field:{group:"height"}}:x.signalOrValueRef(t)}})),s.register("2V3EF",(function(e,t){n(e.exports,"DEFAULT_SORT_OP",(function(){return a})),n(e.exports,"isSortByChannel",(function(){return o})),n(e.exports,"isSortByEncoding",(function(){return u})),n(e.exports,"isSortField",(function(){return c})),n(e.exports,"isSortArray",(function(){return l})),s("iSlfb");var r=s("4ujSI"),a="min",i={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function o(e){return e in i}function u(e){return!!e&&!!e.encoding}function c(e){return!(!e||"count"!==e.op&&!e.field)}function l(e){return!!e&&r.default(e)}})),s.register("pZnnI",(function(e,t){function r(e){return"row"in e||"column"in e}function a(e){return!!e&&"header"in e}function i(e){return"facet"in e}n(e.exports,"isFacetMapping",(function(){return r})),n(e.exports,"isFacetFieldDef",(function(){return a})),n(e.exports,"isFacetSpec",(function(){return i}))})),s.register("aiwuu",(function(e,t){n(e.exports,"extractTitleConfig",(function(){return u})),n(e.exports,"isText",(function(){return c}));var r=s("2lx0N");s("iSlfb");var a=s("fCSiB"),i=s("4ujSI"),o=s("lSb9O");function u(e){var t=e.anchor,n=e.frame,a=e.offset,i=e.orient,u=e.color,s=e.subtitleColor,c=e.subtitleFont,l=e.subtitleFontSize,f=e.subtitleFontStyle,d=e.subtitleFontWeight,p=e.subtitleLineHeight,h=e.subtitlePadding,v=r.__rest(e,["anchor","frame","offset","orient","color","subtitleColor","subtitleFont","subtitleFontSize","subtitleFontStyle","subtitleFontWeight","subtitleLineHeight","subtitlePadding"]),g=Object.assign(Object.assign({},v),u?{fill:u}:{}),m=Object.assign(Object.assign(Object.assign(Object.assign({},t?{anchor:t}:{}),n?{frame:n}:{}),a?{offset:a}:{}),i?{orient:i}:{}),y=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{subtitleColor:s}:{}),c?{subtitleFont:c}:{}),l?{subtitleFontSize:l}:{}),f?{subtitleFontStyle:f}:{}),d?{subtitleFontWeight:d}:{}),p?{subtitleLineHeight:p}:{}),h?{subtitlePadding:h}:{});return{titleMarkConfig:g,subtitleMarkConfig:o.pick(g,["align","baseline","dx","dy","limit"]),nonMark:m,subtitle:y}}function c(e){return a.default(e)||i.default(e)&&a.default(e[0])}})),s.register("jQ4iQ",(function(e,t){n(e.exports,"channelHasField",(function(){return g})),n(e.exports,"isAggregate",(function(){return m})),n(e.exports,"extractTransformsFromEncoding",(function(){return y})),n(e.exports,"forEach",(function(){return k})),n(e.exports,"initEncoding",(function(){return x})),n(e.exports,"fieldDefs",(function(){return b})),n(e.exports,"reduce",(function(){return w})),n(e.exports,"pathGroupingFields",(function(){return A}));var r=s("2lx0N");s("iSlfb");var a=s("4ujSI"),i=s("1Ihp0"),o=s("6jZCp"),u=s("61RXI"),c=s("e3OyN"),l=s("iooJ7"),f=s("16rNM"),d=s("2x4HI"),p=s("4jgmF"),h=s("lSb9O"),v=s("7T458");function g(e,t){var n=e&&e[t];return!!n&&(a.default(n)?h.some(n,(function(e){return!!e.field})):l.isFieldDef(n)||l.hasConditionalFieldDef(n))}function m(e){return h.some(c.CHANNELS,(function(t){if(g(e,t)){var n=e[t];if(a.default(n))return h.some(n,(function(e){return!!e.aggregate}));var r=l.getFieldDef(n);return r&&!!r.aggregate}return!1}))}function y(e,t){var n=[],a=[],i=[],s=[],f={};return k(e,(function(d,h){if(l.isFieldDef(d)){var v=d.field,g=d.aggregate,m=d.bin,y=d.timeUnit,x=r.__rest(d,["field","aggregate","bin","timeUnit"]);if(g||y||m){var b,k=l.getGuide(d),w=k&&k.title,A=l.vgField(d,{forAs:!0}),E=Object.assign(Object.assign(Object.assign({},w?[]:{title:l.title(d,t,{allowDisabling:!0})}),x),{field:A});if(g){if(o.isArgmaxDef(g)?(b="argmax",A=l.vgField({op:"argmax",field:g.argmax},{forAs:!0}),E.field="".concat(A,".").concat(v)):o.isArgminDef(g)?(b="argmin",A=l.vgField({op:"argmin",field:g.argmin},{forAs:!0}),E.field="".concat(A,".").concat(v)):"boxplot"!==g&&"errorbar"!==g&&"errorband"!==g&&(b=g),b){var C={op:b,as:A};v&&(C.field=v),s.push(C)}}else if(n.push(A),l.isTypedFieldDef(d)&&u.isBinning(m)){if(a.push({bin:m,field:v,as:A}),n.push(l.vgField(d,{binSuffix:"end"})),l.binRequiresRange(d,h)&&n.push(l.vgField(d,{binSuffix:"range"})),c.isXorY(h)){var S={field:A+"_end"};f[h+"2"]=S}E.bin="binned",c.isSecondaryRangeChannel(h)||(E.type=p.QUANTITATIVE)}else if(y){i.push({timeUnit:y,field:v,as:A});var N=l.isTypedFieldDef(d)&&d.type!==p.TEMPORAL&&"time";N&&(h===c.TEXT||h===c.TOOLTIP?E.formatType=N:c.isNonPositionScaleChannel(h)?E.legend=Object.assign({formatType:N},E.legend):c.isXorY(h)&&(E.axis=Object.assign({formatType:N},E.axis)))}f[h]=E}else n.push(v),f[h]=e[h]}else f[h]=e[h]})),{bins:a,timeUnits:i,aggregate:s,groupby:n,encoding:f}}function x(e,t,n){var r=t.type;return h.keys(e).reduce((function(o,s){if(!c.isChannel(s))return f.warn(d.invalidEncodingChannel(s)),o;var p=e[s];if("angle"!==s||"arc"!==r||e.theta||(f.warn(d.REPLACE_ANGLE_WITH_THETA),s=c.THETA),!function(e,t,n){var r=c.supportMark(t,n);if(!r)return!1;if("binned"===r){var a=e[t===c.X2?c.X:c.Y];return!!(l.isFieldDef(a)&&l.isFieldDef(e[t])&&u.isBinned(a.bin))}return!0}(e,s,r))return f.warn(d.incompatibleChannel(s,r)),o;if(s===c.SIZE&&"line"===r){var h=l.getFieldDef(e[s]);if(null==h?void 0:h.aggregate)return f.warn(d.LINE_WITH_VARYING_SIZE),o}if(s===c.COLOR&&(t.filled?"fill"in e:"stroke"in e))return f.warn(d.droppingColor("encoding",{fill:"fill"in e,stroke:"stroke"in e})),o;if(s===c.DETAIL||s===c.ORDER&&!a.default(p)&&!l.isValueDef(p)||s===c.TOOLTIP&&a.default(p))p&&(o[s]=i.default(p).reduce((function(e,t){return l.isFieldDef(t)?e.push(l.initFieldDef(t,s)):f.warn(d.emptyFieldDef(t,s)),e}),[]));else{if(s===c.TOOLTIP&&null===p)o[s]=null;else if(!(l.isFieldDef(p)||l.isDatumDef(p)||l.isValueDef(p)||l.isConditionalDef(p)||v.isSignalRef(p)))return f.warn(d.emptyFieldDef(p,s)),o;o[s]=l.initChannelDef(p,s,n)}return o}),{})}function b(e){var t=[],n=!0,r=!1,a=void 0;try{for(var o,u=h.keys(e)[Symbol.iterator]();!(n=(o=u.next()).done);n=!0){var s=o.value;if(g(e,s)){var c=e[s],f=i.default(c),d=!0,p=!1,v=void 0;try{for(var m,y=f[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var x=m.value;l.isFieldDef(x)?t.push(x):l.hasConditionalFieldDef(x)&&t.push(x.condition)}}catch(e){p=!0,v=e}finally{try{d||null==y.return||y.return()}finally{if(p)throw v}}}}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}return t}function k(e,t,n){if(e){var r=!0,i=!1,o=void 0;try{for(var u,s=h.keys(e)[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value,l=e[c],f=!0,d=!1,p=void 0;if(a.default(l))try{for(var v,g=l[Symbol.iterator]();!(f=(v=g.next()).done);f=!0){var m=v.value;t.call(n,m,c)}}catch(e){d=!0,p=e}finally{try{f||null==g.return||g.return()}finally{if(d)throw p}}else t.call(n,l,c)}}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}}}function w(e,t,n,r){return e?h.keys(e).reduce((function(n,i){var o=e[i];return a.default(o)?o.reduce((function(e,n){return t.call(r,e,n,i)}),n):t.call(r,n,o,i)}),n):n}function A(e,t){return h.keys(t).reduce((function(n,r){switch(r){case c.X:case c.Y:case c.HREF:case c.DESCRIPTION:case c.URL:case c.X2:case c.Y2:case c.THETA:case c.THETA2:case c.RADIUS:case c.RADIUS2:case c.LATITUDE:case c.LONGITUDE:case c.LATITUDE2:case c.LONGITUDE2:case c.TEXT:case c.SHAPE:case c.ANGLE:case c.TOOLTIP:return n;case c.ORDER:if("line"===e||"trail"===e)return n;case c.DETAIL:case c.KEY:var o=t[r];if(a.default(o)||l.isFieldDef(o)){var u=!0,s=!1,f=void 0;try{for(var d,p=i.default(o)[Symbol.iterator]();!(u=(d=p.next()).done);u=!0){var h=d.value;h.aggregate||n.push(l.vgField(h,{}))}}catch(e){s=!0,f=e}finally{try{u||null==p.return||p.return()}finally{if(s)throw f}}}return n;case c.SIZE:if("trail"===e)return n;case c.COLOR:case c.FILL:case c.STROKE:case c.OPACITY:case c.FILLOPACITY:case c.STROKEOPACITY:case c.STROKEDASH:case c.STROKEWIDTH:var v=l.getFieldDef(t[r]);return v&&!v.aggregate&&n.push(l.vgField(v,{})),n}}),[])}})),s.register("7iwSx",(function(e,t){n(e.exports,"filterTooltipWithAggregatedField",(function(){return m})),n(e.exports,"getCompositeMarkTooltip",(function(){return y})),n(e.exports,"getTitle",(function(){return x})),n(e.exports,"makeCompositeAggregatePartFactory",(function(){return b})),n(e.exports,"partLayerMixins",(function(){return k})),n(e.exports,"compositeMarkContinuousAxis",(function(){return w})),n(e.exports,"compositeMarkOrient",(function(){return E})),s("1i51P");var r=s("9M1dW"),a=s("4Ui3v"),i=s("2lx0N");s("iSlfb");var o=s("4ujSI"),u=s("fCSiB"),c=s("iRIM1"),l=s("iooJ7"),f=s("jQ4iQ"),d=s("16rNM"),p=s("2x4HI"),h=s("4sOzK"),v=s("lSb9O"),g=s("7T458");function m(e){var t,n,r=e.tooltip,a=i.__rest(e,["tooltip"]);if(!r)return{filteredEncoding:e};if(o.default(r)){var u=!0,s=!1,c=void 0;try{for(var l,f=r[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;d.aggregate?(t||(t=[]),t.push(d)):(n||(n=[]),n.push(d))}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}t&&(a.tooltip=t)}else r.aggregate?a.tooltip=r:n=r;return o.default(n)&&1===n.length&&(n=n[0]),{customTooltipWithoutAggregatedField:n,filteredEncoding:a}}function y(e,t,n){var a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if("tooltip"in n)return{tooltip:n.tooltip};var i=e.map((function(e){var n=e.fieldPrefix,r=e.titlePrefix,i=a?" of ".concat(t.field):"";return{field:n+t.field,type:t.type,title:g.isSignalRef(r)?{signal:r+'"'.concat(escape(i),'"')}:r+i}}));return{tooltip:r.default(i).concat(r.default(f.fieldDefs(n)))}}function x(e){var t=e.axis,n=e.title,r=e.field;return t&&void 0!==t.title?void 0:v.getFirstDefined(n,r)}function b(e,t,n,r,i){var o=n.scale,s=n.axis;return function(c){var l=c.partName,f=c.mark,d=c.positionPrefix,p=c.endPositionPrefix,h=c.aria,v=c.extraEncoding,g=void 0===v?{}:v,m=x(n);return k(e,l,i,h,{mark:f,encoding:Object.assign(Object.assign(Object.assign(a.default({},t,Object.assign(Object.assign(Object.assign({field:d+"_"+n.field,type:n.type},void 0!==m?{title:m}:{}),void 0!==o?{scale:o}:{}),void 0!==s?{axis:s}:{})),u.default(p)?a.default({},t+"2",{field:p+"_"+n.field}):{}),r),g)})}}function k(e,t,n,r,a){var i=e.clip,o=e.color,u=e.opacity,s=e.type;return e[t]||void 0===e[t]&&n[t]?[Object.assign(Object.assign({},a),{mark:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n[t]),i?{clip:i}:{}),o?{color:o}:{}),u?{opacity:u}:{}),h.isMarkDef(a.mark)?a.mark:{type:a.mark}),{style:"".concat(s,"-").concat(t)}),c.default(e[t])?{}:e[t]),!1===r?{aria:r}:{})})]:[]}function w(e,t,n){var r=e.encoding,a="vertical"===t?"y":"x",i=r[a],o=r[a+"2"],u=r[a+"Error"],s=r[a+"Error2"];return{continuousAxisChannelDef:A(i,n),continuousAxisChannelDef2:A(o,n),continuousAxisChannelDefError:A(u,n),continuousAxisChannelDefError2:A(s,n),continuousAxis:a}}function A(e,t){if(e&&e.aggregate){var n=e.aggregate,r=i.__rest(e,["aggregate"]);return n!==t&&d.warn(p.errorBarContinuousAxisHasCustomizedAggregate(n,t)),r}return e}function E(e,t){var n=e.mark,r=e.encoding,a=r.x,i=r.y;if(l.isContinuousFieldOrDatumDef(a)){if(l.isContinuousFieldOrDatumDef(i)){var o=l.isFieldDef(a)&&a.aggregate,u=l.isFieldDef(i)&&i.aggregate;if(o||u!==t){if(u||o!==t){if(o===t&&u===t)throw new Error("Both x and y cannot have aggregate");return h.isMarkDef(n)&&n.orient?n.orient:"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(l.isContinuousFieldOrDatumDef(i))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")}})),s.register("bY77U",(function(e,t){n(e.exports,"ERRORBAND",(function(){return l})),n(e.exports,"ERRORBAND_PARTS",(function(){return f})),n(e.exports,"errorBandNormalizer",(function(){return d})),n(e.exports,"normalizeErrorBand",(function(){return p})),s("1i51P");var r=s("9M1dW"),a=s("16rNM"),i=s("2x4HI"),o=s("ioRdy"),u=s("7iwSx"),c=s("jEBxI"),l="errorband",f=["band","borders"],d=new o.CompositeMarkNormalizer(l,p);function p(e,t){var n=t.config,o=c.errorBarParams(e,l,n),s=o.transform,f=o.continuousAxisChannelDef,d=o.continuousAxis,p=o.encodingWithoutContinuousAxis,h=o.markDef,v=o.outerSpec,g=o.tooltipEncoding,m=h,y=u.makeCompositeAggregatePartFactory(m,d,f,p,n.errorband),x=void 0!==e.encoding.x&&void 0!==e.encoding.y,b={type:x?"area":"rect"},k={type:x?"line":"rule"},w=Object.assign(Object.assign({},m.interpolate?{interpolate:m.interpolate}:{}),m.tension&&m.interpolate?{tension:m.tension}:{});return x?(b=Object.assign(Object.assign(Object.assign({},b),w),{ariaRoleDescription:"errorband"}),k=Object.assign(Object.assign({},k),w)):m.interpolate?a.warn(i.errorBand1DNotSupport("interpolate")):m.tension&&a.warn(i.errorBand1DNotSupport("tension")),Object.assign(Object.assign({},v),{transform:s,layer:r.default(y({partName:"band",mark:b,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:g})).concat(r.default(y({partName:"borders",mark:k,positionPrefix:"lower",aria:!1,extraEncoding:g})),r.default(y({partName:"borders",mark:k,positionPrefix:"upper",aria:!1,extraEncoding:g})))})}})),s.register("jEBxI",(function(e,t){n(e.exports,"ERRORBAR",(function(){return v})),n(e.exports,"ERRORBAR_PARTS",(function(){return g})),n(e.exports,"errorBarNormalizer",(function(){return m})),n(e.exports,"normalizeErrorBar",(function(){return y})),n(e.exports,"errorBarParams",(function(){return b})),s("1i51P");var r=s("9M1dW"),a=s("5lcaY"),i=s("2lx0N"),o=s("iooJ7"),u=s("jQ4iQ"),c=s("16rNM"),l=s("2x4HI"),f=s("4sOzK"),d=s("lSb9O"),p=s("ioRdy"),h=s("7iwSx"),v="errorbar",g=["ticks","rule"],m=new p.CompositeMarkNormalizer(v,y);function y(e,t){var n=t.config,a=b(e,v,n),i=a.transform,o=a.continuousAxisChannelDef,u=a.continuousAxis,s=a.encodingWithoutContinuousAxis,c=a.ticksOrient,l=a.markDef,f=a.outerSpec,d=a.tooltipEncoding,p=h.makeCompositeAggregatePartFactory(l,u,o,s,n.errorbar),g={type:"tick",orient:c},m=r.default(p({partName:"ticks",mark:g,positionPrefix:"lower",aria:!1,extraEncoding:d})).concat(r.default(p({partName:"ticks",mark:g,positionPrefix:"upper",aria:!1,extraEncoding:d})),r.default(p({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar"},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:d})));return Object.assign(Object.assign(Object.assign({},f),{transform:i}),m.length>1?{layer:m}:Object.assign({},m[0]))}function x(e,t){var n=e.encoding;if(function(e){return(o.isFieldOrDatumDef(e.x)||o.isFieldOrDatumDef(e.y))&&!o.isFieldOrDatumDef(e.x2)&&!o.isFieldOrDatumDef(e.y2)&&!o.isFieldOrDatumDef(e.xError)&&!o.isFieldOrDatumDef(e.xError2)&&!o.isFieldOrDatumDef(e.yError)&&!o.isFieldOrDatumDef(e.yError2)}(n))return{orient:h.compositeMarkOrient(e,t),inputType:"raw"};var r=function(e){return o.isFieldOrDatumDef(e.x2)||o.isFieldOrDatumDef(e.y2)}(n),a=function(e){return o.isFieldOrDatumDef(e.xError)||o.isFieldOrDatumDef(e.xError2)||o.isFieldOrDatumDef(e.yError)||o.isFieldOrDatumDef(e.yError2)}(n),i=n.x,u=n.y;if(r){if(a)throw new Error("".concat(t," cannot be both type aggregated-upper-lower and aggregated-error"));var s=n.x2,c=n.y2;if(o.isFieldOrDatumDef(s)&&o.isFieldOrDatumDef(c))throw new Error("".concat(t," cannot have both x2 and y2"));if(o.isFieldOrDatumDef(s)){if(o.isContinuousFieldOrDatumDef(i))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error("Both x and x2 have to be quantitative in ".concat(t))}if(o.isFieldOrDatumDef(c)){if(o.isContinuousFieldOrDatumDef(u))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error("Both y and y2 have to be quantitative in ".concat(t))}throw new Error("No ranged axis")}var l=n.xError,f=n.xError2,d=n.yError,p=n.yError2;if(o.isFieldOrDatumDef(f)&&!o.isFieldOrDatumDef(l))throw new Error("".concat(t," cannot have xError2 without xError"));if(o.isFieldOrDatumDef(p)&&!o.isFieldOrDatumDef(d))throw new Error("".concat(t," cannot have yError2 without yError"));if(o.isFieldOrDatumDef(l)&&o.isFieldOrDatumDef(d))throw new Error("".concat(t," cannot have both xError and yError with both are quantiative"));if(o.isFieldOrDatumDef(l)){if(o.isContinuousFieldOrDatumDef(i))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(o.isFieldOrDatumDef(d)){if(o.isContinuousFieldOrDatumDef(u))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}function b(e,t,n){var s,p=e.mark,v=e.encoding,g=e.selection,m=(e.projection,i.__rest(e,["mark","encoding","selection","projection"])),y=f.isMarkDef(p)?p:{type:p};g&&c.warn(l.selectionNotSupported(t));var b=x(e,t),w=b.orient,A=b.inputType,E=h.compositeMarkContinuousAxis(e,w,t),C=E.continuousAxisChannelDef,S=E.continuousAxisChannelDef2,N=E.continuousAxisChannelDefError,T=E.continuousAxisChannelDefError2,D=E.continuousAxis,F=function(e,t,n,r,a,i,u,s){var f,p=[],h=[],v=t.field,g=!1;if("raw"===i){var m,y,x,b=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":s.errorbar.center,w=e.extent?e.extent:"mean"===b?"stderr":"iqr";if("median"===b!=("iqr"===w)&&c.warn(l.errorBarCenterIsUsedWithWrongExtent(b,w,u)),"stderr"===w||"stdev"===w)p=[{op:w,field:v,as:"extent_"+v},{op:b,field:v,as:"center_"+v}],h=[{calculate:'datum["center_'.concat(v,'"] + datum["extent_').concat(v,'"]'),as:"upper_"+v},{calculate:'datum["center_'.concat(v,'"] - datum["extent_').concat(v,'"]'),as:"lower_"+v}],f=[{fieldPrefix:"center_",titlePrefix:d.titleCase(b)},{fieldPrefix:"upper_",titlePrefix:k(b,w,"+")},{fieldPrefix:"lower_",titlePrefix:k(b,w,"-")}],g=!0;else e.center&&e.extent&&c.warn(l.errorBarCenterIsNotNeeded(e.extent,u)),"ci"===w?(m="mean",y="ci0",x="ci1"):(m="median",y="q1",x="q3"),p=[{op:y,field:v,as:"lower_"+v},{op:x,field:v,as:"upper_"+v},{op:m,field:v,as:"center_"+v}],f=[{fieldPrefix:"upper_",titlePrefix:o.title({field:v,aggregate:x,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:o.title({field:v,aggregate:y,type:"quantitative"},s,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:o.title({field:v,aggregate:m,type:"quantitative"},s,{allowDisabling:!1})}]}else{(e.center||e.extent)&&c.warn(l.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),"aggregated-upper-lower"===i?(f=[],h=[{calculate:'datum["'.concat(n.field,'"]'),as:"upper_"+v},{calculate:'datum["'.concat(v,'"]'),as:"lower_"+v}]):"aggregated-error"===i&&(f=[{fieldPrefix:"",titlePrefix:v}],h=[{calculate:'datum["'.concat(v,'"] + datum["').concat(r.field,'"]'),as:"upper_"+v}],a?h.push({calculate:'datum["'.concat(v,'"] + datum["').concat(a.field,'"]'),as:"lower_"+v}):h.push({calculate:'datum["'.concat(v,'"] - datum["').concat(r.field,'"]'),as:"lower_"+v}));var A=!0,E=!1,C=void 0;try{for(var S,N=h[Symbol.iterator]();!(A=(S=N.next()).done);A=!0){var T=S.value;f.push({fieldPrefix:T.as.substring(0,6),titlePrefix:d.replaceAll(d.replaceAll(T.calculate,'datum["',""),'"]',"")})}}catch(e){E=!0,C=e}finally{try{A||null==N.return||N.return()}finally{if(E)throw C}}}return{postAggregateCalculates:h,errorBarSpecificAggregate:p,tooltipSummary:f,tooltipTitleWithFieldName:g}}(y,C,S,N,T,A,t,n),O=F.errorBarSpecificAggregate,_=F.postAggregateCalculates,I=F.tooltipSummary,R=F.tooltipTitleWithFieldName,M=v,B=D,P=(M[B],"x"===D?"x2":"y2"),L=(M[P],"x"===D?"xError":"yError"),j=(M[L],"x"===D?"xError2":"yError2"),z=(M[j],i.__rest(M,["symbol"===(void 0===B?"undefined":a.default(B))?B:B+"","symbol"===(void 0===P?"undefined":a.default(P))?P:P+"","symbol"===(void 0===L?"undefined":a.default(L))?L:L+"","symbol"===(void 0===j?"undefined":a.default(j))?j:j+""])),U=u.extractTransformsFromEncoding(z,n),V=U.bins,W=U.timeUnits,G=U.aggregate,H=U.groupby,q=U.encoding,J=r.default(G).concat(r.default(O)),K="raw"!==A?[]:H,X=h.getCompositeMarkTooltip(I,C,q,R);return{transform:r.default(null!==(s=m.transform)&&void 0!==s?s:[]).concat(r.default(V),r.default(W),r.default(0===J.length?[]:[{aggregate:J,groupby:K}]),r.default(_)),groupby:K,continuousAxisChannelDef:C,continuousAxis:D,encodingWithoutContinuousAxis:q,ticksOrient:"vertical"===w?"horizontal":"vertical",markDef:y,outerSpec:m,tooltipEncoding:X}}function k(e,t,n){return d.titleCase(e)+" "+n+" "+t}})),s.register("k2bZF",(function(e,t){n(e.exports,"VL_ONLY_LEGEND_CONFIG",(function(){return r}));var r=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"]})),s.register("9280j",(function(e,t){n(e.exports,"LEGEND_SCALE_CHANNELS",(function(){return a})),n(e.exports,"SIGNAL_LEGEND_PROP_INDEX",(function(){return i})),n(e.exports,"defaultLegendConfig",(function(){return o})),n(e.exports,"COMMON_LEGEND_PROPERTY_INDEX",(function(){return u}));var r=s("lSb9O"),a=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],i={fillColor:{part:"legend",vgProp:"fill"},gradientStrokeColor:{part:"gradient",vgProp:"stroke"},labelColor:{part:"labels",vgProp:"fill"},strokeColor:{part:"legend",vgProp:"stroke"},symbolFillColor:{part:"symbols",vgProp:"fill"},symbolStrokeColor:{part:"symbols",vgProp:"stroke"},titleColor:{part:"title",vgProp:"fill"}},o={gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},u={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1};r.keys(u)})),s.register("5XFBz",(function(e,t){n(e.exports,"SELECTION_ID",(function(){return a})),n(e.exports,"defaultConfig",(function(){return i})),n(e.exports,"isLegendBinding",(function(){return o})),n(e.exports,"isLegendStreamBinding",(function(){return u})),s("iSlfb");var r=s("bZ6XL"),a="_vgsid_",i={single:{on:"click",fields:[a],resolve:"global",empty:"all",clear:"dblclick"},multi:{on:"click",fields:[a],toggle:"event.shiftKey",resolve:"global",empty:"all",clear:"dblclick"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function o(e){return!(!e||"legend"!==e&&!e.legend)}function u(e){return o(e)&&r.default(e)}})),s.register("eg4js",(function(e,t){n(e.exports,"isStep",(function(){return c})),n(e.exports,"isFrameMixins",(function(){return l})),n(e.exports,"DEFAULT_SPACING",(function(){return f})),n(e.exports,"extractCompositionLayout",(function(){return p})),s("iSlfb");var r=s("bZ6XL"),a=s("8AF0b"),i=s("lSb9O"),o=s("e0srg"),u=s("pZnnI");function c(e){return r.default(e)&&void 0!==e.step}function l(e){return e.view||e.width||e.height}var f=20,d=i.keys({align:1,bounds:1,center:1,columns:1,spacing:1});function p(e,t,n){var r,i,s=n[t],c={},l=s.spacing,f=s.columns;void 0!==l&&(c.spacing=l),void 0!==f&&(u.isFacetSpec(e)&&!u.isFacetMapping(e.facet)||o.isConcatSpec(e))&&(c.columns=f),o.isVConcatSpec(e)&&(c.columns=1);var p=!0,h=!1,v=void 0;try{for(var g,m=d[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=g.value;if(void 0!==e[y])if("spacing"===y){var x=e[y];c[y]=a.default(x)?x:{row:null!==(r=x.row)&&void 0!==r?r:l,column:null!==(i=x.column)&&void 0!==i?i:l}}else c[y]=e[y]}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}return c}})),s.register("e0srg",(function(e,t){function r(e){return i(e)||o(e)||a(e)}function a(e){return"concat"in e}function i(e){return"vconcat"in e}function o(e){return"hconcat"in e}n(e.exports,"isAnyConcatSpec",(function(){return r})),n(e.exports,"isVConcatSpec",(function(){return i})),n(e.exports,"isHConcatSpec",(function(){return o})),n(e.exports,"isConcatSpec",(function(){return a}))})),s.register("gLFCo",(function(e,t){n(e.exports,"isAnyConcatSpec",(function(){return s("e0srg").isAnyConcatSpec})),n(e.exports,"isHConcatSpec",(function(){return s("e0srg").isHConcatSpec})),n(e.exports,"isVConcatSpec",(function(){return s("e0srg").isVConcatSpec})),n(e.exports,"isFacetSpec",(function(){return s("pZnnI").isFacetSpec})),n(e.exports,"isLayerSpec",(function(){return s("1sD9J").isLayerSpec})),n(e.exports,"isUnitSpec",(function(){return s("aIH68").isUnitSpec}));s("e0srg"),s("pZnnI"),s("1sD9J"),s("7DQpg"),s("aIH68")})),s.register("1sD9J",(function(e,t){function r(e){return"layer"in e}n(e.exports,"isLayerSpec",(function(){return r}))})),s.register("7DQpg",(function(e,t){n(e.exports,"isRepeatSpec",(function(){return a})),n(e.exports,"isLayerRepeatSpec",(function(){return i})),s("iSlfb");var r=s("4ujSI");function a(e){return"repeat"in e}function i(e){return!r.default(e.repeat)&&e.repeat.layer}})),s.register("1GdhA",(function(e,t){n(e.exports,"CoreNormalizer",(function(){return D})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("kRKWT"),c=s("eYQ8O"),l=s("9M1dW"),f=s("2lx0N");s("iSlfb");var d=s("4ujSI"),p=s("e3OyN"),h=s("ctDl5"),v=s("bY77U"),g=s("jEBxI"),m=s("jQ4iQ"),y=s("16rNM"),x=s("2x4HI"),b=s("pZnnI"),k=s("7vDGT"),w=s("7DQpg"),A=s("aIH68"),E=s("lSb9O"),C=s("c5FVc"),S=s("3ehCB"),N=s("6r5YL"),T=s("eteUa"),D=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){var e;return i.default(this,n),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).nonFacetUnitNormalizers=[h.boxPlotNormalizer,g.errorBarNormalizer,v.errorBandNormalizer,new C.PathOverlayNormalizer,new T.RuleForRangedLineNormalizer,new S.RangeStepNormalizer],e}return o.default(n,[{key:"map",value:function(e,t){if(A.isUnitSpec(e)){var r=m.channelHasField(e.encoding,p.ROW),a=m.channelHasField(e.encoding,p.COLUMN),i=m.channelHasField(e.encoding,p.FACET);if(r||a||i)return this.mapFacetedUnit(e,t)}return u.default(c.default(n.prototype),"map",this).call(this,e,t)}},{key:"mapUnit",value:function(e,t){var n=t.parentEncoding,r=t.parentProjection,a=Object.assign(Object.assign({},e),{encoding:N.replaceRepeaterInEncoding(e.encoding,t.repeater)});if(n||r)return this.mapUnitWithParentEncodingOrProjection(a,t);var i=this.mapLayerOrUnit.bind(this),o=!0,u=!1,s=void 0;try{for(var c,l=this.nonFacetUnitNormalizers[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;if(f.hasMatchingType(a,t.config))return f.run(a,t,i)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return a}},{key:"mapRepeat",value:function(e,t){return w.isLayerRepeatSpec(e)?this.mapLayerRepeat(e,t):this.mapNonLayerRepeat(e,t)}},{key:"mapLayerRepeat",value:function(e,t){var n=this,r=e.repeat,a=e.spec,i=f.__rest(e,["repeat","spec"]),o=r.row,u=r.column,s=r.layer,c=t.repeater,l=void 0===c?{}:c,d=t.repeaterPrefix,p=void 0===d?"":d;return o||u?this.mapRepeat(Object.assign(Object.assign({},e),{repeat:Object.assign(Object.assign({},o?{row:o}:{}),u?{column:u}:{}),spec:{repeat:{layer:s},spec:a}}),t):Object.assign(Object.assign({},i),{layer:s.map((function(e){var r=Object.assign(Object.assign({},l),{layer:e}),i=(a.name||"")+p+"child__layer_".concat(E.varName(e)),o=n.mapLayerOrUnit(a,Object.assign(Object.assign({},t),{repeater:r,repeaterPrefix:i}));return o.name=i,o}))})}},{key:"mapNonLayerRepeat",value:function(e,t){var n,r=e.repeat,a=e.spec,i=e.data,o=f.__rest(e,["repeat","spec","data"]);!d.default(r)&&e.columns&&(e=E.omit(e,["columns"]),y.warn(x.columnsNotSupportByRowCol("repeat")));var u=[],s=t.repeater,c=void 0===s?{}:s,l=t.repeaterPrefix,p=void 0===l?"":l,h=!d.default(r)&&r.row||[c?c.row:null],v=!d.default(r)&&r.column||[c?c.column:null],g=d.default(r)&&r||[c?c.repeat:null],m=!0,b=!1,k=void 0;try{for(var w,A=g[Symbol.iterator]();!(m=(w=A.next()).done);m=!0){var C=w.value,S=!0,N=!1,T=void 0,D=!0,F=!1,O=void 0;try{for(var _,I=h[Symbol.iterator]();!(D=(_=I.next()).done);D=!0){var R=_.value;try{for(var M,B=v[Symbol.iterator]();!(S=(M=B.next()).done);S=!0){var P=M.value,L={repeat:C,row:R,column:P,layer:c.layer},j=(a.name||"")+p+"child__"+(d.default(r)?"".concat(E.varName(C)):(r.row?"row_".concat(E.varName(R)):"")+(r.column?"column_".concat(E.varName(P)):"")),z=this.map(a,Object.assign(Object.assign({},t),{repeater:L,repeaterPrefix:j}));z.name=j,u.push(E.omit(z,["data"]))}}catch(e){N=!0,T=e}finally{try{S||null==B.return||B.return()}finally{if(N)throw T}}}}catch(e){F=!0,O=e}finally{try{D||null==I.return||I.return()}finally{if(F)throw O}}}}catch(e){b=!0,k=e}finally{try{m||null==A.return||A.return()}finally{if(b)throw k}}var U=d.default(r)?e.columns:r.column?r.column.length:1;return Object.assign(Object.assign({data:null!==(n=a.data)&&void 0!==n?n:i,align:"all"},o),{columns:U,concat:u})}},{key:"mapFacet",value:function(e,t){var r=e.facet;return b.isFacetMapping(r)&&e.columns&&(e=E.omit(e,["columns"]),y.warn(x.columnsNotSupportByRowCol("facet"))),u.default(c.default(n.prototype),"mapFacet",this).call(this,e,t)}},{key:"mapUnitWithParentEncodingOrProjection",value:function(e,t){var n=e.encoding,r=e.projection,a=t.parentEncoding,i=t.parentProjection,o=t.config,u=O({parentProjection:i,projection:r}),s=F({parentEncoding:a,encoding:N.replaceRepeaterInEncoding(n,t.repeater)});return this.mapUnit(Object.assign(Object.assign(Object.assign({},e),u?{projection:u}:{}),s?{encoding:s}:{}),{config:o})}},{key:"mapFacetedUnit",value:function(e,t){var n=e.encoding,r=n.row,a=n.column,i=n.facet,o=f.__rest(n,["row","column","facet"]),u=e.mark,s=e.width,c=e.projection,l=e.height,d=e.view,p=e.selection,h=(e.encoding,f.__rest(e,["mark","width","projection","height","view","selection","encoding"])),v=this.getFacetMappingAndLayout({row:r,column:a,facet:i},t),g=v.facetMapping,m=v.layout,y=N.replaceRepeaterInEncoding(o,t.repeater);return this.mapFacet(Object.assign(Object.assign(Object.assign({},h),m),{facet:g,spec:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},s?{width:s}:{}),l?{height:l}:{}),d?{view:d}:{}),c?{projection:c}:{}),{mark:u,encoding:y}),p?{selection:p}:{})}),t)}},{key:"getFacetMappingAndLayout",value:function(e,t){var n,r=e.row,a=e.column,i=e.facet;if(r||a){i&&y.warn(x.facetChannelDropped(l.default(r?[p.ROW]:[]).concat(l.default(a?[p.COLUMN]:[]))));var o={},u={},s=!0,c=!1,d=void 0;try{for(var h,v=[p.ROW,p.COLUMN][Symbol.iterator]();!(s=(h=v.next()).done);s=!0){var g=h.value,m=e[g];if(m){m.align,m.center,m.spacing,m.columns;var b=f.__rest(m,["align","center","spacing","columns"]);o[g]=b;var k=!0,w=!1,A=void 0;try{for(var E,C=["align","center","spacing"][Symbol.iterator]();!(k=(E=C.next()).done);k=!0){var S=E.value;void 0!==m[S]&&(u[S]=null!==(n=u[S])&&void 0!==n?n:{},u[S][g]=m[S])}}catch(e){w=!0,A=e}finally{try{k||null==C.return||C.return()}finally{if(w)throw A}}}}}catch(e){c=!0,d=e}finally{try{s||null==v.return||v.return()}finally{if(c)throw d}}return{facetMapping:o,layout:u}}var T=i.align,D=i.center,F=i.spacing,O=i.columns,_=f.__rest(i,["align","center","spacing","columns"]);return{facetMapping:N.replaceRepeaterInFacet(_,t.repeater),layout:Object.assign(Object.assign(Object.assign(Object.assign({},T?{align:T}:{}),D?{center:D}:{}),F?{spacing:F}:{}),O?{columns:O}:{})}}},{key:"mapLayer",value:function(e,t){var r=t.parentEncoding,a=t.parentProjection,i=f.__rest(t,["parentEncoding","parentProjection"]),o=e.encoding,s=e.projection,l=f.__rest(e,["encoding","projection"]),d=Object.assign(Object.assign({},i),{parentEncoding:F({parentEncoding:r,encoding:o}),parentProjection:O({parentProjection:a,projection:s})});return u.default(c.default(n.prototype),"mapLayer",this).call(this,l,d)}}]),n}(k.SpecMapper);function F(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=E.keys(t).reduce((function(e,t){return n[t]&&e.push(t),e}),[]);r.length>0&&y.warn(x.encodingOverridden(r))}var a=Object.assign(Object.assign({},null!=t?t:{}),null!=n?n:{});return E.isEmpty(a)?void 0:a}function O(e){var t=e.parentProjection,n=e.projection;return t&&n&&y.warn(x.projectionOverridden({parentProjection:t,projection:n})),null!=n?n:t}})),s.register("7vDGT",(function(e,t){n(e.exports,"SpecMapper",(function(){return p})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("2lx0N");s("16rNM");var o=s("2x4HI"),u=s("e0srg"),c=s("pZnnI"),l=s("1sD9J"),f=s("7DQpg"),d=s("aIH68"),p=function(){"use strict";function e(){r.default(this,e)}return a.default(e,[{key:"map",value:function(e,t){return c.isFacetSpec(e)?this.mapFacet(e,t):f.isRepeatSpec(e)?this.mapRepeat(e,t):u.isHConcatSpec(e)?this.mapHConcat(e,t):u.isVConcatSpec(e)?this.mapVConcat(e,t):u.isConcatSpec(e)?this.mapConcat(e,t):this.mapLayerOrUnit(e,t)}},{key:"mapLayerOrUnit",value:function(e,t){if(l.isLayerSpec(e))return this.mapLayer(e,t);if(d.isUnitSpec(e))return this.mapUnit(e,t);throw new Error(o.invalidSpec(e))}},{key:"mapLayer",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{layer:e.layer.map((function(e){return n.mapLayerOrUnit(e,t)}))})}},{key:"mapHConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{hconcat:e.hconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapVConcat",value:function(e,t){var n=this;return Object.assign(Object.assign({},e),{vconcat:e.vconcat.map((function(e){return n.map(e,t)}))})}},{key:"mapConcat",value:function(e,t){var n=this,r=e.concat,a=i.__rest(e,["concat"]);return Object.assign(Object.assign({},a),{concat:r.map((function(e){return n.map(e,t)}))})}},{key:"mapFacet",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}},{key:"mapRepeat",value:function(e,t){return Object.assign(Object.assign({},e),{spec:this.map(e.spec,t)})}}]),e}()})),s.register("c5FVc",(function(e,t){n(e.exports,"PathOverlayNormalizer",(function(){return m})),s("1i51P");var r=s("4Ui3v"),a=s("3QOYJ"),i=s("2tuUj"),o=s("2lx0N");s("iSlfb");var u=s("bZ6XL"),c=s("4sOzK"),l=s("aIH68"),f=s("0RcIy"),d=s("lSb9O");function p(e){e.point,e.line;var t=o.__rest(e,["point","line"]);return d.keys(t).length>1?t:t.type}function h(e){var t=!0,n=!1,a=void 0;try{for(var i,o=["line","area","rule","trail"][Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value;e[u]&&(e=Object.assign(Object.assign({},e),r.default({},u,d.omit(e[u],["point","line"]))))}}catch(e){n=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return e}function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;return"transparent"===e.point?{opacity:0}:e.point?u.default(e.point)?e.point:{}:void 0!==e.point?null:t.point||n.shape?u.default(t.point)?t.point:{}:void 0}function g(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.line?!0===e.line?{}:e.line:void 0!==e.line?null:t.line?!0===t.line?{}:t.line:void 0}var m=function(){"use strict";function e(){a.default(this,e),this.name="path-overlay"}return i.default(e,[{key:"hasMatchingType",value:function(e,t){if(l.isUnitSpec(e)){var n=e.mark,r=e.encoding,a=c.isMarkDef(n)?n:{type:n};switch(a.type){case"line":case"rule":case"trail":return!!v(a,t[a.type],r);case"area":return!!v(a,t[a.type],r)||!!g(a,t[a.type])}}return!1}},{key:"run",value:function(e,t,n){var a=t.config,i=e.selection,u=e.projection,s=e.encoding,l=e.mark,m=o.__rest(e,["selection","projection","encoding","mark"]),y=c.isMarkDef(l)?l:{type:l},x=v(y,a[y.type],s),b="area"===y.type&&g(y,a[y.type]),k=[Object.assign(Object.assign({},i?{selection:i}:{}),{mark:p(Object.assign(Object.assign({},"area"===y.type&&void 0===y.opacity&&void 0===y.fillOpacity?{opacity:.7}:{}),y)),encoding:d.omit(s,["shape"])})],w=f.stack(y,s),A=s;if(w){var E=w.fieldChannel,C=w.offset;A=Object.assign(Object.assign({},s),r.default({},E,Object.assign(Object.assign({},s[E]),C?{stack:C}:{})))}return b&&k.push(Object.assign(Object.assign({},u?{projection:u}:{}),{mark:Object.assign(Object.assign({type:"line"},d.pick(y,["clip","interpolate","tension","tooltip"])),b),encoding:A})),x&&k.push(Object.assign(Object.assign({},u?{projection:u}:{}),{mark:Object.assign(Object.assign({type:"point",opacity:1,filled:!0},d.pick(y,["clip","tooltip"])),x),encoding:A})),n(Object.assign(Object.assign({},m),{layer:k}),Object.assign(Object.assign({},t),{config:h(a)}))}}]),e}()})),s.register("0RcIy",(function(e,t){n(e.exports,"stack",(function(){return k})),s("iSlfb");var r=s("1Ihp0"),a=s("iRIM1"),i=s("6jZCp"),o=s("e3OyN"),u=s("iooJ7"),c=s("jQ4iQ"),l=s("16rNM"),f=s("2x4HI"),d=s("4sOzK"),p=s("7J7Lf"),h=s("lSb9O"),v={zero:1,center:1,normalize:1};function g(e){return e in v}var m=new Set([d.ARC,d.BAR,d.AREA,d.RULE,d.POINT,d.CIRCLE,d.SQUARE,d.LINE,d.TEXT,d.TICK]),y=new Set([d.BAR,d.AREA,d.ARC]);function x(e,t){var n,r,a="x"===t?"y":"radius",i=e[t],o=e[a];if(u.isFieldDef(i)&&u.isFieldDef(o))if("quantitative"===u.channelDefType(i)&&"quantitative"===u.channelDefType(o)){if(i.stack)return t;if(o.stack)return a;var s=u.isFieldDef(i)&&!!i.aggregate;if(s!==(u.isFieldDef(o)&&!!o.aggregate))return s?t:a;var c=null===(n=i.scale)||void 0===n?void 0:n.type,l=null===(r=o.scale)||void 0===r?void 0:r.type;if(c&&"linear"!==c)return a;if(l&&"linear"!==l)return t}else{if("quantitative"===u.channelDefType(i))return t;if("quantitative"===u.channelDefType(o))return a}else{if("quantitative"===u.channelDefType(i))return t;if("quantitative"===u.channelDefType(o))return a}}function b(e){switch(e){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=d.isMarkDef(e)?e.type:e;if(!m.has(s))return null;var v=x(t,"x")||x(t,"theta");if(!v)return null;var k=t[v],w=u.isFieldDef(k)?u.vgField(k,{}):void 0,A=b(v),E=t[A],C=u.isFieldDef(E)?u.vgField(E,{}):void 0;C===w&&(C=void 0,E=void 0,A=void 0);var S,N=o.NONPOSITION_CHANNELS.reduce((function(e,n){if("tooltip"!==n&&c.channelHasField(t,n)){var a=t[n],i=!0,o=!1,s=void 0;try{for(var l,f=r.default(a)[Symbol.iterator]();!(i=(l=f.next()).done);i=!0){var d=l.value,p=u.getFieldDef(d);if(!p.aggregate){var h=u.vgField(p,{});h&&h===C||e.push({channel:n,fieldDef:p})}}}catch(e){o=!0,s=e}finally{try{i||null==f.return||f.return()}finally{if(o)throw s}}}return e}),[]);if(void 0!==k.stack?S=a.default(k.stack)?k.stack?"zero":null:k.stack:N.length>0&&y.has(s)&&(S="zero"),!S||!g(S))return null;if(c.isAggregate(t)&&0===N.length)return null;if(k.scale&&k.scale.type&&k.scale.type!==p.ScaleType.LINEAR){if(n.disallowNonLinearStack)return null;l.warn(f.cannotStackNonLinearScale(k.scale.type))}return u.isFieldOrDatumDef(t[o.getSecondaryRangeChannel(v)])?(void 0!==k.stack&&l.warn(f.cannotStackRangedMark(v)),null):(u.isFieldDef(k)&&k.aggregate&&!h.contains(i.SUM_OPS,k.aggregate)&&l.warn(f.stackNonSummativeAggregate(k.aggregate)),{groupbyChannel:E?A:void 0,groupbyField:C,fieldChannel:v,impute:null!==k.impute&&d.isPathMark(s),stackBy:N,offset:S})}})),s.register("3ehCB",(function(e,t){n(e.exports,"RangeStepNormalizer",(function(){return h})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("4Ui3v"),o=s("2lx0N"),u=s("e3OyN"),c=s("iooJ7"),l=s("16rNM"),f=s("2x4HI"),d=s("aIH68"),p=s("lSb9O"),h=function(){"use strict";function e(){r.default(this,e),this.name="RangeStep"}return a.default(e,[{key:"hasMatchingType",value:function(e){var t,n=!0,r=!1,a=void 0;if(d.isUnitSpec(e)&&e.encoding)try{for(var i,o=u.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,l=e.encoding[s];if(l&&c.isFieldOrDatumDef(l)&&(null===(t=null==l?void 0:l.scale)||void 0===t?void 0:t.rangeStep))return!0}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return!1}},{key:"run",value:function(e){var t,n={},r=Object.assign({},e.encoding),a=!0,s=!1,d=void 0;try{for(var h,v=u.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(a=(h=v.next()).done);a=!0){var g=h.value,m=u.getSizeChannel(g),y=r[g];if(y&&c.isFieldOrDatumDef(y)&&(null===(t=null==y?void 0:y.scale)||void 0===t?void 0:t.rangeStep)){var x=y.scale,b=o.__rest(y,["scale"]),k=x,w=(k.rangeStep,o.__rest(k,["rangeStep"]));n[m]={step:x.rangeStep},l.warn(f.RANGE_STEP_DEPRECATED),r=Object.assign(Object.assign({},r),i.default({},g,Object.assign(Object.assign({},b),p.isEmpty(w)?{}:{scale:w})))}}}catch(e){s=!0,d=e}finally{try{a||null==v.return||v.return()}finally{if(s)throw d}}return Object.assign(Object.assign(Object.assign({},n),e),{encoding:r})}}]),e}()})),s.register("6r5YL",(function(e,t){n(e.exports,"replaceRepeaterInFacet",(function(){return p})),n(e.exports,"replaceRepeaterInEncoding",(function(){return h})),s("1i51P");var r=s("4Ui3v"),a=s("2lx0N");s("iSlfb");var i=s("b1OzQ"),o=s("4ujSI"),u=s("iooJ7"),c=s("16rNM"),l=s("2x4HI"),f=s("2V3EF"),d=s("pZnnI");function p(e,t){return t?d.isFacetMapping(e)?x(e,t):g(e,t):e}function h(e,t){return t?x(e,t):e}function v(e,t,n){var a=t[e];return u.isRepeatRef(a)?a.repeat in n?Object.assign(Object.assign({},t),r.default({},e,n[a.repeat])):void c.warn(l.noSuchRepeatedValue(a.repeat)):t}function g(e,t){if(void 0!==(e=v("field",e,t))){if(null===e)return null;if(u.isSortableFieldDef(e)&&f.isSortField(e.sort)){var n=v("field",e.sort,t);e=Object.assign(Object.assign({},e),n?{sort:n}:{})}return e}}function m(e,t){if(u.isFieldDef(e))return g(e,t);var n=v("datum",e,t);return n===e||n.type||(n.type="nominal"),n}function y(e,t){if(!u.isFieldOrDatumDef(e)){if(u.hasConditionalFieldOrDatumDef(e)){var n=m(e.condition,t);if(n)return Object.assign(Object.assign({},e),{condition:n});e.condition;return a.__rest(e,["condition"])}return e}var r=m(e,t);return r||(u.isConditionalDef(e)?{condition:e.condition}:void 0)}function x(e,t){var n={};for(var r in e)if(i.default(e,r)){var a=e[r];if(o.default(a))n[r]=a.map((function(e){return y(e,t)})).filter((function(e){return e}));else{var u=y(a,t);void 0!==u&&(n[r]=u)}}return n}})),s.register("eteUa",(function(e,t){n(e.exports,"RuleForRangedLineNormalizer",(function(){return d})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("61RXI"),o=s("e3OyN"),u=s("iooJ7"),c=s("16rNM"),l=s("2x4HI"),f=s("aIH68"),d=function(){"use strict";function e(){r.default(this,e),this.name="RuleForRangedLine"}return a.default(e,[{key:"hasMatchingType",value:function(e){if(f.isUnitSpec(e)){var t=e.encoding,n=!0,r=!1,a=void 0;if("line"===e.mark)try{for(var s,c=o.SECONDARY_RANGE_CHANNEL[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var l=s.value,d=t[o.getMainRangeChannel(l)];if(t[l]&&(u.isFieldDef(d)&&!i.isBinned(d.bin)||u.isDatumDef(d)))return!0}}catch(e){r=!0,a=e}finally{try{n||null==c.return||c.return()}finally{if(r)throw a}}}return!1}},{key:"run",value:function(e,t,n){var r=e.encoding;return c.warn(l.lineWithRange(!!r.x2,!!r.y2)),n(Object.assign(Object.assign({},e),{mark:"rule"}),t)}}]),e}()})),s.register("3pmRX",(function(e,t){n(e.exports,"compile",(function(){return y})),s("1i51P");var r=s("9M1dW");s("iSlfb");var a=s("krpEv"),i=s("fCSiB"),o=s("e3OyN"),u=s("iooJ7"),c=s("fldOo"),l=s("16rNM"),f=s("2x4HI"),d=s("5oqYo"),p=s("a6koz"),h=s("lSb9O"),v=s("lqDEC"),g=s("03p0t"),m=s("XTLnN");function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.logger&&l.set(t.logger),t.fieldTitle&&u.setTitleFormatter(t.fieldTitle);try{var n=c.initConfig(a.mergeConfig(t.config,e.config)),r=d.normalize(e,n),i=v.buildModel(r,null,"",void 0,n);i.parse(),m.optimizeDataflow(i.component.data,i);var o=b(i,x(e,r.autosize,n,i),e.datasets,e.usermeta);return{spec:o,normalized:r}}finally{t.logger&&l.reset(),t.fieldTitle&&u.resetTitleFormatter()}}function x(e,t,n,r){var a=r.component.layoutSize.get("width"),u=r.component.layoutSize.get("height");if(void 0===t?(t={type:"pad"},r.hasAxisOrientSignalRef()&&(t.resize=!0)):i.default(t)&&(t={type:t}),a&&u&&p.isFitType(t.type))if("step"===a&&"step"===u)l.warn(f.droppingFit()),t.type="pad";else if("step"===a||"step"===u){var s="step"===a?"width":"height";l.warn(f.droppingFit(o.getPositionScaleChannel(s)));var c="width"===s?"height":"width";t.type=p.getFitType(c)}return Object.assign(Object.assign(Object.assign({},1===h.keys(t).length&&t.type?"pad"===t.type?{}:{autosize:t.type}:{autosize:t}),p.extractTopLevelProperties(n)),p.extractTopLevelProperties(e))}function b(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,i=e.config?c.stripAndRedirectConfig(e.config):void 0,o=[].concat(e.assembleSelectionData([]),g.assembleRootData(e.component.data,n)),u=e.assembleProjections(),s=e.assembleTitle(),l=e.assembleGroupStyle(),f=e.assembleGroupEncodeEntry(!0),d=e.assembleLayoutSignals();return d=d.filter((function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)})),Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({$schema:"https://vega.github.io/schema/vega/v5.json"},e.description?{description:e.description}:{}),t),s?{title:s}:{}),l?{style:l}:{}),f?{encode:{update:f}}:{}),{data:o}),u.length>0?{projections:u}:{}),e.assembleGroup(r.default(d).concat(r.default(e.assembleSelectionTopLevelSignals([]))))),i?{config:i}:{}),a?{usermeta:a}:{})}})),s.register("a6koz",(function(e,t){n(e.exports,"isFitType",(function(){return a})),n(e.exports,"getFitType",(function(){return i})),n(e.exports,"extractTopLevelProperties",(function(){return u}));var r=s("e3OyN");function a(e){return"fit"===e||"fit-x"===e||"fit-y"===e}function i(e){return e?"fit-".concat(r.getPositionScaleChannel(e)):"fit"}var o=["background","padding"];function u(e){return o.reduce((function(t,n){return e&&void 0!==e[n]&&(t[n]=e[n]),t}),{})}})),s.register("lqDEC",(function(e,t){n(e.exports,"buildModel",(function(){return p})),s("16rNM");var r=s("2x4HI");s("gLFCo");var a=s("pZnnI"),i=s("1sD9J"),o=s("aIH68"),u=s("e0srg"),c=s("hjixe"),l=s("hSDND"),f=s("JHpzO"),d=s("lAgVt");function p(e,t,n,s,p){if(a.isFacetSpec(e))return new l.FacetModel(e,t,n,p);if(i.isLayerSpec(e))return new f.LayerModel(e,t,n,s,p);if(o.isUnitSpec(e))return new d.UnitModel(e,t,n,s,p);if(u.isAnyConcatSpec(e))return new c.ConcatModel(e,t,n,p);throw new Error(r.invalidSpec(e))}})),s.register("hjixe",(function(e,t){n(e.exports,"ConcatModel",(function(){return y})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("jZS3C"),u=s("2tuUj"),c=s("9M1dW"),l=s("16rNM"),f=s("2x4HI");s("gLFCo");var d=s("e0srg"),p=s("lSb9O"),h=s("lqDEC"),v=s("2zW61"),g=s("iUaCf"),m=s("lWXej"),y=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,u){var s,c,d,p,v;return i.default(this,n),s=t.call(this,e,"concat",r,a,u,e.resolve),"shared"!==(null===(d=null===(c=e.resolve)||void 0===c?void 0:c.axis)||void 0===d?void 0:d.x)&&"shared"!==(null===(v=null===(p=e.resolve)||void 0===p?void 0:p.axis)||void 0===v?void 0:v.y)||l.warn(f.CONCAT_CANNOT_SHARE_AXIS),s.children=s.getChildren(e).map((function(e,t){return h.buildModel(e,o.default(s),s.getName("concat_"+t),void 0,u)})),s}return u.default(n,[{key:"parseData",value:function(){this.component.data=v.parseData(this);var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.parseData()}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"parseSelections",value:function(){this.component.selection={};var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var i=r.value;i.parseSelections();var o=!0,u=!1,s=void 0;try{for(var c,l=p.keys(i.component.selection)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;this.component.selection[f]=i.component.selection[f]}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"parseMarkGroup",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.parseMarkGroup()}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"parseAxesAndHeaders",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.parseAxesAndHeaders()}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"getChildren",value:function(e){return d.isVConcatSpec(e)?e.vconcat:d.isHConcatSpec(e)?e.hconcat:e.concat}},{key:"parseLayoutSize",value:function(){m.parseConcatLayoutSize(this)}},{key:"parseAxisGroup",value:function(){return null}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.forEach((function(e){return e.assembleSignals()})),[]}},{key:"assembleLayoutSignals",value:function(){var e,t=g.assembleLayoutSignals(this),n=!0,r=!1,a=void 0;try{for(var i,o=this.children[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;(e=t).push.apply(e,c.default(u.assembleLayoutSignals()))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleMarks",value:function(){return this.children.map((function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleGroupEncodeEntry(!1);return Object.assign(Object.assign(Object.assign(Object.assign({type:"group",name:e.getName("group")},t?{title:t}:{}),n?{style:n}:{}),r?{encode:{update:r}}:{}),e.assembleGroup())}))}},{key:"assembleDefaultLayout",value:function(){var e=this.layout.columns;return Object.assign(Object.assign({},null!=e?{columns:e}:{}),{bounds:"full",align:"each"})}}]),n}(s("jZr2L").Model)})),s.register("2zW61",(function(e,t){n(e.exports,"findSource",(function(){return W})),n(e.exports,"parseData",(function(){return G})),s("1i51P");var r=s("4Ui3v"),a=s("59M3q"),i=s("1Z7Bs"),o=s("16rNM"),u=s("2x4HI"),c=s("4gSyH"),l=s("lSb9O"),f=s("jZr2L"),d=s("aukhr"),p=s("4dGY7"),h=s("dQfAT"),v=s("4ewT3"),g=s("fFVzC"),m=s("5XgHP"),y=s("jjYLQ"),x=s("fPIRu"),b=s("dD9t5"),k=s("gwoKC"),w=s("cChH7"),A=s("5zs9z"),E=s("lmM4C"),C=s("5I9U7"),S=s("4xXhT"),N=s("XZnM9"),T=s("4gRNk"),D=s("aWQzg"),F=s("e0CR6"),O=s("gJd0d"),_=s("bXLC3"),I=s("7fj9G"),R=s("ewe31"),M=s("hke9K"),B=s("iVWNn"),P=s("ajBw6"),L=s("5HdXV"),j=s("cYGz2"),z=s("gR1OF"),U=s("bAeeP"),V=s("hijEA");function W(e,t){var n,r,a,o,u,s,c,f,d,p,h=!0,v=!1,g=void 0;try{for(var m,y=t[Symbol.iterator]();!(h=(m=y.next()).done);h=!0){var x=m.value,b=x.data;if((!e.name||!x.hasName()||e.name===x.dataName)&&!((null===(n=e.format)||void 0===n?void 0:n.mesh)&&(null===(r=b.format)||void 0===r?void 0:r.feature)||((null===(a=e.format)||void 0===a?void 0:a.feature)||(null===(o=b.format)||void 0===o?void 0:o.feature))&&(null===(u=e.format)||void 0===u?void 0:u.feature)!==(null===(s=b.format)||void 0===s?void 0:s.feature)||((null===(c=e.format)||void 0===c?void 0:c.mesh)||(null===(f=b.format)||void 0===f?void 0:f.mesh))&&(null===(d=e.format)||void 0===d?void 0:d.mesh)!==(null===(p=b.format)||void 0===p?void 0:p.mesh)))if(i.isInlineData(e)&&i.isInlineData(b)){if(l.deepEqual(e.values,b.values))return x}else if(i.isUrlData(e)&&i.isUrlData(b)){if(e.url===b.url)return x}else if(i.isNamedData(e)&&e.name===x.dataName)return x}}catch(e){v=!0,g=e}finally{try{h||null==y.return||y.return()}finally{if(v)throw g}}return null}function G(e){var t,n,s,G,H,q,J,K,X,Y,Q=function(e,t){if(e.data||!e.parent){if(null===e.data){var n=new j.SourceNode({values:[]});return t.push(n),n}var r=W(e.data,t);if(r)return i.isGenerator(e.data)||(r.data.format=l.mergeDeep({},e.data.format,r.data.format)),!r.hasName()&&e.data.name&&(r.dataName=e.data.name),r;var a=new j.SourceNode(e.data);return t.push(a),a}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources),Z=e.component.data,$=Z.outputNodes,ee=Z.outputNodeRefCounts,te=e.parent?e.parent.component.data.ancestorParse.clone():new a.AncestorParse,ne=e.data;i.isGenerator(ne)?(i.isSequenceGenerator(ne)?Q=new L.SequenceNode(Q,ne.sequence):i.isGraticuleGenerator(ne)&&(Q=new N.GraticuleNode(Q,ne.graticule)),te.parseNothing=!0):null===(null===(t=null==ne?void 0:ne.format)||void 0===t?void 0:t.parse)&&(te.parseNothing=!0),Q=null!==(n=E.ParseNode.makeExplicit(Q,e,te))&&void 0!==n?n:Q,Q=new T.IdentifierNode(Q);var re=e.parent&&f.isLayerModel(e.parent);(f.isUnitModel(e)||f.isFacetModel(e))&&re&&(Q=null!==(s=v.BinNode.makeFromEncoding(Q,e))&&void 0!==s?s:Q),e.transforms.length>0&&(Q=function(e,t,n){var a,i,s=0,l=!0,f=!1,p=void 0;try{for(var m,x=t.transforms[Symbol.iterator]();!(l=(m=x.next()).done);l=!0){var k=m.value,C=void 0,S=void 0;if(c.isCalculate(k))S=e=new g.CalculateNode(e,k),C="derived";else if(c.isFilter(k)){var N=E.getImplicitFromFilterTransform(k);S=e=null!==(a=E.ParseNode.makeWithAncestors(e,{},N,n))&&void 0!==a?a:e,e=new b.FilterNode(e,t,k.filter)}else if(c.isBin(k))S=e=v.BinNode.makeFromTransform(e,k,t),C="number";else if(c.isTimeUnit(k))C="date",void 0===n.getWithExplicit(k.field).value&&(e=new E.ParseNode(e,r.default({},k.field,C)),n.set(k.field,C,!1)),S=e=U.TimeUnitNode.makeFromTransform(e,k);else if(c.isAggregate(k))S=e=h.AggregateNode.makeFromTransform(e,k),C="number",d.requiresSelectionId(t)&&(e=new T.IdentifierNode(e));else if(c.isLookup(k))S=e=I.LookupNode.make(e,t,k,s++),C="derived";else if(c.isWindow(k))S=e=new V.WindowTransformNode(e,k),C="number";else if(c.isJoinAggregate(k))S=e=new F.JoinAggregateTransformNode(e,k),C="number";else if(c.isStack(k))S=e=z.StackNode.makeFromTransform(e,k),C="derived";else if(c.isFold(k))S=e=new A.FoldTransformNode(e,k),C="derived";else if(c.isFlatten(k))S=e=new w.FlattenTransformNode(e,k),C="derived";else if(c.isPivot(k))S=e=new R.PivotTransformNode(e,k),C="derived";else if(c.isSample(k))e=new P.SampleTransformNode(e,k);else if(c.isImpute(k))S=e=D.ImputeNode.makeFromTransform(e,k),C="derived";else if(c.isDensity(k))S=e=new y.DensityTransformNode(e,k),C="derived";else if(c.isQuantile(k))S=e=new M.QuantileTransformNode(e,k),C="derived";else if(c.isRegression(k))S=e=new B.RegressionTransformNode(e,k),C="derived";else{if(!c.isLoess(k)){o.warn(u.invalidTransformIgnored(k));continue}S=e=new _.LoessTransformNode(e,k),C="derived"}var O=!0,L=!1,j=void 0;if(S&&void 0!==C)try{for(var W,G=(null!==(i=S.producedFields())&&void 0!==i?i:[])[Symbol.iterator]();!(O=(W=G.next()).done);O=!0){var H=W.value;n.set(H,C,!1)}}catch(e){L=!0,j=e}finally{try{O||null==G.return||G.return()}finally{if(L)throw j}}}}catch(e){f=!0,p=e}finally{try{l||null==x.return||x.return()}finally{if(f)throw p}}return e}(Q,e,te));var ae=E.getImplicitFromSelection(e),ie=E.getImplicitFromEncoding(e);Q=null!==(G=E.ParseNode.makeWithAncestors(Q,{},Object.assign(Object.assign({},ae),ie),te))&&void 0!==G?G:Q,f.isUnitModel(e)&&(Q=C.GeoJSONNode.parseAll(Q,e),Q=S.GeoPointNode.parseAll(Q,e)),(f.isUnitModel(e)||f.isFacetModel(e))&&(re||(Q=null!==(H=v.BinNode.makeFromEncoding(Q,e))&&void 0!==H?H:Q),Q=null!==(q=U.TimeUnitNode.makeFromEncoding(Q,e))&&void 0!==q?q:Q,Q=g.CalculateNode.parseAllForSortIndex(Q,e));var oe=e.getName(i.RAW),ue=new m.OutputNode(Q,oe,i.RAW,ee);if($[oe]=ue,Q=ue,f.isUnitModel(e)){var se=h.AggregateNode.makeFromEncoding(Q,e);se&&(Q=se,d.requiresSelectionId(e)&&(Q=new T.IdentifierNode(Q))),Q=null!==(J=D.ImputeNode.makeFromEncoding(Q,e))&&void 0!==J?J:Q,Q=null!==(K=z.StackNode.makeFromEncoding(Q,e))&&void 0!==K?K:Q}f.isUnitModel(e)&&(Q=null!==(X=k.FilterInvalidNode.make(Q,e))&&void 0!==X?X:Q);var ce=e.getName(i.MAIN),le=new m.OutputNode(Q,ce,i.MAIN,ee);$[ce]=le,Q=le,f.isUnitModel(e)&&p.materializeSelections(e,le);var fe=null;if(f.isFacetModel(e)){var de=e.getName("facet");Q=null!==(Y=O.makeJoinAggregateFromFacet(Q,e.facet))&&void 0!==Y?Y:Q,fe=new x.FacetNode(Q,e,de,le.getSource()),$[de]=fe}return Object.assign(Object.assign({},e.component.data),{outputNodes:$,outputNodeRefCounts:ee,raw:ue,main:le,facetRoot:fe,ancestorParse:te})}})),s.register("59M3q",(function(e,t){n(e.exports,"AncestorParse",(function(){return l})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("kRKWT"),c=s("eYQ8O"),l=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i.default(this,n),(e=t.call(this,r,a)).explicit=r,e.implicit=a,e.parseNothing=o,e}return o.default(n,[{key:"clone",value:function(){var e=u.default(c.default(n.prototype),"clone",this).call(this);return e.parseNothing=this.parseNothing,e}}]),n}(s("CFwcG").Split)})),s.register("CFwcG",(function(e,t){n(e.exports,"Split",(function(){return c})),n(e.exports,"makeExplicit",(function(){return l})),n(e.exports,"makeImplicit",(function(){return f})),n(e.exports,"tieBreakByComparing",(function(){return d})),n(e.exports,"defaultTieBreaker",(function(){return p})),n(e.exports,"mergeValuesWithExplicit",(function(){return h})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("16rNM"),o=s("2x4HI"),u=s("lSb9O"),c=function(){"use strict";function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.default(this,e),this.explicit=t,this.implicit=n}return a.default(e,[{key:"clone",value:function(){return new e(u.duplicate(this.explicit),u.duplicate(this.implicit))}},{key:"combine",value:function(){return Object.assign(Object.assign({},this.explicit),this.implicit)}},{key:"get",value:function(e){return u.getFirstDefined(this.explicit[e],this.implicit[e])}},{key:"getWithExplicit",value:function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}}},{key:"setWithExplicit",value:function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)}},{key:"set",value:function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this}},{key:"copyKeyFromSplit",value:function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)}},{key:"copyKeyFromObject",value:function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)}},{key:"copyAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=u.keys(e.combine())[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,s=e.getWithExplicit(o);this.setWithExplicit(o,s)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}}]),e}();function l(e){return{explicit:!0,value:e}}function f(e){return{explicit:!1,value:e}}function d(e){return function(t,n,r,a){var i=e(t.value,n.value);return i>0?t:i<0?n:p(t,n,r,a)}}function p(e,t,n,r){return e.explicit&&t.explicit&&i.warn(o.mergeConflictingProperty(n,r,e.value,t.value)),e}function h(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:p;return void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:u.deepEqual(e.value,t.value)?e:a(e,t,n,r)}})),s.register("1Z7Bs",(function(e,t){function r(e){return"url"in e}function a(e){return"values"in e}function i(e){return"name"in e&&!r(e)&&!a(e)&&!o(e)}function o(e){return e&&(u(e)||s(e)||c(e))}function u(e){return"sequence"in e}function s(e){return"sphere"in e}function c(e){return"graticule"in e}n(e.exports,"isUrlData",(function(){return r})),n(e.exports,"isInlineData",(function(){return a})),n(e.exports,"isNamedData",(function(){return i})),n(e.exports,"isGenerator",(function(){return o})),n(e.exports,"isSequenceGenerator",(function(){return u})),n(e.exports,"isSphereGenerator",(function(){return s})),n(e.exports,"isGraticuleGenerator",(function(){return c})),n(e.exports,"MAIN",(function(){return l})),n(e.exports,"RAW",(function(){return f}));var l="main",f="raw"})),s.register("4gSyH",(function(e,t){n(e.exports,"isFilter",(function(){return i})),n(e.exports,"isImputeSequence",(function(){return o})),n(e.exports,"isLookup",(function(){return u})),n(e.exports,"isLookupData",(function(){return c})),n(e.exports,"isLookupSelection",(function(){return l})),n(e.exports,"isPivot",(function(){return f})),n(e.exports,"isDensity",(function(){return d})),n(e.exports,"isQuantile",(function(){return p})),n(e.exports,"isRegression",(function(){return h})),n(e.exports,"isLoess",(function(){return v})),n(e.exports,"isSample",(function(){return g})),n(e.exports,"isWindow",(function(){return m})),n(e.exports,"isJoinAggregate",(function(){return y})),n(e.exports,"isFlatten",(function(){return x})),n(e.exports,"isCalculate",(function(){return b})),n(e.exports,"isBin",(function(){return k})),n(e.exports,"isImpute",(function(){return w})),n(e.exports,"isTimeUnit",(function(){return A})),n(e.exports,"isAggregate",(function(){return E})),n(e.exports,"isStack",(function(){return C})),n(e.exports,"isFold",(function(){return S})),n(e.exports,"normalizeTransform",(function(){return N}));var r=s("12Yae"),a=s("ceGn0");function i(e){return"filter"in e}function o(e){return void 0!==(null==e?void 0:e.stop)}function u(e){return"lookup"in e}function c(e){return"data"in e}function l(e){return"selection"in e}function f(e){return"pivot"in e}function d(e){return"density"in e}function p(e){return"quantile"in e}function h(e){return"regression"in e}function v(e){return"loess"in e}function g(e){return"sample"in e}function m(e){return"window"in e}function y(e){return"joinaggregate"in e}function x(e){return"flatten"in e}function b(e){return"calculate"in e}function k(e){return"bin"in e}function w(e){return"impute"in e}function A(e){return"timeUnit"in e}function E(e){return"aggregate"in e}function C(e){return"stack"in e}function S(e){return"fold"in e}function N(e){return e.map((function(e){return i(e)?{filter:r.normalizeLogicalComposition(e.filter,a.normalizePredicate)}:e}))}})),s.register("jZr2L",(function(e,t){n(e.exports,"isUnitModel",(function(){return B})),n(e.exports,"isFacetModel",(function(){return P})),n(e.exports,"isConcatModel",(function(){return L})),n(e.exports,"isLayerModel",(function(){return j})),n(e.exports,"Model",(function(){return z})),n(e.exports,"ModelWithField",(function(){return U})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("2vsUb"),o=s("d6iiX"),u=s("2lx0N"),c=s("e3OyN"),l=s("iooJ7"),f=s("jQ4iQ"),d=s("16rNM"),p=s("2x4HI"),h=s("7J7Lf");s("gLFCo");var v=s("pZnnI"),g=s("eg4js"),m=s("aiwuu"),y=s("4gSyH"),x=s("lSb9O"),b=s("7T458"),k=s("56lbz"),w=s("9iwJo"),A=s("fDBRf"),E=s("7HuhJ"),C=s("iUaCf"),S=s("1ByWd"),N=s("lgWLp"),T=s("5fWDg"),D=s("hlBuE"),F=s("aypA2"),O=s("cI6bT"),_=s("ivIoL"),I=s("3RXxY"),R=s("CFwcG"),M=function(){"use strict";function e(){r.default(this,e),this.nameMap={}}return a.default(e,[{key:"rename",value:function(e,t){this.nameMap[e]=t}},{key:"has",value:function(e){return void 0!==this.nameMap[e]}},{key:"get",value:function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e}}]),e}();function B(e){return"unit"===(null==e?void 0:e.type)}function P(e){return"facet"===(null==e?void 0:e.type)}function L(e){return"concat"===(null==e?void 0:e.type)}function j(e){return"layer"===(null==e?void 0:e.type)}var z=function(){"use strict";function e(t,n,a,i,o,u,s){var c,l,f=this;r.default(this,e),this.type=n,this.parent=a,this.config=o,this.view=s,this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=f.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=f.lookupDataSource(e.from.facet.data)),e},this.parent=a,this.config=o,this.name=null!==(c=t.name)&&void 0!==c?c:i,this.title=m.isText(t.title)?{text:t.title}:t.title,this.scaleNameMap=a?a.scaleNameMap:new M,this.projectionNameMap=a?a.projectionNameMap:new M,this.signalNameMap=a?a.signalNameMap:new M,this.data=t.data,this.description=t.description,this.transforms=y.normalizeTransform(null!==(l=t.transform)&&void 0!==l?l:[]),this.layout="layer"===n||"unit"===n?{}:g.extractCompositionLayout(t,n,o),this.component={data:{sources:a?a.component.data.sources:[],outputNodes:a?a.component.data.outputNodes:{},outputNodeRefCounts:a?a.component.data.outputNodeRefCounts:{},isFaceted:v.isFacetSpec(t)||a&&a.component.data.isFaceted&&void 0===t.data},layoutSize:new R.Split,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:Object.assign({scale:{},axis:{},legend:{}},u?x.duplicate(u):{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return a.default(e,[{key:"width",get:function(){return this.getSizeSignalRef("width")}},{key:"height",get:function(){return this.getSizeSignalRef("height")}},{key:"parse",value:function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}},{key:"parseScale",value:function(){I.parseScales(this)}},{key:"parseProjection",value:function(){F.parseProjection(this)}},{key:"renameTopLevelLayoutSizeSignal",value:function(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}},{key:"parseLegends",value:function(){T.parseLegend(this)}},{key:"assembleGroupStyle",value:function(){var e,t;if("unit"===this.type||"layer"===this.type)return null!==(t=null===(e=this.view)||void 0===e?void 0:e.style)&&void 0!==t?t:"cell"}},{key:"assembleEncodeFromView",value:function(e){e.style;var t=u.__rest(e,["style"]),n={},r=!0,a=!1,i=void 0;try{for(var o,s=x.keys(t)[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){var c=o.value,l=t[c];void 0!==l&&(n[c]=w.signalOrValueRef(l))}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}},{key:"assembleGroupEncodeEntry",value:function(e){var t={};return this.view&&(t=this.assembleEncodeFromView(this.view)),e||(this.description&&(t.description=w.signalOrValueRef(this.description)),"unit"!==this.type&&"layer"!==this.type)?x.isEmpty(t)?void 0:t:Object.assign({width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")},null!=t?t:{})}},{key:"assembleLayout",value:function(){if(this.layout){var e=this.layout,t=e.spacing,n=u.__rest(e,["spacing"]),r=this.component,a=this.config,i=A.assembleLayoutTitleBand(r.layoutHeaders,a);return Object.assign(Object.assign(Object.assign({padding:t},this.assembleDefaultLayout()),n),i?{titleBand:i}:{})}}},{key:"assembleDefaultLayout",value:function(){return{}}},{key:"assembleHeaderMarks",value:function(){var e=this.component.layoutHeaders,t=[],n=!0,r=!1,a=void 0;try{for(var i,o=c.FACET_CHANNELS[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;e[u].title&&t.push(A.assembleTitleGroup(this,u))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}var s=!0,l=!1,f=void 0;try{for(var d,p=E.HEADER_CHANNELS[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){var h=d.value;t=t.concat(A.assembleHeaderGroups(this,h))}}catch(e){l=!0,f=e}finally{try{s||null==p.return||p.return()}finally{if(l)throw f}}return t}},{key:"assembleAxes",value:function(){return k.assembleAxes(this.component.axes,this.config)}},{key:"assembleLegends",value:function(){return N.assembleLegends(this)}},{key:"assembleProjections",value:function(){return D.assembleProjections(this)}},{key:"assembleTitle",value:function(){var e,t,n,r=null!==(e=this.title)&&void 0!==e?e:{},a=r.encoding,i=u.__rest(r,["encoding"]),o=Object.assign(Object.assign(Object.assign({},m.extractTitleConfig(this.config.title).nonMark),i),a?{encode:{update:a}}:{});if(o.text)return x.contains(["unit","layer"],this.type)?x.contains(["middle",void 0],o.anchor)&&(o.frame=null!==(t=o.frame)&&void 0!==t?t:"group"):o.anchor=null!==(n=o.anchor)&&void 0!==n?n:"start",x.isEmpty(o)?void 0:o}},{key:"assembleGroup",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};(e=e.concat(this.assembleSignals())).length>0&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||P(this.parent)?O.assembleScales(this):[];r.length>0&&(t.scales=r);var a=this.assembleAxes();a.length>0&&(t.axes=a);var i=this.assembleLegends();return i.length>0&&(t.legends=i),t}},{key:"getName",value:function(e){return x.varName((this.name?this.name+"_":"")+e)}},{key:"requestDataName",value:function(e){var t,n=this.getName(e),r=this.component.data.outputNodeRefCounts;return r[n]=(null!==(t=r[n])&&void 0!==t?t:0)+1,n}},{key:"getSizeSignalRef",value:function(e){if(P(this.parent)){var t=S.getSizeTypeFromLayoutSizeType(e),n=c.getPositionScaleChannel(t),r=this.component.scales[n];if(r&&!r.merged){var a=r.get("type"),i=r.get("range");if(h.hasDiscreteDomain(a)&&b.isVgRangeStep(i)){var o=r.get("name"),u=_.assembleDomain(this,n),s=_.getFieldFromDomain(u);if(s){var f=l.vgField({aggregate:"distinct",field:s},{expr:"datum"});return{signal:C.sizeExpr(o,r,f)}}return d.warn("Unknown field for ".concat(n,". Cannot calculate view size.")),null}}}return{signal:this.signalNameMap.get(this.getName(e))}}},{key:"lookupDataSource",value:function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e}},{key:"getSignalName",value:function(e){return this.signalNameMap.get(e)}},{key:"renameSignal",value:function(e,t){this.signalNameMap.rename(e,t)}},{key:"renameScale",value:function(e,t){this.scaleNameMap.rename(e,t)}},{key:"renameProjection",value:function(e,t){this.projectionNameMap.rename(e,t)}},{key:"scaleName",value:function(e,t){return t?this.getName(e):c.isChannel(e)&&c.isScaleChannel(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0}},{key:"projectionName",value:function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}},{key:"getScaleComponent",value:function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0}},{key:"getSelectionComponent",value:function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(p.selectionNotFound(t));return n}},{key:"hasAxisOrientSignalRef",value:function(){var e,t;return(null===(e=this.component.axes.x)||void 0===e?void 0:e.some((function(e){return e.hasOrientSignalRef()})))||(null===(t=this.component.axes.y)||void 0===t?void 0:t.some((function(e){return e.hasOrientSignalRef()})))}}]),e}(),U=function(e){"use strict";i.default(n,e);var t=o.default(n);function n(){return r.default(this,n),t.apply(this,arguments)}return a.default(n,[{key:"vgField",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.fieldDef(e);if(n)return l.vgField(n,t)}},{key:"reduceFieldDef",value:function(e,t){return f.reduce(this.getMapping(),(function(t,n,r){var a=l.getFieldDef(n);return a?e(t,a,r):t}),t)}},{key:"forEachFieldDef",value:function(e,t){f.forEach(this.getMapping(),(function(t,n){var r=l.getFieldDef(t);r&&e(r,n)}),t)}}]),n}(z)})),s.register("56lbz",(function(e,t){n(e.exports,"assembleAxis",(function(){return y})),n(e.exports,"assembleAxisSignals",(function(){return x})),n(e.exports,"assembleAxes",(function(){return b})),s("1i51P");var r=s("9M1dW"),a=s("2lx0N");s("iSlfb");var i=s("4ujSI"),o=s("1Ihp0"),u=s("aLoDX"),c=s("e3OyN"),l=s("iooJ7"),f=s("aiwuu"),d=s("lSb9O"),p=s("7T458"),h=s("9iwJo"),v=s("dSz8D");function g(e,t){if(e)return i.default(e)&&!f.isText(e)?e.map((function(e){return l.defaultTitle(e,t)})).join(", "):e}function m(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function y(e,t,n){var i,s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{header:!1},l=e.combine(),f=l.disable,y=l.orient,x=l.scale,b=l.labelExpr,k=l.title,w=l.zindex,A=a.__rest(l,["disable","orient","scale","labelExpr","title","zindex"]);if(!f){for(var E in A){var C=u.AXIS_PROPERTY_TYPE[E],S=A[E];if(C&&C!==t&&"both"!==C)delete A[E];else if(u.isConditionalAxisValue(S)){var N=S.condition,T=a.__rest(S,["condition"]),D=o.default(N),F=u.CONDITIONAL_AXIS_PROP_INDEX[E];if(F){var O=F.vgProp,_=F.part,I=r.default(D.map((function(e){var t=e.test,n=a.__rest(e,["test"]);return Object.assign({test:v.expression(null,t)},n)}))).concat([T]);m(A,_,O,I),delete A[E]}else if(null===F){var R={signal:D.map((function(e){var t=e.test,n=a.__rest(e,["test"]);return"".concat(v.expression(null,t)," ? ").concat(h.exprFromValueOrSignalRef(n)," : ")})).join("")+h.exprFromValueOrSignalRef(T)};A[E]=R}}else if(p.isSignalRef(S)){var M=u.CONDITIONAL_AXIS_PROP_INDEX[E];if(M){var B=M.vgProp,P=M.part;m(A,P,B,S),delete A[E]}}}if("grid"===t){if(!A.grid)return;if(A.encode){var L=A.encode.grid;A.encode=Object.assign({},L?{grid:L}:{}),d.isEmpty(A.encode)&&delete A.encode}return Object.assign(Object.assign({scale:x,orient:y},A),{domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:d.getFirstDefined(w,0)})}if(c.header||!e.mainExtracted){if(void 0!==b){var j=b;(null===(s=null===(i=A.encode)||void 0===i?void 0:i.labels)||void 0===s?void 0:s.update)&&p.isSignalRef(A.encode.labels.update.text)&&(j=d.replaceAll(b,"datum.label",A.encode.labels.update.text.signal)),m(A,"labels","text",{signal:j})}if(null===A.labelAlign&&delete A.labelAlign,A.encode){var z=!0,U=!1,V=void 0;try{for(var W,G=u.AXIS_PARTS[Symbol.iterator]();!(z=(W=G.next()).done);z=!0){var H=W.value;e.hasAxisPart(H)||delete A.encode[H]}}catch(e){U=!0,V=e}finally{try{z||null==G.return||G.return()}finally{if(U)throw V}}d.isEmpty(A.encode)&&delete A.encode}var q=g(k,n);return Object.assign(Object.assign(Object.assign(Object.assign({scale:x,orient:y,grid:!1},q?{title:q}:{}),A),!1===n.aria?{aria:!1}:{}),{zindex:d.getFirstDefined(w,0)})}}}function x(e){var t=e.component.axes,n=[],r=!0,a=!1,i=void 0;try{for(var o,u=c.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(t[s]){var l=!0,f=!1,d=void 0;try{for(var p,h=t[s][Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;if(!v.get("disable")&&!v.get("gridScale")){var g="x"===s?"height":"width",m=e.getSizeSignalRef(g).signal;g!==m&&n.push({name:g,update:m})}}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}}}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}function b(e,t){var n=e.x,a=void 0===n?[]:n,i=e.y,o=void 0===i?[]:i;return r.default(a.map((function(e){return y(e,"grid",t)}))).concat(r.default(o.map((function(e){return y(e,"grid",t)}))),r.default(a.map((function(e){return y(e,"main",t)}))),r.default(o.map((function(e){return y(e,"main",t)})))).filter((function(e){return e}))}})),s.register("dSz8D",(function(e,t){n(e.exports,"expression",(function(){return u})),s("iSlfb");var r=s("fCSiB"),a=s("ceGn0"),i=s("lSb9O"),o=s("4dGY7");function u(e,t,n){return i.logicalExpr(t,(function(t){return r.default(t)?t:a.isSelectionPredicate(t)?o.parseSelectionPredicate(e,t.selection,n):a.fieldFilterExpression(t)}))}})),s.register("4dGY7",(function(e,t){n(e.exports,"parseUnitSelection",(function(){return h})),n(e.exports,"parseSelectionPredicate",(function(){return v})),n(e.exports,"parseSelectionBinExtent",(function(){return g})),n(e.exports,"materializeSelections",(function(){return m}));var r=s("2lx0N"),a=s("A0mT6");s("iSlfb");var i=s("fCSiB"),o=s("1gJgm"),u=s("aukhr"),c=s("16rNM"),l=s("lSb9O"),f=s("5XgHP"),d=s("dD9t5"),p=s("grXod");function h(e,t){var n,o={},u=e.config.selection,s=!0,c=!1,f=void 0;try{for(var d,h=function(s,c){var f=c.value,d=l.duplicate(t[f]),h=u[d.type],v=(h.fields,h.encodings,r.__rest(h,["fields","encodings"]));for(var g in v)"encodings"===g&&d.fields||"fields"===g&&d.encodings||("mark"===g&&(d[g]=Object.assign(Object.assign({},v[g]),d[g])),void 0!==d[g]&&!0!==d[g]||(d[g]=null!==(n=v[g])&&void 0!==n?n:d[g]));var m=l.varName(f),y=o[m]=Object.assign(Object.assign({},d),{name:m,events:i.default(d.on)?a.selector(d.on,"scope"):l.duplicate(d.on)});p.forEachTransform(y,(function(n){n.has(y)&&n.parse&&n.parse(e,y,d,t[f])}))},v=l.keys(null!=t?t:{})[Symbol.iterator]();!(s=(d=v.next()).done);s=!0)h(0,d)}catch(e){c=!0,f=e}finally{try{s||null==v.return||v.return()}finally{if(c)throw f}}return o}function v(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"datum",a=[];function i(t){var i=l.varName(t),s=e.getSelectionComponent(i,t),c=o.default(i+u.STORE);if(s.project.timeUnit){var f=null!=n?n:e.component.data.raw,d=s.project.timeUnit.clone();f.parent?d.insertAsParentOf(f):f.parent=d}return"none"!==s.empty&&a.push(c),"vlSelectionTest(".concat(c,", ").concat(r)+("global"===s.resolve?")":", ".concat(o.default(s.resolve),")"))}var s=l.logicalExpr(t,i);return(a.length?"!("+a.map((function(e){return"length(data(".concat(e,"))")})).join(" || ")+") || ":"")+"(".concat(s,")")}function g(e,t){var n=t.encoding,r=t.field;if(n||r){if(n&&!r){var a=e.project.items.filter((function(e){return e.channel===n}));!a.length||a.length>1?(r=e.project.items[0].field,c.warn((a.length?"Multiple ":"No ")+"matching ".concat(o.default(n)," encoding found for selection ").concat(o.default(t.selection),". ")+'Using "field": '.concat(o.default(r),"."))):r=a[0].field}}else r=e.project.items[0].field,e.project.items.length>1&&c.warn('A "field" or "encoding" must be specified when using a selection as a scale domain. '+'Using "field": '.concat(o.default(r),"."));return"".concat(e.name,"[").concat(o.default(r),"]")}function m(e,t){u.forEachSelection(e,(function(n){var r=n.name,a=e.getName("lookup_".concat(r));e.component.data.outputNodes[a]=n.materialized=new f.OutputNode(new d.FilterNode(t,e,{selection:r}),a,"lookup",e.component.data.outputNodeRefCounts)}))}})),s.register("aukhr",(function(e,t){n(e.exports,"STORE",(function(){return d})),n(e.exports,"TUPLE",(function(){return p})),n(e.exports,"MODIFY",(function(){return h})),n(e.exports,"VL_SELECTION_RESOLVE",(function(){return v})),n(e.exports,"forEachSelection",(function(){return m})),n(e.exports,"unitName",(function(){return x})),n(e.exports,"requiresSelectionId",(function(){return b})),s("iSlfb");var r=s("1gJgm"),a=s("e3OyN"),i=s("5XFBz"),o=s("lSb9O"),u=s("jZr2L"),c=s("jMnT0"),l=s("cGHEC"),f=s("azcvj"),d="_store",p="_tuple",h="_modify",v="vlSelectionResolve",g={single:f.default,multi:l.default,interval:c.default};function m(e,t){var n=e.component.selection,r=!0,a=!1,i=void 0;if(n)try{for(var u,s=o.vals(n)[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value;if(!0===t(c,g[c.type]))break}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}}function y(e){for(var t=e.parent;t&&!u.isFacetModel(t);)t=t.parent;return t}function x(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{escape:!0}).escape,n=t?r.default(e.name):e.name,i=y(e);if(i){var o=i.facet,u=!0,s=!1,c=void 0;try{for(var l,f=a.FACET_CHANNELS[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;o[d]&&(n+=" + '__facet_".concat(d,"_' + (facet[").concat(r.default(i.vgField(d)),"])"))}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}}return n}function b(e){var t=!1;return m(e,(function(e){t=t||e.project.items.some((function(e){return e.field===i.SELECTION_ID}))})),t}})),s.register("jMnT0",(function(e,t){n(e.exports,"BRUSH",(function(){return g})),n(e.exports,"default",(function(){return x})),s("1i51P");var r=s("9M1dW"),a=s("2lx0N");s("iSlfb");var i=s("1gJgm"),o=s("1Ihp0"),u=s("aukhr"),c=s("e3OyN"),l=s("16rNM"),f=s("7J7Lf"),d=s("lSb9O"),p=s("d4pV2"),h=s("a6sWl"),v=s("e12kF"),g="_brush",m="_scale_trigger",y={signals:function(e,t){var n=t.name,a=n+h.TUPLE_FIELDS,s=v.default.has(t),d=[],y=[],x=[];if(t.translate&&!s){var k="!event.item || event.item.mark.name !== ".concat(i.default(n+g));b(t,(function(e,t){var n,r=o.default(null!==(n=t.between[0].filter)&&void 0!==n?n:t.between[0].filter=[]);return r.indexOf(k)<0&&r.push(k),e}))}t.project.items.forEach((function(n,a){var o,u=n.channel;if(u===c.X||u===c.Y){var s=t.init?t.init[a]:null,h=function(e,t,n,a){var o=n.channel,u=n.signals.visual,s=n.signals.data,l=v.default.has(t),d=i.default(e.scaleName(o)),h=e.getScaleComponent(o),g=h?h.get("type"):void 0,y=function(e){return"scale(".concat(d,", ").concat(e,")")},x=e.getSizeSignalRef(o===c.X?"width":"height").signal,k="".concat(o,"(unit)"),w=b(t,(function(e,t){return r.default(e).concat([{events:t.between[0],update:"[".concat(k,", ").concat(k,"]")},{events:t,update:"[".concat(u,"[0], clamp(").concat(k,", 0, ").concat(x,")]")}])}));return w.push({events:{signal:t.name+m},update:f.hasContinuousDomain(g)?"[".concat(y("".concat(s,"[0]")),", ").concat(y("".concat(s,"[1]")),"]"):"[0, 0]"}),l?[{name:s,on:[]}]:[Object.assign(Object.assign({name:u},a?{init:p.assembleInit(a,!0,y)}:{value:[]}),{on:w}),Object.assign(Object.assign({name:s},a?{init:p.assembleInit(a)}:{}),{on:[{events:{signal:u},update:"".concat(u,"[0] === ").concat(u,"[1] ? null : invert(").concat(d,", ").concat(u,")")}]})]}(e,t,n,s),g=n.signals.data,k=n.signals.visual,w=i.default(e.scaleName(u)),A=e.getScaleComponent(u).get("type"),E=f.hasContinuousDomain(A)?"+":"";(o=d).push.apply(o,r.default(h)),y.push(g),x.push({scaleName:e.scaleName(u),expr:"(!isArray(".concat(g,") || ")+"(".concat(E,"invert(").concat(w,", ").concat(k,")[0] === ").concat(E).concat(g,"[0] && ")+"".concat(E,"invert(").concat(w,", ").concat(k,")[1] === ").concat(E).concat(g,"[1]))")})}else l.warn("Interval selections only support x and y encoding channels.")})),s||d.push({name:n+m,value:{},on:[{events:x.map((function(e){return{scale:e.scaleName}})),update:x.map((function(e){return e.expr})).join(" && ")+" ? ".concat(n+m," : {}")}]});var w=t.init,A="unit: ".concat(u.unitName(e),", fields: ").concat(a,", values");return d.concat(Object.assign(Object.assign({name:n+u.TUPLE},w?{init:"{".concat(A,": ").concat(p.assembleInit(w),"}")}:{}),{on:[{events:[{signal:y.join(" || ")}],update:y.join(" && ")+" ? {".concat(A,": [").concat(y,"]} : null")}]}))},modifyExpr:function(e,t){return t.name+u.TUPLE+", "+("global"===t.resolve?"true":"{unit: ".concat(u.unitName(e),"}"))},marks:function(e,t,n){var o=t.name,s=t.project.hasChannel,c=s.x,l=s.y,f=c&&c.signals.visual,p=l&&l.signals.visual,h="data(".concat(i.default(t.name+u.STORE),")");if(v.default.has(t))return n;var m={x:void 0!==c?{signal:"".concat(f,"[0]")}:{value:0},y:void 0!==l?{signal:"".concat(p,"[0]")}:{value:0},x2:void 0!==c?{signal:"".concat(f,"[1]")}:{field:{group:"width"}},y2:void 0!==l?{signal:"".concat(p,"[1]")}:{field:{group:"height"}}},y=!0,x=!1,b=void 0;if("global"===t.resolve)try{for(var k,w=d.keys(m)[Symbol.iterator]();!(y=(k=w.next()).done);y=!0){var A=k.value;m[A]=[Object.assign({test:"".concat(h,".length && ").concat(h,"[0].unit === ").concat(u.unitName(e))},m[A]),{value:0}]}}catch(e){x=!0,b=e}finally{try{y||null==w.return||w.return()}finally{if(x)throw b}}var E=t.mark,C=E.fill,S=E.fillOpacity,N=E.cursor,T=a.__rest(E,["fill","fillOpacity","cursor"]),D=d.keys(T).reduce((function(e,t){return e[t]=[{test:[void 0!==c&&"".concat(f,"[0] !== ").concat(f,"[1]"),void 0!==l&&"".concat(p,"[0] !== ").concat(p,"[1]")].filter((function(e){return e})).join(" && "),value:T[t]},{value:null}],e}),{});return[{name:o+g+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:C},fillOpacity:{value:S}},update:m}}].concat(r.default(n),[{name:o+g,type:"rect",clip:!0,encode:{enter:Object.assign(Object.assign({},N?{cursor:{value:N}}:{}),{fill:{value:"transparent"}}),update:Object.assign(Object.assign({},m),D)}}])}},x=y;function b(e,t){return e.events.reduce((function(e,n){return n.between?t(e,n):(l.warn("".concat(n," is not an ordered event stream for interval selections.")),e)}),[])}})),s.register("d4pV2",(function(e,t){n(e.exports,"assembleInit",(function(){return g})),n(e.exports,"assembleUnitSelectionSignals",(function(){return m})),n(e.exports,"assembleFacetSignals",(function(){return y})),n(e.exports,"assembleTopLevelSignals",(function(){return x})),n(e.exports,"assembleUnitSelectionData",(function(){return b})),n(e.exports,"assembleUnitSelectionMarks",(function(){return k})),n(e.exports,"assembleLayerSelectionMarks",(function(){return w})),n(e.exports,"assembleSelectionScaleDomain",(function(){return A})),s("1i51P");var r=s("9M1dW"),a=s("2lx0N"),i=s("A0mT6");s("iSlfb");var o=s("9vONj"),u=s("4ujSI"),c=s("1gJgm"),l=s("aukhr"),f=s("ggS1y"),d=s("lSb9O"),p=s("jZr2L"),h=s("grXod"),v=s("4dGY7");function g(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.identity;if(u.default(e)){var r=e.map((function(e){return g(e,t,n)}));return t?"[".concat(r.join(", "),"]"):r}return f.isDateTime(e)?n(t?f.dateTimeToExpr(e):f.dateTimeToTimestamp(e)):t?n(JSON.stringify(e)):e}function m(e,t){return l.forEachSelection(e,(function(n,a){var i,o=n.name,u=a.modifyExpr(e,n);(i=t).push.apply(i,r.default(a.signals(e,n))),h.forEachTransform(n,(function(r){r.signals&&(t=r.signals(e,n,t)),r.modifyExpr&&(u=r.modifyExpr(e,n,u))})),t.push({name:o+l.MODIFY,on:[{events:{signal:n.name+l.TUPLE},update:"modify(".concat(c.default(n.name+l.STORE),", ").concat(u,")")}]})})),E(t)}function y(e,t){if(e.component.selection&&d.keys(e.component.selection).length){var n=c.default(e.getName("cell"));t.unshift({name:"facet",value:{},on:[{events:i.selector("mousemove","scope"),update:"isTuple(facet) ? facet : group(".concat(n,").datum")}]})}return E(t)}function x(e,t){var n=!1;(l.forEachSelection(e,(function(r,a){var i=r.name,o=c.default(i+l.STORE);if(0===t.filter((function(e){return e.name===i})).length){var u="global"===r.resolve?"union":r.resolve,s="multi"===r.type?", true)":")";t.push({name:r.name,update:"".concat(l.VL_SELECTION_RESOLVE,"(").concat(o,", ").concat(c.default(u)).concat(s)})}n=!0,a.topLevelSignals&&(t=a.topLevelSignals(e,r,t)),h.forEachTransform(r,(function(n){n.topLevelSignals&&(t=n.topLevelSignals(e,r,t))}))})),n)&&(0===t.filter((function(e){return"unit"===e.name})).length&&t.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]}));return E(t)}function b(e,t){var n=r.default(t);return l.forEachSelection(e,(function(t){var r={name:t.name+l.STORE};if(t.init){var i=t.project.items.map((function(e){e.signals;return a.__rest(e,["signals"])})),o=t.init.map((function(e){return g(e,!1)}));r.values="interval"===t.type?[{unit:l.unitName(e,{escape:!1}),fields:i,values:o}]:o.map((function(t){return{unit:l.unitName(e,{escape:!1}),fields:i,values:t}}))}n.filter((function(e){return e.name===t.name+l.STORE})).length||n.push(r)})),n}function k(e,t){return l.forEachSelection(e,(function(n,r){t=r.marks?r.marks(e,n,t):t,h.forEachTransform(n,(function(r){r.marks&&(t=r.marks(e,n,t))}))})),t}function w(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=e.children[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;p.isUnitModel(u)&&(t=k(u,t))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}function A(e,t){var n=t.selection,r=e.getSelectionComponent(n,d.varName(n));return{signal:v.parseSelectionBinExtent(r,t)}}function E(e){return e.map((function(e){return e.on&&!e.on.length&&delete e.on,e}))}})),s.register("grXod",(function(e,t){n(e.exports,"forEachTransform",(function(){return h}));var r=s("hhVu6"),a=s("ehA4f"),i=s("bJQrN"),o=s("a6sWl"),u=s("e12kF"),c=s("6B2G8"),l=s("cmtQP"),f=s("ecJHj"),d=s("thQrq"),p=[o.default,l.default,u.default,c.default,f.default,d.default,a.default,i.default,r.default];function h(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=p[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;u.has(e)&&t(u)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}})),s.register("hhVu6",(function(e,t){n(e.exports,"default",(function(){return f}));var r=s("A0mT6");s("iSlfb");var a=s("fCSiB"),i=s("aukhr"),o=s("lSb9O"),u=s("ehA4f"),c=s("cmtQP"),l={has:function(e){return void 0!==e.clear&&!1!==e.clear},parse:function(e,t,n){n.clear&&(t.clear=a.default(n.clear)?r.selector(n.clear,"scope"):n.clear)},topLevelSignals:function(e,t,n){var r=!0,a=!1,i=void 0;if(u.default.has(t))try{for(var s,c=function(e,r){var a=r.value,i=n.findIndex((function(e){return e.name===o.varName("".concat(t.name,"_").concat(a.field))}));-1!==i&&n[i].on.push({events:t.clear,update:"null"})},l=t.project.items[Symbol.iterator]();!(r=(s=l.next()).done);r=!0)c(0,s)}catch(e){a=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw i}}return n},signals:function(e,t,n){function r(e,r){-1!==e&&n[e].on&&n[e].on.push({events:t.clear,update:r})}var a=!0,o=!1,u=void 0;if("interval"===t.type)try{for(var s,l=function(e,t){var a=t.value,i=n.findIndex((function(e){return e.name===a.signals.visual}));(r(i,"[0, 0]"),-1===i)&&r(n.findIndex((function(e){return e.name===a.signals.data})),"null")},f=t.project.items[Symbol.iterator]();!(a=(s=f.next()).done);a=!0)l(0,s)}catch(e){o=!0,u=e}finally{try{a||null==f.return||f.return()}finally{if(o)throw u}}else{var d=n.findIndex((function(e){return e.name===t.name+i.TUPLE}));r(d,"null"),c.default.has(t)&&r(d=n.findIndex((function(e){return e.name===t.name+c.TOGGLE})),"false")}return n}},f=l})),s.register("ehA4f",(function(e,t){n(e.exports,"default",(function(){return d})),s("iSlfb");var r=s("1gJgm"),a=s("aukhr"),i=s("lSb9O"),o=s("d4pV2"),u=s("bJQrN"),c=s("a6sWl"),l=s("5XFBz"),f={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind&&!l.isLegendBinding(e.bind)},parse:function(e,t,n,r){r.on||delete t.events,r.clear||delete t.clear},topLevelSignals:function(e,t,n){var a=t.name,s=t.project,c=t.bind,l=t.init&&t.init[0],f=u.default.has(t)?"(item().isVoronoi ? datum.datum : datum)":"datum";return s.items.forEach((function(e,u){var s,d,p=i.varName("".concat(a,"_").concat(e.field));n.filter((function(e){return e.name===p})).length||n.unshift(Object.assign(Object.assign({name:p},l?{init:o.assembleInit(l[u])}:{value:null}),{on:t.events?[{events:t.events,update:"datum && item().mark.marktype !== 'group' ? ".concat(f,"[").concat(r.default(e.field),"] : null")}]:[],bind:null!==(d=null!==(s=c[e.field])&&void 0!==s?s:c[e.channel])&&void 0!==d?d:c}))})),n},signals:function(e,t,n){var r=t.name,o=t.project,u=n.filter((function(e){return e.name===r+a.TUPLE}))[0],s=r+c.TUPLE_FIELDS,l=o.items.map((function(e){return i.varName("".concat(r,"_").concat(e.field))})),f=l.map((function(e){return"".concat(e," !== null")})).join(" && ");return l.length&&(u.update="".concat(f," ? {fields: ").concat(s,", values: [").concat(l.join(", "),"]} : null")),delete u.value,delete u.on,n}},d=f})),s.register("bJQrN",(function(e,t){n(e.exports,"default",(function(){return l}));var r=s("16rNM"),a=s("2x4HI"),i=s("4sOzK");s("7fgyI");var o=s("1T392"),u="voronoi",c={has:function(e){return"interval"!==e.type&&e.nearest},parse:function(e,t){var n=!0,r=!1,a=void 0;if(t.events)try{for(var i,o=t.events[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){i.value.markname=e.getName(u)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}},marks:function(e,t,n){var s=t.project.hasChannel,c=s.x,l=s.y,f=e.mark;if(i.isPathMark(f))return r.warn(a.nearestNotSupportForContinuous(f)),n;var d={name:e.getName(u),type:"path",interactive:!0,from:{data:e.getName("marks")},encode:{update:Object.assign({fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}},o.tooltip(e,{reactiveGeom:!0}))},transform:[{type:"voronoi",x:{expr:c||!l?"datum.datum.x || 0":"0"},y:{expr:l||!c?"datum.datum.y || 0":"0"},size:[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]}]},p=0,h=!1;return n.forEach((function(t,n){var r,a=null!==(r=t.name)&&void 0!==r?r:"";a===e.component.mark[0].name?p=n:a.indexOf(u)>=0&&(h=!0)})),h||n.splice(p+1,0,d),n}},l=c})),s.register("7fgyI",(function(e,t){n(e.exports,"baseEncodeEntry",(function(){return s("5N18T").baseEncodeEntry})),n(e.exports,"color",(function(){return s("kSkay").color})),n(e.exports,"wrapCondition",(function(){return s("lbihi").wrapCondition})),n(e.exports,"defined",(function(){return s("1W8hP").defined})),n(e.exports,"valueIfDefined",(function(){return s("1W8hP").valueIfDefined})),n(e.exports,"nonPosition",(function(){return s("cQqts").nonPosition})),n(e.exports,"pointPosition",(function(){return s("cleKX").pointPosition})),n(e.exports,"pointOrRangePosition",(function(){return s("63VZV").pointOrRangePosition})),n(e.exports,"rectPosition",(function(){return s("8rcIu").rectPosition})),n(e.exports,"text",(function(){return s("6JdYd").text})),n(e.exports,"tooltip",(function(){return s("1T392").tooltip}));s("5N18T"),s("kSkay"),s("lbihi"),s("1W8hP"),s("cQqts"),s("cleKX"),s("63VZV"),s("8rcIu"),s("6JdYd"),s("1T392"),s("gKx9u")})),s.register("5N18T",(function(e,t){n(e.exports,"baseEncodeEntry",(function(){return b})),s("1i51P");var r=s("4Ui3v"),a=s("9M1dW");s("iSlfb");var i=s("1Ihp0"),o=s("e3OyN"),u=s("4sOzK"),c=s("7J7Lf"),l=s("lSb9O"),f=s("7T458"),d=s("9iwJo"),p=s("gKx9u"),h=s("kSkay"),v=s("cQqts"),g=s("6JdYd"),m=s("1T392"),y=s("5PVWc"),x=(h=s("kSkay"),s("lbihi"),v=s("cQqts"),s("cleKX"),s("63VZV"),s("8rcIu"),g=s("6JdYd"),m=s("1T392"),new Set(["aria"]));function b(e,t){var n="include"===t.color?h.color(e):{},r=n.fill,a=n.stroke;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},function(e,t){return f.VG_MARK_CONFIGS.reduce((function(n,r){return x.has(r)||void 0===e[r]||"ignore"===t[r]||(n[r]=d.signalOrValueRef(e[r])),n}),{})}(e.markDef,t)),k(e,"fill",r)),k(e,"stroke",a)),v.nonPosition("opacity",e)),v.nonPosition("fillOpacity",e)),v.nonPosition("strokeOpacity",e)),v.nonPosition("strokeWidth",e)),v.nonPosition("strokeDash",e)),m.tooltip(e)),g.text(e,"href")),p.aria(e))}function k(e,t,n){var s=e.config,f=e.mark,p=e.markDef;if("hide"===d.getMarkPropOrConfig("invalid",p,s)&&n&&!u.isPathMark(f)){var h=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),i=e.vgField(n,{expr:"datum"});i&&c.hasContinuousDomain(a)&&(t[i]=!0)}return t}),{}),i=l.keys(a);if(i.length>0){var o=r?"||":"&&";return i.map((function(e){return y.fieldInvalidPredicate(e,r)})).join(" ".concat(o," "))}return}(e,{invalid:!0,channels:o.SCALE_CHANNELS});if(h)return r.default({},t,[{test:h,value:null}].concat(a.default(i.default(n))))}return n?r.default({},t,n):{}}})),s.register("gKx9u",(function(e,t){n(e.exports,"aria",(function(){return l}));var r=s("lSb9O"),a=s("9iwJo"),i=s("7T458"),o=s("lbihi"),u=s("6JdYd"),c=s("1T392");function l(e){var t=e.markDef,n=e.config,s=a.getMarkPropOrConfig("aria",t,n);return!1===s?{}:Object.assign(Object.assign(Object.assign({},s?{aria:s}:{}),function(e){var t=e.mark,n=e.markDef,r=e.config;if(!1===r.aria)return{};var o=a.getMarkPropOrConfig("ariaRoleDescription",n,r);return null!=o?{ariaRoleDescription:{value:o}}:t in i.VG_MARK_INDEX?{}:{ariaRoleDescription:{value:t}}}(e)),function(e){var t=e.encoding,n=e.markDef,i=e.config,s=e.stack,l=t.description;if(l)return o.wrapCondition(e,l,"description",(function(t){return u.textRef(t,e.config)}));var f=a.getMarkPropOrConfig("description",n,i);if(null!=f)return{description:a.signalOrValueRef(f)};if(!1===i.aria)return{};var d=c.tooltipData(t,s,i);return r.isEmpty(d)?void 0:{description:{signal:r.entries(d).map((function(e){var t=e.key,n=e.value;return"".concat(t,' + ": " + (').concat(n,")")})).join(' + "; " + ')}}}(e))}})),s.register("lbihi",(function(e,t){n(e.exports,"wrapCondition",(function(){return l})),s("1i51P");var r=s("4Ui3v"),a=s("9M1dW");s("iSlfb");var i=s("1Ihp0"),o=s("iooJ7"),u=s("dSz8D"),c=s("4dGY7");function l(e,t,n,s){var l=o.isConditionalDef(t)&&t.condition,f=s(t);if(l){var d=i.default(l).map((function(t){var n=s(t),r=o.isConditionalSelection(t)?c.parseSelectionPredicate(e,t.selection):u.expression(e,t.test);return Object.assign({test:r},n)}));return r.default({},n,a.default(d).concat(a.default(void 0!==f?[f]:[])))}return void 0!==f?r.default({},n,f):{}}})),s.register("6JdYd",(function(e,t){n(e.exports,"text",(function(){return u})),n(e.exports,"textRef",(function(){return c}));var r=s("iooJ7"),a=s("9iwJo"),i=s("ixH3E"),o=s("lbihi");function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"text",n=e.encoding[t];return o.wrapCondition(e,n,t,(function(t){return c(t,e.config)}))}function c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"datum";if(e){if(r.isValueDef(e))return a.signalOrValueRef(e.value);if(r.isFieldOrDatumDef(e)){var o=r.getFormatMixins(e),u=o.format,s=o.formatType;return i.formatSignalRef({fieldOrDatumDef:e,format:u,formatType:s,expr:n,config:t})}}}})),s.register("1T392",(function(e,t){n(e.exports,"tooltip",(function(){return y})),n(e.exports,"tooltipData",(function(){return x})),s("iSlfb");var r=s("4ujSI"),a=s("fCSiB"),i=s("bZ6XL"),o=s("1Ihp0"),u=s("1gJgm"),c=s("61RXI"),l=s("e3OyN"),f=s("iooJ7"),d=s("jQ4iQ"),p=s("lSb9O"),h=s("9iwJo"),v=s("ixH3E"),g=s("lbihi"),m=s("6JdYd");function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.encoding,o=e.markDef,u=e.config,s=e.stack,c=n.tooltip;if(r.default(c))return{tooltip:b({tooltip:c},s,u,t)};var l=t.reactiveGeom?"datum.datum":"datum";return g.wrapCondition(e,c,"tooltip",(function(e){var r=m.textRef(e,u,l);if(r)return r;if(null!==e){var c=h.getMarkPropOrConfig("tooltip",o,u);return!0===c&&(c={content:"encoding"}),a.default(c)?{value:c}:i.default(c)?"encoding"===c.content?b(n,s,u,t):{signal:l}:void 0}}))}function x(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).reactiveGeom,a={},i=r?"datum.datum":"datum",s=[];function p(r,u){var d,p=l.getMainRangeChannel(u),h=f.isTypedFieldDef(r)?r:Object.assign(Object.assign({},r),{type:e[p].type}),g=o.default(f.title(h,n,{allowDisabling:!1})).join(", ");if(l.isXorY(u)){var y="x"===u?"x2":"y2",x=f.getFieldDef(e[y]);if(c.isBinned(h.bin)&&x){var b=f.vgField(h,{expr:i}),k=f.vgField(x,{expr:i}),w=f.getFormatMixins(h),A=w.format,E=w.formatType;d=v.binFormatExpression(b,k,A,E,n),a[y]=!0}else if(t&&t.fieldChannel===u&&"normalize"===t.offset){var C=f.getFormatMixins(h),S=C.format,N=C.formatType;d=v.formatSignalRef({fieldOrDatumDef:h,format:S,formatType:N,expr:i,config:n,normalizeStack:!0}).signal}}d=null!=d?d:m.textRef(h,n,i).signal,s.push({channel:u,key:g,value:d})}d.forEach(e,(function(e,t){f.isFieldDef(e)?p(e,t):f.hasConditionalFieldDef(e)&&p(e.condition,t)}));var h={},g=!0,y=!1,x=void 0;try{for(var b,k=s[Symbol.iterator]();!(g=(b=k.next()).done);g=!0){var w=b.value,A=w.channel,E=w.key,C=w.value;a[A]||h[E]||(h[u.default(E)]=C)}}catch(e){y=!0,x=e}finally{try{g||null==k.return||k.return()}finally{if(y)throw x}}return h}function b(e,t,n){var r=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).reactiveGeom,a=x(e,t,n,{reactiveGeom:r}),i=p.entries(a).map((function(e){var t=e.key,n=e.value;return"".concat(t,": ").concat(n)}));return i.length>0?{signal:"{".concat(i.join(", "),"}")}:void 0}})),s.register("kSkay",(function(e,t){n(e.exports,"color",(function(){return c}));var r=s("16rNM"),a=s("2x4HI"),i=s("lSb9O"),o=s("9iwJo"),u=s("cQqts");function c(e){var t,n,s,c,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filled:void 0},f=e.markDef,d=e.encoding,p=e.config,h=f.type,v=null!==(t=l.filled)&&void 0!==t?t:o.getMarkPropOrConfig("filled",f,p),g=i.contains(["bar","point","circle","square","geoshape"],h)?"transparent":void 0,m=null!==(s=null!==(n=o.getMarkPropOrConfig(!0===v?"color":void 0,f,p,{vgChannel:"fill"}))&&void 0!==n?n:p.mark[!0===v&&"color"])&&void 0!==s?s:g,y=null!==(c=o.getMarkPropOrConfig(!1===v?"color":void 0,f,p,{vgChannel:"stroke"}))&&void 0!==c?c:p.mark[!1===v&&"color"],x=v?"fill":"stroke",b=Object.assign(Object.assign({},m?{fill:o.signalOrValueRef(m)}:{}),y?{stroke:o.signalOrValueRef(y)}:{});return f.color&&(v?f.fill:f.stroke)&&r.warn(a.droppingColor("property",{fill:"fill"in f,stroke:"stroke"in f})),Object.assign(Object.assign(Object.assign(Object.assign({},b),u.nonPosition("color",e,{vgChannel:x,defaultValue:v?m:y})),u.nonPosition("fill",e,{defaultValue:d.fill?m:void 0})),u.nonPosition("stroke",e,{defaultValue:d.stroke?y:void 0}))}})),s.register("cQqts",(function(e,t){n(e.exports,"nonPosition",(function(){return o}));var r=s("9iwJo"),a=s("lbihi"),i=s("5PVWc");function o(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=t.markDef,u=t.encoding,s=t.config,c=n.vgChannel,l=n.defaultRef,f=n.defaultValue;void 0===l&&void 0!==(f=null!=f?f:r.getMarkPropOrConfig(e,o,s,{vgChannel:c,ignoreVgConfig:!0}))&&(l=r.signalOrValueRef(f));var d=u[e];return a.wrapCondition(t,d,null!=c?c:e,(function(n){return i.midPoint({channel:e,channelDef:n,markDef:o,config:s,scaleName:t.scaleName(e),scale:t.getScaleComponent(e),stack:null,defaultRef:l})}))}})),s.register("cleKX",(function(e,t){n(e.exports,"pointPosition",(function(){return d})),n(e.exports,"pointPositionDefaultRef",(function(){return p})),s("1i51P");var r=s("4Ui3v"),a=s("e3OyN"),i=s("iooJ7"),o=s("7J7Lf"),u=s("lSb9O"),c=s("9iwJo"),l=s("3ifMS"),f=s("5PVWc");function d(e,t,n){var o=n.defaultPos,u=n.vgChannel,s=n.isMidPoint,c=t.encoding,d=t.markDef,h=t.config,v=t.stack,g=c[e],m=c[a.getSecondaryRangeChannel(e)],y=t.scaleName(e),x=t.getScaleComponent(e),b=l.getOffset(e,d),k=p({model:t,defaultPos:o,channel:e,scaleName:y,scale:x}),w=!g&&a.isXorY(e)&&(c.latitude||c.longitude)?{field:t.getName(e)}:function(e){var t=e.channel,n=e.channelDef,r=e.isMidPoint,a=e.scaleName,o=e.stack,u=e.offset,s=e.markDef,c=e.config;if(i.isFieldOrDatumDef(n)&&o&&t===o.fieldChannel){if(i.isFieldDef(n)){var l=i.getBand({channel:t,fieldDef:n,isMidPoint:r,markDef:s,stack:o,config:c});if(void 0!==l)return f.interpolatedSignalRef({scaleName:a,fieldOrDatumDef:n,startSuffix:"start",band:l,offset:u})}return f.valueRefForFieldOrDatumDef(n,a,{suffix:"end"},{offset:u})}return f.midPointRefWithPositionInvalidTest(e)}({channel:e,channelDef:g,channel2Def:m,markDef:d,config:h,isMidPoint:s,scaleName:y,scale:x,stack:v,offset:b,defaultRef:k});return w?r.default({},u||e,w):void 0}function p(e){var t=e.model,n=e.defaultPos,r=e.channel,i=e.scaleName,s=e.scale,l=t.markDef,d=t.config;return function(){var e=a.getMainRangeChannel(r),p=a.getVgPositionChannel(r),h=c.getMarkPropOrConfig(r,l,d,{vgChannel:p});if(void 0!==h)return f.widthHeightValueOrSignalRef(r,h);switch(n){case"zeroOrMin":case"zeroOrMax":if(i){var v=s.get("type");if(u.contains([o.ScaleType.LOG,o.ScaleType.TIME,o.ScaleType.UTC],v));else if(s.domainDefinitelyIncludesZero())return{scale:i,value:0}}if("zeroOrMin"===n)return"y"===e?{field:{group:"height"}}:{value:0};switch(e){case"radius":return{signal:"min(".concat(t.width.signal,",").concat(t.height.signal,")/2")};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":var g=t[a.getSizeChannel(r)];return Object.assign(Object.assign({},g),{mult:.5})}}}})),s.register("3ifMS",(function(e,t){n(e.exports,"getOffset",(function(){return a}));var r=s("e3OyN");function a(e,t){var n=t[r.getOffsetChannel(e)];if(n)return n}})),s.register("63VZV",(function(e,t){n(e.exports,"pointOrRangePosition",(function(){return d})),n(e.exports,"rangePosition",(function(){return p})),s("1i51P");var r=s("4Ui3v"),a=s("e3OyN"),i=s("iooJ7"),o=s("9iwJo"),u=s("3ifMS"),c=s("dfv5k"),l=s("cleKX"),f=s("5PVWc");function d(e,t,n){var r=n.defaultPos,a=n.defaultPos2;return n.range?p(e,t,{defaultPos:r,defaultPos2:a}):l.pointPosition(e,t,{defaultPos:r})}function p(e,t,n){var s=n.defaultPos,d=n.defaultPos2,p=t.markDef,v=t.config,g=a.getSecondaryRangeChannel(e),m=a.getSizeChannel(e),y=function(e,t,n){var s=e.encoding,c=e.mark,d=e.markDef,p=e.stack,v=e.config,g=a.getMainRangeChannel(n),m=a.getSizeChannel(n),y=a.getVgPositionChannel(n),x=s[g],b=e.scaleName(g),k=e.getScaleComponent(g),w=n in s||n in d?u.getOffset(n,e.markDef):u.getOffset(g,e.markDef);if(!x&&("x2"===n||"y2"===n)&&(s.latitude||s.longitude))return r.default({},y,{field:e.getName(n)});var A,E=function(e){var t=e.channel,n=e.channelDef,r=e.channel2Def,a=e.markDef,o=e.config,u=e.scaleName,s=e.scale,c=e.stack,l=e.offset,d=e.defaultRef;return i.isFieldOrDatumDef(n)&&c&&t.charAt(0)===c.fieldChannel.charAt(0)?f.valueRefForFieldOrDatumDef(n,u,{suffix:"start"},{offset:l}):f.midPointRefWithPositionInvalidTest({channel:t,channelDef:r,scaleName:u,scale:s,stack:c,markDef:a,config:o,offset:l,defaultRef:d})}({channel:n,channelDef:x,channel2Def:s[n],markDef:d,config:v,scaleName:b,scale:k,stack:p,offset:w,defaultRef:void 0});return void 0!==E?r.default({},y,E):h(n,d)||h(n,(A={},r.default(A,n,o.getMarkStyleConfig(n,d,v.style)),r.default(A,m,o.getMarkStyleConfig(m,d,v.style)),A))||h(n,v[c])||h(n,v.mark)||r.default({},y,l.pointPositionDefaultRef({model:e,defaultPos:t,channel:n,scaleName:b,scale:k})())}(t,d,g),x=y[m]?c.vgAlignedPositionChannel(e,p,v):a.getVgPositionChannel(e);return Object.assign(Object.assign({},l.pointPosition(e,t,{defaultPos:s,vgChannel:x})),y)}function h(e,t){var n=a.getSizeChannel(e),i=a.getVgPositionChannel(e);return void 0!==t[i]?r.default({},i,f.widthHeightValueOrSignalRef(e,t[i])):void 0!==t[e]?r.default({},i,f.widthHeightValueOrSignalRef(e,t[e])):t[n]?r.default({},n,f.widthHeightValueOrSignalRef(e,t[n])):void 0}})),s.register("dfv5k",(function(e,t){n(e.exports,"vgAlignedPositionChannel",(function(){return u}));var r=s("e3OyN"),a=s("9iwJo"),i={left:"x",center:"xc",right:"x2"},o={top:"y",middle:"yc",bottom:"y2"};function u(e,t,n){var u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"middle";if("radius"===e||"theta"===e)return r.getVgPositionChannel(e);var s="x"===e?"align":"baseline",c=a.getMarkPropOrConfig(s,t,n);return"x"===e?i[c||("top"===u?"left":"center")]:o[c||u]}})),s.register("8rcIu",(function(e,t){n(e.exports,"rectPosition",(function(){return A})),s("1i51P");var r=s("4Ui3v");s("iSlfb");var a=s("8AF0b"),i=s("4ujSI"),o=s("61RXI"),u=s("e3OyN"),c=s("iooJ7"),l=s("fldOo"),f=s("16rNM"),d=s("2x4HI"),p=s("7J7Lf"),h=s("lSb9O"),v=s("7T458"),g=s("9iwJo"),m=s("cQqts"),y=s("3ifMS"),x=s("dfv5k"),b=s("cleKX"),k=s("63VZV"),w=s("5PVWc");function A(e,t,n){var s,A,S,N,T=e.config,D=e.encoding,F=e.markDef,O=e.stack,_=u.getSecondaryRangeChannel(t),I=u.getSizeChannel(t),R=D[t],M=D[_],B=e.getScaleComponent(t),P=B?B.get("type"):void 0,L=e.scaleName(t),j=F.orient,z=null!==(A=null!==(s=D[I])&&void 0!==s?s:D.size)&&void 0!==A?A:g.getMarkPropOrConfig("size",F,T,{vgChannel:I}),U="bar"===n&&("x"===t?"vertical"===j:"horizontal"===j);if(c.isFieldDef(R)&&(o.isBinning(R.bin)||o.isBinned(R.bin)||R.timeUnit&&!M)&&!z&&!p.hasDiscreteDomain(P)){var V=c.getBand({channel:t,fieldDef:R,stack:O,markDef:F,config:T}),W=null===(S=e.component.axes[t])||void 0===S?void 0:S[0];return function(e){var t,n=e.fieldDef,a=e.fieldDef2,i=e.channel,s=e.band,l=e.scaleName,p=e.markDef,h=e.spacing,v=void 0===h?0:h,g=e.axisTranslate,m=e.reverse,x=e.config,b=u.getSecondaryRangeChannel(i),k=u.getVgPositionChannel(i),A=u.getVgPositionChannel(b),S=y.getOffset(i,p);if(o.isBinning(n.bin)||n.timeUnit)return t={},r.default(t,A,C({channel:i,fieldDef:n,scaleName:l,markDef:p,band:(1-s)/2,offset:E(b,v,m,g,S),config:x})),r.default(t,k,C({channel:i,fieldDef:n,scaleName:l,markDef:p,band:1-(1-s)/2,offset:E(i,v,m,g,S),config:x})),t;if(o.isBinned(n.bin)){var N,T,D=w.valueRefForFieldOrDatumDef(n,l,{},{offset:E(b,v,m,g,S)});if(c.isFieldDef(a))return N={},r.default(N,A,D),r.default(N,k,w.valueRefForFieldOrDatumDef(a,l,{},{offset:E(i,v,m,g,S)})),N;if(o.isBinParams(n.bin)&&n.bin.step)return T={},r.default(T,A,D),r.default(T,k,{signal:'scale("'.concat(l,'", ').concat(c.vgField(n,{expr:"datum"})," + ").concat(n.bin.step,")"),offset:E(i,v,m,g,S)}),T}return void f.warn(d.channelRequiredForBinned(b))}({fieldDef:R,fieldDef2:M,channel:t,markDef:F,scaleName:L,band:V,axisTranslate:null!==(N=null==W?void 0:W.get("translate"))&&void 0!==N?N:.5,spacing:u.isXorY(t)?g.getMarkPropOrConfig("binSpacing",F,T):void 0,reverse:B.get("reverse"),config:T})}return(c.isFieldOrDatumDef(R)&&p.hasDiscreteDomain(P)||U)&&!M?function(e,t,n,o){var s,k,A=o.markDef,E=o.encoding,C=o.config,S=o.stack,N=A.orient,T=o.scaleName(n),D=o.getScaleComponent(n),F=u.getSizeChannel(n),O=u.getSecondaryRangeChannel(n),_="horizontal"===N&&"y"===n||"vertical"===N&&"x"===n,I=g.getMarkPropOrConfig(_?"size":F,A,C,{vgChannel:F});(E.size||void 0!==I)&&(_?k=m.nonPosition("size",o,{vgChannel:F,defaultValue:I}):f.warn(d.cannotApplySizeToNonOrientedMark(A.type)));var R=null!==(s=c.isFieldOrDatumDef(t)?c.getBand({channel:n,fieldDef:t,markDef:A,stack:S,config:C}):void 0)&&void 0!==s?s:1;k=k||r.default({},F,function(e,t,n,r,i,o){if(r){var u=r.get("type");if("point"===u||"band"===u){if(void 0!==i[e].discreteBandSize)return{value:i[e].discreteBandSize};if(u===p.ScaleType.POINT){var s=r.get("range");return v.isVgRangeStep(s)&&a.default(s.step)?{value:s.step-2}:{value:l.DEFAULT_STEP-2}}return{scale:n,band:o}}return{value:i[e].continuousBandSize}}var c=l.getViewConfigDiscreteStep(i.view,t),f=h.getFirstDefined(i[e].discreteBandSize,c-2);return void 0!==f?{value:f}:void 0}(e,F,T,D,C,R));var M="band"!==(null==D?void 0:D.get("type"))||!("band"in k[F]),B=x.vgAlignedPositionChannel(n,A,C,M?"middle":"top"),P=y.getOffset(n,A),L=w.midPointRefWithPositionInvalidTest({channel:n,channelDef:t,markDef:A,config:C,scaleName:T,scale:D,stack:S,offset:P,defaultRef:b.pointPositionDefaultRef({model:o,defaultPos:"mid",channel:n,scaleName:T,scale:D}),band:M?.5:(1-R)/2});if(F)return Object.assign(r.default({},B,L),k);var j,z=u.getVgPositionChannel(O),U=k[F],V=P?Object.assign(Object.assign({},U),{offset:P}):U;return j={},r.default(j,B,L),r.default(j,z,i.default(L)?[L[0],Object.assign(Object.assign({},L[1]),{offset:V})]:Object.assign(Object.assign({},L),{offset:V})),j}(n,R,t,e):k.rangePosition(t,e,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"})}function E(e,t,n,r,a){if(u.isPolarPositionChannel(e))return 0;var i="x"===e||"y2"===e?-t/2:t/2;if(v.isSignalRef(n)){var o=g.signalOrStringValue(a);return{signal:"".concat(n.signal," ? ").concat(r-i).concat(o?"-"+o:""," : ").concat(r+i).concat(o?"+"+o:"")}}if(v.isSignalRef(a)){var s=r+(n?-i:i);return{signal:"".concat(s||"").concat(n?" - ":s?" + ":"").concat(a.signal)}}return a=a||0,r+(n?-a-i:+a+i)}function C(e){var t=e.channel,n=e.fieldDef,r=e.scaleName,a=e.markDef,i=e.band,o=e.offset,u=e.config,s=w.interpolatedSignalRef({scaleName:r,fieldOrDatumDef:n,band:i,offset:o});return w.wrapPositionInvalidTest({fieldDef:n,channel:t,markDef:a,ref:s,config:u})}})),s.register("1W8hP",(function(e,t){n(e.exports,"defined",(function(){return l})),n(e.exports,"valueIfDefined",(function(){return f})),s("1i51P");var r=s("4Ui3v"),a=s("e3OyN"),i=s("7J7Lf"),o=s("lSb9O"),u=s("9iwJo"),c=s("5PVWc");function l(e){var t=e.config,n=e.markDef;if(u.getMarkPropOrConfig("invalid",n,t)){var r=function(e,t){var n=t.invalid,r=void 0!==n&&n,a=t.channels.reduce((function(t,n){var r=e.getScaleComponent(n);if(r){var a=r.get("type"),o=e.vgField(n,{expr:"datum"});o&&i.hasContinuousDomain(a)&&(t[o]=!0)}return t}),{}),u=o.keys(a);if(u.length>0){var s=r?"||":"&&";return u.map((function(e){return c.fieldInvalidPredicate(e,r)})).join(" ".concat(s," "))}return}(e,{channels:a.POSITION_SCALE_CHANNELS});if(r)return{defined:{signal:r}}}return{}}function f(e,t){if(void 0!==t)return r.default({},e,u.signalOrValueRef(t))}})),s.register("a6sWl",(function(e,t){n(e.exports,"TUPLE_FIELDS",(function(){return h})),n(e.exports,"default",(function(){return m})),s("1i51P");var r=s("3QOYJ"),a=s("4Ui3v"),i=s("2lx0N");s("iSlfb");var o=s("1Ihp0"),u=s("e3OyN"),c=s("16rNM"),l=s("2x4HI"),f=s("7J7Lf"),d=s("lSb9O"),p=s("bAeeP"),h="_tuple_fields",v=function e(){"use strict";for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];r.default(this,e),this.items=n,this.hasChannel={},this.hasField={}},g={has:function(){return!0},parse:function(e,t,n){var r,i,s,h=t.name,g=null!==(r=t.project)&&void 0!==r?r:t.project=new v,m={},y={},x=new Set,b=function(e,t){for(var n="visual"===t?e.channel:e.field,r=d.varName("".concat(h,"_").concat(n)),i=1;x.has(r);i++)r=d.varName("".concat(h,"_").concat(n,"_").concat(i));return x.add(r),a.default({},t,r)};if(!n.fields&&!n.encodings){var k=e.config.selection[n.type];if(n.init){var w=!0,A=!1,E=void 0,C=!0,S=!1,N=void 0;try{for(var T,D=o.default(n.init)[Symbol.iterator]();!(C=(T=D.next()).done);C=!0){var F=T.value;try{for(var O,_=d.keys(F)[Symbol.iterator]();!(w=(O=_.next()).done);w=!0){var I=O.value;u.isSingleDefUnitChannel(I)?(n.encodings||(n.encodings=[])).push(I):"interval"===n.type?(c.warn('Interval selections should be initialized using "x" and/or "y" keys.'),n.encodings=k.encodings):(n.fields||(n.fields=[])).push(I)}}catch(e){A=!0,E=e}finally{try{w||null==_.return||_.return()}finally{if(A)throw E}}}}catch(e){S=!0,N=e}finally{try{C||null==D.return||D.return()}finally{if(S)throw N}}}else n.encodings=k.encodings,n.fields=k.fields}var R=!0,M=!1,B=void 0;try{for(var P,L=(null!==(i=n.fields)&&void 0!==i?i:[])[Symbol.iterator]();!(R=(P=L.next()).done);R=!0){var j=P.value,z={type:"E",field:j};z.signals=Object.assign({},b(z,"data")),g.items.push(z),g.hasField[j]=z}}catch(e){M=!0,B=e}finally{try{R||null==L.return||L.return()}finally{if(M)throw B}}var U=!0,V=!1,W=void 0;try{for(var G,H=(null!==(s=n.encodings)&&void 0!==s?s:[])[Symbol.iterator]();!(U=(G=H.next()).done);U=!0){var q=G.value,J=e.fieldDef(q);if(J){var K=J.field;if(J.aggregate){c.warn(l.cannotProjectAggregate(q,J.aggregate));continue}if(!K){c.warn(l.cannotProjectOnChannelWithoutField(q));continue}if(J.timeUnit){K=e.vgField(q);var X={timeUnit:J.timeUnit,as:K,field:J.field};y[d.hash(X)]=X}if(!m[K]){var Y="E";if("interval"===t.type){var Q=e.getScaleComponent(q).get("type");f.hasContinuousDomain(Q)&&(Y="R")}else J.bin&&(Y="R-RE");var Z={field:K,channel:q,type:Y};Z.signals=Object.assign(Object.assign({},b(Z,"data")),b(Z,"visual")),g.items.push(m[K]=Z),g.hasField[K]=g.hasChannel[q]=m[K]}}else c.warn(l.cannotProjectOnChannelWithoutField(q))}}catch(e){V=!0,W=e}finally{try{U||null==H.return||H.return()}finally{if(V)throw W}}if(n.init){var $=function(e){return g.items.map((function(t){return void 0!==e[t.channel]?e[t.channel]:e[t.field]}))};if("interval"===n.type)t.init=$(n.init);else{var ee=o.default(n.init);t.init=ee.map($)}}d.isEmpty(y)||(g.timeUnit=new p.TimeUnitNode(null,y))},signals:function(e,t,n){var r=t.name+h;return n.filter((function(e){return e.name===r})).length>0?n:n.concat({name:r,value:t.project.items.map((function(e){e.signals,e.hasLegend;var t=i.__rest(e,["signals","hasLegend"]);return t.field=d.replacePathInField(t.field),t}))})}},m=g})),s.register("bAeeP",(function(e,t){n(e.exports,"TimeUnitNode",(function(){return v})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("4Ui3v"),c=s("2lx0N"),l=s("e3OyN"),f=s("iooJ7"),d=s("gQOdy"),p=s("lSb9O"),h=s("jZr2L"),v=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).formula=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,p.duplicate(this.formula))}},{key:"merge",value:function(e){for(var t in this.formula=Object.assign({},this.formula),e.formula)this.formula[t]&&!e.formula[t].band||(this.formula[t]=e.formula[t]);var n=!0,r=!1,a=void 0;try{for(var i,o=e.children[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;e.removeChild(u),u.parent=this}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}e.remove()}},{key:"producedFields",value:function(){return new Set(p.vals(this.formula).map((function(e){return e.as})))}},{key:"dependentFields",value:function(){return new Set(p.vals(this.formula).map((function(e){return e.field})))}},{key:"hash",value:function(){return"TimeUnit ".concat(p.hash(this.formula))}},{key:"assemble",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=p.vals(this.formula)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,u=o.field,s=o.as,l=o.timeUnit,f=d.normalizeTimeUnit(l),h=f.unit,v=f.utc,g=c.__rest(f,["unit","utc"]);e.push(Object.assign(Object.assign(Object.assign(Object.assign({field:p.replacePathInField(u),type:"timeunit"},h?{units:d.getTimeUnitParts(h)}:{}),v?{timezone:"utc"}:{}),g),{as:[s,"".concat(s,"_end")]}))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){var a=n.field,i=n.timeUnit,o=h.isUnitModel(t)?t.encoding[l.getSecondaryRangeChannel(r)]:void 0,u=h.isUnitModel(t)&&f.hasBand(r,n,o,t.stack,t.markDef,t.config);if(i){var s=f.vgField(n,{forAs:!0});e[p.hash({as:s,field:a,timeUnit:i})]=Object.assign({as:s,field:a,timeUnit:i},u?{band:!0}:{})}return e}),{});return p.isEmpty(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t){var r=Object.assign({},t),a=r.timeUnit,i=c.__rest(r,["timeUnit"]),o=d.normalizeTimeUnit(a),s=Object.assign(Object.assign({},i),{timeUnit:o});return new n(e,u.default({},p.hash(s),s))}}]),n}(s("5XgHP").DataFlowNode)})),s.register("5XgHP",(function(e,t){n(e.exports,"DataFlowNode",(function(){return c})),n(e.exports,"OutputNode",(function(){return l})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("2vsUb"),o=s("d6iiX"),u=s("lSb9O"),c=function(){"use strict";function e(t,n){r.default(this,e),this.debugName=n,this._children=[],this._parent=null,t&&(this.parent=t)}return a.default(e,[{key:"clone",value:function(){throw new Error("Cannot clone node")}},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e,e&&e.addChild(this)}},{key:"children",get:function(){return this._children}},{key:"numChildren",value:function(){return this._children.length}},{key:"addChild",value:function(e,t){this._children.indexOf(e)>-1?console.warn("Attempt to add the same child twice."):void 0!==t?this._children.splice(t,0,e):this._children.push(e)}},{key:"removeChild",value:function(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t}},{key:"remove",value:function(){var e=this._parent.removeChild(this),t=!0,n=!1,r=void 0;try{for(var a,i=this._children[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;o._parent=this._parent,this._parent.addChild(o,e++)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"insertAsParentOf",value:function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this}},{key:"swapWithParent",value:function(){var e=this._parent,t=e.parent,n=!0,r=!1,a=void 0;try{for(var i,o=this._children[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){i.value.parent=e}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this}}]),e}(),l=function(e){"use strict";i.default(n,e);var t=o.default(n);function n(e,a,i,o){var u;return r.default(this,n),(u=t.call(this,e,a)).type=i,u.refCounts=o,u._source=u._name=a,u.refCounts&&!(u._name in u.refCounts)&&(u.refCounts[u._name]=0),u}return a.default(n,[{key:"clone",value:function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return void 0===this._hash&&(this._hash="Output ".concat(u.uniqueId())),this._hash}},{key:"getSource",value:function(){return this.refCounts[this._name]++,this._source}},{key:"isRequired",value:function(){return!!this.refCounts[this._name]}},{key:"setSource",value:function(e){this._source=e}}]),n}(c)})),s.register("cmtQP",(function(e,t){n(e.exports,"TOGGLE",(function(){return a})),n(e.exports,"default",(function(){return i}));var r=s("aukhr"),a="_toggle",i={has:function(e){return"multi"===e.type&&!!e.toggle},signals:function(e,t,n){return n.concat({name:t.name+a,value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t){var n=t.name+r.TUPLE,i=t.name+a;return"".concat(i," ? null : ").concat(n,", ")+("global"===t.resolve?"".concat(i," ? null : true, "):"".concat(i," ? null : {unit: ").concat(r.unitName(e),"}, "))+"".concat(i," ? ").concat(n," : null")}}})),s.register("e12kF",(function(e,t){n(e.exports,"default",(function(){return d})),n(e.exports,"domain",(function(){return p})),s("iSlfb");var r=s("1gJgm"),a=s("aukhr"),i=s("e3OyN"),o=s("16rNM"),u=s("2x4HI"),c=s("7J7Lf"),l=s("jZr2L"),f={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(e,t){var n=t.scales=[],r=!0,a=!1,s=void 0;try{for(var l,f=t.project.items[Symbol.iterator]();!(r=(l=f.next()).done);r=!0){var d=l.value,p=d.channel;if(i.isScaleChannel(p)){var h=e.getScaleComponent(p),v=h?h.get("type"):void 0;if(h&&c.hasContinuousDomain(v)){var g={selection:t.name,field:d.field};h.set("selectionExtent",g,!0),n.push(d)}else o.warn(u.SCALE_BINDINGS_CONTINUOUS)}}}catch(e){a=!0,s=e}finally{try{r||null==f.return||f.return()}finally{if(a)throw s}}},topLevelSignals:function(e,t,n){var i=t.scales.filter((function(e){return 0===n.filter((function(t){return t.name===e.signals.data})).length}));if(!e.parent||h(e)||0===i.length)return n;var o=n.filter((function(e){return e.name===t.name}))[0],u=o.update;if(u.indexOf(a.VL_SELECTION_RESOLVE)>=0)o.update="{".concat(i.map((function(e){return"".concat(r.default(e.field),": ").concat(e.signals.data)})).join(", "),"}");else{var s=!0,c=!1,l=void 0;try{for(var f,d=i[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value,v="".concat(r.default(p.field),": ").concat(p.signals.data);u.indexOf(v)<0&&(u="".concat(u.substring(0,u.length-1),", ").concat(v,"}"))}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}o.update=u}return n.concat(i.map((function(e){return{name:e.signals.data}})))},signals:function(e,t,n){var r=!0,a=!1,i=void 0;if(e.parent&&!h(e))try{for(var o,u=function(e,t){var r=t.value,a=n.filter((function(e){return e.name===r.signals.data}))[0];a.push="outer",delete a.value,delete a.update},s=t.scales[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)u(0,o)}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}},d=f;function p(e,t){var n=r.default(e.scaleName(t));return"domain(".concat(n,")")}function h(e){var t;return e.parent&&l.isLayerModel(e.parent)&&(void 0!==(t=!e.parent.parent)?t:h(e.parent.parent))}})),s.register("6B2G8",(function(e,t){n(e.exports,"default",(function(){return v})),n(e.exports,"parseInteractiveLegend",(function(){return g}));var r=s("A0mT6");s("iSlfb");var a=s("1Ihp0"),i=s("fCSiB"),o=s("aukhr"),u=s("16rNM"),c=s("2x4HI"),l=s("5XFBz"),f=s("lSb9O"),d=s("a6sWl"),p=s("cmtQP"),h={has:function(e){var t="global"===e.resolve&&e.bind&&l.isLegendBinding(e.bind),n=1===e.project.items.length&&e.project.items[0].field!==l.SELECTION_ID;return t&&!n&&u.warn(c.LEGEND_BINDINGS_PROJECT_LENGTH),t&&n},parse:function(e,t,n,o){var u;if(o.on||delete t.events,o.clear||delete t.clear,o.on||o.clear){var s='event.item && indexof(event.item.mark.role, "legend") < 0',c=!0,f=!1,d=void 0;try{for(var p,h=t.events[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var v=p.value;v.filter=a.default(null!==(u=v.filter)&&void 0!==u?u:[]),v.filter.indexOf(s)<0&&v.filter.push(s)}}catch(e){f=!0,d=e}finally{try{c||null==h.return||h.return()}finally{if(f)throw d}}}var g=l.isLegendStreamBinding(t.bind)?t.bind.legend:"click",m=i.default(g)?r.selector(g,"view"):a.default(g);t.bind={legend:{merge:m}}},topLevelSignals:function(e,t,n){var r=t.name,a=l.isLegendStreamBinding(t.bind)&&t.bind.legend,i=function(e){return function(t){var n=f.duplicate(t);return n.markname=e,n}},o=!0,u=!1,s=void 0;try{for(var c,d=function(e,o){var u=o.value;if(!u.hasLegend)return"continue";var s="".concat(f.varName(u.field),"_legend"),c="".concat(r,"_").concat(s);if(0===n.filter((function(e){return e.name===c})).length){var l=a.merge.map(i("".concat(s,"_symbols"))).concat(a.merge.map(i("".concat(s,"_labels")))).concat(a.merge.map(i("".concat(s,"_entries"))));n.unshift(Object.assign(Object.assign({name:c},t.init?{}:{value:null}),{on:[{events:l,update:"datum.value || item().items[0].items[0].datum.value",force:!0},{events:a.merge,update:"!event.item || !datum ? null : ".concat(c),force:!0}]}))}},p=t.project.items[Symbol.iterator]();!(o=(c=p.next()).done);o=!0)d(0,c)}catch(e){u=!0,s=e}finally{try{o||null==p.return||p.return()}finally{if(u)throw s}}return n},signals:function(e,t,n){var r=t.name,a=t.project,i=n.find((function(e){return e.name===r+o.TUPLE})),u=r+d.TUPLE_FIELDS,s=a.items.filter((function(e){return e.hasLegend})).map((function(e){return f.varName("".concat(r,"_").concat(f.varName(e.field),"_legend"))})),c=s.map((function(e){return"".concat(e," !== null")})).join(" && "),h="".concat(c," ? {fields: ").concat(u,", values: [").concat(s.join(", "),"]} : null");t.events&&s.length>0?i.on.push({events:s.map((function(e){return{signal:e}})),update:h}):s.length>0&&(i.update=h,delete i.value,delete i.on);var v=n.find((function(e){return e.name===r+p.TOGGLE})),g=l.isLegendStreamBinding(t.bind)&&t.bind.legend;return v&&(t.events?v.on.push(Object.assign(Object.assign({},v.on[0]),{events:g})):v.on[0].events=g),n}},v=h;function g(e,t,n){var r,a=null===(r=e.fieldDef(t))||void 0===r?void 0:r.field;o.forEachSelection(e,(function(e){var r,i,o=null!==(r=e.project.hasField[a])&&void 0!==r?r:e.project.hasChannel[t];if(o&&h.has(e)){var u=null!==(i=n.get("selections"))&&void 0!==i?i:[];u.push(e.name),n.set("selections",u,!1),o.hasLegend=!0}}))}})),s.register("ecJHj",(function(e,t){n(e.exports,"default",(function(){return f}));var r=s("A0mT6"),a=s("e3OyN"),i=s("jMnT0"),o=s("e12kF"),u="_translate_anchor",c="_translate_delta",l={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var s=t.name,l=o.default.has(t),f=s+u,p=t.project.hasChannel,h=p.x,v=p.y,g=r.selector(t.translate,"scope");return l||(g=g.map((function(e){return e.between[0].markname=s+i.BRUSH,e}))),n.push({name:f,value:{},on:[{events:g.map((function(e){return e.between[0]})),update:"{x: x(unit), y: y(unit)"+(void 0!==h?", extent_x: "+(l?o.domain(e,a.X):"slice(".concat(h.signals.visual,")")):"")+(void 0!==v?", extent_y: "+(l?o.domain(e,a.Y):"slice(".concat(v.signals.visual,")")):"")+"}"}]},{name:s+c,value:{},on:[{events:g,update:"{x: ".concat(f,".x - x(unit), y: ").concat(f,".y - y(unit)}")}]}),void 0!==h&&d(e,t,h,"width",n),void 0!==v&&d(e,t,v,"height",n),n}},f=l;function d(e,t,n,r,i){var s,l=t.name,f=l+u,d=l+c,p=n.channel,h=o.default.has(t),v=i.filter((function(e){return e.name===n.signals[h?"data":"visual"]}))[0],g=e.getSizeSignalRef(r).signal,m=e.getScaleComponent(p),y=m.get("type"),x=h&&p===a.X?"-":"",b="".concat(f,".extent_").concat(p),k="".concat(x).concat(d,".").concat(p," / ")+(h?"".concat(g):"span(".concat(b,")")),w="".concat(h?"log"===y?"panLog":"pow"===y?"panPow":"panLinear":"panLinear","(").concat(b,", ").concat(k)+(h&&"pow"===y?", ".concat(null!==(s=m.get("exponent"))&&void 0!==s?s:1):"")+")";v.on.push({events:{signal:d},update:h?w:"clampRange(".concat(w,", 0, ").concat(g,")")})}})),s.register("thQrq",(function(e,t){n(e.exports,"default",(function(){return d}));var r=s("A0mT6");s("iSlfb");var a=s("1gJgm"),i=s("e3OyN"),o=s("jMnT0"),u=s("e12kF"),c="_zoom_anchor",l="_zoom_delta",f={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var s=t.name,f=u.default.has(t),d=s+l,h=t.project.hasChannel,v=h.x,g=h.y,m=a.default(e.scaleName(i.X)),y=a.default(e.scaleName(i.Y)),x=r.selector(t.zoom,"scope");return f||(x=x.map((function(e){return e.markname=s+o.BRUSH,e}))),n.push({name:s+c,on:[{events:x,update:f?"{"+[m?"x: invert(".concat(m,", x(unit))"):"",y?"y: invert(".concat(y,", y(unit))"):""].filter((function(e){return!!e})).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:d,on:[{events:x,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==v&&p(e,t,v,"width",n),void 0!==g&&p(e,t,g,"height",n),n}},d=f;function p(e,t,n,r,a){var i,o=t.name,s=n.channel,f=u.default.has(t),d=a.filter((function(e){return e.name===n.signals[f?"data":"visual"]}))[0],p=e.getSizeSignalRef(r).signal,h=e.getScaleComponent(s),v=h.get("type"),g=f?u.domain(e,s):d.name,m=o+l,y="".concat(o).concat(c,".").concat(s),x="".concat(f?"log"===v?"zoomLog":"pow"===v?"zoomPow":"zoomLinear":"zoomLinear","(").concat(g,", ").concat(y,", ").concat(m)+(f&&"pow"===v?", ".concat(null!==(i=h.get("exponent"))&&void 0!==i?i:1):"")+")";d.on.push({events:{signal:m},update:f?x:"clampRange(".concat(x,", 0, ").concat(p,")")})}})),s.register("cGHEC",(function(e,t){n(e.exports,"singleOrMultiSignals",(function(){return o})),n(e.exports,"default",(function(){return u})),s("iSlfb");var r=s("1gJgm"),a=s("aukhr"),i=s("a6sWl");function o(e,t){var n=t.name,o=n+i.TUPLE_FIELDS,u=t.project,s="(item().isVoronoi ? datum.datum : datum)",c=u.items.map((function(t){var n=e.fieldDef(t.channel);return n&&n.bin?"[".concat(s,"[").concat(r.default(e.vgField(t.channel,{})),"], ")+"".concat(s,"[").concat(r.default(e.vgField(t.channel,{binSuffix:"end"})),"]]"):"".concat(s,"[").concat(r.default(t.field),"]")})).join(", "),l="unit: ".concat(a.unitName(e),", fields: ").concat(o,", values"),f=t.events;return[{name:n+a.TUPLE,on:f?[{events:f,update:"datum && item().mark.marktype !== 'group' ? {".concat(l,": [").concat(c,"]} : null"),force:!0}]:[]}]}var u={signals:o,modifyExpr:function(e,t){return t.name+a.TUPLE+", "+("global"===t.resolve?"null":"{unit: ".concat(a.unitName(e),"}"))}}})),s.register("azcvj",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("aukhr"),a={signals:s("cGHEC").singleOrMultiSignals,modifyExpr:function(e,t){return t.name+r.TUPLE+", "+("global"===t.resolve?"true":"{unit: ".concat(r.unitName(e),"}"))}}})),s.register("dD9t5",(function(e,t){n(e.exports,"FilterNode",(function(){return p})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("jZS3C"),u=s("2tuUj"),c=s("lSb9O"),l=s("dSz8D"),f=s("5XgHP"),d=s("38SzU"),p=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a){var u;return i.default(this,n),(u=t.call(this,e)).model=r,u.filter=a,u.expr=l.expression(u.model,u.filter,o.default(u)),u._dependentFields=d.getDependentFields(u.expr),u}return u.default(n,[{key:"clone",value:function(){return new n(null,this.model,c.duplicate(this.filter))}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"producedFields",value:function(){return new Set}},{key:"assemble",value:function(){return{type:"filter",expr:this.expr}}},{key:"hash",value:function(){return"Filter ".concat(this.expr)}}]),n}(f.DataFlowNode)})),s.register("38SzU",(function(e,t){n(e.exports,"getDependentFields",(function(){return u})),s("1i51P");var r=s("9M1dW");s("bMFWX");var a=s("7svuF");function i(e){var t,n,a=[];if("Identifier"===e.type)return[e.name];if("Literal"===e.type)return[e.value];"MemberExpression"===e.type&&((t=a).push.apply(t,r.default(i(e.object))),(n=a).push.apply(n,r.default(i(e.property))));return a}function o(e){return"MemberExpression"===e.object.type?o(e.object):"datum"===e.object.name}function u(e){var t=a.default(e),n=new Set;return t.visit((function(e){"MemberExpression"===e.type&&o(e)&&n.add(i(e).slice(1).join("."))})),n}})),s.register("bMFWX",(function(e,t){n(e.exports,"parse",(function(){return s("7svuF").default}));s("tcYO2"),s("7svuF"),s("25Q13"),s("8azSx"),s("4UrXf")})),s.register("tcYO2",(function(e,t){n(e.exports,"default",(function(){return d}));var r="Property",a="ArrayExpression",i="BinaryExpression",o="CallExpression",u="ConditionalExpression",s="LogicalExpression",c="MemberExpression",l="ObjectExpression",f="UnaryExpression";function d(e){this.type=e}d.prototype.visit=function(e){var t,n,d;if(e(this))return 1;for(n=0,d=(t=function(e){switch(e.type){case a:return e.elements;case i:case s:return[e.left,e.right];case o:return[e.callee].concat(e.arguments);case u:return[e.test,e.consequent,e.alternate];case c:return[e.object,e.property];case l:return e.properties;case r:return[e.key,e.value];case f:return[e.argument];default:return[]}}(this)).length;n<d;++n)if(t[n].visit(e))return 1}})),s.register("7svuF",(function(e,t){n(e.exports,"default",(function(){return le}));var r,a,i,o,u,c=s("tcYO2");(r={})[1]="Boolean",r[2]="<end>",r[3]="Identifier",r[4]="Keyword",r[5]="Null",r[6]="Numeric",r[7]="Punctuator",r[8]="String",r[9]="RegularExpression";var l="Identifier",f="Unexpected token %0",d="Invalid regular expression",p="Invalid regular expression: missing /",h="Octal literals are not allowed in strict mode.",v="ILLEGAL",g="Disabled.",m=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),y=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function x(e,t){if(!e)throw new Error("ASSERT: "+t)}function b(e){return e>=48&&e<=57}function k(e){return"0123456789abcdefABCDEF".indexOf(e)>=0}function w(e){return"01234567".indexOf(e)>=0}function A(e){return 32===e||9===e||11===e||12===e||160===e||e>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(e)>=0}function E(e){return 10===e||13===e||8232===e||8233===e}function C(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||92===e||e>=128&&m.test(String.fromCharCode(e))}function S(e){return 36===e||95===e||e>=65&&e<=90||e>=97&&e<=122||e>=48&&e<=57||92===e||e>=128&&y.test(String.fromCharCode(e))}var N={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function T(){for(var e;i<o&&(A(e=a.charCodeAt(i))||E(e));)++i}function D(e){var t,n,r,u=0;for(n="u"===e?4:2,t=0;t<n;++t)i<o&&k(a[i])?(r=a[i++],u=16*u+"0123456789abcdef".indexOf(r.toLowerCase())):H({},f,v);return String.fromCharCode(u)}function F(){var e,t,n,r;for(t=0,"}"===(e=a[i])&&H({},f,v);i<o&&k(e=a[i++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(t>1114111||"}"!==e)&&H({},f,v),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function O(){var e,t;for(e=a.charCodeAt(i++),t=String.fromCharCode(e),92===e&&(117!==a.charCodeAt(i)&&H({},f,v),++i,(e=D("u"))&&"\\"!==e&&C(e.charCodeAt(0))||H({},f,v),t=e);i<o&&S(e=a.charCodeAt(i));)++i,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==a.charCodeAt(i)&&H({},f,v),++i,(e=D("u"))&&"\\"!==e&&S(e.charCodeAt(0))||H({},f,v),t+=e);return t}function _(){var e,t;return e=i,t=92===a.charCodeAt(i)?O():function(){var e,t;for(e=i++;i<o;){if(92===(t=a.charCodeAt(i)))return i=e,O();if(!S(t))break;++i}return a.slice(e,i)}(),{type:1===t.length?3:N.hasOwnProperty(t)?4:"null"===t?5:"true"===t||"false"===t?1:3,value:t,start:e,end:i}}function I(){var e,t,n,r,o=i,u=a.charCodeAt(i),s=a[i];switch(u){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++i,{type:7,value:String.fromCharCode(u),start:o,end:i};default:if(61===(e=a.charCodeAt(i+1)))switch(u){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return i+=2,{type:7,value:String.fromCharCode(u)+String.fromCharCode(e),start:o,end:i};case 33:case 61:return i+=2,61===a.charCodeAt(i)&&++i,{type:7,value:a.slice(o,i),start:o,end:i}}}return">>>="===(r=a.substr(i,4))?{type:7,value:r,start:o,end:i+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:7,value:n,start:o,end:i+=3}:s===(t=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===t?{type:7,value:t,start:o,end:i+=2}:"<>=!+-*%&|^/".indexOf(s)>=0?{type:7,value:s,start:o,end:++i}:void H({},f,v)}function R(){var e,t,n;if(x(b((n=a[i]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=i,e="","."!==n){if(e=a[i++],n=a[i],"0"===e){if("x"===n||"X"===n)return++i,function(e){for(var t="";i<o&&k(a[i]);)t+=a[i++];return 0===t.length&&H({},f,v),C(a.charCodeAt(i))&&H({},f,v),{type:6,value:parseInt("0x"+t,16),start:e,end:i}}(t);if(w(n))return function(e){for(var t="0"+a[i++];i<o&&w(a[i]);)t+=a[i++];return(C(a.charCodeAt(i))||b(a.charCodeAt(i)))&&H({},f,v),{type:6,value:parseInt(t,8),octal:!0,start:e,end:i}}(t);n&&b(n.charCodeAt(0))&&H({},f,v)}for(;b(a.charCodeAt(i));)e+=a[i++];n=a[i]}if("."===n){for(e+=a[i++];b(a.charCodeAt(i));)e+=a[i++];n=a[i]}if("e"===n||"E"===n)if(e+=a[i++],"+"!==(n=a[i])&&"-"!==n||(e+=a[i++]),b(a.charCodeAt(i)))for(;b(a.charCodeAt(i));)e+=a[i++];else H({},f,v);return C(a.charCodeAt(i))&&H({},f,v),{type:6,value:parseFloat(e),start:t,end:i}}function M(){var e,t,n,r;return u=null,T(),e=i,t=function(){var e,t,n,r;for(x("/"===(e=a[i]),"Regular expression literal must start with a slash"),t=a[i++],n=!1,r=!1;i<o;)if(t+=e=a[i++],"\\"===e)E((e=a[i++]).charCodeAt(0))&&H({},p),t+=e;else if(E(e.charCodeAt(0)))H({},p);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||H({},p),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(t="",n="";i<o&&S((e=a[i]).charCodeAt(0));)++i,"\\"===e&&i<o?H({},f,v):(n+=e,t+=e);return n.search(/[^gimuy]/g)>=0&&H({},d,n),{value:n,literal:t}}(),r=function(e,t){var n=e;t.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,(function(e,t){if(parseInt(t,16)<=1114111)return"x";H({},d)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(e){H({},d)}try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:i}}function B(){var e;return T(),i>=o?{type:2,start:i,end:i}:C(e=a.charCodeAt(i))?_():40===e||41===e||59===e?I():39===e||34===e?function(){var e,t,n,r,u="",s=!1;for(x("'"===(e=a[i])||'"'===e,"String literal must starts with a quote"),t=i,++i;i<o;){if((n=a[i++])===e){e="";break}if("\\"===n)if((n=a[i++])&&E(n.charCodeAt(0)))"\r"===n&&"\n"===a[i]&&++i;else switch(n){case"u":case"x":"{"===a[i]?(++i,u+=F()):u+=D(n);break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"b":u+="\b";break;case"f":u+="\f";break;case"v":u+="\v";break;default:w(n)?(0!==(r="01234567".indexOf(n))&&(s=!0),i<o&&w(a[i])&&(s=!0,r=8*r+"01234567".indexOf(a[i++]),"0123".indexOf(n)>=0&&i<o&&w(a[i])&&(r=8*r+"01234567".indexOf(a[i++]))),u+=String.fromCharCode(r)):u+=n}else{if(E(n.charCodeAt(0)))break;u+=n}}return""!==e&&H({},f,v),{type:8,value:u,octal:s,start:t,end:i}}():46===e?b(a.charCodeAt(i+1))?R():I():b(e)?R():I()}function P(){var e;return i=(e=u).end,u=B(),i=e.end,e}function L(){var e;e=i,u=B(),i=e}function j(e,t,n){var r=new c.default("||"===e||"&&"===e?"LogicalExpression":"BinaryExpression");return r.operator=e,r.left=t,r.right=n,r}function z(e,t){var n=new c.default("CallExpression");return n.callee=e,n.arguments=t,n}function U(e){var t=new c.default(l);return t.name=e,t}function V(e){var t=new c.default("Literal");return t.value=e.value,t.raw=a.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function W(e,t,n){var r=new c.default("MemberExpression");return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function G(e,t,n){var r=new c.default("Property");return r.key=t,r.value=n,r.kind=e,r}function H(e,t){var n,r=Array.prototype.slice.call(arguments,2),a=t.replace(/%(\d)/g,(function(e,t){return x(t<r.length,"Message reference must be in range"),r[t]}));throw(n=new Error(a)).index=i,n.description=a,n}function q(e){2===e.type&&H(e,"Unexpected end of input"),6===e.type&&H(e,"Unexpected number"),8===e.type&&H(e,"Unexpected string"),3===e.type&&H(e,"Unexpected identifier"),4===e.type&&H(e,"Unexpected reserved word"),H(e,f,e.value)}function J(e){var t=P();7===t.type&&t.value===e||q(t)}function K(e){return 7===u.type&&u.value===e}function X(e){return 4===u.type&&u.value===e}function Y(){var e=[];for(i=u.start,J("[");!K("]");)K(",")?(P(),e.push(null)):(e.push(se()),K("]")||J(","));return P(),function(e){var t=new c.default("ArrayExpression");return t.elements=e,t}(e)}function Q(){var e;return i=u.start,8===(e=P()).type||6===e.type?(e.octal&&H(e,h),V(e)):U(e.value)}function Z(){var e,t,n;return i=u.start,3===(e=u).type?(n=Q(),J(":"),G("init",n,se())):2!==e.type&&7!==e.type?(t=Q(),J(":"),G("init",t,se())):void q(e)}function $(){var e,t,n=[],r={},a=String;for(i=u.start,J("{");!K("}");)t="$"+((e=Z()).key.type===l?e.key.name:a(e.key.value)),Object.prototype.hasOwnProperty.call(r,t)?H({},"Duplicate data property in object literal not allowed in strict mode"):r[t]=!0,n.push(e),K("}")||J(",");return J("}"),function(e){var t=new c.default("ObjectExpression");return t.properties=e,t}(n)}var ee={if:1};function te(){var e,t,n;if(K("("))return function(){var e;return J("("),e=ce(),J(")"),e}();if(K("["))return Y();if(K("{"))return $();if(e=u.type,i=u.start,3===e||ee[u.value])n=U(P().value);else if(8===e||6===e)u.octal&&H(u,h),n=V(P());else{if(4===e)throw new Error(g);1===e?((t=P()).value="true"===t.value,n=V(t)):5===e?((t=P()).value=null,n=V(t)):K("/")||K("/=")?(n=V(M()),L()):q(P())}return n}function ne(){var e=[];if(J("("),!K(")"))for(;i<o&&(e.push(se()),!K(")"));)J(",");return J(")"),e}function re(){return J("."),i=u.start,function(e){return 3===e.type||4===e.type||1===e.type||5===e.type}(e=P())||q(e),U(e.value);var e}function ae(){var e;return J("["),e=ce(),J("]"),e}function ie(){var e=function(){var e;for(e=te();;)if(K("."))e=W(".",e,re());else if(K("("))e=z(e,ne());else{if(!K("["))break;e=W("[",e,ae())}return e}();if(7===u.type&&(K("++")||K("--")))throw new Error(g);return e}function oe(){var e,t,n,r,a;if(7!==u.type&&4!==u.type)t=ie();else{if(K("++")||K("--"))throw new Error(g);if(K("+")||K("-")||K("~")||K("!"))e=P(),t=oe(),n=e.value,r=t,(a=new c.default("UnaryExpression")).operator=n,a.argument=r,a.prefix=!0,t=a;else{if(X("delete")||X("void")||X("typeof"))throw new Error(g);t=ie()}}return t}function ue(e){var t=0;if(7!==e.type&&4!==e.type)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function se(){var e,t;return e=function(){var e,t,n,r,a,i,o,s,c,l;if(e=u,c=oe(),0===(a=ue(r=u)))return c;for(r.prec=a,P(),t=[e,u],i=[c,r,o=oe()];(a=ue(u))>0;){for(;i.length>2&&a<=i[i.length-2].prec;)o=i.pop(),s=i.pop().value,c=i.pop(),t.pop(),n=j(s,c,o),i.push(n);(r=P()).prec=a,i.push(r),t.push(u),n=oe(),i.push(n)}for(n=i[l=i.length-1],t.pop();l>1;)t.pop(),n=j(i[l-1].value,i[l-2],n),l-=2;return n}(),K("?")&&(P(),t=se(),J(":"),e=function(e,t,n){var r=new c.default("ConditionalExpression");return r.test=e,r.consequent=t,r.alternate=n,r}(e,t,se())),e}function ce(){var e=se();if(K(","))throw new Error(g);return e}function le(e){i=0,o=(a=e).length,u=null,L();var t=ce();if(2!==u.type)throw new Error("Unexpect token after expression.");return t}})),s.register("25Q13",(function(e,t){s("4UrXf"),s("8azSx"),s("Z6CwE")})),s.register("4UrXf",(function(e,t){n(e.exports,"default",(function(){return r}));var r={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"}})),s.register("8azSx",(function(e,t){n(e.exports,"default",(function(){return a}));var r=s("Z6CwE");function a(e){function t(t,n,r){return function(a){return function(t,n,r,a){var i=e(n[0]);return r&&(i=r+"("+i+")",0===r.lastIndexOf("new ",0)&&(i="("+i+")")),i+"."+t+(a<0?"":0===a?"()":"("+n.slice(1).map(e).join(",")+")")}(t,a,n,r)}}var n="new Date",a="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(t){t.length<3&&r.error("Missing arguments to clamp function."),t.length>3&&r.error("Too many arguments to clamp function.");var n=t.map(e);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:t("getDate",n,0),day:t("getDay",n,0),year:t("getFullYear",n,0),month:t("getMonth",n,0),hours:t("getHours",n,0),minutes:t("getMinutes",n,0),seconds:t("getSeconds",n,0),milliseconds:t("getMilliseconds",n,0),time:t("getTime",n,0),timezoneoffset:t("getTimezoneOffset",n,0),utcdate:t("getUTCDate",n,0),utcday:t("getUTCDay",n,0),utcyear:t("getUTCFullYear",n,0),utcmonth:t("getUTCMonth",n,0),utchours:t("getUTCHours",n,0),utcminutes:t("getUTCMinutes",n,0),utcseconds:t("getUTCSeconds",n,0),utcmilliseconds:t("getUTCMilliseconds",n,0),length:t("length",null,-1),join:t("join",null),indexof:t("indexOf",null),lastindexof:t("lastIndexOf",null),slice:t("slice",null),reverse:function(t){return"("+e(t[0])+").slice().reverse()"},parseFloat:"parseFloat",parseInt:"parseInt",upper:t("toUpperCase",a,0),lower:t("toLowerCase",a,0),substring:t("substring",a),split:t("split",a),replace:t("replace",a),trim:t("trim",a,0),regexp:i,test:t("test",i),if:function(t){t.length<3&&r.error("Missing arguments to if function."),t.length>3&&r.error("Too many arguments to if function.");var n=t.map(e);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}})),s.register("Z6CwE",(function(e,t){function r(e,t,n){return e.fields=t||[],e.fname=n,e}function a(e){return 1===e.length?i(e[0]):o(e)}n(e.exports,"error",(function(){return u})),n(e.exports,"isFunction",(function(){return l})),n(e.exports,"hasOwnProperty",(function(){return d})),n(e.exports,"isString",(function(){return p})),n(e.exports,"toSet",(function(){return h}));var i=function(e){return function(t){return t[e]}},o=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function u(e){throw Error(e)}function s(e){var t,n,r,a=[],i=e.length,o=null,s=0,c="";function l(){a.push(c+e.substring(t,n)),c="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))c+=e.substring(t,n),c+=e.substring(++n,++n),t=n;else if(r===o)l(),o=null,s=-1;else{if(o)continue;t===s&&'"'===r||t===s&&"'"===r?(t=n+1,o=r):"."!==r||s?"["===r?(n>t&&l(),s=t=n+1):"]"===r&&(s||u("Access path missing open bracket: "+e),s>0&&l(),s=0,t=n+1):n>t?l():t=n+1}return s&&u("Access path missing closing bracket: "+e),o&&u("Access path missing closing quote: "+e),n>t&&(n++,l()),a}function c(e,t,n){var i=s(e);return e=1===i.length?i[0]:e,r((n&&n.get||a)(i),[e],t||e)}c("id"),r((function(e){return e}),[],"identity"),r((function(){return 0}),[],"zero"),r((function(){return 1}),[],"one"),r((function(){return!0}),[],"true"),r((function(){return!1}),[],"false");Array.isArray;function l(e){return"function"==typeof e}var f=Object.prototype.hasOwnProperty;function d(e,t){return f.call(e,t)}function p(e){return"string"==typeof e}function h(e){for(var t={},n=e.length,r=0;r<n;++r)t[e[r]]=!0;return t}})),s.register("fDBRf",(function(e,t){n(e.exports,"assembleTitleGroup",(function(){return y})),n(e.exports,"assembleHeaderGroups",(function(){return k})),n(e.exports,"assembleLabelTitle",(function(){return A})),n(e.exports,"assembleLayoutTitleBand",(function(){return N})),s("1i51P");var r=s("4Ui3v");s("iSlfb");var a=s("4ujSI"),i=s("e3OyN"),o=s("iooJ7"),u=s("clhMD"),c=s("2V3EF"),l=s("pZnnI"),f=s("lSb9O"),d=s("1m8vd"),p=s("fFVzC"),h=s("ixH3E"),v=s("jZr2L"),g=s("doORn"),m=s("7HuhJ");function y(e,t){var n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,a=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0,i=g.getHeaderProperties(["titleAnchor","titleAngle","titleOrient"],a,r,t),o=i.titleAnchor,s=i.titleAngle,c=i.titleOrient,l=g.getHeaderChannel(t,c),d=f.normalizeAngle(s);return{name:"".concat(t,"-title"),type:"group",role:"".concat(l,"-title"),title:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:n},"row"===t?{orient:"left"}:{}),{style:"guide-title"}),b(d,l)),x(l,d,o)),T(r,a,t,u.HEADER_TITLE_PROPERTIES,u.HEADER_TITLE_PROPERTIES_MAP))}}function x(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"middle";switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}var r=d.defaultLabelAlign(t,"row"===e?"left":"top","row"===e?"y":"x");return r?{align:r}:{}}function b(e,t){var n=d.defaultLabelBaseline(e,"row"===t?"left":"top","row"===t?"y":"x",!0);return n?{baseline:n}:{}}function k(e,t){var n=e.component.layoutHeaders[t],r=[],a=!0,i=!1,o=void 0;try{for(var u,s=m.HEADER_TYPES[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value,l=!0,f=!1,d=void 0;if(n[c])try{for(var p,h=n[c][Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=E(e,t,c,n,p.value);null!=v&&r.push(v)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return r}function w(e,t){var n,r=e.sort;return c.isSortField(r)?{field:o.vgField(r,{expr:"datum"}),order:null!==(n=r.order)&&void 0!==n?n:"ascending"}:a.default(r)?{field:p.sortArrayIndexField(e,t,{expr:"datum"}),order:"ascending"}:{field:o.vgField(e,{expr:"datum"}),order:null!=r?r:"ascending"}}function A(e,t,n){var r=g.getHeaderProperties(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],e,n,t),a=r.format,i=r.formatType,s=r.labelAngle,c=r.labelAnchor,l=r.labelOrient,d=r.labelExpr,p=h.formatSignalRef({fieldOrDatumDef:e,format:a,formatType:i,expr:"parent",config:n}).signal,v=g.getHeaderChannel(t,l);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({text:{signal:d?f.replaceAll(f.replaceAll(d,"datum.label",p),"datum.value",o.vgField(e,{expr:"parent"})):p}},"row"===t?{orient:"left"}:{}),{style:"guide-label",frame:"group"}),b(s,v)),x(v,s,c)),T(n,e,t,u.HEADER_LABEL_PROPERTIES,u.HEADER_LABEL_PROPERTIES_MAP))}function E(e,t,n,a,i){if(i){var o=null,u=a.facetFieldDef,s=e.config?e.config:void 0;if(u&&i.labels){var c=g.getHeaderProperties(["labelOrient"],u,s,t).labelOrient;("row"===t&&!f.contains(["top","bottom"],c)||"column"===t&&!f.contains(["left","right"],c))&&(o=A(u,t,s))}var d=v.isFacetModel(e)&&!l.isFacetMapping(e.facet),p=i.axes,h=(null==p?void 0:p.length)>0;if(o||h){var m="row"===t?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("".concat(t,"_").concat(n)),type:"group",role:"".concat(t,"-").concat(n)},a.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:w(u,t)}:{}),h&&d?{from:{data:e.getName("facet_domain_".concat(t))}}:{}),o?{title:o}:{}),i.sizeSignal?{encode:{update:r.default({},m,i.sizeSignal)}}:{}),h?{axes:p}:{})}}return null}var C={column:{start:0,end:1},row:{start:1,end:0}};function S(e,t){return C[t][e]}function N(e,t){var n={},r=!0,a=!1,o=void 0;try{for(var u,s=i.FACET_CHANNELS[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value,l=e[c];if(null==l?void 0:l.facetFieldDef){var d=g.getHeaderProperties(["titleAnchor","titleOrient"],l.facetFieldDef,t,c),p=d.titleAnchor,h=d.titleOrient,v=g.getHeaderChannel(c,h),m=S(p,v);void 0!==m&&(n[v]=m)}}}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return f.isEmpty(n)?void 0:n}function T(e,t,n,r,a){var i={},o=!0,u=!1,s=void 0;try{for(var c,l=r[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;if(a[f]){var d=g.getHeaderProperty(f,t,e,n);void 0!==d&&(i[a[f]]=d)}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return i}})),s.register("clhMD",(function(e,t){n(e.exports,"HEADER_TITLE_PROPERTIES_MAP",(function(){return a})),n(e.exports,"HEADER_LABEL_PROPERTIES_MAP",(function(){return i})),n(e.exports,"HEADER_TITLE_PROPERTIES",(function(){return o})),n(e.exports,"HEADER_LABEL_PROPERTIES",(function(){return u}));var r=s("lSb9O"),a={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},i={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},o=r.keys(a),u=r.keys(i)})),s.register("1m8vd",(function(e,t){n(e.exports,"axisRules",(function(){return g})),n(e.exports,"defaultLabelAlign",(function(){return b})),n(e.exports,"defaultLabelBaseline",(function(){return x})),n(e.exports,"getFieldDefTitle",(function(){return w})),n(e.exports,"getLabelAngle",(function(){return m})),n(e.exports,"defaultOrient",(function(){return k})),s("iSlfb");var r=s("4ujSI"),a=s("61RXI"),i=s("e3OyN"),o=s("iooJ7"),u=s("7J7Lf"),c=s("gQOdy"),l=s("4jgmF"),f=s("lSb9O"),d=s("7T458"),p=s("9iwJo"),h=s("ixH3E"),v=s("k1xRj"),g={scale:function(e){var t=e.model,n=e.channel;return t.scaleName(n)},format:function(e){var t=e.fieldOrDatumDef,n=e.config,r=e.axis,a=r.format,i=r.formatType;return h.guideFormat(t,t.type,a,i,n,!0)},formatType:function(e){var t=e.axis,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return h.guideFormatType(a,n,r)},grid:function(e){var t,n=e.fieldOrDatumDef,r=e.axis,i=e.scaleType;return(!o.isFieldDef(n)||!a.isBinned(n.bin))&&(null!==(t=r.grid)&&void 0!==t?t:function(e,t){return!u.hasDiscreteDomain(e)&&o.isFieldDef(t)&&!a.isBinning(null==t?void 0:t.bin)}(i,n))},gridScale:function(e){return function(e,t){var n="x"===t?"y":"x";return e.getScaleComponent(n)?e.scaleName(n):void 0}(e.model,e.channel)},labelAlign:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelAlign||b(n,r,a)},labelAngle:function(e){return e.labelAngle},labelBaseline:function(e){var t=e.axis,n=e.labelAngle,r=e.orient,a=e.channel;return t.labelBaseline||x(n,r,a)},labelFlush:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.channel;return null!==(t=n.labelFlush)&&void 0!==t?t:function(e,t){return!("x"!==t||!f.contains(["quantitative","temporal"],e))||void 0}(r.type,a)},labelOverlap:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.scaleType;return null!==(t=n.labelOverlap)&&void 0!==t?t:function(e,t){if("nominal"!==e)return"log"!==t||"greedy";return}(r.type,a)},orient:function(e){return e.orient},tickCount:function(e){var t,n=e.channel,r=e.model,i=e.axis,s=e.fieldOrDatumDef,l=e.scaleType,d="x"===n?"width":"y"===n?"height":void 0,p=d?r.getSizeSignalRef(d):void 0;return null!==(t=i.tickCount)&&void 0!==t?t:function(e){var t,n=e.fieldOrDatumDef,r=e.scaleType,i=e.size;if(!e.values&&!u.hasDiscreteDomain(r)&&"log"!==r){if(o.isFieldDef(n)){if(a.isBinning(n.bin))return{signal:"ceil(".concat(i.signal,"/10)")};if(n.timeUnit&&f.contains(["month","hours","day","quarter"],null===(t=c.normalizeTimeUnit(n.timeUnit))||void 0===t?void 0:t.unit))return}return{signal:"ceil(".concat(i.signal,"/40)")}}return}({fieldOrDatumDef:s,scaleType:l,size:p,values:i.values})},title:function(e){var t=e.axis,n=e.model,r=e.channel;if(void 0!==t.title)return t.title;var a=w(n,r);if(void 0!==a)return a;var i=n.typedFieldDef(r),u="x"===r?"x2":"y2",s=n.fieldDef(u);return p.mergeTitleFieldDefs(i?[o.toFieldDefBase(i)]:[],o.isFieldDef(s)?[o.toFieldDefBase(s)]:[])},values:function(e){return function(e,t){var n=e.values;if(r.default(n))return o.valueArray(t,n);if(d.isSignalRef(n))return n;return}(e.axis,e.fieldOrDatumDef)},zindex:function(e){var t,n=e.axis,r=e.fieldOrDatumDef,a=e.mark;return null!==(t=n.zindex)&&void 0!==t?t:function(e,t){return"rect"===e&&o.isDiscrete(t)?1:0}(a,r)}};function m(e,t,n,r,a){var o=null==t?void 0:t.labelAngle;if(void 0!==o)return d.isSignalRef(o)?o:f.normalizeAngle(o);var u=v.getAxisConfig("labelAngle",e.config,null==t?void 0:t.style,a).configValue;return void 0!==u?f.normalizeAngle(u):n===i.X&&f.contains([l.NOMINAL,l.ORDINAL],r.type)?270:void 0}function y(e){return"(((".concat(e.signal," % 360) + 360) % 360)")}function x(e,t,n,r){if(void 0!==e){if("x"===n){if(d.isSignalRef(e)){var a=y(e),i=d.isSignalRef(t)?"(".concat(t.signal,' === "top")'):"top"===t;return{signal:"(45 < ".concat(a," && ").concat(a," < 135) || (225 < ").concat(a," && ").concat(a,' < 315) ? "middle" :')+"(".concat(a," <= 45 || 315 <= ").concat(a,") === ").concat(i,' ? "bottom" : "top"')}}if(45<e&&e<135||225<e&&e<315)return"middle";if(d.isSignalRef(t)){var o=e<=45||315<=e?"===":"!==";return{signal:"".concat(t.signal," ").concat(o,' "top" ? "bottom" : "top"')}}return(e<=45||315<=e)==("top"===t)?"bottom":"top"}if(d.isSignalRef(e)){var u=y(e),s=d.isSignalRef(t)?"(".concat(t.signal,' === "left")'):"left"===t,c=r?'"middle"':"null";return{signal:"".concat(u," <= 45 || 315 <= ").concat(u," || (135 <= ").concat(u," && ").concat(u," <= 225) ? ").concat(c," : (45 <= ").concat(u," && ").concat(u," <= 135) === ").concat(s,' ? "top" : "bottom"')}}if(e<=45||315<=e||135<=e&&e<=225)return r?"middle":null;if(d.isSignalRef(t)){var l=45<=e&&e<=135?"===":"!==";return{signal:"".concat(t.signal," ").concat(l,' "left" ? "top" : "bottom"')}}return(45<=e&&e<=135)==("left"===t)?"top":"bottom"}}function b(e,t,n){if(void 0!==e){var r="x"===n,a=r?0:90,i=r?"bottom":"left";if(d.isSignalRef(e)){var o=y(e),u=d.isSignalRef(t)?"(".concat(t.signal,' === "').concat(i,'")'):t===i;return{signal:"(".concat(a?"("+o+" + 90)":o," % 180 === 0) ? ").concat(r?null:'"center"'," :")+"(".concat(a," < ").concat(o," && ").concat(o," < ").concat(180+a,") === ").concat(u,' ? "left" : "right"')}}if((e+a)%180==0)return r?null:"center";if(d.isSignalRef(t)){var s=a<e&&e<180+a?"===":"!==",c="".concat(t.signal," ").concat(s,' "').concat(i,'"');return{signal:"".concat(c,' ? "left" : "right"')}}return(a<e&&e<180+a)==(t===i)?"left":"right"}}function k(e){return"x"===e?"bottom":"left"}function w(e,t){var n="x"===t?"x2":"y2",r=e.fieldDef(t),a=e.fieldDef(n),i=r?r.title:void 0,o=a?a.title:void 0;return i&&o?p.mergeTitle(i,o):i||(o||(void 0!==i?i:void 0!==o?o:void 0))}})),s.register("k1xRj",(function(e,t){n(e.exports,"getAxisConfigs",(function(){return f})),n(e.exports,"getAxisConfig",(function(){return p})),s("1i51P");var r=s("9M1dW");s("iSlfb");var a=s("1Ihp0"),i=s("7J7Lf"),o=s("lSb9O"),u=s("7T458"),c=s("9iwJo");function l(e,t,n,a){return Object.assign.apply(null,[{}].concat(r.default(e.map((function(e){if("axisOrient"===e){var i="x"===n?"bottom":"left",u=t["x"===n?"axisBottom":"axisLeft"]||{},s=t["x"===n?"axisTop":"axisRight"]||{},l=new Set(r.default(o.keys(u)).concat(r.default(o.keys(s)))),f={},d=!0,p=!1,h=void 0;try{for(var v,g=l.values()[Symbol.iterator]();!(d=(v=g.next()).done);d=!0){var m=v.value;f[m]={signal:"".concat(a.signal,' === "').concat(i,'" ? ').concat(c.signalOrStringValue(u[m])," : ").concat(c.signalOrStringValue(s[m]))}}}catch(e){p=!0,h=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw h}}return f}return t[e]})))))}function f(e,t,n,a){var s="band"===t?["axisDiscrete","axisBand"]:"point"===t?["axisDiscrete","axisPoint"]:i.isQuantitative(t)?["axisQuantitative"]:"time"===t||"utc"===t?["axisTemporal"]:[],c="x"===e?"axisX":"axisY",f=u.isSignalRef(n)?"axisOrient":"axis"+o.titleCase(n),p=r.default(s).concat(r.default(s.map((function(e){return c+e.substr(4)})))),h=["axis",f,c];return{vlOnlyAxisConfig:l(p,a,e,n),vgAxisConfig:l(h,a,e,n),axisConfigStyle:d(r.default(h).concat(r.default(p)),a)}}function d(e,t){var n,r=[{}],i=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=null===(n=t[s.value])||void 0===n?void 0:n.style;if(l){l=a.default(l);var f=!0,d=!1,p=void 0;try{for(var h,v=l[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var g=h.value;r.push(t.style[g])}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}}}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}return Object.assign.apply(null,r)}function p(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=c.getStyleConfig(e,n,t.style);if(void 0!==i)return{configFrom:"style",configValue:i};var o=!0,u=!1,s=void 0;try{for(var l,f=["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"][Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var d=l.value;if(void 0!==(null===(r=a[d])||void 0===r?void 0:r[e]))return{configFrom:d,configValue:a[d][e]}}}catch(e){u=!0,s=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}return{}}})),s.register("fFVzC",(function(e,t){n(e.exports,"CalculateNode",(function(){return h})),n(e.exports,"sortArrayIndexField",(function(){return v})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("iooJ7"),c=s("ceGn0"),l=s("2V3EF"),f=s("lSb9O"),d=s("5XgHP"),p=s("38SzU"),h=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).transform=r,a._dependentFields=p.getDependentFields(a.transform.calculate),a}return o.default(n,[{key:"clone",value:function(){return new n(null,f.duplicate(this.transform))}},{key:"producedFields",value:function(){return new Set([this.transform.as])}},{key:"dependentFields",value:function(){return this._dependentFields}},{key:"assemble",value:function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}},{key:"hash",value:function(){return"Calculate ".concat(f.hash(this.transform))}}],[{key:"parseAllForSortIndex",value:function(e,t){return t.forEachFieldDef((function(t,r){if(u.isScaleFieldDef(t)&&l.isSortArray(t.sort)){var a=t.field,i=t.timeUnit,o=t.sort,s=o.map((function(e,t){return"".concat(c.fieldFilterExpression({field:a,timeUnit:i,equal:e})," ? ").concat(t," : ")})).join("")+o.length;e=new n(e,{calculate:s,as:v(t,r,{forAs:!0})})}})),e}}]),n}(d.DataFlowNode);function v(e,t,n){return u.vgField(e,Object.assign({prefix:t,suffix:"sort_index"},null!=n?n:{}))}})),s.register("doORn",(function(e,t){n(e.exports,"getHeaderChannel",(function(){return a})),n(e.exports,"getHeaderProperty",(function(){return i})),n(e.exports,"getHeaderProperties",(function(){return o}));var r=s("lSb9O");function a(e,t){return r.contains(["top","bottom"],t)?"column":r.contains(["left","right"],t)||"row"===e?"row":"column"}function i(e,t,n,a){var i="row"===a?n.headerRow:"column"===a?n.headerColumn:n.headerFacet;return r.getFirstDefined(((null==t?void 0:t.header)||{})[e],i[e],n.header[e])}function o(e,t,n,r){var a={},o=!0,u=!1,s=void 0;try{for(var c,l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value,d=i(f,t,n,r);void 0!==d&&(a[f]=d)}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}return a}})),s.register("7HuhJ",(function(e,t){n(e.exports,"HEADER_CHANNELS",(function(){return r})),n(e.exports,"HEADER_TYPES",(function(){return a}));var r=["row","column"],a=["header","footer"]})),s.register("iUaCf",(function(e,t){n(e.exports,"assembleLayoutSignals",(function(){return l})),n(e.exports,"sizeExpr",(function(){return p})),s("1i51P");var r=s("9M1dW"),a=s("fldOo"),i=s("7J7Lf"),o=s("lSb9O"),u=s("7T458"),c=s("jZr2L");function l(e){return r.default(f(e,"width")).concat(r.default(f(e,"height")),r.default(f(e,"childWidth")),r.default(f(e,"childHeight")))}function f(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var o=e.getSizeSignalRef(t).signal;if("step"===r){var s=e.getScaleComponent(n);if(s){var l=s.get("type"),f=s.get("range");if(i.hasDiscreteDomain(l)&&u.isVgRangeStep(f)){var h=e.scaleName(n);if(c.isFacetModel(e.parent))if("independent"===e.parent.component.resolve.scale[n])return[d(h,f)];return[d(h,f),{name:o,update:p(h,s,"domain('".concat(h,"').length"))}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){var v=o.endsWith("width"),g=v?"containerSize()[0]":"containerSize()[1]",m=a.getViewConfigContinuousSize(e.config.view,v?"width":"height"),y="isFinite(".concat(g,") ? ").concat(g," : ").concat(m);return[{name:o,init:y,on:[{update:y,events:"window:resize"}]}]}return[{name:o,value:r}]}function d(e,t){return{name:e+"_step",value:t.step}}function p(e,t,n){var r=t.get("type"),a=t.get("padding"),i=o.getFirstDefined(t.get("paddingOuter"),a),u=t.get("paddingInner");return u="band"===r?void 0!==u?u:a:1,"bandspace(".concat(n,", ").concat(u,", ").concat(i,") * ").concat(e,"_step")}})),s.register("1ByWd",(function(e,t){function r(e){return"childWidth"===e?"width":"childHeight"===e?"height":e}n(e.exports,"getSizeTypeFromLayoutSizeType",(function(){return r}))})),s.register("lgWLp",(function(e,t){n(e.exports,"assembleLegends",(function(){return l}));var r=s("2lx0N"),a=s("9280j"),i=s("lSb9O"),o=s("7T458"),u=s("5fWDg");function c(e,t,n,r){var a,i,o;e.encode=null!==(a=e.encode)&&void 0!==a?a:{},e.encode[t]=null!==(i=e.encode[t])&&void 0!==i?i:{},e.encode[t].update=null!==(o=e.encode[t].update)&&void 0!==o?o:{},e.encode[t].update[n]=r}function l(e){var t=e.component.legends,n={},s=!0,l=!1,f=void 0;try{for(var d,p=i.keys(t)[Symbol.iterator]();!(s=(d=p.next()).done);s=!0){var h=d.value,v=e.getScaleComponent(h),g=i.stringify(v.get("domains")),m=!0,y=!1,x=void 0;if(n[g])try{for(var b,k=n[g][Symbol.iterator]();!(m=(b=k.next()).done);m=!0){var w=b.value;u.mergeLegendComponent(w,t[h])||n[g].push(t[h])}}catch(e){y=!0,x=e}finally{try{m||null==k.return||k.return()}finally{if(y)throw x}}else n[g]=[t[h].clone()]}}catch(e){l=!0,f=e}finally{try{s||null==p.return||p.return()}finally{if(l)throw f}}var A=i.vals(n).flat().map((function(t){return function(e,t){var n,u,s,l=e.combine(),f=l.disable,d=l.labelExpr,p=(l.selections,r.__rest(l,["disable","labelExpr","selections"]));if(f)return;!1===t.aria&&null==p.aria&&(p.aria=!1);if(null===(n=p.encode)||void 0===n?void 0:n.symbols){var h=p.encode.symbols.update;!h.fill||"transparent"===h.fill.value||h.stroke||p.stroke||(h.stroke={value:"transparent"});var v=!0,g=!1,m=void 0;try{for(var y,x=a.LEGEND_SCALE_CHANNELS[Symbol.iterator]();!(v=(y=x.next()).done);v=!0){var b=y.value;p[b]&&delete h[b]}}catch(e){g=!0,m=e}finally{try{v||null==x.return||x.return()}finally{if(g)throw m}}}p.title||delete p.title;if(void 0!==d){var k=d;(null===(s=null===(u=p.encode)||void 0===u?void 0:u.labels)||void 0===s?void 0:s.update)&&o.isSignalRef(p.encode.labels.update.text)&&(k=i.replaceAll(d,"datum.label",p.encode.labels.update.text.signal)),c(p,"labels","text",{signal:k})}for(var w in p){var A=p[w];if(o.isSignalRef(A)){var E=a.SIGNAL_LEGEND_PROP_INDEX[w];if(E){var C=E.vgProp;c(p,E.part,C,A),delete p[w]}}}return p}(t,e.config)})).filter((function(e){return void 0!==e}));return A}})),s.register("5fWDg",(function(e,t){n(e.exports,"parseLegend",(function(){return k})),n(e.exports,"mergeLegendComponent",(function(){return E})),s("1i51P");var r=s("9M1dW"),a=s("4Ui3v"),i=s("e3OyN"),o=s("iooJ7"),u=s("9280j"),c=s("gQOdy"),l=s("4jgmF"),f=s("lSb9O"),d=s("9iwJo"),p=s("cN8QU"),h=s("jZr2L"),v=s("598xZ"),g=s("6B2G8"),m=s("CFwcG"),y=s("96MFK"),x=s("5SM9U"),b=s("lE56e");function k(e){var t=h.isUnitModel(e)?function(e){var t=e.encoding,n={},a=!0,s=!1,c=void 0;try{for(var f,d=[i.COLOR].concat(r.default(u.LEGEND_SCALE_CHANNELS))[Symbol.iterator]();!(a=(f=d.next()).done);a=!0){var p=f.value,h=o.getFieldOrDatumDef(t[p]);h&&e.getScaleComponent(p)&&(p===i.SHAPE&&o.isFieldDef(h)&&h.type===l.GEOJSON||(n[p]=A(e,p)))}}catch(e){s=!0,c=e}finally{try{a||null==d.return||d.return()}finally{if(s)throw c}}return n}(e):function(e){var t=e.component,n=t.legends,r=t.resolve,a=!0,i=!1,o=void 0;try{for(var u,s=e.children[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;k(c);var l=!0,d=!1,p=void 0;try{for(var h,g=f.keys(c.component.legends)[Symbol.iterator]();!(l=(h=g.next()).done);l=!0){var m=h.value;r.legend[m]=v.parseGuideResolve(e.component.resolve,m),"shared"===r.legend[m]&&(n[m]=E(n[m],c.component.legends[m]),n[m]||(r.legend[m]="independent",delete n[m]))}}catch(e){d=!0,p=e}finally{try{l||null==g.return||g.return()}finally{if(d)throw p}}}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}var y=!0,x=!1,b=void 0,w=!0,A=!1,C=void 0;try{for(var S,N=f.keys(n)[Symbol.iterator]();!(w=(S=N.next()).done);w=!0){var T=S.value;try{for(var D,F=e.children[Symbol.iterator]();!(y=(D=F.next()).done);y=!0){var O=D.value;O.component.legends[T]&&("shared"===r.legend[T]&&delete O.component.legends[T])}}catch(e){x=!0,b=e}finally{try{y||null==F.return||F.return()}finally{if(x)throw b}}}}catch(e){A=!0,C=e}finally{try{w||null==N.return||N.return()}finally{if(A)throw C}}return n}(e);return e.component.legends=t,t}function w(e,t,n,r){switch(t){case"disable":return void 0!==n;case"values":return!!(null==n?void 0:n.values);case"title":if("title"===t&&e===(null==r?void 0:r.title))return!0}return e===(n||{})[t]}function A(e,t){var n,r,i,u=e.legend(t),s=e.markDef,l=e.encoding,d=e.config,h=d.legend,v=new y.LegendComponent({},function(e,t){var n=e.scaleName(t);if("trail"===e.mark){if("color"===t)return{stroke:n};if("size"===t)return{strokeWidth:n}}return"color"===t?e.markDef.filled?{fill:n}:{stroke:n}:a.default({},t,n)}(e,t));g.parseInteractiveLegend(e,t,v);var m=void 0!==u?!u:h.disable;if(v.set("disable",m,void 0!==u),m)return v;u=u||{};var k=e.getScaleComponent(t).get("type"),A=o.getFieldOrDatumDef(l[t]),E=o.isFieldDef(A)?null===(n=c.normalizeTimeUnit(A.timeUnit))||void 0===n?void 0:n.unit:void 0,C=u.orient||d.legend.orient||"right",S=b.getLegendType({legend:u,channel:t,timeUnit:E,scaleType:k}),N={legend:u,channel:t,model:e,markDef:s,encoding:l,fieldOrDatumDef:A,legendConfig:h,config:d,scaleType:k,orient:C,legendType:S,direction:b.getDirection({legend:u,legendType:S,orient:C,legendConfig:h})},T=!0,D=!1,F=void 0;try{for(var O,_=y.LEGEND_COMPONENT_PROPERTIES[Symbol.iterator]();!(T=(O=_.next()).done);T=!0){var I=O.value,R=I in b.legendRules?b.legendRules[I](N):u[I];if(void 0!==R){var M=w(R,I,u,e.fieldDef(t));(M||void 0===d.legend[I])&&v.set(I,R,M)}}}catch(e){D=!0,F=e}finally{try{T||null==_.return||_.return()}finally{if(D)throw F}}var B=null!==(r=null==u?void 0:u.encoding)&&void 0!==r?r:{},P=v.get("selections"),L={},j={fieldOrDatumDef:A,model:e,channel:t,legendCmpt:v,legendType:S},z=!0,U=!1,V=void 0;try{for(var W,G=["labels","legend","title","symbols","gradient","entries"][Symbol.iterator]();!(z=(W=G.next()).done);z=!0){var H=W.value,q=p.guideEncodeEntry(null!==(i=B[H])&&void 0!==i?i:{},e),J=H in x.legendEncodeRules?x.legendEncodeRules[H](q,j):q;void 0===J||f.isEmpty(J)||(L[H]=Object.assign(Object.assign(Object.assign({},(null==P?void 0:P.length)&&o.isFieldDef(A)?{name:"".concat(f.varName(A.field),"_legend_").concat(H)}:{}),(null==P?void 0:P.length)?{interactive:!!P}:{}),{update:J}))}}catch(e){U=!0,V=e}finally{try{z||null==G.return||G.return()}finally{if(U)throw V}}return f.isEmpty(L)||v.set("encode",L,!!(null==u?void 0:u.encoding)),v}function E(e,t){var n,r,a,i;if(!e)return t.clone();var o=e.getWithExplicit("orient"),u=t.getWithExplicit("orient");if(!o.explicit||!u.explicit||o.value===u.value){var s=!1,c=!0,l=!1,p=void 0;try{for(var h,v=function(n,r){var a=r.value,i=m.mergeValuesWithExplicit(e.getWithExplicit(a),t.getWithExplicit(a),a,"legend",(function(e,t){switch(a){case"symbolType":return n=e,"circle"===(r=t).value?r:n;case"title":return d.mergeTitleComponent(e,t);case"type":return s=!0,m.makeImplicit("symbol")}var n,r;return m.defaultTieBreaker(e,t,a,"legend")}));e.setWithExplicit(a,i)},g=y.LEGEND_COMPONENT_PROPERTIES[Symbol.iterator]();!(c=(h=g.next()).done);c=!0)v(0,h)}catch(e){l=!0,p=e}finally{try{c||null==g.return||g.return()}finally{if(l)throw p}}return s&&((null===(r=null===(n=e.implicit)||void 0===n?void 0:n.encode)||void 0===r?void 0:r.gradient)&&f.deleteNestedProperty(e.implicit,["encode","gradient"]),(null===(i=null===(a=e.explicit)||void 0===a?void 0:a.encode)||void 0===i?void 0:i.gradient)&&f.deleteNestedProperty(e.explicit,["encode","gradient"])),e}}})),s.register("cN8QU",(function(e,t){n(e.exports,"guideEncodeEntry",(function(){return o}));var r=s("lSb9O"),a=s("7T458");s("7fgyI");var i=s("lbihi");function o(e,t){return r.keys(e).reduce((function(n,r){var o=e[r];return Object.assign(Object.assign({},n),i.wrapCondition(t,o,r,(function(e){return a.isSignalRef(e)?e:{value:e.value}})))}),{})}})),s.register("598xZ",(function(e,t){n(e.exports,"defaultScaleResolve",(function(){return u})),n(e.exports,"parseGuideResolve",(function(){return c}));var r=s("e3OyN"),a=s("16rNM"),i=s("2x4HI"),o=s("jZr2L");function u(e,t){if(o.isLayerModel(t)||o.isFacetModel(t))return"shared";if(o.isConcatModel(t))return r.isXorY(e)?"independent":"shared";throw new Error("invalid model type for resolve")}function c(e,t){var n=e.scale[t],o=r.isXorY(t)?"axis":"legend";return"independent"===n?("shared"===e[o][t]&&a.warn(i.independentScaleMeansIndependentGuide(t)),"independent"):e[o][t]||"shared"}})),s.register("96MFK",(function(e,t){n(e.exports,"LEGEND_COMPONENT_PROPERTIES",(function(){return f})),n(e.exports,"LegendComponent",(function(){return d})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("9280j"),u=s("lSb9O"),c=s("CFwcG"),l=Object.assign(Object.assign({},o.COMMON_LEGEND_PROPERTY_INDEX),{disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1}),f=u.keys(l),d=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return n}(c.Split)})),s.register("5SM9U",(function(e,t){n(e.exports,"legendEncodeRules",(function(){return v})),n(e.exports,"getFirstConditionValue",(function(){return m})),s("iSlfb");var r=s("4ujSI"),a=s("1Ihp0"),i=s("1gJgm"),o=s("e3OyN"),u=s("iooJ7"),c=s("4sOzK"),l=s("lSb9O"),f=s("9iwJo"),d=s("ixH3E");s("7fgyI");var p=s("kSkay"),h=s("aukhr"),v={symbols:function(e,t){var n,a,i,s,d,h=t.fieldOrDatumDef,v=t.model,y=t.channel,b=t.legendCmpt;if("symbol"!==t.legendType)return;var k=v.markDef,w=v.encoding,A=v.config,E=v.mark,C=k.filled&&"trail"!==E,S=Object.assign(Object.assign({},f.applyMarkConfig({},v,c.FILL_STROKE_CONFIG)),p.color(v,{filled:C})),N=null!==(n=g(w.opacity))&&void 0!==n?n:k.opacity;if(S.fill)if("fill"===y||C&&y===o.COLOR)delete S.fill;else if(S.fill.field)b.get("symbolFillColor")?delete S.fill:(S.fill=f.signalOrValueRef(null!==(a=A.legend.symbolBaseFillColor)&&void 0!==a?a:"black"),S.fillOpacity=f.signalOrValueRef(null!=N?N:1));else if(r.default(S.fill)){var T=null!==(d=null!==(s=m(null!==(i=w.fill)&&void 0!==i?i:w.color))&&void 0!==s?s:k.fill)&&void 0!==d?d:C&&k.color;T&&(S.fill=f.signalOrValueRef(T))}if(S.stroke)if("stroke"===y||!C&&y===o.COLOR)delete S.stroke;else if(S.stroke.field)delete S.stroke;else if(r.default(S.stroke)){var D=l.getFirstDefined(m(w.stroke||w.color),k.stroke,C?k.color:void 0);D&&(S.stroke={value:D})}if(y!==o.OPACITY){var F=u.isFieldDef(h)&&x(v,b,h);F?S.opacity=[Object.assign({test:F},f.signalOrValueRef(null!=N?N:1)),f.signalOrValueRef(A.legend.unselectedOpacity)]:N&&(S.opacity=f.signalOrValueRef(N))}return S=Object.assign(Object.assign({},S),e),l.isEmpty(S)?void 0:S},gradient:function(e,t){var n=t.model;if("gradient"!==t.legendType)return;var r={},a=g(n.encoding.opacity)||n.markDef.opacity;a&&(r.opacity=f.signalOrValueRef(a));return r=Object.assign(Object.assign({},r),e),l.isEmpty(r)?void 0:r},labels:function(e,t){var n=t.fieldOrDatumDef,r=t.model,a=t.channel,i=t.legendCmpt,o=r.legend(a)||{},s=r.config,c=u.isFieldDef(n)?x(r,i,n):void 0,f=c?[{test:c,value:1},{value:s.legend.unselectedOpacity}]:void 0,p=o.format,h=o.formatType,v=d.isCustomFormatType(h)?d.formatCustomType({fieldOrDatumDef:n,field:"datum.value",format:p,formatType:h,config:s}):void 0,g=Object.assign(Object.assign(Object.assign({},f?{opacity:f}:{}),v?{text:v}:{}),e);return l.isEmpty(g)?void 0:g},entries:function(e,t){var n=t.legendCmpt.get("selections");return(null==n?void 0:n.length)?Object.assign(Object.assign({},e),{fill:{value:"transparent"}}):e}};function g(e){return y(e,(function(e,t){return Math.max(e,t.value)}))}function m(e){return y(e,(function(e,t){return l.getFirstDefined(e,t.value)}))}function y(e,t){return u.hasConditionalValueDef(e)?a.default(e.condition).reduce(t,e.value):u.isValueDef(e)?e.value:void 0}function x(e,t,n){var r=t.get("selections");if(null==r?void 0:r.length){var a=i.default(n.field);return r.map((function(e){var t=i.default(l.varName(e)+h.STORE);return"(!length(data(".concat(t,")) || (").concat(e,"[").concat(a,"] && indexof(").concat(e,"[").concat(a,"], datum.value) >= 0))")})).join(" || ")}}})),s.register("lE56e",(function(e,t){n(e.exports,"legendRules",(function(){return d})),n(e.exports,"getLegendType",(function(){return p})),n(e.exports,"getDirection",(function(){return h})),s("iSlfb");var r=s("4ujSI"),a=s("e3OyN"),i=s("iooJ7"),o=s("7J7Lf"),u=s("lSb9O"),c=s("7T458"),l=s("ixH3E"),f=s("5SM9U"),d={direction:function(e){return e.direction},format:function(e){var t=e.fieldOrDatumDef,n=e.legend,r=e.config,a=n.format,i=n.formatType;return l.guideFormat(t,t.type,a,i,r,!1)},formatType:function(e){var t=e.legend,n=e.fieldOrDatumDef,r=e.scaleType,a=t.formatType;return l.guideFormatType(a,n,r)},gradientLength:function(e){var t,n,r=e.legend,a=e.legendConfig;return null!==(n=null!==(t=r.gradientLength)&&void 0!==t?t:a.gradientLength)&&void 0!==n?n:function(e){var t=e.legendConfig,n=e.model,r=e.direction,a=e.orient,i=e.scaleType,u=t.gradientHorizontalMaxLength,s=t.gradientHorizontalMinLength,c=t.gradientVerticalMaxLength,l=t.gradientVerticalMinLength;if(o.isContinuousToContinuous(i))return"horizontal"===r?"top"===a||"bottom"===a?v(n,"width",s,u):s:v(n,"height",l,c);return}(e)},labelOverlap:function(e){var t,n,r=e.legend,a=e.legendConfig,i=e.scaleType;return null!==(n=null!==(t=r.labelOverlap)&&void 0!==t?t:a.labelOverlap)&&void 0!==n?n:function(e){return u.contains(["quantile","threshold","log"],e)?"greedy":void 0}(i)},symbolType:function(e){var t,n=e.legend,r=e.markDef,a=e.channel,i=e.encoding;return null!==(t=n.symbolType)&&void 0!==t?t:function(e,t,n,r){var a;if("shape"!==t){var i=null!==(a=f.getFirstConditionValue(n))&&void 0!==a?a:r;if(i)return i}switch(e){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(r.type,a,i.shape,r.shape)},title:function(e){var t=e.fieldOrDatumDef,n=e.config;return i.title(t,n,{allowDisabling:!0})},type:function(e){var t=e.legendType,n=e.scaleType,r=e.channel;if(a.isColorChannel(r)&&o.isContinuousToContinuous(n)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:function(e){var t=e.fieldOrDatumDef;return function(e,t){var n=e.values;if(r.default(n))return i.valueArray(t,n);if(c.isSignalRef(n))return n;return}(e.legend,t)}};function p(e){var t=e.legend;return u.getFirstDefined(t.type,function(e){var t=e.channel,n=e.timeUnit,r=e.scaleType;if(a.isColorChannel(t)){if(u.contains(["quarter","month","day"],n))return"symbol";if(o.isContinuousToContinuous(r))return"gradient"}return"symbol"}(e))}function h(e){var t,n,r=e.legendConfig,a=e.legendType,i=e.orient;return null!==(n=null!==(t=e.legend.direction)&&void 0!==t?t:r[a?"gradientDirection":"symbolDirection"])&&void 0!==n?n:function(e,t){switch(e){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===t?"horizontal":void 0}}(i,a)}function v(e,t,n,r){var a=e.getSizeSignalRef(t).signal;return{signal:"clamp(".concat(a,", ").concat(n,", ").concat(r,")")}}})),s.register("hlBuE",(function(e,t){n(e.exports,"assembleProjections",(function(){return o}));var r=s("lSb9O"),a=s("7T458"),i=s("jZr2L");function o(e){return i.isLayerModel(e)||i.isConcatModel(e)?function(e){return e.children.reduce((function(e,t){return e.concat(t.assembleProjections())}),u(e))}(e):u(e)}function u(e){var t=e.component.projection;if(!t||t.merged)return[];var n=t.combine(),i=n.name;if(t.data){var o={signal:"[".concat(t.size.map((function(e){return e.signal})).join(", "),"]")},u=t.data.reduce((function(t,n){var i=a.isSignalRef(n)?n.signal:"data('".concat(e.lookupDataSource(n),"')");return r.contains(t,i)||t.push(i),t}),[]);if(u.length<=0)throw new Error("Projection's fit didn't find any data sources");return[Object.assign({name:i,size:o,fit:{signal:u.length>1?"[".concat(u.join(", "),"]"):u[0]}},n)]}return[Object.assign(Object.assign({name:i},{translate:{signal:"[width / 2, height / 2]"}}),n)]}})),s.register("aypA2",(function(e,t){n(e.exports,"parseProjection",(function(){return h})),s("1i51P");var r=s("9M1dW");s("iSlfb");var a=s("b1OzQ"),i=s("e3OyN"),o=s("iooJ7"),u=s("1Z7Bs"),c=s("3THYY"),l=s("4jgmF"),f=s("lSb9O"),d=s("jZr2L"),p=s("lGc0A");function h(e){e.component.projection=d.isUnitModel(e)?function(e){var t;if(e.hasProjection){var n=e.specifiedProjection,r=!(n&&(null!=n.scale||null!=n.translate)),a=r?[e.getSizeSignalRef("width"),e.getSizeSignalRef("height")]:void 0,s=r?function(e){var t=[],n=e.encoding,r=!0,a=!1,s=void 0;try{for(var c,f=[[i.LONGITUDE,i.LATITUDE],[i.LONGITUDE2,i.LATITUDE2]][Symbol.iterator]();!(r=(c=f.next()).done);r=!0){var d=c.value;(o.getFieldOrDatumDef(n[d[0]])||o.getFieldOrDatumDef(n[d[1]]))&&t.push({signal:e.getName("geojson_".concat(t.length))})}}catch(e){a=!0,s=e}finally{try{r||null==f.return||f.return()}finally{if(a)throw s}}e.channelHasField(i.SHAPE)&&e.typedFieldDef(i.SHAPE).type===l.GEOJSON&&t.push({signal:e.getName("geojson_".concat(t.length))});0===t.length&&t.push(e.requestDataName(u.MAIN));return t}(e):void 0;return new p.ProjectionComponent(e.projectionName(!0),Object.assign(Object.assign({},null!==(t=e.config.projection)&&void 0!==t?t:{}),null!=n?n:{}),a,s)}return}(e):function(e){if(0===e.children.length)return;var t,n=!0,i=!1,o=void 0;try{for(var u,s=e.children[Symbol.iterator]();!(n=(u=s.next()).done);n=!0){h(u.value)}}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}var l=f.every(e.children,(function(e){var n=e.component.projection;if(n){if(t){var r=function(e,t){var n=f.every(c.PROJECTION_PROPERTIES,(function(n){return!a.default(e.explicit,n)&&!a.default(t.explicit,n)||!(!a.default(e.explicit,n)||!a.default(t.explicit,n)||f.stringify(e.get(n))!==f.stringify(t.get(n)))}));if(f.stringify(e.size)===f.stringify(t.size)){if(n)return e;if(f.stringify(e.explicit)===f.stringify({}))return t;if(f.stringify(t.explicit)===f.stringify({}))return e}return null}(t,n);return r&&(t=r),!!r}return t=n,!0}return!0}));if(t&&l){var d=e.projectionName(!0),v=new p.ProjectionComponent(d,t.specifiedProjection,t.size,f.duplicate(t.data)),g=!0,m=!1,y=void 0;try{for(var x,b=e.children[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var k,w=x.value,A=w.component.projection;if(A)A.isFit&&(k=v.data).push.apply(k,r.default(w.component.projection.data)),w.renameProjection(A.get("name"),d),A.merged=!0}}catch(e){m=!0,y=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}return v}return}(e)}})),s.register("3THYY",(function(e,t){n(e.exports,"PROJECTION_PROPERTIES",(function(){return r}));var r=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"]})),s.register("lGc0A",(function(e,t){n(e.exports,"ProjectionComponent",(function(){return u})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,o){var u;return i.default(this,n),(u=t.call(this,Object.assign({},r),{name:e})).specifiedProjection=r,u.size=a,u.data=o,u.merged=!1,u}return o.default(n,[{key:"isFit",get:function(){return!!this.data}}]),n}(s("CFwcG").Split)})),s.register("cI6bT",(function(e,t){n(e.exports,"assembleScales",(function(){return f}));var r=s("2lx0N"),a=s("e3OyN"),i=s("lSb9O"),o=s("7T458"),u=s("jZr2L"),c=s("d4pV2"),l=s("ivIoL");function f(e){return u.isLayerModel(e)||u.isConcatModel(e)?e.children.reduce((function(e,t){return e.concat(f(t))}),d(e)):d(e)}function d(e){return i.keys(e.component.scales).reduce((function(t,n){var i=e.component.scales[n];if(i.merged)return t;var u,s=i.combine(),f=s.name,d=s.type,p=s.selectionExtent,h=(s.domains,s.range,s.reverse),v=r.__rest(s,["name","type","selectionExtent","domains","range","reverse"]),g=function(e,t,n){if(a.isXorY(n)&&o.isVgRangeStep(e))return{step:{signal:t+"_step"}};return e}(s.range,f,n);p&&(u=c.assembleSelectionScaleDomain(e,p));var m=l.assembleDomain(e,n);return t.push(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:f,type:d},m?{domain:m}:{}),u?{domainRaw:u}:{}),{range:g}),void 0!==h?{reverse:h}:{}),v)),t}),[])}})),s.register("ivIoL",(function(e,t){n(e.exports,"parseScaleDomain",(function(){return S})),n(e.exports,"getFieldFromDomain",(function(){return R})),n(e.exports,"assembleDomain",(function(){return M})),s("1i51P");var r=s("9M1dW"),a=s("2lx0N");s("iSlfb");var i=s("bZ6XL"),o=s("fCSiB"),u=s("6jZCp"),c=s("61RXI"),l=s("e3OyN"),f=s("iooJ7"),d=s("1Z7Bs"),p=s("16rNM"),h=s("2x4HI"),v=s("7J7Lf"),g=s("2V3EF"),m=s("gQOdy"),y=s("lSb9O"),x=s("7T458"),b=s("4ewT3"),k=s("fFVzC"),w=s("XTLnN"),A=s("jZr2L"),E=s("hr8xM"),C=s("CFwcG");function S(e){A.isUnitModel(e)?function(e){var t=e.component.scales,n=!0,r=!1,a=void 0;try{for(var i,o=y.keys(t)[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value,s=N(e,u);if(t[u].setWithExplicit("domains",s),O(e,u),e.component.data.isFaceted){for(var c=e;!A.isFacetModel(c)&&c.parent;)c=c.parent;if("shared"===c.component.resolve.scale[u]){var l=!0,f=!1,d=void 0;try{for(var p,h=s.value[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;x.isDataRefDomain(v)&&(v.data=w.FACET_SCALE_PREFIX+v.data.replace(w.FACET_SCALE_PREFIX,""))}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}}}}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}(e):function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e.children[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){S(a.value)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}var o=e.component.scales,u=!0,s=!1,c=void 0;try{for(var l,f=y.keys(o)[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value,h=void 0,v=null,g=!0,m=!1,x=void 0;try{for(var b,k=e.children[Symbol.iterator]();!(g=(b=k.next()).done);g=!0){var w=b.value.component.scales[d];if(w){h=void 0===h?w.getWithExplicit("domains"):C.mergeValuesWithExplicit(h,w.getWithExplicit("domains"),"domains","scale",I);var A=w.get("selectionExtent");v&&A&&v.selection!==A.selection&&p.warn("The same selection must be used to override scale domains in a layered view."),v=A}}}catch(e){m=!0,x=e}finally{try{g||null==k.return||k.return()}finally{if(m)throw x}}o[d].setWithExplicit("domains",h),v&&o[d].set("selectionExtent",v,!0)}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}}(e)}function N(e,t){var n=e.getScaleComponent(t).get("type"),r=e.encoding,a=function(e,t,n,r){if("unaggregated"===e){var a=_(t,n),i=a.valid,o=a.reason;if(!i)return void p.warn(o)}else if(void 0===e&&r.useUnaggregatedDomain&&_(t,n).valid)return"unaggregated";return e}(e.scaleDomain(t),e.typedFieldDef(t),n,e.config.scale);return a!==e.scaleDomain(t)&&(e.specifiedScales[t]=Object.assign(Object.assign({},e.specifiedScales[t]),{domain:a})),"x"===t&&f.getFieldOrDatumDef(r.x2)?f.getFieldOrDatumDef(r.x)?C.mergeValuesWithExplicit(D(n,a,e,"x"),D(n,a,e,"x2"),"domain","scale",I):D(n,a,e,"x2"):"y"===t&&f.getFieldOrDatumDef(r.y2)?f.getFieldOrDatumDef(r.y)?C.mergeValuesWithExplicit(D(n,a,e,"y"),D(n,a,e,"y2"),"domain","scale",I):D(n,a,e,"y2"):D(n,a,e,t)}function T(e,t,n){var r,a=null===(r=m.normalizeTimeUnit(n))||void 0===r?void 0:r.unit;return"temporal"===t||a?function(e,t,n){return e.map((function(e){var r=f.valueExpr(e,{timeUnit:n,type:t});return{signal:"{data: ".concat(r,"}")}}))}(e,t,a):[e]}function D(e,t,n,a){var o=n.encoding,s=f.getFieldOrDatumDef(o[a]),p=s.type,h=s.timeUnit;if(v.isDomainUnionWith(t)){var m=D(e,void 0,n,a),w=T(t.unionWith,p,h);return C.makeExplicit(r.default(m.value).concat(r.default(w)))}if(x.isSignalRef(t))return C.makeExplicit([t]);if(t&&"unaggregated"!==t&&!v.isSelectionDomain(t))return C.makeExplicit(T(t,p,h));var S=n.stack;if(S&&a===S.fieldChannel){if("normalize"===S.offset)return C.makeImplicit([[0,1]]);var N=n.requestDataName(d.MAIN);return C.makeImplicit([{data:N,field:n.vgField(a,{suffix:"start"})},{data:N,field:n.vgField(a,{suffix:"end"})}])}var O=l.isScaleChannel(a)&&f.isFieldDef(s)?function(e,t,n){if(!v.hasDiscreteDomain(n))return;var a=e.fieldDef(t),i=a.sort;if(g.isSortArray(i))return{op:"min",field:k.sortArrayIndexField(a,t),order:"ascending"};var o=e.stack,s=o?r.default(o.groupbyField?[o.groupbyField]:[]).concat(r.default(o.stackBy.map((function(e){return e.fieldDef.field})))):void 0;if(g.isSortField(i))return F(i,o&&!y.contains(s,i.field));if(g.isSortByEncoding(i)){var c=i.encoding,l=i.order,d=e.fieldDef(c),p=d.aggregate,h=d.field,m=o&&!y.contains(s,h);if(u.isArgminDef(p)||u.isArgmaxDef(p))return F({field:f.vgField(d),order:l},m);if(u.isAggregateOp(p)||!p)return F({op:p,field:h,order:l},m)}else{if("descending"===i)return{op:"min",field:e.vgField(t),order:"descending"};if(y.contains(["ascending",void 0],i))return!0}return}(n,a,e):void 0;if(f.isDatumDef(s)){var _=T([s.datum],p,h);return C.makeImplicit(_)}var I=s;if("unaggregated"===t){var R=n.requestDataName(d.MAIN),M=s.field;return C.makeImplicit([{data:R,field:f.vgField({field:M,aggregate:"min"})},{data:R,field:f.vgField({field:M,aggregate:"max"})}])}if(c.isBinning(I.bin)){if(v.hasDiscreteDomain(e))return"bin-ordinal"===e?C.makeImplicit([]):C.makeImplicit([{data:y.isBoolean(O)?n.requestDataName(d.MAIN):n.requestDataName(d.RAW),field:n.vgField(a,f.binRequiresRange(I,a)?{binSuffix:"range"}:{}),sort:!0!==O&&i.default(O)?O:{field:n.vgField(a,{}),op:"min"}}]);var B=I.bin;if(c.isBinning(B)){var P=b.getBinSignalName(n,I.field,B);return C.makeImplicit([new E.SignalRefWrapper((function(){var e=n.getSignalName(P);return"[".concat(e,".start, ").concat(e,".stop]")}))])}return C.makeImplicit([{data:n.requestDataName(d.MAIN),field:n.vgField(a,{})}])}if(I.timeUnit&&y.contains(["time","utc"],e)&&f.hasBand(a,I,A.isUnitModel(n)?n.encoding[l.getSecondaryRangeChannel(a)]:void 0,n.stack,n.markDef,n.config)){var L=n.requestDataName(d.MAIN);return C.makeImplicit([{data:L,field:n.vgField(a)},{data:L,field:n.vgField(a,{suffix:"end"})}])}return O?C.makeImplicit([{data:y.isBoolean(O)?n.requestDataName(d.MAIN):n.requestDataName(d.RAW),field:n.vgField(a),sort:O}]):C.makeImplicit([{data:n.requestDataName(d.MAIN),field:n.vgField(a)}])}function F(e,t){var n=e.op,r=e.field,a=e.order;return Object.assign(Object.assign({op:null!=n?n:t?"sum":g.DEFAULT_SORT_OP},r?{field:y.replacePathInField(r)}:{}),a?{order:a}:{})}function O(e,t){var n,r=e.component.scales[t],a=e.specifiedScales[t].domain,i=null===(n=e.fieldDef(t))||void 0===n?void 0:n.bin,o=v.isSelectionDomain(a)&&a,u=c.isBinParams(i)&&c.isSelectionExtent(i.extent)&&i.extent;(o||u)&&r.set("selectionExtent",null!=o?o:u,!0)}function _(e,t){var n=e.aggregate,r=e.type;return n?o.default(n)&&!u.SHARED_DOMAIN_OP_INDEX[n]?{valid:!1,reason:h.unaggregateDomainWithNonSharedDomainOp(n)}:"quantitative"===r&&"log"===t?{valid:!1,reason:h.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:h.unaggregateDomainHasNoEffectForRawField(e)}}function I(e,t,n,a){return e.explicit&&t.explicit&&p.warn(h.mergeConflictingDomainProperty(n,a,e.value,t.value)),{explicit:e.explicit,value:r.default(e.value).concat(r.default(t.value))}}function R(e){if(x.isDataRefDomain(e)&&o.default(e.field))return e.field;if(x.isDataRefUnionedDomain(e)){var t,n=!0,r=!1,a=void 0;try{for(var i,u=e.fields[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var s=i.value;if(x.isDataRefDomain(s)&&o.default(s.field))if(t){if(t!==s.field)return p.warn(h.FACETED_INDEPENDENT_DIFFERENT_SOURCES),t}else t=s.field}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}return p.warn(h.FACETED_INDEPENDENT_SAME_FIELDS_DIFFERENT_SOURCES),t}if(x.isFieldRefUnionDomain(e)){p.warn(h.FACETED_INDEPENDENT_SAME_SOURCE);var c=e.fields[0];return o.default(c)?c:void 0}}function M(e,t){return function(e){var t=y.unique(e.map((function(e){return x.isDataRefDomain(e)?(e.sort,a.__rest(e,["sort"])):e})),y.hash),n=y.unique(e.map((function(e){if(x.isDataRefDomain(e)){var t=e.sort;return void 0===t||y.isBoolean(t)||("op"in t&&"count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}})).filter((function(e){return void 0!==e})),y.hash);if(0!==t.length){if(1===t.length){var r=e[0];if(x.isDataRefDomain(r)&&n.length>0){var o=n[0];if(n.length>1)p.warn(h.MORE_THAN_ONE_SORT),o=!0;else if(i.default(o)&&"field"in o){var s=o.field;r.field===s&&(o=!o.order||{order:o.order})}return Object.assign(Object.assign({},r),{sort:o})}return r}var c,l=y.unique(n.map((function(e){return y.isBoolean(e)||!("op"in e)||e.op in u.MULTIDOMAIN_SORT_OP_INDEX?e:(p.warn(h.domainSortDropped(e)),!0)})),y.hash);1===l.length?c=l[0]:l.length>1&&(p.warn(h.MORE_THAN_ONE_SORT),c=!0);var f=y.unique(e.map((function(e){return x.isDataRefDomain(e)?e.data:null})),(function(e){return e}));return 1===f.length&&null!==f[0]?Object.assign({data:f[0],fields:t.map((function(e){return e.field}))},c?{sort:c}:{}):Object.assign({fields:t},c?{sort:c}:{})}}(e.component.scales[t].get("domains").map((function(t){return x.isDataRefDomain(t)&&(t.data=e.lookupDataSource(t.data)),t})))}})),s.register("4ewT3",(function(e,t){n(e.exports,"getBinSignalName",(function(){return b})),n(e.exports,"BinNode",(function(){return w})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("cTgYo"),l=s("4Ui3v"),f=s("2lx0N");s("iSlfb");var d=s("fCSiB"),p=s("61RXI"),h=s("iooJ7"),v=s("lSb9O"),g=s("ixH3E"),m=s("jZr2L"),y=s("4dGY7");function x(e,t){return"".concat(p.binToString(e),"_").concat(t)}function b(e,t,n){var r,a=x(null!==(r=h.normalizeBin(n,void 0))&&void 0!==r?r:{},t);return e.getName("".concat(a,"_bins"))}function k(e,t,n){var r,a;r=function(e){return"as"in e}(e)?d.default(e.as)?[e.as,"".concat(e.as,"_end")]:[e.as[0],e.as[1]]:[h.vgField(e,{forAs:!0}),h.vgField(e,{binSuffix:"end",forAs:!0})];var i=Object.assign({},h.normalizeBin(t,void 0)),o=x(i,e.field),u=function(e,t){return{signal:e.getName("".concat(t,"_bins")),extentSignal:e.getName("".concat(t,"_extent"))}}(n,o),s=u.signal,c=u.extentSignal;if(p.isSelectionExtent(i.extent)){var l=i.extent,f=l.selection;a=y.parseSelectionBinExtent(n.getSelectionComponent(v.varName(f),f),l),delete i.extent}return{key:o,binComponent:Object.assign(Object.assign(Object.assign({bin:i,field:e.field,as:[r]},s?{signal:s}:{}),c?{extentSignal:c}:{}),a?{span:a}:{})}}var w=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).bins=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,v.duplicate(this.bins))}},{key:"merge",value:function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,o=v.keys(e.bins)[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;s in this.bins?(t(e.bins[s].signal,this.bins[s].signal),this.bins[s].as=v.unique(u.default(this.bins[s].as).concat(u.default(e.bins[s].as)),v.hash)):this.bins[s]=e.bins[s]}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}var c=!0,l=!1,f=void 0;try{for(var d,p=e.children[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;e.removeChild(h),h.parent=this}}catch(e){l=!0,f=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}e.remove()}},{key:"producedFields",value:function(){return new Set(v.vals(this.bins).map((function(e){return e.as})).flat(2))}},{key:"dependentFields",value:function(){return new Set(v.vals(this.bins).map((function(e){return e.field})))}},{key:"hash",value:function(){return"Bin ".concat(v.hash(this.bins))}},{key:"assemble",value:function(){return v.vals(this.bins).flatMap((function(e){var t=[],n=c.default(e.as),r=n[0],a=n.slice(1),i=e.bin,o=i.extent,u=f.__rest(i,["extent"]),s=Object.assign(Object.assign(Object.assign({type:"bin",field:v.replacePathInField(e.field),as:r,signal:e.signal},p.isSelectionExtent(o)?{extent:null}:{extent:o}),e.span?{span:{signal:"span(".concat(e.span,")")}}:{}),u);!o&&e.extentSignal&&(t.push({type:"extent",field:v.replacePathInField(e.field),signal:e.extentSignal}),s.extent={signal:e.extentSignal}),t.push(s);var l=!0,d=!1,g=void 0;try{for(var m,y=a[Symbol.iterator]();!(l=(m=y.next()).done);l=!0)for(var x=m.value,b=0;b<2;b++)t.push({type:"formula",expr:h.vgField({field:r[b]},{expr:"datum"}),as:x[b]})}catch(e){d=!0,g=e}finally{try{l||null==y.return||y.return()}finally{if(d)throw g}}return e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))}}],[{key:"makeFromEncoding",value:function(e,t){var r=t.reduceFieldDef((function(e,n,r){if(h.isTypedFieldDef(n)&&p.isBinning(n.bin)){var a=k(n,n.bin,t),i=a.key,o=a.binComponent;e[i]=Object.assign(Object.assign(Object.assign({},o),e[i]),function(e,t,n,r){var a,i;if(h.binRequiresRange(t,n)){var o=m.isUnitModel(e)&&null!==(i=null!==(a=e.axis(n))&&void 0!==a?a:e.legend(n))&&void 0!==i?i:{},u=h.vgField(t,{expr:"datum"}),s=h.vgField(t,{expr:"datum",binSuffix:"end"});return{formulaAs:h.vgField(t,{binSuffix:"range",forAs:!0}),formula:g.binFormatExpression(u,s,o.format,o.formatType,r)}}return{}}(t,n,r,t.config))}return e}),{});return v.isEmpty(r)?null:new n(e,r)}},{key:"makeFromTransform",value:function(e,t,r){var a=k(t,t.bin,r),i=a.key,o=a.binComponent;return new n(e,l.default({},i,o))}}]),n}(s("5XgHP").DataFlowNode)})),s.register("XTLnN",(function(e,t){n(e.exports,"FACET_SCALE_PREFIX",(function(){return u})),n(e.exports,"optimizeDataflow",(function(){return p}));var r=s("16rNM"),a=s("fm3i1"),i=s("adXrw"),o=s("dCfiy"),u="scale_";function c(e){var t=[];function n(e){var r=!0,a=!1,i=void 0;if(0===e.numChildren())t.push(e);else try{for(var o,u=e.children[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){n(o.value)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}var r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){n(o.value)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return t}function l(e){return e}function f(e,t){return t.map((function(t){if(e instanceof i.BottomUpOptimizer){var n=e.optimizeNextFromLeaves(t);return e.reset(),n}return e.run(t)})).some(l)}function d(e,t){var n=e.sources,r=new Set;return r.add(f(new o.RemoveUnnecessaryOutputNodes,n)),r.add(f(new o.RemoveUnnecessaryIdentifierNodes(t),n)),n=n.filter((function(e){return e.numChildren()>0})),r.add(f(new o.RemoveUnusedSubtrees,c(n))),n=n.filter((function(e){return e.numChildren()>0})),r.add(f(new o.MoveParseUp,c(n))),r.add(f(new o.MergeBins(t),c(n))),r.add(f(new o.RemoveDuplicateTimeUnits,c(n))),r.add(f(new o.MergeParse,c(n))),r.add(f(new o.MergeAggregates,c(n))),r.add(f(new o.MergeTimeUnits,c(n))),r.add(f(new o.MergeIdenticalNodes,n)),r.add(f(new o.MergeOutputs,c(n))),e.sources=n,r.has(!0)}function p(e,t){a.checkLinks(e.sources);for(var n=0,i=0,u=0;u<5&&d(e,t);u++)n++;e.sources.map(o.moveFacetDown);for(var s=0;s<5&&d(e,t);s++)i++;a.checkLinks(e.sources),5===Math.max(n,i)&&r.warn("Maximum optimization runs(".concat(5,") reached."))}})),s.register("fm3i1",(function(e,t){n(e.exports,"checkLinks",(function(){return r})),s("1i51P");s("9M1dW"),s("6vecG"),s("lSb9O"),s("5XgHP"),s("cYGz2");function r(e){var t=!0,n=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value,s=!0,c=!1,l=void 0;try{for(var f,d=u.children[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;if(p.parent!==u)return console.error("Dataflow graph is inconsistent.",u,p),!1}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}if(!r(u.children))return!1}}catch(e){n=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw a}}return!0}})),s.register("cYGz2",(function(e,t){n(e.exports,"SourceNode",(function(){return l})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("1Z7Bs"),c=s("lSb9O"),l=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e){var r,a;if(i.default(this,n),r=t.call(this,null),e=null!=e?e:{name:"source"},u.isGenerator(e)||(a=e.format?Object.assign({},c.omit(e.format,["parse"])):{}),u.isInlineData(e))r._data={values:e.values};else if(u.isUrlData(e)){if(r._data={url:e.url},!a.type){var o=/(?:\.([^.]+))?$/.exec(e.url)[1];c.contains(["json","csv","tsv","dsv","topojson"],o)||(o="json"),a.type=o}}else u.isSphereGenerator(e)?r._data={values:[{type:"Sphere"}]}:(u.isNamedData(e)||u.isGenerator(e))&&(r._data={});return r._generator=u.isGenerator(e),e.name&&(r._name=e.name),a&&!c.isEmpty(a)&&(r._data.format=a),r}return o.default(n,[{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"data",get:function(){return this._data}},{key:"hasName",value:function(){return!!this._name}},{key:"isGenerator",get:function(){return this._generator}},{key:"dataName",get:function(){return this._name},set:function(e){this._name=e}},{key:"parent",set:function(e){throw new Error("Source nodes have to be roots.")}},{key:"remove",value:function(){throw new Error("Source nodes are roots and cannot be removed.")}},{key:"hash",value:function(){throw new Error("Cannot hash sources")}},{key:"assemble",value:function(){return Object.assign(Object.assign({name:this._name},this._data),{transform:[]})}}]),n}(s("5XgHP").DataFlowNode)})),s.register("adXrw",(function(e,t){n(e.exports,"isDataSourceNode",(function(){return f})),n(e.exports,"BottomUpOptimizer",(function(){return p})),n(e.exports,"TopDownOptimizer",(function(){return h})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("2vsUb"),o=s("d6iiX"),u=s("cYGz2"),c=s("XZnM9"),l=s("5HdXV");function f(e){return e instanceof u.SourceNode||e instanceof c.GraticuleNode||e instanceof l.SequenceNode}var d=function(){"use strict";function e(){r.default(this,e),this._mutated=!1}return a.default(e,[{key:"setMutated",value:function(){this._mutated=!0}},{key:"mutatedFlag",get:function(){return this._mutated}}]),e}(),p=function(e){"use strict";i.default(n,e);var t=o.default(n);function n(){var e;return r.default(this,n),(e=t.call(this))._continue=!1,e}return a.default(n,[{key:"setContinue",value:function(){this._continue=!0}},{key:"continueFlag",get:function(){return this._continue}},{key:"flags",get:function(){return{continueFlag:this.continueFlag,mutatedFlag:this.mutatedFlag}},set:function(e){var t=e.continueFlag,n=e.mutatedFlag;t&&this.setContinue(),n&&this.setMutated()}},{key:"reset",value:function(){}},{key:"optimizeNextFromLeaves",value:function(e){if(f(e))return!1;var t=e.parent;return this.run(e).continueFlag&&this.optimizeNextFromLeaves(t),this.mutatedFlag}}]),n}(d),h=function(e){"use strict";i.default(n,e);var t=o.default(n);function n(){return r.default(this,n),t.apply(this,arguments)}return n}(d)})),s.register("XZnM9",(function(e,t){n(e.exports,"GraticuleNode",(function(){return c})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("lSb9O"),c=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).params=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){}},{key:"hash",value:function(){return"Graticule ".concat(u.hash(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"graticule"},!0===this.params?{}:this.params)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("5HdXV",(function(e,t){n(e.exports,"SequenceNode",(function(){return c})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("lSb9O"),c=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).params=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,this.params)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){var e;return new Set([null!==(e=this.params.as)&&void 0!==e?e:"data"])}},{key:"hash",value:function(){return"Hash ".concat(u.hash(this.params))}},{key:"assemble",value:function(){return Object.assign({type:"sequence"},this.params)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("dCfiy",(function(e,t){n(e.exports,"MoveParseUp",(function(){return C})),n(e.exports,"MergeIdenticalNodes",(function(){return S})),n(e.exports,"RemoveUnusedSubtrees",(function(){return N})),n(e.exports,"RemoveDuplicateTimeUnits",(function(){return T})),n(e.exports,"MergeTimeUnits",(function(){return D})),n(e.exports,"moveFacetDown",(function(){return F})),n(e.exports,"RemoveUnnecessaryOutputNodes",(function(){return _})),n(e.exports,"RemoveUnnecessaryIdentifierNodes",(function(){return I})),n(e.exports,"MergeParse",(function(){return R})),n(e.exports,"MergeAggregates",(function(){return M})),n(e.exports,"MergeBins",(function(){return B})),n(e.exports,"MergeOutputs",(function(){return P})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("1Z7Bs"),l=s("lSb9O"),f=s("aukhr"),d=s("dQfAT"),p=s("4ewT3"),h=s("5XgHP"),v=s("fPIRu"),g=s("dD9t5"),m=s("lmM4C"),y=s("4gRNk"),x=s("e0CR6"),b=s("XTLnN"),k=s("adXrw"),w=s("gR1OF"),A=s("bAeeP"),E=s("hijEA"),C=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"run",value:function(e){var t=e.parent;if(e instanceof m.ParseNode){if(k.isDataSourceNode(t))return this.flags;if(t.numChildren()>1)return this.setContinue(),this.flags;if(t instanceof m.ParseNode)this.setMutated(),t.merge(e);else{if(l.fieldIntersection(t.producedFields(),e.dependentFields()))return this.setContinue(),this.flags;this.setMutated(),e.swapWithParent()}}return this.setContinue(),this.flags}}]),n}(k.BottomUpOptimizer),S=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"mergeNodes",value:function(e,t){var n=t.shift(),r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;e.removeChild(s),s.parent=n,s.remove()}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}},{key:"run",value:function(e){for(var t=e.children.map((function(e){return e.hash()})),n={},r=0;r<t.length;r++)void 0===n[t[r]]?n[t[r]]=[e.children[r]]:n[t[r]].push(e.children[r]);var a=!0,i=!1,o=void 0;try{for(var u,s=l.keys(n)[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;n[c].length>1&&(this.setMutated(),this.mergeNodes(e,n[c]))}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}var f=!0,d=!1,p=void 0;try{for(var h,v=e.children[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var g=h.value;this.run(g)}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}return this.mutatedFlag}}]),n}(k.TopDownOptimizer),N=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"run",value:function(e){return e instanceof h.OutputNode||e.numChildren()>0||e instanceof v.FacetNode||(this.setMutated(),e.remove()),this.flags}}]),n}(k.BottomUpOptimizer),T=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){var e;return i.default(this,n),(e=t.call.apply(t,[this].concat(Array.prototype.slice.call(arguments)))).fields=new Set,e.prev=null,e}return o.default(n,[{key:"run",value:function(e){if(this.setContinue(),e instanceof A.TimeUnitNode){var t=e.producedFields();l.hasIntersection(t,this.fields)?(this.setMutated(),this.prev.remove()):this.fields=new Set(u.default(this.fields).concat(u.default(t))),this.prev=e}return this.flags}},{key:"reset",value:function(){this.fields.clear()}}]),n}(k.BottomUpOptimizer),D=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"run",value:function(e){this.setContinue();var t=e.parent.children.filter((function(e){return e instanceof A.TimeUnitNode})),n=t.pop(),r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.setMutated(),n.merge(s)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return this.flags}}]),n}(k.BottomUpOptimizer);function F(e){if(e instanceof v.FacetNode)if(1!==e.numChildren()||e.children[0]instanceof h.OutputNode){var t=e.model.component.data.main;O(t);var n=(l=e,function e(t){if(!(t instanceof v.FacetNode)){var n=t.clone();if(n instanceof h.OutputNode){var r=b.FACET_SCALE_PREFIX+n.getSource();n.setSource(r),l.model.component.data.outputNodes[r]=n}else(n instanceof d.AggregateNode||n instanceof w.StackNode||n instanceof E.WindowTransformNode||n instanceof x.JoinAggregateTransformNode)&&n.addDimensions(l.fields);var a=!0,i=!1,o=void 0;try{for(var u,s=t.children.flatMap(e)[Symbol.iterator]();!(a=(u=s.next()).done);a=!0)u.value.parent=n}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return[n]}return t.children.flatMap(e)}),r=e.children.map(n).flat(),a=!0,i=!1,o=void 0;try{for(var u,s=r[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){u.value.parent=t}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}}else{var c=e.children[0];(c instanceof d.AggregateNode||c instanceof w.StackNode||c instanceof E.WindowTransformNode||c instanceof x.JoinAggregateTransformNode)&&c.addDimensions(e.fields),c.swapWithParent(),F(e)}else e.children.map(F);var l}function O(e){if(e instanceof h.OutputNode&&e.type===c.MAIN&&1===e.numChildren()){var t=e.children[0];t instanceof v.FacetNode||(t.swapWithParent(),O(e))}}var _=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.call(this)}return o.default(n,[{key:"run",value:function(e){e instanceof h.OutputNode&&!e.isRequired()&&(this.setMutated(),e.remove());var t=!0,n=!1,r=void 0;try{for(var a,i=e.children[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;this.run(o)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return this.mutatedFlag}}]),n}(k.TopDownOptimizer),I=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e){var r;return i.default(this,n),(r=t.call(this)).requiresSelectionId=e&&f.requiresSelectionId(e),r}return o.default(n,[{key:"run",value:function(e){e instanceof y.IdentifierNode&&(this.requiresSelectionId&&(k.isDataSourceNode(e.parent)||e.parent instanceof d.AggregateNode||e.parent instanceof m.ParseNode)||(this.setMutated(),e.remove()));var t=!0,n=!1,r=void 0;try{for(var a,i=e.children[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;this.run(o)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return this.mutatedFlag}}]),n}(k.TopDownOptimizer),R=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"run",value:function(e){var t=e.parent,n=u.default(t.children),r=t.children.filter((function(e){return e instanceof m.ParseNode}));if(t.numChildren()>1&&r.length>=1){var a={},i=new Set,o=!0,s=!1,c=void 0;try{for(var f,d=r[Symbol.iterator]();!(o=(f=d.next()).done);o=!0){var p=f.value.parse,h=!0,v=!1,g=void 0;try{for(var y,x=l.keys(p)[Symbol.iterator]();!(h=(y=x.next()).done);h=!0){var b=y.value;b in a?a[b]!==p[b]&&i.add(b):a[b]=p[b]}}catch(e){v=!0,g=e}finally{try{h||null==x.return||x.return()}finally{if(v)throw g}}}}catch(e){s=!0,c=e}finally{try{o||null==d.return||d.return()}finally{if(s)throw c}}var k=!0,w=!1,A=void 0;try{for(var E,C=i[Symbol.iterator]();!(k=(E=C.next()).done);k=!0){delete a[E.value]}}catch(e){w=!0,A=e}finally{try{k||null==C.return||C.return()}finally{if(w)throw A}}if(!l.isEmpty(a)){this.setMutated();var S=new m.ParseNode(t,a),N=!0,T=!1,D=void 0;try{for(var F,O=n[Symbol.iterator]();!(N=(F=O.next()).done);N=!0){var _=F.value,I=!0,R=!1,M=void 0;if(_ instanceof m.ParseNode)try{for(var B,P=l.keys(a)[Symbol.iterator]();!(I=(B=P.next()).done);I=!0){var L=B.value;delete _.parse[L]}}catch(e){R=!0,M=e}finally{try{I||null==P.return||P.return()}finally{if(R)throw M}}t.removeChild(_),_.parent=S,_ instanceof m.ParseNode&&0===l.keys(_.parse).length&&_.remove()}}catch(e){T=!0,D=e}finally{try{N||null==O.return||O.return()}finally{if(T)throw D}}}}return this.setContinue(),this.flags}}]),n}(k.BottomUpOptimizer),M=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"run",value:function(e){var t=e.parent,n=t.children.filter((function(e){return e instanceof d.AggregateNode})),r={},a=!0,i=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value,f=l.hash(c.groupBy);f in r||(r[f]=[]),r[f].push(c)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}var p=!0,h=!1,v=void 0;try{for(var g,m=l.keys(r)[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=r[g.value];if(y.length>1){var x=y.pop(),b=!0,k=!1,w=void 0;try{for(var A,E=y[Symbol.iterator]();!(b=(A=E.next()).done);b=!0){var C=A.value;x.merge(C)&&(t.removeChild(C),C.parent=x,C.remove(),this.setMutated())}}catch(e){k=!0,w=e}finally{try{b||null==E.return||E.return()}finally{if(k)throw w}}}}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}return this.setContinue(),this.flags}}]),n}(k.BottomUpOptimizer),B=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e){var r;return i.default(this,n),(r=t.call(this)).model=e,r}return o.default(n,[{key:"run",value:function(e){var t=e.parent,n=!(k.isDataSourceNode(t)||t instanceof g.FilterNode||t instanceof m.ParseNode||t instanceof y.IdentifierNode),r=[],a=[],i=!0,o=!1,u=void 0;try{for(var s,c=t.children[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;f instanceof p.BinNode&&(n&&!l.fieldIntersection(t.producedFields(),f.dependentFields())?r.push(f):a.push(f))}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}if(r.length>0){var d=r.pop(),h=!0,v=!1,x=void 0;try{for(var b,w=r[Symbol.iterator]();!(h=(b=w.next()).done);h=!0){var A=b.value;d.merge(A,this.model.renameSignal.bind(this.model))}}catch(e){v=!0,x=e}finally{try{h||null==w.return||w.return()}finally{if(v)throw x}}this.setMutated(),t instanceof p.BinNode?t.merge(d,this.model.renameSignal.bind(this.model)):d.swapWithParent()}if(a.length>1){var E=a.pop(),C=!0,S=!1,N=void 0;try{for(var T,D=a[Symbol.iterator]();!(C=(T=D.next()).done);C=!0){var F=T.value;E.merge(F,this.model.renameSignal.bind(this.model))}}catch(e){S=!0,N=e}finally{try{C||null==D.return||D.return()}finally{if(S)throw N}}this.setMutated()}return this.setContinue(),this.flags}}]),n}(k.BottomUpOptimizer),P=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"run",value:function(e){var t=e.parent,n=u.default(t.children);if(!l.some(n,(function(e){return e instanceof h.OutputNode}))||t.numChildren()<=1)return this.setContinue(),this.flags;var r,a=[],i=!0,o=!1,s=void 0;try{for(var c,f=n[Symbol.iterator]();!(i=(c=f.next()).done);i=!0){var d=c.value;if(d instanceof h.OutputNode){for(var p,v=d;1===v.numChildren();){var g=v.children[0];if(!(g instanceof h.OutputNode))break;v=g}(p=a).push.apply(p,u.default(v.children)),r?(t.removeChild(d),d.parent=r.parent,r.parent.removeChild(r),r.parent=v,this.setMutated()):r=v}else a.push(d)}}catch(e){o=!0,s=e}finally{try{i||null==f.return||f.return()}finally{if(o)throw s}}if(a.length){this.setMutated();var m=!0,y=!1,x=void 0;try{for(var b,k=a[Symbol.iterator]();!(m=(b=k.next()).done);m=!0){var w=b.value;w.parent.removeChild(w),w.parent=r}}catch(e){y=!0,x=e}finally{try{m||null==k.return||k.return()}finally{if(y)throw x}}}return this.setContinue(),this.flags}}]),n}(k.BottomUpOptimizer)})),s.register("dQfAT",(function(e,t){n(e.exports,"AggregateNode",(function(){return g})),s("1i51P");var r=s("9M1dW"),a=s("4Ui3v"),i=s("2vsUb"),o=s("d6iiX"),u=s("3QOYJ"),c=s("2tuUj"),l=s("6jZCp"),f=s("e3OyN"),d=s("iooJ7"),p=s("16rNM"),h=s("lSb9O"),v=s("jZr2L");var g=function(e){"use strict";i.default(n,e);var t=o.default(n);function n(e,r,a){var i;return u.default(this,n),(i=t.call(this,e)).dimensions=r,i.measures=a,i}return c.default(n,[{key:"clone",value:function(){return new n(null,new Set(this.dimensions),h.duplicate(this.measures))}},{key:"groupBy",get:function(){return this.dimensions}},{key:"merge",value:function(e){return h.setEqual(this.dimensions,e.dimensions)?(function(e,t){var n,i=!0,o=!1,u=void 0;try{for(var s,c=h.keys(t)[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value,f=t[l],d=!0,p=!1,v=void 0;try{for(var g,m=h.keys(f)[Symbol.iterator]();!(d=(g=m.next()).done);d=!0){var y=g.value;l in e?e[l][y]=new Set(r.default(null!==(n=e[l][y])&&void 0!==n?n:[]).concat(r.default(f[y]))):e[l]=a.default({},y,f[y])}}catch(e){p=!0,v=e}finally{try{d||null==m.return||m.return()}finally{if(p)throw v}}}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}}(this.measures,e.measures),!0):(p.debug("different dimensions, cannot merge"),!1)}},{key:"addDimensions",value:function(e){e.forEach(this.dimensions.add,this.dimensions)}},{key:"dependentFields",value:function(){return new Set(r.default(this.dimensions).concat(r.default(h.keys(this.measures))))}},{key:"producedFields",value:function(){var e=new Set,t=!0,n=!1,r=void 0,a=!0,i=!1,o=void 0;try{for(var u,s=h.keys(this.measures)[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;try{for(var l,f=h.keys(this.measures[c])[Symbol.iterator]();!(t=(l=f.next()).done);t=!0){var d=l.value,p=this.measures[c][d];0===p.size?e.add("".concat(d,"_").concat(c)):p.forEach(e.add,e)}}catch(e){n=!0,r=e}finally{try{t||null==f.return||f.return()}finally{if(n)throw r}}}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return e}},{key:"hash",value:function(){return"Aggregate ".concat(h.hash({dimensions:this.dimensions,measures:this.measures}))}},{key:"assemble",value:function(){var e=[],t=[],n=[],a=!0,i=!1,o=void 0;try{for(var u,s=h.keys(this.measures)[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value,l=!0,f=!1,d=void 0,p=!0,v=!1,g=void 0;try{for(var m,y=h.keys(this.measures[c])[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var x=m.value;try{for(var b,k=this.measures[c][x][Symbol.iterator]();!(l=(b=k.next()).done);l=!0){var w=b.value;n.push(w),e.push(x),t.push("*"===c?null:h.replacePathInField(c))}}catch(e){f=!0,d=e}finally{try{l||null==k.return||k.return()}finally{if(f)throw d}}}}catch(e){v=!0,g=e}finally{try{p||null==y.return||y.return()}finally{if(v)throw g}}}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return{type:"aggregate",groupby:r.default(this.dimensions).map(h.replacePathInField),ops:e,fields:t,as:n}}}],[{key:"makeFromEncoding",value:function(e,t){var r=!1;t.forEachFieldDef((function(e){e.aggregate&&(r=!0)}));var a={},i=new Set;return r?(t.forEachFieldDef((function(e,n){var r,o,u,s,c=e.aggregate,p=e.field;if(c)if("count"===c)a["*"]=null!==(r=a["*"])&&void 0!==r?r:{},a["*"].count=new Set([d.vgField(e,{forAs:!0})]);else{if(l.isArgminDef(c)||l.isArgmaxDef(c)){var h=l.isArgminDef(c)?"argmin":"argmax",g=c[h];a[g]=null!==(o=a[g])&&void 0!==o?o:{},a[g][h]=new Set([d.vgField({op:h,field:g},{forAs:!0})])}else a[p]=null!==(u=a[p])&&void 0!==u?u:{},a[p][c]=new Set([d.vgField(e,{forAs:!0})]);f.isScaleChannel(n)&&"unaggregated"===t.scaleDomain(n)&&(a[p]=null!==(s=a[p])&&void 0!==s?s:{},a[p].min=new Set([d.vgField({field:p,aggregate:"min"},{forAs:!0})]),a[p].max=new Set([d.vgField({field:p,aggregate:"max"},{forAs:!0})]))}else!function(e,t,n,r){var a=v.isUnitModel(r)?r.encoding[f.getSecondaryRangeChannel(t)]:void 0;if(d.isTypedFieldDef(n)&&v.isUnitModel(r)&&d.hasBand(t,n,a,r.stack,r.markDef,r.config))e.add(d.vgField(n,{})),e.add(d.vgField(n,{suffix:"end"})),n.bin&&d.binRequiresRange(n,t)&&e.add(d.vgField(n,{binSuffix:"range"}));else if(f.isGeoPositionChannel(t)){var i=f.getPositionChannelFromLatLong(t);e.add(r.getName(i))}else e.add(d.vgField(n))}(i,n,e,t)})),i.size+h.keys(a).length===0?null:new n(e,i,a)):null}},{key:"makeFromTransform",value:function(e,t){var r,a,i,o=new Set,u={},s=!0,c=!1,l=void 0;try{for(var f,p=t.aggregate[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var v=f.value,g=v.op,m=v.field,y=v.as;g&&("count"===g?(u["*"]=null!==(r=u["*"])&&void 0!==r?r:{},u["*"].count=new Set([y||d.vgField(v,{forAs:!0})])):(u[m]=null!==(a=u[m])&&void 0!==a?a:{},u[m][g]=new Set([y||d.vgField(v,{forAs:!0})])))}}catch(e){c=!0,l=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}var x=!0,b=!1,k=void 0;try{for(var w,A=(null!==(i=t.groupby)&&void 0!==i?i:[])[Symbol.iterator]();!(x=(w=A.next()).done);x=!0){var E=w.value;o.add(E)}}catch(e){b=!0,k=e}finally{try{x||null==A.return||A.return()}finally{if(b)throw k}}return o.size+h.keys(u).length===0?null:new n(e,o,u)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("fPIRu",(function(e,t){n(e.exports,"FacetNode",(function(){return k})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("9M1dW"),u=s("2tuUj");s("iSlfb");var c=s("4ujSI"),l=s("61RXI"),f=s("e3OyN"),d=s("iooJ7"),p=s("16rNM"),h=s("7J7Lf"),v=s("2V3EF"),g=s("lSb9O"),m=s("7T458"),y=s("7HuhJ"),x=s("ivIoL"),b=s("fFVzC"),k=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,u){var s;i.default(this,n),(s=t.call(this,e)).model=r,s.name=a,s.data=u;var p=!0,h=!1,g=void 0;try{for(var m,y=f.FACET_CHANNELS[Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var x=m.value,k=r.facet[x];if(k){var w=k.bin,A=k.sort;s[x]=Object.assign({name:r.getName("".concat(x,"_domain")),fields:[d.vgField(k)].concat(o.default(l.isBinning(w)?[d.vgField(k,{binSuffix:"end"})]:[]))},v.isSortField(A)?{sortField:A}:c.default(A)?{sortIndexField:b.sortArrayIndexField(k,x)}:{})}}}catch(e){h=!0,g=e}finally{try{p||null==y.return||y.return()}finally{if(h)throw g}}return s.childModel=r.child,s}return u.default(n,[{key:"hash",value:function(){var e="Facet",t=!0,n=!1,r=void 0;try{for(var a,i=f.FACET_CHANNELS[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;this[o]&&(e+=" ".concat(o.charAt(0),":").concat(g.hash(this[o])))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"fields",get:function(){var e,t,n=[],r=!0,a=!1,i=void 0;try{for(var u,s=f.FACET_CHANNELS[Symbol.iterator]();!(r=(u=s.next()).done);r=!0){var c=u.value;(null===(t=this[c])||void 0===t?void 0:t.fields)&&(e=n).push.apply(e,o.default(this[c].fields))}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}return n}},{key:"dependentFields",value:function(){var e=new Set(this.fields),t=!0,n=!1,r=void 0;try{for(var a,i=f.FACET_CHANNELS[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;this[o]&&(this[o].sortField&&e.add(this[o].sortField.field),this[o].sortIndexField&&e.add(this[o].sortIndexField))}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"producedFields",value:function(){return new Set}},{key:"getSource",value:function(){return this.name}},{key:"getChildIndependentFieldsWithStep",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var a,i=f.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,u=this.childModel.component.scales[o];if(u&&!u.merged){var s=u.get("type"),c=u.get("range");if(h.hasDiscreteDomain(s)&&m.isVgRangeStep(c)){var l=x.assembleDomain(this.childModel,o),d=x.getFieldFromDomain(l);d?e[o]=d:p.warn("Unknown field for ".concat(o,". Cannot calculate view size."))}}}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"assembleRowColumnHeaderData",value:function(e,t,n){var r={row:"y",column:"x"}[e],a=[],i=[],o=[];n&&n[r]&&(t?(a.push("distinct_".concat(n[r])),i.push("max")):(a.push(n[r]),i.push("distinct")),o.push("distinct_".concat(n[r])));var u=this[e],s=u.sortField,c=u.sortIndexField;if(s){var l=s.op,f=void 0===l?v.DEFAULT_SORT_OP:l,p=s.field;a.push(p),i.push(f),o.push(d.vgField(s,{forAs:!0}))}else c&&(a.push(c),i.push("max"),o.push(c));return{name:this[e].name,source:null!=t?t:this.data,transform:[Object.assign({type:"aggregate",groupby:this[e].fields},a.length?{fields:a,ops:i,as:o}:{})]}}},{key:"assembleFacetHeaderData",value:function(e){var t,n,r=this.model.layout.columns,a=this.model.component.layoutHeaders,i=[],o={},u=!0,s=!1,c=void 0;try{for(var l,f=y.HEADER_CHANNELS[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value,p=!0,h=!1,v=void 0;try{for(var g,m=y.HEADER_TYPES[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var x=g.value,b=null!==(t=a[d]&&a[d][x])&&void 0!==t?t:[],k=!0,w=!1,A=void 0;try{for(var E,C=b[Symbol.iterator]();!(k=(E=C.next()).done);k=!0){if((null===(n=E.value.axes)||void 0===n?void 0:n.length)>0){o[d]=!0;break}}}catch(e){w=!0,A=e}finally{try{k||null==C.return||C.return()}finally{if(w)throw A}}}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}if(o[d]){var S='length(data("'.concat(this.facet.name,'"))'),N="row"===d?r?{signal:"ceil(".concat(S," / ").concat(r,")")}:1:r?{signal:"min(".concat(S,", ").concat(r,")")}:{signal:S};i.push({name:"".concat(this.facet.name,"_").concat(d),transform:[{type:"sequence",start:0,stop:N}]})}}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}var T=o.row,D=o.column;return(T||D)&&i.unshift(this.assembleRowColumnHeaderData("facet",null,e)),i}},{key:"assemble",value:function(){var e,t,n=[],r=null,a=this.getChildIndependentFieldsWithStep(),i=this,u=i.column,s=i.row,c=i.facet;if(u&&s&&(a.x||a.y)){r="cross_".concat(this.column.name,"_").concat(this.row.name);var l=[].concat(null!==(e=a.x)&&void 0!==e?e:[],null!==(t=a.y)&&void 0!==t?t:[]),d=l.map((function(){return"distinct"}));n.push({name:r,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:l,ops:d}]})}var p=!0,h=!1,v=void 0;try{for(var g,m=[f.COLUMN,f.ROW][Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=g.value;this[y]&&n.push(this.assembleRowColumnHeaderData(y,r,a))}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}if(c){var x,b=this.assembleFacetHeaderData(a);b&&(x=n).push.apply(x,o.default(b))}return n}}]),n}(s("5XgHP").DataFlowNode)})),s.register("lmM4C",(function(e,t){n(e.exports,"getImplicitFromFilterTransform",(function(){return S})),n(e.exports,"getImplicitFromEncoding",(function(){return N})),n(e.exports,"getImplicitFromSelection",(function(){return T})),n(e.exports,"ParseNode",(function(){return D})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj");s("iSlfb");var u=s("8AF0b"),c=s("fCSiB"),l=s("6jZCp"),f=s("e3OyN"),d=s("iooJ7"),p=s("1Z7Bs"),h=s("ggS1y"),v=s("16rNM"),g=s("2x4HI"),m=s("12Yae"),y=s("4sOzK"),x=s("ceGn0"),b=s("2V3EF"),k=s("lSb9O"),w=s("jZr2L"),A=s("CFwcG");function E(e){return"'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1]?e.slice(1,-1):e}function C(e,t){var n=k.accessPathWithDatum(e);if("number"===t)return"toNumber(".concat(n,")");if("boolean"===t)return"toBoolean(".concat(n,")");if("string"===t)return"toString(".concat(n,")");if("date"===t)return"toDate(".concat(n,")");if("flatten"===t)return n;if(0===t.indexOf("date:")){var r=E(t.slice(5,t.length));return"timeParse(".concat(n,",'").concat(r,"')")}if(0===t.indexOf("utc:")){var a=E(t.slice(4,t.length));return"utcParse(".concat(n,",'").concat(a,"')")}return v.warn(g.unrecognizedParse(t)),null}function S(e){var t={};return m.forEachLeaf(e.filter,(function(e){var n;if(x.isFieldPredicate(e)){var r=null;x.isFieldEqualPredicate(e)?r=e.equal:x.isFieldRangePredicate(e)?r=e.range[0]:x.isFieldOneOfPredicate(e)&&(r=(null!==(n=e.oneOf)&&void 0!==n?n:e.in)[0]),r&&(h.isDateTime(r)?t[e.field]="date":u.default(r)?t[e.field]="number":c.default(r)&&(t[e.field]="string")),e.timeUnit&&(t[e.field]="date")}})),t}function N(e){var t={};function n(e){d.isFieldOrDatumDefForTimeFormat(e)?t[e.field]="date":"quantitative"===e.type&&l.isMinMaxOp(e.aggregate)?t[e.field]="number":k.accessPathDepth(e.field)>1?e.field in t||(t[e.field]="flatten"):d.isScaleFieldDef(e)&&b.isSortField(e.sort)&&k.accessPathDepth(e.sort.field)>1&&(e.sort.field in t||(t[e.sort.field]="flatten"))}if((w.isUnitModel(e)||w.isFacetModel(e))&&e.forEachFieldDef((function(t,r){if(d.isTypedFieldDef(t))n(t);else{var a=f.getMainRangeChannel(r),i=e.fieldDef(a);n(Object.assign(Object.assign({},t),{type:i.type}))}})),w.isUnitModel(e)){var r=e.mark,a=e.markDef,i=e.encoding;if(y.isPathMark(r)&&!e.encoding.order){var o=i["horizontal"===a.orient?"y":"x"];d.isFieldDef(o)&&"quantitative"===o.type&&!(o.field in t)&&(t[o.field]="number")}}return t}function T(e){var t={},n=!0,r=!1,a=void 0;if(w.isUnitModel(e)&&e.component.selection)try{for(var i,o=k.keys(e.component.selection)[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value,s=e.component.selection[u],c=!0,l=!1,f=void 0;try{for(var d,p=s.project.items[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;!h.channel&&k.accessPathDepth(h.field)>1&&(t[h.field]="flatten")}}catch(e){l=!0,f=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}var D=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e))._parse=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,k.duplicate(this._parse))}},{key:"hash",value:function(){return"Parse ".concat(k.hash(this._parse))}},{key:"parse",get:function(){return this._parse}},{key:"merge",value:function(e){this._parse=Object.assign(Object.assign({},this._parse),e.parse),e.remove()}},{key:"assembleFormatParse",value:function(){var e={},t=!0,n=!1,r=void 0;try{for(var a,i=k.keys(this._parse)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,u=this._parse[o];1===k.accessPathDepth(o)&&(e[o]=u)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"producedFields",value:function(){return new Set(k.keys(this._parse))}},{key:"dependentFields",value:function(){return new Set(k.keys(this._parse))}},{key:"assembleTransforms",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;return k.keys(this._parse).filter((function(t){return!e||k.accessPathDepth(t)>1})).map((function(e){var n=C(e,t._parse[e]);return n?{type:"formula",expr:n,as:k.removePathFromField(e)}:null})).filter((function(e){return null!==e}))}}],[{key:"makeExplicit",value:function(e,t,n){var r={},a=t.data;return!p.isGenerator(a)&&a&&a.format&&a.format.parse&&(r=a.format.parse),this.makeWithAncestors(e,r,{},n)}},{key:"makeWithAncestors",value:function(e,t,r,a){var i=!0,o=!1,u=void 0;try{for(var s,c=k.keys(r)[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value,f=a.getWithExplicit(l);void 0!==f.value&&(f.explicit||f.value===r[l]||"derived"===f.value||"flatten"===r[l]?delete r[l]:v.warn(g.differentParse(l,r[l],f.value)))}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}var d=!0,p=!1,h=void 0;try{for(var m,y=k.keys(t)[Symbol.iterator]();!(d=(m=y.next()).done);d=!0){var x=m.value,b=a.get(x);void 0!==b&&(b===t[x]?delete t[x]:v.warn(g.differentParse(x,t[x],b)))}}catch(e){p=!0,h=e}finally{try{d||null==y.return||y.return()}finally{if(p)throw h}}var w=new A.Split(t,r);a.copyAll(w);var E={},C=!0,S=!1,N=void 0;try{for(var T,D=k.keys(w.combine())[Symbol.iterator]();!(C=(T=D.next()).done);C=!0){var F=T.value,O=w.get(F);null!==O&&(E[F]=O)}}catch(e){S=!0,N=e}finally{try{C||null==D.return||D.return()}finally{if(S)throw N}}return 0===k.keys(E).length||a.parseNothing?null:new n(e,E)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("4gRNk",(function(e,t){n(e.exports,"IdentifierNode",(function(){return c})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("5XFBz"),c=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e){return i.default(this,n),t.call(this,e)}return o.default(n,[{key:"clone",value:function(){return new n(null)}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set([u.SELECTION_ID])}},{key:"hash",value:function(){return"Identifier"}},{key:"assemble",value:function(){return{type:"identifier",as:u.SELECTION_ID}}}]),n}(s("5XgHP").DataFlowNode)})),s.register("e0CR6",(function(e,t){n(e.exports,"JoinAggregateTransformNode",(function(){return l})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("iooJ7"),c=s("lSb9O"),l=(c=s("lSb9O"),function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).transform=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,c.duplicate(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=c.unique(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e=new Set;return this.transform.groupby&&this.transform.groupby.forEach(e.add,e),this.transform.joinaggregate.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:u.vgField(e)}},{key:"hash",value:function(){return"JoinAggregateTransform ".concat(c.hash(this.transform))}},{key:"assemble",value:function(){var e=[],t=[],n=[],r=!0,a=!1,i=void 0;try{for(var o,u=this.transform.joinaggregate[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;t.push(s.op),n.push(this.getDefaultName(s)),e.push(void 0===s.field?null:s.field)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}var c=this.transform.groupby;return Object.assign({type:"joinaggregate",as:n,ops:t,fields:e},void 0!==c?{groupby:c}:{})}}]),n}(s("5XgHP").DataFlowNode))})),s.register("gR1OF",(function(e,t){n(e.exports,"StackNode",(function(){return h})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW");s("iSlfb");var c=s("4ujSI"),l=s("fCSiB"),f=s("iooJ7"),d=s("lSb9O"),p=s("9iwJo");var h=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e))._stack=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,d.duplicate(this._stack))}},{key:"stack",get:function(){return this._stack}},{key:"addDimensions",value:function(e){var t;(t=this._stack.facetby).push.apply(t,u.default(e))}},{key:"dependentFields",value:function(){var e=new Set;return e.add(this._stack.stackField),this.getGroupbyFields().forEach(e.add,e),this._stack.facetby.forEach(e.add,e),this._stack.sort.field.forEach(e.add,e),e}},{key:"producedFields",value:function(){return new Set(this._stack.as)}},{key:"hash",value:function(){return"Stack ".concat(d.hash(this._stack))}},{key:"getGroupbyFields",value:function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;return t?t.bin?n?[f.vgField(t,{binSuffix:"mid"})]:[f.vgField(t,{}),f.vgField(t,{binSuffix:"end"})]:[f.vgField(t)]:null!=r?r:[]}},{key:"assemble",value:function(){var e=[],t=this._stack,n=t.facetby,r=t.dimensionFieldDef,a=t.stackField,i=t.stackby,o=t.sort,s=t.offset,c=t.impute,l=t.as;if(c&&r){var d=r.band,p=void 0===d?.5:d;r.bin&&e.push({type:"formula",expr:"".concat(p,"*")+f.vgField(r,{expr:"datum"})+"+".concat(1-p,"*")+f.vgField(r,{expr:"datum",binSuffix:"end"}),as:f.vgField(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:a,groupby:u.default(i).concat(u.default(n)),key:f.vgField(r,{binSuffix:"mid"}),method:"value",value:0})}return e.push({type:"stack",groupby:u.default(this.getGroupbyFields()).concat(u.default(n)),field:a,sort:o,as:l,offset:s}),e}}],[{key:"makeFromTransform",value:function(e,t){var r=t.stack,a=t.groupby,i=t.as,o=t.offset,u=void 0===o?"zero":o,s=[],f=[],p=!0,h=!1,v=void 0;if(void 0!==t.sort)try{for(var g,m=t.sort[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){var y=g.value;s.push(y.field),f.push(d.getFirstDefined(y.order,"ascending"))}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}var x,b={field:s,order:f};return x=function(e){return c.default(e)&&e.every((function(e){return l.default(e)}))&&e.length>1}(i)?i:l.default(i)?[i,i+"_end"]:[t.stack+"_start",t.stack+"_end"],new n(e,{stackField:r,groupby:a,offset:u,sort:b,facetby:[],as:x})}},{key:"makeFromEncoding",value:function(e,t){var r=t.stack,a=t.encoding;if(!r)return null;var i,o=r.groupbyChannel,u=r.fieldChannel,s=r.offset,l=r.impute;if(o){var d=a[o];i=f.getFieldDef(d)}var h,v=function(e){return e.stack.stackBy.reduce((function(e,t){var n=t.fieldDef,r=f.vgField(n);return r&&e.push(r),e}),[])}(t),g=t.encoding.order;return h=c.default(g)||f.isFieldDef(g)?p.sortParams(g):v.reduce((function(e,t){return e.field.push(t),e.order.push("y"===u?"descending":"ascending"),e}),{field:[],order:[]}),new n(e,{dimensionFieldDef:i,stackField:t.vgField(u),facetby:[],stackby:v,sort:h,offset:s,impute:l,as:[t.vgField(u,{suffix:"start",forAs:!0}),t.vgField(u,{suffix:"end",forAs:!0})]})}}]),n}(s("5XgHP").DataFlowNode)})),s.register("hijEA",(function(e,t){n(e.exports,"WindowTransformNode",(function(){return f})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("6jZCp"),c=s("iooJ7"),l=s("lSb9O"),f=(l=s("lSb9O"),function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).transform=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,l.duplicate(this.transform))}},{key:"addDimensions",value:function(e){this.transform.groupby=l.unique(this.transform.groupby.concat(e),(function(e){return e}))}},{key:"dependentFields",value:function(){var e,t,n=new Set;return(null!==(e=this.transform.groupby)&&void 0!==e?e:[]).forEach(n.add,n),(null!==(t=this.transform.sort)&&void 0!==t?t:[]).forEach((function(e){return n.add(e.field)})),this.transform.window.map((function(e){return e.field})).filter((function(e){return void 0!==e})).forEach(n.add,n),n}},{key:"producedFields",value:function(){return new Set(this.transform.window.map(this.getDefaultName))}},{key:"getDefaultName",value:function(e){var t;return null!==(t=e.as)&&void 0!==t?t:c.vgField(e)}},{key:"hash",value:function(){return"WindowTransform ".concat(l.hash(this.transform))}},{key:"assemble",value:function(){var e,t=[],n=[],r=[],a=[],i=!0,o=!1,s=void 0;try{for(var c,l=this.transform.window[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;n.push(f.op),r.push(this.getDefaultName(f)),a.push(void 0===f.param?null:f.param),t.push(void 0===f.field?null:f.field)}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}var d=this.transform.frame,p=this.transform.groupby;if(d&&null===d[0]&&null===d[1]&&n.every((function(e){return u.isAggregateOp(e)})))return Object.assign({type:"joinaggregate",as:r,ops:n,fields:t},void 0!==p?{groupby:p}:{});var h=[],v=[],g=!0,m=!1,y=void 0;if(void 0!==this.transform.sort)try{for(var x,b=this.transform.sort[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var k=x.value;h.push(k.field),v.push(null!==(e=k.order)&&void 0!==e?e:"ascending")}}catch(e){m=!0,y=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}var w={field:h,order:v},A=this.transform.ignorePeers;return Object.assign(Object.assign(Object.assign({type:"window",params:a,as:r,ops:n,fields:t,sort:w},void 0!==A?{ignorePeers:A}:{}),void 0!==p?{groupby:p}:{}),void 0!==d?{frame:d}:{})}}]),n}(s("5XgHP").DataFlowNode))})),s.register("hr8xM",(function(e,t){n(e.exports,"SignalRefWrapper",(function(){return i})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=function(){"use strict";function e(t){r.default(this,e),Object.defineProperty(this,"signal",{enumerable:!0,get:t})}return a.default(e,null,[{key:"fromName",value:function(t,n){return new e((function(){return t(n)}))}}]),e}()})),s.register("3RXxY",(function(e,t){n(e.exports,"parseScales",(function(){return m}));var r=s("e3OyN"),a=s("iooJ7"),i=s("4sOzK"),o=s("7J7Lf"),u=s("4jgmF"),c=s("lSb9O"),l=s("jZr2L"),f=s("598xZ"),d=s("CFwcG"),p=s("8wifb"),h=s("ivIoL"),v=s("g7zG1"),g=s("4AxJM");function m(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).ignoreRange;y(e),h.parseScaleDomain(e);var n=!0,r=!1,a=void 0;try{for(var i,u=o.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var s=i.value;v.parseScaleProperty(e,s)}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}t||v.parseScaleRange(e)}function y(e){l.isUnitModel(e)?e.component.scales=function(e){var t=e.encoding,n=e.mark;return r.SCALE_CHANNELS.reduce((function(o,s){var c=a.getFieldOrDatumDef(t[s]);if(c&&n===i.GEOSHAPE&&s===r.SHAPE&&c.type===u.GEOJSON)return o;var l=c&&c.scale;if(c&&null!==l&&!1!==l){l=null!=l?l:{};var f=g.scaleType(l,s,c,n);o[s]=new p.ScaleComponent(e.scaleName(s+"",!0),{value:f,explicit:l.type===f})}return o}),{})}(e):e.component.scales=function(e){var t,n=e.component.scales={},r={},a=e.component.resolve,i=!0,u=!1,s=void 0;try{for(var l,h=e.children[Symbol.iterator]();!(i=(l=h.next()).done);i=!0){var v=l.value;y(v);var g=!0,m=!1,b=void 0;try{for(var k,w=c.keys(v.component.scales)[Symbol.iterator]();!(g=(k=w.next()).done);g=!0){var A=k.value;if(a.scale[A]=null!==(t=a.scale[A])&&void 0!==t?t:f.defaultScaleResolve(A,e),"shared"===a.scale[A]){var E=r[A],C=v.component.scales[A].getWithExplicit("type");E?o.scaleCompatible(E.value,C.value)?r[A]=d.mergeValuesWithExplicit(E,C,"type","scale",x):(a.scale[A]="independent",delete r[A]):r[A]=C}}}catch(e){m=!0,b=e}finally{try{g||null==w.return||w.return()}finally{if(m)throw b}}}}catch(e){u=!0,s=e}finally{try{i||null==h.return||h.return()}finally{if(u)throw s}}var S=!0,N=!1,T=void 0;try{for(var D,F=c.keys(r)[Symbol.iterator]();!(S=(D=F.next()).done);S=!0){var O=D.value,_=e.scaleName(O,!0),I=r[O];n[O]=new p.ScaleComponent(_,I);var R=!0,M=!1,B=void 0;try{for(var P,L=e.children[Symbol.iterator]();!(R=(P=L.next()).done);R=!0){var j=P.value,z=j.component.scales[O];z&&(j.renameScale(z.get("name"),_),z.merged=!0)}}catch(e){M=!0,B=e}finally{try{R||null==L.return||L.return()}finally{if(M)throw B}}}}catch(e){N=!0,T=e}finally{try{S||null==F.return||F.return()}finally{if(N)throw T}}return n}(e)}var x=d.tieBreakByComparing((function(e,t){return o.scaleTypePrecedence(e)-o.scaleTypePrecedence(t)}))})),s.register("8wifb",(function(e,t){n(e.exports,"ScaleComponent",(function(){return l})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj");s("iSlfb");var u=s("4ujSI"),c=s("lSb9O"),l=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,{},{name:e})).merged=!1,a.setWithExplicit("type",r),a}return o.default(n,[{key:"domainDefinitelyIncludesZero",value:function(){return!1!==this.get("zero")||c.some(this.get("domains"),(function(e){return u.default(e)&&2===e.length&&e[0]<=0&&e[1]>=0}))}}]),n}(s("CFwcG").Split)})),s.register("g7zG1",(function(e,t){n(e.exports,"parseScaleProperty",(function(){return x})),n(e.exports,"parseScaleRange",(function(){return k})),s("1i51P");var r=s("9M1dW");s("iSlfb");var a=s("4ujSI"),i=s("61RXI"),o=s("e3OyN"),u=s("iooJ7"),c=s("16rNM"),l=s("2x4HI"),f=s("7J7Lf"),d=s("lSb9O"),p=(d=s("lSb9O"),s("7T458")),h=s("4ewT3"),v=s("jZr2L"),g=s("hr8xM"),m=s("CFwcG"),y=s("ewn9K");function x(e,t){v.isUnitModel(e)?function(e,t){var n=e.component.scales,r=e.config,a=e.encoding,i=e.markDef,o=e.specifiedScales,s=!0,p=!1,h=void 0;try{for(var v,g=d.keys(n)[Symbol.iterator]();!(s=(v=g.next()).done);s=!0){var m=v.value,y=o[m],x=n[m],k=e.getScaleComponent(m),w=u.getFieldOrDatumDef(a[m]),A=y[t],E=k.get("type"),C=k.get("padding"),S=k.get("paddingInner"),N=f.scaleTypeSupportProperty(E,t),T=f.channelScalePropertyIncompatability(m,t);if(void 0!==A&&(N?T&&c.warn(T):c.warn(l.scalePropertyNotWorkWithScaleType(E,t,m))),N&&void 0===T)if(void 0!==A)x.copyKeyFromObject(t,y);else{var D=t in b?b[t]({model:e,channel:m,fieldOrDatumDef:w,scaleType:E,scalePadding:C,scalePaddingInner:S,domain:y.domain,markDef:i,config:r}):r.scale[t];void 0!==D&&x.set(t,D,!1)}}}catch(e){p=!0,h=e}finally{try{s||null==g.return||g.return()}finally{if(p)throw h}}}(e,t):w(e,t)}var b={bins:function(e){var t=e.model,n=e.fieldOrDatumDef;return u.isFieldDef(n)?function(e,t){var n=t.bin;if(i.isBinning(n)){var r=h.getBinSignalName(e,t.field,n);return new g.SignalRefWrapper((function(){return e.getSignalName(r)}))}if(i.isBinned(n)&&i.isBinParams(n)&&void 0!==n.step)return{step:n.step};return}(t,n):void 0},interpolate:function(e){return function(e,t){return d.contains([o.COLOR,o.FILL,o.STROKE],e)&&"nominal"!==t?"hcl":void 0}(e.channel,e.fieldOrDatumDef.type)},nice:function(e){return function(e,t,n){var r;return(null===(r=u.getFieldDef(n))||void 0===r?void 0:r.bin)||d.contains([f.ScaleType.TIME,f.ScaleType.UTC],e)?void 0:t in o.POSITION_SCALE_CHANNEL_INDEX||void 0}(e.scaleType,e.channel,e.fieldOrDatumDef)},padding:function(e){var t=e.channel,n=e.scaleType,r=e.fieldOrDatumDef,a=e.markDef,i=e.config;return function(e,t,n,r,a,i){if(e in o.POSITION_SCALE_CHANNEL_INDEX){if(f.isContinuousToContinuous(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var s=a.type,c=a.orient;if("bar"===s&&(!u.isFieldDef(r)||!r.bin&&!r.timeUnit)&&("vertical"===c&&"x"===e||"horizontal"===c&&"y"===e))return i.continuousBandSize}if(t===f.ScaleType.POINT)return n.pointPadding}return}(t,n,i.scale,r,a,i.bar)},paddingInner:function(e){var t=e.scalePadding,n=e.channel,r=e.markDef,a=e.config;return function(e,t,n,r){if(void 0!==e)return;if(t in o.POSITION_SCALE_CHANNEL_INDEX){var a=r.bandPaddingInner,i=r.barBandPaddingInner,u=r.rectBandPaddingInner;return d.getFirstDefined(a,"bar"===n?i:u)}return}(t,n,r.type,a.scale)},paddingOuter:function(e){var t=e.scalePadding,n=e.channel,r=e.scaleType,a=e.markDef,i=e.scalePaddingInner,u=e.config;return function(e,t,n,r,a,i){if(void 0!==e)return;if(t in o.POSITION_SCALE_CHANNEL_INDEX&&n===f.ScaleType.BAND){var u=i.bandPaddingOuter;return d.getFirstDefined(u,p.isSignalRef(a)?{signal:"".concat(a.signal,"/2")}:a/2)}return}(t,n,r,a.type,i,u.scale)},reverse:function(e){var t=e.fieldOrDatumDef,n=e.scaleType,r=e.channel,a=e.config;return function(e,t,n,r){if("x"===n&&void 0!==r.xReverse)return f.hasContinuousDomain(e)&&"descending"===t?p.isSignalRef(r.xReverse)?{signal:"!".concat(r.xReverse.signal)}:!r.xReverse:r.xReverse;return!(!f.hasContinuousDomain(e)||"descending"!==t)||void 0}(n,u.isFieldDef(t)?t.sort:void 0,r,a.scale)},zero:function(e){return function(e,t,n,i,s){if(n&&"unaggregated"!==n&&f.hasContinuousDomain(s)){if(a.default(n)){var c=n[0],l=n[n.length-1];if(c<=0&&l>=0)return!0}return!1}if("size"===e&&"quantitative"===t.type&&!f.isContinuousToDiscrete(s))return!0;if((!u.isFieldDef(t)||!t.bin)&&d.contains(r.default(o.POSITION_SCALE_CHANNELS).concat(r.default(o.POLAR_POSITION_SCALE_CHANNELS)),e)){var p=i.orient,h=i.type;return!d.contains(["bar","area","line","trail"],h)||!("horizontal"===p&&"y"===e||"vertical"===p&&"x"===e)}return!1}(e.channel,e.fieldOrDatumDef,e.domain,e.markDef,e.scaleType)}};function k(e){v.isUnitModel(e)?y.parseUnitScaleRange(e):w(e,"range")}function w(e,t){var n=e.component.scales,r=!0,a=!1,i=void 0;try{for(var o,u=e.children[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;"range"===t?k(s):x(s,t)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}var c=!0,l=!1,f=void 0;try{for(var p,h=d.keys(n)[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var v=p.value,g=void 0,y=!0,b=!1,w=void 0;try{for(var A,E=e.children[Symbol.iterator]();!(y=(A=E.next()).done);y=!0){var C=A.value.component.scales[v];if(C){var S=C.getWithExplicit(t);g=m.mergeValuesWithExplicit(g,S,t,"scale",m.tieBreakByComparing((function(e,n){return"range"===t&&e.step&&n.step?e.step-n.step:0})))}}}catch(e){b=!0,w=e}finally{try{y||null==E.return||E.return()}finally{if(b)throw w}}n[v].setWithExplicit(t,g)}}catch(e){l=!0,f=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw f}}}})),s.register("ewn9K",(function(e,t){n(e.exports,"parseUnitScaleRange",(function(){return w})),s("iSlfb");var r=s("4ujSI"),a=s("8AF0b"),i=s("61RXI"),o=s("e3OyN"),u=s("iooJ7"),c=s("fldOo"),l=s("16rNM"),f=s("2x4HI"),d=s("7J7Lf"),p=s("eg4js"),h=s("lSb9O"),v=s("7T458"),g=s("4ewT3"),m=s("hr8xM"),y=s("CFwcG"),x=s("9iwJo"),b=["range","scheme"];function k(e){return"x"===e?"width":"y"===e?"height":void 0}function w(e){var t=e.component.scales,n=!0,r=!1,a=void 0;try{for(var i,u=o.SCALE_CHANNELS[Symbol.iterator]();!(n=(i=u.next()).done);n=!0){var s=i.value,c=t[s];if(c){var l=E(s,e);c.setWithExplicit("range",l)}}}catch(e){r=!0,a=e}finally{try{n||null==u.return||u.return()}finally{if(r)throw a}}}function A(e,t){var n=e.fieldDef(t);if(n&&n.bin&&i.isBinning(n.bin)){var r=g.getBinSignalName(e,n.field,n.bin),a=k(t),o=e.getName(a);return new m.SignalRefWrapper((function(){var t=e.getSignalName(r),n="(".concat(t,".stop - ").concat(t,".start) / ").concat(t,".step");return"".concat(e.getSignalName(o)," / (").concat(n,")")}))}}function E(e,t){var n=t.specifiedScales[e],i=t.size,s=t.getScaleComponent(e).get("type"),g=!0,w=!1,E=void 0;try{for(var D,F=b[Symbol.iterator]();!(g=(D=F.next()).done);g=!0){var O=D.value;if(void 0!==n[O]){var _=d.scaleTypeSupportProperty(s,O),I=d.channelScalePropertyIncompatability(e,O);if(_)if(I)l.warn(I);else switch(O){case"range":return r.default(n.range)&&o.isXorY(e)?y.makeExplicit(n.range.map((function(e){if("width"===e||"height"===e){var n=t.getName(e),r=t.getSignalName.bind(t);return m.SignalRefWrapper.fromName(r,n)}return e}))):y.makeExplicit(n.range);case"scheme":return y.makeExplicit(C(n[O]))}else l.warn(f.scalePropertyNotWorkWithScaleType(s,O,e))}}}catch(e){w=!0,E=e}finally{try{g||null==F.return||F.return()}finally{if(w)throw E}}if(e===o.X||e===o.Y){var R=e===o.X?"width":"height",M=i[R];if(p.isStep(M)){if(d.hasDiscreteDomain(s))return y.makeExplicit({step:M.step});l.warn(f.stepDropped(R))}}return y.makeImplicit(function(e,t){var n=t.size,i=t.config,s=t.mark,g=t.encoding,y=t.getSignalName.bind(t),b=u.getFieldOrDatumDef(g[e]).type,w=t.getScaleComponent(e).get("type"),E=t.specifiedScales[e],C=E.domain,D=E.domainMid;switch(e){case o.X:case o.Y:if(h.contains(["point","band"],w))if(e!==o.X||n.width){if(e===o.Y&&!n.height){var F=c.getViewConfigDiscreteSize(i.view,"height");if(p.isStep(F))return F}}else{var O=c.getViewConfigDiscreteSize(i.view,"width");if(p.isStep(O))return O}var _=k(e),I=t.getName(_);return e===o.Y&&d.hasContinuousDomain(w)?[m.SignalRefWrapper.fromName(y,I),0]:[0,m.SignalRefWrapper.fromName(y,I)];case o.SIZE:var R=S(s,t.component.scales[e].get("zero"),i),M=function(e,t,n,r){var i={x:A(n,"x"),y:A(n,"y")};switch(e){case"bar":case"tick":if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;var o=T(t,i,r.view);return a.default(o)?o-1:new m.SignalRefWrapper((function(){return"".concat(o.signal," - 1")}));case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":if(r.scale.maxSize)return r.scale.maxSize;var u=T(t,i,r.view);return a.default(u)?Math.pow(N*u,2):new m.SignalRefWrapper((function(){return"pow(".concat(N," * ").concat(u.signal,", 2)")}))}throw new Error(f.incompatibleChannel("size",e))}(s,n,t,i);return d.isContinuousToDiscrete(w)?function(e,t,n){var r=function(){var r=x.signalOrStringValue(t),a=x.signalOrStringValue(e),i="(".concat(r," - ").concat(a,") / (").concat(n," - 1)");return"sequence(".concat(a,", ").concat(r," + ").concat(i,", ").concat(i,")")};return v.isSignalRef(t)?new m.SignalRefWrapper(r):{signal:r()}}(R,M,function(e,t,n,a){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&r.default(n)?n.length+1:(l.warn(f.domainRequiredForThresholdScale(a)),3)}}(w,i,C,e)):[R,M];case o.THETA:return[0,2*Math.PI];case o.ANGLE:return[0,360];case o.RADIUS:return[0,new m.SignalRefWrapper((function(){var e=t.getSignalName("width"),n=t.getSignalName("height");return"min(".concat(e,",").concat(n,")/2")}))];case o.STROKEWIDTH:return[i.scale.minStrokeWidth,i.scale.maxStrokeWidth];case o.STROKEDASH:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case o.SHAPE:return"symbol";case o.COLOR:case o.FILL:case o.STROKE:return"ordinal"===w?"nominal"===b?"category":"ordinal":void 0!==D?"diverging":"rect"===s||"geoshape"===s?"heatmap":"ramp";case o.OPACITY:case o.FILLOPACITY:case o.STROKEOPACITY:return[i.scale.minOpacity,i.scale.maxOpacity]}throw new Error("Scale range undefined for channel ".concat(e))}(e,t))}function C(e){return d.isExtendedScheme(e)?Object.assign({scheme:e.name},h.omit(e,["name"])):{scheme:e}}function S(e,t,n){if(t)return v.isSignalRef(t)?{signal:"".concat(t.signal," ? 0 : ").concat(S(e,!1,n))}:0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(f.incompatibleChannel("size",e))}var N=.95;function T(e,t,n){var r=p.isStep(e.width)?e.width.step:c.getViewConfigDiscreteStep(n,"width"),a=p.isStep(e.height)?e.height.step:c.getViewConfigDiscreteStep(n,"height");return t.x||t.y?new m.SignalRefWrapper((function(){var e=[t.x?t.x.signal:r,t.y?t.y.signal:a];return"min(".concat(e.join(", "),")")})):Math.min(r,a)}})),s.register("4AxJM",(function(e,t){n(e.exports,"scaleType",(function(){return d}));var r=s("61RXI"),a=s("e3OyN"),i=s("iooJ7"),o=s("16rNM"),u=s("2x4HI"),c=s("7J7Lf"),l=s("gQOdy"),f=s("lSb9O");a=s("e3OyN");function d(e,t,n,s){var d=function(e,t,n){var s;switch(t.type){case"nominal":case"ordinal":if(a.isColorChannel(e)||"discrete"===a.rangeType(e))return"shape"===e&&"ordinal"===t.type&&o.warn(u.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(e in a.POSITION_SCALE_CHANNEL_INDEX){if(f.contains(["rect","bar","image","rule"],n))return"band"}else if("arc"===n&&e in a.POLAR_POSITION_SCALE_CHANNEL_INDEX)return"band";return void 0!==t.band||i.isPositionFieldOrDatumDef(t)&&(null===(s=t.axis)||void 0===s?void 0:s.tickBand)?"band":"point";case"temporal":return a.isColorChannel(e)?"time":"discrete"===a.rangeType(e)?(o.warn(u.discreteChannelCannotEncode(e,"temporal")),"ordinal"):i.isFieldDef(t)&&t.timeUnit&&l.normalizeTimeUnit(t.timeUnit).utc?"utc":"time";case"quantitative":return a.isColorChannel(e)?i.isFieldDef(t)&&r.isBinning(t.bin)?"bin-ordinal":"linear":"discrete"===a.rangeType(e)?(o.warn(u.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(u.invalidFieldType(t.type))}(t,n,s),p=e.type;return a.isScaleChannel(t)?void 0!==p?c.channelSupportScaleType(t,p)?i.isFieldDef(n)&&!c.scaleTypeSupportDataType(p,n.type)?(o.warn(u.scaleTypeNotWorkWithFieldDef(p,d)),d):p:(o.warn(u.scaleTypeNotWorkWithChannel(t,p,d)),d):d:null}})),s.register("jjYLQ",(function(e,t){n(e.exports,"DensityTransformNode",(function(){return f})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("2lx0N"),l=s("lSb9O"),f=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a,o,u,s;i.default(this,n),(a=t.call(this,e)).transform=r,a.transform=l.duplicate(r);var c=null!==(o=a.transform.as)&&void 0!==o?o:[void 0,void 0];return a.transform.as=[null!==(u=c[0])&&void 0!==u?u:"value",null!==(s=c[1])&&void 0!==s?s:"density"],a}return o.default(n,[{key:"clone",value:function(){return new n(null,l.duplicate(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.density].concat(u.default(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"DensityTransform ".concat(l.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.density,n=c.__rest(e,["density"]);return Object.assign({type:"kde",field:t},n)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("gwoKC",(function(e,t){n(e.exports,"FilterInvalidNode",(function(){return h})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("e3OyN"),c=s("iooJ7"),l=s("4sOzK"),f=s("7J7Lf"),d=s("lSb9O"),p=s("9iwJo"),h=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).filter=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,Object.assign({},this.filter))}},{key:"dependentFields",value:function(){return new Set(d.keys(this.filter))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"FilterInvalid ".concat(d.hash(this.filter))}},{key:"assemble",value:function(){var e=this,t=d.keys(this.filter).reduce((function(t,n){var r=e.filter[n],a=c.vgField(r,{expr:"datum"});return null!==r&&("temporal"===r.type?t.push("(isDate(".concat(a,") || (isValid(").concat(a,") && isFinite(+").concat(a,")))")):"quantitative"===r.type&&(t.push("isValid(".concat(a,")")),t.push("isFinite(+".concat(a,")")))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}],[{key:"make",value:function(e,t){var r=t.config,a=t.mark,i=t.markDef;if("filter"!==p.getMarkPropOrConfig("invalid",i,r))return null;var o=t.reduceFieldDef((function(e,n,r){var i=u.isScaleChannel(r)&&t.getScaleComponent(r);if(i){var o=i.get("type");f.hasContinuousDomain(o)&&"count"!==n.aggregate&&!l.isPathMark(a)&&(e[n.field]=n)}return e}),{});return d.keys(o).length?new n(e,o):null}}]),n}(s("5XgHP").DataFlowNode)})),s.register("cChH7",(function(e,t){n(e.exports,"FlattenTransformNode",(function(){return c})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("lSb9O"),c=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;i.default(this,n),(a=t.call(this,e)).transform=r,a.transform=u.duplicate(r);var o=a.transform,s=o.flatten,c=o.as,l=void 0===c?[]:c;return a.transform.as=s.map((function(e,t){var n;return null!==(n=l[t])&&void 0!==n?n:e})),a}return o.default(n,[{key:"clone",value:function(){return new n(this.parent,u.duplicate(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.flatten)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FlattenTransform ".concat(u.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"flatten",fields:e.flatten,as:e.as}}}]),n}(s("5XgHP").DataFlowNode)})),s.register("5zs9z",(function(e,t){n(e.exports,"FoldTransformNode",(function(){return c})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("lSb9O"),c=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a,o,s,c;i.default(this,n),(a=t.call(this,e)).transform=r,a.transform=u.duplicate(r);var l=null!==(o=a.transform.as)&&void 0!==o?o:[void 0,void 0];return a.transform.as=[null!==(s=l[0])&&void 0!==s?s:"key",null!==(c=l[1])&&void 0!==c?c:"value"],a}return o.default(n,[{key:"clone",value:function(){return new n(null,u.duplicate(this.transform))}},{key:"dependentFields",value:function(){return new Set(this.transform.fold)}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"FoldTransform ".concat(u.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform;return{type:"fold",fields:e.fold,as:e.as}}}]),n}(s("5XgHP").DataFlowNode)})),s.register("5I9U7",(function(e,t){n(e.exports,"GeoJSONNode",(function(){return h})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW");s("iSlfb");var c=s("fCSiB"),l=s("e3OyN"),f=s("iooJ7"),d=s("4jgmF"),p=s("lSb9O"),h=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,o){var u;return i.default(this,n),(u=t.call(this,e)).fields=r,u.geojson=a,u.signal=o,u}return o.default(n,[{key:"clone",value:function(){return new n(null,p.duplicate(this.fields),this.geojson,this.signal)}},{key:"dependentFields",value:function(){var e,t=(null!==(e=this.fields)&&void 0!==e?e:[]).filter(c.default);return new Set(u.default(this.geojson?[this.geojson]:[]).concat(u.default(t)))}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"GeoJSON ".concat(this.geojson," ").concat(this.signal," ").concat(p.hash(this.fields))}},{key:"assemble",value:function(){return Object.assign(Object.assign(Object.assign({type:"geojson"},this.fields?{fields:this.fields}:{}),this.geojson?{geojson:this.geojson}:{}),{signal:this.signal})}}],[{key:"parseAll",value:function(e,t){if(t.component.projection&&!t.component.projection.isFit)return e;var r=0,a=!0,i=!1,o=void 0;try{for(var u,s=[[l.LONGITUDE,l.LATITUDE],[l.LONGITUDE2,l.LATITUDE2]][Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value.map((function(e){var n=f.getFieldOrDatumDef(t.encoding[e]);return f.isFieldDef(n)?n.field:f.isDatumDef(n)?{expr:"".concat(n.datum)}:f.isValueDef(n)?{expr:"".concat(n.value)}:void 0}));(c[0]||c[1])&&(e=new n(e,c,null,t.getName("geojson_".concat(r++))))}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}if(t.channelHasField(l.SHAPE)){var p=t.typedFieldDef(l.SHAPE);p.type===d.GEOJSON&&(e=new n(e,null,p.field,t.getName("geojson_".concat(r++))))}return e}}]),n}(s("5XgHP").DataFlowNode)})),s.register("4xXhT",(function(e,t){n(e.exports,"GeoPointNode",(function(){return d})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj");s("iSlfb");var u=s("fCSiB"),c=s("e3OyN"),l=s("iooJ7"),f=s("lSb9O"),d=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,o){var u;return i.default(this,n),(u=t.call(this,e)).projection=r,u.fields=a,u.as=o,u}return o.default(n,[{key:"clone",value:function(){return new n(null,this.projection,f.duplicate(this.fields),f.duplicate(this.as))}},{key:"dependentFields",value:function(){return new Set(this.fields.filter(u.default))}},{key:"producedFields",value:function(){return new Set(this.as)}},{key:"hash",value:function(){return"Geopoint ".concat(this.projection," ").concat(f.hash(this.fields)," ").concat(f.hash(this.as))}},{key:"assemble",value:function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}],[{key:"parseAll",value:function(e,t){if(!t.projectionName())return e;var r=!0,a=!1,i=void 0;try{for(var o,u=[[c.LONGITUDE,c.LATITUDE],[c.LONGITUDE2,c.LATITUDE2]][Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value,f=s.map((function(e){var n=l.getFieldOrDatumDef(t.encoding[e]);return l.isFieldDef(n)?n.field:l.isDatumDef(n)?{expr:"".concat(n.datum)}:l.isValueDef(n)?{expr:"".concat(n.value)}:void 0})),d=s[0]===c.LONGITUDE2?"2":"";(f[0]||f[1])&&(e=new n(e,t.projectionName(),f,[t.getName("x"+d),t.getName("y"+d)]))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return e}}]),n}(s("5XgHP").DataFlowNode)})),s.register("aWQzg",(function(e,t){n(e.exports,"ImputeNode",(function(){return p})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("iooJ7"),l=s("jQ4iQ"),f=s("4gSyH"),d=s("lSb9O"),p=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).transform=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,d.duplicate(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.impute,this.transform.key].concat(u.default(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set([this.transform.impute])}},{key:"processSequence",value:function(e){var t=e.start,n=void 0===t?0:t,r=e.stop,a=e.step,i=[n,r].concat(u.default(a?[a]:[])).join(",");return{signal:"sequence(".concat(i,")")}}},{key:"hash",value:function(){return"Impute ".concat(d.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.impute,n=e.key,r=e.keyvals,a=e.method,i=e.groupby,o=e.value,u=e.frame,s=void 0===u?[null,null]:u,c=Object.assign(Object.assign(Object.assign(Object.assign({type:"impute",field:t,key:n},r?{keyvals:f.isImputeSequence(r)?this.processSequence(r):r}:{}),{method:"value"}),i?{groupby:i}:{}),{value:a&&"value"!==a?null:o});return a&&"value"!==a?[c,Object.assign({type:"window",as:["imputed_".concat(t,"_value")],ops:[a],fields:[t],frame:s,ignorePeers:!1},i?{groupby:i}:{}),{type:"formula",expr:"datum.".concat(t," === null ? datum.imputed_").concat(t,"_value : datum.").concat(t),as:t}]:[c]}}],[{key:"makeFromTransform",value:function(e,t){return new n(e,t)}},{key:"makeFromEncoding",value:function(e,t){var r=t.encoding,a=r.x,i=r.y;if(c.isFieldDef(a)&&c.isFieldDef(i)){var o=a.impute?a:i.impute?i:void 0;if(void 0===o)return;var u=a.impute?i:i.impute?a:void 0,s=o.impute,f=s.method,d=s.value,p=s.frame,h=s.keyvals,v=l.pathGroupingFields(t.mark,r);return new n(e,Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({impute:o.field,key:u.field},f?{method:f}:{}),void 0!==d?{value:d}:{}),p?{frame:p}:{}),void 0!==h?{keyvals:h}:{}),v.length?{groupby:v}:{}))}return null}}]),n}(s("5XgHP").DataFlowNode)})),s.register("gJd0d",(function(e,t){n(e.exports,"makeJoinAggregateFromFacet",(function(){return u}));var r=s("iooJ7"),a=s("2V3EF"),i=s("hSDND"),o=s("e0CR6");function u(e,t){var n=t.row,u=t.column;if(n&&u){var s=null,c=!0,l=!1,f=void 0;try{for(var d,p=[n,u][Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;if(a.isSortField(h.sort)){var v=h.sort,g=v.field,m=v.op,y=void 0===m?a.DEFAULT_SORT_OP:m;e=s=new o.JoinAggregateTransformNode(e,{joinaggregate:[{op:y,field:g,as:i.facetSortFieldName(h,h.sort,{forAs:!0})}],groupby:[r.vgField(h)]})}}}catch(e){l=!0,f=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}return s}return null}})),s.register("hSDND",(function(e,t){n(e.exports,"facetSortFieldName",(function(){return M})),n(e.exports,"FacetModel",(function(){return B})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("jZS3C"),u=s("2tuUj"),c=s("kRKWT"),l=s("eYQ8O");s("iSlfb");var f=s("4ujSI"),d=s("61RXI"),p=s("e3OyN"),h=s("iooJ7"),v=s("jQ4iQ"),g=s("16rNM"),m=s("2x4HI"),y=s("7J7Lf"),x=s("2V3EF"),b=s("pZnnI"),k=s("lSb9O"),w=s("7T458"),A=s("lqDEC"),E=s("03p0t"),C=s("fFVzC"),S=s("2zW61"),N=s("fDBRf"),T=s("doORn"),D=s("7HuhJ"),F=s("j6YQk"),O=s("lWXej"),_=s("jZr2L"),I=s("ivIoL"),R=s("d4pV2");function M(e,t,n){return h.vgField(t,Object.assign({suffix:"by_".concat(h.vgField(e))},null!=n?n:{}))}var B=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,u){var s;return i.default(this,n),(s=t.call(this,e,"facet",r,a,u,e.resolve)).child=A.buildModel(e.spec,o.default(s),s.getName("child"),void 0,u),s.children=[s.child],s.facet=s.initFacet(e.facet,u),s}return u.default(n,[{key:"initFacet",value:function(e,t){return b.isFacetMapping(e)?v.reduce(e,(function(e,n,r){return k.contains([p.ROW,p.COLUMN],r)?void 0===n.field?(g.warn(m.emptyFieldDef(n,r)),e):(e[r]=h.initChannelDef(n,r,t),e):(g.warn(m.incompatibleChannel(r,"facet")),e)}),{}):{facet:h.initChannelDef(e,"facet",t)}}},{key:"channelHasField",value:function(e){return!!this.facet[e]}},{key:"fieldDef",value:function(e){return this.facet[e]}},{key:"parseData",value:function(){this.component.data=S.parseData(this),this.child.parseData()}},{key:"parseLayoutSize",value:function(){O.parseChildrenLayoutSize(this)}},{key:"parseSelections",value:function(){this.child.parseSelections(),this.component.selection=this.child.component.selection}},{key:"parseMarkGroup",value:function(){this.child.parseMarkGroup()}},{key:"parseAxesAndHeaders",value:function(){this.child.parseAxesAndHeaders(),F.parseFacetHeaders(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.child.assembleSelectionTopLevelSignals(e)}},{key:"assembleSignals",value:function(){return this.child.assembleSignals(),[]}},{key:"assembleSelectionData",value:function(e){return this.child.assembleSelectionData(e)}},{key:"getHeaderLayoutMixins",value:function(){var e,t,n,r={},a=!0,i=!1,o=void 0,u=!0,s=!1,c=void 0;try{for(var l,f=p.FACET_CHANNELS[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;try{for(var h,v=D.HEADER_TYPES[Symbol.iterator]();!(a=(h=v.next()).done);a=!0){var g=h.value,m=this.component.layoutHeaders[d],y=m[g],x=m.facetFieldDef;if(x){var b=T.getHeaderProperty("titleOrient",x,this.config,d);if(k.contains(["right","bottom"],b)){var w=T.getHeaderChannel(d,b);r.titleAnchor=null!==(e=r.titleAnchor)&&void 0!==e?e:{},r.titleAnchor[w]="end"}}if(null==y?void 0:y[0]){var A="row"===d?"height":"width",E="header"===g?"headerBand":"footerBand";"facet"===d||this.child.component.layoutSize.get(A)||(r[E]=null!==(t=r[E])&&void 0!==t?t:{},r[E][d]=.5),m.title&&(r.offset=null!==(n=r.offset)&&void 0!==n?n:{},r.offset["row"===d?"rowTitle":"columnTitle"]=10)}}}catch(e){i=!0,o=e}finally{try{a||null==v.return||v.return()}finally{if(i)throw o}}}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}return r}},{key:"assembleDefaultLayout",value:function(){var e=this.facet,t=e.column,n=e.row,r=t?this.columnDistinctSignal():n?1:void 0,a="all";return(n||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(a="none"),Object.assign(Object.assign(Object.assign({},this.getHeaderLayoutMixins()),r?{columns:r}:{}),{bounds:"full",align:a})}},{key:"assembleLayoutSignals",value:function(){return this.child.assembleLayoutSignals()}},{key:"columnDistinctSignal",value:function(){if(!(this.parent&&this.parent instanceof n)){var e=this.getName("column_domain");return{signal:"length(data('".concat(e,"'))")}}}},{key:"assembleGroup",value:function(e){return this.parent&&this.parent instanceof n?Object.assign(Object.assign({},this.channelHasField("column")?{encode:{update:{columns:{field:h.vgField(this.facet.column,{prefix:"distinct"})}}}}:{}),c.default(l.default(n.prototype),"assembleGroup",this).call(this,e)):c.default(l.default(n.prototype),"assembleGroup",this).call(this,e)}},{key:"getCardinalityAggregateForChild",value:function(){var e=[],t=[],r=[],a=!0,i=!1,o=void 0;if(this.child instanceof n){if(this.child.channelHasField("column")){var u=h.vgField(this.child.facet.column);e.push(u),t.push("distinct"),r.push("distinct_".concat(u))}}else try{for(var s,c=p.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,f=this.child.component.scales[l];if(f&&!f.merged){var d=f.get("type"),v=f.get("range");if(y.hasDiscreteDomain(d)&&w.isVgRangeStep(v)){var m=I.assembleDomain(this.child,l),x=I.getFieldFromDomain(m);x?(e.push(x),t.push("distinct"),r.push("distinct_".concat(x))):g.warn("Unknown field for ".concat(l,". Cannot calculate view size."))}}}}catch(e){i=!0,o=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw o}}return{fields:e,ops:t,as:r}}},{key:"assembleFacet",value:function(){var e=this.component.data.facetRoot,t=e.name,n=e.data,r=this.facet,a=r.row,i=r.column,o=this.getCardinalityAggregateForChild(),u=o.fields,s=o.ops,c=o.as,l=[],v=!0,g=!1,m=void 0;try{for(var y,b=p.FACET_CHANNELS[Symbol.iterator]();!(v=(y=b.next()).done);v=!0){var k=y.value,w=this.facet[k];if(w){l.push(h.vgField(w));var A=w.bin,E=w.sort;if(d.isBinning(A)&&l.push(h.vgField(w,{binSuffix:"end"})),x.isSortField(E)){var S=E.field,N=E.op,T=void 0===N?x.DEFAULT_SORT_OP:N,D=M(w,E);a&&i?(u.push(D),s.push("max"),c.push(D)):(u.push(S),s.push(T),c.push(D))}else if(f.default(E)){var F=C.sortArrayIndexField(w,k);u.push(F),s.push("max"),c.push(F)}}}}catch(e){g=!0,m=e}finally{try{v||null==b.return||b.return()}finally{if(g)throw m}}var O=!!a&&!!i;return Object.assign({name:t,data:n,groupby:l},O||u.length>0?{aggregate:Object.assign(Object.assign({},O?{cross:O}:{}),u.length?{fields:u,ops:s,as:c}:{})}:{})}},{key:"facetSortFields",value:function(e){var t=this.facet[e];return t?x.isSortField(t.sort)?[M(t,t.sort,{expr:"datum"})]:f.default(t.sort)?[C.sortArrayIndexField(t,e,{expr:"datum"})]:[h.vgField(t,{expr:"datum"})]:[]}},{key:"facetSortOrder",value:function(e){var t=this.facet[e];if(t){var n=t.sort;return[(x.isSortField(n)?n.order:!f.default(n)&&n)||"ascending"]}return[]}},{key:"assembleLabelTitle",value:function(){var e=this.facet,t=this.config;if(e.facet)return N.assembleLabelTitle(e.facet,"facet",t);var n={row:["top","bottom"],column:["left","right"]},r=!0,a=!1,i=void 0;try{for(var o,u=D.HEADER_CHANNELS[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(e[s]){var c=T.getHeaderProperty("labelOrient",e[s],t,s);if(k.contains(n[s],c))return N.assembleLabelTitle(e[s],s,t)}}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}},{key:"assembleMarks",value:function(){var e=this,t=this.child,n=this.component.data.facetRoot,r=E.assembleFacetData(n),a=t.assembleGroupEncodeEntry(!1),i=this.assembleLabelTitle()||t.assembleTitle(),o=t.assembleGroupStyle();return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:this.getName("cell"),type:"group"},i?{title:i}:{}),o?{style:o}:{}),{from:{facet:this.assembleFacet()},sort:{field:p.FACET_CHANNELS.map((function(t){return e.facetSortFields(t)})).flat(),order:p.FACET_CHANNELS.map((function(t){return e.facetSortOrder(t)})).flat()}}),r.length>0?{data:r}:{}),a?{encode:{update:a}}:{}),t.assembleGroup(R.assembleFacetSignals(this,[])))]}},{key:"getMapping",value:function(){return this.facet}}]),n}(_.ModelWithField)})),s.register("03p0t",(function(e,t){n(e.exports,"assembleFacetData",(function(){return B})),n(e.exports,"assembleRootData",(function(){return P})),s("1i51P");var r=s("9M1dW"),a=s("6vecG"),i=s("1Z7Bs"),o=s("dQfAT"),u=s("4ewT3"),c=s("fFVzC"),l=s("5XgHP"),f=s("jjYLQ"),d=s("fPIRu"),p=s("dD9t5"),h=s("gwoKC"),v=s("cChH7"),g=s("5zs9z"),m=s("lmM4C"),y=s("5I9U7"),x=s("4xXhT"),b=s("XZnM9"),k=s("4gRNk"),w=s("aWQzg"),A=s("e0CR6"),E=s("bXLC3"),C=s("7fj9G"),S=s("hke9K"),N=s("iVWNn"),T=s("ewe31"),D=s("ajBw6"),F=s("5HdXV"),O=s("cYGz2"),_=s("gR1OF"),I=s("bAeeP"),R=s("hijEA");function M(e){var t=0;return function n(a,s){var M,B,P,L;if(a instanceof O.SourceNode&&(a.isGenerator||i.isUrlData(a.data)||(e.push(s),s={name:null,source:s.name,transform:[]})),a instanceof m.ParseNode&&(a.parent instanceof O.SourceNode&&!s.source?(s.format=Object.assign(Object.assign({},null!==(B=s.format)&&void 0!==B?B:{}),{parse:a.assembleFormatParse()}),(L=s.transform).push.apply(L,r.default(a.assembleTransforms(!0)))):(P=s.transform).push.apply(P,r.default(a.assembleTransforms()))),a instanceof d.FacetNode){s.name||(s.name="data_".concat(t++)),!s.source||s.transform.length>0?(e.push(s),a.data=s.name):a.data=s.source;var j=!0,z=!1,U=void 0;try{for(var V,W=a.assemble()[Symbol.iterator]();!(j=(V=W.next()).done);j=!0){var G=V.value;e.push(G)}}catch(e){z=!0,U=e}finally{try{j||null==W.return||W.return()}finally{if(z)throw U}}}else{if((a instanceof b.GraticuleNode||a instanceof F.SequenceNode||a instanceof h.FilterInvalidNode||a instanceof p.FilterNode||a instanceof c.CalculateNode||a instanceof x.GeoPointNode||a instanceof y.GeoJSONNode||a instanceof o.AggregateNode||a instanceof C.LookupNode||a instanceof R.WindowTransformNode||a instanceof A.JoinAggregateTransformNode||a instanceof g.FoldTransformNode||a instanceof v.FlattenTransformNode||a instanceof f.DensityTransformNode||a instanceof E.LoessTransformNode||a instanceof S.QuantileTransformNode||a instanceof N.RegressionTransformNode||a instanceof k.IdentifierNode||a instanceof D.SampleTransformNode||a instanceof T.PivotTransformNode)&&s.transform.push(a.assemble()),(a instanceof u.BinNode||a instanceof I.TimeUnitNode||a instanceof w.ImputeNode||a instanceof _.StackNode)&&(M=s.transform).push.apply(M,r.default(a.assemble())),a instanceof l.OutputNode)if(s.source&&0===s.transform.length)a.setSource(s.source);else if(a.parent instanceof l.OutputNode)a.setSource(s.name);else{if(s.name||(s.name="data_".concat(t++)),a.setSource(s.name),1===a.numChildren())e.push(s),s={name:null,source:s.name,transform:[]}}switch(a.numChildren()){case 0:a instanceof l.OutputNode&&(!s.source||s.transform.length>0)&&e.push(s);break;case 1:n(a.children[0],s);break;default:s.name||(s.name="data_".concat(t++));var H=s.name;!s.source||s.transform.length>0?e.push(s):H=s.source;var q=!0,J=!1,K=void 0;try{for(var X,Y=a.children[Symbol.iterator]();!(q=(X=Y.next()).done);q=!0){n(X.value,{name:null,source:H,transform:[]})}}catch(e){J=!0,K=e}finally{try{q||null==Y.return||Y.return()}finally{if(J)throw K}}}}}}function B(e){var t=[],n=M(t),r=!0,a=!1,i=void 0;try{for(var o,u=e.children[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){n(o.value,{source:e.name,name:null,transform:[]})}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return t}function P(e,t){var n,r,i=[],o=M(i),u=0,s=!0,c=!1,l=void 0;try{for(var f,d=e.sources[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;p.hasName()||(p.dataName="source_".concat(u++));var h=p.assemble();o(p,h)}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}var v=!0,g=!1,m=void 0;try{for(var y,x=i[Symbol.iterator]();!(v=(y=x.next()).done);v=!0){var b=y.value;0===b.transform.length&&delete b.transform}}catch(e){g=!0,m=e}finally{try{v||null==x.return||x.return()}finally{if(g)throw m}}var k=0,w=!0,A=!1,E=void 0;try{for(var C,S=i.entries()[Symbol.iterator]();!(w=(C=S.next()).done);w=!0){var N=a.default(C.value,2),T=N[0],D=N[1];0!==(null!==(n=D.transform)&&void 0!==n?n:[]).length||D.source||i.splice(k++,0,i.splice(T,1)[0])}}catch(e){A=!0,E=e}finally{try{w||null==S.return||S.return()}finally{if(A)throw E}}var F=!0,O=!1,_=void 0;try{for(var I,R=i[Symbol.iterator]();!(F=(I=R.next()).done);F=!0){var B=I.value,P=!0,L=!1,j=void 0;try{for(var z,U=(null!==(r=B.transform)&&void 0!==r?r:[])[Symbol.iterator]();!(P=(z=U.next()).done);P=!0){var V=z.value;"lookup"===V.type&&(V.from=e.outputNodes[V.from].getSource())}}catch(e){L=!0,j=e}finally{try{P||null==U.return||U.return()}finally{if(L)throw j}}}}catch(e){O=!0,_=e}finally{try{F||null==R.return||R.return()}finally{if(O)throw _}}var W=!0,G=!1,H=void 0;try{for(var q,J=i[Symbol.iterator]();!(W=(q=J.next()).done);W=!0){var K=q.value;K.name in t&&(K.values=t[K.name])}}catch(e){G=!0,H=e}finally{try{W||null==J.return||J.return()}finally{if(G)throw H}}return i}})),s.register("bXLC3",(function(e,t){n(e.exports,"LoessTransformNode",(function(){return f})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("2lx0N"),l=s("lSb9O"),f=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a,o,u,s;i.default(this,n),(a=t.call(this,e)).transform=r,a.transform=l.duplicate(r);var c=null!==(o=a.transform.as)&&void 0!==o?o:[void 0,void 0];return a.transform.as=[null!==(u=c[0])&&void 0!==u?u:r.on,null!==(s=c[1])&&void 0!==s?s:r.loess],a}return o.default(n,[{key:"clone",value:function(){return new n(null,l.duplicate(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.loess,this.transform.on].concat(u.default(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"LoessTransform ".concat(l.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.loess,n=e.on,r=c.__rest(e,["loess","on"]);return Object.assign({type:"loess",x:n,y:t},r)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("7fj9G",(function(e,t){n(e.exports,"LookupNode",(function(){return m})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj");s("iSlfb");var u=s("1Ihp0"),c=s("fCSiB"),l=s("16rNM"),f=s("2x4HI"),d=s("4gSyH"),p=s("lSb9O"),h=s("5XgHP"),v=s("2zW61"),g=s("cYGz2"),m=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a){var o;return i.default(this,n),(o=t.call(this,e)).transform=r,o.secondary=a,o}return o.default(n,[{key:"clone",value:function(){return new n(null,p.duplicate(this.transform),this.secondary)}},{key:"dependentFields",value:function(){return new Set([this.transform.lookup])}},{key:"producedFields",value:function(){return new Set(this.transform.as?u.default(this.transform.as):this.transform.from.fields)}},{key:"hash",value:function(){return"Lookup ".concat(p.hash({transform:this.transform,secondary:this.secondary}))}},{key:"assemble",value:function(){var e;if(this.transform.from.fields)e=Object.assign({values:this.transform.from.fields},this.transform.as?{as:u.default(this.transform.as)}:{});else{var t=this.transform.as;c.default(t)||(l.warn(f.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return Object.assign(Object.assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e),this.transform.default?{default:this.transform.default}:{})}}],[{key:"make",value:function(e,t,r,a){var i=t.component.data.sources,o=r.from,u=null;if(d.isLookupData(o)){var s=v.findSource(o.data,i);s||(s=new g.SourceNode(o.data),i.push(s));var c=t.getName("lookup_".concat(a));u=new h.OutputNode(s,c,"lookup",t.component.data.outputNodeRefCounts),t.component.data.outputNodes[c]=u}else if(d.isLookupSelection(o)){var l=o.selection;if(r=Object.assign({as:l},r),!(u=t.getSelectionComponent(p.varName(l),l).materialized))throw new Error(f.noSameUnitLookup(l))}return new n(e,r,u.getSource())}}]),n}(h.DataFlowNode)})),s.register("hke9K",(function(e,t){n(e.exports,"QuantileTransformNode",(function(){return f})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("2lx0N"),l=s("lSb9O"),f=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a,o,u,s;i.default(this,n),(a=t.call(this,e)).transform=r,a.transform=l.duplicate(r);var c=null!==(o=a.transform.as)&&void 0!==o?o:[void 0,void 0];return a.transform.as=[null!==(u=c[0])&&void 0!==u?u:"prob",null!==(s=c[1])&&void 0!==s?s:"value"],a}return o.default(n,[{key:"clone",value:function(){return new n(null,l.duplicate(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.quantile].concat(u.default(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"QuantileTransform ".concat(l.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.quantile,n=c.__rest(e,["quantile"]);return Object.assign({type:"quantile",field:t},n)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("iVWNn",(function(e,t){n(e.exports,"RegressionTransformNode",(function(){return f})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("2lx0N"),l=s("lSb9O"),f=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a,o,u,s;i.default(this,n),(a=t.call(this,e)).transform=r,a.transform=l.duplicate(r);var c=null!==(o=a.transform.as)&&void 0!==o?o:[void 0,void 0];return a.transform.as=[null!==(u=c[0])&&void 0!==u?u:r.on,null!==(s=c[1])&&void 0!==s?s:r.regression],a}return o.default(n,[{key:"clone",value:function(){return new n(null,l.duplicate(this.transform))}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.regression,this.transform.on].concat(u.default(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"producedFields",value:function(){return new Set(this.transform.as)}},{key:"hash",value:function(){return"RegressionTransform ".concat(l.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.regression,n=e.on,r=c.__rest(e,["regression","on"]);return Object.assign({type:"regression",x:n,y:t},r)}}]),n}(s("5XgHP").DataFlowNode)})),s.register("ewe31",(function(e,t){n(e.exports,"PivotTransformNode",(function(){return l})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("lSb9O"),l=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).transform=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,c.duplicate(this.transform))}},{key:"addDimensions",value:function(e){var t;this.transform.groupby=c.unique((null!==(t=this.transform.groupby)&&void 0!==t?t:[]).concat(e),(function(e){return e}))}},{key:"producedFields",value:function(){}},{key:"dependentFields",value:function(){var e;return new Set([this.transform.pivot,this.transform.value].concat(u.default(null!==(e=this.transform.groupby)&&void 0!==e?e:[])))}},{key:"hash",value:function(){return"PivotTransform ".concat(c.hash(this.transform))}},{key:"assemble",value:function(){var e=this.transform,t=e.pivot,n=e.value,r=e.groupby,a=e.limit,i=e.op;return Object.assign(Object.assign(Object.assign({type:"pivot",field:t,value:n},void 0!==a?{limit:a}:{}),void 0!==i?{op:i}:{}),void 0!==r?{groupby:r}:{})}}]),n}(s("5XgHP").DataFlowNode)})),s.register("ajBw6",(function(e,t){n(e.exports,"SampleTransformNode",(function(){return c})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("lSb9O"),c=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r){var a;return i.default(this,n),(a=t.call(this,e)).transform=r,a}return o.default(n,[{key:"clone",value:function(){return new n(null,u.duplicate(this.transform))}},{key:"dependentFields",value:function(){return new Set}},{key:"producedFields",value:function(){return new Set}},{key:"hash",value:function(){return"SampleTransform ".concat(u.hash(this.transform))}},{key:"assemble",value:function(){return{type:"sample",size:this.transform.sample}}}]),n}(s("5XgHP").DataFlowNode)})),s.register("j6YQk",(function(e,t){n(e.exports,"parseFacetHeaders",(function(){return p})),s("1i51P");var r=s("4Ui3v");s("iSlfb");var a=s("4ujSI"),i=s("e3OyN"),o=s("iooJ7"),u=s("lSb9O"),c=s("7T458"),l=s("56lbz"),f=s("598xZ"),d=s("doORn");function p(e){var t=!0,n=!1,r=void 0;try{for(var a,o=i.FACET_CHANNELS[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){h(e,a.value)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}g(e,"x"),g(e,"y")}function h(e,t){var n,i=e.facet,s=e.config,c=e.child,l=e.component;if(e.channelHasField(t)){var f=i[t],p=d.getHeaderProperty("title",null,s,t),h=o.title(f,s,{allowDisabling:!0,includeDefault:void 0===p||!!p});c.component.layoutHeaders[t].title&&(h=a.default(h)?h.join(", "):h,h+=" / "+c.component.layoutHeaders[t].title,c.component.layoutHeaders[t].title=null);var g=d.getHeaderProperty("labelOrient",f,s,t),m=null!==(n=f.header)&&void 0!==n?n:{},y=u.getFirstDefined(m.labels,s.header.labels,!0),x=u.contains(["bottom","right"],g)?"footer":"header";l.layoutHeaders[t]=r.default({title:h,facetFieldDef:f},x,"facet"===t?[]:[v(e,t,y)])}}function v(e,t,n){var r="row"===t?"height":"width";return{labels:n,sizeSignal:e.child.component.layoutSize.get(r)?e.child.getSizeSignalRef(r):void 0,axes:[]}}function g(e,t){var n,r,a=e.child;if(a.component.axes[t]){var i=e.component,o=i.layoutHeaders,u=i.resolve;if(u.axis[t]=f.parseGuideResolve(u,t),"shared"===u.axis[t]){var s="x"===t?"column":"row",d=o[s],p=!0,h=!1,g=void 0;try{for(var m,y=a.component.axes[t][Symbol.iterator]();!(p=(m=y.next()).done);p=!0){var x=m.value,b="top"===(r=x.get("orient"))||"left"===r||c.isSignalRef(r)?"header":"footer";d[b]=null!==(n=d[b])&&void 0!==n?n:[v(e,s,!1)];var k=l.assembleAxis(x,"main",e.config,{header:!0});k&&d[b][0].axes.push(k),x.mainExtracted=!0}}catch(e){h=!0,g=e}finally{try{p||null==y.return||y.return()}finally{if(h)throw g}}}}}})),s.register("lWXej",(function(e,t){n(e.exports,"parseLayerLayoutSize",(function(){return f})),n(e.exports,"parseChildrenLayoutSize",(function(){return p})),n(e.exports,"parseConcatLayoutSize",(function(){return d})),n(e.exports,"parseUnitLayoutSize",(function(){return v}));var r=s("e3OyN"),a=s("fldOo"),i=s("7J7Lf"),o=s("eg4js"),u=s("7T458"),c=s("CFwcG"),l=s("1ByWd");function f(e){p(e),h(e,"width"),h(e,"height")}function d(e){p(e);var t=1===e.layout.columns?"width":"childWidth",n=void 0===e.layout.columns?"height":"childHeight";h(e,t),h(e,n)}function p(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e.children[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.parseLayoutSize()}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}function h(e,t){var n,a=l.getSizeTypeFromLayoutSizeType(t),i=r.getPositionScaleChannel(a),o=e.component.resolve,u=e.component.layoutSize,s=!0,f=!1,d=void 0;try{for(var p,h=e.children[Symbol.iterator]();!(s=(p=h.next()).done);s=!0){var v=p.value.component.layoutSize.getWithExplicit(a),g=o.scale[i];if("independent"===g&&"step"===v.value){n=void 0;break}if(n){if("independent"===g&&n.value!==v.value){n=void 0;break}n=c.mergeValuesWithExplicit(n,v,a,"")}else n=v}}catch(e){f=!0,d=e}finally{try{s||null==h.return||h.return()}finally{if(f)throw d}}if(n){var m=!0,y=!1,x=void 0;try{for(var b,k=e.children[Symbol.iterator]();!(m=(b=k.next()).done);m=!0){var w=b.value;e.renameSignal(w.getName(a),e.getName(t)),w.component.layoutSize.set(a,"merged",!1)}}catch(e){y=!0,x=e}finally{try{m||null==k.return||k.return()}finally{if(y)throw x}}u.setWithExplicit(t,n)}else u.setWithExplicit(t,{explicit:!1,value:void 0})}function v(e){var t=e.size,n=e.component,a=!0,i=!1,u=void 0;try{for(var s,c=r.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value,f=r.getSizeChannel(l);if(t[f]){var d=t[f];n.layoutSize.set(f,o.isStep(d)?"step":d,!0)}else{var p=g(e,f);n.layoutSize.set(f,p,!1)}}}catch(e){i=!0,u=e}finally{try{a||null==c.return||c.return()}finally{if(i)throw u}}}function g(e,t){var n="width"===t?"x":"y",r=e.config,s=e.getScaleComponent(n);if(s){var c=s.get("type"),l=s.get("range");if(i.hasDiscreteDomain(c)){var f=a.getViewConfigDiscreteSize(r.view,t);return u.isVgRangeStep(l)||o.isStep(f)?"step":f}return a.getViewConfigContinuousSize(r.view,t)}if(e.hasProjection||"arc"===e.mark)return a.getViewConfigContinuousSize(r.view,t);var d=a.getViewConfigDiscreteSize(r.view,t);return o.isStep(d)?d.step:d}})),s.register("JHpzO",(function(e,t){n(e.exports,"LayerModel",(function(){return E})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("jZS3C"),u=s("2tuUj"),c=s("kRKWT"),l=s("eYQ8O");s("16rNM");var f=s("2x4HI");s("gLFCo");var d=s("1sD9J"),p=s("aIH68"),h=s("lSb9O"),v=s("56lbz"),g=s("lKuQD"),m=s("2zW61"),y=s("iUaCf"),x=s("lWXej"),b=s("lgWLp"),k=s("jZr2L"),w=s("d4pV2"),A=s("lAgVt"),E=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a,u,s){var c;i.default(this,n),c=t.call(this,e,"layer",r,a,s,e.resolve,e.view);var l=Object.assign(Object.assign(Object.assign({},u),e.width?{width:e.width}:{}),e.height?{height:e.height}:{});return c.children=e.layer.map((function(e,t){if(d.isLayerSpec(e))return new n(e,o.default(c),c.getName("layer_"+t),l,s);if(p.isUnitSpec(e))return new A.UnitModel(e,o.default(c),c.getName("layer_"+t),l,s);throw new Error(f.invalidSpec(e))})),c}return u.default(n,[{key:"parseData",value:function(){this.component.data=m.parseData(this);var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.parseData()}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"parseLayoutSize",value:function(){x.parseLayerLayoutSize(this)}},{key:"parseSelections",value:function(){this.component.selection={};var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var i=r.value;i.parseSelections();var o=!0,u=!1,s=void 0;try{for(var c,l=h.keys(i.component.selection)[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;this.component.selection[f]=i.component.selection[f]}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"parseMarkGroup",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.children[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){r.value.parseMarkGroup()}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}},{key:"parseAxesAndHeaders",value:function(){g.parseLayerAxes(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionTopLevelSignals(e)}),e)}},{key:"assembleSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleSignals())}),v.assembleAxisSignals(this))}},{key:"assembleLayoutSignals",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLayoutSignals())}),y.assembleLayoutSignals(this))}},{key:"assembleSelectionData",value:function(e){return this.children.reduce((function(e,t){return t.assembleSelectionData(e)}),e)}},{key:"assembleTitle",value:function(){var e=c.default(l.default(n.prototype),"assembleTitle",this).call(this);if(e)return e;var t=!0,r=!1,a=void 0;try{for(var i,o=this.children[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){if(e=i.value.assembleTitle())return e}}catch(e){r=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw a}}}},{key:"assembleLayout",value:function(){return null}},{key:"assembleMarks",value:function(){return w.assembleLayerSelectionMarks(this,this.children.flatMap((function(e){return e.assembleMarks()})))}},{key:"assembleLegends",value:function(){return this.children.reduce((function(e,t){return e.concat(t.assembleLegends())}),b.assembleLegends(this))}}]),n}(k.Model)})),s.register("lKuQD",(function(e,t){n(e.exports,"parseUnitAxes",(function(){return m})),n(e.exports,"parseLayerAxes",(function(){return x}));var r=s("aLoDX"),a=s("e3OyN"),i=s("iooJ7"),o=s("lSb9O"),u=s("7T458"),c=s("9iwJo"),l=s("cN8QU"),f=s("598xZ"),d=s("CFwcG"),p=s("bawWs"),h=s("k1xRj"),v=s("ktTpu"),g=s("1m8vd");function m(e){return a.POSITION_SCALE_CHANNELS.reduce((function(t,n){return e.component.scales[n]&&(t[n]=[E(n,e)]),t}),{})}var y={bottom:"top",top:"bottom",left:"right",right:"left"};function x(e){var t,n=e.component,r=n.axes,i=n.resolve,s={top:0,bottom:0,right:0,left:0},c=!0,l=!1,d=void 0;try{for(var p,h=e.children[Symbol.iterator]();!(c=(p=h.next()).done);c=!0){var v=p.value;v.parseAxesAndHeaders();var g=!0,m=!1,x=void 0;try{for(var k,w=o.keys(v.component.axes)[Symbol.iterator]();!(g=(k=w.next()).done);g=!0){var A=k.value;i.axis[A]=f.parseGuideResolve(e.component.resolve,A),"shared"===i.axis[A]&&(r[A]=b(r[A],v.component.axes[A]),r[A]||(i.axis[A]="independent",delete r[A]))}}catch(e){m=!0,x=e}finally{try{g||null==w.return||w.return()}finally{if(m)throw x}}}}catch(e){l=!0,d=e}finally{try{c||null==h.return||h.return()}finally{if(l)throw d}}var E=!0,C=!1,S=void 0;try{for(var N,T=a.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(E=(N=T.next()).done);E=!0){var D=N.value,F=!0,O=!1,_=void 0;try{for(var I,R=e.children[Symbol.iterator]();!(F=(I=R.next()).done);F=!0){var M=I.value;if(M.component.axes[D]){if("independent"===i.axis[D]){r[D]=(null!==(t=r[D])&&void 0!==t?t:[]).concat(M.component.axes[D]);var B=!0,P=!1,L=void 0;try{for(var j,z=M.component.axes[D][Symbol.iterator]();!(B=(j=z.next()).done);B=!0){var U=j.value,V=U.getWithExplicit("orient"),W=V.value,G=V.explicit;if(!u.isSignalRef(W)){if(s[W]>0&&!G){var H=y[W];s[W]>s[H]&&U.set("orient",H,!1)}s[W]++}}}catch(e){P=!0,L=e}finally{try{B||null==z.return||z.return()}finally{if(P)throw L}}}delete M.component.axes[D]}}}catch(e){O=!0,_=e}finally{try{F||null==R.return||R.return()}finally{if(O)throw _}}if("independent"===i.axis[D]&&r[D]&&r[D].length>1){var q=!0,J=!1,K=void 0;try{for(var X,Y=r[D][Symbol.iterator]();!(q=(X=Y.next()).done);q=!0){var Q=X.value;Q.get("grid")&&!Q.explicit.grid&&(Q.implicit.grid=!1)}}catch(e){J=!0,K=e}finally{try{q||null==Y.return||Y.return()}finally{if(J)throw K}}}}}catch(e){C=!0,S=e}finally{try{E||null==T.return||T.return()}finally{if(C)throw S}}}function b(e,t){if(!e)return t.map((function(e){return e.clone()}));if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var a=e[r],i=t[r];if(!!a!=!!i)return;if(a&&i){var o=a.getWithExplicit("orient"),u=i.getWithExplicit("orient");if(o.explicit&&u.explicit&&o.value!==u.value)return;e[r]=k(a,i)}}return e}}function k(e,t){var n=!0,r=!1,a=void 0;try{for(var i,u=function(n,r){var a=r.value,i=d.mergeValuesWithExplicit(e.getWithExplicit(a),t.getWithExplicit(a),a,"axis",(function(e,t){switch(a){case"title":return c.mergeTitleComponent(e,t);case"gridScale":return{explicit:e.explicit,value:o.getFirstDefined(e.value,t.value)}}return d.defaultTieBreaker(e,t,a,"axis")}));e.setWithExplicit(a,i)},s=p.AXIS_COMPONENT_PROPERTIES[Symbol.iterator]();!(n=(i=s.next()).done);n=!0)u(0,i)}catch(e){r=!0,a=e}finally{try{n||null==s.return||s.return()}finally{if(r)throw a}}return e}function w(e,t,n,r,a){if("disable"===t)return void 0!==n;switch(n=n||{},t){case"titleAngle":case"labelAngle":return e===(u.isSignalRef(n.labelAngle)?n.labelAngle:o.normalizeAngle(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===g.getFieldDefTitle(r,a))return!0}return e===n[t]}var A=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function E(e,t){var n,a,s,c=t.axis(e),f=new p.AxisComponent,d=i.getFieldOrDatumDef(t.encoding[e]),m=t.mark,y=t.config,x=(null==c?void 0:c.orient)||(null===(n=y["x"===e?"axisX":"axisY"])||void 0===n?void 0:n.orient)||(null===(a=y.axis)||void 0===a?void 0:a.orient)||g.defaultOrient(e),b=t.getScaleComponent(e).get("type"),k=h.getAxisConfigs(e,b,x,t.config),E=void 0!==c?!c:h.getAxisConfig("disable",y,null==c?void 0:c.style,k).configValue;if(f.set("disable",E,void 0!==c),E)return f;c=c||{};var C=g.getLabelAngle(t,c,e,d,k),S={fieldOrDatumDef:d,axis:c,channel:e,model:t,scaleType:b,orient:x,labelAngle:C,mark:m,config:y},N=!0,T=!1,D=void 0;try{for(var F,O=p.AXIS_COMPONENT_PROPERTIES[Symbol.iterator]();!(N=(F=O.next()).done);N=!0){var _=F.value,I=_ in g.axisRules?g.axisRules[_](S):r.isAxisProperty(_)?c[_]:void 0,R=void 0!==I,M=w(I,_,c,t,e);if(R&&M)f.set(_,I,M);else{var B=r.isAxisProperty(_)&&"values"!==_?h.getAxisConfig(_,t.config,c.style,k):{},P=B.configValue,L=B.configFrom,j=void 0!==P;R&&!j?f.set(_,I,M):("vgAxisConfig"!==L||A.has(_)&&j||r.isConditionalAxisValue(P)||u.isSignalRef(P))&&f.set(_,P,!1)}}}catch(e){T=!0,D=e}finally{try{N||null==O.return||O.return()}finally{if(T)throw D}}var z=null!==(s=c.encoding)&&void 0!==s?s:{},U=r.AXIS_PARTS.reduce((function(n,r){var a;if(!f.hasAxisPart(r))return n;var i=l.guideEncodeEntry(null!==(a=z[r])&&void 0!==a?a:{},t),u="labels"===r?v.labels(t,e,i):i;return void 0===u||o.isEmpty(u)||(n[r]={update:u}),n}),{});return o.isEmpty(U)||f.set("encode",U,!!c.encoding||void 0!==c.labelAngle),f}})),s.register("bawWs",(function(e,t){n(e.exports,"AXIS_COMPONENT_PROPERTIES",(function(){return p})),n(e.exports,"AxisComponent",(function(){return h})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("aLoDX"),c=s("lSb9O"),l=s("CFwcG"),f=s("7T458");var d=Object.assign(Object.assign({disable:1,gridScale:1,scale:1},u.COMMON_AXIS_PROPERTIES_INDEX),{labelExpr:1,encode:1}),p=c.keys(d),h=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i.default(this,n),(e=t.call(this)).explicit=r,e.implicit=a,e.mainExtracted=o,e}return o.default(n,[{key:"clone",value:function(){return new n(c.duplicate(this.explicit),c.duplicate(this.implicit),this.mainExtracted)}},{key:"hasAxisPart",value:function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t}},{key:"hasOrientSignalRef",value:function(){return f.isSignalRef(this.explicit.orient)}}]),n}(l.Split)})),s.register("ktTpu",(function(e,t){n(e.exports,"labels",(function(){return o}));var r=s("e3OyN"),a=s("iooJ7"),i=s("ixH3E");function o(e,t,n){var o,u=e.encoding,s=e.config,c=null!==(o=a.getFieldOrDatumDef(u[t]))&&void 0!==o?o:a.getFieldOrDatumDef(u[r.getSecondaryRangeChannel(t)]),l=e.axis(t)||{},f=l.format,d=l.formatType;return i.isCustomFormatType(d)?Object.assign({text:i.formatCustomType({fieldOrDatumDef:c,field:"datum.value",format:f,formatType:d,config:s})},n):n}})),s.register("lAgVt",(function(e,t){n(e.exports,"UnitModel",(function(){return N})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("e3OyN"),l=s("iooJ7"),f=s("1Z7Bs"),d=s("jQ4iQ"),p=(d=s("jQ4iQ"),s("4sOzK")),h=s("eg4js"),v=s("0RcIy"),g=s("56lbz"),m=s("lKuQD"),y=s("2zW61"),x=s("iUaCf"),b=s("8mfm1"),k=s("lWXej"),w=s("bR5IL"),A=s("lWWIx"),E=s("jZr2L"),C=s("d4pV2"),S=s("4dGY7"),N=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(e,r,a){var o,u,s,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},l=arguments.length>4?arguments[4]:void 0;i.default(this,n),(o=t.call(this,e,"unit",r,a,l,void 0,h.isFrameMixins(e)?e.view:void 0)).specifiedScales={},o.specifiedAxes={},o.specifiedLegends={},o.specifiedProjection={},o.selection={},o.children=[];var g=p.isMarkDef(e.mark)?e.mark.type:e.mark;o.markDef=w.initMarkdef(e.mark,null!==(u=e.encoding)&&void 0!==u?u:{},l,{graticule:e.data&&f.isGraticuleGenerator(e.data)});var m=o.encoding=d.initEncoding(null!==(s=e.encoding)&&void 0!==s?s:{},o.markDef,l);return o.size=b.initLayoutSize({encoding:m,size:h.isFrameMixins(e)?Object.assign(Object.assign(Object.assign({},c),e.width?{width:e.width}:{}),e.height?{height:e.height}:{}):c}),o.stack=v.stack(g,m),o.specifiedScales=o.initScales(g,m),o.specifiedAxes=o.initAxes(m),o.specifiedLegends=o.initLegend(m),o.specifiedProjection=e.projection,o.selection=e.selection,o}return o.default(n,[{key:"hasProjection",get:function(){var e=this.encoding,t=this.mark===p.GEOSHAPE,n=e&&c.GEOPOSITION_CHANNELS.some((function(t){return l.isFieldOrDatumDef(e[t])}));return t||n}},{key:"scaleDomain",value:function(e){var t=this.specifiedScales[e];return t?t.domain:void 0}},{key:"axis",value:function(e){return this.specifiedAxes[e]}},{key:"legend",value:function(e){return this.specifiedLegends[e]}},{key:"initScales",value:function(e,t){return c.SCALE_CHANNELS.reduce((function(e,n){var r,a=l.getFieldOrDatumDef(t[n]);return a&&(e[n]=null!==(r=a.scale)&&void 0!==r?r:{}),e}),{})}},{key:"initAxes",value:function(e){return c.POSITION_SCALE_CHANNELS.reduce((function(t,n){var r=e[n];if(l.isFieldOrDatumDef(r)||n===c.X&&l.isFieldOrDatumDef(e.x2)||n===c.Y&&l.isFieldOrDatumDef(e.y2)){var a=l.isFieldOrDatumDef(r)?r.axis:void 0;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"initLegend",value:function(e){return c.NONPOSITION_SCALE_CHANNELS.reduce((function(t,n){var r=l.getFieldOrDatumDef(e[n]);if(r&&c.supportLegend(n)){var a=r.legend;t[n]=a?Object.assign({},a):a}return t}),{})}},{key:"parseData",value:function(){this.component.data=y.parseData(this)}},{key:"parseLayoutSize",value:function(){k.parseUnitLayoutSize(this)}},{key:"parseSelections",value:function(){this.component.selection=S.parseUnitSelection(this,this.selection)}},{key:"parseMarkGroup",value:function(){this.component.mark=A.parseMarkGroups(this)}},{key:"parseAxesAndHeaders",value:function(){this.component.axes=m.parseUnitAxes(this)}},{key:"assembleSelectionTopLevelSignals",value:function(e){return C.assembleTopLevelSignals(this,e)}},{key:"assembleSignals",value:function(){return u.default(g.assembleAxisSignals(this)).concat(u.default(C.assembleUnitSelectionSignals(this,[])))}},{key:"assembleSelectionData",value:function(e){return C.assembleUnitSelectionData(this,e)}},{key:"assembleLayout",value:function(){return null}},{key:"assembleLayoutSignals",value:function(){return x.assembleLayoutSignals(this)}},{key:"assembleMarks",value:function(){var e,t=null!==(e=this.component.mark)&&void 0!==e?e:[];return this.parent&&E.isLayerModel(this.parent)||(t=C.assembleUnitSelectionMarks(this,t)),t.map(this.correctDataNames)}},{key:"getMapping",value:function(){return this.encoding}},{key:"mark",get:function(){return this.markDef.type}},{key:"channelHasField",value:function(e){return d.channelHasField(this.encoding,e)}},{key:"fieldDef",value:function(e){var t=this.encoding[e];return l.getFieldDef(t)}},{key:"typedFieldDef",value:function(e){var t=this.fieldDef(e);return l.isTypedFieldDef(t)?t:null}}]),n}(E.ModelWithField)})),s.register("8mfm1",(function(e,t){n(e.exports,"initLayoutSize",(function(){return c}));var r=s("e3OyN"),a=s("iooJ7"),i=s("16rNM"),o=s("2x4HI"),u=s("eg4js");function c(e){var t=e.encoding,n=e.size,s=!0,c=!1,l=void 0;try{for(var f,d=r.POSITION_SCALE_CHANNELS[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value,h=r.getSizeChannel(p);u.isStep(n[h])&&a.isContinuousFieldOrDatumDef(t[p])&&(delete n[h],i.warn(o.stepDropped(h)))}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return n}})),s.register("bR5IL",(function(e,t){n(e.exports,"initMarkdef",(function(){return p}));var r=s("61RXI"),a=s("iooJ7"),i=s("jQ4iQ"),o=s("16rNM"),u=s("2x4HI"),c=s("4sOzK"),l=s("4jgmF"),f=s("lSb9O"),d=s("9iwJo");function p(e,t,n,s){var p=s.graticule,h=c.isMarkDef(e)?Object.assign({},e):{type:e},v=d.getMarkPropOrConfig("orient",h,n);if(h.orient=function(e,t,n){switch(e){case c.POINT:case c.CIRCLE:case c.SQUARE:case c.TEXT:case c.RECT:case c.IMAGE:return}var i=t.x,o=t.y,u=t.x2,s=t.y2;switch(e){case c.BAR:if(a.isFieldDef(i)&&(r.isBinned(i.bin)||a.isFieldDef(o)&&o.aggregate&&!i.aggregate))return"vertical";if(a.isFieldDef(o)&&(r.isBinned(o.bin)||a.isFieldDef(i)&&i.aggregate&&!o.aggregate))return"horizontal";if(s||u){if(n)return n;if(!u&&(a.isFieldDef(i)&&i.type===l.QUANTITATIVE&&!r.isBinning(i.bin)||a.isNumericDataDef(i)))return"horizontal";if(!s&&(a.isFieldDef(o)&&o.type===l.QUANTITATIVE&&!r.isBinning(o.bin)||a.isNumericDataDef(o)))return"vertical"}case c.RULE:if(u&&(!a.isFieldDef(i)||!r.isBinned(i.bin))&&s&&(!a.isFieldDef(o)||!r.isBinned(o.bin)))return;case c.AREA:if(s)return a.isFieldDef(o)&&r.isBinned(o.bin)?"horizontal":"vertical";if(u)return a.isFieldDef(i)&&r.isBinned(i.bin)?"vertical":"horizontal";if(e===c.RULE){if(i&&!o)return"vertical";if(o&&!i)return"horizontal"}case c.LINE:case c.TICK:var f=a.isContinuousFieldOrDatumDef(i),d=a.isContinuousFieldOrDatumDef(o);if(f&&!d)return"tick"!==e?"horizontal":"vertical";if(!f&&d)return"tick"!==e?"vertical":"horizontal";if(f&&d){var p=i,h=o,v=p.type===l.TEMPORAL,g=h.type===l.TEMPORAL;return v&&!g?"tick"!==e?"vertical":"horizontal":!v&&g?"tick"!==e?"horizontal":"vertical":!p.aggregate&&h.aggregate?"tick"!==e?"vertical":"horizontal":p.aggregate&&!h.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(h.type,t,v),void 0!==v&&v!==h.orient&&o.warn(u.orientOverridden(h.orient,v)),"bar"===h.type&&h.orient){var g=d.getMarkPropOrConfig("cornerRadiusEnd",h,n);if(void 0!==g){var m="horizontal"===h.orient&&t.x2||"vertical"===h.orient&&t.y2?["cornerRadius"]:c.BAR_CORNER_RADIUS_INDEX[h.orient],y=!0,x=!1,b=void 0;try{for(var k,w=m[Symbol.iterator]();!(y=(k=w.next()).done);y=!0){h[k.value]=g}}catch(e){x=!0,b=e}finally{try{y||null==w.return||w.return()}finally{if(x)throw b}}void 0!==h.cornerRadiusEnd&&delete h.cornerRadiusEnd}}return void 0===d.getMarkPropOrConfig("opacity",h,n)&&(h.opacity=function(e,t){if(f.contains([c.POINT,c.TICK,c.CIRCLE,c.SQUARE],e)&&!i.isAggregate(t))return.7;return}(h.type,t)),void 0===h.filled&&(h.filled=!p&&function(e,t){var n=d.getMarkConfig("filled",e,t),r=e.type;return f.getFirstDefined(n,r!==c.POINT&&r!==c.LINE&&r!==c.RULE)}(h,n)),void 0===d.getMarkPropOrConfig("cursor",h,n)&&(h.cursor=function(e,t,n){return t.href||e.href||d.getMarkPropOrConfig("href",e,n)?"pointer":e.cursor}(h,t,n)),h}})),s.register("lWWIx",(function(e,t){n(e.exports,"parseMarkGroups",(function(){return T})),s("1i51P");var r=s("6vecG"),a=s("9M1dW"),i=s("4Ui3v");s("iSlfb");var o=s("4ujSI"),u=s("iooJ7"),c=s("1Z7Bs"),l=s("jQ4iQ"),f=s("4sOzK"),d=s("2V3EF"),p=s("lSb9O"),h=s("7T458"),v=s("9iwJo"),g=s("gMqwp"),m=s("iF3WM"),y=s("acrsf"),x=s("42eA2"),b=s("26DUG"),k=s("eBTj8"),w=s("4bo26"),A=s("ftZN8"),E=s("02T1x"),C=s("9qoOg"),S=s("c9YI1"),N={arc:g.arc,area:m.area,bar:y.bar,circle:w.circle,geoshape:x.geoshape,image:b.image,line:k.line,point:w.point,rect:A.rect,rule:E.rule,square:w.square,text:C.text,tick:S.tick,trail:k.trail};function T(e){return p.contains([f.LINE,f.AREA,f.TRAIL],e.mark)?function(e){var t=l.pathGroupingFields(e.mark,e.encoding),n=_(e,{fromPrefix:t.length>0?D:""});return t.length>0?[{name:e.getName("pathgroup"),type:"group",from:{facet:{name:D+e.requestDataName(c.MAIN),data:e.requestDataName(c.MAIN),groupby:t}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:n}]:n}(e):p.contains([f.BAR],e.mark)?function(e){var t=h.VG_CORNERRADIUS_CHANNELS.some((function(t){return v.getMarkPropOrConfig(t,e.markDef,e.config)}));if(e.stack&&!e.fieldDef("size")&&t){var n,o,s=r.default(_(e,{fromPrefix:F}),1)[0],l=e.scaleName(e.stack.fieldChannel),f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.vgField(e.stack.fieldChannel,t)},d=function(e,t){var n=[f({prefix:"min",suffix:"start",expr:t}),f({prefix:"max",suffix:"start",expr:t}),f({prefix:"min",suffix:"end",expr:t}),f({prefix:"max",suffix:"end",expr:t})];return"".concat(e,"(").concat(n.map((function(e){return"scale('".concat(l,"',").concat(e,")")})).join(","),")")};"x"===e.stack.fieldChannel?(n=Object.assign(Object.assign({},p.pick(s.encode.update,["y","yc","y2","height"].concat(a.default(h.VG_CORNERRADIUS_CHANNELS)))),{x:{signal:d("min","datum")},x2:{signal:d("max","datum")},clip:{value:!0}}),o={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},s.encode.update=Object.assign(Object.assign({},p.omit(s.encode.update,["y","yc","y2"])),{height:{field:{group:"height"}}})):(n=Object.assign(Object.assign({},p.pick(s.encode.update,["x","xc","x2","width"])),{y:{signal:d("min","datum")},y2:{signal:d("max","datum")},clip:{value:!0}}),o={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},s.encode.update=Object.assign(Object.assign({},p.omit(s.encode.update,["x","xc","x2"])),{width:{field:{group:"width"}}}));var g=!0,m=!1,y=void 0;try{for(var x,b=h.VG_CORNERRADIUS_CHANNELS[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var k=x.value,w=v.getMarkConfig(k,e.markDef,e.config);s.encode.update[k]?(n[k]=s.encode.update[k],delete s.encode.update[k]):w&&(n[k]=v.signalOrValueRef(w)),w&&(s.encode.update[k]={value:0})}}catch(e){m=!0,y=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}var A=e.fieldDef(e.stack.groupbyChannel),E=u.vgField(A)?[u.vgField(A)]:[];return((null==A?void 0:A.bin)||(null==A?void 0:A.timeUnit))&&E.push(u.vgField(A,{binSuffix:"end"})),n=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce((function(t,n){if(s.encode.update[n])return Object.assign(Object.assign({},t),i.default({},n,s.encode.update[n]));var r=v.getMarkConfig(n,e.markDef,e.config);return void 0!==r?Object.assign(Object.assign({},t),i.default({},n,v.signalOrValueRef(r))):t}),n),n.stroke&&(n.strokeForeground={value:!0},n.strokeOffset={value:0}),[{type:"group",from:{facet:{data:e.requestDataName(c.MAIN),name:F+e.requestDataName(c.MAIN),groupby:E,aggregate:{fields:[f({suffix:"start"}),f({suffix:"start"}),f({suffix:"end"}),f({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:n},marks:[{type:"group",encode:{update:o},marks:[s]}]}]}return _(e)}(e):_(e)}var D="faceted_path_";var F="stack_group_";function O(e){var t=e.encoding,n=e.stack,r=e.mark,a=e.markDef,i=e.config,s=t.order;if(!(!o.default(s)&&u.isValueDef(s)&&p.isNullOrFalse(s.value)||!s&&p.isNullOrFalse(v.getMarkPropOrConfig("order",a,i)))){if((o.default(s)||u.isFieldDef(s))&&!n)return v.sortParams(s,{expr:"datum"});if(f.isPathMark(r)){var c="horizontal"===a.orient?"y":"x",h=t[c];if(u.isFieldDef(h)){var g=h.sort;if(o.default(g))return{field:u.vgField(h,{prefix:c,suffix:"sort_index",expr:"datum"})};if(d.isSortField(g))return{field:u.vgField({aggregate:l.isAggregate(e.encoding)?g.op:void 0,field:g.field},{expr:"datum"})};if(d.isSortByEncoding(g)){var m=e.fieldDef(g.encoding);return{field:u.vgField(m,{expr:"datum"}),order:g.order}}return null===g?void 0:{field:u.vgField(h,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"})}}}else;}}function _(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fromPrefix:""},n=e.mark,r=e.markDef,a=e.config,i=p.getFirstDefined(r.clip,I(e),R(e)),o=v.getStyles(r),u=e.encoding.key,s=O(e),l=M(e),f=v.getMarkPropOrConfig("aria",r,a),d=N[n].postEncodingTransform?N[n].postEncodingTransform(e):null;return[Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({name:e.getName("marks"),type:N[n].vgMark},i?{clip:!0}:{}),o?{style:o}:{}),u?{key:u.field}:{}),s?{sort:s}:{}),l||{}),!1===f?{aria:f}:{}),{from:{data:t.fromPrefix+e.requestDataName(c.MAIN)},encode:{update:N[n].encodeEntry(e)}}),d?{transform:d}:{})]}function I(e){var t=e.getScaleComponent("x"),n=e.getScaleComponent("y");return!!(t&&t.get("selectionExtent")||n&&n.get("selectionExtent"))||void 0}function R(e){var t=e.component.projection;return!(!t||t.isFit)||void 0}function M(e){if(!e.component.selection)return null;for(var t=p.keys(e.component.selection).length,n=t,r=e.parent;r&&0===n;)n=p.keys(r.component.selection).length,r=r.parent;return n?{interactive:t>0}:null}})),s.register("gMqwp",(function(e,t){n(e.exports,"arc",(function(){return o})),s("7fgyI");var r=s("5N18T"),a=s("cleKX"),i=s("8rcIu"),o={vgMark:"arc",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),a.pointPosition("x",e,{defaultPos:"mid"})),a.pointPosition("y",e,{defaultPos:"mid"})),i.rectPosition(e,"radius","arc")),i.rectPosition(e,"theta","arc"))}}})),s.register("iF3WM",(function(e,t){n(e.exports,"area",(function(){return o})),s("7fgyI");var r=s("5N18T"),a=s("63VZV"),i=s("1W8hP"),o={vgMark:"area",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"})),a.pointOrRangePosition("x",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===e.markDef.orient})),a.pointOrRangePosition("y",e,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===e.markDef.orient})),i.defined(e))}}})),s.register("acrsf",(function(e,t){n(e.exports,"bar",(function(){return i})),s("7fgyI");var r=s("5N18T"),a=s("8rcIu"),i={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),a.rectPosition(e,"x","bar")),a.rectPosition(e,"y","bar"))}}})),s.register("42eA2",(function(e,t){n(e.exports,"geoshape",(function(){return o}));var r=s("iooJ7"),a=s("4jgmF");s("7fgyI");var i=s("5N18T"),o={vgMark:"shape",encodeEntry:function(e){return Object.assign({},i.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[Object.assign({type:"geoshape",projection:e.projectionName()},t&&r.isFieldDef(t)&&t.type===a.GEOJSON?{field:r.vgField(t,{expr:"datum"})}:{})]}}})),s.register("26DUG",(function(e,t){n(e.exports,"image",(function(){return o})),s("7fgyI");var r=s("5N18T"),a=s("8rcIu"),i=s("6JdYd"),o={vgMark:"image",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"})),a.rectPosition(e,"x","image")),a.rectPosition(e,"y","image")),i.text(e,"url"))}}})),s.register("eBTj8",(function(e,t){n(e.exports,"line",(function(){return u})),n(e.exports,"trail",(function(){return c})),s("7fgyI");var r=s("5N18T"),a=s("cleKX"),i=s("cQqts"),o=s("1W8hP"),u={vgMark:"line",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})),a.pointPosition("x",e,{defaultPos:"mid"})),a.pointPosition("y",e,{defaultPos:"mid"})),i.nonPosition("size",e,{vgChannel:"strokeWidth"})),o.defined(e))}},c={vgMark:"trail",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),a.pointPosition("x",e,{defaultPos:"mid"})),a.pointPosition("y",e,{defaultPos:"mid"})),i.nonPosition("size",e)),o.defined(e))}}})),s.register("4bo26",(function(e,t){n(e.exports,"point",(function(){return u})),n(e.exports,"circle",(function(){return c})),n(e.exports,"square",(function(){return l})),s("7fgyI");var r=s("5N18T"),a=s("cleKX"),i=s("cQqts");function o(e,t){e.config;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"})),a.pointPosition("x",e,{defaultPos:"mid"})),a.pointPosition("y",e,{defaultPos:"mid"})),i.nonPosition("size",e)),i.nonPosition("angle",e)),function(e,t,n){return n?{shape:{value:n}}:i.nonPosition("shape",e)}(e,0,t))}var u={vgMark:"symbol",encodeEntry:function(e){return o(e)}},c={vgMark:"symbol",encodeEntry:function(e){return o(e,"circle")}},l={vgMark:"symbol",encodeEntry:function(e){return o(e,"square")}}})),s.register("ftZN8",(function(e,t){n(e.exports,"rect",(function(){return i})),s("7fgyI");var r=s("5N18T"),a=s("8rcIu"),i={vgMark:"rect",encodeEntry:function(e){return Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),a.rectPosition(e,"x","rect")),a.rectPosition(e,"y","rect"))}}})),s.register("02T1x",(function(e,t){n(e.exports,"rule",(function(){return o})),s("7fgyI");var r=s("5N18T"),a=s("63VZV"),i=s("cQqts"),o={vgMark:"rule",encodeEntry:function(e){var t=e.markDef.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?Object.assign(Object.assign(Object.assign(Object.assign({},r.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),a.pointOrRangePosition("x",e,{defaultPos:"horizontal"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==t})),a.pointOrRangePosition("y",e,{defaultPos:"vertical"===t?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==t})),i.nonPosition("size",e,{vgChannel:"strokeWidth"})):{}}}})),s.register("9qoOg",(function(e,t){n(e.exports,"text",(function(){return l}));var r=s("9iwJo");s("7fgyI");var a=s("5N18T"),i=s("cleKX"),o=s("6JdYd"),u=s("cQqts"),c=s("1W8hP"),l={vgMark:"text",encodeEntry:function(e){var t=e.config;e.encoding;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a.baseEncodeEntry(e,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"})),i.pointPosition("x",e,{defaultPos:"mid"})),i.pointPosition("y",e,{defaultPos:"mid"})),o.text(e)),u.nonPosition("size",e,{vgChannel:"fontSize"})),u.nonPosition("angle",e)),c.valueIfDefined("align",function(e,t,n){return void 0===r.getMarkPropOrConfig("align",e,n)?"center":void 0}(e.markDef,0,t))),c.valueIfDefined("baseline",function(e,t,n){return void 0===r.getMarkPropOrConfig("baseline",e,n)?"middle":void 0}(e.markDef,0,t))),i.pointPosition("radius",e,{defaultPos:null,isMidPoint:!0})),i.pointPosition("theta",e,{defaultPos:null,isMidPoint:!0}))}}})),s.register("c9YI1",(function(e,t){n(e.exports,"tick",(function(){return d})),s("1i51P");var r=s("4Ui3v");s("iSlfb");var a=s("8AF0b"),i=s("fldOo"),o=s("7T458"),u=s("9iwJo");s("7fgyI");var c=s("5N18T"),l=s("cleKX"),f=s("cQqts"),d={vgMark:"rect",encodeEntry:function(e){var t=e.config,n=e.markDef,a=n.orient,i="horizontal"===a?"width":"height",o="horizontal"===a?"height":"width";return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},c.baseEncodeEntry(e,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"})),l.pointPosition("x",e,{defaultPos:"mid",vgChannel:"xc"})),l.pointPosition("y",e,{defaultPos:"mid",vgChannel:"yc"})),f.nonPosition("size",e,{defaultValue:p(e),vgChannel:i})),r.default({},o,u.signalOrValueRef(u.getMarkPropOrConfig("thickness",n,t))))}};function p(e){var t,n=e.config,r=e.markDef,s=r.orient,c="horizontal"===s?"width":"height",l=e.getScaleComponent("horizontal"===s?"x":"y"),f=null!==(t=u.getMarkPropOrConfig("size",r,n,{vgChannel:c}))&&void 0!==t?t:n.tick.bandSize;if(void 0!==f)return f;var d=l?l.get("range"):void 0;return d&&o.isVgRangeStep(d)&&a.default(d.step)?3*d.step/4:3*i.getViewConfigDiscreteStep(n.view,c)/4}})),s.register("8ykKy",(function(e,t){n(e.exports,"extractTransforms",(function(){return d})),s("1i51P");var r=s("2vsUb"),a=s("d6iiX"),i=s("3QOYJ"),o=s("2tuUj"),u=s("9M1dW"),c=s("jQ4iQ"),l=function(e){"use strict";r.default(n,e);var t=a.default(n);function n(){return i.default(this,n),t.apply(this,arguments)}return o.default(n,[{key:"mapUnit",value:function(e,t){var n=t.config;if(e.encoding){var r=e.encoding,a=e.transform,i=c.extractTransformsFromEncoding(r,n),o=i.bins,s=i.timeUnits,l=i.aggregate,f=i.groupby,d=i.encoding,p=u.default(a||[]).concat(u.default(o),u.default(s),u.default(0===l.length?[]:[{aggregate:l,groupby:f}]));return Object.assign(Object.assign(Object.assign({},e),p.length>0?{transform:p}:{}),{encoding:d})}return e}}]),n}(s("7vDGT").SpecMapper),f=new l;function d(e,t){return f.map(e,{config:t})}})),s.register("axtJv",(function(e,t){n(e.exports,"default",(function(){return a})),s("1i51P");var r=s("6vecG");var a=function(e){var t=r.default(/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(e).slice(1,3),2);return{library:t[0],version:t[1]}}})),s.register("ixC8H",(function(e,t){n(e.exports,"dark",(function(){return a})),n(e.exports,"excel",(function(){return o})),n(e.exports,"fivethirtyeight",(function(){return f})),n(e.exports,"ggplot2",(function(){return p})),n(e.exports,"latimes",(function(){return x})),n(e.exports,"quartz",(function(){return w})),n(e.exports,"vox",(function(){return E})),n(e.exports,"urbaninstitute",(function(){return F})),n(e.exports,"googlecharts",(function(){return R})),n(e.exports,"version",(function(){return M}));var r="#fff",a={background:"#333",title:{color:r,subtitleColor:r},style:{"guide-label":{fill:r},"guide-title":{fill:r}},axis:{domainColor:r,gridColor:"#888",tickColor:r}},i="#4572a7",o={background:"#fff",arc:{fill:i},area:{fill:i},line:{stroke:i,strokeWidth:2},path:{stroke:i},rect:{fill:i},shape:{stroke:i},symbol:{fill:i,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},u="#30a2da",s="#cbcbcb",c="#f0f0f0",l="#333",f={arc:{fill:u},area:{fill:u},axis:{domainColor:s,grid:!0,gridColor:s,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:s,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:c,group:{fill:c},legend:{labelColor:l,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:l,titleFontSize:14,titlePadding:10},line:{stroke:u,strokeWidth:2},path:{stroke:u,strokeWidth:.5},rect:{fill:u},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:u},bar:{binSpacing:2,fill:u,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},d="#000",p={group:{fill:"#e5e5e5"},arc:{fill:d},area:{fill:d},line:{stroke:d},path:{stroke:d},rect:{fill:d},shape:{stroke:d},symbol:{fill:d,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},h="Benton Gothic, sans-serif",v="#82c6df",g="Benton Gothic Bold, sans-serif",m="normal",y={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},x={background:"#ffffff",title:{anchor:"start",color:"#000000",font:g,fontSize:22,fontWeight:"normal"},arc:{fill:v},area:{fill:v},line:{stroke:v,strokeWidth:2},path:{stroke:v},rect:{fill:v},shape:{stroke:v},symbol:{fill:v,size:30},axis:{labelFont:h,labelFontSize:11.5,labelFontWeight:"normal",titleFont:g,titleFontSize:13,titleFontWeight:m},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:h,labelFontSize:11.5,symbolType:"square",titleFont:g,titleFontSize:13,titleFontWeight:m},range:{category:y["category-6"],diverging:y["fireandice-6"],heatmap:y["fire-7"],ordinal:y["fire-7"],ramp:y["fire-7"]}},b="#ab5787",k="#979797",w={background:"#f9f9f9",arc:{fill:b},area:{fill:b},line:{stroke:b},path:{stroke:b},rect:{fill:b},shape:{stroke:b},symbol:{fill:b,size:30},axis:{domainColor:k,domainWidth:.5,gridWidth:.2,labelColor:k,tickColor:k,tickWidth:.2,titleColor:k},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},A="#3e5c69",E={background:"#fff",arc:{fill:A},area:{fill:A},line:{stroke:A},path:{stroke:A},rect:{fill:A},shape:{stroke:A},symbol:{fill:A},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},C="#1696d2",S="#000000",N="Lato",T="Lato",D={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},F={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:N},axisX:{domain:!0,domainColor:S,domainWidth:1,grid:!1,labelFontSize:12,labelFont:T,labelAngle:0,tickColor:S,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:N},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:T,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:N,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:T,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:N,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:D["six-groups-cat-1"],diverging:D["diverging-colors"],heatmap:D["diverging-colors"],ordinal:D["six-groups-seq"],ramp:D["shades-blue"]},area:{fill:C},rect:{fill:C},line:{color:C,stroke:C,strokeWidth:5},trail:{color:C,stroke:C,strokeWidth:0,size:1},path:{stroke:C,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:C,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:C,stroke:null}},arc:{fill:C},shape:{stroke:C},symbol:{fill:C,size:30}},O="#3366CC",_="#ccc",I="Arial, sans-serif",R={arc:{fill:O},area:{fill:O},path:{stroke:O},rect:{fill:O},shape:{stroke:O},symbol:{stroke:O},circle:{fill:O},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:I,fontSize:12},"guide-title":{font:I,fontSize:12},"group-title":{font:I,fontSize:12}},title:{font:I,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:_,tickColor:_,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},M="2.10.0"})),s.register("1x0ks",(function(e,t){n(e.exports,"Handler",(function(){return f})),s("1i51P");var r=s("3QOYJ"),a=s("2tuUj"),i=s("caNzv"),o="vg-tooltip-element",u={offsetX:10,offsetY:10,id:o,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2};function c(e,t,n){if(i.isArray(e))return"[".concat(e.map((function(e){return t(i.isString(e)?e:l(e,n))})).join(", "),"]");if(i.isObject(e)){var r="",a=e,o=a.title,u=a.image,s=
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(a,["title","image"]);o&&(r+="<h2>".concat(t(o),"</h2>")),u&&(r+='<img src="'.concat(t(u),'">'));var c=Object.keys(s);if(c.length>0){r+="<table>";var f=!0,d=!1,p=void 0;try{for(var h,v=c[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var g=h.value,m=s[g];void 0!==m&&(i.isObject(m)&&(m=l(m,n)),r+='<tr><td class="key">'.concat(t(g),':</td><td class="value">').concat(t(m),"</td></tr>"))}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}r+="</table>"}return r||"{}"}return t(e)}function l(e,t){return JSON.stringify(e,function(e){var t=[];return function(n,r){if("object"!=typeof r||null===r)return r;var a=t.indexOf(this)+1;return t.length=a,t.length>e?"[Object]":t.indexOf(r)>=0?"[Circular]":(t.push(r),r)}}(t))}var f=function(){"use strict";function e(t){r.default(this,e),this.options=Object.assign(Object.assign({},u),t);var n=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){var a=document.createElement("style");a.setAttribute("id",this.options.styleId),a.innerHTML=function(e){if(!/^[A-Za-z]+[-:.\w]*$/.test(e))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black; }\n  #vg-tooltip-element.visible {\n    visibility: visible; }\n  #vg-tooltip-element h2 {\n    margin-top: 0;\n    margin-bottom: 10px;\n    font-size: 13px; }\n  #vg-tooltip-element img {\n    max-width: 200px;\n    max-height: 200px; }\n  #vg-tooltip-element table {\n    border-spacing: 0; }\n    #vg-tooltip-element table tr {\n      border: none; }\n      #vg-tooltip-element table tr td {\n        overflow: hidden;\n        text-overflow: ellipsis;\n        padding-top: 2px;\n        padding-bottom: 2px; }\n        #vg-tooltip-element table tr td.key {\n          color: #808080;\n          max-width: 150px;\n          text-align: right;\n          padding-right: 4px; }\n        #vg-tooltip-element table tr td.value {\n          display: block;\n          max-width: 300px;\n          max-height: 7em;\n          text-align: left; }\n  #vg-tooltip-element.dark-theme {\n    background-color: rgba(32, 32, 32, 0.9);\n    border: 1px solid #f5f5f5;\n    color: white; }\n    #vg-tooltip-element.dark-theme td.key {\n      color: #bfbfbf; }\n".toString().replace(o,e)}(n);var i=document.head;i.childNodes.length>0?i.insertBefore(a,i.childNodes[0]):i.appendChild(a)}}return a.default(e,[{key:"tooltipHandler",value:function(e,t,n,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),document.body.appendChild(this.el)),(null!=document.fullscreenElement?document.fullscreenElement:document.body).appendChild(this.el),null!=r&&""!==r){this.el.innerHTML=c(r,this.options.sanitize,this.options.maxDepth),this.el.classList.add("visible","".concat(this.options.theme,"-theme"));var a=function(e,t,n,r){var a=e.clientX+n;a+t.width>window.innerWidth&&(a=+e.clientX-n-t.width);var i=e.clientY+r;return i+t.height>window.innerHeight&&(i=+e.clientY-r-t.height),{x:a,y:i}}(t,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY),i=a.x,o=a.y;this.el.setAttribute("style","top: ".concat(o,"px; left: ").concat(i,"px"))}else this.el.classList.remove("visible","".concat(this.options.theme,"-theme"))}}]),e}()})),s.register("eoZhW",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isSurfaceInfo=function(e){return null!=e.name},e.exports.isSurface=function(e){return e.drawArea instanceof HTMLElement}})),s("1i51P");var c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),d=s("6vecG"),p=s("2vsUb"),h=s("d6iiX"),v=s("40Zzs");s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),p=s("2vsUb"),h=s("d6iiX"),v=s("40Zzs");s("jbRpz");var g=s("kglvN"),m=s("P1tXK"),y=s("4JvjV"),x=s("biSQf"),b=s("616DT"),k=s("1Rhbk");s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),p=s("2vsUb"),h=s("d6iiX"),v=s("40Zzs");s("jbRpz");m=s("P1tXK");var w=s("gIxdA");g=s("kglvN"),k=s("1Rhbk");s("jbRpz");y=s("4JvjV");s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");y=s("4JvjV"),g=s("kglvN");function A(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Set;if(null==e)return null;if(r.has(e))throw new Error("Circular references are not supported.");if(n.has(e))return n.get(e);var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep map function may not return both a value and recurse=true.");if(a.recurse){if(N(e)){var i=Array.isArray(e)?[]:{};for(var o in r.add(e),e){var u=e[o],s=A(u,t,n,r);i[o]=s}return r.delete(e),i}throw new Error("Can't recurse into non-iterable type: ".concat(e))}return n.set(e,a.value),a.value}function E(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S;return C(e,t)}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set,r=e[0];if(n.has(r))throw new Error("Circular references are not supported.");var a=t(e);if(a.recurse&&null!==a.value)throw new Error("A deep zip function may not return both a value and recurse=true.");if(a.recurse){if(N(r)){var i=function(r){var a=e.map((function(e){return e[r]})),i=C(a,t,n);o[r]=i},o=Array.isArray(r)?[]:{};for(var u in n.add(r),r)i(u);return n.delete(r),o}throw new Error("Can't recurse into non-iterable type: ".concat(r))}return a.value}function S(e){return null===e?null:N(e[0])?{value:null,recurse:!0}:{value:e,recurse:!1}}function N(e){return null!=e&&!ArrayBuffer.isView(e)&&(Array.isArray(e)||"object"==typeof e&&!(e instanceof y.Tensor))}function T(e){return A(e,D)}function D(e){return e instanceof y.Tensor?{value:e.clone(),recurse:!1}:N(e)?{value:null,recurse:!0}:{value:e,recurse:!1}}s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");var F=s("kRKWT"),O=s("eYQ8O");s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var _=function(){"use strict";function e(t){if(c.default(this,e),this.capacity=t,this.begin=0,this.end=0,null==t)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(t<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(t),this.doubledCapacity=2*t}return l.default(e,[{key:"wrap",value:function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}},{key:"get",value:function(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}},{key:"set",value:function(e,t){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=t}},{key:"length",value:function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}},{key:"isFull",value:function(){return this.length()===this.capacity}},{key:"isEmpty",value:function(){return 0===this.length()}},{key:"push",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}},{key:"pushAll",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=e[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;this.push(o)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"pop",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e}},{key:"unshift",value:function(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}},{key:"shift",value:function(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}},{key:"shuffleExcise",value:function(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n}}]),e}(),I=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.call(this,n.INITIAL_CAPACITY)}return l.default(n,[{key:"isFull",value:function(){return!1}},{key:"push",value:function(e){F.default(O.default(n.prototype),"isFull",this).call(this)&&this.expand(),F.default(O.default(n.prototype),"push",this).call(this,e)}},{key:"unshift",value:function(e){F.default(O.default(n.prototype),"isFull",this).call(this)&&this.expand(),F.default(O.default(n.prototype),"unshift",this).call(this,e)}},{key:"expand",value:function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n}}]),n}(_);function R(e){return new j(e)}function M(e){return new z(e)}function B(e,t){return new Q(e,t)}I.INITIAL_CAPACITY=32;var P,L=function(){"use strict";function e(){c.default(this,e)}return l.default(e,[{key:"toArray",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.next=3,e.next();case 3:a=t.sent;case 4:if(a.done){t.next=11;break}return r.push(a.value),t.next=8,e.next();case 8:a=t.sent,t.next=4;break;case 11:return t.abrupt("return",r);case 12:case"end":return t.stop()}}),n)})))()}},{key:"toArrayForTest",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a,i;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.prefetch(100),a=[],t.next=4,r.next();case 4:i=t.sent;case 5:if(i.done){t.next=12;break}return a.push(i.value),t.next=9,r.next();case 9:i=t.sent,t.next=5;break;case 12:return t.abrupt("return",a);case 13:case"end":return t.stop()}}),n)})))()}},{key:"resolveFully",value:function(){var e=this;return f.default(t(v).mark((function n(){var r;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.next();case 2:r=t.sent;case 3:if(r.done){t.next=9;break}return t.next=6,e.next();case 6:r=t.sent,t.next=3;break;case 9:case"end":return t.stop()}}),n)})))()}},{key:"resolveWhile",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a,i;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.next();case 2:a=t.sent,i=e(a.value);case 4:if(a.done||!i){t.next=11;break}return t.next=7,n.next();case 7:a=t.sent,i=e(a.value),t.next=4;break;case 11:case"end":return t.stop()}}),r)})))()}},{key:"handleErrors",value:function(e){return new J(this,e)}},{key:"filter",value:function(e){return new H(this,e)}},{key:"map",value:function(e){return new q(this,e)}},{key:"mapAsync",value:function(e){return new K(this,e)}},{key:"serialMapAsync",value:function(e){return new K(this,e).serial()}},{key:"flatmap",value:function(e){return new Y(this,e)}},{key:"forEachAsync",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.map(e).resolveFully());case 1:case"end":return t.stop()}}),r)})))()}},{key:"serialForEach",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.serialMapAsync(e).resolveWhile((function(e){return!0===e})));case 1:case"end":return t.stop()}}),r)})))()}},{key:"rowMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new G(this,e,t)}},{key:"columnMajorBatch",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S,r=this.rowMajorBatch(e,t);return r.map((function(e){return E(e,n)}))}},{key:"concatenate",value:function(e,t){return new Q(R([this,e]),t)}},{key:"take",value:function(e){return e<0||null==e?this:new W(this,e)}},{key:"skip",value:function(e){return e<0||null==e?this:new V(this,e)}},{key:"prefetch",value:function(e){return new Z(this,e)}},{key:"shuffle",value:function(e,t){return new $(this,e,t)}},{key:"serial",value:function(){return new U(this)}}]),e}(),j=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){var t;return c.default(this,r),(t=n.call(this)).items=e,t.trav=0,t}return l.default(r,[{key:"summary",value:function(){return"Array of ".concat(this.items.length," items")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){var r;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.trav>=e.items.length)){t.next=2;break}return t.abrupt("return",{value:null,done:!0});case 2:return r=e.items[e.trav],e.trav++,t.abrupt("return",{value:T(r),done:!1});case 5:case"end":return t.stop()}}),n)})))()}}]),r}(L),z=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){var t;return c.default(this,r),(t=n.call(this)).nextFn=e,t}return l.default(r,[{key:"summary",value:function(){return"Function call"}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.abrupt("return",e.nextFn());case 4:throw t.prev=4,t.t0=t.catch(0),t.t0.message="Error thrown while iterating through a dataset: ".concat(t.t0.message),t.t0;case 8:case"end":return t.stop()}}),n,null,[[0,4]])})))()}}]),r}(L),U=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){var t;return c.default(this,r),(t=n.call(this)).upstream=e,t.lastRead=Promise.resolve({value:null,done:!1}),t}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Serial")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.upstream.next());case 1:case"end":return t.stop()}}),n)})))()}}]),r}(L),V=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.maxCount=t,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Skip")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){var r;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.count++<e.maxCount)){t.next=9;break}return t.next=3,e.upstream.next();case 3:if(!(r=t.sent).done){t.next=6;break}return t.abrupt("return",r);case 6:m.dispose(r.value),t.next=0;break;case 9:return t.abrupt("return",e.upstream.next());case 10:case"end":return t.stop()}}),n)})))()}}]),r}(L),W=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.maxCount=t,a.count=0,a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Take")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e.count++>=e.maxCount)){t.next=2;break}return t.abrupt("return",{value:null,done:!0});case 2:return t.abrupt("return",e.upstream.next());case 3:case"end":return t.stop()}}),n)})))()}}]),r}(L),G=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return c.default(this,r),(a=n.call(this)).upstream=e,a.batchSize=t,a.enableSmallLastBatch=i,a.lastRead=Promise.resolve({value:null,done:!1}),a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> RowMajorBatch")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=[];case 1:if(!(r.length<e.batchSize)){t.next=12;break}return t.next=4,e.upstream.next();case 4:if(!(a=t.sent).done){t.next=9;break}if(!(e.enableSmallLastBatch&&r.length>0)){t.next=8;break}return t.abrupt("return",{value:r,done:!1});case 8:return t.abrupt("return",{value:null,done:!0});case 9:r.push(a.value),t.next=1;break;case 12:return t.abrupt("return",{value:r,done:!1});case 13:case"end":return t.stop()}}),n)})))()}}]),r}(L),H=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.predicate=t,a.lastRead=Promise.resolve({value:null,done:!1}),a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Filter")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){var r;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,e.upstream.next();case 3:if(!(r=t.sent).done&&!e.predicate(r.value)){t.next=6;break}return t.abrupt("return",r);case 6:m.dispose(r.value),t.next=0;break;case 9:case"end":return t.stop()}}),n)})))()}}]),r}(L),q=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Map")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a,i,o,u,s,c,l,f,d;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.upstream.next();case 2:if(!(r=t.sent).done){t.next=5;break}return t.abrupt("return",{value:null,done:!0});case 5:for(a=w.getTensorsInContainer(r.value),i=e.transform(r.value),o=w.getTensorsInContainer(i),u=!0,s=!1,c=void 0,t.prev=9,l=a[Symbol.iterator]();!(u=(f=l.next()).done);u=!0)d=f.value,w.isTensorInList(d,o)||d.dispose();t.next=17;break;case 13:t.prev=13,t.t0=t.catch(9),s=!0,c=t.t0;case 17:t.prev=17,t.prev=18,u||null==l.return||l.return();case 20:if(t.prev=20,!s){t.next=23;break}throw c;case 23:return t.finish(20);case 24:return t.finish(17);case 25:return t.abrupt("return",{value:i,done:!1});case 26:case"end":return t.stop()}}),n,null,[[9,13,17,25],[18,,20,24]])})))()}}]),r}(L),J=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.handler=t,a.count=0,a.lastRead=Promise.resolve({value:null,done:!1}),a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> handleErrors")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=1,t.next=4,e.upstream.next();case 4:return t.abrupt("return",t.sent);case 7:if(t.prev=7,t.t0=t.catch(1),e.handler(t.t0)){t.next=11;break}return t.abrupt("return",{value:null,done:!0});case 11:t.next=0;break;case 13:case"end":return t.stop()}}),n,null,[[1,7]])})))()}}]),r}(L),K=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> AsyncMap")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a,i,o,u,s,c,l,f,d;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.upstream.next();case 2:if(!(r=t.sent).done){t.next=5;break}return t.abrupt("return",{value:null,done:!0});case 5:return a=w.getTensorsInContainer(r.value),t.next=8,e.transform(r.value);case 8:for(i=t.sent,o=w.getTensorsInContainer(i),u=!0,s=!1,c=void 0,t.prev=11,l=a[Symbol.iterator]();!(u=(f=l.next()).done);u=!0)d=f.value,w.isTensorInList(d,o)||d.dispose();t.next=19;break;case 15:t.prev=15,t.t0=t.catch(11),s=!0,c=t.t0;case 19:t.prev=19,t.prev=20,u||null==l.return||l.return();case 22:if(t.prev=22,!s){t.next=25;break}throw c;case 25:return t.finish(22);case 26:return t.finish(19);case 27:return t.abrupt("return",{value:i,done:!1});case 28:case"end":return t.stop()}}),n,null,[[11,15,19,27],[20,,22,26]])})))()}}]),r}(L),X=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(){var e;return c.default(this,r),(e=n.call(this)).outputQueue=new I,e.lastRead=Promise.resolve({value:null,done:!1}),e}return l.default(r,[{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==e.outputQueue.length()){t.next=7;break}return t.next=3,e.pump();case 3:if(t.sent){t.next=5;break}return t.abrupt("return",{value:null,done:!0});case 5:t.next=0;break;case 7:return t.abrupt("return",{value:e.outputQueue.shift(),done:!1});case 8:case"end":return t.stop()}}),n)})))()}}]),r}(L),Y=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).upstream=e,a.transform=t,a}return l.default(r,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Flatmap")}},{key:"pump",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a,i,o,u,s,c,l,f,d;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.upstream.next();case 2:if(!(r=t.sent).done){t.next=5;break}return t.abrupt("return",!1);case 5:for(a=w.getTensorsInContainer(r.value),i=e.transform(r.value),o=w.getTensorsInContainer(i),e.outputQueue.pushAll(i),u=!0,s=!1,c=void 0,t.prev=10,l=a[Symbol.iterator]();!(u=(f=l.next()).done);u=!0)d=f.value,w.isTensorInList(d,o)||d.dispose();t.next=18;break;case 14:t.prev=14,t.t0=t.catch(10),s=!0,c=t.t0;case 18:t.prev=18,t.prev=19,u||null==l.return||l.return();case 21:if(t.prev=21,!s){t.next=24;break}throw c;case 24:return t.finish(21);case 25:return t.finish(18);case 26:return t.abrupt("return",!0);case 27:case"end":return t.stop()}}),n,null,[[10,14,18,26],[19,,21,25]])})))()}}]),r}(X),Q=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a;return c.default(this,r),(a=n.call(this)).baseErrorHandler=t,a.lastRead=null,a.iterator=null,a.moreIterators=e,a}return l.default(r,[{key:"summary",value:function(){return"".concat("TODO: fill in upstream of chained summaries"," -> Chained")}},{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.readFromChain(e.lastRead),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"readFromChain",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a,i;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e;case 2:if(null!=n.iterator){t.next=10;break}return t.next=5,n.moreIterators.next();case 5:if(!(a=t.sent).done){t.next=8;break}return t.abrupt("return",{value:null,done:!0});case 8:n.iterator=a.value,null!=n.baseErrorHandler&&(n.iterator=n.iterator.handleErrors(n.baseErrorHandler));case 10:return t.next=12,n.iterator.next();case 12:if(!(i=t.sent).done){t.next=16;break}return n.iterator=null,t.abrupt("return",n.readFromChain(e));case 16:return t.abrupt("return",i);case 17:case"end":return t.stop()}}),r)})))()}}]),r}(L);!function(e){e[e.FAIL=0]="FAIL",e[e.SHORTEST=1]="SHORTEST",e[e.LONGEST=2]="LONGEST"}(P||(P={}));var Z=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e,r){var a;return c.default(this,n),(a=t.call(this)).upstream=e,a.bufferSize=r,a.buffer=new _(r),a}return l.default(n,[{key:"summary",value:function(){return"".concat(this.upstream.summary()," -> Prefetch")}},{key:"refill",value:function(){for(;!this.buffer.isFull();){var e=this.upstream.next();this.buffer.push(e)}}},{key:"next",value:function(){return this.refill(),this.buffer.shift()}}]),n}(L),$=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t,a){var i;return c.default(this,r),(i=n.call(this,e,t)).upstream=e,i.windowSize=t,i.upstreamExhausted=!1,i.random=k.alea(a||g.now().toString()),i.lastRead=Promise.resolve({value:null,done:!1}),i}return l.default(r,[{key:"next",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.lastRead=e.lastRead.then((function(){return e.serialNext()})),t.abrupt("return",e.lastRead);case 2:case"end":return t.stop()}}),n)})))()}},{key:"randomInt",value:function(e){return Math.floor(this.random()*e)}},{key:"chooseIndex",value:function(){return this.randomInt(this.buffer.length())}},{key:"serialNext",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.upstreamExhausted||e.refill();case 1:if(e.buffer.isEmpty()){t.next=14;break}return r=e.chooseIndex(),t.next=5,e.buffer.shuffleExcise(r);case 5:if(!(a=t.sent).done){t.next=10;break}e.upstreamExhausted=!0,t.next=12;break;case 10:return e.refill(),t.abrupt("return",a);case 12:t.next=1;break;case 14:return t.abrupt("return",{value:null,done:!0});case 15:case"end":return t.stop()}}),n)})))()}}]),r}(Z),ee=function(){"use strict";function e(){c.default(this,e),this.size=null}return l.default(e,[{key:"batch",value:function(e){var n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this;return g.assert(e>0,(function(){return"batchSize needs to be positive, but it is\n      ".concat(e)})),n=this.size===1/0||null==this.size?this.size:r?Math.ceil(this.size/e):Math.floor(this.size/e),te(f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.iterator();case 2:return t.abrupt("return",t.sent.columnMajorBatch(e,r,ne));case 3:case"end":return t.stop()}}),n)}))),n)}},{key:"concatenate",value:function(e){var n,r=this;return n=this.size===1/0||e.size===1/0?1/0:null!=this.size&&null!=e.size?this.size+e.size:null,te(f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.t0=t.sent,t.next=5,e.iterator();case 5:return t.t1=t.sent,t.abrupt("return",t.t0.concatenate.call(t.t0,t.t1));case 7:case"end":return t.stop()}}),n)}))),n)}},{key:"filter",value:function(e){var n,r=this;return n=this.size===1/0?1/0:null,te(f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.filter((function(t){return m.tidy((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),n)}))),n)}},{key:"forEachAsync",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.forEachAsync(e));case 3:case"end":return t.stop()}}),r)})))()}},{key:"map",value:function(e){var n=this;return te(f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.map((function(t){return m.tidy((function(){return e(t)}))})));case 3:case"end":return t.stop()}}),r)}))),this.size)}},{key:"mapAsync",value:function(e){var n=this;return te(f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.mapAsync(e));case 3:case"end":return t.stop()}}),r)}))),this.size)}},{key:"prefetch",value:function(e){if(null==e)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");var n=this;return te(f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.iterator();case 2:return t.abrupt("return",t.sent.prefetch(e));case 3:case"end":return t.stop()}}),r)}))),this.size)}},{key:"repeat",value:function(e){var n,r=this;return n=null!=this.size&&e>0?this.size*e:0===e?0:null!=this.size&&(void 0===e||e<0)?1/0:null,te(f.default(t(v).mark((function n(){var a;return t(v).wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=M(f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.iterator();case 2:return e.t0=e.sent,e.abrupt("return",{value:e.t0,done:!1});case 4:case"end":return e.stop()}}),e)})))),n.abrupt("return",B(a.take(e)));case 2:case"end":return n.stop()}}),n)}))),n)}},{key:"skip",value:function(e){var n,r=this;return n=null!=this.size&&e>=0&&this.size>=e?this.size-e:null!=this.size&&(this.size<e||void 0===e||e<0)?0:null,te(f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.skip(e));case 3:case"end":return t.stop()}}),n)}))),n)}},{key:"shuffle",value:function(e,n){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(null==e||e<0)throw null==this.size?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError("`Dataset.shuffle()` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for `tf.Tensor`s), consider setting "+"bufferSize to the dataset size (".concat(this.size," elements)"));var a=this,i=k.alea(n||g.now().toString());return te(f.default(t(v).mark((function n(){var o;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=i.int32(),r&&(o+=i.int32()),t.next=4,a.iterator();case 4:return t.abrupt("return",t.sent.shuffle(e,o.toString()));case 5:case"end":return t.stop()}}),n)}))),this.size)}},{key:"take",value:function(e){var n,r=this;return n=null!=this.size&&this.size>e?e:null!=this.size&&this.size<=e?this.size:null,te(f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.iterator();case 2:return t.abrupt("return",t.sent.take(e));case 3:case"end":return t.stop()}}),n)}))),n)}},{key:"toArray",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.size!==1/0){t.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return t.next=4,e.iterator();case 4:return t.abrupt("return",t.sent.toArray());case 5:case"end":return t.stop()}}),n)})))()}},{key:"toArrayForTest",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.size!==1/0){t.next=2;break}throw new Error("Can not convert infinite data stream to array.");case 2:return t.next=4,e.iterator();case 4:return t.abrupt("return",t.sent.toArrayForTest());case 5:case"end":return t.stop()}}),n)})))()}}]),e}();function te(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new(function(r){"use strict";p.default(i,r);var a=h.default(i);function i(){var e;return c.default(this,i),(e=a.call.apply(a,[this].concat(Array.prototype.slice.call(arguments)))).size=n,e}return l.default(i,[{key:"iterator",value:function(){return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e());case 1:case"end":return t.stop()}}),n)})))()}}]),i}(ee))}function ne(e){if(null===e)return null;var t,n=e[0];return null==(t=n)||function(e){return null===e||"object"!=typeof e&&"function"!=typeof e}(t)||Array.isArray(t)||"object"==typeof t&&t instanceof y.Tensor||g.isTypedArray(t)?{value:function(e){if(0===e.length)throw new Error("Can't make a batch of zero elements.");return e[0]instanceof y.Tensor?x.stack(e):b.tensor(e)}(e),recurse:!1}:{value:null,recurse:!0}}ee.MAX_BUFFER_SIZE=1e4,s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");g=s("kglvN");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs"),Symbol("out"),Symbol("field"),Symbol("quote"),Symbol("quoteafterquote"),Symbol("quoteinquote");s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");g=s("kglvN"),b=s("616DT");var re=s("lU3MY");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");var ae=s("5J0XY"),ie=s("bqdMI"),oe=(g=s("kglvN"),s("iq41T"),m=s("P1tXK"),s("j2ViA"));re=s("lU3MY");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("1i51P");c=s("3QOYJ");s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");g=s("kglvN");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");g=s("kglvN"),re=s("lU3MY");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");re=s("lU3MY");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs"),s("1mtJC").Buffer;s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");re=s("lU3MY");s("jbRpz");var ue=s("d4BUr");s("jbRpz");var se=s("cvMH2");g=s("kglvN");s("jbRpz");g=s("kglvN");function ce(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&g.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}var le={kernelName:se.Cos,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;ce(r,"cos");for(var i=a.data.get(r.dataId).values,o=g.sizeFromShape(r.shape),u=new Float32Array(o),s=0;s<o;++s)u[s]=Math.cos(i[s]);return{dataId:a.write(u,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};s("jbRpz");se=s("cvMH2");var fe=s("dITq1"),de=(g=s("kglvN"),{kernelName:se.Dilation2D,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=r.strides,u=r.pad,s=r.dilations,c=n,l=c.data.get(a.dataId).values,f=a.shape.length,d=c.data.get(i.dataId).values,p=i.shape.length,h=fe.computeDilation2DInfo(a.shape,i.shape,o,u,"NHWC",s),v=h.batchSize,m=h.inHeight,y=h.inWidth,x=h.inChannels,b=h.outHeight,k=h.outWidth,w=h.padInfo,A=h.strideHeight,E=h.strideWidth,C=h.filterHeight,S=h.filterWidth,N=h.dilationHeight,T=h.dilationWidth,D=h.outShape,F=g.sizeFromShape(D),O=D.length,_=g.getArrayFromDType(a.dtype,F),I=0;I<v;++I)for(var R=0;R<b;++R)for(var M=R*A-w.top,B=0;B<k;++B)for(var P=B*E-w.left,L=0;L<x;++L){for(var j=Number.MIN_SAFE_INTEGER,z=0;z<C;++z){var U=M+z*N;if(U>=0&&U<m)for(var V=0;V<S;++V){var W=P+V*T;if(W>=0&&W<y){var G=g.locToIndex([I,U,W,L],f,g.computeStrides(a.shape)),H=g.locToIndex([z,V,L],p,g.computeStrides(i.shape)),q=l[G]+d[H];q>j&&(j=q)}}}_[g.locToIndex([I,R,B,L],O,g.computeStrides(D))]=j}return{dataId:c.write(g.toTypedArray(_,a.dtype),D,a.dtype),shape:D,dtype:a.dtype}}});s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");var pe={kernelName:se.Dilation2DBackpropFilter,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,u=r.strides,s=r.pad,c=r.dilations,l=n,f=g.toNestedArray(a.shape,l.data.get(a.dataId).values),d=g.toNestedArray(i.shape,l.data.get(i.dataId).values),p=fe.computeDilation2DInfo(a.shape,i.shape,u,s,"NHWC",c),h=p.batchSize,v=p.inHeight,m=p.inWidth,y=p.inChannels,x=p.outHeight,b=p.outWidth,k=p.padInfo,w=p.strideHeight,A=p.strideWidth,E=p.filterHeight,C=p.filterWidth,S=p.dilationHeight,N=p.dilationWidth,T=p.outShape;g.assert(o.rank===T.length,(function(){return"Error in ".concat(se.Dilation2DBackpropFilter,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var D=g.toNestedArray(T,l.data.get(o.dataId).values),F=g.makeZerosNestedTypedArray(i.shape,i.dtype),O=0;O<h;++O)for(var _=0;_<x;++_)for(var I=_*w-k.top,R=0;R<b;++R)for(var M=R*A-k.left,B=0;B<y;++B){for(var P=Number.MIN_SAFE_INTEGER,L=0,j=0,z=0;z<E;++z){var U=I+z*S;if(U>=0&&U<v)for(var V=0;V<C;++V){var W=M+V*N;if(W>=0&&W<m){var G=f[O][U][W][B]+d[z][V][B];G>P&&(P=G,L=z,j=V)}}}F[L][j][B]+=D[O][_][R][B]}return{dataId:l.write(g.toTypedArray(F,a.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");var he={kernelName:se.Dilation2DBackpropInput,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,o=t.dy,u=r.strides,s=r.pad,c=r.dilations,l=n,f=g.toNestedArray(a.shape,l.data.get(a.dataId).values),d=g.toNestedArray(i.shape,l.data.get(i.dataId).values),p=fe.computeDilation2DInfo(a.shape,i.shape,u,s,"NHWC",c),h=p.batchSize,v=p.inHeight,m=p.inWidth,y=p.inChannels,x=p.outHeight,b=p.outWidth,k=p.padInfo,w=p.strideHeight,A=p.strideWidth,E=p.filterHeight,C=p.filterWidth,S=p.dilationHeight,N=p.dilationWidth,T=p.outShape;g.assert(o.rank===T.length,(function(){return"Error in ".concat(se.Dilation2DBackpropInput,", dy ")+"must have the same rank as output ".concat(T.length,", but got ")+"".concat(o.rank)}));for(var D=g.toNestedArray(T,l.data.get(o.dataId).values),F=g.makeZerosNestedTypedArray(a.shape,a.dtype),O=0;O<h;++O)for(var _=0;_<x;++_)for(var I=_*w-k.top,R=0;R<b;++R)for(var M=R*A-k.left,B=0;B<y;++B){for(var P=Number.MIN_SAFE_INTEGER,L=I<0?0:I,j=M<0?0:M,z=0;z<E;++z){var U=I+z*S;if(U>=0&&U<v)for(var V=0;V<C;++V){var W=M+V*N;if(W>=0&&W<m){var G=f[O][U][W][B]+d[z][V][B];G>P&&(P=G,L=U,j=W)}}}F[O][L][j][B]+=D[O][_][R][B]}return{dataId:l.write(g.toTypedArray(F,a.dtype),a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};s("jbRpz");se=s("cvMH2");s("1i51P");d=s("6vecG");s("jbRpz");g=s("kglvN"),fe=s("dITq1");s("jbRpz");g=s("kglvN"),fe=s("dITq1");function ve(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,a=n.backend,i=r.a,o=r.b,u=a;ce([i,o],e);var s=u.data.get(i.dataId).values,c=u.data.get(o.dataId).values,l=d.default(t(i.shape,o.shape,s,c,i.dtype),2),f=l[0],p=l[1];return{dataId:u.write(f,p,i.dtype),shape:p,dtype:i.dtype}}}}function ge(e){return function(t,n,r,a,i){var o=function(t){var n=g.indexToLoc(t,s,c),i=n.slice(-d);m.forEach((function(e){return i[e]=0}));var o=g.locToIndex(i,d,h),u=n.slice(-p);y.forEach((function(e){return u[e]=0}));var l=g.locToIndex(u,p,v);f[t]=e(r[o],a[l])},u=fe.assertAndGetBroadcastShape(t,n),s=u.length,c=g.computeStrides(u),l=g.sizeFromShape(u),f=g.getTypedArrayFromDType(i,l),d=t.length,p=n.length,h=g.computeStrides(t),v=g.computeStrides(n),m=fe.getBroadcastDims(t,u),y=fe.getBroadcastDims(n,u);if(m.length+y.length===0)for(var x=0;x<f.length;++x)f[x]=e(r[x%r.length],a[x%a.length]);else for(var b=0;b<f.length;++b)o(b);return[f,u]}}var me=ge((function(e,t){return e/t})),ye=ve(se.Div,me);s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),g=s("kglvN");var xe={kernelName:se.FlipLeftRight,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=(e.attrs,e.backend),r=t.image,a=n,i=g.getTypedArrayFromDType(r.dtype,g.sizeFromShape(r.shape)),o=d.default(r.shape,4),u=o[0],s=o[1],c=o[2],l=o[3],f=a.data.get(r.dataId).values,p=0;p<u;p++)for(var h=p*c*s*l,v=0;v<s;v++)for(var m=v*(c*l),y=0;y<c;y++)for(var x=y*l,b=0;b<l;b++){var k=[u,v,y,b][2],w=Math.round(c-k),A=h+m+x+b,E=f[A];if(w>=0&&w<c)E=f[h+m+w*l+b];i[A]=E}return{dataId:a.write(i,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};s("jbRpz");var be={kernelName:(se=s("cvMH2")).Identity,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}};s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");s("jbRpz");g=s("kglvN");function ke(e,t,n,r){for(var a=g.getTypedArrayFromDType(r,g.sizeFromShape(n)),i=0;i<a.length;++i){for(var o=i*t,u=e[o],s=0;s<t;++s){var c=e[o+s];c>u&&(u=c)}a[i]=u}return a}s("jbRpz");g=s("kglvN");function we(e,t,n,r,a){for(var i=t.length,o=g.sizeFromShape(t),u=g.computeStrides(t),s=g.computeStrides(a),c=g.getTypedArrayFromDType(n,g.sizeFromShape(a)),l=0;l<o;++l){for(var f=g.indexToLoc(l,i,u),d=new Array(f.length),p=0;p<d.length;p++)d[p]=f[r[p]];c[g.locToIndex(d,i,s)]=e[l]}return c}var Ae={kernelName:se.Max,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.reductionIndices,o=n.keepDims,u=r,s=a.shape,c=s.length,l=g.parseAxisParam(i,s),f=l,p=fe.getAxesPermutation(f,c),h=u.data.get(a.dataId).values;if(null!=p){for(var v=new Array(c),m=0;m<v.length;m++)v[m]=s[p[m]];h=we(h,s,a.dtype,p,v),f=fe.getInnerMostAxes(f.length,c),s=v}ce(a,"max"),fe.assertAxesAreInnerMostDims("max",f,c);var y=d.default(fe.computeOutAndReduceShapes(s,f),2),x=y[0],b=y[1],k=ke(h,g.sizeFromShape(b),x,a.dtype),w=u.write(k,x,a.dtype),A=x;o&&(A=fe.expandShapeToKeepDim(x,l));return{dataId:w,shape:A,dtype:a.dtype}}};s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),fe=s("dITq1");s("jbRpz");se=s("cvMH2"),fe=s("dITq1");s("jbRpz");g=s("kglvN");s("jbRpz");var Ee=s("8orDI");function Ce(e,t,n,r,a,i){for(var o=a.strideHeight,u=a.strideWidth,s=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,f=a.effectiveFilterWidth,d=a.padInfo.top,p=a.padInfo.left,h="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=Ee.buffer(a.outShape,n),g=v.values,m=a.outShape[1]*a.outShape[2]*a.outShape[3],y=a.outShape[2]*a.outShape[3],x=a.outShape[3],b=0;b<a.batchSize;++b)for(var k=b*m,w=b*r[0],A=0;A<a.inChannels;++A)for(var E=0;E<a.outHeight;++E)for(var C=E*o-d,S=Math.max(0,C),N=Math.min(a.inHeight,l+C),T=k+E*y,D=0;D<a.outWidth;++D){for(var F=D*u-p,O=Math.max(0,F),_=Math.min(a.inWidth,f+F),I=h,R=0,M=0,B=S;B<N;B+=s){for(var P=w+B*r[1],L=O;L<_;L+=c){var j=e[P+L*r[2]+A];"max"===i&&j>I?I=j:"avg"===i&&(R+=j,M++)}if(isNaN(I))break}g[T+D*x+A]="avg"===i?R/M:I}return v}function Se(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Ee.buffer(r.outShape,"int32"),u=r.strideHeight,s=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,d=r.effectiveFilterWidth,p=r.padInfo.top,h=r.padInfo.left,v=Ee.buffer(t,n,e),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.outHeight;++y){for(var x=y*u-p,b=x;b<0;)b+=c;for(var k=Math.min(r.inHeight,f+x),w=0;w<r.outWidth;++w){for(var A=w*s-h,E=A;E<0;)E+=l;for(var C=Math.min(r.inWidth,d+A),S=Number.NEGATIVE_INFINITY,N=-1,T=b;T<k;T+=c)for(var D=T-x,F=E;F<C;F+=l){var O=F-A,_=v.get(g,T,F,m);_>S&&(S=_,N=a?i?((g*r.inHeight+T)*r.inWidth+F)*r.inChannels+m:(T*r.inWidth+F)*r.inChannels+m:D*d+O)}o.set(N,g,y,w,m)}}return o}var Ne={kernelName:se.MaxPoolWithArgmax,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,u=n.pad,s=n.includeBatchInIndex,c=r;ce(a,"MaxPoolWithArgmax");var l=c.data.get(a.dataId).values,f=fe.computePool2DInfo(a.shape,i,o,[1,1],u),p=d.default(function(e,t,n,r,a){var i=Ce(e,0,n,g.computeStrides(t),a,"max"),o=Se(e,t,n,a,!0,r);return[i.values,o.values]}(l,a.shape,a.dtype,s,f),2),h=p[0],v=p[1],m=c.write(h,f.outShape,a.dtype),y=c.write(v,f.outShape,a.dtype);return[{dataId:m,shape:f.outShape,dtype:a.dtype},{dataId:y,shape:f.outShape,dtype:"int32"}]}};s("jbRpz");var Te=s("289sH");se=s("cvMH2");s("jbRpz");Te=s("289sH"),se=s("cvMH2");var De=Te.nonMaxSuppressionV4Impl,Fe={kernelName:se.NonMaxSuppressionV4,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize,l=n;ce(a,"NonMaxSuppressionPadded");var f=l.data.get(a.dataId).values,d=l.data.get(i.dataId).values,p=De(f,d,o,u,s,c);return[p.selectedIndices,p.validOutputs]}};s("jbRpz");Te=s("289sH"),se=s("cvMH2");s("jbRpz");Te=s("289sH"),se=s("cvMH2");var Oe=Te.nonMaxSuppressionV5Impl,_e={kernelName:se.NonMaxSuppressionV5,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma,l=n;ce(a,"NonMaxSuppressionWithScore");var f=l.data.get(a.dataId).values,d=l.data.get(i.dataId).values,p=Oe(f,d,o,u,s,c);return[p.selectedIndices,p.selectedScores]}};s("jbRpz");g=s("kglvN");var Ie={kernelName:(se=s("cvMH2")).PadV2,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,o=r.constantValue;ce(a,"pad");var u=i.map((function(e,t){return e[0]+a.shape[t]+e[1]})),s=i.map((function(e){return e[0]})),c=n.data.get(a.dataId).values,l=g.sizeFromShape(a.shape),f=a.shape.length,d=g.computeStrides(a.shape),p=g.sizeFromShape(u),h=u.length,v=g.computeStrides(u),m=g.getTypedArrayFromDType(a.dtype,p);0!==o&&m.fill(o);for(var y=0;y<l;y++){var x=g.indexToLoc(y,f,d).map((function(e,t){return e+s[t]}));m[g.locToIndex(x,h,v)]=c[y]}return{dataId:n.write(m,u,a.dtype),shape:u,dtype:a.dtype}}};function Re(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape;return n.incRef(a.dataId),{dataId:a.dataId,shape:i,dtype:a.dtype}}s("jbRpz");var Me={kernelName:(se=s("cvMH2")).Reshape,backendName:"cpu",kernelFunc:Re};s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");var Be={kernelName:se.RotateWithOffset,backendName:"cpu",kernelFunc:function(e){for(var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,u=n.center,s=r,c=g.getTypedArrayFromDType(a.dtype,g.sizeFromShape(a.shape)),l=d.default(a.shape,4),f=l[0],p=l[1],h=l[2],v=l[3],m=d.default(fe.getImageCenter(u,p,h),2),y=m[0],x=m[1],b=Math.sin(i),k=Math.cos(i),w=s.data.get(a.dataId).values,A=0;A<f;A++)for(var E=A*h*p*v,C=0;C<p;C++)for(var S=C*(h*v),N=0;N<h;N++)for(var T=N*v,D=0;D<v;D++){var F=[f,C,N,D],O=F[2],_=F[1],I=(O-y)*k-(_-x)*b,R=(O-y)*b+(_-x)*k;I=Math.round(I+y),R=Math.round(R+x);var M=o;if("number"!=typeof o&&(M=3===D?255:o[D]),I>=0&&I<h&&R>=0&&R<p)M=w[E+R*(h*v)+I*v+D];c[E+S+T+D]=M}return{dataId:s.write(c,a.shape,a.dtype),shape:a.shape,dtype:a.dtype}}};s("1i51P");var Pe=s("9M1dW");s("jbRpz");g=s("kglvN"),fe=s("dITq1"),se=s("cvMH2");function Le(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm;ce(a,"transpose");for(var o=a.shape.length,u=new Array(o),s=0;s<u.length;s++)u[s]=a.shape[i[s]];var c=we(r.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:r.write(c,u,a.dtype),shape:u,dtype:a.dtype}}s("jbRpz");var je={kernelName:(se=s("cvMH2")).Transpose,backendName:"cpu",kernelFunc:Le};var ze={kernelName:se.SpaceToBatchND,backendName:"cpu",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.blockShape,u=a.paddings;ce([i],"spaceToBatchND");var s=g.sizeFromShape(o),c=[[0,0]];(t=c).push.apply(t,Pe.default(u));for(var l=1+o.length;l<i.shape.length;++l)c.push([0,0]);var f=Ie.kernelFunc({inputs:{x:i},backend:r,attrs:{paddings:c,constantValue:0}}),d=fe.getReshaped(f.shape,o,s,!1),p=fe.getPermuted(d.length,o.length,!1),h=fe.getReshapedPermuted(f.shape,o,s,!1),v=Re({inputs:{x:f},backend:r,attrs:{shape:d}}),m=Le({inputs:{x:v},backend:r,attrs:{perm:p}}),y=Re({inputs:{x:m},backend:r,attrs:{shape:h}});return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(m),y}};s("jbRpz");var Ue={kernelName:(se=s("cvMH2")).Square,backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;ce(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),u=0;u<i.length;++u){var s=i[u];o[u]=s*s}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};s("jbRpz");se=s("cvMH2");var Ve=ge((function(e,t){var n=e-t;return n*n})),We=ve(se.SquaredDifference,Ve),Ge=[le,de,he,pe,ye,xe,be,Ne,Ae,Fe,_e,Ie,Me,Be,ze,Ue,We,je],He=!0,qe=!1,Je=void 0;try{for(var Ke=Ge[Symbol.iterator]();!(He=(kr=Ke.next()).done);He=!0){var Xe=kr.value;ue.registerKernel(Xe)}}catch(e){qe=!0,Je=e}finally{try{He||null==Ke.return||Ke.return()}finally{if(qe)throw Je}}s("jbRpz");m=s("P1tXK");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ");var Ye=s("jZS3C");l=s("2tuUj"),f=s("e3nFV"),Pe=s("9M1dW"),d=s("6vecG"),F=s("kRKWT"),O=s("eYQ8O"),v=s("40Zzs");s("jbRpz");Te=s("289sH");var Qe=s("lvUHp"),Ze=(m=s("P1tXK"),re=s("lU3MY"),fe=s("dITq1"),g=s("kglvN"),Ee=s("8orDI"),s("aK0eq")),$e=(b=s("616DT"),s("2acG6")),et=s("hXj3N"),tt=s("3IcUj"),nt=s("bftEy"),rt=s("aTTkI"),at=s("avJI0"),it=s("6baO0"),ot=s("ilMKa"),ut=s("iuFae"),st=(x=s("biSQf"),s("9PS5J")),ct=s("a0S6X"),lt=s("etmQx");ie=s("bqdMI"),y=s("4JvjV");s("jbRpz");Te=s("289sH"),Qe=s("lvUHp"),m=s("P1tXK"),re=s("lU3MY"),fe=s("dITq1"),g=s("kglvN"),Ee=s("8orDI"),Ze=s("aK0eq"),b=s("616DT"),$e=s("2acG6"),et=s("hXj3N"),tt=s("3IcUj"),nt=s("bftEy"),rt=s("aTTkI"),at=s("avJI0"),it=s("6baO0"),ot=s("ilMKa"),ut=s("iuFae"),x=s("biSQf"),st=s("9PS5J"),ct=s("a0S6X"),lt=s("etmQx"),ie=s("bqdMI"),y=s("4JvjV"),k=s("1Rhbk");var ft=Te.nonMaxSuppressionV3Impl,dt=Te.split,pt=Te.tile,ht=Te.topkImpl,vt=Te.whereImpl;function gt(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation ".concat(n," has not been implemented for the CPU backend."))}var mt=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(){var e;return c.default(this,r),(e=n.call(this)).blockSize=48,e.firstUse=!0,e.data=new Qe.DataStorage(Ye.default(e),m.engine()),e}return l.default(r,[{key:"write",value:function(e,t,n){this.firstUse&&(this.firstUse=!1,re.env().get("IS_NODE")&&fe.warn("\n============================\nHi there . Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n,refCount:1}),r}},{key:"incRef",value:function(e){this.data.get(e).refCount++}},{key:"decRef",value:function(e){this.data.has(e)&&this.data.get(e).refCount--}},{key:"move",value:function(e,t,n,r){this.data.set(e,{values:t,dtype:r,refCount:1})}},{key:"numDataIds",value:function(){return this.data.numDataIds()}},{key:"read",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",n.readSync(e));case 1:case"end":return t.stop()}}),r)})))()}},{key:"readSync",value:function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;if("complex64"===n){var a=this.readSync(r.real.dataId),i=this.readSync(r.imag.dataId);return fe.mergeRealAndImagArrays(a,i)}return this.data.get(e).values}},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return g.decodeString(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return Ee.buffer(e.shape,e.dtype,n)}},{key:"makeOutput",value:function(e,t,n){var r=this.write(e,t,n);return m.engine().makeTensorFromDataId(r,t,n,this)}},{key:"disposeData",value:function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}}},{key:"disposeIntermediateTensorInfo",value:function(e){var t=e.dataId;if(this.data.has(t)){var n=this.data.get(t);n.refCount--,n.refCount<1&&this.disposeData(t)}}},{key:"time",value:function(e){return f.default(t(v).mark((function n(){var r,a;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=g.now(),e(),a=g.now()-r,t.abrupt("return",{kernelMs:a});case 4:case"end":return t.stop()}}),n)})))()}},{key:"memory",value:function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}},{key:"complex",value:function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:m.engine().keep(e.clone()),imag:m.engine().keep(t.clone())},n}},{key:"real",value:function(e){return this.data.get(e.dataId).complexTensors.real.clone()}},{key:"imag",value:function(e){return this.data.get(e.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(e,t,n){if(ce(e,"slice"),Ze.isSliceContinous(e.shape,t,n)){var r=Ze.computeFlatOffset(t,e.strides),a=g.sizeFromShape(n),i=this.readSync(e.dataId);return b.tensor(i.subarray(r,r+a),n,e.dtype)}for(var o=Ee.buffer(n,e.dtype),u=this.bufferSync(e),s=0;s<o.size;++s){var c,l=o.indexToLoc(s).map((function(e,n){return e+t[n]}));o.values[s]=(c=u).get.apply(c,Pe.default(l))}return o.toTensor()}},{key:"stridedSlice",value:function(e,t,n,r){ce(e,"stridedSlice");var a=Ze.computeOutShape(t,n,r);if(a.some((function(e){return 0===e})))return b.tensor([],a);for(var i=Ee.buffer(a,e.dtype),o=this.bufferSync(e),u=0;u<i.size;u++){for(var s,c,l=i.indexToLoc(u),f=new Array(l.length),d=0;d<f.length;d++)f[d]=l[d]*r[d]+t[d];(c=i).set.apply(c,[(s=o).get.apply(s,Pe.default(f))].concat(Pe.default(l)))}return i.toTensor()}},{key:"diag",value:function(e){for(var t=this.readSync(e.dataId),n=Ee.buffer([e.size,e.size],e.dtype),r=n.values,a=0;a<t.length;a++)r[a*e.size+a]=t[a];return n.toTensor()}},{key:"unstack",value:function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),u=e.shape.slice();u[t]=1;for(var s=new Array(n),c=0;c<s.length;c++)o[t]=c,s[c]=this.slice(e,o,u).reshape(r);return s}},{key:"reverse",value:function(e,t){var n=function(n){var i,o,u=r.indexToLoc(n),s=u.slice();t.forEach((function(t){return s[t]=e.shape[t]-1-s[t]})),(o=r).set.apply(o,[(i=a).get.apply(i,Pe.default(s))].concat(Pe.default(u)))};ce(e,"reverse");for(var r=Ee.buffer(e.shape,e.dtype),a=this.bufferSync(e),i=0;i<r.size;i++)n(i);return r.toTensor()}},{key:"concat",value:function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return $e.real(e)})),r=e.map((function(e){return et.imag(e)}));return tt.complex(this.concat(n,t),this.concat(r,t))}var a=e.map((function(e){var n=g.sizeFromShape(e.shape.slice(t));return e.as2D(-1,n)})),i=fe.computeOutShape(a.map((function(e){return e.shape})),1),o=Ee.buffer(i,e[0].dtype).values;if(1===a[0].shape[0]){var u=this,s=0;a.forEach((function(e){o.set(u.readSync(e.dataId),s),s+=e.size}))}else{var c=this,l=0;a.forEach((function(e){for(var t=c.readSync(e.dataId),n=0,r=0;r<e.shape[0];++r)for(var a=r*i[1]+l,u=0;u<e.shape[1];++u)o[a+u]=t[n++];l+=e.shape[1]}))}var f=fe.computeOutShape(e.map((function(e){return e.shape})),t);return b.tensor(o,f,e[0].dtype)}},{key:"neg",value:function(e){return ce(e,"neg"),this.multiply(nt.scalar(-1),e)}},{key:"add",value:function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,rt.upcastType(e.dtype,t.dtype),(function(e,t){return e+t}))}},{key:"addN",value:function(e){var t=this;ce(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=Ee.buffer(e[0].shape,e[0].dtype),a=r.values,i=0;i<e.length;i++)for(var o=n[i],u=0;u<a.length;u++)a[u]+=o[u];return r.toTensor()}},{key:"softmax",value:function(e,t){var n=g.parseAxisParam([t],e.shape),r=at.max(e,n),a=fe.expandShapeToKeepDim(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),u=this.sum(o,n).reshape(a);return it.div(o,u)}},{key:"subtract",value:function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,rt.upcastType(e.dtype,t.dtype),(function(e,t){return e-t}))}},{key:"pow",value:function(e,t){return ce([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))}},{key:"batchMatMul",value:function(e,t,n,r){ce([e,t],"matMul");for(var a=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],u=e.shape[0],s=this.readSync(e.dataId),c=this.readSync(t.dataId),l=d.default(n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],3),f=l[0],p=l[1],h=l[2],v=d.default(r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],3),g=v[0],m=v[1],y=v[2],x=i*o,b=Ee.buffer([u,i,o],e.dtype),k=b.values,w=this.blockSize,A=0;A<u;A++)for(var E=0;E<i;E+=w)for(var C=0;C<o;C+=w)for(var S=0;S<a;S+=w)for(var N=Math.min(E+w,i),T=Math.min(C+w,o),D=Math.min(S+w,a),F=E;F<N;F++)for(var O=C;O<T;O++){for(var _=0,I=S;I<D;I++)_+=s[A*f+F*p+I*h]*c[I*g+O*m+A*y];k[A*x+(F*o+O)]+=_}return b.toTensor()}},{key:"fusedBatchMatMul",value:function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,u=e.preluActivationWeights,s=this.batchMatMul(t,n,r,a);return i&&(s=this.add(s,i)),o&&(s=gt(this,s,o,u)),s}},{key:"multiply",value:function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,rt.upcastType(e.dtype,t.dtype),(function(e,t){return e*t}))}},{key:"floorDiv",value:function(e,t){ce([e,t],"floorDiv");return this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))}},{key:"sum",value:function(e,t){ce(e,"sum"),fe.assertAxesAreInnerMostDims("sum",t,e.rank);for(var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=rt.upcastType(e.dtype,"int32"),o=ot.zeros(r,i),u=g.sizeFromShape(a),s=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<s.length;++l){for(var f=l*u,p=0,h=0;h<u;++h)p+=c[f+h];s[l]=p}return o}},{key:"prod",value:function(e,t){ce(e,"sum");for(var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=rt.upcastType(e.dtype,"int32"),o=ot.zeros(r,i),u=g.sizeFromShape(a),s=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<s.length;++l){for(var f=l*u,p=1,h=0;h<u;++h)p*=c[f+h];s[l]=p}return o}},{key:"unsortedSegmentSum",value:function(e,t,n){ce(e,"unsortedSegmentSum");for(var r=[],a=e.rank-t.rank,i=0;i<a;++i)t=t.expandDims(i+1);for(var o=0;o<n;++o){var u=nt.scalar(o,"int32"),s=ut.equal(u,t).asType("float32").mul(e).sum(0);r.push(s)}return x.stack(r)}},{key:"argMin",value:function(e,t){ce(e,"argMin");var n=[t];fe.assertAxesAreInnerMostDims("argMin",n,e.rank);for(var r=d.default(fe.computeOutAndReduceShapes(e.shape,n),2),a=r[0],i=r[1],o=ot.zeros(a,"int32"),u=g.sizeFromShape(i),s=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<s.length;++l){for(var f=l*u,p=c[f],h=0,v=0;v<u;++v){var m=c[f+v];m<p&&(p=m,h=v)}s[l]=h}return o}},{key:"argMax",value:function(e,t){ce(e,"argMax");var n=[t];fe.assertAxesAreInnerMostDims("argMax",n,e.rank);for(var r=d.default(fe.computeOutAndReduceShapes(e.shape,n),2),a=r[0],i=r[1],o=ot.zeros(a,"int32"),u=g.sizeFromShape(i),s=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<s.length;++l){for(var f=l*u,p=c[f],h=0,v=0;v<u;++v){var m=c[f+v];m>p&&(p=m,h=v)}s[l]=h}return o}},{key:"cumsum",value:function(e,t,n,r){if(ce(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis=".concat(e.rank-1," ")+"but got axis=".concat(t));for(var a=rt.upcastType(e.dtype,"int32"),i=ot.zeros(e.shape,a),o=this.readSync(i.dataId),u=this.readSync(e.dataId),s=e.shape[e.rank-1],c=r?function(e,t){return e+s-t-1}:function(e,t){return e+t},l=0;l<u.length;l+=s)for(var f=0;f<s;f++){var d=c(l,f);if(0===f)o[d]=n?0:u[d];else{var p=c(l,f-1);o[d]=n?u[p]+o[p]:u[d]+o[p]}}return i}},{key:"equal",value:function(e,t){return ce([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))}},{key:"notEqual",value:function(e,t){return ce([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))}},{key:"less",value:function(e,t){return ce([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))}},{key:"lessEqual",value:function(e,t){return ce([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))}},{key:"greater",value:function(e,t){return ce([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))}},{key:"greaterEqual",value:function(e,t){return ce([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))}},{key:"logicalNot",value:function(e){ce(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")}},{key:"logicalAnd",value:function(e,t){return ce([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))}},{key:"logicalOr",value:function(e,t){return ce([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))}},{key:"select",value:function(e,t,n){ce([e,t,n],"select");for(var r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=this.readSync(n.dataId),o=ot.zeros(t.shape,rt.upcastType(t.dtype,n.dtype)),u=this.readSync(o.dataId),s=0,c=0===e.rank||e.rank>1||1===t.rank?1:g.sizeFromShape(t.shape.slice(1)),l=0;l<r.length;l++)for(var f=0;f<c;f++)1===r[l]?u[s++]=a[l]:u[s++]=i[l];return o}},{key:"where",value:function(e){ce([e],"where");var t=this.readSync(e.dataId);return vt(e.shape,t)}},{key:"topk",value:function(e,t,n){ce(e,"topk");var r=this.readSync(e.dataId);return ht(r,e.shape,e.dtype,t,n)}},{key:"min",value:function(e,t){ce(e,"min"),fe.assertAxesAreInnerMostDims("min",t,e.rank);for(var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=ot.zeros(r,e.dtype),o=g.sizeFromShape(a),u=this.readSync(i.dataId),s=this.readSync(e.dataId),c=0;c<u.length;++c){for(var l=c*o,f=s[l],p=0;p<o;++p){var h=s[l+p];h<f&&(f=h)}u[c]=f}return i}},{key:"minimum",value:function(e,t){return ce([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))}},{key:"mod",value:function(e,t){return ce([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))}},{key:"maximum",value:function(e,t){return ce([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))}},{key:"all",value:function(e,t){ce(e,"all"),fe.assertAxesAreInnerMostDims("all",t,e.rank);for(var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=ot.zeros(r,e.dtype),o=g.sizeFromShape(a),u=this.readSync(i.dataId),s=this.readSync(e.dataId),c=0;c<u.length;++c){for(var l=c*o,f=s[l],p=0;p<o;++p){var h=s[l+p];f=f&&h}u[c]=f}return i}},{key:"any",value:function(e,t){ce(e,"any"),fe.assertAxesAreInnerMostDims("any",t,e.rank);for(var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=ot.zeros(r,e.dtype),o=g.sizeFromShape(a),u=this.readSync(i.dataId),s=this.readSync(e.dataId),c=0;c<u.length;++c){for(var l=c*o,f=s[l],p=0;p<o;++p){var h=s[l+p];f=f||h}u[c]=f}return i}},{key:"squaredDifference",value:function(e,t){return ce([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))}},{key:"ceil",value:function(e){ce(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"floor",value:function(e){ce(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"sign",value:function(e){ce(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")}},{key:"isNaN",value:function(e){ce(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")}},{key:"isInf",value:function(e){ce(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")}},{key:"isFinite",value:function(e){ce(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")}},{key:"round",value:function(e){ce(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=Math.floor(t[r]);t[r]-a<.5?n[r]=Math.floor(t[r]):t[r]-a>.5?n[r]=Math.ceil(t[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,e.shape,"float32")}},{key:"exp",value:function(e){ce(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"expm1",value:function(e){ce(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")}},{key:"log",value:function(e){ce(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log(a)}return this.makeOutput(n,e.shape,"float32")}},{key:"log1p",value:function(e){ce(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log1p(a)}return this.makeOutput(n,e.shape,"float32")}},{key:"sqrt",value:function(e){ce(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")}},{key:"rsqrt",value:function(e){ce(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")}},{key:"reciprocal",value:function(e){ce(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")}},{key:"linear",value:function(e){return e}},{key:"relu",value:function(e){ce(e,"relu");for(var t=ot.zeros(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return t}},{key:"relu6",value:function(e){ce(e,"relu");for(var t=ot.zeros(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return t}},{key:"prelu",value:function(e,t){return ce([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))}},{key:"elu",value:function(e){ce(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(t,e.shape,"float32")}},{key:"eluDer",value:function(e,t){ce([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,t.shape,"float32")}},{key:"selu",value:function(e){ce(e,"selu");for(var t=fe.SELU_SCALEALPHA,n=fe.SELU_SCALE,r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>=0?n*o:t*(Math.exp(o)-1)}return this.makeOutput(r,e.shape,"float32")}},{key:"clip",value:function(e,t,n){ce(e,"clip");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<t?t:o}return this.makeOutput(r,e.shape,e.dtype)}},{key:"abs",value:function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"complexAbs",value:function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var a=n[2*r],i=n[2*r+1];t[r]=Math.hypot(a,i)}return this.makeOutput(t,e.shape,"float32")}},{key:"int",value:function(e){ce(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")}},{key:"sigmoid",value:function(e){ce(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")}},{key:"softplus",value:function(e){ce(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a]>-t,o=r[a]<t,u=Math.exp(r[a]),s=void 0;s=o?u:i?r[a]:Math.log(1+u),n[a]=s}return this.makeOutput(n,e.shape,"float32")}},{key:"sin",value:function(e){ce(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"tan",value:function(e){ce(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"asin",value:function(e){ce(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"acos",value:function(e){ce(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"atan",value:function(e){ce(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"atan2",value:function(e,t){return ce([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))}},{key:"sinh",value:function(e){ce(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"cosh",value:function(e){ce(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"tanh",value:function(e){ce(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=g.tanh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"asinh",value:function(e){ce(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"acosh",value:function(e){ce(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"atanh",value:function(e){ce(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")}},{key:"erf",value:function(e){ce(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=fe.ERF_P,a=fe.ERF_A1,i=fe.ERF_A2,o=fe.ERF_A3,u=fe.ERF_A4,s=fe.ERF_A5,c=0;c<n.length;++c){var l=Math.sign(n[c]),f=Math.abs(n[c]),d=1/(1+r*f);t[c]=l*(1-((((s*d+u)*d+o)*d+i)*d+a)*d*Math.exp(-f*f))}return this.makeOutput(t,e.shape,"float32")}},{key:"step",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;ce(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")}},{key:"fusedConv2d",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,u=this.conv2d(t,n,r);return a&&(u=this.add(u,a)),i&&(u=gt(this,u,i,o)),u}},{key:"conv2d",value:function(e,t,n){ce([e,t],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,u=n.padInfo.left,s=n.padInfo.top,c="channelsLast"===n.dataFormat,l=Ee.buffer(n.outShape,e.dtype),f=e.strides[0],d=c?e.strides[1]:e.strides[2],p=c?e.strides[2]:1,h=c?1:e.strides[1],v=l.strides[0],g=c?l.strides[1]:l.strides[2],m=c?l.strides[2]:1,y=c?1:l.strides[1],x=this.readSync(e.dataId),b=this.readSync(t.dataId),k=l.values,w=0;w<n.batchSize;++w)for(var A=w*f,E=w*v,C=0;C<n.outHeight;++C)for(var S=E+C*g,N=C*n.strideHeight-s,T=0;T<r;T++){var D=N+T*i;if(!(D<0||D>=n.inHeight))for(var F=T*t.strides[0],O=A+D*d,_=0;_<n.outWidth;++_)for(var I=S+_*m,R=_*n.strideWidth-u,M=0;M<a;M++){var B=R+M*o;if(!(B<0||B>=n.inWidth))for(var P=O+B*p,L=F+M*t.strides[1],j=0;j<n.inChannels;++j){for(var z=x[P+j*h],U=0;U<n.outChannels;++U)k[I+U*y]+=z*b[L+U];L+=n.outChannels}}}return l.toTensor()}},{key:"conv3d",value:function(e,t,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,u=n.dilationHeight,s=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,f=n.padInfo.top,d=Ee.buffer(n.outShape,e.dtype),p=this.readSync(e.dataId),h=this.readSync(t.dataId),v=d.values,g=0;g<n.batchSize;++g)for(var m=g*e.strides[0],y=g*d.strides[0],x=0;x<n.outDepth;++x)for(var b=y+x*d.strides[1],k=x*n.strideDepth-c,w=0;w<r;w++){var A=k+w*o;if(!(A<0||A>=n.inDepth))for(var E=w*t.strides[0],C=m+A*e.strides[1],S=0;S<n.outHeight;++S)for(var N=b+S*d.strides[2],T=S*n.strideHeight-f,D=0;D<a;D++){var F=T+D*u;if(!(F<0||F>=n.inHeight))for(var O=E+D*t.strides[1],_=C+F*e.strides[2],I=0;I<n.outWidth;++I)for(var R=N+I*n.outChannels,M=I*n.strideWidth-l,B=0;B<i;B++){var P=M+B*s;if(!(P<0||P>=n.inWidth))for(var L=O+B*t.strides[2],j=_+P*n.inChannels,z=L,U=0;U<n.inChannels;++U){for(var V=p[j+U],W=0;W<n.outChannels;++W)v[R+W]+=V*h[z+W];z+=n.outChannels}}}}return d.toTensor()}},{key:"conv2dDerInput",value:function(e,t,n){ce([e,t],"conv2dDerInput");for(var r=Ee.buffer(n.inShape,"float32"),a=r.values,i=this.readSync(e.dataId),o=this.readSync(t.dataId),u=d.default(t.strides,3),s=u[0],c=u[1],l=u[2],f=n.batchSize,p=n.filterHeight,h=n.filterWidth,v=n.inChannels,g=n.inHeight,m=n.inWidth,y=n.outChannels,x=n.outHeight,b=n.outWidth,k=n.strideHeight,w=n.strideWidth,A=n.dataFormat,E=p-1-n.padInfo.top,C=h-1-n.padInfo.left,S="channelsLast"===A,N=r.strides[0],T=S?r.strides[1]:r.strides[2],D=S?r.strides[2]:1,F=S?1:r.strides[1],O=e.strides[0],_=S?e.strides[1]:e.strides[2],I=S?e.strides[2]:1,R=S?1:e.strides[1],M=0;M<f;++M)for(var B=0;B<v;++B)for(var P=0;P<g;++P)for(var L=P-E,j=Math.max(0,Math.ceil(L/k)),z=Math.min(x,(p+L)/k),U=0;U<m;++U){for(var V=U-C,W=Math.max(0,Math.ceil(V/w)),G=Math.min(b,(h+V)/w),H=0,q=j;q<z;++q)for(var J=q*k-L,K=W;K<G;++K)for(var X=O*M+_*q+I*K,Y=s*(p-1-J)+c*(h-1-(K*w-V))+l*B,Q=0;Q<y;++Q){H+=i[X+R*Q]*o[Y+Q]}a[N*M+T*P+D*U+F*B]=H}return r.toTensor()}},{key:"conv3dDerInput",value:function(e,t,n){for(var r=Ee.buffer(n.inShape,"float32"),a=r.values,i=d.default(r.strides,4),o=i[0],u=i[1],s=i[2],c=i[3],l=this.readSync(e.dataId),f=d.default(e.strides,4),p=f[0],h=f[1],v=f[2],g=f[3],m=this.readSync(t.dataId),y=d.default(t.strides,4),x=y[0],b=y[1],k=y[2],w=y[3],A=n.batchSize,E=n.filterDepth,C=n.filterHeight,S=n.filterWidth,N=n.inChannels,T=n.inDepth,D=n.inHeight,F=n.inWidth,O=n.outChannels,_=n.outDepth,I=n.outHeight,R=n.outWidth,M=n.strideDepth,B=n.strideHeight,P=n.strideWidth,L=E-1-n.padInfo.front,j=C-1-n.padInfo.top,z=S-1-n.padInfo.left,U=0;U<A;++U)for(var V=0;V<N;++V)for(var W=0;W<T;++W)for(var G=W-L,H=Math.max(0,Math.ceil(G/M)),q=Math.min(_,(E+G)/M),J=0;J<D;++J)for(var K=J-j,X=Math.max(0,Math.ceil(K/B)),Y=Math.min(I,(C+K)/B),Q=0;Q<F;++Q){for(var Z=Q-z,$=Math.max(0,Math.ceil(Z/P)),ee=Math.min(R,(S+Z)/P),te=0,ne=H;ne<q;++ne)for(var re=ne*M-G,ae=X;ae<Y;++ae)for(var ie=ae*B-K,oe=$;oe<ee;++oe)for(var ue=p*U+h*ne+v*ae+g*oe,se=x*(E-1-re)+b*(C-1-ie)+k*(S-1-(oe*P-Z))+w*V,ce=0;ce<O;++ce){te+=l[ue+ce]*m[se+ce]}a[o*U+u*W+s*J+c*Q+V]=te}return r.toTensor()}},{key:"conv2dDerFilter",value:function(e,t,n){ce([e,t],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,u="channelsLast"===n.dataFormat,s=Ee.buffer(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,f=this.bufferSync(e),d=this.bufferSync(t),p=0;p<i;++p)for(var h=Math.max(0,Math.ceil((l-p)/r)),v=Math.min(n.outHeight,(n.inHeight+l-p)/r),g=0;g<o;++g)for(var m=Math.max(0,Math.ceil((c-g)/a)),y=Math.min(n.outWidth,(n.inWidth+c-g)/a),x=0;x<n.inChannels;++x)for(var b=0;b<n.outChannels;++b){for(var k=0,w=0;w<n.batchSize;++w)for(var A=h;A<v;++A)for(var E=p+A*r-l,C=m;C<y;++C){var S=g+C*a-c;k+=u?f.get(w,E,S,x)*d.get(w,A,C,b):f.get(w,x,E,S)*d.get(w,b,A,C)}s.set(k,p,g,x,b)}return s.toTensor()}},{key:"conv3dDerFilter",value:function(e,t,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,u=n.filterHeight,s=n.filterWidth,c=Ee.buffer(n.filterShape,"float32"),l=c.values,f=d.default(c.strides,4),p=f[0],h=f[1],v=f[2],g=f[3],m=this.readSync(t.dataId),y=d.default(t.strides,4),x=y[0],b=y[1],k=y[2],w=y[3],A=this.readSync(e.dataId),E=d.default(e.strides,4),C=E[0],S=E[1],N=E[2],T=E[3],D=n.padInfo.front,F=n.padInfo.left,O=n.padInfo.top,_=0;_<o;++_)for(var I=Math.max(0,Math.ceil((D-_)/r)),R=Math.min(n.outDepth,(n.inDepth+D-_)/r),M=_*p,B=0;B<u;++B)for(var P=Math.max(0,Math.ceil((O-B)/a)),L=Math.min(n.outHeight,(n.inHeight+O-B)/a),j=B*h+M,z=0;z<s;++z)for(var U=Math.max(0,Math.ceil((F-z)/i)),V=Math.min(n.outWidth,(n.inWidth+F-z)/i),W=z*v+j,G=0;G<n.inChannels;++G)for(var H=G*g+W,q=0;q<n.outChannels;++q){for(var J=0,K=0;K<n.batchSize;++K)for(var X=K*C,Y=K*x,Q=I;Q<R;++Q)for(var Z=(_+Q*r-D)*S+X,$=Q*b+Y,ee=P;ee<L;++ee)for(var te=(B+ee*a-O)*N+Z,ne=ee*k+$,re=U;re<V;++re){var ae=re*w+ne;J+=A[(z+re*i-F)*T+te+G]*m[ae+q]}l[H+q]=J}return c.toTensor()}},{key:"fusedDepthwiseConv2D",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,u=this.depthwiseConv2D(t,n,r);return a&&(u=this.add(u,a)),i&&(u=gt(this,u,i,o)),u}},{key:"depthwiseConv2D",value:function(e,t,n){ce([e,t],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,u=n.padInfo.left,s=n.padInfo.top,c=n.outChannels/n.inChannels,l=Ee.buffer(n.outShape,e.dtype),f=this.readSync(e.dataId),d=this.readSync(t.dataId),p=l.values,h=0;h<n.batchSize;++h)for(var v=h*e.strides[0],g=h*l.strides[0],m=0;m<n.outHeight;++m)for(var y=g+m*l.strides[1],x=m*n.strideHeight-u,b=0;b<r;++b){var k=x+b*i;if(!(k<0||k>=n.inHeight))for(var w=b*t.strides[0],A=v+k*e.strides[1],E=0;E<n.outWidth;++E)for(var C=y+E*l.strides[2],S=E*n.strideWidth-s,N=0;N<a;++N){var T=S+N*o;if(!(T<0||T>=n.inWidth))for(var D=w+N*t.strides[1],F=A+T*n.inChannels,O=C,_=D,I=0;I<n.inChannels;++I){for(var R=f[F+I],M=0;M<c;++M)p[O+M]+=R*d[_+M];O+=c,_+=c}}}return l.toTensor()}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){ce([e,t],"depthwiseConv2DDerInput");for(var r=Ee.buffer(n.inShape,"float32"),a=r.values,i=d.default(r.strides,3),o=i[0],u=i[1],s=i[2],c=this.readSync(e.dataId),l=d.default(e.strides,3),f=l[0],p=l[1],h=l[2],v=this.readSync(t.dataId),g=d.default(t.strides,3),m=g[0],y=g[1],x=g[2],b=n.batchSize,k=n.filterHeight,w=n.filterWidth,A=n.inChannels,E=n.inHeight,C=n.inWidth,S=n.outChannels,N=n.outHeight,T=n.outWidth,D=n.strideHeight,F=n.strideWidth,O=k-1-n.padInfo.top,_=w-1-n.padInfo.left,I=S/A,R=0;R<b;++R)for(var M=0;M<A;++M)for(var B=0;B<E;++B)for(var P=B-O,L=Math.max(0,Math.ceil(P/D)),j=Math.min(N,(k+P)/D),z=0;z<C;++z){for(var U=z-_,V=Math.max(0,Math.ceil(U/F)),W=Math.min(T,(w+U)/F),G=0,H=L;H<j;++H)for(var q=H*D-P,J=V;J<W;++J)for(var K=f*R+p*H+h*J,X=m*(k-1-q)+y*(w-1-(J*F-U))+x*M,Y=0;Y<I;++Y){G+=c[K+(M*I+Y)]*v[X+Y]}a[o*R+u*B+s*z+M]=G}return r.toTensor()}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){ce([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,u=Ee.buffer(n.filterShape,"float32"),s=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,f=this.bufferSync(e),d=this.bufferSync(t),p=0;p<i;++p)for(var h=Math.max(0,Math.ceil((c-p)/r)),v=Math.min(n.outHeight,(n.inHeight+c-p)/r),g=0;g<o;++g)for(var m=Math.max(0,Math.ceil((s-g)/a)),y=Math.min(n.outWidth,(n.inWidth+s-g)/a),x=0;x<n.outChannels;++x){for(var b=Math.trunc(x/l),k=x%l,w=0,A=0;A<n.batchSize;++A)for(var E=h;E<v;++E)for(var C=p+E*r-c,S=m;S<y;++S){var N=g+S*a-s;w+=f.get(A,C,N,b)*d.get(A,E,S,x)}u.set(w,p,g,b,k)}return u.toTensor()}},{key:"tile",value:function(e,t){return ce(e,"tile"),pt(this.bufferSync(e),t)}},{key:"gather",value:function(e,t,n){ce([e,t],"gather");var r=e.shape.slice(),a=this.readSync(t.dataId);r[n]=a.length;for(var i=Ee.buffer(r,e.dtype),o=this.bufferSync(e),u=0;u<i.size;++u){var s=i.indexToLoc(u),c=s.slice();c[n]=a[s[n]];var l=o.locToIndex(c);i.values[u]=o.values[l]}return i.toTensor()}},{key:"batchToSpaceND",value:function(e,t,n){ce([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),a=fe.getReshaped(e.shape,t,r),i=fe.getPermuted(a.length,t.length),o=fe.getReshapedPermuted(e.shape,t,r),u=fe.getSliceBeginCoords(n,t.length),s=fe.getSliceSize(o,n,t.length);return st.transpose(e.reshape(a),i).reshape(o).slice(u,s)}},{key:"maxPool",value:function(e,t){return ce(e,"maxPool"),Ce(this.readSync(e.dataId),e.shape,e.dtype,e.strides,t,"max").toTensor()}},{key:"maxPoolBackprop",value:function(e,t,n,r){ce([t,n],"maxPoolBackprop");for(var a=this.readSync(t.dataId),i=Ee.buffer(r.outShape,t.dtype,Se(a,t.shape,t.dtype,r).values),o=r.strideHeight,u=r.strideWidth,s=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,f=r.effectiveFilterWidth,d=f-1-r.padInfo.left,p=l-1-r.padInfo.top,h=Ee.buffer(t.shape,"float32"),v=this.bufferSync(e),g=0;g<r.batchSize;++g)for(var m=0;m<r.inChannels;++m)for(var y=0;y<r.inHeight;++y)for(var x=0;x<r.inWidth;++x){for(var b=y-p,k=x-d,w=0,A=0;A<l;A+=s){var E=(b+A)/o;if(!(E<0||E>=r.outHeight||Math.floor(E)!==E))for(var C=0;C<f;C+=c){var S=(k+C)/u;if(!(S<0||S>=r.outWidth||Math.floor(S)!==S)){var N=l*f-1-i.get(g,E,S,m)===A*f+C?1:0;if(0!==N)w+=v.get(g,E,S,m)*N}}}h.set(w,g,y,x,m)}return h.toTensor()}},{key:"avgPoolBackprop",value:function(e,t,n){ce([e,t],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,u=n.dilationHeight,s=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,f=l-1-n.padInfo.left,d=c-1-n.padInfo.top,p=Ee.buffer(t.shape,"float32"),h=1/(i*o),v=this.bufferSync(e),g=0;g<n.batchSize;++g)for(var m=0;m<n.inChannels;++m)for(var y=0;y<n.inHeight;++y)for(var x=0;x<n.inWidth;++x){for(var b=y-d,k=x-f,w=0,A=0;A<c;A+=u){var E=(b+A)/r;if(!(E<0||E>=n.outHeight||Math.floor(E)!==E))for(var C=0;C<l;C+=s){var S=(k+C)/a;if(!(S<0||S>=n.outWidth||Math.floor(S)!==S))w+=v.get(g,E,S,m)}}p.set(w*h,g,y,x,m)}return p.toTensor()}},{key:"pool3d",value:function(e,t,n){ce(e,"pool3d");for(var r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,u=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,h=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=this.readSync(e.dataId),m=Ee.buffer(t.outShape,e.dtype),y=m.values,x=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],b=t.outShape[2]*t.outShape[3]*t.outShape[4],k=t.outShape[3]*t.outShape[4],w=t.outShape[4],A=0;A<t.batchSize;++A)for(var E=A*x,C=A*e.strides[0],S=0;S<t.inChannels;++S)for(var N=0;N<t.outDepth;++N){for(var T=N*r-d,D=T;D<0;)D+=o;for(var F=Math.min(t.inDepth,c+T),O=E+N*b,_=0;_<t.outHeight;++_){for(var I=_*a-p,R=I;R<0;)R+=u;for(var M=Math.min(t.inHeight,l+I),B=O+_*k,P=0;P<t.outWidth;++P){for(var L=P*i-h,j=L;j<0;)j+=s;for(var z=Math.min(t.inWidth,f+L),U=B+P*w,V=v,W=0,G=0,H=D;H<F;H+=o){for(var q=C+H*e.strides[1],J=R;J<M;J+=u){for(var K=q+J*e.strides[2],X=j;X<z;X+=s){var Y=g[K+X*e.strides[3]+S];if("max"===n&&Y>V?V=Y:"avg"===n&&(W+=Y,G++),isNaN(V))break}if(isNaN(V))break}if(isNaN(V))break}y[U+S]="avg"===n?W/G:V}}}return m.toTensor()}},{key:"avgPool3d",value:function(e,t){return ce(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()}},{key:"avgPool3dBackprop",value:function(e,t,n){ce([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,u=n.filterHeight,s=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,d=n.effectiveFilterDepth,p=n.effectiveFilterHeight,h=n.effectiveFilterWidth,v=d-1-n.padInfo.front,g=h-1-n.padInfo.left,m=p-1-n.padInfo.top,y=Ee.buffer(t.shape,"float32"),x=1/(o*u*s),b=this.bufferSync(e),k=0;k<n.batchSize;++k)for(var w=0;w<n.inChannels;++w)for(var A=0;A<n.inDepth;++A)for(var E=0;E<n.inHeight;++E)for(var C=0;C<n.inWidth;++C){for(var S=A-v,N=E-m,T=C-g,D=0,F=0;F<d;F+=c){var O=(S+F)/r;if(!(O<0||O>=n.outDepth||Math.floor(O)!==O))for(var _=0;_<p;_+=l){var I=(N+_)/a;if(!(I<0||I>=n.outHeight||Math.floor(I)!==I))for(var R=0;R<h;R+=f){var M=(T+R)/i;if(!(M<0||M>=n.outWidth||Math.floor(M)!==M))D+=b.get(k,O,I,M,w)}}}y.set(D*x,k,A,E,C,w)}return y.toTensor()}},{key:"maxPool3d",value:function(e,t){return ce(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()}},{key:"maxPool3dPositions",value:function(e,t){for(var n=Ee.buffer(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,u=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=t.padInfo.front,p=t.padInfo.top,h=t.padInfo.left,v=this.bufferSync(e),g=0;g<t.batchSize;++g)for(var m=0;m<t.inChannels;++m)for(var y=0;y<t.outDepth;++y){for(var x=y*r-d,b=x;b<0;)b+=o;for(var k=Math.min(t.inDepth,c+x),w=0;w<t.outHeight;++w){for(var A=w*a-p,E=A;E<0;)E+=u;for(var C=Math.min(t.inHeight,l+A),S=0;S<t.outWidth;++S){for(var N=S*i-h,T=N;T<0;)T+=s;for(var D=Math.min(t.inWidth,f+N),F=Number.NEGATIVE_INFINITY,O=-1,_=b;_<k;_+=o)for(var I=_-x,R=E;R<C;R+=u)for(var M=R-A,B=T;B<D;B+=s){var P=B-N,L=v.get(g,_,R,B,m);L>=F&&(F=L,O=I*l*f+M*l+P)}n.set(O,g,y,w,S,m)}}}return n.toTensor()}},{key:"maxPool3dBackprop",value:function(e,t,n,r){ce([t,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(t,r),i=r.strideDepth,o=r.strideHeight,u=r.strideWidth,s=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterDepth,d=r.effectiveFilterHeight,p=r.effectiveFilterWidth,h=f-1-r.padInfo.front,v=p-1-r.padInfo.left,g=d-1-r.padInfo.top,m=Ee.buffer(t.shape,"float32"),y=this.bufferSync(a),x=this.bufferSync(e),b=0;b<r.batchSize;++b)for(var k=0;k<r.inChannels;++k)for(var w=0;w<r.inDepth;++w)for(var A=0;A<r.inHeight;++A)for(var E=0;E<r.inWidth;++E){for(var C=w-h,S=A-g,N=E-v,T=0,D=0;D<f;D+=s){var F=(C+D)/i;if(!(F<0||F>=r.outDepth||Math.floor(F)!==F))for(var O=0;O<d;O+=c){var _=(S+O)/o;if(!(_<0||_>=r.outHeight||Math.floor(_)!==_))for(var I=0;I<p;I+=l){var R=(N+I)/u;if(!(R<0||R>=r.outWidth||Math.floor(R)!==R)){var M=f*d*p-1-y.get(b,F,_,R,k)===D*d*p+O*p+I?1:0;if(0!==M)T+=x.get(b,F,_,R,k)*M}}}}m.set(T,b,w,A,E,k)}return m.toTensor()}},{key:"cast",value:function(e,t){return fe.castTensor(e,t,this)}},{key:"avgPool",value:function(e,t){return ce(e,"avgPool"),ce(e,"maxPool"),Ce(this.readSync(e.dataId),e.shape,e.dtype,e.strides,t,"avg").toTensor().toFloat()}},{key:"resizeBilinear",value:function(e,t,n,r){ce(e,"resizeBilinear");for(var a=d.default(e.shape,4),i=a[0],o=a[1],u=a[2],s=a[3],c=this.readSync(e.dataId),l=new Float32Array(g.sizeFromShape([i,t,n,s])),f=[r&&t>1?o-1:o,r&&n>1?u-1:u],p=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=0,v=f[0]/p[0],m=f[1]/p[1],y=0;y<i;y++)for(var x=0;x<t;x++)for(var k=v*x,w=Math.floor(k),A=k-w,E=Math.min(o-1,Math.ceil(k)),C=y*e.strides[0]+w*e.strides[1],S=y*e.strides[0]+E*e.strides[1],N=0;N<n;N++)for(var T=m*N,D=Math.floor(T),F=T-D,O=Math.min(u-1,Math.ceil(T)),_=C+D*e.strides[2],I=S+D*e.strides[2],R=C+O*e.strides[2],M=S+O*e.strides[2],B=0;B<s;B++){var P=c[_+B],L=c[I+B],j=P+(c[R+B]-P)*F,z=j+(L+(c[M+B]-L)*F-j)*A;l[h++]=z}return b.tensor(l,[i,t,n,s])}},{key:"resizeBilinearBackprop",value:function(e,t,n){ce([e,t],"resizeBilinearBackprop");for(var r=d.default(t.shape,4),a=r[0],i=r[1],o=r[2],u=r[3],s=d.default(e.shape,3),c=s[1],l=s[2],f=new Float32Array(a*i*o*u),p=[n&&c>1?i-1:i,n&&l>1?o-1:o],h=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=p[0]/h[0],g=p[1]/h[1],m=this.readSync(e.dataId),y=0,x=0;x<a;x++)for(var b=x*t.strides[0],k=0;k<c;k++)for(var w=k*v,A=Math.floor(w),E=Math.min(Math.ceil(w),i-1),C=b+A*t.strides[1],S=b+E*t.strides[1],N=w-A,T=1-N,D=0;D<l;D++)for(var F=D*g,O=Math.floor(F),_=Math.min(Math.ceil(F),o-1),I=F-O,R=1-I,M=C+O*t.strides[2],B=C+_*t.strides[2],P=S+O*t.strides[2],L=S+_*t.strides[2],j=T*R,z=T*I,U=N*R,V=N*I,W=0;W<u;W++){var G=m[y++];f[M+W]+=G*j,f[B+W]+=G*z,f[P+W]+=G*U,f[L+W]+=G*V}return ct.tensor4d(f,[a,o,i,u],t.dtype)}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){ce(e,"resizeNearestNeighbor");for(var a=d.default(e.shape,4),i=a[0],o=a[1],u=a[2],s=a[3],c=this.readSync(e.dataId),l=new Float32Array(i*t*n*s),f=[r&&t>1?o-1:o,r&&n>1?u-1:u],p=[r&&t>1?t-1:t,r&&n>1?n-1:n],h=f[0]/p[0],v=f[1]/p[1],g=0,m=0;m<i;m++)for(var y=m*e.strides[0],x=0;x<t;x++)for(var k=h*x,w=y+Math.min(o-1,r?Math.round(k):Math.floor(k))*e.strides[1],A=0;A<n;A++)for(var E=v*A,C=w+Math.min(u-1,r?Math.round(E):Math.floor(E))*e.strides[2],S=0;S<s;S++){var N=c[C+S];l[g++]=N}return b.tensor(l,[i,t,n,s],e.dtype)}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){ce([e,t],"resizeNearestNeighborBackprop");for(var r=d.default(t.shape,4),a=r[0],i=r[1],o=r[2],u=r[3],s=d.default(e.shape,3),c=s[1],l=s[2],f=new Float32Array(a*i*o*u),p=this.readSync(e.dataId),h=[n&&c>1?i-1:i,n&&l>1?o-1:o],v=[n&&c>1?c-1:c,n&&l>1?l-1:l],g=h[0]/v[0],m=h[1]/v[1],y=1/g,x=1/m,b=2*Math.ceil(y)+2,k=2*Math.ceil(x)+2,w=0;w<a;w++)for(var A=w*t.strides[0],E=0;E<i;E++)for(var C=A+E*t.strides[1],S=Math.floor(E*y),N=Math.floor(S-b/2),T=0;T<o;T++)for(var D=C+T*t.strides[2],F=Math.floor(T*x),O=Math.floor(F-k/2),_=0;_<u;_++){for(var I=0,R=0;R<b;R++){var M=R+N;if(!(M<0||M>=c)){var B=A+M*e.strides[1],P=M*g;if(E===Math.min(i-1,n?Math.round(P):Math.floor(P)))for(var L=0;L<k;L++){var j=L+O;if(!(j<0||j>=l)){var z=B+j*e.strides[2],U=j*m;T===Math.min(o-1,n?Math.round(U):Math.floor(U))&&(I+=p[z+_])}}}}f[D+_]=I}return ct.tensor4d(f,t.shape,t.dtype)}},{key:"batchNorm",value:function(e,t,n,r,a,i){ce([e,t,n,a,r],"batchNorm");for(var o=this.readSync(e.dataId),u=this.readSync(t.dataId),s=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),l=r?this.readSync(r.dataId):new Float32Array([0]),f=new Float32Array(o.length),d=l.length,p=c.length,h=s.length,v=u.length,g=0,m=0,y=0,x=0,b=0;b<o.length;++b)f[b]=l[g++]+(o[b]-u[m++])*c[y++]/Math.sqrt(s[x++]+i),g>=d&&(g=0),m>=v&&(m=0),y>=p&&(y=0),x>=h&&(x=0);return ct.tensor4d(f,e.shape)}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){ce(e,"localResponseNormalization4D");var i=e.shape[3],o=i-1,u=this.readSync(e.dataId),s=e.size,c=new Float32Array(s);function l(e){for(var n=e%i,r=e-n+Math.max(0,n-t),a=e-n+Math.min(n+t,o),s=0;r<=a;r++){var c=u[r];s+=c*c}return s}for(var f=0;f<s;f++){var d=l(f),p=u[f]*Math.pow(n+r*d,-a);c[f]=p}return ct.tensor4d(c,e.shape)}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){ce(e,"LRNGrad");for(var u=e.shape[3],s=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),f=new Float32Array(e.size),d=e.size,p=0;p<d;p++){for(var h=p%u,v=p-h+Math.max(0,h-r),g=p-h+Math.min(u,h+r+1),m=0,y=v;y<g;y++)m+=Math.pow(c[y],2);m=i*m+a;for(var x=v;x<g;x++){var b=-2*i*o*c[x]*l[p]/m;p===x&&(b+=Math.pow(m,-o)),b*=s[p],f[x]+=b}}return ct.tensor4d(f,e.shape)}},{key:"multinomial",value:function(e,t,n,r){ce(e,"multinomial");for(var a=t?e:lt.softmax(e),i=a.shape[0],o=a.shape[1],u=ot.zeros([i,n],"int32"),s=this.readSync(u.dataId),c=this.readSync(a.dataId),l=0;l<i;++l){var f=l*o,d=new Float32Array(o-1);d[0]=c[f];for(var p=1;p<d.length;++p)d[p]=d[p-1]+c[f+p];for(var h=k.alea(r.toString()),v=l*n,g=0;g<n;++g){var m=h();s[v+g]=d.length;for(var y=0;y<d.length;y++)if(m<d[y]){s[v+g]=y;break}}}return u}},{key:"oneHot",value:function(e,t,n,r){ce(e,"oneHot");var a=new Float32Array(e.size*t);a.fill(r);for(var i=this.readSync(e.dataId),o=0;o<e.size;++o)i[o]>=0&&i[o]<t&&(a[o*t+i[o]]=n);return ie.tensor2d(a,[e.size,t],"int32")}},{key:"nonMaxSuppression",value:function(e,t,n,r,a){ce(e,"nonMaxSuppression");var i=this.readSync(e.dataId),o=this.readSync(t.dataId);return ft(i,o,n,r,a)}},{key:"fft",value:function(e){return this.fftBatch(e,!1)}},{key:"ifft",value:function(e){return this.fftBatch(e,!0)}},{key:"fftBatch",value:function(e,t){for(var n=e.shape[0],r=e.shape[1],a=Ee.buffer(e.shape,"float32"),i=Ee.buffer(e.shape,"float32"),o=$e.real(e).as2D(n,r),u=et.imag(e).as2D(n,r),s=0;s<n;s++)for(var c=o.slice([s,0],[1,r]),l=u.slice([s,0],[1,r]),f=tt.complex(c,l),d=this.readSync(this.fftImpl(f,t).dataId),p=0;p<r;p++){var h=fe.getComplexWithIndex(d,p);a.values[s*r+p]=h.real,i.values[s*r+p]=h.imag}return tt.complex(a.toTensor(),i.toTensor()).as2D(n,r)}},{key:"fftImpl",value:function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(a=tt.complex($e.real(a).div(nt.scalar(r)),et.imag(a).div(nt.scalar(r)))),a}var i=this.readSync(e.dataId),o=this.fourierTransformByMatmul(i,r,t),u=fe.splitRealAndImagArrays(o);return tt.complex(u.real,u.imag).as2D(e.shape[0],e.shape[1])}},{key:"isExponentOf2",value:function(e){return 0==(e&e-1)}},{key:"fftRadix2",value:function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),a=t/2,i=fe.complexWithEvenIndex(r),o=tt.complex(i.real,i.imag).as1D(),u=fe.complexWithOddIndex(r),s=tt.complex(u.real,u.imag).as1D();o=this.fftRadix2(o,a,n),s=this.fftRadix2(s,a,n);var c=fe.exponents(t,n),l=tt.complex(c.real,c.imag).mul(s),f=o.add(l),d=o.sub(l),p=$e.real(f).concat($e.real(d)),h=et.imag(f).concat(et.imag(d));return tt.complex(p,h).as1D()}},{key:"fourierTransformByMatmul",value:function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,u=0;u<t;u++){var s=fe.exponent(a*u,t,n),c=fe.getComplexWithIndex(e,u);i+=c.real*s.real-c.imag*s.imag,o+=c.real*s.imag+c.imag*s.real}n&&(i/=t,o/=t),fe.assignToTypedArray(r,i,o,a)}return r}},{key:"depthToSpace",value:function(e,t,n){g.assert("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got ".concat(n)})),g.assert(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)}));for(var r=e.shape[0],a=e.shape[1],i=e.shape[2],o=e.shape[3],u=a*t,s=i*t,c=o/(t*t),l=this.readSync(e.dataId),f=new Float32Array(r*u*s*c),d=0,p=0;p<r;++p)for(var h=0;h<u;++h)for(var v=Math.floor(h/t),m=h%t,y=0;y<s;++y)for(var x=Math.floor(y/t),b=(m*t+y%t)*c,k=0;k<c;++k){var w=k+b+o*(x+i*(v+a*p));f[d++]=l[w]}return ct.tensor4d(f,[r,u,s,c])}},{key:"broadcastedBinaryOp",value:function(e,t,n,r){var a=fe.assertAndGetBroadcastShape(e.shape,t.shape),i=Ee.buffer(a,n),o=this.readSync(e.dataId),u=this.readSync(t.dataId),s=fe.getBroadcastDims(e.shape,a),c=fe.getBroadcastDims(t.shape,a),l=i.values;if(s.length+c.length===0)for(var f=0;f<l.length;++f)l[f]=r(o[f%o.length],u[f%u.length]);else for(var d=function(n){var a=i.indexToLoc(n),f=a.slice(-e.rank);s.forEach((function(e){return f[e]=0}));var d=p.locToIndex(f),v=a.slice(-t.rank);c.forEach((function(e){return v[e]=0}));var g=h.locToIndex(v);l[n]=r(o[d],u[g])},p=this.bufferSync(e),h=this.bufferSync(t),v=0;v<l.length;++v)d(v);return i.toTensor()}},{key:"broadcastedBinaryComplexOp",value:function(e,t,n){var r=fe.assertAndGetBroadcastShape(e.shape,t.shape),a=Ee.buffer(r,"float32"),i=Ee.buffer(r,"float32"),o=this.readSync(e.dataId),u=this.readSync(t.dataId),s=fe.getBroadcastDims(e.shape,r),c=fe.getBroadcastDims(t.shape,r),l=a.values,f=i.values;if(s.length+c.length===0)for(var d=0;d<l.length;d++){var p=d%o.length,h=d%u.length,v=n(o[2*p],o[2*p+1],u[2*h],u[2*h+1]);l[d]=v.real,f[d]=v.imag}else for(var g=function(r){var i=a.indexToLoc(r),d=i.slice(-e.rank);s.forEach((function(e){return d[e]=0}));var p=m.locToIndex(d),h=i.slice(-t.rank);c.forEach((function(e){return h[e]=0}));var v=y.locToIndex(h),g=n(o[2*p],o[2*p+1],u[2*v],u[2*v+1]);l[r]=g.real,f[r]=g.imag},m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=this.bufferSync(this.data.get(t.dataId).complexTensors.real),x=0;x<l.length;x++)g(x);return this.complex(a.toTensor(),i.toTensor())}},{key:"split",value:function(e,t,n){return dt(e,t,n)}},{key:"dispose",value:function(){}},{key:"floatPrecision",value:function(){return 32}},{key:"epsilon",value:function(){return F.default(O.default(r.prototype),"epsilon",this).call(this)}},{key:"cropAndResize",value:function(e,t,n,r,a,i){for(var o=d.default(e.shape,4),u=o[0],s=o[1],c=o[2],l=o[3],f=t.shape[0],p=d.default(r,2),h=p[0],v=p[1],g=Ee.buffer([f,h,v,l],"float32"),m=this.readSync(t.dataId),y=this.readSync(n.dataId),x=this.readSync(e.dataId),b=e.strides,k=g.strides,w=0;w<f;w++){var A=4*w,E=m[A],C=m[A+1],S=m[A+2],N=m[A+3],T=y[w];if(!(T>=u))for(var D=h>1?(S-E)*(s-1)/(h-1):0,F=v>1?(N-C)*(c-1)/(v-1):0,O=0;O<h;O++){var _=h>1?E*(s-1)+O*D:.5*(E+S)*(s-1);if(_<0||_>s-1)for(var I=0;I<v;I++)for(var R=0;R<l;R++){var M=R+I*k[2]+O*k[1]+w*k[0];g.values[M]=i}else if("bilinear"===a)for(var B=Math.floor(_),P=Math.ceil(_),L=_-B,j=0;j<v;j++){var z=v>1?C*(c-1)+j*F:.5*(C+N)*(c-1);if(z<0||z>c-1)for(var U=0;U<l;U++){var V=U+j*k[2]+O*k[1]+w*k[0];g.values[V]=i}else for(var W=Math.floor(z),G=Math.ceil(z),H=z-W,q=0;q<l;q++){var J=q+W*b[2]+B*b[1]+T*b[0],K=x[J],X=x[J=q+G*b[2]+B*b[1]+T*b[0]],Y=x[J=q+W*b[2]+P*b[1]+T*b[0]],Q=K+(X-K)*H,Z=Y+(x[J=q+G*b[2]+P*b[1]+T*b[0]]-Y)*H;J=q+j*k[2]+O*k[1]+w*k[0],g.values[J]=Q+(Z-Q)*L}}else for(var $=0;$<v;++$){var ee=v>1?C*(c-1)+$*F:.5*(C+N)*(c-1);if(ee<0||ee>c-1)for(var te=0;te<l;te++){var ne=te+$*k[2]+O*k[1]+w*k[0];g.values[ne]=i}else for(var re=Math.round(ee),ae=Math.round(_),ie=0;ie<l;ie++){var oe=ie+re*b[2]+ae*b[1]+T*b[0],ue=ie+$*k[2]+O*k[1]+w*k[0];g.values[ue]=x[oe]}}}}return g.toTensor()}},{key:"sparseToDense",value:function(e,t,n,r){var a=fe.calculateShapes(t,e,n),i=a.sliceRank,o=a.numUpdates,u=a.sliceSize,s=a.strides,c=a.outputSize;return this.scatter(e,t,n,c,u,o,i,s,r,!1)}},{key:"gatherND",value:function(e,t){var n=t.shape,r=n[n.length-1],a=d.default(fe.prepareAndValidate(e,t),4),i=a[0],o=a[1],u=a[2],s=a[3];if(0===o)return b.tensor([],i,e.dtype);for(var c=new y.TensorBuffer([o,u],e.dtype),l=this.readSync(t.dataId),f=this.readSync(e.dataId),p=0;p<o;p++){for(var h=[],v=0,g=0;g<r;g++){var m=l[p*r+g];v+=m*s[g],h.push(m)}if(v<0||v>=e.size/u)throw new Error("Invalid indices: ".concat(h," does not index into ").concat(e.shape));for(var x=0;x<u;x++)c.values[p*u+x]=f[v*u+x]}return c.toTensor().reshape(i)}},{key:"scatterND",value:function(e,t,n){var r=fe.calculateShapes(t,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,u=r.strides,s=r.outputSize,c=nt.scalar(0);return this.scatter(e,t,n,s,o,i,a,u,c,!0)}},{key:"fill",value:function(e,t,n){n=n||g.inferDtype(t);var r=g.getArrayFromDType(n,g.sizeFromShape(e));return r.fill(t),m.engine().makeTensor(r,e,n,this)}},{key:"onesLike",value:function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)}},{key:"zerosLike",value:function(e){var t=g.getArrayFromDType(e.dtype,g.sizeFromShape(e.shape));return this.makeOutput(t,e.shape,e.dtype)}},{key:"linspace",value:function(e,t,n){return fe.linspaceImpl(e,t,n)}},{key:"scatter",value:function(e,t,n,r,a,i,o,u,s,c){var l=[r/a,a],f=this.readSync(e.dataId),d=this.readSync(t.dataId);if(0===r)return b.tensor([],n,t.dtype);var p=new y.TensorBuffer(l,t.dtype);p.values.fill(this.readSync(s.dataId)[0]);for(var h=0;h<i;h++){for(var v=[],g=0,m=0;m<o;m++){var x=f[h*o+m];v.push(x),g+=x*u[m]}if(g<0||g>=r/a)throw new Error("Invalid indices: ".concat(v," does not index into ").concat(n));for(var k=0;k<a;k++)c?p.values[g*a+k]+=d[h*a+k]:p.values[g*a+k]=0===t.rank?d[0]:d[h*a+k]}return p.toTensor().reshape(n)}}]),r}(Qe.KernelBackend);
/** @license See the LICENSE file. */m.registerBackend("cpu",(function(){return new mt}),1),s("jbRpz");ue=s("d4BUr");s("jbRpz");se=s("cvMH2");s("jbRpz");re=s("lU3MY");s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var yt="return a + b;",xt="return a - b;",bt="return a * b;",kt="return (a < 0.) ? b * a : a;",wt=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["A","B"],this.outputShape=fe.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1"),g=s("kglvN");function At(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function Et(e,t){return 1===t?[e]:At(e,t)}s("1i51P");d=s("6vecG");s("jbRpz");fe=s("dITq1"),g=s("kglvN");s("jbRpz");re=s("lU3MY");function Ct(){var e,t,n,r,a,i,o,u,s,c;return 2===re.env().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",u="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",s="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",u="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",s="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:u,defineSpecialInf:s,defineRound:c}}s("jbRpz");g=s("kglvN");function St(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=g.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function Nt(e){var t=g.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}var Tt="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",Dt=fe.getBroadcastDims;function Ft(e,t,n,r){var a=[];e.forEach((function(e){var t=g.sizeFromShape(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var i,o,u=a.join("\n"),s=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?_t(e):Ot(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(r+=n?jt(e,t):zt(e,t));return r}(e,t,r)})).join("\n"),c=t.texShape,l=Ct(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(l),d=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(It,"\n    ").concat(Rt,"\n    ").concat(Mt,"\n  ")}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return n=t,1===(r=[Math.ceil(n[0]/2),Math.ceil(n[1]/2)])[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(r[1],".0);\n      }\n    "):1===r[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(r[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(r[0],", ").concat(r[1],"));\n      return 2 * (resTexRC.x * ").concat(r[1]," + resTexRC.y);\n    }\n  ");case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(g.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",u="b, r, c",s=2;s<e.length-1;s++)i*=e[e.length-s-1],o="\n      int b".concat(s," = index / ").concat(i,";\n      index -= b").concat(s," * ").concat(i,";\n    ")+o,u="b".concat(s,", ")+u;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(u,");\n    }\n  ")}(e,t)}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return 1===(n=t)[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(n[1],".0);\n      }\n    "):1===n[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(n[0],".0);\n      }\n    "):"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return resTexRC.x * ").concat(n[1]," + resTexRC.y;\n    }\n  ");case 2:return function(e,t){return g.arraysEqual(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    "):1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    "):1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    "):"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=St(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=St(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=St(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=St(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}var n}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(l)),r&&(d+=Bt),[d,f,o,u,i,s,n].join("\n")}function Ot(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=d.default(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=d.default(e.shapeInfo.texShape,2),u=o[0],s=o[1],c=Pt(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(u,", ").concat(s,", ").concat(c,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(Lt(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=Pt(t);return 1===i?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):1===a?"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    "):"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&g.arraysEqual(t,a)){var i=a[0],o=a[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var u=g.squeezeShape(t),s=u.newShape,c=u.keptDims,l=s;if(l.length<t.length){var f=Vt(e,l),d=["row","col"];return"\n      ".concat(Ot(f),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(Wt(d,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(Lt(e),"\n      }\n    ");var p=a[0],h=a[1],v=Pt(n);return 1===h?"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):1===p?"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(h,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  "):"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(v,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=g.squeezeShape(t),u=o.newShape,s=o.keptDims,c=u;if(c.length<t.length){var l=Vt(e,c),f=["row","col","depth"];return"\n        ".concat(Ot(l),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(Wt(f,s),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(i,", 1)));\n        ").concat(Lt(e),"\n      }\n    ");var d=e.shapeInfo.texShape,p=d[0],h=d[1],v=e.shapeInfo.flatOffset;if(h===a&&null==v)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(h,".0, ").concat(p,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(h===i&&null==v)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(h,".0, ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var m=Pt(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(i," + depth + ").concat(m,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(h,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,u=g.squeezeShape(t),s=u.newShape,c=u.keptDims;if(s.length<t.length){var l=Vt(e,s),f=["row","col","depth","depth2"];return"\n      ".concat(Ot(l),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(Wt(f,c),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(o,", ").concat(i,", ").concat(a,", 1)));\n        ").concat(Lt(e),"\n      }\n    ");var d=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,h=p[0],v=p[1];if(v===o&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==d)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(h,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var m=Pt(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(o," + col * ").concat(i," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(h,", ").concat(v,", index + ").concat(m,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,u=t[1]*o,s=g.squeezeShape(t),c=s.newShape,l=s.keptDims;if(c.length<t.length){var f=Vt(e,c),d=["row","col","depth","depth2","depth3"];return"\n      ".concat(Ot(f),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(Wt(d,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(u,", ").concat(o,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(Lt(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,v=h[0],m=h[1];if(m===u&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(o,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(m===a&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(m,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=Pt(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(u," + col * ").concat(o," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(m,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=g.squeezeShape(t),i=a.newShape,o=a.keptDims;if(i.length<t.length){var u=Vt(e,i),s=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(Ot(u),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(Wt(s,o),");\n      }\n    ")}var c=t[5],l=t[4]*c,f=t[3]*l,d=t[2]*f,p=t[1]*d;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(d,", ").concat(f,", ").concat(l,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(c,", 1)));\n        ").concat(Lt(e),"\n      }\n    ");var h=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,m=v[0],y=v[1];if(y===p&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(d,", ").concat(f,", ").concat(l,", ").concat(c,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(y,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(y===c&&null==h)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(y,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var x=Pt(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(d," + depth * ").concat(f," +\n          depth2 * ").concat(l," + depth3 * ").concat(c," + depth4 + ").concat(x,";\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(y,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function _t(e){var t,n,r;switch(e.shapeInfo.logicalShape.length){case 0:return t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Ct(),"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ");case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Ct();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],u=Ct();if(null!=a&&g.arraysEqual(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(o,".0, ").concat(i,".0);\n\n        return ").concat(u.texture2D,"(").concat(n,", uv);\n      }\n    ");var s=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(c,", ").concat(s[0],", ").concat(s[1],", row, col);\n      return ").concat(u.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var o=[1,2],u=Vt(e,t.slice(1)),s=["b","row","col"];return"\n        ".concat(_t(u),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(Wt(s,o),");\n        }\n      ")}var c=i[0],l=i[1],f=Math.ceil(t[2]/2),d=f*Math.ceil(t[1]/2),p=Ct();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(c,", ").concat(l,", ").concat(d,", ").concat(f,", b, row, col);\n      return ").concat(p.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],u=o[0],s=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),f="int b, int row, int col",d="b * ".concat(l," + (row / 2) * ").concat(c," + (col / 2)"),p=2;p<n-1;p++)f="int b".concat(p,", ")+f,l*=t[n-p-1],d="b".concat(p," * ").concat(l," + ")+d;var h=Ct();return"\n    vec4 ".concat(a,"(").concat(f,") {\n      int index = ").concat(d,";\n      int texR = index / ").concat(s,";\n      int texC = index - texR * ").concat(s,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(s,", ").concat(u,");\n      return ").concat(h.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var It="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Rt="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Mt="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Bt="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Pt(e){return"offset".concat(e)}function Lt(e){var t=e.name,n=g.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function jt(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,u=t.logicalShape.length,s=Dt(e.shapeInfo.logicalShape,t.logicalShape),c=Ut(u),l=u-o,f=["x","y","z","w","u","v"];n=0===o?"":u<2&&s.length>=1?"coords = 0;":s.map((function(e){return"coords.".concat(f[e+l]," = 0;")})).join("\n");var d="";d=u<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(f[t+l])})).join(", ");var p="return outputValue;",h=1===g.sizeFromShape(e.shapeInfo.logicalShape),v=1===g.sizeFromShape(t.logicalShape);if(1!==o||h||v){if(h&&!v)p=1===u?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(s.length){var m=o-2,y=o-1;s.indexOf(m)>-1&&s.indexOf(y)>-1?p="return vec4(outputValue.x);":s.indexOf(m)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":s.indexOf(y)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(c," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(d,");\n      ").concat(p,"\n    }\n  ")}function zt(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,u=e.shapeInfo.logicalShape.length,s=t.logicalShape.length;if(!e.shapeInfo.isUniform&&u===s&&null==e.shapeInfo.flatOffset&&g.arraysEqual(o,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var c,l=Ut(s),f=Dt(e.shapeInfo.logicalShape,t.logicalShape),d=s-u,p=["x","y","z","w","u","v"];c=0===u?"":s<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords.".concat(p[e+d]," = 0;")})).join("\n");var h="";return h=s<2&&u>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(p[t+d])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(c,"\n      return get").concat(r,"(").concat(h,");\n    }\n  ")}function Ut(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function Vt(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function Wt(e,t){return t.map((function(t){return e[t]})).join(", ")}var Gt="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",Ht=function e(t,n,r){"use strict";var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];c.default(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=fe.assertAndGetBroadcastShape(n,r);var i=this.outputShape.length,o="";if(a)if(0===i||1===g.sizeFromShape(this.outputShape))o="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var u=Ut(i);if(o="\n          ".concat(u," coords = getOutputCoords();\n        "),1===i)o+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var s=Et("coords",i);o+="\n            bool nextRowOutOfBounds =\n              (".concat(s[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(s[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(o,"\n\n        setOutput(result);\n      }\n    ")};var qt={kernelName:se.Div,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return function(e,t,n){var r=new wt("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new Ht("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",e.shape,t.shape,!0)),n.runWebGLProgram(r,[e,t],"float32")}(t.a,t.b,n)}};s("jbRpz");se=s("cvMH2");s("1i51P");c=s("3QOYJ");var Jt=function e(t){"use strict";c.default(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},Kt={kernelName:se.FlipLeftRight,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new Jt(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}};s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),re=s("lU3MY");s("jbRpz");se=s("cvMH2"),re=s("lU3MY");s("1i51P");d=s("6vecG");s("jbRpz");g=s("kglvN"),re=s("lU3MY");s("jbRpz");var Xt,Yt,Qt;g=s("kglvN"),re=s("lU3MY");function Zt(e,t){return[t,e]}function $t(e){var t=g.sizeFromShape(e),n=Math.ceil(t/4);return g.sizeToSquarishShape(n)}function en(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function tn(e,t){var n,r,a,i,o,u,s,c,l,f=e;return 2===re.env().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,i=f.RGBA32F,o=f.RED,u=4,s=1,c=f.HALF_FLOAT,l=f.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=f.RGBA,o=e.RGBA,u=4,s=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:u,defaultNumChannels:s,textureTypeHalfFloat:c,textureTypeFloat:l}}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(Xt||(Xt={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(Yt||(Yt={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(Qt||(Qt={})),s("1i51P");c=s("3QOYJ"),d=s("6vecG");var nn=function e(t){"use strict";c.default(this,e),this.variableNames=["A"];var n=Ct(),r=d.default(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var rn,an=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Ct(),r=d.default(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},on={kernelName:se.FromPixels,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,u="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,s=d.default(o?[a.videoWidth,a.videoHeight]:[a.width,a.height],2),c=s[0],l=s[1],f=[l,c],p=[l,c,i];(u||o)&&(null==rn&&(rn=document.createElement("canvas").getContext("2d")),rn.canvas.width=c,rn.canvas.height=l,rn.drawImage(a,0,0,c,l),a=rn.canvas);var h=n.makeTensorInfo(f,"int32");n.texData.get(h.dataId).usage=Yt.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),a);var v=re.env().getBool("WEBGL_PACK")?new an(p):new nn(p),g=n.runWebGLProgram(v,[h],"int32");return n.disposeData(h.dataId),g}};s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");var un=ke,sn=we;s("jbRpz");g=s("kglvN");s("jbRpz");fe=s("dITq1");s("1i51P");c=s("3QOYJ");var cn=function e(t,n){"use strict";c.default(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var u="0.0",s="";"prod"===n?u="1.0":"min"===n?(u="1.0 / 1e-20",s="min"):"max"===n&&(u="-1.0 / 1e-20",s="max");var l="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?l="sumValue":"prod"===n?l="prodValue":"all"===n?l="allValue":"any"===n&&(l="anyValue");var f=4*Math.floor(r/4),d=r%4,p="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(s,"(values, minMaxValue);\n      }\n    "),h="vec4";"all"===n?(u="1.0",p="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===n&&(u="0.0",p="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var v="";i%r>0&&(v="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(u,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(v,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(u,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(f,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(p,"\n        }\n\n        int inIdx = inOffset + ").concat(f,";\n        if (").concat(1===d,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(2===d,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(p,"\n        } else if (").concat(3===d,") {\n          ").concat(h," values = ").concat(h,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(p,"\n        }\n        setOutput(").concat(l,");\n      }\n    ")};function ln(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=fe.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,o=0;o<a.length;o++){var u=a[o],s=u.inSize,c=u.windowSize,l=u.outSize,f=new cn({windowSize:c,inSize:s,batchSize:e.shape[0],outSize:l},n),d=i;i=r.runWebGLProgram(f,[i],t),d.dataId!==e.dataId&&r.disposeData(d.dataId)}return i}s("1i51P");Pe=s("9M1dW");s("1i51P");c=s("3QOYJ");var fn=function e(t,n){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r,a,i="",o=0;o<4;o++){var u="thisRC = rc;";o%2==1&&(u+="thisRC.z += 1;"),o>1&&(u+="thisRC.y += 1;"),i+="\n        ".concat(u,"\n        ").concat(o>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(o,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(o>0?"}":"","\n      ")}this.userCode="\n      ".concat((r=n,a=St(["r","c","d"],r),"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(a,"\n      return ivec3(r, c, d);\n    }\n  ")),"\n      ").concat(Nt(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(i,"\n\n        setOutput(result);\n      }\n    ")};s("1i51P");Pe=s("9M1dW"),d=s("6vecG");s("jbRpz");re=s("lU3MY"),g=s("kglvN");var dn={},pn={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function hn(e){e in dn||(dn[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete dn[e]}),!1),1===e?t.getContext("webgl",pn)||t.getContext("experimental-webgl",pn):t.getContext("webgl2",pn)}(e));var t=dn[e];return t.isContextLost()?(delete dn[e],hn(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),dn[e])}function vn(e,t){var n=t();return re.env().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}function gn(e){return!!(re.env().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function mn(e,t){return Fn(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function yn(e,t){var n=Fn(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(vn(e,(function(){return e.shaderSource(n,t)})),vn(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=kn.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return g.rightPad((t+1).toString(),i)+e})),u=0,s=0;s<o.length;s++)u=Math.max(o[s].length,u);var c=o.slice(0,r-1),l=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(g.rightPad(l[0],u)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var xn,bn,kn=/ERROR: [0-9]+:([0-9]+):/g;function wn(e,t){if(vn(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function An(e,t,n,r,a,i,o){var u=e.getAttribLocation(t,n);return-1!==u&&(vn(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),vn(e,(function(){return e.vertexAttribPointer(u,a,e.FLOAT,!1,i,o)})),vn(e,(function(){return e.enableVertexAttribArray(u)})),!0)}function En(e,t,n){return Fn(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function Cn(e,t,n){return e.getUniformLocation(t,n)}function Sn(e,t,n,r){vn(e,(function(){return function(e,t,n){On(e,n),vn(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),vn(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),vn(e,(function(){return e.uniform1i(n,r)}))}function Nn(e,t,n){vn(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),vn(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function Tn(e,t){vn(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),vn(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function Dn(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function Fn(e,t,n){var r=vn(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function On(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function _n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return g.sizeFromShape(e.slice(0,e.length-t))}function In(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function Rn(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[_n(e)].concat(Pe.default(In(e)))),t}function Mn(e){return e%2==0}function Bn(e,t){if(e=e.slice(-2),t=t.slice(-2),g.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(Mn(n)&&Mn(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&Mn(e[0])&&Mn(t[0])}function Pn(e,t){return null!=e.getExtension(t)}function Ln(e){try{if(null!=hn(e))return!0}catch(e){return!1}return!1}function jn(e){if(0===e)return!1;var t=hn(e);if(1!==e){if(Pn(t,"EXT_color_buffer_float"))return zn(t);var n="EXT_color_buffer_half_float";if(Pn(t,n)){var r=t.getExtension(n);return function(e,t){var n=tn(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var u=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),u}(t,r)}return!1}return!!Pn(t,"OES_texture_float")&&(!!Pn(t,"WEBGL_color_buffer_float")&&zn(t))}function zn(e){var t=tn(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function Un(e,t,n){var r=n.texData.get(e.dataId);return!r.isPacked||Bn(e.shape,t)||null!==r.texture&&Bn(r.shape,t)?{dataId:e.dataId,shape:t,dtype:e.dtype}:function(e,t,n){var r=[_n(e.shape)].concat(Pe.default(In(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[_n(t)].concat(Pe.default(In(t))),o=new fn(i,r),u=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:u.dataId,shape:t,dtype:u.dtype}}(e,t,n)}s("jbRpz");re=s("lU3MY");s("1i51P");c=s("3QOYJ");var Vn=function e(t,n){"use strict";c.default(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=Ut(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")};s("1i51P");c=s("3QOYJ");var Wn=function e(t,n){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=Ut(this.rank),o=At("rc",this.rank),u=new Array(this.rank),s=0;s<n.length;s++)u[n[s]]=o[s];var l="vec2(".concat(u.slice(-2).join(),")"),f="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),d="getChannel(getA(".concat(u.join(),"), ").concat(l,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(d,";\n      if(").concat(f,") {\n        result[1] = ").concat(d,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(d,";\n        if(").concat(f,") {\n          result[3] = ").concat(d,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function Gn(e,t,n){var r=re.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wn(e.shape,t):new Vn(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}var Hn={kernelName:se.Max,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.reductionIndices,o=n.keepDims,u=r,s=a.shape.length,c=g.parseAxisParam(i,a.shape),l=c,f=fe.getAxesPermutation(l,s),p=null!=f,h=u.shouldExecuteOnCPU([a]),v=a;if(p){if(h){for(var m=u.texData.get(v.dataId).values,y=new Array(s),x=0;x<y.length;x++)y[x]=a.shape[f[x]];var b=sn(m,a.shape,a.dtype,f,y);v=u.makeTensorInfo(y,a.dtype),u.texData.get(v.dataId).values=b}else v=Gn(a,f,u);l=fe.getInnerMostAxes(l.length,s)}fe.assertAxesAreInnerMostDims("max",l,s);var k,w=d.default(fe.computeOutAndReduceShapes(v.shape,l),2),A=w[0],E=w[1],C=A;if(o&&(C=fe.expandShapeToKeepDim(A,c)),h){var S=u.texData.get(v.dataId).values,N=un(S,g.sizeFromShape(E),C,a.dtype);k=u.makeTensorInfo(C,a.dtype),u.texData.get(k.dataId).values=N}else k=function(e,t,n,r){var a=g.sizeFromShape(t),i=Un(e,[g.sizeFromShape(e.shape)/a,a],r),o=ln(i,e.dtype,"max",r);return i.dataId!==e.dataId&&r.disposeData(i.dataId),Un(o,n,r)}(v,E,C,u);return p&&u.disposeData(v.dataId),k}};s("1i51P");d=s("6vecG");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");s("jbRpz");se=s("cvMH2"),g=s("kglvN"),fe=s("dITq1");s("1i51P");c=s("3QOYJ");var qn=function e(t,n,r){"use strict";var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(c.default(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideHeight,s=t.strideWidth,l=t.dilationHeight,f=t.dilationWidth,d=t.effectiveFilterHeight,p=t.effectiveFilterWidth,h=t.padInfo.top,v=t.padInfo.left;this.outputShape=t.outShape;var g="avg"===n,m="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),x="0.0";if(g||(x="-1.0 / 1e-20"),r){var b=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(u,", ").concat(s,");\n        const ivec2 pads = ivec2(").concat(h,", ").concat(v,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(l,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(f,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(b," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?m:y:"wR * ".concat(p," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var k="max",w="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(w="avgValue / count");var A=4*Math.floor(o/4),E=o%4,C="\n      if (".concat(g,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(k,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(u,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(h,", ").concat(v,");\n      const float initializationValue = ").concat(x,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(x,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(l,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(A,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(f,", d),\n              getValue(batch, xR, xC + 2 * ").concat(f,", d),\n              getValue(batch, xR, xC + 3 * ").concat(f,", d)\n            );\n\n            ").concat(C,"\n          }\n\n          int xC = xCCorner + ").concat(A,";\n          if (").concat(1===E,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(C,"\n          } else if (").concat(2===E,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(f,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(C,"\n          } else if (").concat(3===E,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(f,", d),\n              getValue(batch, xR, xC + 2 * ").concat(f,", d),\n              initializationValue\n            );\n\n            ").concat(C,"\n          }\n        }\n        setOutput(").concat(w,");\n      }\n    ")}},Jn=function e(t,n,r){"use strict";var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(c.default(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,u=t.strideDepth,s=t.strideHeight,l=t.strideWidth,f=t.dilationDepth,d=t.dilationHeight,p=t.dilationWidth,h=t.effectiveFilterDepth,v=t.effectiveFilterHeight,g=t.effectiveFilterWidth,m=t.padInfo.front,y=t.padInfo.top,x=t.padInfo.left;this.outputShape=t.outShape;var b="avg"===n,k="0.0";if(b||(k="-1.0 / 1e-20"),r){var w=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(u,", ").concat(s,", ").concat(l,");\n        const ivec3 pads = ivec3(").concat(m,", ").concat(y,", ").concat(x,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(h,";\n              wD += ").concat(f,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(v,";\n                wR += ").concat(d,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(g,";\n                  wC += ").concat(p,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(w," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(v," * ").concat(g," +\n                      wR * ").concat(g," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var A="max",E="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(E="avgValue / count");var C=4*Math.floor(o/4),S=o%4,N="\n      if (".concat(b,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(A,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(u,", ").concat(s,", ").concat(l,");\n      const ivec3 pads = ivec3(").concat(m,", ").concat(y,", ").concat(x,");\n      const float initializationValue = ").concat(k,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(k,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(h,";\n            wD += ").concat(f,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(v,";\n            wR += ").concat(d,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(C,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(p,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(p,", ch)\n              );\n\n              ").concat(N,"\n            }\n\n            int xC = xCCorner + ").concat(C,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(N,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(p,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(p,", ch),\n                initializationValue\n              );\n\n              ").concat(N,"\n            }\n          }\n          setOutput(").concat(E,");\n        }\n      }\n    ")}};var Kn={kernelName:se.MaxPoolWithArgmax,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,o=n.strides,u=n.pad,s=n.includeBatchInIndex,c=r;g.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var l=[1,1];g.assert(fe.eitherStridesOrDilationsAreOne(o,l),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(o," and dilations '").concat(l,"'")}));var f=fe.computePool2DInfo(a.shape,i,o,l,u),p=d.default(function(e,t,n,r){var a=new qn(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new qn(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,s,f,c),2);return[p[0],p[1]]}};s("jbRpz");se=s("cvMH2"),fe=s("dITq1"),Te=s("289sH");var Xn={kernelName:se.NonMaxSuppressionV3,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;fe.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=n,l=c.readSync(a.dataId),f=c.readSync(i.dataId),d=o,p=u,h=s;return Te.nonMaxSuppressionV3Impl(l,f,d,p,h)}};s("jbRpz");Te=s("289sH"),se=s("cvMH2"),fe=s("dITq1");var Yn=Te.nonMaxSuppressionV4Impl,Qn={kernelName:se.NonMaxSuppressionV4,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;fe.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.padToMaxOutputSize,l=n,f=l.readSync(a.dataId),d=l.readSync(i.dataId),p=Yn(f,d,o,u,s,c);return[p.selectedIndices,p.validOutputs]}};s("jbRpz");Te=s("289sH"),se=s("cvMH2"),fe=s("dITq1");s("jbRpz");Te=s("289sH"),se=s("cvMH2"),fe=s("dITq1");var Zn=Te.nonMaxSuppressionV5Impl,$n={kernelName:se.NonMaxSuppressionV5,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;fe.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t.boxes,i=t.scores,o=r.maxOutputSize,u=r.iouThreshold,s=r.scoreThreshold,c=r.softNmsSigma,l=n,f=l.readSync(a.dataId),d=l.readSync(i.dataId),p=Zn(f,d,o,u,s,c);return[p.selectedIndices,p.selectedScores]}};s("jbRpz");se=s("cvMH2");s("1i51P");c=s("3QOYJ"),d=s("6vecG");s("jbRpz");fe=s("dITq1");var er=function e(t,n,r,a){"use strict";c.default(this,e),this.variableNames=["Image"],this.outputShape=[];var i=t[1],o=t[2],u=Math.sin(n).toFixed(3),s=Math.cos(n).toFixed(3);this.outputShape=t;var l=d.default(fe.getImageCenter(a,i,o),2),f=l[0],p=l[1],h=f.toFixed(3),v=p.toFixed(3),g="";g="number"==typeof r?"float outputValue = ".concat(r.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(r.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - ".concat(h,") * ").concat(s," - (float(y) - ").concat(v,") * ").concat(u,";\n          float coordYFloat = (float(x) - ").concat(h,") * ").concat(u," + (float(y) - ").concat(v,") * ").concat(s,";\n          int coordX = int(round(coordXFloat + ").concat(h,"));\n          int coordY = int(round(coordYFloat + ").concat(v,"));\n          ").concat(g,"\n          if(coordX >= 0 && coordX < ").concat(o," && coordY >= 0 && coordY < ").concat(i,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},tr={kernelName:se.RotateWithOffset,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,o=n.fillValue,u=n.center,s=r,c=new er(a.shape,i,o,u);return s.runWebGLProgram(c,[a],a.dtype)}};s("jbRpz");se=s("cvMH2");s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var nr=function e(t,n){"use strict";c.default(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},rr="if (isnan(x)) return x;",ar="return x;",ir="return abs(x);",or="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",ur="if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",sr="return (x >= 0.0) ? x : (exp(x) - 1.0);",cr="\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(fe.SELU_SCALEALPHA,";\n  float scale = ").concat(fe.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");var lr="return -x;",fr="return ceil(x);",dr="return floor(x);",pr="return exp(x);",hr="return exp(x) - 1.0;",vr='\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(fe.ERF_P,";\n  float a1 = ").concat(fe.ERF_A1,";\n  float a2 = ").concat(fe.ERF_A2,";\n  float a3 = ").concat(fe.ERF_A3,";\n  float a4 = ").concat(fe.ERF_A4,";\n  float a5 = ").concat(fe.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n"),gr="return x;",mr={kernelName:se.Square,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new nr(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}};s("jbRpz");se=s("cvMH2"),re=s("lU3MY");var yr={kernelName:se.SquaredDifference,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.a,a=t.b,i="return (a - b) * (a - b);",o=n,u=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht(i,r.shape,a.shape):new wt(i,r.shape,a.shape);return o.compileAndRun(u,[r,a])}};s("jbRpz");var xr={kernelName:(se=s("cvMH2")).Transpose,backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,a=e.backend,i=n.x,o=r.perm,u=a,s=i.shape.length,c=new Array(s),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(u.shouldExecuteOnCPU([i])){var f=u.texData.get(i.dataId).values,d=sn(f,i.shape,i.dtype,o,c);t=u.makeTensorInfo(c,i.dtype),u.texData.get(t.dataId).values=d}else t=Gn(i,o,u);return t}},br=[Hn,Kt,on,qt,Kn,Xn,Qn,$n,tr,mr,yr,xr];He=!0,qe=!1,Je=void 0;try{var kr;for(Ke=br[Symbol.iterator]();!(He=(kr=Ke.next()).done);He=!0){Xe=kr.value;ue.registerKernel(Xe)}}catch(e){qe=!0,Je=e}finally{try{He||null==Ke.return||Ke.return()}finally{if(qe)throw Je}}s("jbRpz");var wr=s("iUbQh");m=s("P1tXK");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),Ye=s("jZS3C"),l=s("2tuUj"),f=s("e3nFV"),Pe=s("9M1dW"),d=s("6vecG"),v=s("40Zzs");s("jbRpz");re=s("lU3MY"),wr=s("iUbQh");var Ar=re.env();Ar.registerFlag("HAS_WEBGL",(function(){return Ar.getNumber("WEBGL_VERSION")>0})),Ar.registerFlag("WEBGL_VERSION",(function(){return Ln(2)?2:Ln(1)?1:0})),Ar.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),Ar.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Ar.get("WEBGL_VERSION")})),Ar.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Ar.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Ar.registerFlag("WEBGL_PACK",(function(){return Ar.getBool("HAS_WEBGL")})),Ar.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_PACK_CLIP",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Ar.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_PACK_REDUCE",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_CONV_IM2COL",(function(){return Ar.getBool("WEBGL_PACK")})),Ar.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==xn){var t=hn(e);xn=t.getParameter(t.MAX_TEXTURE_SIZE)}return xn}(Ar.getNumber("WEBGL_VERSION"))})),Ar.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==bn){var t=hn(e);bn=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,bn)}(Ar.getNumber("WEBGL_VERSION"))})),Ar.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Ar.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=hn(e);return Pn(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:Pn(t,"EXT_disjoint_timer_query")?1:0}(e)})),Ar.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Ar.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!wr.isMobile()})),Ar.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=hn(e);if(1===e){if(!Pn(t,"OES_texture_float"))return!1}else if(!Pn(t,"EXT_color_buffer_float"))return!1;return zn(t)}(Ar.getNumber("WEBGL_VERSION"))})),Ar.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Ar.getBool("WEBGL_FORCE_F16_TEXTURES")&&Ar.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Ar.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return jn(Ar.getNumber("WEBGL_VERSION"))})),Ar.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=Ar.getNumber("WEBGL_VERSION"))&&null!=hn(e).fenceSync;var e})),Ar.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Ar.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Ar.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),s("jbRpz");fe=s("dITq1"),Te=s("289sH"),re=s("lU3MY"),Qe=s("lvUHp"),m=s("P1tXK"),g=s("kglvN"),b=s("616DT"),Ze=s("aK0eq"),$e=s("2acG6"),et=s("hXj3N"),tt=s("3IcUj"),st=s("9PS5J"),rt=s("aTTkI"),Ee=s("8orDI");var Er=s("gldWN"),Cr=s("jlvqc");at=s("avJI0"),it=s("6baO0"),lt=s("etmQx"),nt=s("bftEy");s("jbRpz");fe=s("dITq1"),Te=s("289sH"),re=s("lU3MY"),Qe=s("lvUHp"),m=s("P1tXK"),g=s("kglvN"),b=s("616DT"),Ze=s("aK0eq"),$e=s("2acG6"),et=s("hXj3N"),tt=s("3IcUj"),st=s("9PS5J"),rt=s("aTTkI"),Ee=s("8orDI"),Er=s("gldWN"),Cr=s("jlvqc"),at=s("avJI0"),it=s("6baO0"),lt=s("etmQx"),nt=s("bftEy");s("jbRpz");fe=s("dITq1"),Te=s("289sH"),re=s("lU3MY"),Qe=s("lvUHp"),m=s("P1tXK"),g=s("kglvN"),b=s("616DT"),Ze=s("aK0eq"),$e=s("2acG6"),et=s("hXj3N"),tt=s("3IcUj"),st=s("9PS5J"),rt=s("aTTkI"),Ee=s("8orDI"),Er=s("gldWN"),Cr=s("jlvqc"),at=s("avJI0"),it=s("6baO0"),lt=s("etmQx"),nt=s("bftEy");s("jbRpz");fe=s("dITq1"),Te=s("289sH"),re=s("lU3MY"),Qe=s("lvUHp"),m=s("P1tXK"),g=s("kglvN"),b=s("616DT"),Ze=s("aK0eq"),$e=s("2acG6"),et=s("hXj3N"),tt=s("3IcUj"),st=s("9PS5J"),rt=s("aTTkI"),Ee=s("8orDI"),Er=s("gldWN"),Cr=s("jlvqc"),at=s("avJI0"),it=s("6baO0"),lt=s("etmQx"),nt=s("bftEy");s("1i51P");c=s("3QOYJ");var Sr=function e(t,n){"use strict";c.default(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Nr=function e(t,n){"use strict";c.default(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Tr=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var u="max"===n?">":"<",s=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(s,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(u," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");g=s("kglvN");var Dr=function e(t,n,r,a){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,g.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],o=Math.ceil(i/n);this.outputShape=t.slice(0,-1),o>1&&this.outputShape.push(o),a||this.variableNames.push("bestIndicesA");var u,s,l=this.outputShape,f=l.length,d=Ut(f),p=Et("coords",f);if(1===o){var h=Ut(s=f+1);u="\n        ".concat(h," sourceLocR = ").concat(h,"(").concat(p.join(),", 0);\n        ++").concat(p[f-1],";\n        ").concat(h," sourceLocG = ").concat(h,"(").concat(p.join(),", 0);\n        ++").concat(p[f-2],";\n        ").concat(h," sourceLocA = ").concat(h,"(").concat(p.join(),", 0);\n        --").concat(p[f-1],";\n        ").concat(h," sourceLocB = ").concat(h,"(").concat(p.join(),", 0);\n        --").concat(p[f-2],";")}else s=f,u="\n        ".concat(d," sourceLocR = coords;\n        ++").concat(p[f-1],";\n        ").concat(d," sourceLocG = coords;\n        ++").concat(p[f-2],";\n        ").concat(d," sourceLocA = coords;\n        --").concat(p[f-1],";\n        ").concat(d," sourceLocB = coords;\n        --").concat(p[f-2],";");var v=["x","y","z","w","u","v"].slice(0,s),m="."+v[s-1],y=v.map((function(e){return"int "+e})),x=Et("sourceLocR",s-1).concat("inIdx.r"),b=Et("sourceLocG",s-1).concat("inIdx.g"),k=Et("sourceLocB",s-1).concat("inIdx.b"),w=Et("sourceLocA",s-1).concat("inIdx.a"),A="max"===r?"greaterThan":"lessThan",E=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(b.join(),"),\n                             getBestIndicesAChannel(").concat(k.join(),"),\n                             getBestIndicesAChannel(").concat(w.join(),")));"),C="vec4(\n            getAChannel(".concat(x.join(),"),\n            hasNextCol ? getAChannel(").concat(b.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(k.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(w.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(y.join(),") {\n        return getChannel(getBestIndicesA(").concat(v.join(),"),\n                                          vec2(").concat(v.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(y.join(),") {\n        return getChannel(getA(").concat(v.join(),"),\n                               vec2(").concat(v.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(d," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[f-1]," < ").concat(l[f-1]-1,";\n        bool hasNextRow = ").concat(p[f-2]," < ").concat(l[f-2]-1,";\n        ").concat(u,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(m,", sourceLocG").concat(m,",\n          sourceLocB").concat(m,", sourceLocA").concat(m,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(C,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(E,"\n          vec4 candidate = ").concat(C,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(A,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Fr=function e(t){"use strict";c.default(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,u=t.dilationWidth,s=t.effectiveFilterHeight,l=t.effectiveFilterWidth,f=s-1-t.padInfo.top,d=l-1-t.padInfo.left,p=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(f,", ").concat(d,");\n      const float avgMultiplier = float(").concat(p,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(s,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(l,";\n            wC+= ").concat(u,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Or=function e(t){"use strict";c.default(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,s=t.dilationDepth,l=t.dilationHeight,f=t.dilationWidth,d=t.effectiveFilterDepth,p=t.effectiveFilterHeight,h=t.effectiveFilterWidth,v=d-1-t.padInfo.front,g=p-1-t.padInfo.top,m=h-1-t.padInfo.left,y=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(v,", ").concat(g,", ").concat(m,");\n      const float avgMultiplier = float(").concat(y,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(s,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(p,";\n              wR += ").concat(l,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(h,";\n                wC += ").concat(f,") {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var _r=function e(t,n,r,a,i,o){"use strict";c.default(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],fe.assertAndGetBroadcastShape(t,n),fe.assertAndGetBroadcastShape(t,r);var u="0.0";null!=a&&(fe.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="1.0";null!=i&&(fe.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(u,";\n        float scale = ").concat(s,";\n        float inv = scale * inversesqrt(variance + float(").concat(o,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var Ir=function e(t,n,r,a,i,o){"use strict";c.default(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],fe.assertAndGetBroadcastShape(t,n),fe.assertAndGetBroadcastShape(t,r);var u="vec4(0.0)";null!=a&&(fe.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),u="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=i&&(fe.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(u,";\n        vec4 scale = ").concat(s,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(o,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var Rr="return areal * breal - aimag * bimag;",Mr="return areal * bimag + aimag * breal;",Br=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=fe.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var Pr=function(){"use strict";function e(t){c.default(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return l.default(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var Lr=function(){"use strict";function e(t){c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return l.default(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();s("1i51P");c=s("3QOYJ");var jr=function e(t){"use strict";c.default(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var zr=function e(t){"use strict";c.default(this,e),this.outputShape=[],this.outputShape=fe.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var o=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(o,"));"))}var u=n.length,s=n[n.length-1];a.push("else setOutput(getT".concat(u,"(yR, yC-").concat(s,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");fe=s("dITq1");var Ur=function e(t,n){"use strict";c.default(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=fe.computeOutShape(t,n);var r=this.outputShape,a=r.length,i=Ut(a),o=Et("coords",a),u=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var s=new Array(t.length-1);s[0]=t[0][n];for(var l=1;l<s.length;l++)s[l]=s[l-1]+t[l][n];for(var f=u[n],d=u.slice(-2),p=u.join(),h="if (".concat(f," < ").concat(s[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(d.join(),"));\n        }"),v=1;v<s.length;v++){var g=s[v-1];h+="\n        if (".concat(f," < ").concat(s[v],"  && ").concat(f," >= ").concat(s[v-1],") {\n          return getChannel(\n            getT").concat(v,"(").concat(Vr(u,f,g),"),\n            vec2(").concat(Vr(d,f,g),"));\n        }")}var m=s.length,y=s[s.length-1];h+="\n        return getChannel(\n          getT".concat(m,"(").concat(Vr(u,f,y),"),\n          vec2(").concat(Vr(d,f,y),"));"),this.userCode="\n      float getValue(".concat(u.map((function(e){return"int "+e})),") {\n        ").concat(h,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(o,"), 0., 0., 0.);\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," + 1;\n        if (").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-2]," = ").concat(o[a-2]," + 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(o,");\n        }\n\n        ").concat(o[a-1]," = ").concat(o[a-1]," - 1;\n        if (").concat(o[a-2]," < ").concat(r[a-2]," &&\n            ").concat(o[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(o,");\n        }\n        setOutput(result);\n      }\n    ")};function Vr(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}s("1i51P");c=s("3QOYJ");var Wr=function e(t){"use strict";c.default(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Gr=function e(t){"use strict";c.default(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,u=n-1-t.padInfo.top,s=r-1-t.padInfo.left,l=o?1:2,f=o?2:3,d=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(d,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(l,"], coords[").concat(f,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Hr=function e(t){"use strict";c.default(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,u=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(u,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},qr=function e(t){"use strict";c.default(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,s=n-1-t.padInfo.front,l=r-1-t.padInfo.top,f=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(s,", ").concat(l,", ").concat(f,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(u,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Jr=function e(t){"use strict";c.default(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Kr=function e(t){"use strict";c.default(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,u=r-1-t.padInfo.left,s=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(s,"; dm++) {\n              int d2 = d1 * ").concat(s," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Xr=function e(t){"use strict";var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];c.default(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.padInfo.top,o=t.padInfo.left,u=t.strideHeight,s=t.strideWidth,l=t.dilationHeight,f=t.dilationWidth,d=t.filterHeight,p=t.filterWidth,h=4*Math.floor(t.inChannels/4),v=t.inChannels%4,g="channelsLast"===t.dataFormat,m=g?1:2,y=g?2:3,x=g?3:1,b="",k="";r&&(b=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),k="result = activation(result);");var w=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(u,", ").concat(s,");\n      const ivec2 pads = ivec2(").concat(i,", ").concat(o,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(x,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(m,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(d,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(f,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(h,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(h,") *\n                    getW(wR, wC, ").concat(h,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(h,", xR, xC) *\n                    getW(wR, wC, ").concat(h,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(h,", d2),\n                getW(wR, wC, ").concat(h," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(h,"),\n                  getX(batch, xR, xC, ").concat(h," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(h,", xR, xC),\n                  getX(batch, ").concat(h," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(h,", d2),\n                getW(wR, wC, ").concat(h," + 1, d2),\n                getW(wR, wC, ").concat(h," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(h,"),\n                  getX(batch, xR, xC, ").concat(h," + 1),\n                  getX(batch, xR, xC, ").concat(h," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(h,", xR, xC),\n                  getX(batch, ").concat(h," + 1, xR, xC),\n                  getX(batch, ").concat(h," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(w,"\n        ").concat(k,"\n        setOutput(result);\n      }\n    ")},Yr=function e(t){"use strict";c.default(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,u=t.strideWidth,s=t.dilationDepth,l=t.dilationHeight,f=t.dilationWidth,d=t.filterDepth,p=t.filterHeight,h=t.filterWidth,v=4*Math.floor(t.inChannels/4),g=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(d,"; wF++) {\n          int xF = xFCorner + wF * ").concat(s,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(p,"; wR++) {\n            int xR = xRCorner + wR * ").concat(l,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(h,"; wC++) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(v,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===g,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(v,") *\n                  getW(wF, wR, wC, ").concat(v,", d2);\n              } else if (").concat(2===g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(v,"),\n                  getX(batch, xF, xR, xC, ").concat(v," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(v,", d2),\n                  getW(wF, wR, wC, ").concat(v," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(v,"),\n                  getX(batch, xF, xR, xC, ").concat(v," + 1),\n                  getX(batch, xF, xR, xC, ").concat(v," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(v,", d2),\n                  getW(wF, wR, wC, ").concat(v," + 1, d2),\n                  getW(wF, wR, wC, ").concat(v," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Qr=function e(t){"use strict";var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];c.default(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var i=t.inHeight,o=t.inWidth,u=t.padInfo.top,s=t.padInfo.left,l=t.strideHeight,f=t.strideWidth,d=t.dilationHeight,p=t.dilationWidth,h=t.filterHeight,v=t.filterWidth,g=t.outChannels/t.inChannels,m="",y="";r&&(m=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),y="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(m,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(f,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(g,";\n        int q = d2 - d1 * ").concat(g,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(h,"; wR++) {\n          int xR = xRCorner + wR * ").concat(d,";\n\n          if (xR < 0 || xR >= ").concat(i,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC++) {\n            int xC = xCCorner + wC * ").concat(p,";\n\n            if (xC < 0 || xC >= ").concat(o,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(x,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ");s("jbRpz");g=s("kglvN");var Zr=function e(t){"use strict";var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];c.default(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var i=t.inHeight,o=t.inWidth,u=t.padInfo.top,s=t.padInfo.left,l=t.strideHeight,f=t.strideWidth,d=t.dilationHeight,p=t.dilationWidth,h=t.filterHeight,v=t.filterWidth,m=v,y="int xR; int xC; int xCOffset;",x=0;x<h;x++)for(var b=0;b<v;b++)y+="\n          vec4 xTexelR".concat(x,"C").concat(2*b," = vec4(0.);\n          vec4 wR").concat(x,"C").concat(b," = vec4(0.);\n          vec4 xR").concat(x,"C").concat(b," = vec4(0.);");for(var k=0;k<h;k++)for(var w=0;w<m;w++){var A=2*w;if(y+="\n          xR = xRCorner + ".concat(k*d,";\n          xC = xCCorner + ").concat(A*p,";\n        "),1===f){if(A<v&&(y+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(i," && xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(k,"C").concat(A," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(o,") {\n                    xTexelR").concat(k,"C").concat(A,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(k,"C").concat(A," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(i," && xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(o,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(k,"C").concat(A," = vec4(previous.zw, xTexelR").concat(k,"C").concat(A,".xy);\n                } else {\n                  xR").concat(k,"C").concat(A," = vec4(0, 0, xTexelR").concat(k,"C").concat(A,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(i," && xC >= 0 && xC < ").concat(o,") {\n                  xTexelR").concat(k,"C").concat(A," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(A," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(A," = xTexelR").concat(k,"C").concat(A,";\n              "),A+1<v)){var E=s%2==0?g.nearestLargerEven(p):p;p%2==0&&s%2==1||p%2!=0&&s%2!=1?(y+="\n                  xCOffset = xC + ".concat(s%2," + ").concat(E,";\n\n                  if(xR >= 0 && xR < ").concat(i," &&\n                    xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    xTexelR").concat(k,"C").concat(A+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),p>1&&(y+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(i," &&\n                      xCOffset >= 0 && xCOffset < ").concat(o,") {\n                      xTexelR").concat(k,"C").concat(A," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(k,"C").concat(A," = vec4(0.);\n                    }\n                  ")),y+="\n                  xR".concat(k,"C").concat(A+1," = vec4(\n                    xTexelR").concat(k,"C").concat(A,".zw, xTexelR").concat(k,"C").concat(A+2,".xy);\n                ")):y+="\n                  xCOffset = xC + ".concat(E,";\n\n                  if(xR >= 0 && xR < ").concat(i," &&\n                    xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    xTexelR").concat(k,"C").concat(A+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(k,"C").concat(A+1," = xTexelR").concat(k,"C").concat(A+2,";\n                ")}}else A<v&&(y+="\n              if(xR >= 0 && xR < ".concat(i,") {\n            "),s%2==1?(y+="\n                xCOffset = xC + 1 - ".concat(f,";\n                if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(k,"C").concat(A," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(A," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(o,") {\n                  xTexelR").concat(k,"C").concat(A+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(A+2," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(A," = vec4(\n                  xTexelR").concat(k,"C").concat(A,".zw, xTexelR").concat(k,"C").concat(A+2,".zw);\n              "),A+1<v&&(y+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(f,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(k,"C").concat(A+1," = vec4(xTexelR").concat(k,"C").concat(A+2,".xy, final.xy);\n                "))):(y+="\n                if(xC >= 0 && xC < ".concat(o,") {\n                  xTexelR").concat(k,"C").concat(A," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(A," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(f,";\n                if(xCOffset >= 0 && xCOffset < ").concat(o,") {\n                  xTexelR").concat(k,"C").concat(A+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(k,"C").concat(A+2," = vec4(0.);\n                }\n\n                xR").concat(k,"C").concat(A," = vec4(\n                  xTexelR").concat(k,"C").concat(A,".xy, xTexelR").concat(k,"C").concat(A+2,".xy);\n              "),A+1<v&&(y+="\n                  xR".concat(k,"C").concat(A+1," = vec4(\n                    xTexelR").concat(k,"C").concat(A,".zw, xTexelR").concat(k,"C").concat(A+2,".zw);\n                "))),y+="}");A<v&&(y+="\n            vec4 wTexelR".concat(k,"C").concat(A," = getW(").concat(k,", ").concat(A,", d1, q);\n            wR").concat(k,"C").concat(A," = vec4(wTexelR").concat(k,"C").concat(A,".xz, wTexelR").concat(k,"C").concat(A,".xz);\n          "),A+1<v&&(y+="\n              vec4 wTexelR".concat(k,"C").concat(A+1," = getW(").concat(k,", ").concat(A+1,", d1, q);\n              wR").concat(k,"C").concat(A+1," =\n                vec4(wTexelR").concat(k,"C").concat(A+1,".xz, wTexelR").concat(k,"C").concat(A+1,".xz);")))}for(var C=0;C<h;C++)for(var S=0;S<v;S++)y+="dotProd += xR".concat(C,"C").concat(S," * wR").concat(C,"C").concat(S,";");var N="",T="";r&&(N=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),T="result = activation(result);");var D=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(N,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(f,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(s,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(y,"\n\n        vec4 result = dotProd;\n        ").concat(D,"\n        ").concat(T,"\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var $r=function e(t,n,r,a,i){"use strict";c.default(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=d.default(t,4),u=o[0],s=o[1],l=o[2],f=o[3],p=d.default(n,1)[0],h=d.default(r,2),v=h[0],g=h[1];this.outputShape=[p,v,g,f];var m="bilinear"===a?1:0,y=["".concat(s-1,".0"),"".concat(l-1,".0")],x=y[0],b=y[1],k=d.default(v>1?["".concat((s-1)/(v-1)),"(y2-y1) * height_ratio","y1*".concat(x," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(x)],3),w=k[0],A=k[1],E=k[2],C=d.default(g>1?["".concat((l-1)/(g-1)),"(x2-x1) * width_ratio","x1*".concat(b," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(b)],3),S=C[0],N=C[1],T=C[2];this.userCode="\n      const float height_ratio = float(".concat(w,");\n      const float width_ratio = float(").concat(S,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(u,") {\n          return;\n        }\n\n        float height_scale = ").concat(A,";\n        float width_scale = ").concat(N,";\n\n        float in_y = ").concat(E,";\n        if( in_y < 0.0 || in_y > ").concat(x," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(T,";\n        if( in_x < 0.0 || in_x > ").concat(b," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(m," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var ea=function(){"use strict";function e(t,n,r){c.default(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(ta(a,"coords"),")"),o=t[t.length-1],u="",s="";n?(u=r?"end != ".concat(o-1):"end != 0",s=r?"end + 1":"end - 1"):(u=r?"end + pow2 < ".concat(o):"end >= pow2",s=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(Ut(a)," coords = getOutputCoords();\n        int end = ").concat(na(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(u,") {\n          int idx = ").concat(s,";\n          ").concat(na(a,"coords")," = idx;\n          val += getX(").concat(ta(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return l.default(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function ta(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function na(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}s("1i51P");c=s("3QOYJ");var ra=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Xt.DENSE;var n=$t(t),r=Ct();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(St(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")};s("1i51P");c=s("3QOYJ");var aa=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Xt.DENSE;var n=$t(t),r=Ct();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat(St(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(r.output," = result;\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var ia=function(){"use strict";function e(t,n,r){c.default(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return l.default(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();s("1i51P");c=s("3QOYJ");var oa=function e(t){"use strict";c.default(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "};s("1i51P");c=s("3QOYJ");var ua=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.outTexUsage=Yt.DOWNLOAD;var n=Ct();this.outputShape=t,this.userCode="\n      ".concat(Tt,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var sa=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Yt.DOWNLOAD;var n=Ct();this.outputShape=t,this.userCode="\n      ".concat(Tt,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var ca=function e(t,n){"use strict";var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];c.default(this,e),this.variableNames=["A"];var a=Ct(),i=d.default(n,2),o=i[0],u=i[1];this.outputShape=t;var s="result";r&&(s="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(Nt(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(u,";\n        int c = imod(flatIndex, ").concat(u,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(s,", 0., 0., 0.);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var la=function e(t,n){"use strict";var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];c.default(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=Ct(),i=d.default(n,2),o=i[0],u=i[1];this.outputShape=t;var s="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var f=0;f<=1;f++)for(var p=0;p<=1;p++){var h=2*f+p;s+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(p," < ").concat(t[2],") {\n            localCoords[2] += ").concat(p,";\n            if(localCoords[1] + ").concat(f," < ").concat(t[1],") {\n              localCoords[1] += ").concat(f,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(u,";\n              c = imod(flatIndex, ").concat(u,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(u,".0, ").concat(o,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(h,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(h,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(h,"] = values[2];\n              } else {\n                result[").concat(h,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(Nt(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(s,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")};s("1i51P");c=s("3QOYJ");var fa="return real * expR - imag * expI;",da="return real * expI + imag * expR;",pa=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),o=r?"".concat(a,".0"):"1.0";this.userCode="\n      const float exponentMultiplier = ".concat(i,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(t,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(o,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var ha=function(){"use strict";function e(t,n){c.default(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return l.default(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();s("1i51P");c=s("3QOYJ");var va=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["A","indices"];var a=t.slice();a[r]=n,this.outputShape=a,this.rank=a.length;var i=Ut(this.rank),o=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank ".concat(n," is not yet supported"));if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<e.length;i++)i===t?a.push("int(getIndices(".concat(r[i],"))")):a.push("".concat(r[i]));return a.join()}(t,r);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")};s("1i51P");c=s("3QOYJ");var ga=function e(t,n,r){"use strict";c.default(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=Ut(n.length),i=Ut(r.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(o,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),d=s("6vecG"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");re=s("lU3MY"),g=s("kglvN");s("1i51P");d=s("6vecG");function ma(e){var t=Ct();return function(e,t){var n=Fn(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(vn(e,(function(){return e.shaderSource(n,t)})),vn(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function ya(e){return function(e,t){var n=Fn(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return vn(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),vn(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function xa(e){return function(e,t){var n=Fn(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return vn(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),vn(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function ba(e,t,n,r,a,i){!function(e,t){var n=re.env().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var o=function(e){return Fn(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),u=e.TEXTURE_2D;return vn(e,(function(){return e.bindTexture(u,o)})),vn(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),vn(e,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),vn(e,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),vn(e,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),vn(e,(function(){return e.texImage2D(u,0,r,t,n,0,a,i,null)})),vn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),o}function ka(e){return e.internalFormatFloat}function wa(e){return e.internalFormatHalfFloat}function Aa(e){return e.downloadTextureFormat}function Ea(e){return e.internalFormatPackedFloat}function Ca(e){return e.internalFormatPackedHalfFloat}function Sa(e,t,n,r,a,i,o,u){var s=e,c=new Float32Array(function(e,t){var n=d.default(en(e,t),2);return n[0]*n[1]*4}(i,o));return s.bindBuffer(s.PIXEL_PACK_BUFFER,t),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,c),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),c}var Na=function(){"use strict";function e(t){c.default(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=re.env().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){dn[e]=t}(n,t)):this.gl=hn(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===re.env().getNumber("WEBGL_VERSION")){var i="OES_texture_half_float";if(this.textureFloatExtension=mn(this.gl,"OES_texture_float"),Pn(this.gl,i))this.textureHalfFloatExtension=mn(this.gl,i);else if(re.env().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),Pn(this.gl,a))this.colorBufferHalfFloatExtension=mn(this.gl,a);else if(re.env().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",Pn(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!Pn(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=ya(this.gl),this.indexBuffer=xa(this.gl),this.framebuffer=function(e){return Fn(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=tn(this.gl,this.textureHalfFloatExtension)}return l.default(e,[{key:"debug",get:function(){return re.env().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;vn(t,(function(){return t.finish()})),vn(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),vn(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),vn(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),vn(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),vn(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=d.default(Zt(t,n),2);return ba(e,a[0],a[1],ka(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=d.default(Zt(t,n),2);return ba(e,a[0],a[1],wa(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=d.default(Zt(t,n),2);return ba(e,a[0],a[1],Aa(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){vn(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?vn(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):vn(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),vn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,u,s;vn(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),u=e.UNSIGNED_BYTE,s=e.RGBA):(o=new Float32Array(n*r*4),u=e.FLOAT,s=i.internalFormatPackedFloat),o.set(a),vn(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,s,n,r,0,e.RGBA,u,o)})),vn(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=d.default(en(t,n),2);return ba(e,a[0],a[1],Ca(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=d.default(en(t,n),2);return ba(e,a[0],a[1],Ea(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(Tn(this.gl,this.framebuffer),this.outputTexture=null),vn(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=d.default(Zt(t,n),2),i=a[0],o=a[1],u=new Uint8Array(t*n*4);return vn(e,(function(){return e.readPixels(0,0,i,o,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return Sa(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();vn(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return vn(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),vn(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),vn(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n;if(re.env().getBool("WEBGL_FENCE_API_ENABLED")){var r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=r.clientWaitSync(a,0,0);return e===r.ALREADY_SIGNALED||e===r.CONDITION_SATISFIED},t=a}else if(re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0){var i=this;t=this.beginQuery(),this.endQuery(),n=function(){return i.isQueryAvailable(t,re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}}else n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return vn(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=yn(t,e),r=ma(t),a=function(e){return Fn(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return vn(t,(function(){return t.attachShader(a,r)})),vn(t,(function(){return t.attachShader(a,n)})),function(e,t){if(vn(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&wn(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return vn(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),An(e,t,"clipSpacePos",n,3,20,0)&&An(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&vn(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&wn(this.gl,this.program),vn(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?En(this.gl,e,t):Cn(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),vn(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),Sn(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=d.default(en(t,n),2),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&wn(this.gl,this.program),Dn(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),vn(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),vn(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=mn(this.gl,2===re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.repeatedTry((function(){return n.disposed||n.isQueryAvailable(e,re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return t.abrupt("return",n.getQueryTime(e,re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return t.stop()}}),r)})))()}},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||g.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),Nn(this.gl,e,this.framebuffer),this.debug&&Dn(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(Nn(this.gl,this.outputTexture,this.framebuffer),this.debug&&Dn(this.gl)):Tn(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;Nn(r,e,this.framebuffer),this.debug&&Dn(r),this.outputTexture=e,vn(r,(function(){return r.viewport(0,0,t,n)})),vn(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),vn(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();s("jbRpz");re=s("lU3MY"),g=s("kglvN");function Ta(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((function(e){return e.shapeInfo})),u={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},s=Ft(i,u,a,t.packedInputs),c=e.createProgram(s),l=null,f=e.getUniformLocation(c,"NAN",!1);1===re.env().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var d={},p=0;p<t.variableNames.length;p++){var h=t.variableNames[p];d[h]=e.getUniformLocation(c,h,false),d["offset".concat(h)]=e.getUniformLocation(c,"offset".concat(h),false)}return{program:t,source:s,webGLProgram:c,uniformLocations:d,inShapeInfos:o,outShapeInfo:u,infLoc:l,nanLoc:f}}function Da(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!g.arraysEqual(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var o=e.texShape,u=a.isUniform?null:a.texData.texShape;if(!g.arraysEqual(o,u))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(o," and ").concat(u," must match"))}}))}function Fa(e,t,n,r,a){Da(t.inShapeInfos,n),Da([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===re.env().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset".concat(a)];if(null!=i)if(n.isUniform)if(g.sizeFromShape(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var u=n.uniformValues;u instanceof Float32Array||(u=new Float32Array(u)),e.gl.uniform1fv(i,u)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}function Oa(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a}s("1i51P");c=s("3QOYJ");var _a=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,u=r.strideHeight,s=r.padInfo,l=r.outWidth,f=r.dilationWidth,d=r.dilationHeight,p=r.dataFormat,h=s.left,v=s.top,g=i*a,m=Ct(),y="channelsLast"===p,x=y?0:1,b=y?1:2,k="",w=0;w<=1;w++)for(var A=0;A<=1;A++)k+="\n          blockIndex = rc.y + ".concat(A,";\n          pos = rc.x + ").concat(w,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(l,")) * ").concat(u," - ").concat(v,";\n            d0 = offsetY + ").concat(d," * (pos / ").concat(g,");\n\n            if(d0 < ").concat(n[x]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(l,".) * ").concat(o,". - ").concat(h,".);\n              d1 = offsetX + ").concat(f," * (int(mod(float(pos), ").concat(g,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[b]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(y,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*w+A,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*w+A,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(k,"\n\n        ").concat(m.output," = result;\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Ia=function e(t,n,r,a,i){"use strict";c.default(this,e),this.variableNames=["x"],this.outputShape=[];var o,u=n,s=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(u,"; j <= ").concat(u,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(s,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Ra=function e(t,n,r,a,i){"use strict";c.default(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Ma=function e(t,n,r,a,i){"use strict";c.default(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,u=n,s=t[3]-1;this.outputShape=t;var l="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(l,")"):1===i?"1.0/(".concat(l,")"):"exp(log(".concat(l,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(u,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(u,"; j <= ").concat(u,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(s,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Ba=function e(t){"use strict";c.default(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,u=i-1-t.padInfo.top,s=o-1-t.padInfo.left,l=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(u,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(l," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Pa=function e(t){"use strict";c.default(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,u=t.dilationWidth,s=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,d=s-1-t.padInfo.front,p=l-1-t.padInfo.top,h=f-1-t.padInfo.left,v=s*l*f-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(p,", ").concat(h,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(s,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(l,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(u,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(v," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(l," * ").concat(f," +\n                  wR * ").concat(f," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var La=function e(t,n){"use strict";var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6];c.default(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n;var s=r?t[1]:t[2],l=Math.ceil(s/2),f=r?"i * 2, rc.y":"rc.y, i * 2",d=a?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],v="",g="";o&&(v=u?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(o,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(o,"\n        }"),g="result = activation(result);");var m=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      ".concat(v,"\n\n      const float sharedDimension = ").concat(l,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(l,"; i++) {\n          vec4 a = getMatrixA(rc.x, ").concat(f,");\n          vec4 b = getMatrixB(rc.x, ").concat(d,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(p[0]," * ").concat(h[0],");\n          result += (").concat(p[1]," * ").concat(h[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(m,"\n\n        ").concat(g,"\n\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var ja=function(){"use strict";function e(t,n,r){c.default(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return l.default(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}();s("1i51P");c=s("3QOYJ");var za=function e(t,n,r,a){"use strict";c.default(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Ua=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=Et("rc",n),a=Ut(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),u=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0"):"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(u,"));\n          }\n        }\n      ")}};s("1i51P");c=s("3QOYJ");var Va=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Ut(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float(").concat(r,"));\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(s,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(u,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float(").concat(r,"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")};s("1i51P");c=s("3QOYJ");var Wa=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=Ut(a),o=n.map((function(e){return e[0]})).join(","),u=n.map((function(e,n){return e[0]+t[n]})).join(","),s=Et("rc",a),l=Et("source",a),f="".concat(s[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(l.slice(-2).join(),")"),p=["".concat(i," rc = outputLoc;"),"".concat(s[a-1]," += 1;\n       if(").concat(f,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(s[a-2]," += 1;\n       if(").concat(s[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(s[a-1]," += 1;\n         if(").concat(f,") {")],h=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",v="",g=0,m=1===a?2:4;g<m;g++)v+="\n        ".concat(p[g],"\n        if (").concat(h,") {\n          result[").concat(g,"] = float(").concat(r,");\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(g,"] = getChannel(getX(").concat(l.join(),"), ").concat(d,");\n        }\n      ");v+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(u,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(v,"\n        setOutput(result);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var Ga=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var a=d.default(n.shape,3),i=a[1],o=a[2],u=d.default(t.shape,3),s=u[1],l=u[2],f=[r&&s>1?i-1:i,r&&l>1?o-1:o],p=[r&&s>1?s-1:s,r&&l>1?l-1:l],h=f[0]/p[0],v=f[1]/p[1],g=1/h,m=1/v,y=2*Math.ceil(g)+2,x=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(v,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(x,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var Ha=function e(t,n,r,a){"use strict";c.default(this,e),this.variableNames=["A"],this.outputShape=[];var i=d.default(t,4),o=i[0],u=i[1],s=i[2],l=i[3];this.outputShape=[o,n,r,l];var f=[a&&n>1?u-1:u,a&&r>1?s-1:s],p=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(f[0]/p[0],",\n          ").concat(f[1]/p[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var qa=function e(t,n,r,a){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var i=d.default(t,4),o=i[0],u=i[1],s=i[2],l=i[3];this.outputShape=[o,n,r,l];var f=[a&&n>1?u-1:u,a&&r>1?s-1:s],p=[a&&n>1?n-1:n,a&&r>1?r-1:r];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(f[0]/p[0],",\n          ").concat(f[1]/p[1],",\n          ").concat(f[1]/p[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(s,".0,\n                                     ").concat(s,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(l-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var Ja=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n.shape;var a=d.default(n.shape,3),i=a[1],o=a[2],u=d.default(t.shape,3),s=u[1],l=u[2],f=[r&&s>1?i-1:i,r&&l>1?o-1:o],p=[r&&s>1?s-1:s,r&&l>1?l-1:l],h=f[0]/p[0],v=f[1]/p[1],g=1/h,m=1/v,y=2*Math.ceil(g)+2,x=2*Math.ceil(m)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(h,");\n        const float widthScale = float(").concat(v,");\n\n        const float invHeightScale = float(").concat(g,");\n        const float invWidthScale = float(").concat(m,");\n\n        const int winHeight = int(").concat(y,");\n        const int winWidth = int(").concat(x,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(s,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(f[0],") *\n                (float(dyR) / float(").concat(p[0],"));\n\n            float sourceFracCol =\n                float(").concat(f[1],") *\n                  (float(dyC) / float(").concat(p[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};s("1i51P");c=s("3QOYJ"),d=s("6vecG");var Ka=function e(t,n,r,a){"use strict";c.default(this,e),this.variableNames=["A"],this.outputShape=[];var i=d.default(t,4),o=i[0],u=i[1],s=i[2],l=i[3];this.outputShape=[o,n,r,l];var f=[a&&n>1?u-1:u,a&&r>1?s-1:s],p=[a&&n>1?n-1:n,a&&r>1?r-1:r],h=a?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(f[0]/p[0],",\n          ").concat(f[1]/p[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(s,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(h,")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var Xa=function e(t,n){"use strict";c.default(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=Ut(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")};s("1i51P");c=s("3QOYJ");var Ya=function e(t,n){"use strict";c.default(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a,i=Et("rc",r),o="".concat(i[r-1]," + 1 < ").concat(this.outputShape[r-1]),u="".concat(i[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=Ut(r);function l(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(o,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat((a=i.slice(),l(a)),";\n          if(").concat(o,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",l(e)}(i.slice()),";\n          }\n          if(").concat(u,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",l(e)}(i.slice()),";\n            if(").concat(o,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",l(e)}(i.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")};s("1i51P");c=s("3QOYJ");var Qa=function e(t,n,r,a,i,o){"use strict";c.default(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var u=Ut(i.length),s=Ut(o.length),l="";1===r?l="i":2===r&&(l="i, j");var f="getIndices(".concat(l,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var p="getUpdates(".concat(d,")"),h=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(u," strides = ").concat(u,"(").concat(i,");\n\n        void main() {\n          ").concat(s," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(f,");\n              flattenedIndex += index * ").concat(h,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(p,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")};s("1i51P");c=s("3QOYJ");var Za=function e(t,n){"use strict";c.default(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,u=o*Math.ceil(i/r);this.outputShape=[a,u];var s=4*Math.floor(r/4),l=r%4,f="\n        sumValue += dot(values, segFilter);\n    ",d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var p="";i%r>0&&(p="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(p,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(s,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(s,";\n        if (").concat(1===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===l,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")};s("1i51P");c=s("3QOYJ");var $a=function e(t,n,r){"use strict";var a,i;if(c.default(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],s=[],l=0;l<n.length;l++)s.push("".concat(o[l])),l<t&&u.push("".concat(o[l]));a=u.join(),i=s.join()}var f=Ut(r);this.userCode="\n      void main() {\n        ".concat(f," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var ei=function(){"use strict";function e(t){c.default(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Ut(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return ti.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),o=t.map((function(e,t){return"sourceLoc.".concat(ti[t]," = start[").concat(t,"] + coords.").concat(ti[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return l.default(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),ti=["x","y","z","w","u","v"];s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var ni=function(){"use strict";function e(t){c.default(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Ut(this.rank),r=Et("coords",this.rank),a=Et("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),u="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),s=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),l=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(l,"\n        vec4 result = vec4(0.);\n        ").concat(u,"\n        ").concat(s,"\n        setOutput(result);\n      }\n    ")}return l.default(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();s("1i51P");c=s("3QOYJ");var ri=function e(t,n,r){"use strict";c.default(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=Ut(r.length),o=Ut(r.length),u="";if(1===a)u="coords * strides + begin";else{var s=0;u=r.map((function(e,t){return s++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(s-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(u,"));\n      }\n    ")};s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),d=s("6vecG");s("jbRpz");re=s("lU3MY");var ai=function(){"use strict";function e(t){c.default(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return l.default(e,[{key:"acquireTexture",value:function(e,t,n){var r=oi(t,n),a=ui(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var i,o=ii(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=o,this.log();var u=this.freeTextures[a].shift();return this.usedTextures[a].push(u),u}return r===Qt.PACKED_2X2_FLOAT32?i=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Qt.PACKED_2X2_FLOAT16?i=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Qt.UNPACKED_FLOAT32?i=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Qt.UNPACKED_FLOAT16?i=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Qt.PACKED_4X1_UNSIGNED_BYTE&&(i=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(i),this.numUsedTextures++,this._numBytesAllocated+=o,this.log(),i}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=oi(n,r),i=ui(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var o=ii(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),u=re.env().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==u&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=o):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;var s=this.usedTextures[i],c=s.indexOf(e);if(c<0)throw new Error("Cannot release a texture that was never provided by this texture manager");s.splice(c,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function ii(e,t,n,r,a){var i,o=function(e,t){switch(e){case Qt.PACKED_2X2_FLOAT32:return Ea(t);case Qt.PACKED_2X2_FLOAT16:return Ca(t);case Qt.UNPACKED_FLOAT32:return ka(t);case Qt.UNPACKED_FLOAT16:return wa(t);case Qt.PACKED_4X1_UNSIGNED_BYTE:return Aa(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var u=d.default(en(e[0],e[1]),2);i=u[0]*u[1]}else{var s=d.default(Zt(e[0],e[1]),2);i=s[0]*s[1]}var c=function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,o);return i*c}function oi(e,t){if(e===Yt.UPLOAD)return Qt.PACKED_2X2_FLOAT32;if(e===Yt.RENDER||null==e)return function(e){return re.env().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?Qt.PACKED_2X2_FLOAT32:Qt.UNPACKED_FLOAT32:e?Qt.PACKED_2X2_FLOAT16:Qt.UNPACKED_FLOAT16}(t);if(e===Yt.DOWNLOAD||e===Yt.PIXELS)return Qt.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function ui(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}s("1i51P");c=s("3QOYJ");var si=function e(t,n){"use strict";c.default(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=Ut(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")};s("1i51P");c=s("3QOYJ");var ci="return x;",li="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",fi="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",di="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",pi=function e(t,n){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")};s("1i51P");c=s("3QOYJ");var hi=function e(t){"use strict";c.default(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=Et("rc",n),a=Ut(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),u=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(u,"));\n      }\n    ")},vi=fe.segment_util,gi=Te.split,mi=Te.tile,yi=Te.topkImpl,xi=Te.whereImpl,bi={};function ki(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?ci:ar;if("relu"===e)return t?li:or;if("elu"===e)return t?di:sr;if("relu6"===e)return t?fi:ur;if("prelu"===e)return t?Gt:kt;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var wi=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){var t,a;if(c.default(this,r),(t=n.call(this)).pendingRead=new WeakMap,t.pendingDisposal=new WeakSet,t.dataRefCount=new WeakMap,t.numBytesInGPU=0,t.uploadWaitMs=0,t.downloadWaitMs=0,t.warnedAboutMemory=!1,t.warnedAboutCPUBackend=!1,t.pendingDeletes=0,t.disposed=!1,!re.env().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=hn(re.env().getNumber("WEBGL_VERSION"));t.binaryCache=((a=re.env().getNumber("WEBGL_VERSION"))in bi||(bi[a]={}),bi[a]),t.gpgpu=new Na(i),t.canvas=i.canvas,t.gpgpuCreatedLocally=!0}else t.gpgpu=e,t.binaryCache={},t.gpgpuCreatedLocally=!1,t.canvas=e.gl.canvas;return t.textureManager=new ai(t.gpgpu),t.numMBBeforeWarning=null==re.env().global.screen?1024:re.env().global.screen.height*re.env().global.screen.width*window.devicePixelRatio*600/1024/1024,t.texData=new Qe.DataStorage(Ye.default(t),m.engine()),t}return l.default(r,[{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((re.env().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||re.env().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:Yt.UPLOAD}),r}},{key:"move",value:function(e,t,n,r){if(re.env().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:Yt.UPLOAD})}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensors,i=t.slice,o=t.shape,u=t.isPacked;if(null!=i){var s;s=u?new pi(o,gr):new nr(o,gr);var c=this.runWebGLProgram(s,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,d,p=null!=this.activeTimers;if(p&&(f=g.now()),"complex64"===r){var h=a.real.dataSync(),v=a.imag.dataSync();d=fe.mergeRealAndImagArrays(h,v)}else d=this.getValuesFromTexture(e);return p&&(this.downloadWaitMs+=g.now()-f),this.convertAndCacheOnCPU(e,d)}},{key:"read",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a,i,o,u,s,c,l,f,d,p,h,m,y,x,b,k,w,A,E,C,S,N;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n.pendingRead.has(e)){t.next=3;break}return a=n.pendingRead.get(e),t.abrupt("return",new Promise((function(e){return a.push(e)})));case 3:if(i=n.texData.get(e),o=i.values,u=i.shape,s=i.slice,c=i.dtype,l=i.complexTensors,f=i.isPacked,null==s){t.next=12;break}return d=f?new pi(u,gr):new nr(u,gr),p=n.runWebGLProgram(d,[{dataId:e,shape:u,dtype:c}],c),h=n.read(p.dataId),n.disposeData(p.dataId),t.abrupt("return",h);case 12:if(null==o){t.next=14;break}return t.abrupt("return",n.convertAndCacheOnCPU(e));case 14:if(re.env().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==re.env().getNumber("WEBGL_VERSION")){t.next=16;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 16:if(m=null,"complex64"!==c&&re.env().get("WEBGL_BUFFER_SUPPORTED")&&(y=n.decode(e),b=n.texData.get(y.dataId),m=(x=n.gpgpu).createBufferFromTexture.apply(x,[b.texture].concat(Pe.default($t(u))))),n.pendingRead.set(e,[]),"complex64"===c){t.next=23;break}return t.next=23,n.gpgpu.createAndWaitForFence();case 23:if("complex64"!==c){t.next=33;break}return t.next=27,Promise.all([l.real.data(),l.imag.data()]);case 27:w=t.sent,A=w[0],E=w[1],k=fe.mergeRealAndImagArrays(A,E),t.next=34;break;case 33:null==m?k=n.getValuesFromTexture(e):(C=g.sizeFromShape(u),k=n.gpgpu.downloadFloat32MatrixFromBuffer(m,C));case 34:return null!=y&&n.disposeData(y.dataId),S=n.convertAndCacheOnCPU(e,k),N=n.pendingRead.get(e),n.pendingRead.delete(e),N.forEach((function(e){return e(S)})),n.pendingDisposal.has(e)&&(n.pendingDisposal.delete(e),n.disposeData(e),n.pendingDeletes--),t.abrupt("return",S);case 41:case"end":return t.stop()}}),r)})))()}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!gn(n)){if(re.env().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=g.sizeFromShape(n);if(re.env().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var o,u=this.decode(e),s=this.texData.get(u.dataId),c=(o=this.gpgpu).downloadMatrixFromPackedTexture.apply(o,[s.texture].concat(Pe.default($t(n)))).subarray(0,i);return this.disposeData(u.dataId),c}var l=re.env().getBool("WEBGL_PACK")&&!0===a,f=l?Rn(n):n,d=l?new sa(f):new ua(f),p=this.runWebGLProgram(d,[{shape:f,dtype:r,dataId:e}],"float32"),h=this.texData.get(p.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture,h.texShape[0],h.texShape[1]).subarray(0,i);return this.disposeData(p.dataId),v}},{key:"time",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a,i,o,u,s,c,l;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=n.activeTimers,i=[],o=!1,null==n.programTimersStack?(n.programTimersStack=i,o=!0):n.activeTimers.push(i),n.activeTimers=i,e(),u=g.flatten(n.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),s=g.flatten(n.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),n.activeTimers=a,o&&(n.programTimersStack=null),c={uploadWaitMs:n.uploadWaitMs,downloadWaitMs:n.downloadWaitMs,kernelMs:null,wallMs:null},!(re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){t.next=19;break}return t.next=14,Promise.all(u);case 14:l=t.sent,c.kernelMs=g.sum(l),c.getExtraProfileInfo=function(){return l.map((function(e,t){return{name:s[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},t.next=20;break;case 19:c.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return n.uploadWaitMs=0,n.downloadWaitMs=0,t.abrupt("return",c);case 23:case"end":return t.stop()}}),r)})))()}},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:g.now(),endMs:null}}},{key:"endTimer",value:function(e){return re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=g.now(),e)}},{key:"getQueryTime",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(re.env().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){t.next=2;break}return t.abrupt("return",n.gpgpu.waitForQueryAndGetTime(e));case 2:return a=e,t.abrupt("return",a.endMs-a.startMs);case 4:case"end":return t.stop()}}),r)})))()}},{key:"disposeData",value:function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,u=t.slice,s=u&&u.origDataId||e,c=this.dataRefCount.get(s);c>1?this.dataRefCount.set(s,c-1):(this.dataRefCount.delete(s),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return re.env().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=m.engine().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,n=this,r=this.getCPUBackend();return this.warnedAboutCPUBackend||null!=r||re.env().getBool("IS_TEST")||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=r&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&g.sizeFromShape(e.shape)<t}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"complex",value:function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:m.engine().keep(e.clone()),imag:m.engine().keep(t.clone())},n}},{key:"real",value:function(e){return this.texData.get(e.dataId).complexTensors.real.clone()}},{key:"imag",value:function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()}},{key:"slice",value:function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===g.sizeFromShape(n))return b.tensor([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,a=Ze.isSliceContinous(e.shape,t,n);if(r||!a){var i=re.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ni(n):new ei(n),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,o)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)}},{key:"shallowSlice",value:function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var o=Ze.computeFlatOffset(t,e.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};var u=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,u+1),a}},{key:"stridedSlice",value:function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=Ze.computeOutShape(t,n,r);if(a.some((function(e){return 0===e})))return b.tensor([],a);var i=new ri(t,r,a);return this.compileAndRun(i,[e])}},{key:"reverse",value:function(e,t){var n=re.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Ya(e.shape,t):new Xa(e.shape,t);return this.compileAndRun(n,[e])}},{key:"concat",value:function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return $e.real(e)})),r=e.map((function(e){return et.imag(e)}));return tt.complex(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>re.env().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),i=this.concat(e.slice(0,a),t),o=this.concat(e.slice(a),t);return this.concat([i,o],t)}if(re.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var u=new Ur(e.map((function(e){return e.shape})),t);return this.compileAndRun(u,e)}var s=fe.computeOutShape(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,g.sizeFromShape(e.shape.slice(t)))})),l=new zr(c.map((function(e){return e.shape})));return this.compileAndRun(l,c).reshape(s)}},{key:"neg",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,lr,e.dtype);var t=new nr(e.shape,lr);return this.compileAndRun(t,[e])}},{key:"batchMatMul",value:function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],u=d.default(e.shape,1)[0];if((1===a||1===i)&&o>1e3){n&&(e=st.transpose(e,[0,2,1])),r&&(t=st.transpose(t,[0,2,1]));var s=1===i?e:e.as3D(u,o,1),c=1===i?2:1,l=1===i?t.as3D(u,1,o):t;return this.multiply(s,l).sum(c,!0)}var f=rt.upcastType(e.dtype,t.dtype),p=new La(e.shape,[u,a,i],n,r);return this.compileAndRun(p,[e,t],f)}},{key:"fusedBatchMatMul",value:function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,u=e.preluActivationWeights,s=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],l=d.default(t.shape,1)[0],f=rt.upcastType(t.dtype,n.dtype),p=null!=i,h=null!=u,v=o?ki(o,!0):null,g=new La(t.shape,[l,s,c],r,a,p,v,h),m=[t,n];return i&&m.push(i),u&&m.push(u),this.compileAndRun(g,m,f)}},{key:"multiply",value:function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new Br(Rr,e.shape,t.shape),i=new Br(Mr,e.shape,t.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],u=this.compileAndRun(a,o),s=this.compileAndRun(i,o),c=this.complex(u,s);return u.dispose(),s.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,bt,e.dtype);var l=new wt(bt,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)}},{key:"batchNorm",value:function(e,t,n,r,a,i){var o=[e,t,n],u=null;null!=r&&(u=r.shape,o.push(r));var s=null;if(null!=a&&(s=a.shape,o.push(a)),re.env().getBool("WEBGL_PACK_NORMALIZATION")){var c=new Ir(e.shape,t.shape,n.shape,u,s,i);return this.compileAndRun(c,o)}var l=new _r(e.shape,t.shape,n.shape,u,s,i);return this.compileAndRun(l,o)}},{key:"localResponseNormalization4D",value:function(e,t,n,r,a){var i=re.env().getBool("WEBGL_PACK_NORMALIZATION")?new Ma(e.shape,t,n,r,a):new Ia(e.shape,t,n,r,a);return this.compileAndRun(i,[e])}},{key:"LRNGrad",value:function(e,t,n,r,a,i,o){var u=new Ra(t.shape,r,a,i,o);return this.compileAndRun(u,[t,n,e])}},{key:"tile",value:function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return g.decodeString(e)})),r=Ee.buffer(e.shape,e.dtype,n);return mi(r,t)}var a=new si(e.shape,t);return this.compileAndRun(a,[e])}},{key:"pad",value:function(e,t,n){var r=re.env().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wa(e.shape,t,n):new Va(e.shape,t,n);return this.compileAndRun(r,[e])}},{key:"gather",value:function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new va(e.shape,t.size,n);return this.compileAndRun(r,[e,t])}},{key:"batchToSpaceND",value:function(e,t,n){g.assert(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=fe.getReshaped(e.shape,t,r),i=fe.getPermuted(a.length,t.length),o=fe.getReshapedPermuted(e.shape,t,r),u=fe.getSliceBeginCoords(n,t.length),s=fe.getSliceSize(o,n,t.length);return st.transpose(e.reshape(a),i).reshape(o).slice(u,s)}},{key:"spaceToBatchND",value:function(e,t,n){var r;g.assert(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var a=t.reduce((function(e,t){return e*t})),i=[[0,0]];(r=i).push.apply(r,Pe.default(n));for(var o=1+t.length;o<e.shape.length;++o)i.push([0,0]);var u=e.pad(i),s=fe.getReshaped(u.shape,t,a,!1),c=fe.getPermuted(s.length,t.length,!1),l=fe.getReshapedPermuted(u.shape,t,a,!1),f=st.transpose(u.reshape(s),c);return Er.reshape(f,l)}},{key:"reduce",value:function(e,t,n){var r=e.shape[0],a=e.shape[1],i=fe.computeOptimalWindowSize(a),o=Math.ceil(a/i),u=new cn({windowSize:i,inSize:a,batchSize:r,outSize:o},t),s=this.compileAndRun(u,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)}},{key:"argReduce",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=fe.computeOptimalWindowSize(a),o={windowSize:i,inSize:a,batchSize:r,outSize:Math.ceil(a/i)},u=new Tr(o,t,null==n),s=[e];null!=n&&s.push(n);var c=this.compileAndRun(u,s,"int32");return 1===c.shape[1]?c:this.argReduce(e,t,c)}},{key:"argReducePacked",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null!=n?n.shape:e.shape,a=r[r.length-1],i=fe.computeOptimalWindowSize(a),o=new Dr(r,i,t,null==n),u=null==n?[e]:[e,n],s=this.compileAndRun(o,u,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s}},{key:"sum",value:function(e,t){fe.assertAxesAreInnerMostDims("sum",t,e.rank);var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=g.sizeFromShape(a),o=e.as2D(-1,i),u=rt.sumOutType(e.dtype);return this.reduce(o,"sum",u).reshape(r)}},{key:"prod",value:function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=g.sizeFromShape(a),o=e.as2D(-1,i),u=rt.sumOutType(e.dtype);return this.reduce(o,"prod",u).reshape(r)}},{key:"unsortedSegmentSum",value:function(e,t,n){var r=0,a=fe.getAxesPermutation([r],e.rank),i=e;null!=a&&(i=st.transpose(e,a),r=fe.getInnerMostAxes(1,e.rank)[0]);var o=vi.computeOutShape(i.shape,r,n),u=g.sizeFromShape([i.shape[r]]),s=i.as2D(-1,u),c=rt.sumOutType(e.dtype),l=this.segOpCompute(s,"unsortedSegmentSum",t,c,n).reshape(o);return null!=a&&(l=st.transpose(l,fe.getUndoAxesPermutation(a))),l}},{key:"segOpCompute",value:function(e,t,n,r,a){var i=e.shape[0],o=e.shape[1],u=vi.segOpComputeOptimalWindowSize(o,a),s=new Za({windowSize:u,inSize:o,batchSize:i,numSegments:a},t),c=this.compileAndRun(s,[e,n],r);return c.shape[1]===a?c:(n=Cr.range(0,a).tile([o/u]),this.segOpCompute(c,t,n,r,a))}},{key:"argMinMaxReduce",value:function(e,t,n){var r=[t];if(fe.assertAxesAreInnerMostDims("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!re.env().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=d.default(fe.computeOutAndReduceShapes(e.shape,r),2),i=a[0],o=a[1],u=g.sizeFromShape(o),s=e.as2D(-1,u);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)}},{key:"argMin",value:function(e,t){return this.argMinMaxReduce(e,t,"min")}},{key:"argMax",value:function(e,t){return this.argMinMaxReduce(e,t,"max")}},{key:"cumsum",value:function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(e.rank-1," ")+"but got axis=".concat(t));for(var a=e.shape[t],i=e,o=0;o<=Math.ceil(Math.log2(a))-1;o++){var u=new ea(e.shape,!1,r),s=u.getCustomSetupFunc(o),c=i;i=this.compileAndRun(u,[i],i.dtype,s),c.dispose()}if(n){var l=new ea(e.shape,n,r),f=i;i=this.compileAndRun(l,[i]),f.dispose()}return i}},{key:"equal",value:function(e,t){if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new wt("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"notEqual",value:function(e,t){if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new wt("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"less",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new wt("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"lessEqual",value:function(e,t){if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new wt("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"greater",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new wt("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"greaterEqual",value:function(e,t){if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new wt("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"logicalNot",value:function(e){var t=new nr(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])}},{key:"logicalAnd",value:function(e,t){if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new wt("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"logicalOr",value:function(e,t){if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new wt("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")}},{key:"select",value:function(e,t,n){var r=new $a(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],rt.upcastType(t.dtype,n.dtype))}},{key:"where",value:function(e){fe.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return xi(e.shape,t)}},{key:"topk",value:function(e,t,n){var r=e.dataSync();return yi(r,e.shape,e.dtype,t,n)}},{key:"min",value:function(e,t){fe.assertAxesAreInnerMostDims("min",t,e.rank);var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=g.sizeFromShape(a),o=e.as2D(-1,i);return this.reduce(o,"min",o.dtype).reshape(r)}},{key:"minimum",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new wt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"mod",value:function(e,t){var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new wt("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"maximum",value:function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new wt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"all",value:function(e,t){fe.assertAxesAreInnerMostDims("all",t,e.rank);var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=g.sizeFromShape(a),o=e.as2D(-1,i);return this.reduce(o,"all",o.dtype).reshape(r)}},{key:"any",value:function(e,t){fe.assertAxesAreInnerMostDims("any",t,e.rank);var n=d.default(fe.computeOutAndReduceShapes(e.shape,t),2),r=n[0],a=n[1],i=g.sizeFromShape(a),o=e.as2D(-1,i);return this.reduce(o,"any",o.dtype).reshape(r)}},{key:"floorDiv",value:function(e,t){var n="int32";if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",n);var r=new wt("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"add",value:function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,yt);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=rt.upcastType(e.dtype,t.dtype);if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,yt,n);var r=new wt(yt,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new pi(e.shape,t);return this.compileAndRun(r,[e],n)}},{key:"packedBinaryOp",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=new Ht(n,e.shape,t.shape,a);return this.compileAndRun(i,[e,t],r)}},{key:"complexSeparableBinaryOp",value:function(e,t,n){var r=this,a=this.texData.get(e.dataId),i=this.texData.get(t.dataId),o=d.default([[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map((function(a){var i=d.default(a,2),o=i[0],u=i[1],s=r.makeComplexComponentTensorInfo(e,o),c=r.makeComplexComponentTensorInfo(t,u),l=new wt(n,e.shape,t.shape);return r.compileAndRun(l,[s,c],rt.upcastType(o.dtype,u.dtype))})),2),u=o[0],s=o[1],c=this.complex(u,s);return u.dispose(),s.dispose(),c}},{key:"makeComplexComponentTensorInfo",value:function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}},{key:"addN",value:function(e){if(1===e.length)return e[0];if(e.length>re.env().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map((function(e){return e.dtype})).reduce((function(e,t){return rt.upcastType(e,t)})),i=e.map((function(e){return e.shape})),o=re.env().getBool("WEBGL_PACK")?new Nr(e[0].shape,i):new Sr(e[0].shape,i);return this.compileAndRun(o,e,a)}},{key:"subtract",value:function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,xt);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=rt.upcastType(e.dtype,t.dtype);if(re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,xt,e.dtype);var r=new wt(xt,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)}},{key:"pow",value:function(e,t){var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new wt("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=rt.upcastType(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)}},{key:"ceil",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,fr,e.dtype);var t=new nr(e.shape,fr);return this.compileAndRun(t,[e])}},{key:"floor",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,dr,e.dtype);var t=new nr(e.shape,dr);return this.compileAndRun(t,[e])}},{key:"sign",value:function(e){var t=new nr(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])}},{key:"isNaN",value:function(e){var t=new nr(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")}},{key:"isInf",value:function(e){var t=new nr(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")}},{key:"isFinite",value:function(e){var t=new nr(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")}},{key:"round",value:function(e){var t=new nr(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])}},{key:"exp",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,pr,e.dtype);var t=new nr(e.shape,pr);return this.compileAndRun(t,[e])}},{key:"expm1",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,hr,e.dtype);var t=new nr(e.shape,hr);return this.compileAndRun(t,[e])}},{key:"softmax",value:function(e,t){var n=g.parseAxisParam([t],e.shape),r=at.max(e,n),a=fe.expandShapeToKeepDim(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),u=this.sum(o,n).reshape(a);return it.div(o,u)}},{key:"log",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new nr(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])}},{key:"log1p",value:function(e){var t=new nr(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])}},{key:"sqrt",value:function(e){var t=new nr(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])}},{key:"rsqrt",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new nr(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])}},{key:"reciprocal",value:function(e){var t=new nr(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])}},{key:"relu",value:function(e){var t;return t=re.env().getBool("WEBGL_PACK")?new pi(e.shape,li):new nr(e.shape,or),this.compileAndRun(t,[e])}},{key:"relu6",value:function(e){var t;return t=re.env().getBool("WEBGL_PACK")?new pi(e.shape,fi):new nr(e.shape,ur),this.compileAndRun(t,[e])}},{key:"prelu",value:function(e,t){var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht(Gt,e.shape,t.shape):new wt(kt,e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"elu",value:function(e){if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,di,e.dtype);var t=new nr(e.shape,sr);return this.compileAndRun(t,[e])}},{key:"eluDer",value:function(e,t){var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new wt("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"selu",value:function(e){var t=new nr(e.shape,cr);return this.compileAndRun(t,[e])}},{key:"int",value:function(e){var t=new nr(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")}},{key:"clip",value:function(e,t,n){var r,a=(r=re.env().getBool("WEBGL_PACK_CLIP")?new Lr(e.shape):new Pr(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(re.env().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,ir,e.dtype);var t=new nr(e.shape,ir);return this.compileAndRun(t,[e])}},{key:"complexAbs",value:function(e){var t=this.texData.get(e.dataId),n=new jr(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)}},{key:"sigmoid",value:function(e){var t=new nr(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])}},{key:"softplus",value:function(e){var t=new nr(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])}},{key:"sin",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(t,[e])}},{key:"cos",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(t,[e])}},{key:"tan",value:function(e){var t=new nr(e.shape,"return tan(x);");return this.compileAndRun(t,[e])}},{key:"asin",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(t,[e])}},{key:"acos",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(t,[e])}},{key:"atan",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(t,[e])}},{key:"atan2",value:function(e,t){var n=re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Ht("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new wt("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])}},{key:"sinh",value:function(e){var t=new nr(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])}},{key:"cosh",value:function(e){var t=new nr(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])}},{key:"tanh",value:function(e){var t=new nr(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])}},{key:"asinh",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(t,[e])}},{key:"acosh",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(t,[e])}},{key:"atanh",value:function(e){var t=new nr(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(t,[e])}},{key:"erf",value:function(e){var t=new nr(e.shape,vr);return this.compileAndRun(t,[e])}},{key:"step",value:function(e,t){var n=new nr(e.shape,function(){return rr+"\n    return x > 0.0 ? 1.0 : float(".concat(arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,");\n  ")}(t));return this.compileAndRun(n,[e])}},{key:"conv2dByMatMul",value:function(e,t,n,r,a,i){var o=e.shape,u=this.texData.get(e.dataId),s=n.inChannels,c=o[0]*o[1]*o[2],l=n.outChannels,f="channelsLast"===n.dataFormat,d=(1===c||1===l)&&s>1e3,p=o[2]%2!=0&&!!u.isPacked;if(d||!re.env().getBool("WEBGL_LAZILY_UNPACK")||!re.env().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var h=f?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],v=this.reshape(e,[1,h,n.inChannels]),y=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:y,transposeA:false,transposeB:false,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var x=f?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),b={dataId:e.dataId,shape:[1,x,n.inChannels],dtype:e.dtype},k=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,g.assert(Bn(u.shape,b.shape),(function(){return"packed reshape ".concat(u.shape," to ").concat(b.shape," isn't free")}));var w=this.reshape(t,[1,n.inChannels,n.outChannels]),A=this.fusedBatchMatMul({a:b,b:w,transposeA:false,transposeB:false,bias:r,activation:a,preluActivationWeights:i}),E=this.texData.get(A.dataId);return g.assert(E.isPacked,(function(){return"batchMatMul result is expected to be packed"})),u.shape=k,E.shape=n.outShape,m.engine().makeTensorFromDataId(A.dataId,n.outShape,A.dtype)}},{key:"conv2dWithIm2Row",value:function(e,t,n,r,a,i){var o=n.filterWidth,u=n.filterHeight,s=n.inChannels,c=n.outWidth,l=n.outHeight,f="channelsLast"===n.dataFormat,d=o*u*s,p=l*c,h=[d,p],v=e.squeeze([0]),g=t.reshape([1,d,-1]),m=new _a(h,v.shape,n),y=this.compileAndRun(m,[v]).reshape([1,h[0],h[1]]),x=null!=r,b=null!=i,k=a?ki(a,!0):null,w=new La(y.shape,[1,p,n.outChannels],!0,!1,x,k,b),A=[y,g];r&&A.push(r),b&&A.push(i);var E=this.compileAndRun(w,A);return f?E.reshape([1,l,c,n.outChannels]):E.reshape([1,n.outChannels,l,c])}},{key:"fusedConv2d",value:function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,i,o);if(re.env().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,i,o);var u=null!=a,s=null!=o,c=i?ki(i,!1):null,l=new Xr(r,u,c,s),f=[t,n];return a&&f.push(a),o&&f.push(o),this.compileAndRun(l,f)}},{key:"conv2d",value:function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(re.env().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new Xr(n);return this.compileAndRun(r,[e,t])}},{key:"conv2dDerInput",value:function(e,t,n){var r=new Gr(n);return this.compileAndRun(r,[e,t])}},{key:"conv2dDerFilter",value:function(e,t,n){var r=new Wr(n);return this.compileAndRun(r,[e,t])}},{key:"fusedDepthwiseConv2D",value:function(e){var t,n=e.input,r=e.filter,a=e.convInfo,i=e.bias,o=e.activation,u=e.preluActivationWeights,s=re.env().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,c=o?ki(o,s):null,l=[n,r],f=null!=i,d=null!=u;return f&&l.push(i),d&&l.push(u),s?(t=new Zr(a,f,c,d),this.compileAndRun(t,l)):(t=new Qr(a,f,c,d),this.compileAndRun(t,l))}},{key:"depthwiseConv2D",value:function(e,t,n){var r;return re.env().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new Zr(n),this.compileAndRun(r,[e,t])):(r=new Qr(n),this.compileAndRun(r,[e,t]))}},{key:"depthwiseConv2DDerInput",value:function(e,t,n){var r=new Kr(n);return this.compileAndRun(r,[e,t])}},{key:"depthwiseConv2DDerFilter",value:function(e,t,n){var r=new Jr(n);return this.compileAndRun(r,[e,t])}},{key:"conv3d",value:function(e,t,n){var r=new Yr(n);return this.compileAndRun(r,[e,t])}},{key:"conv3dDerInput",value:function(e,t,n){var r=new qr(n);return this.compileAndRun(r,[e,t])}},{key:"conv3dDerFilter",value:function(e,t,n){var r=new Hr(n);return this.compileAndRun(r,[e,t])}},{key:"maxPool",value:function(e,t){var n=new qn(t,"max",!1);return this.compileAndRun(n,[e])}},{key:"avgPool",value:function(e,t){var n=new qn(t,"avg",!1);return this.compileAndRun(n,[e],"float32")}},{key:"maxPoolBackprop",value:function(e,t,n,r){var a=new qn(r,"max",!0),i=this.compileAndRun(a,[t]),o=new Ba(r),u=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),u}},{key:"avgPoolBackprop",value:function(e,t,n){var r=new Fr(n);return this.compileAndRun(r,[e],t.dtype)}},{key:"cast",value:function(e,t){return fe.castTensor(e,t,this)}},{key:"unstack",value:function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),u=e.shape.slice();u[t]=1;for(var s=new Array(n),c=0;c<s.length;c++)o[t]=c,s[c]=this.slice(e,o,u).reshape(r);return s}},{key:"avgPool3d",value:function(e,t){var n=new Jn(t,"avg",!1);return this.compileAndRun(n,[e],"float32")}},{key:"avgPool3dBackprop",value:function(e,t,n){var r=new Or(n);return this.compileAndRun(r,[e],t.dtype)}},{key:"maxPool3d",value:function(e,t){var n=new Jn(t,"max",!1);return this.compileAndRun(n,[e],"float32")}},{key:"maxPool3dBackprop",value:function(e,t,n,r){var a=new Jn(r,"max",!0),i=this.compileAndRun(a,[t]),o=new Pa(r),u=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),u}},{key:"reshape",value:function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!Bn(e.shape,t)&&(null===n.texture||!Bn(n.shape,t))){var r=this.packedReshape(e,t);return m.engine().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return fe.reshapeTensor(e,t)}},{key:"resizeBilinear",value:function(e,t,n,r){var a=re.env().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new qa(e.shape,t,n,r):new Ha(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")}},{key:"resizeBilinearBackprop",value:function(e,t,n){var r=new Ga(e,t,n);return this.compileAndRun(r,[e])}},{key:"resizeNearestNeighbor",value:function(e,t,n,r){var a=new Ka(e.shape,t,n,r);return this.compileAndRun(a,[e])}},{key:"resizeNearestNeighborBackprop",value:function(e,t,n){var r=new Ja(e,t,n);return this.compileAndRun(r,[e])}},{key:"multinomial",value:function(e,t,n,r){var a=t?e:lt.softmax(e),i=a.shape[0],o=a.shape[1],u=new ja(i,o,n),s=u.getCustomSetupFunc(r);return this.compileAndRun(u,[a],"int32",s)}},{key:"oneHot",value:function(e,t,n,r){var a=new za(e.size,t,n,r);return this.compileAndRun(a,[e])}},{key:"diag",value:function(e){var t=new oa(e.size);return this.compileAndRun(t,[e])}},{key:"cropAndResize",value:function(e,t,n,r,a,i){var o=new $r(e.shape,t.shape,r,a,i);return this.compileAndRun(o,[e,t,n],"float32")}},{key:"depthToSpace",value:function(e,t,n){g.assert(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(t)}));var r=e.shape[0],a="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],o="NHWC"===n?e.shape[3]:e.shape[1],u=a*t,s=i*t,c=o/(t*t),l=new ia("NHWC"===n?[r,u,s,c]:[r,c,u,s],t,n);return this.compileAndRun(l,[e])}},{key:"split",value:function(e,t,n){return gi(e,t,n)}},{key:"scatterND",value:function(e,t,n){var r=fe.calculateShapes(t,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,u=r.strides,s=r.outputSize,c=[s/o,o],l=e.reshape([i,a]),f=t.reshape([i,o]);if(0===s)return fe.reshapeTensor(b.tensor([]),n);var d=nt.scalar(0),p=new Qa(i,a,l.rank,f.rank,u,c);return this.compileAndRun(p,[f,l,d]).reshape(n)}},{key:"sparseToDense",value:function(e,t,n,r){var a=fe.calculateShapes(t,e,n),i=a.sliceRank,o=a.numUpdates,u=a.strides,s=a.outputSize,c=new Qa(o,i,e.rank,t.rank,u,[s,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)}},{key:"fft",value:function(e){return this.fftImpl(e,!1)}},{key:"ifft",value:function(e){return this.fftImpl(e,!0)}},{key:"fftImpl",value:function(e,t){var n=this.texData.get(e.dataId),r=new pa(fa,e.shape,t),a=new pa(da,e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],o=this.compileAndRun(r,i),u=this.compileAndRun(a,i),s=this.complex(o,u).as2D(e.shape[0],e.shape[1]);return o.dispose(),u.dispose(),s}},{key:"gatherND",value:function(e,t){var n=t.shape,r=n[n.length-1],a=d.default(fe.prepareAndValidate(e,t),4),i=a[0],o=a[1],u=a[2],s=a[3],c=t.reshape([o,r]),l=e.reshape([e.size/u,u]),f=new ga(r,s,[o,u]);return this.compileAndRun(f,[l,c]).reshape(i)}},{key:"fill",value:function(e,t,n){if("string"===(n=n||g.inferDtype(t))){var r=g.getArrayFromDType(n,g.sizeFromShape(e));return r.fill(t),m.engine().makeTensor(r,e,n,this)}var a=new ha(e,t),i=a.getCustomSetupFunc(t);return this.compileAndRun(a,[],n,i)}},{key:"onesLike",value:function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)}},{key:"zerosLike",value:function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)}},{key:"linspace",value:function(e,t,n){return fe.linspaceImpl(e,t,n)}},{key:"makeTensorInfo",value:function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t){var n=this.makeTensorInfo(e,t).dataId;return m.engine().makeTensorFromDataId(n,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new hi(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new Ua(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[_n(e.shape)].concat(Pe.default(In(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[_n(t)].concat(Pe.default(In(t))),i=new fn(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=Rn(a);t=r?new aa(o):new ra(o);return{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=this,o=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(o.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Xt.DENSE){var s=$t(e.outputShape);u.texShape=s.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===g.sizeFromShape(o.shape))return u.values=g.getTypedArrayFromDType(o.dtype,0),o;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&g.sizeFromShape(t.shape)<=re.env().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),c.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!Bn(n.shape,t.shape)){var r=t,a=t.shape;t.shape=n.shape,t=i.packedReshape(t,a),c.push(t),n=i.texData.get(t.dataId),r.shape=a}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var f,d={shape:o.shape,texData:u,isUniform:!1},p=Oa(e,l,d),h=this.getAndSaveBinary(p,(function(){return Ta(i.gpgpu,e,l,d)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),Fa(this.gpgpu,h,l,d,r),c.forEach((function(e){return i.disposeData(e.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!re.env().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===a){var m=this.unpackTensor(o);return this.disposeData(o.dataId),m}return o}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return m.engine().makeTensorFromDataId(i.dataId,i.shape,i.dtype)}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){if(!this.disposed){if(!re.env().getBool("IS_TEST")){var e=this;Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}))}this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=m.tidy((function(){if(!re.env().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=re.env().getBool("DEBUG");re.env().set("DEBUG",!1);var n=e.abs(nt.scalar(1e-8)).dataSync()[0];if(re.env().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.values,i=t.texture,o=t.usage,u=t.isPacked;if(null==i){var s,c=null!=this.activeTimers;c&&(s=g.now());var l=t.texShape;if(null==l&&(l=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=re.env().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?g.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=g.squeezeShape(e);e=r.newShape}var a=g.sizeFromShape(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var i,o=_n(e),u=2,s=2;return e.length&&(u=(i=d.default(In(e),2))[0],s=i[1]),a=o*(u/2)*(s/2),g.sizeToSquarishShape(a).map((function(e){return 2*e}))}return g.sizeToSquarishShape(a)}(n,u),t.texShape=l),null!=a){var f,p,h=Rn(n),v=l[1],m=l[0],y=a instanceof Uint8Array;if(u)v=(p=d.default(en(l[0],l[1]),2))[0],m=p[1],f=new la(h,[m,v],y);else f=new ca(h,[m,v],y);var x=this.makeTensorInfo([m,v],r);this.texData.get(x.dataId).usage=y?Yt.PIXELS:Yt.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),v,m,a);var b=this.runWebGLProgram(f,[x],r,null,!0),k=this.texData.get(b.dataId);t.texture=k.texture,t.texShape=k.texShape,t.isPacked=k.isPacked,t.usage=k.usage,this.disposeData(x.dataId),this.texData.delete(b.dataId),t.values=null,c&&(this.uploadWaitMs+=g.now()-s)}else{var w=this.acquireTexture(l,o,r,u);t.texture=w}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1048576*this.numMBBeforeWarning){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*g.bytesPerElement(t)}}]),r}(Qe.KernelBackend);s("jbRpz");re=s("lU3MY");wr.isBrowser()&&m.registerBackend("webgl",(function(){return new wi}),2);s("jbRpz");s("9lNTO");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");s("jbRpz");m=s("P1tXK");var Ai=s("buy0T"),Ei=s("2xCpB"),Ci=s("j0e1k"),Si=s("6b8rQ"),Ni=s("djUTy"),Ti=(it=s("6baO0"),s("b3Qcj")),Di=s("2MKa7");s("jbRpz");m=s("P1tXK"),Ai=s("buy0T"),Ei=s("2xCpB"),Ci=s("j0e1k"),Si=s("6b8rQ"),Ni=s("djUTy"),it=s("6baO0"),Ti=s("b3Qcj"),Di=s("2MKa7");s("jbRpz");var Fi;m=s("P1tXK");function Oi(){return null==Fi&&(Fi=m.backend().epsilon()),Fi}s("1i51P");d=s("6vecG");var _i=s("5lcaY");Pe=s("9M1dW");s("jbRpz");g=s("kglvN");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),Ye=s("jZS3C");var Ii=s("4pZGK"),Ri=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,e),Object.setPrototypeOf(Ye.default(r),n.prototype),r}return n}(Ii.default(Error)),Mi=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,e),Object.setPrototypeOf(Ye.default(r),n.prototype),r}return n}(Ii.default(Error)),Bi=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,e),Object.setPrototypeOf(Ye.default(r),n.prototype),r}return n}(Ii.default(Error)),Pi=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,e),Object.setPrototypeOf(Ye.default(r),n.prototype),r}return n}(Ii.default(Error)),Li=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,e),Object.setPrototypeOf(Ye.default(r),n.prototype),r}return n}(Ii.default(Error));Ii.default(Error);function ji(e,t){if(Array.isArray(e)){for(var n=[],r=0;r<t;r++)n=n.concat(e);return n}var a=new Array(t);return a.fill(e),a}function zi(e,t){if(!e)throw new Li(t)}function Ui(e,t){var n=0,r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){o.value===t&&n++}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return n}function Vi(e){return 1===e.length?e[0]:e}function Wi(e){return Array.isArray(e)?e:[e]}function Gi(e){var t=e.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return"_"!==t[0]?t:"private"+t}function Hi(e){return e.length<=1||-1===e.indexOf("_")?e:e.replace(/[_]+(\w|$)/g,(function(e,t){return t.toUpperCase()}))}var qi={};function Ji(e){if(null==e)return null;var t={};return t.className=e.getClassName(),t.config=e.getConfig(),t}function Ki(e){if(null!=e&&"object"==typeof e)if(Array.isArray(e))e.forEach((function(e){return Ki(e)}));else{var t=Object.keys(e),n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value,s=e[u];null!=s&&"object"==typeof s&&(Array.isArray(s)||"ndarray"!==s.type||"number"!=typeof s.value?Ki(s):e[u]=s.value)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}}}function Xi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"object",a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if("string"==typeof e){var i,o=e;if(o in n)i=n[o];else if(o in qi)i=qi[o];else if(null==(i=t[o]))throw new Bi("Unknown ".concat(r,": ").concat(e,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");return i}var u=e;if(null==u.className||null==u.config)throw new Bi("".concat(r,": Improper config format: ")+"".concat(JSON.stringify(u),".\n")+"'className' and 'config' must set.");var s,c,l,f,p,h=u.className;if(h in n?(s=(l=d.default(n[h],2))[0],c=l[1]):h in qi?(s=(f=d.default(qi.className,2))[0],c=f[1]):h in t&&(s=(p=d.default(t[h],2))[0],c=p[1]),null==s)throw new Bi("Unknown ".concat(r,": ").concat(h,". ")+"This may be due to one of the following reasons:\n"+"1. The ".concat(r," is defined in Python, in which ")+"case it needs to be ported to TensorFlow.js or your JavaScript code.\n"+"2. The custom ".concat(r," is defined in JavaScript, ")+"but is not registered properly with tf.serialization.registerClass().");if(null!=c){var v={},g=!0,m=!1,y=void 0;try{for(var x,b=Object.keys(qi)[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var k=x.value;v[k]=qi[k]}}catch(e){m=!0,y=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}var w=!0,A=!1,E=void 0;try{for(var C,S=Object.keys(n)[Symbol.iterator]();!(w=(C=S.next()).done);w=!0){var N=C.value;v[N]=n[N]}}catch(e){A=!0,E=e}finally{try{w||null==S.return||S.return()}finally{if(A)throw E}}var T=u.config;T.customObjects=v;var D=Object.assign({},qi),F=!0,O=!1,_=void 0;try{for(var I,R=Object.keys(n)[Symbol.iterator]();!(F=(I=R.next()).done);F=!0){var M=I.value;qi[M]=n[M]}}catch(e){O=!0,_=e}finally{try{F||null==R.return||R.return()}finally{if(O)throw _}}Ki(u.config);var B=c(s,u.config,n,a);return qi=Object.assign({},D),B}var P=Object.assign({},qi),L=!0,j=!1,z=void 0;try{for(var U,V=Object.keys(n)[Symbol.iterator]();!(L=(U=V.next()).done);L=!0){var W=U.value;qi[W]=n[W]}}catch(e){j=!0,z=e}finally{try{L||null==V.return||V.return()}finally{if(j)throw z}}var G=new s(u.config);return qi=Object.assign({},P),G}function Yi(e,t){return-1*function(e,t){return e<t?-1:e>t?1:0}(e,t)}function Qi(e){if(null==e)return e;var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;-1===t.indexOf(u)&&t.push(u)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}function Zi(e){if(null==e)throw new Bi("Invalid value in obj: ".concat(JSON.stringify(e)));for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function $i(e,t,n){if(null!=n&&e.indexOf(n)<0)throw new Bi("".concat(n," is not a valid ").concat(t,".  Valid values are ").concat(e," or null/undefined."))}function eo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;return zi(n>=0),zi(r>=n),Array.isArray(e)&&e.length>=n&&e.length<=r&&e.every((function(e){return(void 0===e?"undefined":_i.default(e))===t}))}function to(e,t){Array.isArray(e)?(g.assert(e.length>0,(function(){return"".concat(t," is unexpectedly an empty array.")})),e.forEach((function(e,n){return to(e,"element ".concat(n+1," of ").concat(t))}))):g.assert(Number.isInteger(e)&&e>0,(function(){return"Expected ".concat(t," to be a positive integer, but got ")+"".concat(no(e),".")}))}function no(e){return null===e?"null":Array.isArray(e)?"["+e.map((function(e){return no(e)})).join(",")+"]":"string"==typeof e?'"'.concat(e,'"'):"".concat(e)}function ro(e){return"relu"===e?"relu":"linear"===e?"linear":"elu"===e?"elu":null}function ao(e,t){return m.tidy((function(){return Ai.sqrt(Ei.sum(Ci.mul(e,e),t,!0))}))}var io=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"getConfig",value:function(){return{}}}]),n}(Si.Serializable),oo=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).defaultMaxValue=2,r.defaultAxis=0,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return l.default(n,[{key:"apply",value:function(e){var t=this;return m.tidy((function(){var n=ao(e,t.axis),r=Ni.clipByValue(n,0,t.maxValue);return Ci.mul(e,it.div(r,Ti.add(Oi(),n)))}))}},{key:"getConfig",value:function(){return{maxValue:this.maxValue,axis:this.axis}}}]),n}(io);oo.className="MaxNorm",Si.registerClass(oo);var uo=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).defaultAxis=0,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return l.default(n,[{key:"apply",value:function(e){var t=this;return m.tidy((function(){return it.div(e,Ti.add(Oi(),ao(e,t.axis)))}))}},{key:"getConfig",value:function(){return{axis:this.axis}}}]),n}(io);uo.className="UnitNorm",Si.registerClass(uo);var so=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return Di.relu(e)}}]),n}(io);so.className="NonNeg",Si.registerClass(so);var co=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).defaultMinValue=0,r.defaultMaxValue=1,r.defaultRate=1,r.defaultAxis=0,r.minValue=null!=e.minValue?e.minValue:r.defaultMinValue,r.maxValue=null!=e.maxValue?e.maxValue:r.defaultMaxValue,r.rate=null!=e.rate?e.rate:r.defaultRate,r.axis=null!=e.axis?e.axis:r.defaultAxis,r}return l.default(n,[{key:"apply",value:function(e){var t=this;return m.tidy((function(){var n=ao(e,t.axis),r=Ti.add(Ci.mul(t.rate,Ni.clipByValue(n,t.minValue,t.maxValue)),Ci.mul(1-t.rate,n));return Ci.mul(e,it.div(r,Ti.add(Oi(),n)))}))}},{key:"getConfig",value:function(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}]),n}(io);co.className="MinMaxNorm",Si.registerClass(co);var lo={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function fo(e){return Ji(e)}function po(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Xi(e,Si.SerializationMap.getMap().classNameMap,t,"constraint")}function ho(e){return null==e?null:"string"==typeof e?po({className:e in lo?lo[e]:e,config:{}}):e instanceof io?e:po(e)}s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");s("jbRpz");Si=s("6b8rQ"),ot=s("ilMKa");var vo=s("6XDPM"),go=(m=s("P1tXK"),Ci=s("j0e1k"),nt=s("bftEy"),s("1GxQM")),mo=s("dqB3G"),yo=s("lyVnl");oe=s("j2ViA");s("1i51P");Pe=s("9M1dW");s("jbRpz");m=s("P1tXK");var xo=s("djXCd"),bo=s("dd8tD"),ko=s("2KAsd"),wo=s("jxscz"),Ao=s("jPaTA"),Eo=s("6hkW8"),Co=s("7dix2"),So=s("it0uc"),No=s("lC5hh"),To=s("2Iobd"),Do=s("kP8JI"),Fo=s("5Qmo8"),Oo=s("lGvfM"),_o=s("8p3bZ"),Io=s("4z0yD"),Ro=s("6FAlx"),Mo=(ut=s("iuFae"),s("ejjI8")),Bo=(Ci=s("j0e1k"),s("9ZTJv")),Po=(ae=s("5J0XY"),s("17OvF")),Lo=(nt=s("bftEy"),s("WvbbQ"),s("gGOj0")),jo=(it=s("6baO0"),s("3gUC5")),zo=s("6UffC");Ti=s("b3Qcj"),Ni=s("djUTy");s("jbRpz");m=s("P1tXK"),xo=s("djXCd"),bo=s("dd8tD"),ko=s("2KAsd"),wo=s("jxscz"),Ao=s("jPaTA"),Eo=s("6hkW8"),Co=s("7dix2"),So=s("it0uc"),No=s("lC5hh"),To=s("2Iobd"),Do=s("kP8JI"),Fo=s("5Qmo8"),Oo=s("lGvfM"),_o=s("8p3bZ"),Io=s("4z0yD"),Ro=s("6FAlx"),ut=s("iuFae"),Mo=s("ejjI8"),Ci=s("j0e1k"),Bo=s("9ZTJv"),ae=s("5J0XY"),Po=s("17OvF"),nt=s("bftEy"),s("WvbbQ"),Lo=s("gGOj0"),it=s("6baO0"),jo=s("3gUC5"),zo=s("6UffC"),Ti=s("b3Qcj"),Ni=s("djUTy");var Uo=["channelsFirst","channelsLast"],Vo=["valid","same","causal"],Wo=["max","avg"],Go=["sum","mul","concat","ave"],Ho=new Map;function qo(e){$i(Uo,"DataFormat",e)}function Jo(e){$i(Vo,"PaddingMode",e)}function Ko(e){$i(Wo,"PoolMode",e)}var Xo=[];function Yo(e,t){Xo.push(e);try{var n=t();return Xo.pop(),n}catch(e){throw Xo.pop(),e}}function Qo(e){if(!eu(e))throw new Error("Not a valid tensor name: '"+e+"'");return(0===Xo.length?"":Xo.join("/")+"/")+e}function Zo(e){if(!eu(e))throw new Error("Not a valid tensor name: '"+e+"'");Ho.has(e)||Ho.set(e,0);var t=Ho.get(e);if(Ho.set(e,Ho.get(e)+1),t>0){var n="".concat(e,"_").concat(t);return Ho.set(n,1),n}return e}var $o=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function eu(e){return!!e.match($o)}s("jbRpz");ae=s("5J0XY");var tu=s("cGC0n"),nu=(at=s("avJI0"),Ei=s("2xCpB"),s("fZE7S"));nt=s("bftEy"),Ci=s("j0e1k");s("jbRpz");ae=s("5J0XY"),tu=s("cGC0n"),at=s("avJI0"),Ei=s("2xCpB"),nu=s("fZE7S"),nt=s("bftEy"),Ci=s("j0e1k");function ru(e){return e===parseInt(e.toString(),10)}function au(e,t,n){null==t&&(t=0),null==n&&(n=e.length);for(var r=1,a=t;a<n;++a)r*=e[a];return r}function iu(e){return e=Array.isArray(e)?new Float32Array(e):e,ae.tensor1d(e)}function ou(e){return tu.min(iu(e)).dataSync()[0]}function uu(e){return at.max(iu(e)).dataSync()[0]}function su(e,t){if(t<e)throw new Bi("end (".concat(t,") < begin (").concat(e,") is forbidden."));for(var n=[],r=e;r<t;++r)n.push(r);return n}function cu(e,t){return e.asType(t)}function lu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.shape.slice();return t<0&&(t=n.length+t+1),n.splice(t,0,1),e.reshape(n)}function fu(e){var t=[au(e.shape)];return e.reshape(t)}function du(e,t,n){return m.tidy((function(){switch(e.rank){case 1:return xo.slice1d(e,t,n);case 2:return bo.slice2d(e,[t,0],[n,e.shape[1]]);case 3:return ko.slice3d(e,[t,0,0],[n,e.shape[1],e.shape[2]]);case 4:return wo.slice4d(e,[t,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3]]);case 5:return Ao.slice(e,[t,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4]]);case 6:return Ao.slice(e,[t,0,0,0,0,0],[n,e.shape[1],e.shape[2],e.shape[3],e.shape[4],e.shape[5]]);default:throw new Bi("sliceAlongFirstAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function pu(e,t,n){return m.tidy((function(){switch(e.rank){case 1:return xo.slice1d(e,t,n);case 2:return bo.slice2d(e,[0,t],[e.shape[0],n]);case 3:return ko.slice3d(e,[0,0,t],[e.shape[0],e.shape[1],n]);case 4:return wo.slice4d(e,[0,0,0,t],[e.shape[0],e.shape[1],e.shape[2],n]);default:throw new Bi("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function hu(e,t,n,r){return m.tidy((function(){switch(e.rank){case 1:return xo.slice1d(e,t,n);case 2:switch(r){case 1:return du(e,t,n);case 2:return pu(e,t,n);default:throw new Bi("The axis is not within the rank of the tensor "+"".concat(r))}case 3:switch(r){case 1:return du(e,t,n);case 2:return ko.slice3d(e,[0,t,0],[e.shape[0],n,e.shape[2]]);case 3:return pu(e,t,n);default:throw new Bi("The axis is not within the rank of the tensor "+"".concat(r))}case 4:switch(r){case 1:return du(e,t,n);case 2:return wo.slice4d(e,[0,t,0,0],[e.shape[0],n,e.shape[2],e.shape[3]]);case 3:return wo.slice4d(e,[0,0,t,0],[e.shape[0],e.shape[1],n,e.shape[3]]);case 4:return pu(e,t,n);default:throw new Bi("The axis is not within the rank of the tensor "+"".concat(r))}default:throw new Bi("sliceAlongLastAxis() received an unsupported tensor rank: "+"".concat(e.rank))}}))}function vu(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return n<0&&(n=0!==(t=e[0].rank)?t:0),n===e[0].rank&&(n=-1),Eo.concat(e,n)}function gu(e,t){switch(e.rank){case 1:return Co.concat1d([e,t]);case 2:return So.concat2d([e,t],0);case 3:return No.concat3d([e,t],0);case 4:return To.concat4d([e,t],0);default:throw new Bi("concatAlongFirstAxis() received an unsupported "+"tensor rank: ".concat(e.rank))}}function mu(e,t){if(Array.isArray(t)||(t=[t]),e.rank!==t.length)throw new Bi("The length of input n (".concat(t.length,") does not match ")+"the number of dimensions in input x (".concat(e.rank,")"));return Do.tile(e,t)}function yu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return Fo.randomNormal(e,t,n,r,a)}function xu(e,t,n,r){if(e.rank<2||t.rank<2)throw new Pi("dot requires both inputs to be rank >= 2"+" but got x shape = ".concat(e.shape," and y shape = ").concat(t.shape));if(t.rank>=3&&e.shape.slice(-1)[0]!==t.shape.slice(-2)[0])throw new Pi("If rank y >= 3, then the second last dim"+" of y must equal the last dim of x but got x shape = ".concat(e.shape," and ")+" y shape = ".concat(t.shape));if(2===e.rank&&2===t.rank){return Oo.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?wu(e.rank,r,"channelsLast"):null,activation:n})}var a=e.shape.slice(),i=a.pop();e=e.reshape([-1,i]);var o=t.shape.slice(),u=o.pop(),s=o.pop(),c=Pe.default(o).concat([u]),l=Array.from({length:t.rank},(function(e,n){return 0===n?t.rank-2:n<=t.rank-2?n-1:n}));t=t.transpose(l).reshape([s,-1]);var f=Pe.default(a).concat(Pe.default(c));return Oo.matMul({a:e,b:t,transposeA:!1,transposeB:!1,bias:r?wu(e.rank,r,"channelsLast"):null,activation:n}).reshape(f)}function bu(e,t,n){return m.tidy((function(){return t=Array.isArray(t)?ae.tensor1d(t,"int32"):t.toInt(),Po.gather(e,t,n)}))}function ku(e){return Ci.mul(e,e)}function wu(e,t,n){var r=t.shape;if(1!==t.rank&&t.rank!==e)throw new Bi("Unexpected bias dimensions: ".concat(t.rank)+"; expected it to be 1 or ".concat(e));if(5===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1,1]):t.reshape([1,r[3],r[0],r[1],r[2]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,1,r[0]]):t.reshape([1].concat(r))}else if(4===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1,1]):t.reshape([1,r[2],r[0],r[1]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,1,r[0]]):t.reshape([1].concat(r))}else if(3===e){if("channelsFirst"===n)return 1===r.length?t.reshape([1,r[0],1]):t.reshape([1,r[1],r[0]]);if("channelsLast"===n)return 1===r.length?t.reshape([1,1,r[0]]):t.reshape([1].concat(r))}else if(e<3)return t;throw new Bi("Unsupported input rank by biasAdd: ".concat(t.rank))}function Au(e,t,n){return m.tidy((function(){return null==n&&(n="channelsLast"),qo(n),e.add(wu(e.rank,t,n))}))}function Eu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(1!==t)throw new Pi("Support for alpha values other than 1 (".concat(t,") is not implemented ")+"yet.");return Lo.elu(e)}function Cu(e,t,n,r){return m.tidy((function(){return zo.dropout(e,t,n,r)}))}function Su(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n?e():t()}var Nu=["fanIn","fanOut","fanAvg"],Tu=["normal","uniform","truncatedNormal"];var Du=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"fromConfigUsesCustomObjects",value:function(){return!1}},{key:"getConfig",value:function(){return{}}}]),n}(Si.Serializable),Fu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e,t){return ot.zeros(e,t)}}]),n}(Du);Fu.className="Zeros",Si.registerClass(Fu);var Ou=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e,t){return vo.ones(e,t)}}]),n}(Du);Ou.className="Ones",Si.registerClass(Ou);var _u=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),r=t.call(this),"object"!=typeof e)throw new Bi("Expected argument of type ConstantConfig but got ".concat(e));if(void 0===e.value)throw new Bi("config must have value set but got ".concat(e));return r.value=e.value,r}return l.default(n,[{key:"apply",value:function(e,t){var n=this;return m.tidy((function(){return Ci.mul(nt.scalar(n.value),vo.ones(e,t))}))}},{key:"getConfig",value:function(){return{value:this.value}}}]),n}(Du);_u.className="Constant",Si.registerClass(_u);var Iu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).DEFAULT_MINVAL=-.05,r.DEFAULT_MAXVAL=.05,r.minval=e.minval||r.DEFAULT_MINVAL,r.maxval=e.maxval||r.DEFAULT_MAXVAL,r.seed=e.seed,r}return l.default(n,[{key:"apply",value:function(e,t){return go.randomUniform(e,this.minval,this.maxval,t)}},{key:"getConfig",value:function(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}]),n}(Du);Iu.className="RandomUniform",Si.registerClass(Iu);var Ru=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return l.default(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Pi("randomNormal does not support dType ".concat(t,"."));return yu(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(Du);Ru.className="RandomNormal",Si.registerClass(Ru);var Mu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).DEFAULT_MEAN=0,r.DEFAULT_STDDEV=.05,r.mean=e.mean||r.DEFAULT_MEAN,r.stddev=e.stddev||r.DEFAULT_STDDEV,r.seed=e.seed,r}return l.default(n,[{key:"apply",value:function(e,t){if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Pi("truncatedNormal does not support dType ".concat(t,"."));return mo.truncatedNormal(e,this.mean,this.stddev,t,this.seed)}},{key:"getConfig",value:function(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}]),n}(Du);Mu.className="TruncatedNormal",Si.registerClass(Mu);var Bu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this)).gain=null!=e.gain?e.gain:1,r}return l.default(n,[{key:"apply",value:function(e,t){var n=this;return m.tidy((function(){if(2!==e.length||e[0]!==e[1])throw new Bi("Identity matrix initializer can only be used for 2D square matrices.");return Ci.mul(n.gain,yo.eye(e[0]))}))}},{key:"getConfig",value:function(){return{gain:this.gain}}}]),n}(Du);Bu.className="Identity",Si.registerClass(Bu);var Pu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),r=t.call(this),e.scale<0)throw new Bi("scale must be a positive float. Got: ".concat(e.scale));return r.scale=null==e.scale?1:e.scale,r.mode=null==e.mode?"fanIn":e.mode,function(e){$i(Nu,"FanMode",e)}(r.mode),r.distribution=null==e.distribution?"normal":e.distribution,function(e){$i(Tu,"Distribution",e)}(r.distribution),r.seed=e.seed,r}return l.default(n,[{key:"apply",value:function(e,t){var n=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"channelsLast";if(qo(r),2===e.length)t=e[0],n=e[1];else if(-1!==[3,4,5].indexOf(e.length)){if("channelsFirst"===r){var a=au(e,2);t=e[1]*a,n=e[0]*a}else if("channelsLast"===r){var i=au(e,0,e.length-2);t=e[e.length-2]*i,n=e[e.length-1]*i}}else{var o=au(e);t=Math.sqrt(o),n=Math.sqrt(o)}return[t,n]}(e),r=n[0],a=n[1],i=this.scale;if("fanIn"===this.mode?i/=Math.max(1,r):"fanOut"===this.mode?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),"normal"===this.distribution){var o=Math.sqrt(i);if("float32"!==(t=t||"float32")&&"int32"!==t)throw new Pi("".concat(this.getClassName()," does not support dType ").concat(t,"."));return mo.truncatedNormal(e,0,o,t,this.seed)}var u=Math.sqrt(3*i);return go.randomUniform(e,-u,u,t)}},{key:"getConfig",value:function(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}]),n}(Du);Pu.className="VarianceScaling",Si.registerClass(Pu);var Lu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"uniform",seed:null==e?null:e.seed})}return l.default(n,[{key:"getClassName",value:function(){return e.className}}]),n}(Pu);Lu.className="GlorotUniform",Si.registerClass(Lu);var ju=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,{scale:1,mode:"fanAvg",distribution:"normal",seed:null==e?null:e.seed})}return l.default(n,[{key:"getClassName",value:function(){return e.className}}]),n}(Pu);ju.className="GlorotNormal",Si.registerClass(ju);var zu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return l.default(n,[{key:"getClassName",value:function(){return e.className}}]),n}(Pu);zu.className="HeNormal",Si.registerClass(zu);var Uu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,{scale:2,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return l.default(n,[{key:"getClassName",value:function(){return e.className}}]),n}(Pu);Uu.className="HeUniform",Si.registerClass(Uu);var Vu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"normal",seed:null==e?null:e.seed})}return l.default(n,[{key:"getClassName",value:function(){return e.className}}]),n}(Pu);Vu.className="LeCunNormal",Si.registerClass(Vu);var Wu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,{scale:1,mode:"fanIn",distribution:"uniform",seed:null==e?null:e.seed})}return l.default(n,[{key:"getClassName",value:function(){return e.className}}]),n}(Pu);Wu.className="LeCunNormal",Si.registerClass(Wu);var Gu=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this)).DEFAULT_GAIN=1,r.gain=null==e.gain?r.DEFAULT_GAIN:e.gain,r.seed=e.seed,null!=r.seed)throw new Pi("Random seed is not implemented for Orthogonal Initializer yet.");return r}return l.default(n,[{key:"apply",value:function(e,t){var n=this;return m.tidy((function(){if(e.length<2)throw new Pi("Shape must be at least 2D.");e[0]*e[1]>2e3&&console.warn("Orthogonal initializer is being called on a matrix with more "+"than 2000 (".concat(e[0]*e[1],") elements: ")+"Slowness may result.");var t=yu(e[0]>e[1]?[e[1],e[0]]:e,0,1,"float32"),r=oe.linalg.gramSchmidt(t);return e[0]>e[1]&&(r=r.transpose()),Ci.mul(n.gain,r)}))}},{key:"getConfig",value:function(){return{gain:this.gain,seed:this.seed}}}]),n}(Du);Gu.className="Orthogonal",Si.registerClass(Gu);var Hu={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function qu(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Xi(e,Si.SerializationMap.getMap().classNameMap,t,"initializer")}function Ju(e){return Ji(e)}function Ku(e){if("string"==typeof e){var t=e in Hu?Hu[e]:e;if("GlorotNormal"===t)return new ju;if("GlorotUniform"===t)return new Lu;if("HeNormal"===t)return new zu;if("HeUniform"===t)return new Uu;if("LeCunNormal"===t)return new Vu;if("LeCunUniform"===t)return new Wu;var n={};return n.className=t,n.config={},qu(n)}return e instanceof Du?e:qu(e)}var Xu={};n(Xu,"inputLayer",(function(){return op})),n(Xu,"elu",(function(){return up})),n(Xu,"reLU",(function(){return sp})),n(Xu,"leakyReLU",(function(){return cp})),n(Xu,"prelu",(function(){return lp})),n(Xu,"softmax",(function(){return fp})),n(Xu,"thresholdedReLU",(function(){return dp})),n(Xu,"conv1d",(function(){return pp})),n(Xu,"conv2d",(function(){return hp})),n(Xu,"conv2dTranspose",(function(){return vp})),n(Xu,"conv3d",(function(){return gp})),n(Xu,"separableConv2d",(function(){return mp})),n(Xu,"cropping2D",(function(){return yp})),n(Xu,"upSampling2d",(function(){return xp})),n(Xu,"depthwiseConv2d",(function(){return bp})),n(Xu,"activation",(function(){return kp})),n(Xu,"dense",(function(){return wp})),n(Xu,"dropout",(function(){return Ap})),n(Xu,"spatialDropout1d",(function(){return Ep})),n(Xu,"flatten",(function(){return Cp})),n(Xu,"repeatVector",(function(){return Sp})),n(Xu,"reshape",(function(){return Np})),n(Xu,"permute",(function(){return Tp})),n(Xu,"embedding",(function(){return Dp})),n(Xu,"add",(function(){return Fp})),n(Xu,"average",(function(){return Op})),n(Xu,"concatenate",(function(){return _p})),n(Xu,"maximum",(function(){return Ip})),n(Xu,"minimum",(function(){return Rp})),n(Xu,"multiply",(function(){return Mp})),n(Xu,"dot",(function(){return Bp})),n(Xu,"batchNormalization",(function(){return Pp})),n(Xu,"layerNormalization",(function(){return Lp})),n(Xu,"zeroPadding2d",(function(){return jp})),n(Xu,"averagePooling1d",(function(){return zp})),n(Xu,"avgPool1d",(function(){return Up})),n(Xu,"avgPooling1d",(function(){return Vp})),n(Xu,"averagePooling2d",(function(){return Wp})),n(Xu,"avgPool2d",(function(){return Gp})),n(Xu,"avgPooling2d",(function(){return Hp})),n(Xu,"averagePooling3d",(function(){return qp})),n(Xu,"avgPool3d",(function(){return Jp})),n(Xu,"avgPooling3d",(function(){return Kp})),n(Xu,"globalAveragePooling1d",(function(){return Xp})),n(Xu,"globalAveragePooling2d",(function(){return Yp})),n(Xu,"globalMaxPooling1d",(function(){return Qp})),n(Xu,"globalMaxPooling2d",(function(){return Zp})),n(Xu,"maxPooling1d",(function(){return $p})),n(Xu,"maxPooling2d",(function(){return eh})),n(Xu,"maxPooling3d",(function(){return th})),n(Xu,"gru",(function(){return nh})),n(Xu,"gruCell",(function(){return rh})),n(Xu,"lstm",(function(){return ah})),n(Xu,"lstmCell",(function(){return ih})),n(Xu,"simpleRNN",(function(){return oh})),n(Xu,"simpleRNNCell",(function(){return uh})),n(Xu,"convLstm2d",(function(){return sh})),n(Xu,"convLstm2dCell",(function(){return ch})),n(Xu,"rnn",(function(){return lh})),n(Xu,"stackedRNNCells",(function(){return fh})),n(Xu,"bidirectional",(function(){return dh})),n(Xu,"timeDistributed",(function(){return ph})),n(Xu,"globalMaxPool1d",(function(){return hh})),n(Xu,"globalMaxPool2d",(function(){return vh})),n(Xu,"maxPool1d",(function(){return gh})),n(Xu,"maxPool2d",(function(){return mh})),n(Xu,"gaussianNoise",(function(){return yh})),n(Xu,"gaussianDropout",(function(){return xh})),n(Xu,"alphaDropout",(function(){return bh})),n(Xu,"masking",(function(){return kh})),n(Xu,"Layer",(function(){return gs})),n(Xu,"RNN",(function(){return Lf})),n(Xu,"RNNCell",(function(){return jf})),n(Xu,"input",(function(){return kl})),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),Ye=s("jZS3C"),l=s("2tuUj");s("jbRpz");Si=s("6b8rQ");
/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var Yu=0;function Qu(){return Yu++}var Zu={};function $u(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e in Zu||(Zu[e]=0),Zu[e]+=1,e+Zu[e].toString()}s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),p=s("2vsUb"),h=s("d6iiX"),Pe=s("9M1dW");s("jbRpz");m=s("P1tXK"),g=s("kglvN"),Si=s("6b8rQ");function es(e){return Array.isArray(e)&&Array.isArray(e[0])}function ts(e){return 0===e.length?[]:Array.isArray(e[0])?e:[e]}function ns(e){var t;if(Array.isArray(e)){if(1!==e.length)throw new Bi("Expected Tensor length to be 1; got ".concat(e.length));t=e[0]}else t=e;return t}function rs(e){if(Array.isArray(e)&&Array.isArray(e[0])){if(1===e.length)return e[0];throw new Bi("Expected exactly 1 Shape; got ".concat(e.length))}return e}function as(e){var t=0,n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;0===u.shape.length?t+=1:t+=u.shape.reduce((function(e,t){return e*t}))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}s("1i51P");c=s("3QOYJ"),l=s("2tuUj");s("jbRpz");var is=s("4ETT0"),os=(ot=s("ilMKa"),_o=s("8p3bZ"),vo=s("6XDPM"),Io=s("4z0yD"),yo=s("lyVnl"),go=s("1GxQM"),mo=s("dqB3G"),Fo=s("5Qmo8"),Ti=s("b3Qcj"),nu=s("fZE7S"),s("2c3OP"));s("jbRpz");is=s("4ETT0"),ot=s("ilMKa"),_o=s("8p3bZ"),vo=s("6XDPM"),Io=s("4z0yD"),yo=s("lyVnl"),go=s("1GxQM"),mo=s("dqB3G"),Fo=s("5Qmo8"),Ti=s("b3Qcj"),nu=s("fZE7S"),os=s("2c3OP");var us="Variable",ss=function(){"use strict";function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:us,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;c.default(this,e),this.dtype=null==n?"float32":n,this.shape=t.shape,this.id=Qu(),r=null==r?us:r,this.originalName=Qo(r),this.name=Zo(this.originalName),this.trainable_=a,this.constraint=i,this.val=is.variable(t,this.trainable_,this.name,this.dtype)}return l.default(e,[{key:"read",value:function(){return this.assertNotDisposed(),this.val}},{key:"write",value:function(e){return this.assertNotDisposed(),function(e,t){if(e.shape.toString()!==t.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(e.shape)+" vs. "+JSON.stringify(t.shape))}(this.val,e),this.val.id!==e.id&&(this.val.assign(e),null!=this.constraint&&this.val.assign(this.constraint.apply(this.val))),this}},{key:"dispose",value:function(){this.assertNotDisposed(),this.val.dispose()}},{key:"assertNotDisposed",value:function(){if(this.val.isDisposed)throw new Error("LayersVariable ".concat(this.name," is already disposed."))}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.trainable_=e,this.val.trainable=e}}]),e}();function cs(e){return e.map((function(e){return e.read()}))}function ls(e){e.forEach((function(e){e[0].write(e[1])}))}var fs=function e(t){"use strict";c.default(this,e),this.dtype=t.dtype,this.shape=t.shape,null!=t.shape?this.ndim=t.shape.length:this.ndim=t.ndim,this.maxNDim=t.maxNDim,this.minNDim=t.minNDim,this.axes=t.axes||{}},ds=function e(t,n,r,a,i,o,u){"use strict";c.default(this,e),this.dtype=t,this.shape=n,this.sourceLayer=r,this.inputs=a,this.callArgs=i,this.outputTensorIndex=u,this.id=Qu(),null!=o&&(this.originalName=Qo(o),this.name=Zo(this.originalName)),this.rank=n.length},ps=0,hs=function(){"use strict";function e(t,n){c.default(this,e),this.callArgs=n,this.id=ps++,this.outboundLayer=t.outboundLayer,this.inboundLayers=t.inboundLayers,this.nodeIndices=t.nodeIndices,this.tensorIndices=t.tensorIndices,this.inputTensors=t.inputTensors,this.outputTensors=t.outputTensors,this.inputMasks=t.inputMasks,this.outputMasks=t.outputMasks,this.inputShapes=t.inputShapes,this.outputShapes=t.outputShapes;var r=!0,a=!1,i=void 0;try{for(var o,u=t.inboundLayers[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;null!=s&&s.outboundNodes.push(this)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}t.outboundLayer.inboundNodes.push(this)}return l.default(e,[{key:"getConfig",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=this.inboundLayers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;null!=o?e.push(o.name):e.push(null)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}]),e}(),vs=0,gs=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c.default(this,n),(e=t.call(this))._callHook=null,e._addedWeightNames=[],e._stateful=!1,e.id=vs++,e.activityRegularizer=null,e.inputSpec=null,e.supportsMasking=!1,e._trainableWeights=[],e._nonTrainableWeights=[],e._losses=[],e._updates=[],e._built=!1,e.inboundNodes=[],e.outboundNodes=[];var a=r.name;if(!a){var i=e.getClassName();a=Gi(i)+"_"+$u(i)}if(e.name=a,e.trainable_=null==r.trainable||r.trainable,null!=r.inputShape||null!=r.batchInputShape){var o;if(null!=r.batchInputShape)o=r.batchInputShape;else if(null!=r.inputShape){var u=null;null!=r.batchSize&&(u=r.batchSize),o=[u].concat(r.inputShape)}e.batchInputShape=o;var s=r.dtype;null==s&&(s=r.inputDType),null==s&&(s="float32"),e.dtype=s}return null!=r.weights?e.initialWeights=r.weights:e.initialWeights=null,e._refCount=null,e.fastWeightInitDuringBuild=!1,e}return l.default(n,[{key:"getNodeAtIndex",value:function(e,t){if(0===this.inboundNodes.length)throw new Mi("The layer has never been called "+"and thus has no defined ".concat(t,"."));if(this.inboundNodes.length<=e)throw new Bi("Asked to get ".concat(t," at node ").concat(e,", ")+"but the layer has only ".concat(this.inboundNodes.length," inbound nodes."));return this.inboundNodes[e]}},{key:"getInputAt",value:function(e){return Vi(this.getNodeAtIndex(e,"input").inputTensors)}},{key:"getOutputAt",value:function(e){return Vi(this.getNodeAtIndex(e,"output").outputTensors)}},{key:"input",get:function(){if(this.inboundNodes.length>1)throw new Ri("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use `getInputAt(nodeIndex)` instead.');if(0===this.inboundNodes.length)throw new Ri("Layer ".concat(this.name)+" is not connected, no input to return.");return Vi(this.getNodeAtIndex(0,"input").inputTensors)}},{key:"output",get:function(){if(0===this.inboundNodes.length)throw new Ri("Layer ".concat(this.name)+" has no inbound nodes.");if(this.inboundNodes.length>1)throw new Ri("Layer ".concat(this.name)+' has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use `getOutputAt(nodeIndex)` instead.');return Vi(this.getNodeAtIndex(0,"output").outputTensors)}},{key:"losses",get:function(){return this._losses}},{key:"calculateLosses",value:function(){return this.losses.map((function(e){return e()}))}},{key:"updates",get:function(){return this._updates}},{key:"built",get:function(){return this._built},set:function(e){this._built=e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this._trainableWeights.forEach((function(t){return t.trainable=e})),this.trainable_=e}},{key:"trainableWeights",get:function(){return this.trainable_?this._trainableWeights.filter((function(e){return e.trainable})):[]},set:function(e){this._trainableWeights=e}},{key:"nonTrainableWeights",get:function(){return this.trainable?this._trainableWeights.filter((function(e){return!e.trainable})).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)},set:function(e){this._nonTrainableWeights=e}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"stateful",get:function(){return this._stateful}},{key:"resetStates",value:function(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}},{key:"assertInputCompatibility",value:function(e){if(e=Wi(e),null!=this.inputSpec&&0!==this.inputSpec.length){var t=Wi(this.inputSpec);if(e.length!==t.length)throw new Bi("Layer ".concat(this.name," expects ").concat(t.length," inputs, ")+"but it received ".concat(e.length," input tensors. ")+"Input received: ".concat(e));for(var n=0;n<e.length;n++){var r=e[n],a=t[n];if(null!=a){var i=r.rank;if(null!=a.ndim&&i!==a.ndim)throw new Bi("Input ".concat(n," is incompatible with layer ").concat(this.name,": ")+"expected ndim=".concat(a.ndim,", found ndim=").concat(i));if(null!=a.maxNDim&&i>a.maxNDim)throw new Bi("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected max_ndim=".concat(a.maxNDim,", found ndim=").concat(i));if(null!=a.minNDim&&i<a.minNDim)throw new Bi("Input ".concat(n," is incompatible with layer ").concat(this.name)+": expected min_ndim=".concat(a.minNDim,", found ndim=").concat(i,"."));if(null!=a.dtype&&r.dtype!==a.dtype)throw new Bi("Input ".concat(n," is incompatible with layer ").concat(this.name," ")+": expected dtype=".concat(a.dtype,", found dtype=").concat(r.dtype,"."));if(a.axes){var o=r.shape;for(var u in a.axes){var s=Number(u),c=a.axes[u],l=s>=0?o[s]:o[o.length+s];if(null!=c&&-1===[c,null].indexOf(l))throw new Bi("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected axis ").concat(s," of input shape to ")+"have value ".concat(c," but got shape ").concat(o,"."))}}if(null!=a.shape)for(var f=0;f<a.shape.length;++f){var d=a.shape[f],p=r.shape[f];if(null!=d&&null!=p&&d!==p)throw new Bi("Input ".concat(n," is incompatible with layer ")+"".concat(this.name,": expected shape=").concat(a.shape,", ")+"found shape=".concat(r.shape,"."))}}}}}},{key:"call",value:function(e,t){return e}},{key:"invokeCallHook",value:function(e,t){null!=this._callHook&&this._callHook(e,t)}},{key:"setCallHook",value:function(e){this._callHook=e}},{key:"clearCallHook",value:function(){this._callHook=null}},{key:"apply",value:function(e,t){var n=this;t=t||{},this.assertNotDisposed();var r=Wi(e),a=!0,i=!0,o=!1,u=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){if(!(s.value instanceof ds)){a=!1;break}}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}var l=!0,f=!0,d=!1,p=void 0;try{for(var h,v=r[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){if(h.value instanceof ds){l=!1;break}}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}if(a===l)throw new Bi("Arguments to apply() must be all SymbolicTensors or all Tensors");return Yo(this.name,(function(){if(!n.built){n.assertInputCompatibility(e);var a=[],i=!0,o=!1,u=void 0;try{for(var s,c=Wi(e)[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var f=s.value;a.push(f.shape)}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}n.build(Vi(a)),n.built=!0,n.initialWeights&&n.setWeights(n.initialWeights),null===n._refCount&&l&&(n._refCount=1)}if(n.assertInputCompatibility(e),l){var d=n.call(e,t),p=Wi(d),h=[],v=!0,g=!1,m=void 0;try{for(var y,x=p[Symbol.iterator]();!(v=(y=x.next()).done);v=!0){var b=y.value;-1!==r.indexOf(b)&&(b=b.clone()),h.push(b)}}catch(e){g=!0,m=e}finally{try{v||null==x.return||x.return()}finally{if(g)throw m}}if(d=Vi(h),null!=n.activityRegularizer)throw new Pi("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return d}var k,w=n,A=function(e){e=Wi(e);var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;t.push(u.shape)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return Vi(t)}(e),E=n.computeOutputShape(A),C="float32";if(n.warnOnIncompatibleInputShape(Array.isArray(e)?A[0]:A),k=null!=E&&E.length>0&&Array.isArray(E[0])?E.map((function(n,r){return new ds(C,n,w,Wi(e),t,w.name,r)})):new ds(C,E,n,Wi(e),t,n.name),n.addInboundNode(e,k,null,null,A,E,t),n._refCount++,null!=n.activityRegularizer)throw new Pi("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return k}))}},{key:"warnOnIncompatibleInputShape",value:function(e){if(null!=this.batchInputShape)if(e.length!==this.batchInputShape.length)console.warn("The rank of the input tensor provided (shape: "+"".concat(JSON.stringify(e),") does not match that of the ")+"batchInputShape (".concat(JSON.stringify(this.batchInputShape),") ")+"of the layer ".concat(this.name));else{var t=!1;this.batchInputShape.forEach((function(n,r){null!=n&&null!=e[r]&&e[r]!==n&&(t=!0)})),t&&console.warn("The shape of the input tensor "+"(".concat(JSON.stringify(e),") does not ")+"match the expectation of layer ".concat(this.name,": ")+"".concat(JSON.stringify(this.batchInputShape)))}}},{key:"outputShape",get:function(){if(null==this.inboundNodes||0===this.inboundNodes.length)throw new Ri("The layer ".concat(this.name," has never been called and thus has no ")+"defined output shape.");var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=this.inboundNodes[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,u=JSON.stringify(o.outputShapes);-1===e.indexOf(u)&&e.push(u)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}if(1===e.length){var s=this.inboundNodes[0].outputShapes;return Array.isArray(s)&&Array.isArray(s[0])&&1===s.length?s[0]:s}throw new Ri("The layer ".concat(this.name," has multiple inbound nodes with different ")+'output shapes. Hence the notion of "output shape" is ill-defined for the layer.')}},{key:"countParams",value:function(){if(!this.built)throw new Mi("You tried to call countParams() on ".concat(this.name,", ")+"but the layer is not built yet. Build it first by calling build(batchInputShape).");return as(this.weights)}},{key:"build",value:function(e){this.built=!0}},{key:"getWeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return cs(e?this.trainableWeights:this.weights)}},{key:"setWeights",value:function(e){var t=this;m.tidy((function(){var n=t.weights;if(n.length!==e.length)throw new Bi('You called setWeights(weights) on layer "'.concat(t.name,'" ')+"with a weight list of length ".concat(e.length,", ")+"but the layer was expecting ".concat(n.length," weights. ")+"Provided weights: ".concat(e,"..."));if(0!==n.length){for(var r=[],a=cs(n),i=0;i<a.length;++i){var o=a[i],u=n[i],s=e[i];if(!g.arraysEqual(o.shape,s.shape))throw new Bi("Layer weight shape ".concat(o.shape," ")+"not compatible with provided weight shape ".concat(s.shape));r.push([u,s])}ls(r)}}))}},{key:"addWeight",value:function(e,t,n,r,a,i,o){if(-1!==this._addedWeightNames.indexOf(e))throw new Bi("Duplicate weight name ".concat(e," for layer ").concat(this.name));this._addedWeightNames.push(e),null==n&&(n="float32"),this.fastWeightInitDuringBuild&&(r=Ku("zeros"));var u=r.apply(t,n),s=new ss(u,n,e,i,o);return u.dispose(),null!=a&&this.addLoss((function(){return a.apply(s.read())})),null==i&&(i=!0),i?this._trainableWeights.push(s):this._nonTrainableWeights.push(s),s}},{key:"setFastWeightInitDuringBuild",value:function(e){this.fastWeightInitDuringBuild=e}},{key:"addLoss",value:function(e){var t;null==e||Array.isArray(e)&&0===e.length||(e=Wi(e),void 0!==this._losses&&null!==this._losses&&(t=this.losses).push.apply(t,Pe.default(e)))}},{key:"computeOutputShape",value:function(e){return e}},{key:"computeMask",value:function(e,t){if(!this.supportsMasking){if(null!=t){var n=this;if(!Array.isArray(t))throw new TypeError("Layer ".concat(this.name," does not support masking, ")+"but was passed an inputMask.");t.forEach((function(e){if(null!=e)throw new TypeError("Layer ".concat(n.name," does not support masking, ")+"but was passed an inputMask.")}))}return null}return t}},{key:"addInboundNode",value:function(e,t,n,r,a,i){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=Wi(e);t=Wi(t),n=Wi(n),r=Wi(r),a=ts(a),i=ts(i);var s=[],c=[],l=[],f=!0,d=!1,p=void 0;try{for(var h,v=u[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var g=h.value;s.push(g.sourceLayer),c.push(g.nodeIndex),l.push(g.tensorIndex)}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}new hs({outboundLayer:this,inboundLayers:s,nodeIndices:c,tensorIndices:l,inputTensors:u,outputTensors:t,inputMasks:n,outputMasks:r,inputShapes:a,outputShapes:i},o);for(var m=0;m<t.length;m++)t[m].sourceLayer=this,t[m].nodeIndex=this.inboundNodes.length-1,t[m].tensorIndex=m}},{key:"getConfig",value:function(){var e={name:this.name,trainable:this.trainable};return null!=this.batchInputShape&&(e.batchInputShape=this.batchInputShape),null!=this.dtype&&(e.dtype=this.dtype),e}},{key:"disposeWeights",value:function(){return this.weights.forEach((function(e){return e.dispose()})),this.weights.length}},{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Layer '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){if(!this.built)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been ")+"built yet.");if(null===this._refCount)throw new Error("Cannot dispose Layer ".concat(this.name," because it has not been used ")+"yet.");this.assertNotDisposed();var e=0;return 0==--this._refCount&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}],[{key:"nodeKey",value:function(e,t){return e.name+"_ib-"+t.toString()}}]),n}(Si.Serializable);function ms(e,t,n){if((null==t||null!=n&&n>0)&&(t=e.sourceLayer,n=e.nodeIndex),0===t.inboundNodes.length)return[e];var r=t.inboundNodes[n];if(0===r.inboundLayers.length)return r.inputTensors;for(var a=[],i=0;i<r.inboundLayers.length;i++){var o=ms(r.inputTensors[i],r.inboundLayers[i],r.nodeIndices[i]),u=!0,s=!1,c=void 0;try{for(var l,f=o[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;-1===a.indexOf(d)&&a.push(d)}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}}return a}var ys=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),r=t.call(this,{dtype:e.dtype,name:null!=e.name?e.name:$u("input").toString()}),null==e.batchSize&&(e.batchSize=null),null==e.sparse&&(e.sparse=!1),r.trainable=!1,r.built=!0,r.sparse=e.sparse,null!=e.inputShape&&null!=e.batchInputShape)throw new Bi("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");var a=e.batchInputShape;if(null==a){if(null==e.inputShape)throw new Bi("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");a=[e.batchSize].concat(e.inputShape)}else if(null!=e.batchSize)throw new Bi("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");var i=e.dtype||"float32";r.batchInputShape=a,r.dtype=i,r.inputSpec=[{shape:a}];var o=new ds(r.dtype,r.batchInputShape,Ye.default(r),[],{},r.name);return o.nodeIndex=0,o.tensorIndex=0,new hs({outboundLayer:Ye.default(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[o],outputTensors:[o],inputMasks:[null],outputMasks:[null],inputShapes:[a],outputShapes:[a]}),r}return l.default(n,[{key:"apply",value:function(e,t){throw new Bi("Cannot pass any input to an "+"InputLayer's apply() method. InputLayer name: ".concat(this.name))}},{key:"dispose",value:function(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}},{key:"getConfig",value:function(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}]),n}(gs);function xs(e){if(null==e.batchShape&&null==e.shape)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(null!=e.batchShape&&null!=e.shape)throw new Bi("Please provide either a `shape` or `batchShape` argument to Input, but not both.");var t=e.batchShape;null!=e.shape&&null==t&&(t=[null].concat(e.shape));var n=e.dtype;return null==n&&(n="float32"),new ys({batchInputShape:t,name:e.name,dtype:n,sparse:e.sparse}).inboundNodes[0].outputTensors[0]}ys.className="InputLayer",Si.registerClass(ys),s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),p=s("2vsUb"),h=s("d6iiX"),Ye=s("jZS3C"),Pe=s("9M1dW"),v=s("40Zzs");s("jbRpz");m=s("P1tXK"),Ti=s("b3Qcj"),Ci=s("j0e1k"),it=s("6baO0"),g=s("kglvN");var bs=s("QkKgL");s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");var ks;m=s("P1tXK");function ws(e){return As.apply(this,arguments)}function As(){return As=f.default(t(v).mark((function e(n){var r,a,i,o,u,s,c,l;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=n){e.next=2;break}return e.abrupt("return");case 2:for(o in r=[],a=[],i=[],n)"number"!=typeof(u=n[o])&&(s=u,r.push(s.data()),a.push(o),i.push(s));if(!(r.length>0)){e.next=12;break}return e.next=9,Promise.all(r);case 9:for(c=e.sent,l=0;l<c.length;++l)n[a[l]]=c[l][0];m.dispose(i);case 12:case"end":return e.stop()}}),e)}))),As.apply(this,arguments)}function Es(e){if(null!=e)for(var t in e){var n=e[t];"number"!=typeof n&&n.dispose()}}!function(e){e[e.SILENT=0]="SILENT",e[e.VERBOSE=1]="VERBOSE"}(ks||(ks={}));var Cs=function(){"use strict";function e(){c.default(this,e),this.validationData=null}return l.default(e,[{key:"setParams",value:function(e){this.params=e}},{key:"onEpochBegin",value:function(e,n){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{key:"onEpochEnd",value:function(e,n){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{key:"onBatchBegin",value:function(e,n){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{key:"onBatchEnd",value:function(e,n){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{key:"onTrainBegin",value:function(e){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{key:"onTrainEnd",value:function(e){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()}},{key:"setModel",value:function(e){}}]),e}(),Ss=function(){"use strict";function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;c.default(this,e),null==t&&(t=[]),this.callbacks=t,this.queueLength=n}return l.default(e,[{key:"append",value:function(e){this.callbacks.push(e)}},{key:"setParams",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=this.callbacks[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.setParams(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"setModel",value:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=this.callbacks[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.setModel(e)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}},{key:"onEpochBegin",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i,o,u,s,c,l;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),i=!0,o=!1,u=void 0,t.prev=2,s=r.callbacks[Symbol.iterator]();case 4:if(i=(c=s.next()).done){t.next=11;break}return l=c.value,t.next=8,l.onEpochBegin(e,n);case 8:i=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),o=!0,u=t.t0;case 17:t.prev=17,t.prev=18,i||null==s.return||s.return();case 20:if(t.prev=20,!o){t.next=23;break}throw u;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),a,null,[[2,13,17,25],[18,,20,24]])})))()}},{key:"onEpochEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i,o,u,s,c,l;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),i=!0,o=!1,u=void 0,t.prev=2,s=r.callbacks[Symbol.iterator]();case 4:if(i=(c=s.next()).done){t.next=11;break}return l=c.value,t.next=8,l.onEpochEnd(e,n);case 8:i=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),o=!0,u=t.t0;case 17:t.prev=17,t.prev=18,i||null==s.return||s.return();case 20:if(t.prev=20,!o){t.next=23;break}throw u;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),a,null,[[2,13,17,25],[18,,20,24]])})))()}},{key:"onBatchBegin",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i,o,u,s,c,l;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),i=!0,o=!1,u=void 0,t.prev=2,s=r.callbacks[Symbol.iterator]();case 4:if(i=(c=s.next()).done){t.next=11;break}return l=c.value,t.next=8,l.onBatchBegin(e,n);case 8:i=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),o=!0,u=t.t0;case 17:t.prev=17,t.prev=18,i||null==s.return||s.return();case 20:if(t.prev=20,!o){t.next=23;break}throw u;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),a,null,[[2,13,17,25],[18,,20,24]])})))()}},{key:"onBatchEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i,o,u,s,c,l;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==n&&(n={}),i=!0,o=!1,u=void 0,t.prev=2,s=r.callbacks[Symbol.iterator]();case 4:if(i=(c=s.next()).done){t.next=11;break}return l=c.value,t.next=8,l.onBatchEnd(e,n);case 8:i=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),o=!0,u=t.t0;case 17:t.prev=17,t.prev=18,i||null==s.return||s.return();case 20:if(t.prev=20,!o){t.next=23;break}throw u;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),a,null,[[2,13,17,25],[18,,20,24]])})))()}},{key:"onTrainBegin",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a,i,o,u,s,c;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==e&&(e={}),a=!0,i=!1,o=void 0,t.prev=2,u=n.callbacks[Symbol.iterator]();case 4:if(a=(s=u.next()).done){t.next=11;break}return c=s.value,t.next=8,c.onTrainBegin(e);case 8:a=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),i=!0,o=t.t0;case 17:t.prev=17,t.prev=18,a||null==u.return||u.return();case 20:if(t.prev=20,!i){t.next=23;break}throw o;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),r,null,[[2,13,17,25],[18,,20,24]])})))()}},{key:"onTrainEnd",value:function(e){var n=this;return f.default(t(v).mark((function r(){var a,i,o,u,s,c;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:null==e&&(e={}),a=!0,i=!1,o=void 0,t.prev=2,u=n.callbacks[Symbol.iterator]();case 4:if(a=(s=u.next()).done){t.next=11;break}return c=s.value,t.next=8,c.onTrainEnd(e);case 8:a=!0,t.next=4;break;case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(2),i=!0,o=t.t0;case 17:t.prev=17,t.prev=18,a||null==u.return||u.return();case 20:if(t.prev=20,!i){t.next=23;break}throw o;case 23:return t.finish(20);case 24:return t.finish(17);case 25:case"end":return t.stop()}}),r,null,[[2,13,17,25],[18,,20,24]])})))()}}]),e}(),Ns=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(){return c.default(this,r),n.call(this)}return l.default(r,[{key:"onEpochBegin",value:function(e){var n=this;return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.seen=0,n.totals={};case 2:case"end":return e.stop()}}),e)})))()}},{key:"onBatchEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function e(){var a,i,o,u,s;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:var t=function(e){"number"==typeof(o=n[e])?(r.totals.hasOwnProperty(e)||(r.totals[e]=0),r.totals[e]=r.totals[e]+o*a):(e in r.totals?u=r.totals[e]:r.totals[e]=0,s=m.tidy((function(){return Ti.add(r.totals[e],Ci.mul(o,a))})),r.totals[e]=s,null!=u&&u.dispose())};for(i in null==n&&(n={}),a=null==n.size?0:n.size,r.seen+=a,n)t(i);case 4:case"end":return e.stop()}}),e)})))()}},{key:"onEpochEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function e(){var a,i,o,u,s,c;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=!0,i=!1,o=void 0,null==n){e.next=26;break}e.prev=2,u=r.params.metrics[Symbol.iterator]();case 4:if(a=(s=u.next()).done){e.next=12;break}if(c=s.value,null!=r.totals[c]){e.next=8;break}return e.abrupt("continue",9);case 8:"number"==typeof r.totals[c]?n[c]=r.totals[c]/r.seen:m.tidy((function(){var e=Ci.mul(it.div(1,r.seen),r.totals[c]);n[c]=e,r.totals[c].dispose(),m.keep(n[c])}));case 9:a=!0,e.next=4;break;case 12:e.next=18;break;case 14:e.prev=14,e.t0=e.catch(2),i=!0,o=e.t0;case 18:e.prev=18,e.prev=19,a||null==u.return||u.return();case 21:if(e.prev=21,!i){e.next=24;break}throw o;case 24:return e.finish(21);case 25:return e.finish(18);case 26:case"end":return e.stop()}}),e,null,[[2,14,18,26],[19,,21,25]])})))()}}]),r}(Cs),Ts=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(){return c.default(this,r),n.apply(this,arguments)}return l.default(r,[{key:"onTrainBegin",value:function(e){var n=this;return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.epoch=[],n.history={};case 2:case"end":return e.stop()}}),e)})))()}},{key:"onEpochEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i in null==n&&(n={}),r.epoch.push(e),n)null==r.history[i]&&(r.history[i]=[]),r.history[i].push(n[i]);case 3:case"end":return t.stop()}}),a)})))()}},{key:"syncData",value:function(){var e=this;return f.default(t(v).mark((function n(){var r,a,i,o,u,s,c,l,f;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o in r=[],a=[],i=[],e.history)for(u=e.history[o],s=0;s<u.length;++s)"number"!=typeof u[s]&&(c=u[s],r.push(c.data()),a.push(o),i.push(s));return t.next=6,Promise.all(r);case 6:for(l=t.sent,f=0;f<l.length;++f)e.history[a[f]][i[f]].dispose(),e.history[a[f]][i[f]]=l[f][0];case 8:case"end":return t.stop()}}),n)})))()}}]),r}(Cs),Ds=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e,t){var a,i,o,u,s;if(c.default(this,r),(a=n.call(this)).currentEpoch=0,a.yieldEvery=t||"auto","auto"===a.yieldEvery&&(a.yieldEvery=125),"never"===a.yieldEvery&&null!=e.onYield)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");return g.isNumber(a.yieldEvery)&&(a.maybeWait=(i=a.maybeWait.bind(Ye.default(a)),o=a.yieldEvery,s=g.now(),function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=g.now();return r-s<o?u:(s=r,u=i.apply(void 0,Pe.default(t)))})),a.trainBegin=e.onTrainBegin,a.trainEnd=e.onTrainEnd,a.epochBegin=e.onEpochBegin,a.epochEnd=e.onEpochEnd,a.batchBegin=e.onBatchBegin,a.batchEnd=e.onBatchEnd,a.yield=e.onYield,a}return l.default(r,[{key:"maybeWait",value:function(e,n,r){var a=this;return f.default(t(v).mark((function i(){var o;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o=[],null==a.yield){t.next=5;break}return t.next=4,ws(r);case 4:o.push(a.yield(e,n,r));case 5:return o.push(bs.nextFrame()),t.next=8,Promise.all(o);case 8:case"end":return t.stop()}}),i)})))()}},{key:"onEpochBegin",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.currentEpoch=e,null==r.epochBegin){t.next=6;break}return t.next=4,ws(n);case 4:return t.next=6,r.epochBegin(e,n);case 6:case"end":return t.stop()}}),a)})))()}},{key:"onEpochEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],null==r.epochEnd){t.next=5;break}return t.next=4,ws(n);case 4:i.push(r.epochEnd(e,n));case 5:return"epoch"===r.yieldEvery&&i.push(bs.nextFrame()),t.next=8,Promise.all(i);case 8:case"end":return t.stop()}}),a)})))()}},{key:"onBatchBegin",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==r.batchBegin){t.next=5;break}return t.next=3,ws(n);case 3:return t.next=5,r.batchBegin(e,n);case 5:case"end":return t.stop()}}),a)})))()}},{key:"onBatchEnd",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=[],null==r.batchEnd){t.next=5;break}return t.next=4,ws(n);case 4:i.push(r.batchEnd(e,n));case 5:return"batch"===r.yieldEvery?i.push(bs.nextFrame()):g.isNumber(r.yieldEvery)&&i.push(r.maybeWait(r.currentEpoch,e,n)),t.next=8,Promise.all(i);case 8:case"end":return t.stop()}}),a)})))()}},{key:"onTrainBegin",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n.trainBegin){t.next=5;break}return t.next=3,ws(e);case 3:return t.next=5,n.trainBegin(e);case 5:case"end":return t.stop()}}),r)})))()}},{key:"onTrainEnd",value:function(e){var n=this;return f.default(t(v).mark((function r(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==n.trainEnd){t.next=5;break}return t.next=3,ws(e);case 3:return t.next=5,n.trainEnd(e);case 5:case"end":return t.stop()}}),r)})))()}}]),r}(Cs);function Fs(e,t){return null==e&&(e={}),e instanceof Cs?[e]:Array.isArray(e)&&e[0]instanceof Cs?e:Wi(e).map((function(e){return new Ds(e,t)}))}var Os=function(){"use strict";function e(){c.default(this,e)}return l.default(e,null,[{key:"registerCallbackConstructor",value:function(t,n){g.assert(t>=0&&Number.isInteger(t),(function(){return"Verbosity level is expected to be an integer >= 0, "+"but got ".concat(t)})),e.checkForDuplicate(n),null==e.constructors[t]&&(e.constructors[t]=[]),e.constructors[t].push(n)}},{key:"checkForDuplicate",value:function(t){for(var n in e.constructors){e.constructors[+n].forEach((function(e){if(e===t)throw new Bi("Duplicate callback constructor.")}))}}},{key:"clear",value:function(){e.constructors={}}},{key:"createCallbacks",value:function(t){var n=[];for(var r in e.constructors){var a,i=+r;t>=i&&(a=n).push.apply(a,Pe.default(e.constructors[i]))}return n.map((function(e){return new e}))}}]),e}();function _s(e,t,n,r,a,i,o,u,s){var c,l=new Ts,f=[new Ns].concat(Pe.default(Os.createCallbacks(t)));null!=e&&(c=f).push.apply(c,Pe.default(e)),f.push(l);var d=new Ss(f);return d.setParams({epochs:n,initialEpoch:r,samples:a,steps:i,batchSize:o,verbose:t,doValidation:u,metrics:s}),{callbackList:d,history:l}}Os.constructors={},s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),d=s("6vecG"),F=s("kRKWT"),O=s("eYQ8O"),Pe=s("9M1dW"),v=s("40Zzs");s("jbRpz");y=s("4JvjV"),g=s("kglvN");var Is=s("aS8kb"),Rs=(m=s("P1tXK"),Eo=s("6hkW8"),ae=s("5J0XY"),nt=s("bftEy"),Ti=s("b3Qcj"),Ci=s("j0e1k"),it=s("6baO0"),s("4804C")),Ms=s("j8KB3");Si=s("6b8rQ");s("jbRpz");y=s("4JvjV"),g=s("kglvN"),Is=s("aS8kb"),m=s("P1tXK"),Eo=s("6hkW8"),ae=s("5J0XY"),nt=s("bftEy"),Ti=s("b3Qcj"),Ci=s("j0e1k"),it=s("6baO0"),Rs=s("4804C"),Ms=s("j8KB3"),Si=s("6b8rQ");s("jbRpz");Si=s("6b8rQ");function Bs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Xi(e,Si.SerializationMap.getMap().classNameMap,t,"layer",n)}s("jbRpz");m=s("P1tXK"),Ei=s("2xCpB");var Ps=s("jwnkA"),Ls=(Ai=s("buy0T"),s("k7Du7")),js=(it=s("6baO0"),Rs=s("4804C"),nu=s("fZE7S"),jo=s("3gUC5"),Ni=s("djUTy"),Ci=s("j0e1k"),s("WSSiT")),zs=(Ti=s("b3Qcj"),at=s("avJI0"),s("eQuwX")),Us=(lt=s("etmQx"),s("ee0Eu")),Vs=s("ksyR5");Bo=s("9ZTJv"),g=s("kglvN");s("jbRpz");m=s("P1tXK"),Ei=s("2xCpB"),Ps=s("jwnkA"),Ai=s("buy0T"),Ls=s("k7Du7"),it=s("6baO0"),Rs=s("4804C"),nu=s("fZE7S"),jo=s("3gUC5"),Ni=s("djUTy"),Ci=s("j0e1k"),js=s("WSSiT"),Ti=s("b3Qcj"),at=s("avJI0"),zs=s("eQuwX"),lt=s("etmQx"),Us=s("ee0Eu"),Vs=s("ksyR5"),Bo=s("9ZTJv"),g=s("kglvN");function Ws(e,t){return m.tidy((function(){"float32"!==e.dtype&&(e=e.asType("float32"));var n=Ei.sum(ku(e),t,!0),r=Ps.fill(n.shape,Oi()),a=Ai.sqrt(Ls.maximum(n,r));return it.div(e,a)}))}function Gs(e,t){return m.tidy((function(){return Rs.mean(ku(nu.sub(t,e)),-1)}))}function Hs(e,t){return m.tidy((function(){return Rs.mean(jo.abs(nu.sub(t,e)),-1)}))}function qs(e,t){return m.tidy((function(){var n=nu.sub(e,t),r=Ni.clipByValue(jo.abs(e),Oi(),Number.MAX_VALUE),a=jo.abs(it.div(n,r));return Ci.mul(100,Rs.mean(a,-1))}))}function Js(e,t){return m.tidy((function(){var n=Ni.clipByValue(t,Oi(),Number.MAX_VALUE),r=js.log(Ti.add(1,n)),a=Ni.clipByValue(e,Oi(),Number.MAX_VALUE),i=js.log(Ti.add(1,a));return Rs.mean(ku(nu.sub(r,i)),-1)}))}function Ks(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return m.tidy((function(){if(n)t=lt.softmax(t);else{var r=Ei.sum(t,t.shape.length-1,!0);t=it.div(t,r)}return t=Ni.clipByValue(t,Oi(),1-Oi()),Us.neg(Ei.sum(Ci.mul(e.toFloat(),js.log(t)),t.shape.length-1))}))}function Xs(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return m.tidy((function(){var r=Vs.floor(fu(e)).toInt(),a=(t=Ni.clipByValue(t,Oi(),1-Oi())).shape;return Ks(Bo.oneHot(r,a[a.length-1]).reshape(a),t,n)}))}function Ys(e,t){return m.tidy((function(){var n;return n=Ni.clipByValue(t,Oi(),1-Oi()),n=js.log(it.div(n,nu.sub(1,n))),Rs.mean(function(e,t){if(!g.arraysEqual(e.shape,t.shape))throw new Bi("logits and labels must have the same shape, but got shapes "+"".concat(JSON.stringify(e.shape)," and ").concat(JSON.stringify(t.shape)));return m.tidy((function(){var n=t.relu(),r=t.abs().neg();return n.sub(t.mul(e)).add(r.exp().log1p())}))}(e,n),-1)}))}function Qs(e,t){return m.tidy((function(){var n=Ni.clipByValue(e,Oi(),1),r=Ni.clipByValue(t,Oi(),1);return Ei.sum(Ci.mul(e,js.log(it.div(n,r))),-1)}))}function Zs(e,t){return m.tidy((function(){var n=Ws(e,-1),r=Ws(t,-1),a=Ci.mul(n,r);return Us.neg(Ei.sum(a,-1))}))}var $s={meanSquaredError:Gs,meanAbsoluteError:Hs,meanAbsolutePercentageError:qs,meanSquaredLogarithmicError:Js,squaredHinge:function(e,t){return m.tidy((function(){var n=Ls.maximum(0,nu.sub(1,Ci.mul(e,t)));return Rs.mean(ku(n),-1)}))},hinge:function(e,t){return m.tidy((function(){var n=Ls.maximum(0,nu.sub(1,Ci.mul(e,t)));return Rs.mean(n,-1)}))},categoricalHinge:function(e,t){return m.tidy((function(){var n=Ei.sum(Ci.mul(e,t),-1),r=at.max(Ci.mul(nu.sub(1,e),t),-1);return Ls.maximum(0,Ti.add(1,nu.sub(r,n)))}))},logcosh:function(e,t){return m.tidy((function(){var n=Math.log(2),r=nu.sub(t,e),a=nu.sub(Ti.add(r,zs.softplus(Ci.mul(-2,r))),n);return Rs.mean(a,-1)}))},categoricalCrossentropy:Ks,sparseCategoricalCrossentropy:Xs,binaryCrossentropy:Ys,kullbackLeiblerDivergence:Qs,poisson:function(e,t){return m.tidy((function(){var n=js.log(Ti.add(Oi(),t));return Rs.mean(nu.sub(t,Ci.mul(e,n)),-1)}))},cosineProximity:Zs};function ec(e){if("string"==typeof e){if(e in $s)return $s[e];var t="Unknown loss ".concat(e);throw e.toLowerCase().includes("softmaxcrossentropy")&&(t="Unknown loss ".concat(e,". ")+'Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy'),new Bi(t)}return e}s("jbRpz");m=s("P1tXK"),Ci=s("j0e1k"),Io=s("4z0yD"),Mo=s("ejjI8"),Rs=s("4804C"),ut=s("iuFae");var tc=s("9UQ7R"),nc=s("7WLBj");Ro=s("6FAlx");s("jbRpz");m=s("P1tXK"),Ci=s("j0e1k"),Io=s("4z0yD"),Mo=s("ejjI8"),Rs=s("4804C"),ut=s("iuFae"),tc=s("9UQ7R"),nc=s("7WLBj"),Ro=s("6FAlx");function rc(e,t){return m.tidy((function(){var n=Ci.mul(.5,Io.onesLike(t)),r=cu(Mo.greater(t,n),e.dtype);return Rs.mean(ut.equal(e,r),-1)}))}function ac(e,t){return m.tidy((function(){return cu(ut.equal(tc.argMax(e,-1),tc.argMax(t,-1)),"float32")}))}function ic(e,t){return m.tidy((function(){return nc.logicalAnd(e.equal(1),t.equal(1)).sum().cast("float32")}))}function oc(e,t){return m.tidy((function(){var n=ic(e,t),r=function(e,t){return m.tidy((function(){return nc.logicalAnd(e.equal(0),t.equal(1)).sum().cast("float32")}))}(e,t),a=n.add(r);return Ro.where(Mo.greater(a,0),n.div(a),0).cast("float32")}))}function uc(e,t){return Ys(e,t)}function sc(e,t){return e.rank===t.rank&&(e=e.squeeze([e.rank-1])),(t=t.argMax(-1)).dtype!==e.dtype&&(t=t.asType(e.dtype)),ut.equal(e,t).asType("float32")}var cc=Ks,lc=Xs,fc={binaryAccuracy:rc,categoricalAccuracy:ac,precision:oc,categoricalCrossentropy:cc,sparseCategoricalCrossentropy:lc,mse:Gs,MSE:Gs,mae:Hs,MAE:Hs,mape:qs,MAPE:qs,cosine:Zs};function dc(e){if(zi(null!==e,"Unknown LossOrMetricFn ".concat(e)),"string"==typeof e)return e;var t,n=!0,r=!1,a=void 0;try{for(var i,o=Object.keys($s)[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;if($s[u]===e){t=u;break}}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if(void 0!==t)return t;var s=!0,c=!1,l=void 0;try{for(var f,d=Object.keys(fc)[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;if(fc[p]===e){t=p;break}}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return void 0!==t?t:e.name}s("jbRpz");var pc=s("aqs9m");s("1i51P");_i=s("5lcaY");var hc=1048576;function vc(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e||"object"!=typeof e||Object.getPrototypeOf(e)!==Object.prototype||!gc(e))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){var r=JSON.stringify(e);r.length>hc&&console.warn('User-defined metadata of model "'.concat(t,'" is too large in ')+"size (length=".concat(r.length," when serialized). It is not ")+"recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= "+"".concat(hc,"."))}}function gc(e){if(null===e)return!0;if("object"==typeof e){if(Object.getPrototypeOf(e)===Object.prototype){var t=Object.keys(e),n=!0,r=!1,a=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;if("string"!=typeof u)return!1;if(!gc(e[u]))return!1}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return!0}if(Array.isArray(e)){var s=!0,c=!1,l=void 0;try{for(var f,d=e[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){if(!gc(f.value))return!1}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}return!0}return!1}var p=void 0===e?"undefined":_i.default(e);return"string"===p||"number"===p||"boolean"===p}s("1i51P");Pe=s("9M1dW");function mc(e,t,n){var r,a,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:console.log,o=xc(e),u=["Layer (type)","Output shape","Param #"];if(o?(t=t||65,n=n||[.45,.85,1]):(t=t||98,n=n||[.33,.55,.67,1]),n[n.length-1]<=1&&(n=n.map((function(e){return Math.floor(t*e)}))),!o)for(var s in u.push("Receives inputs"),r=[],e.nodesByDepth)(a=r).push.apply(a,Pe.default(e.nodesByDepth[s]));i("_".repeat(t)),bc(u,n,i),i("=".repeat(t));for(var c=e.layers,l=0;l<c.length;++l)o?kc(c[l],n,i):wc(c[l],n,r,i),i((l===c.length-1?"=":"_").repeat(t));e.checkTrainableWeightsConsistency();var f=yc(e),d=as(e.nonTrainableWeights);i("Total params: ".concat(f+d)),i("Trainable params: ".concat(f)),i("Non-trainable params: ".concat(d)),i("_".repeat(t))}function yc(e){return null!=e.collectedTrainableWeights?as(e.collectedTrainableWeights):as(e.trainableWeights)}function xc(e){var t=!0,n=[],r=[];for(var a in e.nodesByDepth)n.push(e.nodesByDepth[a]);var i=!0,o=!1,u=void 0;try{for(var s,c=n[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l,f=s.value;if(f.length>1||1===f.length&&f[0].inboundLayers.length>1){t=!1;break}(l=r).push.apply(l,Pe.default(f))}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}var d=!0,p=!1,h=void 0;if(t)try{for(var v,g=e.layers[Symbol.iterator]();!(d=(v=g.next()).done);d=!0){var m=v.value,y=!1,x=!0,b=!1,k=void 0;try{for(var w,A=m.inboundNodes[Symbol.iterator]();!(x=(w=A.next()).done);x=!0){var E=w.value;if(-1!==r.indexOf(E)){if(y){t=!1;break}y=!0}}}catch(e){b=!0,k=e}finally{try{x||null==A.return||A.return()}finally{if(b)throw k}}if(!t)break}}catch(e){p=!0,h=e}finally{try{d||null==g.return||g.return()}finally{if(p)throw h}}return t}function bc(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log,r="",a=0;a<e.length;++a)a>0&&(r=r.slice(0,r.length-1)+" "),r=(r+=e[a]).slice(0,t[a]),r+=" ".repeat(t[a]-r.length);n(r)}function kc(e,t,n){var r;try{r=JSON.stringify(e.outputShape)}catch(e){r="multiple"}var a=e.name,i=e.getClassName();bc(["".concat(a," (").concat(i,")"),r,e.countParams().toString()],t,n)}function wc(e,t,n,r){var a;try{a=JSON.stringify(e.outputShape)}catch(e){a="multiple"}var i=[],o=!0,u=!1,s=void 0;try{for(var c,l=e.inboundNodes[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;if(!(null!=n&&n.length>0&&-1===n.indexOf(f)))for(var d=0;d<f.inboundLayers.length;++d){var p=f.inboundLayers[d].name,h=f.nodeIndices[d],v=f.tensorIndices[d];i.push("".concat(p,"[").concat(h,"][").concat(v,"]"))}}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}var g=e.name,m=e.getClassName(),y=0===i.length?"":i[0];bc(["".concat(g," (").concat(m,")"),a,e.countParams().toString(),y],t,r);for(var x=1;x<i.length;++x)bc(["","","",i[x]],t,r)}function Ac(e,t,n){return("inboundNodes"===e||"outputLayers"===e||"inputLayers"===e)&&0===t&&"string"==typeof n}function Ec(e,t){if(null===e)return null;if("string"==typeof e)return Hi(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Ac(t,a,i)?n.push(i):n.push(Ec(i,t))}return n}var o={},u=!0,s=!1,c=void 0;try{for(var l,f=Object.keys(e)[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value,p=e[d];if("name"===d&&"string"==typeof p)o[d]=p;else{var h=Hi(d);o[h]=Ec(p,h)}}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}return o}function Cc(e,t){if(null==e)return null;if("string"==typeof e)return Gi(e);if("number"==typeof e||"boolean"==typeof e)return e;if(e instanceof Array){for(var n=[],r=e.length,a=0;a<r;++a){var i=e[a];Ac(t,a,i)?n.push(i):n.push(Cc(i,t))}return n}var o={},u=!0,s=!1,c=void 0;try{for(var l,f=Object.keys(e)[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value,p=e[d],h=Gi(d);o[h]="name"!==d&&"className"!==d||"string"!=typeof p?Cc(p,d):p}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}return o}
/** @license See the LICENSE file. */var Sc="2.4.0";s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),Ye=s("jZS3C"),l=s("2tuUj"),Pe=s("9M1dW"),d=s("6vecG");s("jbRpz");m=s("P1tXK");s("1i51P");c=s("3QOYJ"),l=s("2tuUj");s("jbRpz");var Nc=s("782ce");m=s("P1tXK"),g=s("kglvN");var Tc=function(){"use strict";function e(t){if(c.default(this,e),this.id2Value={},this.id2Mask={},this.name2Id={},t instanceof e)for(var n in t.id2Value)this.id2Value[n]=t.id2Value[n],n in t.id2Mask&&(this.id2Mask[n]=t.id2Mask[n]);else{if(null==t)return;var r=!0,a=!1,i=void 0;try{for(var o,u=t[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;this.add(s.key,s.value)}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}}}return l.default(e,[{key:"add",value:function(e,t,n){if(null!=this.id2Value[e.id])throw new Bi("Duplicate key: name=".concat(e.name,", id=").concat(e.id));return this.id2Value[e.id]=function(e,t){if(null==e.dtype||e.dtype===t.dtype)return t;try{return Nc.cast(t,e.dtype)}catch(n){throw new Bi("The dtype of the feed (".concat(t.dtype,") can not be cast to the dtype ")+"of the key '".concat(e.name,"' (").concat(e.dtype,")."))}}(e,t),this.name2Id[e.name]=e.id,null!=n&&(this.id2Mask[e.id]=n),this}},{key:"addFeed",value:function(e){this.add(e.key,e.value)}},{key:"hasKey",value:function(e){return null!=this.id2Value[e.id]}},{key:"names",value:function(){return Object.keys(this.name2Id)}},{key:"getValue",value:function(e){if(e instanceof ds){if(null==this.id2Value[e.id])throw new Bi("Nonexistent key: ".concat(e.name));return this.id2Value[e.id]}var t=this.name2Id[e];if(null==t)throw new Bi("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Value[t]}},{key:"getMask",value:function(e){if(e instanceof ds){if(null==this.id2Value[e.id])throw new Bi("Nonexistent key: ".concat(e.name));return this.id2Mask[e.id]}var t=this.name2Id[e];if(null==t)throw new Bi("Feed dict has no SymbolicTensor name: ".concat(e));return this.id2Mask[t]}},{key:"disposeMasks",value:function(){null!=this.id2Mask&&m.dispose(this.id2Mask)}}]),e}(),Dc={},Fc={};function Oc(e,t,n,r){var a=null!=n&&n.training,i=Array.isArray(e),o=i?e:[e],u=o.map((function(e){return e.name})),s=[],c=t.names(),l=!0,f=!1,d=void 0;try{for(var p,h=u[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;-1!==c.indexOf(v)?s.push(t.getValue(v)):s.push(null)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}null!=r&&(r.maxNumTensors=-1/0,r.minNumTensors=1/0);var y,x,b=u.join(",")+"|"+t.names().join(",");if(null==Dc[b]){var k=function(e,t){g.assert(null!=e&&e.length>0,(function(){return"Expected at least one fetch, got none"}));var n=[],r={};if(1===e.length){var a=Ic(e[0],t);n=a.sorted,r=a.recipientMap}else{var i=new Set,o=!0,u=!1,s=void 0;try{for(var c,l=function(e,a){var o=function(e){null==r[e]&&(r[e]=new Set),c[e].forEach((function(t){return r[e].add(t)}))},u=Ic(a.value,t),s=u.sorted,c=u.recipientMap,l=!0,f=!1,d=void 0;try{for(var p,h=s[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;i.has(v.name)||(n.push(v),i.add(v.name))}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}for(var g in c)o(g)},f=e[Symbol.iterator]();!(o=(c=f.next()).done);o=!0)l(f,c)}catch(e){u=!0,s=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}}return{sorted:n,recipientCounts:_c(r)}}(o,t);y=k.sorted,x=k.recipientCounts,Dc[b]=y,Fc[b]=x}y=Dc[b],x={},a||Object.assign(x,Fc[b]);for(var w=new Tc(t),A=0;A<y.length;++A){if(null!=r){var E=m.memory().numTensors;E>r.maxNumTensors&&(r.maxNumTensors=E),E<r.minNumTensors&&(r.minNumTensors=E)}var C=y[A],S=C.sourceLayer;if(!(S instanceof ys)){var N=[],T=[],D=[],F=!1,O=!0,_=!1,I=void 0;try{for(var R,M=C.inputs[Symbol.iterator]();!(O=(R=M.next()).done);O=!0){var B=R.value,P=w.getValue(B),L=w.getMask(B);N.push(P),T.push(L),null!=L&&(F=!0),a||(x[B.name]--,0!==x[B.name]||t.hasKey(B)||-1!==u.indexOf(B.name)||P.isDisposed||!0===B.sourceLayer.stateful||D.push(P))}}catch(e){_=!0,I=e}finally{try{O||null==M.return||M.return()}finally{if(_)throw I}}F&&((n=n||{}).mask=T[0]);var j=Wi(S.apply(N,n)),z=null;S.supportsMasking&&(z=S.computeMask(N,T));for(var U=Rc(C),V=Array.isArray(U)?U:[U],W=0;W<V.length;++W){w.hasKey(V[W])||w.add(V[W],j[W],Array.isArray(z)?z[0]:z);var G=u.indexOf(V[W].name);-1!==G&&(s[G]=j[W])}a||m.dispose(D)}}return w.disposeMasks(),i?s:s[0]}function _c(e){var t={};for(var n in e)t[n]=e[n].size;return t}function Ic(e,t){var n=new Set,r=[],a={},i=!0,o=!1,u=void 0;try{for(var s,c=t.names()[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;n.add(l)}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}var f=[],d=[];for(f.push(e);f.length>0;){var p=f[f.length-1];if(n.has(p.name))f.pop();else{var h=d[d.length-1]===f.length-1;if(0===p.inputs.length||h)f.pop(),r.push(p),n.add(p.name),h&&d.pop();else{d.push(f.length-1);var v=!0,g=!1,m=void 0;try{for(var y,x=p.inputs[Symbol.iterator]();!(v=(y=x.next()).done);v=!0){var b=y.value;null==a[b.name]&&(a[b.name]=new Set),a[b.name].add(p.name),n.has(b.name)||f.push(b)}}catch(e){g=!0,m=e}finally{try{v||null==x.return||x.return()}finally{if(g)throw m}}}}}return{sorted:r,recipientMap:a}}function Rc(e){var t;if(1===e.sourceLayer.inboundNodes.length)t=e.sourceLayer.output;else{for(var n=null,r=0;r<e.sourceLayer.inboundNodes.length;++r){var a=!0,i=!1,o=void 0;try{for(var u,s=e.sourceLayer.inboundNodes[r].outputTensors[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){if(u.value.id===e.id){n=r;break}}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}}t=e.sourceLayer.getOutputAt(n)}return t}var Mc=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,{})).containerNodes=new Set,r.name=e.name,null==r.name){var a=r.getClassName().toLowerCase();r.name=$u(a)}if(r.supportsMasking=!1,r.trainable_=!0,Array.isArray(e.inputs)?r.inputs=e.inputs.slice():r.inputs=[e.inputs],Array.isArray(e.outputs)?r.outputs=e.outputs.slice():r.outputs=[e.outputs],Qi(r.inputs).length!==r.inputs.length)throw new Bi("The list of inputs passed to the model is redundant. All inputs should only appear once. Found: "+"".concat(r.inputs.map((function(e){return e.name}))));Qi(r.outputs).length!==r.outputs.length&&console.warn("The list of outputs passed to the model is redundant. All outputs should only appear once. Found: "+"".concat(r.outputs.map((function(e){return e.name})))),r.inputLayers=[],r.inputLayersNodeIndices=[],r.inputLayersTensorIndices=[],r.outputLayers=[],r.outputLayersNodeIndices=[],r.outputLayersTensorIndices=[],r.layers=[],r.internalContainerRefs=[];var i=!0,o=!1,u=void 0;try{for(var s,l=r.outputs[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var f=s.value,d=f.sourceLayer,p=f.nodeIndex,h=f.tensorIndex;r.outputLayers.push(d),r.outputLayersNodeIndices.push(p),r.outputLayersTensorIndices.push(h)}}catch(e){o=!0,u=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw u}}var v=!0,g=!1,m=void 0;try{for(var y,x=r.inputs[Symbol.iterator]();!(v=(y=x.next()).done);v=!0){var b=y.value,k=b.sourceLayer,w=b.nodeIndex,A=b.tensorIndex;zi(0===w,"input layer has >1 nodes"),zi(0===A,"input layer has >1 tensors"),r.inputLayers.push(k),r.inputLayersNodeIndices.push(w),r.inputLayersTensorIndices.push(A)}}catch(e){g=!0,m=e}finally{try{v||null==x.return||x.return()}finally{if(g)throw m}}r.inputNames=[],r.outputNames=[],r.feedInputShapes=[],r.feedInputNames=[],r.feedOutputNames=[];for(var E=0;E<r.inputLayers.length;E++){var C=r.inputLayers[E];if(!(C instanceof ys))throw new TypeError("Input layers to a LayersModel must be InputLayer objects. "+"Received inputs: ".concat(e.inputs,". ")+"Input ".concat(E," (0-based) originates ")+"from layer type ".concat(C.getClassName(),"."));r.inputNames.push(C.name),r.feedInputShapes.push(C.batchInputShape),r.feedInputNames.push(C.name)}var S=!0,N=!1,T=void 0;try{for(var D,F=r.outputLayers[Symbol.iterator]();!(S=(D=F.next()).done);S=!0){var O=D.value;r.outputNames.push(O.name)}}catch(e){N=!0,T=e}finally{try{S||null==F.return||F.return()}finally{if(N)throw T}}r.internalInputShapes=r.inputs.map((function(e){return e.shape})),r.internalOutputShapes=r.outputs.map((function(e){return e.shape}));var _={},I={},R={},M={},B={},P=[],L=function(e,t,a,i,o,u){null!=i&&null!=o&&null!=u||(i=e.sourceLayer,o=e.nodeIndex,u=e.tensorIndex);var s=i.inboundNodes[o];if(-1!==a.indexOf(s))throw new Mi("The tensor ".concat(e.name,' at layer "').concat(i.name,'" ')+"is part of a cycle.");if(-1===t.indexOf(s)){r.containerNodes.add(n.nodeKey(i,o)),i.id in B||(B[i.id]=Object.keys(B).length),-1===a.indexOf(s)&&a.push(s);for(var c=s.inboundLayers.length,l=0;l<c;l++){var f=s.inputTensors[l],d=s.inboundLayers[l],p=s.nodeIndices[l],h=s.tensorIndices[l];L(f,t,a,d,p,h)}for(t.push(s);a.indexOf(s)>=0;)a.splice(a.indexOf(s),1);P.push(s)}},j=[],z=[],U=!0,V=!1,W=void 0;try{for(var G,H=r.outputs[Symbol.iterator]();!(U=(G=H.next()).done);U=!0){var q=G.value;L(q,j,z)}}catch(e){V=!0,W=e}finally{try{U||null==H.return||H.return()}finally{if(V)throw W}}var J=P.slice().reverse(),K=!0,X=!1,Y=void 0;try{for(var Q,Z=J[Symbol.iterator]();!(K=(Q=Z.next()).done);K=!0){var $=Q.value;I[$.id]=$,$.id in _||(_[$.id]=0);var ee=_[$.id],te=null==R[$.outboundLayer.id]?0:R[$.outboundLayer.id];ee=Math.max(ee,te),R[$.outboundLayer.id]=ee,M[$.outboundLayer.id]=$.outboundLayer,_[$.id]=ee;for(var ne=0;ne<$.inboundLayers.length;ne++){var re=$.inboundLayers[ne],ae=$.nodeIndices[ne],ie=re.inboundNodes[ae],oe=null==_[ie.id]?0:_[ie.id];_[ie.id]=Math.max(ee+1,oe),I[ie.id]=ie}}}catch(e){X=!0,Y=e}finally{try{K||null==Z.return||Z.return()}finally{if(X)throw Y}}var ue={};for(var se in _){var ce=_[se];ce in ue||(ue[ce]=[]),ue[ce].push(I[se])}var le={};for(var fe in R){var de=R[fe];de in le||(le[de]=[]),le[de].push(M[fe])}var pe=Object.keys(le).map((function(e){return parseInt(e,10)})).sort(Yi);r.layers=[];var he=!0,ve=!1,ge=void 0;try{for(var me,ye=pe[Symbol.iterator]();!(he=(me=ye.next()).done);he=!0){var xe=le[me.value];xe.sort((function(e,t){var n=B[e.id],r=B[t.id];return n<r?-1:n>r?1:0}));var be=!0,ke=!1,we=void 0;try{for(var Ae,Ee=xe[Symbol.iterator]();!(be=(Ae=Ee.next()).done);be=!0){var Ce=Ae.value;Ce instanceof n&&r.internalContainerRefs.push(Ce),r.layers.push(Ce)}}catch(e){ke=!0,we=e}finally{try{be||null==Ee.return||Ee.return()}finally{if(ke)throw we}}}}catch(e){ve=!0,ge=e}finally{try{he||null==ye.return||ye.return()}finally{if(ve)throw ge}}r.layersByDepth=le,pe=Object.keys(ue).map((function(e){return parseInt(e,10)})).sort(Yi);var Se=r.inputs.slice(),Ne=[],Te=!0,De=!1,Fe=void 0,Oe=!0,_e=!1,Ie=void 0;try{for(var Re,Me=pe[Symbol.iterator]();!(Oe=(Re=Me.next()).done);Oe=!0){var Be=Re.value;try{for(var Pe,Le=ue[Be][Symbol.iterator]();!(Te=(Pe=Le.next()).done);Te=!0){var je=Pe.value,ze=je.outboundLayer;if(null!=ze){var Ue=!0,Ve=!1,We=void 0;try{for(var Ge,He=je.inputTensors[Symbol.iterator]();!(Ue=(Ge=He.next()).done);Ue=!0){var qe=Ge.value;if(-1===Se.indexOf(qe))throw new Mi("Graph disconnected: cannot obtain value for tensor ".concat(qe)+' at layer "'.concat(ze.name,'". ')+"The following previous layers were accessed without "+"issue: ".concat(Ne))}}catch(e){Ve=!0,We=e}finally{try{Ue||null==He.return||He.return()}finally{if(Ve)throw We}}var Je=!0,Ke=!1,Xe=void 0;try{for(var Qe,Ze=je.outputTensors[Symbol.iterator]();!(Je=(Qe=Ze.next()).done);Je=!0){var $e=Qe.value;Se.push($e)}}catch(e){Ke=!0,Xe=e}finally{try{Je||null==Ze.return||Ze.return()}finally{if(Ke)throw Xe}}Ne.push(ze.name)}}}catch(e){De=!0,Fe=e}finally{try{Te||null==Le.return||Le.return()}finally{if(De)throw Fe}}}}catch(e){_e=!0,Ie=e}finally{try{Oe||null==Me.return||Me.return()}finally{if(_e)throw Ie}}r.nodesByDepth=ue;var et=r.layers.map((function(e){return e.name})),tt=!0,nt=!1,rt=void 0;try{for(var at,it=function(e,t){var n=t.value,r=et.filter((function(e){return e===n})).length;if(1!==r)throw new Mi('The name "'.concat(n,'" is used ').concat(r," times ")+"in the model. All layer names should be unique. Layer names: "+JSON.stringify(et))},ot=et[Symbol.iterator]();!(tt=(at=ot.next()).done);tt=!0)it(0,at)}catch(e){nt=!0,rt=e}finally{try{tt||null==ot.return||ot.return()}finally{if(nt)throw rt}}return r.outboundNodes=[],r.inboundNodes=[],new hs({outboundLayer:Ye.default(r),inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:r.inputs,outputTensors:r.outputs,inputMasks:r.inputs.map((function(e){return null})),outputMasks:r.outputs.map((function(e){return null})),inputShapes:r.inputs.map((function(e){return e.shape})),outputShapes:r.outputs.map((function(e){return e.shape}))}),r.built=!0,r._refCount=1,r}return l.default(n,[{key:"assertNotDisposed",value:function(){if(0===this._refCount)throw new Error("Container '".concat(this.name,"' is already disposed."))}},{key:"dispose",value:function(){this.assertNotDisposed();var e={refCountAfterDispose:null,numDisposedVariables:0};if(0==--this._refCount){var t=!0,n=!1,r=void 0;try{for(var a,i=this.layers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;e.numDisposedVariables+=o.dispose().numDisposedVariables}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}var u=!0,s=!1,c=void 0;try{for(var l,f=this.internalContainerRefs[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;e.numDisposedVariables+=d.dispose().numDisposedVariables}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}}return e.refCountAfterDispose=this._refCount,e}},{key:"trainable",get:function(){return this.trainable_},set:function(e){this.layers.forEach((function(t){t._trainableWeights.forEach((function(t){return t.trainable=e}))})),this.trainable_=e}},{key:"trainableWeights",get:function(){if(this._trainableWeights.length>0)throw new Bi("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=this.layers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value;e=e.concat(o.trainableWeights)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return e}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=!0,r=!1,a=void 0;try{for(var i,o=this.layers[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;(e=t).push.apply(e,Pe.default(u.nonTrainableWeights))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if(!this.trainable){var s,c=[],l=!0,f=!1,d=void 0;try{for(var p,h=this.layers[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;(s=c).push.apply(s,Pe.default(v.trainableWeights))}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}return c.concat(t)}return t}},{key:"weights",get:function(){return this.trainableWeights.concat(this.nonTrainableWeights)}},{key:"loadWeights",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={},r=0,a=!0,i=!1,o=void 0,u=!0,s=!1,c=void 0;try{for(var l,f=this.layers[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value;try{for(var p,h=d.weights[Symbol.iterator]();!(a=(p=h.next()).done);a=!0){var v=p.value;if(null!=n[v.originalName])throw new Bi("Duplicate weight name: ".concat(v.originalName));n[v.originalName]=v,r++}}catch(e){i=!0,o=e}finally{try{a||null==h.return||h.return()}finally{if(i)throw o}}}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}var g=[];for(var m in e){var y=m;if(null==n[m]){var x=m.split("/"),b=x.slice(0,-2).concat([x[x.length-1]]);y=b.join("/")}if(null!=n[y])g.push([n[y],e[m]]);else if(t)throw new Bi("Provided weight data has no target variable: ".concat(m));delete n[y]}if(t){var k=[];for(var w in n)k.push(w);if(k.length>0)throw new Bi("".concat(k.length," of ").concat(r," weights are not set: ")+"".concat(k))}ls(g)}},{key:"updatedConfig",value:function(){var e=this.getConfig(),t={};return t.className=this.getClassName(),t.config=e,t.kerasVersion="tfjs-layers ".concat(Sc),t.backend="TensorFlow.js",t}},{key:"toJSON",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Cc(this.updatedConfig());return t?JSON.stringify(n):n}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){e=Wi(e);for(var r=new Tc,a=0;a<n.inputs.length;++a)r.add(n.inputs[a],e[a]);return Oc(n.outputs,r,t)}))}},{key:"computeMask",value:function(e,t){var n=this;return m.tidy((function(){var r;return e=Wi(e),r=null==t?ji(null,e.length):Wi(t),n.runInternalGraph(e,r)[1]}))}},{key:"computeOutputShape",value:function(e){var t=ts(e);if(t.length!==this.inputLayers.length)throw new Bi("Invalid inputShape argument ".concat(e,": ")+"model has ".concat(this.inputLayers.length," tensor inputs."));for(var n={},r=0;r<t.length;r++){var a=this.inputLayers[r],i=t[r],o=a.name+"_0_0";n[o]=i}var u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Yi),s=!0,c=!1,l=void 0;if(u.length>1)try{for(var f,d=u[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value,h=this.nodesByDepth[p],v=!0,g=!1,m=void 0;try{for(var y,x=this,b=function(e,t){var r=t.value,a=r.outboundLayer;if(-1!==x.inputLayers.map((function(e){return e.id})).indexOf(a.id))return"continue";for(var i=[],o=0;o<r.inboundLayers.length;o++){var u=r.inboundLayers[o],s=r.nodeIndices[o],c=r.tensorIndices[o],l="".concat(u.name,"_").concat(s,"_").concat(c),f=n[l];i.push(f)}for(var d=ts(a.computeOutputShape(Vi(i))),p=a.inboundNodes.indexOf(r),h=0;h<d.length;h++){var v="".concat(a.name,"_").concat(p,"_").concat(h);n[v]=d[h]}},k=h[Symbol.iterator]();!(v=(y=k.next()).done);v=!0)b(0,y)}catch(e){g=!0,m=e}finally{try{v||null==k.return||k.return()}finally{if(g)throw m}}}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}for(var w=[],A=[],E=0;E<this.outputLayers.length;E++){var C=this.outputLayers[E],S=this.outputLayersNodeIndices[E],N=this.outputLayersTensorIndices[E],T="".concat(C.name,"_").concat(S,"_").concat(N);A.push(T)}for(var D=0;D<A.length;D++){var F=A[D];zi(F in n),w.push(n[F])}return Vi(w)}},{key:"runInternalGraph",value:function(e,t){null==t&&(t=ji(null,e.length));for(var n={},r=0;r<this.inputs.length;++r){var a=this.inputs[r],i=e[r],o=t[r];n[a.id]=[i,o]}var u=Object.keys(this.nodesByDepth).map((function(e){return parseInt(e,10)})).sort(Yi),s=!0,c=!1,l=void 0;try{for(var f,p=u[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var h=f.value,v=this.nodesByDepth[h],g=!0,m=!1,y=void 0;try{for(var x,b=function(e,t){var r=t.value,a=r.outboundLayer,i=r.inputTensors,o=r.outputTensors,u=new Array,s=!0,c=!1,l=void 0;try{for(var f,p=i[Symbol.iterator]();!(s=(f=p.next()).done);s=!0){var h=f.value;h.id in n&&u.push(n[h.id])}}catch(e){c=!0,l=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}if(u.length===i.length){var v={},g=void 0,m=void 0,y=void 0,x=void 0;if(null!=r.callArgs&&(v=r.callArgs),1===u.length){var b=d.default(u[0],2),k=b[0],w=b[1];null==v.mask&&(v.mask=w),y=Wi(a.call(k,v)),x=Wi(a.computeMask(k,w)),g=[k],m=[w]}else g=u.map((function(e){return e[0]})),m=u.map((function(e){return e[1]})),null==v.mask&&(v.mask=m),y=Wi(a.call(g,v)),x=Wi(a.computeMask(g,m));if(a.activityRegularizer)throw new Pi("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(var A=0;A<o.length;++A){var E=o[A],C=y[A],S=x[A];n[E.id]=[C,S]}}},k=v[Symbol.iterator]();!(g=(x=k.next()).done);g=!0)b(0,x)}catch(e){m=!0,y=e}finally{try{g||null==k.return||k.return()}finally{if(m)throw y}}}}catch(e){c=!0,l=e}finally{try{s||null==p.return||p.return()}finally{if(c)throw l}}var w=[],A=[],E=[],C=!0,S=!1,N=void 0;try{for(var T,D=this.outputs[Symbol.iterator]();!(C=(T=D.next()).done);C=!0){var F=T.value;zi(F.id in n,"Could not compute output ".concat(F.name," : ").concat(F.id));var O=d.default(n[F.id],2),_=O[0],I=O[1];E.push(_.shape),w.push(_),A.push(I)}}catch(e){S=!0,N=e}finally{try{C||null==D.return||D.return()}finally{if(S)throw N}}return[w,A,E]}},{key:"buildNodeConversionMap",value:function(e){var t,r={},a=!0,i=!1,o=void 0;try{for(var u,s=this.layers[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;t=c instanceof n?1:0;for(var l=0;l<c.inboundNodes.length;l++){var f=n.nodeKey(c,l);this.containerNodes.has(f)&&(r[f]=t,t+=1)}}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return r}},{key:"getLayer",value:function(e,t){if(null!=t){if(this.layers.length<=t)throw new Bi("Was asked to retrieve layer at index ".concat(t,", but model only ")+"has ".concat(this.layers.length," layer(s)."));return this.layers[t]}if(null==e)throw new Bi("Provide either a layer name or layer index");var n=!0,r=!1,a=void 0;try{for(var i,o=this.layers[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;if(u.name===e)return u}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}throw new Bi("No such layer: ".concat(e))}},{key:"calculateLosses",value:function(){var e=this;return m.tidy((function(){var t=[],r=!0,a=!1,i=void 0;try{for(var o,u=e.layers[Symbol.iterator]();!(r=(o=u.next()).done);r=!0)for(var s=o.value,c=0;c<s.inboundNodes.length;++c){var l,f=n.nodeKey(s,c);e.containerNodes.has(f)&&(l=t).push.apply(l,Pe.default(s.calculateLosses()))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}return t}))}},{key:"getConfig",value:function(){var e={name:this.name},t=this.buildNodeConversionMap(this.layers),r=[],a=!0,i=!1,o=void 0;try{for(var u,s=this.layers[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){for(var c=u.value,l=c.getClassName(),f=c.getConfig(),d=[],p=0;p<c.inboundNodes.length;p++){var h=c.inboundNodes[p],v=n.nodeKey(c,p),g={};if(this.containerNodes.has(v)){if(h.callArgs)try{JSON.stringify(h.callArgs),g=h.callArgs}catch(e){console.warn("Layer ".concat(c.name," was passed ")+"non-serializable keyword arguments: "+"".concat(h.callArgs,". They will not be included ")+"in the serialized model (and thus will be missing at deserialization time)."),g={}}if(h.inboundLayers.length>0){for(var m=[],y=0;y<h.inboundLayers.length;y++){var x=h.inboundLayers[y],b=h.nodeIndices[y],k=h.tensorIndices[y],w=t[n.nodeKey(x,b)];null==w&&(w=0),m.push([x.name,w,k,g])}d.push(m)}}}var A={};A.name=c.name,A.className=l,A.config=f,A.inboundNodes=d,r.push(A)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}e.layers=r;for(var E=[],C=0;C<this.inputLayers.length;C++){var S=this.inputLayers[C],N=this.inputLayersNodeIndices[C],T=n.nodeKey(S,N);if(this.containerNodes.has(T)){var D=t[T];null==D&&(D=0);var F=this.inputLayersTensorIndices[C];E.push([S.name,D,F])}}e.inputLayers=E;for(var O=[],_=0;_<this.outputLayers.length;_++){var I=this.outputLayers[_],R=this.outputLayersNodeIndices[_],M=n.nodeKey(I,R);if(this.containerNodes.has(M)){var B=t[M];null==B&&(B=0);var P=this.outputLayersTensorIndices[_];O.push([I.name,B,P])}}return e.outputLayers=O,e}},{key:"stateful",get:function(){if(this._stateful)throw new Bi("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");var e=!0,t=!1,n=void 0;try{for(var r,a=this.layers[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){if(r.value.stateful)return!0}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}return!1}},{key:"resetStates",value:function(){var e=this;m.tidy((function(){e.layers.forEach((function(e){e.stateful&&e.resetStates()}))}))}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r={},a={};function i(e,t){e.name in a?a[e.name].push(t):a[e.name]=[t]}function o(e,t){var n,a=[],o=!0,u=!1,s=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value,d=f[0],p=f[1],h=f[2];if(n=null==f[3]?{}:f[3],!(d in r))return void i(e,t);var v=r[d];if(v.inboundNodes.length<=p)return void i(e,t);var g=v.inboundNodes[p];a.push(g.outputTensors[h])}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}a.length>0&&e.apply(Vi(a),n)}function u(e){var a=e.name,o=Bs(e,null!=t.customObjects?t.customObjects:{});o.setFastWeightInitDuringBuild(n),r[a]=o,e.inboundNodes.forEach((function(e){if(!(e instanceof Array))throw new Bi("Corrupted configuration, expected array for nodeData: ".concat(e));i(o,e)}))}var s=t.name,c=t.layers,l=!0,f=!1,d=void 0;try{for(var p,h=c[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;u(v)}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}for(var g=!0,m=!1,y=void 0;!Zi(a);)try{for(var x,b=c[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var k=x.value,w=r[k.name];if(w.name in a){var A=a[w.name];delete a[w.name];var E=!0,C=!1,S=void 0;try{for(var N,T=A[Symbol.iterator]();!(E=(N=T.next()).done);E=!0){var D=N.value;o(w,D)}}catch(e){C=!0,S=e}finally{try{E||null==T.return||T.return()}finally{if(C)throw S}}}}}catch(e){m=!0,y=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}var F=[],O=[],_=t.inputLayers,I=!0,R=!1,M=void 0;try{for(var B,P=_[Symbol.iterator]();!(I=(B=P.next()).done);I=!0){var L=B.value,j=L[0],z=L[1],U=L[2];zi(j in r);var V=r[j],W=V.inboundNodes[z].outputTensors;F.push(W[U])}}catch(e){R=!0,M=e}finally{try{I||null==P.return||P.return()}finally{if(R)throw M}}var G=t.outputLayers,H=!0,q=!1,J=void 0;try{for(var K,X=G[Symbol.iterator]();!(H=(K=X.next()).done);H=!0){var Y=K.value,Q=Y[0],Z=Y[1],$=Y[2];zi(Q in r);var ee=r[Q],te=ee.inboundNodes[Z].outputTensors;O.push(te[$])}}catch(e){q=!0,J=e}finally{try{H||null==X.return||X.return()}finally{if(q)throw J}}return new e({inputs:F,outputs:O,name:s})}}]),n}(gs);s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");g=s("kglvN"),y=s("4JvjV"),m=s("P1tXK"),Ti=s("b3Qcj"),Ci=s("j0e1k"),nt=s("bftEy"),it=s("6baO0");s("jbRpz");g=s("kglvN"),y=s("4JvjV"),m=s("P1tXK"),Ti=s("b3Qcj"),Ci=s("j0e1k"),nt=s("bftEy"),it=s("6baO0");s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");m=s("P1tXK"),ae=s("5J0XY"),Ci=s("j0e1k");function Bc(e,t,n){var r=t.length;if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return null}));if(1===r)return Array.isArray(e)&&1===e.length?e:"object"==typeof e&&t[0]in e?[e[t[0]]]:[e];if(Array.isArray(e)){if(e.length!==r)throw new Error("Provided ".concat(n," is an array of ").concat(e.length," ")+"element(s), but the model has ".concat(r," outputs. ")+"Make sure a set of weights is provided for each model output.");return e}if("object"==typeof e&&Object.keys(e).length>0&&"object"==typeof e[Object.keys(e)[0]]){var a=[];return t.forEach((function(t){t in e?a.push(e[t]):a.push(null)})),a}throw new Error("The model has multiple (".concat(r,") outputs, ")+"so ".concat(n," must be either an array with ")+"".concat(r," elements or an object with ").concat(t," keys. ")+"Provided ".concat(n," not understood: ").concat(JSON.stringify(e)))}function Pc(e,t){return Bc(e,t,"classWeight")}function Lc(e,t,n,r){return jc.apply(this,arguments)}function jc(){return(jc=f.default(t(v).mark((function e(n,r,a,i){var o,u,s;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r&&null==i){e.next=2;break}throw new Error("Support sampleWeight is not implemented yet");case 2:if(null==a){e.next=15;break}return o=m.tidy((function(){if(1===n.shape.length)return n.clone();if(2===n.shape.length){if(n.shape[1]>1){return n.argMax(1)}if(1===n.shape[1])return n.reshape([n.shape[0]]);throw new Error("Encountered unexpected last-dimension size (".concat(n.shape[1],") ")+"during handling of class weights. The size is expected to be >= 1.")}throw new Error("Unexpected rank of target (y) tensor (".concat(n.rank,") during ")+"handling of class weights. The rank is expected to be 1 or 2.")})),e.t0=Array,e.next=7,o.data();case 7:return e.t1=e.sent,u=e.t0.from.call(e.t0,e.t1),m.dispose(o),s=[],u.forEach((function(e){if(null==a[e])throw new Error("classWeight must contain all classes in the training data. "+"The class ".concat(e," exists in the data but not in ")+"classWeight");s.push(a[e])})),e.abrupt("return",ae.tensor1d(s,"float32"));case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function zc(e,t){return Ci.mul(e,t)}function Uc(e,t){var n,r,a=function(t){g.assert(u[t].shape[0]===c,(function(){return"Batch size mismatch: input "+"".concat(e.inputNames[t]," has ").concat(u[t].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(e.inputNames[0],".")}))},i=function(t){g.assert(s[t].shape[0]===c,(function(){return"Batch size mismatch: output "+"".concat(e.outputNames[t]," has ").concat(s[t].shape[0],"; ")+"expected  ".concat(c," based on input ").concat(e.inputNames[0],".")}))},o=t;n=o.xs,r=o.ys,g.assert(null!=n&&null!=r,(function(){return"A Dataset iterator for fitDataset() is expected to generate objects of the form `{xs: xVal, ys: yVal}`, where the two values may be `tf.Tensor`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates "+"".concat(t)}));var u=Vc("input",e.inputNames,n),s=Vc("output",e.outputNames,r),c=u[0].shape[0];g.assert(u.length===e.inputs.length,(function(){return"LayersModel has ".concat(e.inputs.length," inputs, but the dataset ")+"provides ".concat(u.length," inputs.  (Expected input keys: ")+"".concat(JSON.stringify(e.inputNames),")")})),g.assert(s.length===e.outputs.length,(function(){return"LayersModel has ".concat(e.outputs.length," outputs, but the dataset ")+"provides ".concat(s.length," outputs.  (Expected output keys: ")+"".concat(JSON.stringify(e.outputNames),")")}));for(var l=0;l<u.length;l++)a(l);for(var f=0;f<s.length;f++)i(f);return{xs:u,ys:s}}function Vc(e,t,n){if(n instanceof y.Tensor)return[n];if(Array.isArray(n))return g.assert(n.length===t.length,(function(){return"Received an array of ".concat(n.length," Tensors, but expected ").concat(t.length," to match the ").concat(e," keys ").concat(t,".")})),n;var r=[],a=!0,i=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;if(null==n[c])throw new Bi("The feature data generated by the dataset lacks the required "+"".concat(e," key '").concat(c,"'."));r.push(n[c])}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return r}function Wc(e){if(3===e.length)throw new Pi("Validation with sample weights is not implemented yet.");return{xs:e[0],ys:e[1]}}function Gc(e,t,n){return Hc.apply(this,arguments)}function Hc(){return Hc=f.default(t(v).mark((function e(n,r,a){var i,o,u,s,c,l,f,d,p,h,y,x,b,k,w,A,E,C,S,N,T,D,F,O,_,I,R,M,B,P,L,j,z;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!=a.batchesPerEpoch,g.assert(null!=n.optimizer,(function(){return"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."})),g.assert(null!=a,(function(){return"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."})),g.assert(null!=a.epochs&&a.epochs>0&&Number.isInteger(a.epochs),(function(){return"For fitDataset(), config.epochs is expected to be a positive "+"integer, but got ".concat(a.epochs)})),g.assert(!i||a.batchesPerEpoch>0&&Number.isInteger(a.batchesPerEpoch),(function(){return"For fitDataset(), config.batchesPerEpoch is expected to be a "+"positive integer if specified, but got ".concat(a.batchesPerEpoch)})),g.assert(null==a.validationSplit,(function(){return"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."})),!n.isTraining){e.next=8;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 8:return n.isTraining=!0,e.prev=9,(o=null!=a.validationData)&&(Jc(a.validationData)?g.assert(null==a.validationBatches||a.validationBatches>0&&Number.isInteger(a.validationBatches),(function(){return"For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, "+"but got ".concat(a.validationBatches)})):(c=Wc(a.validationData),u=c.xs,s=c.ys)),l=n.makeTrainFunction(),f=n.getDedupedMetricsNames(),d=o?f.slice().concat(f.map((function(e){return"val_"+e}))):f.slice(),p=Fs(a.callbacks,a.yieldEvery),h=null==a.verbose?1:a.verbose,y=_s(p,h,a.epochs,null,null,qc(r,a),null,o,d),x=y.callbackList,b=y.history,x.setModel(n),n.history=b,e.next=25,x.onTrainBegin();case 25:return n.stopTraining_=!1,k=null==a.initialEpoch?0:a.initialEpoch,e.next=29,r.iterator();case 29:w=e.sent;case 30:if(!(k<a.epochs)){e.next=101;break}return A={},e.next=34,x.onEpochBegin(k);case 34:if(E=0,C=0,i){e.next=40;break}return e.next=39,r.iterator();case 39:w=e.sent;case 40:if(i&&!(E<a.batchesPerEpoch)){e.next=94;break}return e.next=43,w.next();case 43:if(S=e.sent,!i||!S.done){e.next=47;break}return console.warn("You provided `batchesPerEpoch` as "+"".concat(a.batchesPerEpoch,", ")+"but your dataset iterator ran out of data after "+"".concat(E," batches; ")+"interrupting training. Make sure that your dataset can generate at least `batchesPerEpoch * epochs` batches (in this case, "+"".concat(a.batchesPerEpoch*a.epochs," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",94);case 47:if(null==S.value){e.next=76;break}return N=Uc(n,S.value),T=N.xs,D=N.ys,(F={}).batch=C,F.size=T[0].shape[0],e.next=54,x.onBatchBegin(C,F);case 54:if(O=[],null==a.classWeight){e.next=67;break}_=Pc(a.classWeight,n.outputNames),I=0;case 58:if(!(I<_.length)){e.next=67;break}return e.t0=O,e.next=62,Lc(D[I],null,_[I]);case 62:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 64:++I,e.next=58;break;case 67:for(R=T.concat(D).concat(O),M=l(R),m.dispose(R),B=0;B<f.length;++B)P=f[B],L=M[B],F[P]=L,m.keep(L);return e.next=73,x.onBatchEnd(C,F);case 73:Es(F),C++,E++;case 76:if(!(i?E>=a.batchesPerEpoch:S.done)){e.next=90;break}if(!o){e.next=89;break}if(!Jc(a.validationData)){e.next=87;break}return e.t2=Wi,e.next=83,n.evaluateDataset(a.validationData,{batches:a.validationBatches});case 83:e.t3=e.sent,j=(0,e.t2)(e.t3),e.next=88;break;case 87:j=Wi(n.evaluate(u,s,{batchSize:null==a.validationBatchSize?32:a.validationBatchSize,verbose:0}));case 88:for(z=0;z<n.metricsNames.length;++z)A["val_".concat(n.metricsNames[z])]=j[z];case 89:return e.abrupt("break",94);case 90:if(!n.stopTraining_){e.next=92;break}return e.abrupt("break",94);case 92:e.next=40;break;case 94:return e.next=96,x.onEpochEnd(k,A);case 96:if(k++,!n.stopTraining_){e.next=99;break}return e.abrupt("break",101);case 99:e.next=30;break;case 101:return e.next=103,x.onTrainEnd();case 103:return e.next=105,n.history.syncData();case 105:return e.abrupt("return",n.history);case 106:return e.prev=106,n.isTraining=!1,e.finish(106);case 109:case"end":return e.stop()}}),e,null,[[9,,106,109]])}))),Hc.apply(this,arguments)}function qc(e,t){var n=null;return null!=t.batchesPerEpoch?n=t.batchesPerEpoch:Number.isFinite(e.size)&&(n=e.size),n}function Jc(e){return"function"==typeof e.iterator}function Kc(e){return"function"==typeof e.next}function Xc(e,t,n){return Yc.apply(this,arguments)}function Yc(){return Yc=f.default(t(v).mark((function e(n,r,a){var i,o,u,s,c,l,f,d,p;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=null!=(a=a||{}).batches,o=n.testFunction,u=[],!(a.verbose>0)){e.next=6;break}throw new Pi("Verbose mode is not implemented yet.");case 6:if(g.assert(!i||a.batches>0&&Number.isInteger(a.batches),(function(){return"Test loop expects `batches` to be a positive integer, but "+"received ".concat(JSON.stringify(a.batches))})),!Kc(r)){e.next=11;break}e.t0=r,e.next=14;break;case 11:return e.next=13,r.iterator();case 13:e.t0=e.sent;case 14:s=e.t0,c=0,l=0;case 17:if(i&&!(l<a.batches)){e.next=27;break}return e.next=20,s.next();case 20:if(f=e.sent,u=m.tidy((function(){if(f.value){var e=function(e){var t=s[e],n=u[e];u[e]=m.tidy((function(){return Ti.add(u[e],Ci.mul(p,t))})),l>0&&m.dispose(n)},t=Uc(n,f.value),r=t.xs,a=t.ys,i=r.concat(a),s=m.tidy((function(){return o(i)}));if(m.dispose(i),0===l)for(var d=0;d<s.length;++d)u.push(nt.scalar(0));for(var p=i[0].shape[0],h=0;h<s.length;++h)e(h);m.dispose(s),c+=p,++l}return u})),!f.done){e.next=25;break}return i&&console.warn("Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least `batches` "+"batches (in this case, ".concat(a.batches," batches). ")+"You may need to use the repeat() function when building your dataset."),e.abrupt("break",27);case 25:e.next=17;break;case 27:for(d=0;d<u.length;++d)p=u[d],u[d]=it.div(u[d],c),m.dispose(p);return e.abrupt("return",Vi(u));case 29:case"end":return e.stop()}}),e)}))),Yc.apply(this,arguments)}s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");g=s("kglvN"),m=s("P1tXK"),ae=s("5J0XY"),y=s("4JvjV");s("jbRpz");g=s("kglvN"),m=s("P1tXK"),ae=s("5J0XY"),y=s("4JvjV");function Qc(e){g.assert(e>0&&Number.isInteger(e),(function(){return"batchSize is required to be a positive integer, but got ".concat(e)}))}function Zc(e,t,n){return null==e?[null]:Array.isArray(e)?e.map((function(e){return du(e,t,n-t)})):du(e,t,n-t)}function $c(e,t){return m.tidy((function(){return null==e?null:Array.isArray(e)?e.map((function(e){return $c(e,t)})):bu(e,"int32"===t.dtype?t:t.toInt())}))}function el(e,t){for(var n=[],r=0,a=null;r<e;)(a=r+t)>=e&&(a=e),n.push([r,a]),r=a;return n}function tl(e,t,n,r,a,i,o,u,s,c,l,f,d,p,h){return nl.apply(this,arguments)}function nl(){return(nl=f.default(t(v).mark((function e(n,r,a,i,o,u,s,c,l,f,d,p,h,y,x){var b,k,w,A,E,C,S,N,T,D,F,O;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==o&&(o=32),null==u&&(u=1),null==d&&(d=!0),null==h&&(h=0),b=!1,null!=l&&null!=f&&(b=!0),null==x){e.next=10;break}if(b=!0,null!=y){e.next=10;break}throw new Bi("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");case 10:return null!=(k=n.checkNumSamples(a,o,y,"steps_per_epoch"))&&(w=su(0,k)),null==s&&(s=1),A=_s(c,s,u,h,k,y,o,b,p),E=A.callbackList,C=A.history,E.setModel(n),n.history=C,e.next=19,E.onTrainBegin();case 19:n.stopTraining_=!1,S=h;case 21:if(!(S<u)){e.next=58;break}return e.next=24,E.onEpochBegin(S);case 24:if(N={},null==y){e.next=29;break}throw new Pi("stepsPerEpoch mode is not implemented yet.");case 29:if("batch"!==d){e.next=33;break}throw new Pi("batch shuffling is not implemneted yet");case 33:d&&g.shuffle(w);case 34:T=ae.tensor1d(w),D=el(k,o),F=0;case 37:if(!(F<D.length)){e.next=50;break}return O={},e.next=41,E.onBatchBegin(F,O);case 41:return m.tidy((function(){var e=D[F][0],t=D[F][1],u=du(T,e,t-e);O.batch=F,O.size=t-e;for(var s=$c(a,u),c=r(s),d=0;d<i.length;++d){var p=i[d],h=c[d];O[p]=h,m.keep(h)}if(F===D.length-1&&b)for(var v=n.testLoop(l,f,o),g=0;g<i.length;++g){var y=i[g],x=v[g];m.keep(x),N["val_"+y]=x}})),e.next=44,E.onBatchEnd(F,O);case 44:if(Es(O),!n.stopTraining_){e.next=47;break}return e.abrupt("break",50);case 47:++F,e.next=37;break;case 50:T.dispose();case 51:return e.next=53,E.onEpochEnd(S,N);case 53:if(!n.stopTraining_){e.next=55;break}return e.abrupt("break",58);case 55:++S,e.next=21;break;case 58:return e.next=60,E.onTrainEnd();case 60:return e.next=62,n.history.syncData();case 62:return e.abrupt("return",n.history);case 63:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rl(e,t,n){return al.apply(this,arguments)}function al(){return al=f.default(t(v).mark((function e(n,r,a){var i,o,u,s,c,l,f,d,p,h,g,y,x,b,k,w,A,E,C,S,N,T,D,F,O=arguments;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=O.length>3&&void 0!==O[3]?O[3]:{},!n.isTraining){e.next=3;break}throw new Error("Cannot start training because another fit() call is ongoing.");case 3:return n.isTraining=!0,e.prev=11,Qc(p=null==i.batchSize?32:i.batchSize),h=!1,e.next=17,n.standardizeUserData(r,a,i.sampleWeight,i.classWeight,h,p);case 17:if(g=e.sent,o=g[0],u=g[1],d=g[2],y=!1,!(null!=i.validationData&&i.validationData.length>0)){e.next=43;break}if(y=!0,2!==i.validationData.length){e.next=29;break}s=i.validationData[0],c=i.validationData[1],e.next=34;break;case 29:if(3!==i.validationData.length){e.next=33;break}throw new Pi("validationData including sample weights is not supported yet.");case 33:throw new Bi("When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; "+"".concat(i.validationData," is invalid."));case 34:return b=!0,e.next=37,n.standardizeUserData(s,c,null,null,b,p);case 37:k=e.sent,l=k[0],f=k[1],x=l.concat(f),e.next=44;break;case 43:null!=i.validationSplit&&i.validationSplit>0&&i.validationSplit<1?(y=!0,w=Math.floor(o[0].shape[0]*(1-i.validationSplit)),A=o[0].shape[0],l=Zc(o,w,A),o=Zc(o,0,w),f=Zc(u,w,A),u=Zc(u,0,w),x=l.concat(f)):null!=i.validationSteps&&(y=!0);case 44:return E=o.concat(u).concat(d),n.checkTrainableWeightsConsistency(),C=n.makeTrainFunction(),S=n.getDedupedMetricsNames(),y?(n.makeTestFunction(),N=n.testFunction,T=S.slice().concat(S.map((function(e){return"val_"+e})))):(N=null,x=[],T=S.slice()),D=Fs(i.callbacks,i.yieldEvery),e.next=54,tl(n,C,E,S,p,i.epochs,i.verbose,D,N,x,i.shuffle,T,i.initialEpoch,null,null);case 54:return F=e.sent,e.abrupt("return",F);case 56:return e.prev=56,n.isTraining=!1,ol(o,r),ol(u,a),ol(l,s),ol(f,c),null!=d&&m.dispose(d),e.finish(56);case 64:case"end":return e.stop()}}),e,null,[[11,,56,64]])}))),al.apply(this,arguments)}function il(e){var t=[];e instanceof y.Tensor&&(e=[e]);for(var n=0;n<e.length;++n){var r=e[n];if(1===r.rank)t.push(lu(r,1));else{if(0===r.rank)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");t.push(r)}}return t}function ol(e,t){if(null!=e){var n=[];if(t instanceof y.Tensor)n.push(t.id);else if(Array.isArray(t))t.forEach((function(e){return n.push(e.id)}));else if(null!=t)for(var r in t){var a=t[r];n.push(a.id)}var i=[];if(e instanceof y.Tensor)-1===n.indexOf(e.id)&&i.push(e);else if(Array.isArray(e))e.forEach((function(e){-1===n.indexOf(e.id)&&i.push(e)}));else if(null!=e)for(var o in e){var u=e[o];-1===n.indexOf(u.id)&&i.push(u)}i.forEach((function(e){e.isDisposed||e.dispose()}))}}function ul(e){return Array.isArray(e)}function sl(e){return!function(e){return e instanceof y.Tensor}(e)&&!ul(e)}function cl(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(null==t||0===t.length){if(null!=e){var o=!1;if(ul(e)&&e.length>0)o=!0;else if(sl(e)){for(var u in e)if(e.hasOwnProperty(u)){o=!0;break}}else o=!0;if(o)throw new Bi("Error when checking model ".concat(i," expected no data, ")+"but got ".concat(e))}return[]}if(null==e)return t.map((function(e){return null}));if(sl(e)){r=[];var s=!0,c=!1,l=void 0;try{for(var f,d=t[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;if(null==e[p])throw new Bi('No data provided for "'.concat(p,'". Need data for each key in: ')+"".concat(t));r.push(e[p])}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}}else if(ul(e)){if(e.length!==t.length)throw new Bi("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"model expected. Expected to see ".concat(t.length," Tensor(s), but ")+"instead got the following list of Tensor(s): ".concat(e));r=e}else{if(t.length>1)throw new Bi("The model ".concat(i," expects ").concat(t.length," Tensor(s), ")+"but only received one Tensor. Found: Tensor with shape ".concat(e.shape));r=[e]}if(r=il(r),null!=n)for(var h=0;h<t.length;++h)if(null!=n[h]){var v=r[h];if(v.shape.length!==n[h].length)throw new Bi("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have ".concat(n[h].length," dimension(s). but got array with ")+"shape ".concat(v.shape));for(var g=0;g<n[h].length;++g)if(0!==g||a){var m=v.shape[g],y=n[h][g];if(null!=y&&y>=0&&m!==y)throw new Bi("Error when checking ".concat(i,": expected ").concat(t[h]," ")+"to have shape [".concat(n[h],"], but got array with shape ")+"[".concat(v.shape,"]."))}}return r}function ll(e,t,n){var r=Qi(e.map((function(e){return e.shape[0]})));r.sort();var a=Qi(t.map((function(e){return e.shape[0]})));if(a.sort(),r.length>1)throw new Bi("All input Tensors (x) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(e.map((function(e){return e.shape})))));if(a.length>1)throw new Bi("All target Tensors (y) should have the same number of samples. Got array shapes: "+"".concat(JSON.stringify(t.map((function(e){return e.shape})))));if(r.length>0&&a.length>0&&!g.arraysEqual(r,a))throw new Bi("Input Tensors should have the same number of samples as target "+"Tensors. Found ".concat(r[0]," input sample(s) and ").concat(a[0]," target ")+"sample(s).")}function fl(e,t,n){for(var r=[Gs,Ys,Ks],a=0;a<e.length;++a){var i=e[a],o=t[a],u=n[a];if(null!=o){if(o===Ks&&1===i.shape[i.shape.length-1])throw new Bi("You are passing a target array of shape ".concat(i.shape," while using ")+"a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].");if(-1!==r.indexOf(o))for(var s=i.shape.slice(1),c=u.slice(1),l=0;l<s.length;++l){var f=s[l],d=c[l];if(null!=d&&f!==d)throw new Bi("A target Tensor with shape ".concat(i.shape," was passed for an ")+"output of shape ".concat(u,", while using a loss function that ")+"expects targets to have the same shape as the output.")}}}}function dl(e,t,n){var r,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(Array.isArray(e)){if(e.length!==t.length)throw new Bi("Error when checking model ".concat(i,": the Array of ")+"Tensors that you are passing to your model is not the size the "+"the model expected. Expected to see ".concat(t.length," Tensor(s),")+" but instead got ".concat(e.length," Tensors(s)."));r=e}else{if(t.length>1)throw new Bi("The model expects ".concat(t.length," ").concat(i," Tensors, ")+"but only received one Tensor. Found: array with shape "+"".concat(JSON.stringify(e.shape),"."));r=[e]}if(null!=n)for(var o=0;o<t.length;++o)if(null!=n[o]){var u=r[o];if(u.shape.length!==n[o].length)throw new Bi("Error when checking ".concat(i,": expected ").concat(t[o]," ")+"to have ".concat(n[o].length," dimension(s), but got array with ")+"shape ".concat(JSON.stringify(u.shape)));for(var s=0;s<n[o].length;++s)if(0!==s||a){var c=u.shape[s],l=n[o][s];if(null!=l&&l!==c)throw new Bi("Error when checking ".concat(i,": expected ")+"".concat(t[o]," to have shape ").concat(JSON.stringify(n[o])," but ")+"got array with shape ".concat(JSON.stringify(u.shape),"."))}}}var pl=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){var t;return c.default(this,r),(t=n.call(this,e)).isTraining=!1,t}return l.default(r,[{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;if(!this.built)throw new Bi("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");mc(this,e,t,n)}},{key:"compile",value:function(e){var t=this;if(null==e.loss&&(e.loss=[]),this.loss=e.loss,"string"==typeof e.optimizer)this.optimizer_=function(e){var t={Adagrad:function(){return pc.train.adagrad(.01)},Adadelta:function(){return pc.train.adadelta(1,.95,Oi())},Adam:function(){return pc.train.adam(.001,.9,.999,Oi())},Adamax:function(){return pc.train.adamax(.002,.9,.999,Oi(),0)},RMSProp:function(){return pc.train.rmsprop(.001,.9,0,Oi())},SGD:function(){return pc.train.sgd(.01)}};if(t.adagrad=t.Adagrad,t.adadelta=t.Adadelta,t.adam=t.Adam,t.adamax=t.Adamax,t.rmsprop=t.RMSProp,t.sgd=t.SGD,e in t)return t[e]();throw new Bi("Unknown Optimizer ".concat(e))}(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof Is.Optimizer))throw new Bi("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}var n=[];if(Array.isArray(e.loss)||"string"==typeof e.loss||"function"==typeof e.loss)if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new Bi("When passing an Array as loss, it should have one entry per "+"model output. The model has ".concat(this.outputs.length," output(s), ")+"but you passed loss=".concat(e.loss,"."));var r=e.loss;n=r.map((function(e){return ec(e)}))}else{var a=ec(e.loss);this.outputs.forEach((function(e){n.push(a)}))}else{for(var i in e.loss=e.loss,e.loss)if(-1===this.outputNames.indexOf(i))throw new Bi('Unknown entry in loss dictionary: "'.concat(i,'". ')+"Only expected the following keys: ".concat(this.outputNames));var o=!0,u=!1,s=void 0;try{for(var c,l=this.outputNames[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;null==e.loss[f]&&console.warn('Output "'.concat(f,'" is missing from loss dictionary. We assume ')+"this was done on purpose, and we will not be expecting data "+"to be passed to ".concat(f," during training")),n.push(ec(e.loss[f]))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(var d=0;d<this.outputs.length;++d){var p=this.internalOutputShapes[d],h=this.outputNames[d];this.feedOutputNames.push(h),this.feedOutputShapes.push(p),this.feedLossFns.push(this.lossFunctions[d])}var v=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],Yo("loss",(function(){for(var e=0;e<t.outputs.length;++e)if(-1===v.indexOf(e)){var n=t.lossFunctions[e];t.outputs.length>1&&(t.metricsTensors.push([n,e]),t.metricsNames.push(t.outputNames[e]+"_loss"))}}));var g=function(e,t){if(null==e||Array.isArray(e)&&0===e.length)return t.map((function(e){return[]}));var n;if("string"==typeof e||"function"==typeof e)n=[e];else{if(!Array.isArray(e)&&"object"!=typeof e)throw new TypeError("Type of metrics argument not understood. Expected an string,"+"function, Array, or Object, found: ".concat(e));n=e}if(Array.isArray(n))return t.map((function(e){return n}));var r=[],a=!0,i=!1,o=void 0;try{for(var u,s=t[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value,l=n.hasOwnProperty(c)?n[c]:[];Array.isArray(l)||(l=[l]),r.push(l)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return r}(e.metrics,this.outputNames);Yo("metric",(function(){for(var e=function(e){var n=t;if(-1!==v.indexOf(e))return"continue";!function(r){var a,i,o,u=!0,s=!1,c=void 0;try{for(var l,f=function(r,u){var s=u.value;if("string"==typeof s&&-1!==["accuracy","acc","crossentropy","ce"].indexOf(s)){var c=n.internalOutputShapes[e];1===c[c.length-1]||n.lossFunctions[e]===Ys?-1!==["accuracy","acc"].indexOf(s)?i=rc:-1!==["crossentropy","ce"].indexOf(s)&&(i=uc):n.lossFunctions[e]===Xs?-1!==["accuracy","acc"].indexOf(s)?i=sc:-1!==["crossentropy","ce"].indexOf(s)&&(i=lc):-1!==["accuracy","acc"].indexOf(s)?i=ac:-1!==["crossentropy","ce"].indexOf(s)&&(i=cc);var l=void 0;-1!==["accuracy","acc"].indexOf(s)?l="acc":-1!==["crossentropy","ce"].indexOf(s)&&(l="ce"),o=i,a=""+l}else{var f=function(e){if("string"==typeof e&&e in fc)return fc[e];if("string"!=typeof e&&null!=e)return e;throw new Bi("Unknown metric ".concat(e))}(s);o=f,a=""+dc(s)}var d=void 0;Yo(a,(function(){d=o})),function(e,n,r){t.outputNames.length>1&&(n=t.outputNames[e]+"_"+n),t.metricsNames.push(n),t.metricsTensors.push([r,e])}(e,a,d)},d=r[Symbol.iterator]();!(u=(l=d.next()).done);u=!0)f(0,l)}catch(e){s=!0,c=e}finally{try{u||null==d.return||d.return()}finally{if(s)throw c}}}(g[e])},n=0;n<t.outputs.length;++n)e(n)})),this.collectedTrainableWeights=this.trainableWeights}},{key:"checkTrainableWeightsConsistency",value:function(){null!=this.collectedTrainableWeights&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null==n.batchSize?32:n.batchSize;Qc(r);var a=!0,i=this.standardizeUserDataXY(e,t,a,r);try{var o=i[0].concat(i[1]);this.makeTestFunction();var u=this.testFunction,s=this.testLoop(u,o,r,n.verbose,n.steps);return Vi(s)}finally{ol(i[0],e),ol(i[1],t)}}},{key:"evaluateDataset",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.makeTestFunction(),t.abrupt("return",Xc(r,e,n));case 2:case"end":return t.stop()}}),a)})))()}},{key:"checkNumSamples",value:function(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"steps";if(null!=n){if(r=null,null!=t)throw new Bi("If ".concat(a," is set, batchSize must be null or undefined.")+"Got batchSize = ".concat(t))}else{if(null==e)throw new Bi("Either the input data should have a defined shape, or "+"".concat(a," shoud be specified."));r=Array.isArray(e)?e[0].shape[0]:e.shape[0]}return r}},{key:"execute",value:function(e,t){if(Array.isArray(t)&&0===t.length)throw new Bi("`outputs` is an empty Array, which is not allowed.");var n=Array.isArray(t),r=n?t:[t],a=this.retrieveSymbolicTensors(r),i=new Tc;e instanceof y.Tensor&&(e=[e]);var o=!0,u=!1,s=void 0;if(Array.isArray(e)){if(e.length!==this.inputs.length)throw new Bi("The number of inputs provided (".concat(e.length,") ")+"does not match the number of inputs of this model "+"(".concat(this.inputs.length,")."));for(var c=0;c<this.inputs.length;++c)i.add(this.inputs[c],e[c])}else try{for(var l,f=this.inputs[Symbol.iterator]();!(o=(l=f.next()).done);o=!0){var d=l.value,p=e[d.name];if(null==p)throw new Bi("No value is provided for the model's input ".concat(d.name));i.add(d,p)}}catch(e){u=!0,s=e}finally{try{o||null==f.return||f.return()}finally{if(u)throw s}}var h=Oc(a,i);return n?h:h[0]}},{key:"retrieveSymbolicTensors",value:function(e){var t=ji(null,e.length),n=e.length,r=!0,a=!1,i=void 0;try{for(var o,u=function(r,a){for(var i=a.value,o=Array.isArray(i.output)?i.output:[i.output],u=o.map((function(e){return e.name})),s=0;s<e.length;++s){var c=u.indexOf(e[s]);if(-1!==c&&(t[s]=o[c],n--),0===n)break}if(0===n)return"break"},s=this.layers[Symbol.iterator]();!(r=(o=s.next()).done);r=!0){if("break"===u(0,o))break}}catch(e){a=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw i}}if(n>0){var c=[];throw t.forEach((function(t,n){null==t&&c.push(e[n])})),new Bi("Cannot find SymbolicTensors for output name(s): "+"".concat(JSON.stringify(c)))}return t}},{key:"predictLoop",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return m.tidy((function(){var a=function(t){var n=r;m.tidy((function(){var r=o[t][0],a=o[t][1],i=Zc(e,r,a),u=[];if(Array.isArray(i))for(var s=0;s<i.length;++s)u.push({key:n.inputs[s],value:i[s]});else u.push({key:n.inputs[0],value:i});var c=new Tc(u);return Oc(n.outputs,c)})).forEach((function(e,t){return u[t].push(e)}))},i=r.checkNumSamples(e);if(n)throw new Pi("Verbose predictLoop() is not implemented yet.");for(var o=el(i,t),u=r.outputs.map((function(e){return[]})),s=0;s<o.length;++s)a(s);return Vi(u.map((function(e){return Eo.concat(e,0)})))}))}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=il(e);dl(n,this.inputNames,this.feedInputShapes,!1);try{var r=null==t.batchSize?32:t.batchSize;return Qc(r),this.predictLoop(n,r)}finally{ol(n,e)}}},{key:"predictOnBatch",value:function(e){dl(e,this.inputNames,this.feedInputShapes,!0);var t=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,t)}},{key:"standardizeUserDataXY",value:function(e,t){var n=arguments.length>3?arguments[3]:void 0;if(null==this.optimizer_)throw new Mi("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");for(var r=[],a=0;a<this.feedOutputShapes.length;++a){var i=this.feedOutputShapes[a],o=this.feedLossFns[a];o===Xs?r.push(i.slice(0,i.length-1).concat([1])):r.push(i)}if(ll(e=cl(e,this.feedInputNames,this.feedInputShapes,!1,"input"),t=cl(t,this.feedOutputNames,r,!1,"target")),fl(t,this.feedLossFns,this.feedOutputShapes),this.stateful&&null!=n&&n>0&&e[0].shape[0]%n!=0)throw new Bi("In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size "+"".concat(n,". Found: ").concat(e[0].shape[0]," sample(s)."));return[e,t]}},{key:"standardizeUserData",value:function(e,n,r,a){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5?arguments[5]:void 0,u=this;return f.default(t(v).mark((function s(){var c,l,f,p,h,g;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=d.default(u.standardizeUserDataXY(e,n,i,o),2),l=c[0],f=c[1],null==r){t.next=3;break}throw new Error("sample weight is not supported yet.");case 3:if(p=null,null==a){t.next=17;break}h=Pc(a,u.outputNames),p=[],g=0;case 8:if(!(g<h.length)){t.next=17;break}return t.t0=p,t.next=12,Lc(f[g],null,h[g]);case 12:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 14:++g,t.next=8;break;case 17:return t.abrupt("return",[l,f,p]);case 18:case"end":return t.stop()}}),s)})))()}},{key:"testLoop",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4?arguments[4]:void 0,i=this;return m.tidy((function(){var o=i.checkNumSamples(t,n,a,"steps"),u=[];if(r>0)throw new Pi("Verbose mode is not implemented yet.");if(null!=a)throw new Pi("steps mode in testLoop() is not implemented yet");for(var s=el(o,n),c=ae.tensor1d(su(0,o)),l=0;l<s.length;++l){var f=s[l][0],d=s[l][1],p=du(c,f,d-f),h=$c(t,p),v=e(h);if(0===l)for(var g=0;g<v.length;++g)u.push(nt.scalar(0));for(var m=0;m<v.length;++m){var y=v[m];u[m]=Ti.add(u[m],Ci.mul(d-f,y))}}for(var x=0;x<u.length;++x)u[x]=it.div(u[x],o);return u}))}},{key:"getDedupedMetricsNames",value:function(){for(var e=this.metricsNames,t=[],n=0;n<e.length;++n){var r=e[n],a=r;if(Ui(e,r)>1){var i=Ui(e.slice(0,n),r);a+="_".concat(i)}t.push(a)}return t}},{key:"makeTrainFunction",value:function(){var e=this;return function(t){var n=e,r=[],a=t.slice(0,e.inputs.length),i=t.slice(e.inputs.length,e.inputs.length+e.outputs.length),o=t.slice(e.inputs.length+e.outputs.length,e.inputs.length+2*e.outputs.length),u=[],s=e.collectedTrainableWeights.map((function(e){return e.read()}));return[e.optimizer_.minimize((function(){for(var e=[],t=0;t<n.inputs.length;++t)e.push({key:n.inputs[t],value:a[t]});for(var s,c=new Tc(e),l=Oc(n.outputs,c,{training:!0}),f=0;f<n.lossFunctions.length;++f){var d=(0,n.lossFunctions[f])(i[f],l[f]);null!=o[f]&&(d=zc(d,o[f]));var p=Rs.mean(d);r.push(p),s=0===f?d:Ti.add(s,d)}for(var h=0;h<n.metricsTensors.length;++h){var v=void 0;if(n.outputs.length>1&&h<n.outputs.length)v=r[h];else{var g=n.metricsTensors[h][0],y=n.metricsTensors[h][1];v=Rs.mean(g(i[y],l[y]))}m.keep(v),u.push(v)}return s=Rs.mean(s),n.calculateLosses().forEach((function(e){s=Ti.add(s,e)})),s}),!0,s)].concat(u)}}},{key:"makeTestFunction",value:function(){var e=this;this.testFunction=function(t){var n=e;return m.tidy((function(){for(var e,r=[],a=t.slice(0,n.inputs.length),i=t.slice(n.inputs.length,n.inputs.length+n.outputs.length),o=[],u=0;u<n.inputs.length;++u)o.push({key:n.inputs[u],value:a[u]});for(var s=new Tc(o),c=Oc(n.outputs,s),l=0;l<n.lossFunctions.length;++l){var f=n.lossFunctions[l],d=Rs.mean(f(i[l],c[l]));e=0===l?d:Ti.add(e,d),r.push(e)}for(var p=0;p<n.metricsTensors.length;++p){var h=n.metricsTensors[p][0],v=n.metricsTensors[p][1],g=Rs.mean(h(i[v],c[v]));r.push(g)}return r}))}}},{key:"fit",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this;return f.default(t(v).mark((function i(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",rl(a,e,n,r));case 1:case"end":return t.stop()}}),i)})))()}},{key:"fitDataset",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Gc(r,e,n));case 1:case"end":return t.stop()}}),a)})))()}},{key:"trainOnBatch",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i,o,u,s,c,l,f,d,p,h,g,y,x;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.standardizeUserData(e,n);case 2:i=t.sent,o=i[0],u=i[1],s=r.makeTrainFunction(),c=s(o.concat(u)),l=[],f=!0,d=!1,p=void 0,t.prev=9,h=c[Symbol.iterator]();case 11:if(f=(g=h.next()).done){t.next=20;break}return y=g.value,t.next=15,y.data();case 15:x=t.sent,l.push(x[0]);case 17:f=!0,t.next=11;break;case 20:t.next=26;break;case 22:t.prev=22,t.t0=t.catch(9),d=!0,p=t.t0;case 26:t.prev=26,t.prev=27,f||null==h.return||h.return();case 29:if(t.prev=29,!d){t.next=32;break}throw p;case 32:return t.finish(29);case 33:return t.finish(26);case 34:return m.dispose(c),t.abrupt("return",Vi(l));case 36:case"end":return t.stop()}}),a,null,[[9,22,26,34],[27,,29,33]])})))()}},{key:"getNamedWeights",value:function(e){for(var t=[],n=null!=e&&e.trainableOnly,r=n?this.trainableWeights:this.weights,a=this.getWeights(n),i=0;i<r.length;++i)n&&!r[i].trainable||t.push({name:r[i].originalName,tensor:a[i]});return t}},{key:"stopTraining",get:function(){return this.stopTraining_},set:function(e){this.stopTraining_=e}},{key:"optimizer",get:function(){return this.optimizer_},set:function(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}},{key:"dispose",value:function(){var e=F.default(O.default(r.prototype),"dispose",this).call(this);if(0===e.refCountAfterDispose&&null!=this.optimizer&&this.isOptimizerOwned){var t=m.memory().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=t-m.memory().numTensors}return e}},{key:"getLossIdentifiers",value:function(){var e;if("string"==typeof this.loss)e=Gi(this.loss);else if(Array.isArray(this.loss)){var t=!0,n=!1,r=void 0;try{for(var a,i=this.loss[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){if("string"!=typeof a.value)throw new Error("Serialization of non-string loss is not supported.")}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}e=this.loss.map((function(e){return Gi(e)}))}else{var o=Object.keys(this.loss);e={};var u=this.loss,s=!0,c=!1,l=void 0;try{for(var f,d=o[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;if("string"!=typeof u[p])throw new Error("Serialization of non-string loss is not supported.");e[p]=Gi(u[p])}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}}return e}},{key:"getMetricIdentifiers",value:function(){if("string"==typeof this.metrics||"function"==typeof this.metrics)return[Gi(dc(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map((function(e){return Gi(dc(e))}));var e={};for(var t in this.metrics)e[t]=Gi(dc(this.metrics[t]));return e}},{key:"getTrainingConfig",value:function(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}},{key:"loadTrainingConfig",value:function(e){if(null!=e.weighted_metrics)throw new Error("Loading weight_metrics is not supported yet.");if(null!=e.loss_weights)throw new Error("Loading loss_weights is not supported yet.");if(null!=e.sample_weight_mode)throw new Error("Loading sample_weight_mode is not supported yet.");var t,n,r=Bs(Ec(e.optimizer_config));if("string"==typeof e.loss)t=Hi(e.loss);else if(Array.isArray(e.loss))t=e.loss.map((function(e){return Hi(e)}));else if(null!=e.loss)for(var a in t={},e.loss)t[a]=Hi(e.loss[a]);if(Array.isArray(e.metrics))n=e.metrics.map((function(e){return Hi(e)}));else if(null!=e.metrics)for(var i in n={},e.metrics)n[i]=Hi(e.metrics[i]);this.compile({loss:t,metrics:n,optimizer:r})}},{key:"save",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){var i,o,u,s,c,l,f,d,p;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=9;break}if(0!==(i=Ms.getSaveHandlers(e)).length){t.next=6;break}throw new Bi("Cannot find any save handlers for URL '".concat(e,"'"));case 6:if(!(i.length>1)){t.next=8;break}throw new Bi("Found more than one (".concat(i.length,") save handlers for ")+"URL '".concat(e,"'"));case 8:e=i[0];case 9:if(null!=e.save){t.next=11;break}throw new Bi("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return t.next=13,Ms.encodeWeights(r.getNamedWeights(n));case 13:if(o=t.sent,!1,null,u=r.toJSON(null,false),s={modelTopology:u,format:"layers-model",generatedBy:"TensorFlow.js tfjs-layers v".concat(Sc),convertedBy:null},!(null!=n&&n.includeOptimizer)||null==r.optimizer){t.next=35;break}return s.trainingConfig=r.getTrainingConfig(),l="optimizer",t.t0=Ms,t.next=26,r.optimizer.getWeights();case 26:return t.t1=t.sent,t.t2=l,t.next=30,t.t0.encodeWeights.call(t.t0,t.t1,t.t2);case 30:f=t.sent,d=f.data,p=f.specs,(c=o.specs).push.apply(c,Pe.default(p)),o.data=Ms.concatenateArrayBuffers([o.data,d]);case 35:return null!=r.userDefinedMetadata&&(!0,vc(r.userDefinedMetadata,r.name,true),s.userDefinedMetadata=r.userDefinedMetadata),s.weightData=o.data,s.weightSpecs=o.specs,t.abrupt("return",e.save(s));case 39:case"end":return t.stop()}}),a)})))()}},{key:"setUserDefinedMetadata",value:function(e){vc(e,this.name),this.userDefinedMetadata=e}},{key:"getUserDefinedMetadata",value:function(){return this.userDefinedMetadata}}]),r}(Mc);pl.className="Model",Si.registerClass(pl);var hl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return n}(pl);hl.className="Functional",Si.registerClass(hl),s("1i51P");f=s("e3nFV"),p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O"),v=s("40Zzs");s("jbRpz");Ms=s("j8KB3"),m=s("P1tXK"),g=s("kglvN"),Si=s("6b8rQ");function vl(){return(vl=f.default(t(v).mark((function e(n,r){var a;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==r&&(r={}),"string"!=typeof n){e.next=10;break}if(0!==(a=Ms.getLoadHandlers(n,r)).length){e.next=7;break}a.push(Ms.browserHTTPRequest(n,r)),e.next=9;break;case 7:if(!(a.length>1)){e.next=9;break}throw new Bi("Found more than one (".concat(a.length,") load handlers for ")+"URL '".concat(n,"'"));case 9:n=a[0];case 10:return e.abrupt("return",gl(n,void 0,r));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function gl(e,t,n){return ml.apply(this,arguments)}function ml(){return(ml=f.default(t(v).mark((function e(n,r,a){var i,o,u,s,c,l,f,d,p;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==a&&(a={}),null!=n.load){e.next=3;break}throw new Bi("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return e.next=5,n.load();case 5:if(i=e.sent,null!=(o=i.modelTopology).model_config&&(o=o.model_config),u=null==a.strict||a.strict,s=null!=i.weightData&&null!=i.weightSpecs&&u,c=Bs(Ec(o),r,s),null!=(l=i.trainingConfig)&&c.loadTrainingConfig(l),null!=i.userDefinedMetadata&&c.setUserDefinedMetadata(i.userDefinedMetadata),null==i.weightData){e.next=24;break}if(null!=i.weightSpecs){e.next=17;break}throw new Bi("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");case 17:if(f=yl(i.weightData,i.weightSpecs),d=f.modelWeights,p=f.optimizerWeights,c.loadWeights(d,u),!(null!=c.optimizer&&p.length>0)){e.next=22;break}return e.next=22,c.optimizer.setWeights(p);case 22:m.dispose(d),m.dispose(p.map((function(e){return e.tensor})));case 24:return e.abrupt("return",c);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function yl(e,t){var n=Ms.decodeWeights(e,t),r={},a=[];return t.forEach((function(e){"optimizer"===e.group?a.push({name:e.name,tensor:n[e.name]}):r[e.name]=n[e.name]})),{modelWeights:r,optimizerWeights:a}}var xl=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){var t;c.default(this,r),e=e||{},(t=n.call(this,{inputs:[],outputs:[]})).trainable=!0,t.built=!1,t.name=null!=e.name?e.name:$u("sequential_");var a=!0,i=!1,o=void 0;if(null!=e.layers)try{for(var u,s=e.layers[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value;t.add(l)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return t}return l.default(r,[{key:"checkShape",value:function(e){if(e.inboundNodes[0].outputTensors[0].shape.some((function(e){return e<0})))throw new Bi("Negative dimension size caused by adding layer "+"".concat(e.name," with input shape [")+"".concat(e.inboundNodes[0].inputTensors[0].shape,"]"))}},{key:"add",value:function(e){var t,n=e instanceof r||e instanceof pl;if(n){if(1!==(t=e).outputs.length)throw new Bi("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(1!==t.inputs.length)throw new Bi("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(0===this.outputs.length){if(0===e.inboundNodes.length){if(null==e.batchInputShape)throw new Bi("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");var a=xs({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(a)}if(n)this.outputs=t.outputs,this.inputs=t.inputs;else{if(1!==e.inboundNodes.length)throw new Bi("A layer added to a Sequential model must not already be "+"connected somewhere else. LayersModel received layer ".concat(e.name," ")+"which has ".concat(e.inboundNodes.length," pre-existing inbound ")+"connections.");if(1!==e.inboundNodes[0].outputTensors.length)throw new Bi("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=ms(this.outputs[0])}this.inboundNodes=[],new hs({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:ji(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map((function(e){return e.shape})),outputShapes:this.outputs[0].shape})}else{var i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}},{key:"pop",value:function(){if(0===this.layers.length)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),0===this.layers.length)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{var e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}},{key:"call",value:function(e,t){return null==this.model&&this.build(),this.model.call(e,t)}},{key:"build",value:function(e){if(rs(e),0===this.inputs.length||0===this.outputs.length)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new pl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}},{key:"countParams",value:function(){return this.built||this.build(),F.default(O.default(r.prototype),"countParams",this).call(this)}},{key:"summary",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:console.log;this.built||this.build(),F.default(O.default(r.prototype),"summary",this).call(this,e,t,n)}},{key:"setWeights",value:function(e){null==this.model&&this.build(),this.model.setWeights(e)}},{key:"evaluate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.built)throw new Mi("The model needs to be compiled before being used.");return this.model.evaluate(e,t,n)}},{key:"evaluateDataset",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.built){t.next=2;break}throw new Mi("The model needs to be compiled before being used.");case 2:return t.abrupt("return",r.model.evaluateDataset(e,n));case 3:case"end":return t.stop()}}),a)})))()}},{key:"predict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return null==this.model&&this.build(),this.model.predict(e,t)}},{key:"predictOnBatch",value:function(e){return null==this.model&&this.build(),this.model.predictOnBatch(e)}},{key:"compile",value:function(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}},{key:"optimizer",get:function(){return null==this.model?void 0:this.model.optimizer},set:function(e){this.model.optimizer=e}},{key:"fit",value:function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=this;return f.default(t(v).mark((function i(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a.built){t.next=2;break}throw new Mi("The model needs to be compiled before being used.");case 2:return t.abrupt("return",a.model.fit(e,n,r));case 3:case"end":return t.stop()}}),i)})))()}},{key:"fitDataset",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r.built){t.next=2;break}throw new Mi("The model needs to be compiled before being used.");case 2:return t.abrupt("return",r.model.fitDataset(e,n));case 3:case"end":return t.stop()}}),a)})))()}},{key:"trainOnBatch",value:function(e,n){var r=this;return f.default(t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.model.trainOnBatch(e,n));case 1:case"end":return t.stop()}}),a)})))()}},{key:"stopTraining",get:function(){if(null==this.model)throw new Bi("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining},set:function(e){if(null==this.model)throw new Bi("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}},{key:"getConfig",value:function(){var e=[],t=!0,n=!1,r=void 0;try{for(var a,i=this.layers[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var o=a.value,u={};u.className=o.getClassName(),u.config=o.getConfig(),e.push(u)}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return{name:this.name,layers:e}}}],[{key:"fromConfig",value:function(e,t){var n,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={};if(t instanceof Array){if(null==t[0].className||"Merge"===t[0].className)throw new Bi("Legacy serialization format not supported yet.");n=t}else g.assert(null!=t.layers,(function(){return"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."})),n=t.layers,delete t.layers,i=t;var o=new e(i);if(!(o instanceof r))throw new Pi("Sequential.fromConfig called on non-Sequential input: ".concat(o));var u=!0,s=!1,c=void 0;try{for(var l,f=n[Symbol.iterator]();!(u=(l=f.next()).done);u=!0){var d=l.value,p=void 0,h=Bs(d,p,a);a&&h.setFastWeightInitDuringBuild(!0),o.add(h)}}catch(e){s=!0,c=e}finally{try{u||null==f.return||f.return()}finally{if(s)throw c}}return o}}]),r}(pl);function bl(e,t){return null==t&&(t={}),function(e,t){return vl.apply(this,arguments)}(e,t)}function kl(e){return xs(e)}xl.className="Sequential",Si.registerClass(xl),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");Di=s("2MKa7"),Ni=s("djUTy"),Si=s("6b8rQ");var wl=s("1LZgP"),Al=s("9JCtR");Lo=s("gGOj0");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");s("jbRpz");Si=s("6b8rQ");var El=s("lKM5m"),Cl=(Di=s("2MKa7"),m=s("P1tXK"),s("eu81x")),Sl=s("5uQwR"),Nl=(zs=s("eQuwX"),s("lzRoG")),Tl=(lt=s("etmQx"),s("bYmSd"));s("jbRpz");Si=s("6b8rQ"),El=s("lKM5m"),Di=s("2MKa7"),m=s("P1tXK"),Cl=s("eu81x"),Sl=s("5uQwR"),zs=s("eQuwX"),Nl=s("lzRoG"),lt=s("etmQx"),Tl=s("bYmSd");var Dl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"getConfig",value:function(){return{}}}]),n}(Si.Serializable),Fl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Eu(e,t)}}]),n}(Dl);Fl.className="elu",Si.registerClass(Fl);var Ol=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return El.selu(e)}}]),n}(Dl);Ol.className="selu",Si.registerClass(Ol);var _l=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return Di.relu(e)}}]),n}(Dl);_l.className="relu",Si.registerClass(_l);var Il=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return m.tidy((function(){return Cl.minimum(6,Di.relu(e))}))}}]),n}(Dl);Il.className="relu6",Si.registerClass(Il);var Rl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return e}}]),n}(Dl);Rl.className="linear",Si.registerClass(Rl);var Ml=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return Sl.sigmoid(e)}}]),n}(Dl);Ml.className="sigmoid",Si.registerClass(Ml);var Bl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return function(e){return m.tidy((function(){var t=Ti.add(.5,Ci.mul(.2,e));return Ni.clipByValue(t,0,1)}))}(e)}}]),n}(Dl);Bl.className="hardSigmoid",Si.registerClass(Bl);var Pl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return zs.softplus(e)}}]),n}(Dl);Pl.className="softplus",Si.registerClass(Pl);var Ll=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return function(e){return m.tidy((function(){return it.div(e,jo.abs(e).add(1))}))}(e)}}]),n}(Dl);Ll.className="softsign",Si.registerClass(Ll);var jl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){return Nl.tanh(e)}}]),n}(Dl);jl.className="tanh",Si.registerClass(jl);var zl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return lt.softmax(e,t)}}]),n}(Dl);zl.className="softmax",Si.registerClass(zl);var Ul=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return Tl.logSoftmax(e,t)}}]),n}(Dl);function Vl(e){return e.getClassName()}function Wl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Xi(e,Si.SerializationMap.getMap().classNameMap,t,"activation")}function Gl(e){if(null==e){var t={className:"linear",config:{}};return Wl(t)}if("string"==typeof e){var n={};return n.className=e,n.config={},Wl(n)}return e instanceof Dl?e:Wl(e)}Ul.className="logSoftmax",Si.registerClass(Ul),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");s("jbRpz");Si=s("6b8rQ"),m=s("P1tXK"),ot=s("ilMKa"),Ti=s("b3Qcj"),Ei=s("2xCpB"),Ci=s("j0e1k"),jo=s("3gUC5");s("jbRpz");Si=s("6b8rQ"),m=s("P1tXK"),ot=s("ilMKa"),Ti=s("b3Qcj"),Ei=s("2xCpB"),Ci=s("j0e1k"),jo=s("3gUC5");function Hl(e){if(null!=e&&"object"!=typeof e)throw new Error("Argument to L1L2 regularizer's constructor is expected to be an "+"object, but received: ".concat(e))}var ql=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return n}(Si.Serializable),Jl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this),Hl(e),r.l1=null==e||null==e.l1?.01:e.l1,r.l2=null==e||null==e.l2?.01:e.l2,r.hasL1=0!==r.l1,r.hasL2=0!==r.l2,r}return l.default(n,[{key:"apply",value:function(e){var t=this;return m.tidy((function(){var n=ot.zeros([1]);return t.hasL1&&(n=Ti.add(n,Ei.sum(Ci.mul(t.l1,jo.abs(e))))),t.hasL2&&(n=Ti.add(n,Ei.sum(Ci.mul(t.l2,ku(e))))),n.asScalar()}))}},{key:"getConfig",value:function(){return{l1:this.l1,l2:this.l2}}}],[{key:"fromConfig",value:function(e,t){return new e({l1:t.l1,l2:t.l2})}}]),n}(ql);Jl.className="L1L2",Si.registerClass(Jl);var Kl={l1l2:"L1L2"};function Xl(e){return Ji(e)}function Yl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Xi(e,Si.SerializationMap.getMap().classNameMap,t,"regularizer")}function Ql(e){return null==e?null:"string"==typeof e?Yl({className:e in Kl?Kl[e]:e,config:{}}):e instanceof ql?e:Yl(e)}var Zl=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,null!=e&&(r.maxValue=e.maxValue),r}return l.default(n,[{key:"call",value:function(e,t){e=ns(e);var n=Di.relu(e);return null!=this.maxValue&&(n=Ni.clipByValue(n,0,this.maxValue)),n}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={maxValue:this.maxValue},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);Zl.className="ReLU",Si.registerClass(Zl);var $l=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=.3,null==e&&(e={}),r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return l.default(n,[{key:"call",value:function(e,t){var n=ns(e);return wl.leakyRelu(n,this.alpha)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);$l.className="LeakyReLU",Si.registerClass($l);var ef=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA_INITIALIZER="zeros",null==e&&(e={}),r.supportsMasking=!0,r.alphaInitializer=Ku(e.alphaInitializer||r.DEFAULT_ALPHA_INITIALIZER),r.alphaRegularizer=Ql(e.alphaRegularizer),r.alphaConstraint=ho(e.alphaConstraint),null==e.sharedAxes)r.sharedAxes=null;else if(Array.isArray(e.sharedAxes))r.sharedAxes=e.sharedAxes;else{if("number"!=typeof e.sharedAxes)throw new Bi("Expected sharedAxes to be a number or an array of numbers, "+"but got ".concat(e.sharedAxes));r.sharedAxes=[e.sharedAxes]}return r}return l.default(n,[{key:"build",value:function(e){var t=(e=rs(e)).slice(1),n=!0,r=!1,a=void 0;if(null!=this.sharedAxes)try{for(var i,o=this.sharedAxes[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){t[i.value-1]=1}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}this.alpha=this.addWeight("alpha",t,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);var u={};if(null!=this.sharedAxes)for(var s=1;s<e.length;++s)u[s]=e[s];this.inputSpec=[new fs({ndim:e.length,axes:u})],this.built=!0}},{key:"call",value:function(e,t){return e=ns(e),Al.prelu(e,this.alpha.read())}},{key:"getConfig",value:function(){var e={alphaInitializer:Ju(this.alphaInitializer),alphaRegularizer:Xl(this.alphaRegularizer),alphaConstraint:fo(this.alphaConstraint),sharedAxes:this.sharedAxes},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);ef.className="PReLU",Si.registerClass(ef);var tf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_ALPHA=1,null==e&&(e={}),null!=e.alpha&&e.alpha!==r.DEFAULT_ALPHA)throw new Pi("Non-default alpha value (".concat(e.alpha,") is not supported by the ")+"ELU layer yet.");return r.alpha=null==e.alpha?r.DEFAULT_ALPHA:e.alpha,r}return l.default(n,[{key:"call",value:function(e,t){var n=ns(e);return Lo.elu(n)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={alpha:this.alpha},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);tf.className="ELU",Si.registerClass(tf);var nf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_THETA=1,null==e&&(e={}),r.theta=null==e.theta?r.DEFAULT_THETA:e.theta,r}return l.default(n,[{key:"call",value:function(e,t){var n=ns(e);return n.mul(cu(n.greater(this.theta),"float32"))}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={theta:this.theta},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);nf.className="ThresholdedReLU",Si.registerClass(nf);var rf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,null==e?{}:e)).DEFAULT_AXIS=1,null==e&&(e={}),r.softmax=(new zl).apply,r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r}return l.default(n,[{key:"call",value:function(e,t){var n=ns(e);return this.softmax(n,this.axis)}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e={axis:this.axis},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);rf.className="Softmax",Si.registerClass(rf),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");var af=s("4Ui3v");s("jbRpz");m=s("P1tXK"),st=s("9PS5J");var of=s("ceZj5"),uf=(Oo=s("lGvfM"),s("bxgT2")),sf=(Si=s("6b8rQ"),s("1DPo2")),cf=s("jHQP9");s("jbRpz");m=s("P1tXK"),st=s("9PS5J"),of=s("ceZj5"),Oo=s("lGvfM"),uf=s("bxgT2"),Si=s("6b8rQ"),sf=s("1DPo2"),cf=s("jHQP9");function lf(e,t,n){if("number"==typeof e)return ji(e,t);if(e.length!==t)throw new Bi("The ".concat(n," argument must be an integer or tuple of ").concat(t," integers.")+" Received: ".concat(e.length," elements."));for(var r=0;r<t;++r){var a=e[r];if(!ru(a))throw new Bi("The ".concat(n," argument must be an integer or tuple of ").concat(t)+" integers. Received: ".concat(JSON.stringify(e)," including a")+" non-integer number ".concat(a))}return e}function ff(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;if(null==e)return e;var i,o=t+(t-1)*(a-1);return i="same"===n?e:e-o+1,Math.floor((i+r-1)/r)}function df(e,t,n,r){if(null==e)return null;if("valid"===r)e=e*t+uu([n-t,0]);else{if("same"!==r)throw new Bi("Unsupport padding mode: ".concat(r,"."));e*=t}return e}function pf(e,t){return m.tidy((function(){return qo(t),"channelsFirst"===t?st.transpose(e,[0,2,3,1]):e}))}function hf(e,t){return m.tidy((function(){return qo(t),"channelsFirst"===t?st.transpose(e,[0,2,3,4,1]):e}))}function vf(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1;return m.tidy((function(){if(null==i&&(i="channelsLast"),qo(i),3!==e.shape.length)throw new Bi("The input of a conv1dWithBias operation should be 3, but is "+"".concat(e.shape.length," instead."));if(3!==t.shape.length)throw new Bi("The kernel for a conv1dWithBias operation should be 3, but is "+"".concat(t.shape.length," instead"));if(null!=n&&1!==n.shape.length)throw new Bi("The bias for a conv1dWithBias operation should be 1, but is "+"".concat(t.shape.length," instead"));if("channelsFirst"===i&&(e=st.transpose(e,[0,2,1])),"causal"===a)throw new Pi("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");var u=of.conv1d(e,t,r,"same"===a?"same":"valid","NWC",o);return null!=n&&(u=Au(u,n)),u}))}function gf(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;return m.tidy((function(){if(null==i&&(i="channelsLast"),qo(i),3!==e.rank&&4!==e.rank)throw new Bi("conv2dWithBiasActivation expects input to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));if(3!==t.rank&&4!==t.rank)throw new Bi("conv2dWithBiasActivation expects kernel to be of rank 3 or 4, "+"but received ".concat(e.rank,"."));var s=pf(e,i);if("causal"===a)throw new Pi("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return s=Oo.conv2d({x:s,filter:t,strides:r,pad:"same"===a?"same":"valid",dilations:o,dataFormat:"NHWC",bias:n,activation:u}),"channelsFirst"===i&&(s=st.transpose(s,[0,3,1,2])),s}))}function mf(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1,1,1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"valid",i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6?arguments[6]:void 0;return m.tidy((function(){if(null==i&&(i="channelsLast"),qo(i),4!==e.rank&&5!==e.rank)throw new Bi("conv3dWithBias expects input to be of rank 4 or 5, but received "+"".concat(e.rank,"."));if(4!==t.rank&&5!==t.rank)throw new Bi("conv3dWithBias expects kernel to be of rank 4 or 5, but received "+"".concat(e.rank,"."));var u=hf(e,i);if("causal"===a)throw new Pi("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return u=uf.conv3d(u,t,r,"same"===a?"same":"valid","NDHWC",o),null!=n&&(u=Au(u,n)),"channelsFirst"===i&&(u=st.transpose(u,[0,4,1,2,3])),u}))}var yf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e,r){var a;if(c.default(this,n),(a=t.call(this,r)).bias=null,a.DEFAULT_KERNEL_INITIALIZER="glorotNormal",a.DEFAULT_BIAS_INITIALIZER="zeros",n.verifyArgs(r),a.rank=e,to(a.rank,"rank"),1!==a.rank&&2!==a.rank&&3!==a.rank)throw new Pi("Convolution layer for rank other than 1, 2, or 3 (".concat(a.rank,") is ")+"not implemented yet.");if(a.kernelSize=lf(r.kernelSize,e,"kernelSize"),a.strides=lf(null==r.strides?1:r.strides,e,"strides"),a.padding=null==r.padding?"valid":r.padding,Jo(a.padding),a.dataFormat=null==r.dataFormat?"channelsLast":r.dataFormat,qo(a.dataFormat),a.activation=Gl(r.activation),a.useBias=null==r.useBias||r.useBias,a.biasInitializer=Ku(r.biasInitializer||a.DEFAULT_BIAS_INITIALIZER),a.biasConstraint=ho(r.biasConstraint),a.biasRegularizer=Ql(r.biasRegularizer),a.activityRegularizer=Ql(r.activityRegularizer),a.dilationRate=lf(null==r.dilationRate?1:r.dilationRate,e,"dilationRate"),1===a.rank&&Array.isArray(a.dilationRate)&&1!==a.dilationRate.length)throw new Bi("dilationRate must be a number or an array of a single number for 1D convolution, but received "+"".concat(JSON.stringify(a.dilationRate)));if(2===a.rank){if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate];else if(2!==a.dilationRate.length)throw new Bi("dilationRate must be a number or array of two numbers for 2D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)))}else if(3===a.rank)if("number"==typeof a.dilationRate)a.dilationRate=[a.dilationRate,a.dilationRate,a.dilationRate];else if(3!==a.dilationRate.length)throw new Bi("dilationRate must be a number or array of three numbers for 3D "+"convolution, but received ".concat(JSON.stringify(a.dilationRate)));return a}return l.default(n,[{key:"getConfig",value:function(){var e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:Vl(this.activation),useBias:this.useBias,biasInitializer:Ju(this.biasInitializer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),biasConstraint:fo(this.biasConstraint)},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(zi("kernelSize"in e,"required key 'kernelSize' not in config"),"number"!=typeof e.kernelSize&&!eo(e.kernelSize,"number",1,3))throw new Bi("BaseConv expects config.kernelSize to be number or number[] with "+"length 1, 2, or 3, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(gs),xf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e,r){var a;return c.default(this,n),(a=t.call(this,e,r)).kernel=null,n.verifyArgs(r),a.filters=r.filters,to(a.filters,"filters"),a.kernelInitializer=Ku(r.kernelInitializer||a.DEFAULT_KERNEL_INITIALIZER),a.kernelConstraint=ho(r.kernelConstraint),a.kernelRegularizer=Ql(r.kernelRegularizer),a}return l.default(n,[{key:"build",value:function(e){e=rs(e);var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Bi("The channel dimension of the input should be defined. "+"Found ".concat(e[t]));var n=e[t],r=this.kernelSize.concat([n,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:af.default({},t,n)}],this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t;e=ns(e);var r=null==n.bias?null:n.bias.read(),a=ro(n.activation.getClassName());if(null!=a&&2===n.rank)t=gf(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate,a);else{if(1===n.rank)t=vf(e,n.kernel.read(),r,n.strides[0],n.padding,n.dataFormat,n.dilationRate[0]);else if(2===n.rank)t=gf(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate);else{if(3!==n.rank)throw new Pi("convolutions greater than 3D are not implemented yet.");t=mf(e,n.kernel.read(),r,n.strides,n.padding,n.dataFormat,n.dilationRate)}null!=n.activation&&(t=n.activation.apply(t))}return t}))}},{key:"computeOutputShape",value:function(e){e=rs(e);for(var t=[],n="channelsLast"===this.dataFormat?e.slice(1,e.length-1):e.slice(2),r=0;r<n.length;++r){var a=ff(n[r],this.kernelSize[r],this.padding,this.strides[r],"number"==typeof this.dilationRate?this.dilationRate:this.dilationRate[r]);t.push(a)}var i=[e[0]];return"channelsLast"===this.dataFormat?(i=i.concat(t)).push(this.filters):(i.push(this.filters),i=i.concat(t)),i}},{key:"getConfig",value:function(){var e={filters:this.filters,kernelInitializer:Ju(this.kernelInitializer),kernelRegularizer:Xl(this.kernelRegularizer),kernelConstraint:fo(this.kernelConstraint)},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"verifyArgs",value:function(e){if(!("filters"in e)||"number"!=typeof e.filters||e.filters<1)throw new Bi("Convolution layer expected config.filters to be a 'number' > 0 "+"but got ".concat(JSON.stringify(e.filters)))}}]),n}(yf),bf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){c.default(this,n);var r=t.call(this,2,e);return n.verifyArgs(e),r}return l.default(n,[{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&!eo(e.kernelSize,"number",1,2))throw new Bi("Conv2D expects config.kernelSize to be number or number[] with "+"length 1 or 2, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(xf);bf.className="Conv2D",Si.registerClass(bf);var kf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){c.default(this,n);var r=t.call(this,3,e);return n.verifyArgs(e),r}return l.default(n,[{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete e.rank,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&(!Array.isArray(e.kernelSize)||1!==e.kernelSize.length&&3!==e.kernelSize.length))throw new Bi("Conv3D expects config.kernelSize to be number or"+" [number, number, number], but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(xf);kf.className="Conv3D",Si.registerClass(kf);var wf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,e)).inputSpec=[new fs({ndim:4})],"same"!==r.padding&&"valid"!==r.padding)throw new Bi("Conv2DTranspose currently supports only padding modes 'same' "+"and 'valid', but received padding mode ".concat(r.padding));return r}return l.default(n,[{key:"build",value:function(e){if(4!==(e=rs(e)).length)throw new Bi("Input should have rank 4; Received input shape: "+JSON.stringify(e));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t])throw new Bi("The channel dimension of the inputs should be defined. Found `None`.");var n=e[t],r=this.kernelSize.concat([this.filters,n]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new fs({ndim:4,axes:af.default({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t=ns(e);if(4!==t.shape.length)throw new Bi("Conv2DTranspose.call() expects input tensor to be rank-4, but "+"received a tensor of rank-".concat(t.shape.length));var r,a,i=t.shape,o=i[0];"channelsFirst"===n.dataFormat?(r=2,a=3):(r=1,a=2);var u=i[r],s=i[a],c=n.kernelSize[0],l=n.kernelSize[1],f=n.strides[0],d=n.strides[1],p=[o,df(u,f,c,n.padding),df(s,d,l,n.padding),n.filters];"channelsLast"!==n.dataFormat&&(t=st.transpose(t,[0,2,3,1]));var h=sf.conv2dTranspose(t,n.kernel.read(),p,n.strides,n.padding);return"channelsLast"!==n.dataFormat&&(h=st.transpose(h,[0,3,1,2])),null!=n.bias&&(h=Au(h,n.bias.read(),n.dataFormat)),null!=n.activation&&(h=n.activation.apply(h)),h}))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=(e=rs(e)).slice();"channelsFirst"===this.dataFormat?(t=1,n=2,r=3):(t=3,n=1,r=2);var i=this.kernelSize[0],o=this.kernelSize[1],u=this.strides[0],s=this.strides[1];return a[t]=this.filters,a[n]=df(a[n],u,i,this.padding),a[r]=df(a[r],s,o,this.padding),a}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete e.dilationRate,e}}]),n}(bf);wf.className="Conv2DTranspose",Si.registerClass(wf);var Af=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e,r){var a;if(c.default(this,n),(a=t.call(this,e,r)).DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",a.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",a.depthwiseKernel=null,a.pointwiseKernel=null,null==r.filters)throw new Bi("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(null!=r.kernelInitializer||null!=r.kernelRegularizer||null!=r.kernelConstraint)throw new Bi("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(null!=r.padding&&"same"!==r.padding&&"valid"!==r.padding)throw new Bi("SeparableConv".concat(a.rank,"D supports only padding modes: ")+"'same' and 'valid', but received ".concat(JSON.stringify(r.padding)));return a.depthMultiplier=null==r.depthMultiplier?1:r.depthMultiplier,a.depthwiseInitializer=Ku(r.depthwiseInitializer||a.DEFAULT_DEPTHWISE_INITIALIZER),a.depthwiseRegularizer=Ql(r.depthwiseRegularizer),a.depthwiseConstraint=ho(r.depthwiseConstraint),a.pointwiseInitializer=Ku(r.depthwiseInitializer||a.DEFAULT_POINTWISE_INITIALIZER),a.pointwiseRegularizer=Ql(r.pointwiseRegularizer),a.pointwiseConstraint=ho(r.pointwiseConstraint),a}return l.default(n,[{key:"build",value:function(e){if((e=rs(e)).length<this.rank+2)throw new Bi("Inputs to SeparableConv".concat(this.rank,"D should have rank ")+"".concat(this.rank+2,", but received input shape: ")+"".concat(JSON.stringify(e)));var t="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[t]||e[t]<0)throw new Bi("The channel dimension of the inputs should be defined, "+"but found ".concat(JSON.stringify(e[t])));for(var n=e[t],r=this.kernelSize.concat([n,this.depthMultiplier]),a=[],i=0;i<this.rank;++i)a.push(1);a.push(n*this.depthMultiplier,this.filters);var o=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,o,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,o,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,o,this.biasConstraint):this.bias=null,this.inputSpec=[new fs({ndim:this.rank+2,axes:af.default({},t,n)})],this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t;if(e=ns(e),1===n.rank)throw new Pi("1D separable convolution is not implemented yet.");return 2===n.rank&&("channelsFirst"===n.dataFormat&&(e=st.transpose(e,[0,2,3,1])),t=cf.separableConv2d(e,n.depthwiseKernel.read(),n.pointwiseKernel.read(),n.strides,n.padding,n.dilationRate,"NHWC")),n.useBias&&(t=Au(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),"channelsFirst"===n.dataFormat&&(t=st.transpose(t,[0,3,1,2])),t}))}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Ju(this.depthwiseInitializer),e.pointwiseInitializer=Ju(this.pointwiseInitializer),e.depthwiseRegularizer=Xl(this.depthwiseRegularizer),e.pointwiseRegularizer=Xl(this.pointwiseRegularizer),e.depthwiseConstraint=fo(this.depthwiseConstraint),e.pointwiseConstraint=fo(this.pointwiseConstraint),e}}]),n}(xf);Af.className="SeparableConv";var Ef=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,2,e)}return n}(Af);Ef.className="SeparableConv2D",Si.registerClass(Ef);var Cf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,1,e),n.verifyArgs(e),r.inputSpec=[{ndim:3}],r}return l.default(n,[{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete e.rank,delete e.dataFormat,e}}],[{key:"verifyArgs",value:function(e){if("number"!=typeof e.kernelSize&&!eo(e.kernelSize,"number",1,1))throw new Bi("Conv1D expects config.kernelSize to be number or number[] with "+"length 1, but received ".concat(JSON.stringify(e.kernelSize),"."))}}]),n}(xf);Cf.className="Conv1D",Si.registerClass(Cf);var Sf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),r=t.call(this,e),"number"==typeof e.cropping?r.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:"number"==typeof e.cropping[0]?r.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:r.cropping=e.cropping,r.dataFormat=void 0===e.dataFormat?"channelsLast":e.dataFormat,r.inputSpec=[{ndim:4}],r}return l.default(n,[{key:"computeOutputShape",value:function(e){return"channelsFirst"===this.dataFormat?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){if(e=ns(e),"channelsLast"===n.dataFormat){var t=hu(e,n.cropping[0][0],e.shape[1]-n.cropping[0][0]-n.cropping[0][1],2);return hu(t,n.cropping[1][0],e.shape[2]-n.cropping[1][1]-n.cropping[1][0],3)}var r=hu(e,n.cropping[0][0],e.shape[2]-n.cropping[0][0]-n.cropping[0][1],3);return hu(r,n.cropping[1][0],e.shape[3]-n.cropping[1][1]-n.cropping[1][0],4)}))}},{key:"getConfig",value:function(){var e={cropping:this.cropping,dataFormat:this.dataFormat},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);Sf.className="Cropping2D",Si.registerClass(Sf);var Nf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).DEFAULT_SIZE=[2,2],r.inputSpec=[{ndim:4}],r.size=null==e.size?r.DEFAULT_SIZE:e.size,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,r}return l.default(n,[{key:"computeOutputShape",value:function(e){if("channelsFirst"===this.dataFormat){var t=null==e[2]?null:this.size[0]*e[2],n=null==e[3]?null:this.size[1]*e[3];return[e[0],e[1],t,n]}var r=null==e[1]?null:this.size[0]*e[1],a=null==e[2]?null:this.size[1]*e[2];return[e[0],r,a,e[3]]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t=ns(e),r=t.shape;if("channelsFirst"===n.dataFormat){t=st.transpose(t,[0,2,3,1]);var a=n.size[0]*r[2],i=n.size[1]*r[3],o=t.resizeNearestNeighbor([a,i]);return st.transpose(o,[0,3,1,2])}var u=n.size[0]*r[1],s=n.size[1]*r[2];return t.resizeNearestNeighbor([u,s])}))}},{key:"getConfig",value:function(){var e={size:this.size,dataFormat:this.dataFormat},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);Nf.className="UpSampling2D",Si.registerClass(Nf),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");m=s("P1tXK");var Tf=s("btnhd");st=s("9PS5J"),Si=s("6b8rQ");s("jbRpz");m=s("P1tXK"),Tf=s("btnhd"),st=s("9PS5J"),Si=s("6b8rQ");var Df=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,2,e)).depthwiseKernel=null,r.depthMultiplier=null==e.depthMultiplier?1:e.depthMultiplier,r.depthwiseInitializer=Ku(e.depthwiseInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.depthwiseConstraint=ho(e.depthwiseConstraint),r.depthwiseRegularizer=Ql(e.depthwiseRegularizer),r}return l.default(n,[{key:"build",value:function(e){if((e=rs(e)).length<4)throw new Bi("Inputs to DepthwiseConv2D should have rank 4. "+"Received input shape: ".concat(JSON.stringify(e),"."));var t="channelsFirst"===this.dataFormat?1:3;if(null==e[t]||e[t]<0)throw new Bi("The channel dimension of the inputs to DepthwiseConv2D should "+"be defined, but is not (".concat(e[t],")."));var n=e[t],r=[this.kernelSize[0],this.kernelSize[1],n,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[n*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"valid",a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0;return m.tidy((function(){null==a&&(a="channelsLast"),qo(a);var o=pf(e,a);if(4!==e.rank)throw new Bi("Input for depthwiseConv2d is required to be 4-D, but is instead "+"".concat(e.rank,"-D"));if(4!==t.rank)throw new Bi("depthwiseKernel is required to be 4-D, but is instead "+"".concat(t.rank,"-D"));return o=Tf.depthwiseConv2d(o,t,n,"same"===r?"same":"valid","NHWC",i),"channelsFirst"===a&&(o=st.transpose(o,[0,3,1,2])),o}))}(e=ns(e),n.depthwiseKernel.read(),n.strides,n.padding,n.dataFormat,null);return n.useBias&&(t=Au(t,n.bias.read(),n.dataFormat)),null!=n.activation&&(t=n.activation.apply(t)),t}))}},{key:"computeOutputShape",value:function(e){e=rs(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=ff(t,this.kernelSize[0],this.padding,this.strides[0]),i=ff(n,this.kernelSize[1],this.padding,this.strides[1]);return"channelsFirst"===this.dataFormat?[e[0],r,a,i]:[e[0],a,i,r]}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this);return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Ju(this.depthwiseInitializer),e.depthwiseRegularizer=Xl(this.depthwiseRegularizer),e.depthwiseConstraint=fo(this.depthwiseRegularizer),e}}]),n}(yf);Df.className="DepthwiseConv2D",Si.registerClass(Df);var Ff={};n(Ff,"ConvLSTM2DCell",(function(){return Yf}),(function(e){return Yf=e})),n(Ff,"ConvLSTM2D",(function(){return Qf}),(function(e){return Qf=e})),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O"),Pe=s("9M1dW"),d=s("6vecG");s("jbRpz");m=s("P1tXK"),ot=s("ilMKa"),g=s("kglvN"),vo=s("6XDPM"),Io=s("4z0yD"),Ci=s("j0e1k");var Of=s("htMbZ"),_f=(Ti=s("b3Qcj"),s("dH9u6"));Si=s("6b8rQ");s("jbRpz");m=s("P1tXK"),ot=s("ilMKa"),g=s("kglvN"),vo=s("6XDPM"),Io=s("4z0yD"),Ci=s("j0e1k"),Of=s("htMbZ"),Ti=s("b3Qcj"),_f=s("dH9u6"),Si=s("6b8rQ");s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),Pe=s("9M1dW"),F=s("kRKWT"),O=s("eYQ8O"),d=s("6vecG");s("jbRpz");m=s("P1tXK"),Io=s("4z0yD"),st=s("9PS5J");var If=s("fwOP6"),Rf=s("hYjAM"),Mf=s("6jWCC");x=s("biSQf"),g=s("kglvN"),ot=s("ilMKa"),Ei=s("2xCpB"),Si=s("6b8rQ"),Ci=s("j0e1k"),Ti=s("b3Qcj"),Of=s("htMbZ"),Us=s("ee0Eu");s("jbRpz");m=s("P1tXK"),Io=s("4z0yD"),st=s("9PS5J"),If=s("fwOP6"),Rf=s("hYjAM"),Mf=s("6jWCC"),x=s("biSQf"),g=s("kglvN"),ot=s("ilMKa"),Ei=s("2xCpB"),Si=s("6b8rQ"),Ci=s("j0e1k"),Ti=s("b3Qcj"),Of=s("htMbZ"),Us=s("ee0Eu");function Bf(e,t,n,r){if(Array.isArray(e)){if(null!=t||null!=n)throw new Bi("When inputs is an array, neither initialState or constants should be provided");null!=r&&(n=e.slice(e.length-r,e.length),e=e.slice(0,e.length-r)),e.length>1&&(t=e.slice(1,e.length)),e=e[0]}function a(e){return null==e||Array.isArray(e)?e:[e]}return{inputs:e,initialState:t=a(t),constants:n=a(n)}}function Pf(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4?arguments[4]:void 0,i=arguments.length>5?arguments[5]:void 0,o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return m.tidy((function(){var s=function(t){var n=y[t],r=m.tidy((function(){return e(n,v)}));if(null==a)f=r[0],v=r[1];else{var i=m.tidy((function(){var e=d[t],n=Io.onesLike(e).sub(e);return{output:r[0].mul(e).add(v[0].mul(n)),newStates:v.map((function(t,a){return r[1][a].mul(e).add(t.mul(n))}))}}));f=i.output,v=i.newStates}u&&h.push(f)},c=t.shape.length;if(c<3)throw new Bi("Input should be at least 3D, but is ".concat(c,"D."));var l=[1,0].concat(su(2,c));if(t=st.transpose(t,l),null!=i)throw new Pi("The rnn() functoin of the deeplearn.js backend does not support constants yet.");o&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),null!=a&&((a=a.asType("bool").asType("float32")).rank===c-1&&(a=If.expandDims(a,-1)),a=st.transpose(a,l)),r&&(t=Rf.reverse(t,0),null!=a&&(a=Rf.reverse(a,0)));var f,d,p,h=[],v=n,g=t.shape[0],y=Mf.unstack(t);null!=a&&(d=Mf.unstack(a));for(var b=0;b<g;++b)s(b);if(u){p=x.stack(h,1)}return[f,p,v]}))}var Lf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r,a;if(c.default(this,n),r=t.call(this,e),null==e.cell)throw new Bi("cell property is missing for the constructor of RNN.");if(null==(a=Array.isArray(e.cell)?new qf({cells:e.cell}):e.cell).stateSize)throw new Bi("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");return r.cell=a,r.returnSequences=null!=e.returnSequences&&e.returnSequences,r.returnState=null!=e.returnState&&e.returnState,r.goBackwards=null!=e.goBackwards&&e.goBackwards,r._stateful=null!=e.stateful&&e.stateful,r.unroll=null!=e.unroll&&e.unroll,r.supportsMasking=!0,r.inputSpec=[new fs({ndim:3})],r.stateSpec=null,r.states_=null,r.numConstants=null,r.keptStates=[],r}return l.default(n,[{key:"getStates",value:function(){return null==this.states_?su(0,Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1).map((function(e){return null})):this.states_}},{key:"setStates",value:function(e){this.states_=e}},{key:"computeOutputShape",value:function(e){es(e)&&(e=e[0]);var t=this.cell.stateSize;Array.isArray(t)||(t=[t]);var n,r=t[0];if(n=this.returnSequences?[e[0],e[1],r]:[e[0],r],this.returnState){var a=[],i=!0,o=!1,u=void 0;try{for(var s,c=t[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;a.push([e[0],l])}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}return[n].concat(a)}return n}},{key:"computeMask",value:function(e,t){var n=this;return m.tidy((function(){Array.isArray(t)&&(t=t[0]);var e=n.returnSequences?t:null;if(n.returnState){var r=n.states.map((function(e){return null}));return[e].concat(r)}return e}))}},{key:"states",get:function(){if(null==this.states_){for(var e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,t=[],n=0;n<e;++n)t.push(null);return t}return this.states_},set:function(e){this.states_=e}},{key:"build",value:function(e){if(null!=this.numConstants)throw new Pi("Constants support is not implemented in RNN yet.");es(e)&&(e=e[0]);var t=this.stateful?e[0]:null,n=e.slice(2);this.inputSpec[0]=new fs({shape:[t,null].concat(Pe.default(n))});var r,a=[e[0]].concat(e.slice(2));if(this.cell.build(a),r=Array.isArray(this.cell.stateSize)?this.cell.stateSize:[this.cell.stateSize],null!=this.stateSpec){if(!g.arraysEqual(this.stateSpec.map((function(e){return e.shape[e.shape.length-1]})),r))throw new Bi("An initialState was passed that is not compatible with "+"cell.stateSize. Received stateSpec=".concat(this.stateSpec,"; ")+"However cell.stateSize is ".concat(this.cell.stateSize))}else this.stateSpec=r.map((function(e){return new fs({shape:[null,e]})}));this.stateful&&this.resetStates()}},{key:"resetStates",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;m.tidy((function(){if(!n.stateful)throw new Ri("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape[0];if(null==r)throw new Bi("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.states_)Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(e){return ot.zeros([r,e])})):n.states_=[ot.zeros([r,n.cell.stateSize])];else if(null==e)m.dispose(n.states_),null!=n.keptStates&&(m.dispose(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(e){return ot.zeros([r,e])})):n.states_[0]=ot.zeros([r,n.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==n.states_.length)throw new Bi("Layer ".concat(n.name," expects ").concat(n.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));!0===t?n.keptStates.push(n.states_.slice()):m.dispose(n.states_);for(var a=0;a<n.states_.length;++a){var i=e[a],o=Array.isArray(n.cell.stateSize)?n.cell.stateSize[a]:n.cell.stateSize,u=[r,o];if(!g.arraysEqual(i.shape,u))throw new Bi("State ".concat(a," is incompatible with layer ").concat(n.name,": ")+"expected shape=".concat(u,", received shape=").concat(i.shape));n.states_[a]=i}}n.states_=n.states_.map((function(e){return m.keep(e.clone())}))}))}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=Bf(e,r,a,this.numConstants);e=i.inputs,r=i.initialState,a=i.constants;var o=[],u=[];if(null!=r){t.initialState=r,o=o.concat(r),this.stateSpec=[];var s=!0,c=!1,l=void 0;try{for(var f,d=r[Symbol.iterator]();!(s=(f=d.next()).done);s=!0){var p=f.value;this.stateSpec.push(new fs({shape:p.shape}))}}catch(e){c=!0,l=e}finally{try{s||null==d.return||d.return()}finally{if(c)throw l}}u=u.concat(this.stateSpec)}if(null!=a&&(t.constants=a,o=o.concat(a),this.numConstants=a.length),o[0]instanceof ds){var h=[e].concat(o),v=this.inputSpec.concat(u),g=this.inputSpec;this.inputSpec=v;var m=F.default(O.default(n.prototype),"apply",this).call(this,h,t);return this.inputSpec=g,m}return F.default(O.default(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r=n,a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;e=ns(e),null==o&&(o=n.stateful?n.states_:n.getInitialState(e));var u=Array.isArray(n.cell.stateSize)?n.cell.stateSize.length:1;if(o.length!==u)throw new Bi("RNN Layer has ".concat(u," state(s) but was passed ")+"".concat(o.length," initial state(s)."));n.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");var s={training:i},c=Pf((function(e,t){var n=r.cell.call([e].concat(t),s);return[n[0],n.slice(1)]}),e,o,n.goBackwards,a,null,n.unroll,n.returnSequences),l=c[0],f=c[1],d=c[2];n.stateful&&n.resetStates(d,i);var p=n.returnSequences?f:l;return n.returnState?[p].concat(d):p}))}},{key:"getInitialState",value:function(e){var t=this;return m.tidy((function(){var n=ot.zeros(e.shape);return n=lu(n=Ei.sum(n,[1,2])),Array.isArray(t.cell.stateSize)?t.cell.stateSize.map((function(e){return e>1?mu(n,[1,e]):n})):t.cell.stateSize>1?[mu(n,[1,t.cell.stateSize])]:[n]}))}},{key:"trainableWeights",get:function(){return this.trainable?this.cell.trainableWeights:[]}},{key:"nonTrainableWeights",get:function(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}},{key:"setFastWeightInitDuringBuild",value:function(e){F.default(O.default(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.cell&&this.cell.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};null!=this.numConstants&&(e.numConstants=this.numConstants);var t=this.cell.getConfig();e.cell={className:this.cell.getClassName(),config:t};var r=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,r),e}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.cell,a=Bs(r,n);return new e(Object.assign(t,{cell:a}))}}]),n}(gs);Lf.className="RNN",Si.registerClass(Lf);var jf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return n}(gs),zf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,to(r.units,"units"),r.activation=Gl(null==e.activation?r.DEFAULT_ACTIVATION:e.activation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Ku(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Ku(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Ku(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Ql(e.kernelRegularizer),r.recurrentRegularizer=Ql(e.recurrentRegularizer),r.biasRegularizer=Ql(e.biasRegularizer),r.kernelConstraint=ho(e.kernelConstraint),r.recurrentConstraint=ho(e.recurrentConstraint),r.biasConstraint=ho(e.biasConstraint),r.dropout=ou([1,uu([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=ou([1,uu([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return l.default(n,[{key:"build",value:function(e){e=rs(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){if(2!==e.length)throw new Bi("SimpleRNNCell expects 2 input Tensors, got ".concat(e.length,"."));var r=e[1];e=e[0];var a,i=null!=t.training&&t.training;0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Jf({ones:function(){return Io.onesLike(e)},rate:n.dropout,training:i})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Jf({ones:function(){return Io.onesLike(r)},rate:n.recurrentDropout,training:i}));var o=n.dropoutMask,u=n.recurrentDropoutMask;a=xu(null!=o?Ci.mul(e,o):e,n.kernel.read()),null!=n.bias&&(a=Au(a,n.bias.read())),null!=u&&(r=Ci.mul(r,u));var s=Ti.add(a,xu(r,n.recurrentKernel.read()));return null!=n.activation&&(s=n.activation.apply(s)),[s,s]}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),recurrentInitializer:Ju(this.recurrentInitializer),biasInitializer:Ju(this.biasInitializer),kernelRegularizer:Xl(this.kernelRegularizer),recurrentRegularizer:Xl(this.recurrentRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),recurrentConstraint:fo(this.recurrentConstraint),biasConstraint:fo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(jf);zf.className="SimpleRNNCell",Si.registerClass(zf);var Uf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),e.cell=new zf(e),t.call(this,e)}return l.default(n,[{key:"call",value:function(e,t){var r=this;return m.tidy((function(){null!=r.cell.dropoutMask&&(m.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(m.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return F.default(O.default(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),recurrentInitializer:Ju(this.recurrentInitializer),biasInitializer:Ju(this.biasInitializer),kernelRegularizer:Xl(this.kernelRegularizer),recurrentRegularizer:Xl(this.recurrentRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),recurrentConstraint:fo(this.recurrentConstraint),biasConstraint:fo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete t.cell,Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(Lf);Uf.className="SimpleRNN",Si.registerClass(Uf);var Vf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new Bi("GRUCell does not support reset_after parameter set to true.");return r.units=e.units,to(r.units,"units"),r.activation=Gl(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Gl(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Ku(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Ku(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Ku(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelRegularizer=Ql(e.kernelRegularizer),r.recurrentRegularizer=Ql(e.recurrentRegularizer),r.biasRegularizer=Ql(e.biasRegularizer),r.kernelConstraint=ho(e.kernelConstraint),r.recurrentConstraint=ho(e.recurrentConstraint),r.biasConstraint=ho(e.biasConstraint),r.dropout=ou([1,uu([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=ou([1,uu([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=r.units,r.dropoutMask=null,r.recurrentDropoutMask=null,r}return l.default(n,[{key:"build",value:function(e){var t=(e=rs(e))[e.length-1];this.kernel=this.addWeight("kernel",[t,3*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,3*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[3*this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){if(2!==e.length)throw new Bi("GRUCell expects 2 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=null!=t.training&&t.training,a=e[1];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Jf({ones:function(){return Io.onesLike(e)},rate:n.dropout,training:r,count:3})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Jf({ones:function(){return Io.onesLike(a)},rate:n.recurrentDropout,training:r,count:3}));var i,o,u,s=n.dropoutMask,c=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Ci.mul(e,s[0]));var l=xu(e,n.kernel.read());n.useBias&&(l=Au(l,n.bias.read())),0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Ci.mul(a,c[0]));var f=n.recurrentKernel.read(),p=d.default(Of.split(f,[2*n.units,n.units],f.rank-1),2),h=p[0],v=p[1],g=xu(a,h),m=d.default(Of.split(l,3,l.rank-1),3),y=m[0],x=m[1],b=m[2],k=d.default(Of.split(g,2,g.rank-1),2),w=k[0],A=k[1];i=n.recurrentActivation.apply(Ti.add(y,w)),o=n.recurrentActivation.apply(Ti.add(x,A));var E=xu(Ci.mul(o,a),v);u=n.activation.apply(Ti.add(b,E));var C=Ti.add(Ci.mul(i,a),Ci.mul(Ti.add(1,Us.neg(i)),u));return[C,C]}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),recurrentActivation:Vl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),recurrentInitializer:Ju(this.recurrentInitializer),biasInitializer:Ju(this.biasInitializer),kernelRegularizer:Xl(this.kernelRegularizer),recurrentRegularizer:Xl(this.recurrentRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),recurrentConstraint:fo(this.recurrentConstraint),biasConstraint:fo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(jf);Vf.className="GRUCell",Si.registerClass(Vf);var Wf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Vf(e),t.call(this,e)}return l.default(n,[{key:"call",value:function(e,t){var r=this;return m.tidy((function(){null!=r.cell.dropoutMask&&(m.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(m.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return F.default(O.default(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"recurrentActivation",get:function(){return this.cell.recurrentActivation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"implementation",get:function(){return this.cell.implementation}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),recurrentActivation:Vl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),recurrentInitializer:Ju(this.recurrentInitializer),biasInitializer:Ju(this.biasInitializer),kernelRegularizer:Xl(this.kernelRegularizer),recurrentRegularizer:Xl(this.recurrentRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),recurrentConstraint:fo(this.recurrentConstraint),biasConstraint:fo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete t.cell,Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(Lf);Wf.className="GRU",Si.registerClass(Wf);var Gf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).DEFAULT_ACTIVATION="tanh",r.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_RECURRENT_INITIALIZER="orthogonal",r.DEFAULT_BIAS_INITIALIZER="zeros",r.units=e.units,to(r.units,"units"),r.activation=Gl(void 0===e.activation?r.DEFAULT_ACTIVATION:e.activation),r.recurrentActivation=Gl(void 0===e.recurrentActivation?r.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),r.useBias=null==e.useBias||e.useBias,r.kernelInitializer=Ku(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.recurrentInitializer=Ku(e.recurrentInitializer||r.DEFAULT_RECURRENT_INITIALIZER),r.biasInitializer=Ku(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.unitForgetBias=e.unitForgetBias,r.kernelRegularizer=Ql(e.kernelRegularizer),r.recurrentRegularizer=Ql(e.recurrentRegularizer),r.biasRegularizer=Ql(e.biasRegularizer),r.kernelConstraint=ho(e.kernelConstraint),r.recurrentConstraint=ho(e.recurrentConstraint),r.biasConstraint=ho(e.biasConstraint),r.dropout=ou([1,uu([0,null==e.dropout?0:e.dropout])]),r.recurrentDropout=ou([1,uu([0,null==e.recurrentDropout?0:e.recurrentDropout])]),r.implementation=e.implementation,r.stateSize=[r.units,r.units],r.dropoutMask=null,r.recurrentDropoutMask=null,r}return l.default(n,[{key:"build",value:function(e){var t,n,r=(e=rs(e))[e.length-1];if(this.kernel=this.addWeight("kernel",[r,4*this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,4*this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){if(this.unitForgetBias){var a=this.biasInitializer,i=this.units;n=new(t=function(e){p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e,t){var n=a.apply([i]),r=(new Ou).apply([i]),o=a.apply([2*i]);return gu(gu(n,r),o)}}]),n}(Du),t.className="CustomInit",t)}else n=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.units],null,n,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r=null!=t.training&&t.training;if(3!==e.length)throw new Bi("LSTMCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var a=e[1],i=e[2];e=e[0],0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Jf({ones:function(){return Io.onesLike(e)},rate:n.dropout,training:r,count:4})),0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Jf({ones:function(){return Io.onesLike(a)},rate:n.recurrentDropout,training:r,count:4}));var o,u,s,c,l=n.dropoutMask,f=n.recurrentDropoutMask;0<n.dropout&&n.dropout<1&&(e=Ci.mul(e,l[0]));var p=xu(e,n.kernel.read());0<n.recurrentDropout&&n.recurrentDropout<1&&(a=Ci.mul(a,f[0])),p=Ti.add(p,xu(a,n.recurrentKernel.read())),n.useBias&&(p=Au(p,n.bias.read()));var h=d.default(Of.split(p,4,p.rank-1),4),v=h[0],g=h[1],m=h[2],y=h[3];o=n.recurrentActivation.apply(v),u=n.recurrentActivation.apply(g),s=Ti.add(Ci.mul(u,i),Ci.mul(o,n.activation.apply(m))),c=n.recurrentActivation.apply(y);var x=Ci.mul(c,n.activation.apply(s));return[x,x,s]}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),recurrentActivation:Vl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),recurrentInitializer:Ju(this.recurrentInitializer),biasInitializer:Ju(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Xl(this.kernelRegularizer),recurrentRegularizer:Xl(this.recurrentRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),recurrentConstraint:fo(this.recurrentConstraint),biasConstraint:fo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(jf);Gf.className="LSTMCell",Si.registerClass(Gf);var Hf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),0===e.implementation&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Gf(e),t.call(this,e)}return l.default(n,[{key:"call",value:function(e,t){var r=this;return m.tidy((function(){null!=r.cell.dropoutMask&&(m.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(m.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null);var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return F.default(O.default(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"units",get:function(){return this.cell.units}},{key:"activation",get:function(){return this.cell.activation}},{key:"recurrentActivation",get:function(){return this.cell.recurrentActivation}},{key:"useBias",get:function(){return this.cell.useBias}},{key:"kernelInitializer",get:function(){return this.cell.kernelInitializer}},{key:"recurrentInitializer",get:function(){return this.cell.recurrentInitializer}},{key:"biasInitializer",get:function(){return this.cell.biasInitializer}},{key:"unitForgetBias",get:function(){return this.cell.unitForgetBias}},{key:"kernelRegularizer",get:function(){return this.cell.kernelRegularizer}},{key:"recurrentRegularizer",get:function(){return this.cell.recurrentRegularizer}},{key:"biasRegularizer",get:function(){return this.cell.biasRegularizer}},{key:"kernelConstraint",get:function(){return this.cell.kernelConstraint}},{key:"recurrentConstraint",get:function(){return this.cell.recurrentConstraint}},{key:"biasConstraint",get:function(){return this.cell.biasConstraint}},{key:"dropout",get:function(){return this.cell.dropout}},{key:"recurrentDropout",get:function(){return this.cell.recurrentDropout}},{key:"implementation",get:function(){return this.cell.implementation}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),recurrentActivation:Vl(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),recurrentInitializer:Ju(this.recurrentInitializer),biasInitializer:Ju(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:Xl(this.kernelRegularizer),recurrentRegularizer:Xl(this.recurrentRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),recurrentConstraint:fo(this.recurrentConstraint),biasConstraint:fo(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return delete t.cell,Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){return 0===t.implmentation&&(t.implementation=1),new e(t)}}]),n}(Lf);Hf.className="LSTM",Si.registerClass(Hf);var qf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).cells=e.cells,r}return l.default(n,[{key:"stateSize",get:function(){var e,t=[],n=!0,r=!1,a=void 0;try{for(var i,o=this.cells.slice().reverse()[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;Array.isArray(u.stateSize)?(e=t).push.apply(e,Pe.default(u.stateSize)):t.push(u.stateSize)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r,a=e.slice(1),i=[],o=!0,u=!1,s=void 0;try{for(var c,l=n.cells.slice().reverse()[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var f=c.value;Array.isArray(f.stateSize)?i.push(a.splice(0,f.stateSize.length)):i.push(a.splice(0,1))}}catch(e){u=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(u)throw s}}i.reverse();for(var d,p=[],h=0;h<n.cells.length;++h){var v=n.cells[h];a=i[h],d=0===h?[e[0]].concat(a):[d[0]].concat(a),d=v.call(d,t),p.push(d.slice(1))}a=[];var g=!0,m=!1,y=void 0;try{for(var x,b=p.slice().reverse()[Symbol.iterator]();!(g=(x=b.next()).done);g=!0){var k=x.value;(r=a).push.apply(r,Pe.default(k))}}catch(e){m=!0,y=e}finally{try{g||null==b.return||b.return()}finally{if(m)throw y}}return[d[0]].concat(a)}))}},{key:"build",value:function(e){var t;es(e)&&(e=e[0]),this.cells.forEach((function(n,r){Yo("RNNCell_".concat(r),(function(){n.build(e),t=Array.isArray(n.stateSize)?n.stateSize[0]:n.stateSize,e=[e[0],t]}))})),this.built=!0}},{key:"getConfig",value:function(){var e=[],t=!0,r=!1,a=void 0;try{for(var i,o=this.cells[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value;e.push({className:u.getClassName(),config:u.getConfig()})}}catch(e){r=!0,a=e}finally{try{t||null==o.return||o.return()}finally{if(r)throw a}}var s={cells:e},c=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(s,c),s}},{key:"trainableWeights",get:function(){var e;if(!this.trainable)return[];var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=this.cells[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;(e=t).push.apply(e,Pe.default(u.trainableWeights))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return t}},{key:"nonTrainableWeights",get:function(){var e,t=[],n=!0,r=!1,a=void 0;try{for(var i,o=this.cells[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;(e=t).push.apply(e,Pe.default(u.nonTrainableWeights))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if(!this.trainable){var s,c=[],l=!0,f=!1,d=void 0;try{for(var p,h=this.cells[Symbol.iterator]();!(l=(p=h.next()).done);l=!0){var v=p.value;(s=c).push.apply(s,Pe.default(v.trainableWeights))}}catch(e){f=!0,d=e}finally{try{l||null==h.return||h.return()}finally{if(f)throw d}}return c.concat(t)}return t}},{key:"getWeights",value:function(){var e,t=[],n=!0,r=!1,a=void 0;try{for(var i,o=this.cells[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;(e=t).push.apply(e,Pe.default(u.weights))}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return cs(t)}},{key:"setWeights",value:function(e){var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=this.cells[Symbol.iterator]();!(n=(i=o.next()).done);n=!0)for(var u=i.value,s=u.weights.length,c=e.splice(s),l=0;l<u.weights.length;++l)t.push([u.weights[l],c[l]])}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}ls(t)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],a=!0,i=!1,o=void 0;try{for(var u,s=t.cells[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;r.push(Bs(c,n))}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return new e({cells:r})}}]),n}(jf);function Jf(e){var t=e.ones,n=e.rate,r=e.training,a=void 0!==r&&r,i=e.count,o=void 0===i?1:i,u=function(){return Cu(t(),n)},s=function(){return Su(u,t,a)};return!o||o<=1?m.keep(s().clone()):Array(o).fill(void 0).map(s).map((function(e){return m.keep(e.clone())}))}qf.className="StackedRNNCells",Si.registerClass(qf);var Kf=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n},Xf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),e.unroll)throw new Pi("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Pi("It is not possible at the moment to stack convolutional cells.");return(r=t.call(this,e)).inputSpec=[new fs({ndim:5})],r}return l.default(n,[{key:"call",value:function(e,t){var r=this;return m.tidy((function(){if(null!=r.cell.dropoutMask&&(m.dispose(r.cell.dropoutMask),r.cell.dropoutMask=null),null!=r.cell.recurrentDropoutMask&&(m.dispose(r.cell.recurrentDropoutMask),r.cell.recurrentDropoutMask=null),t&&t.constants)throw new Bi("ConvRNN2D cell does not support constants");var a=null==t?null:t.mask,i=null==t?null:t.training,o=null==t?null:t.initialState;return F.default(O.default(n.prototype),"call",r).call(r,e,{mask:a,training:i,initialState:o})}))}},{key:"computeOutputShape",value:function(e){var t=this.computeSingleOutputShape(e);return this.returnSequences||(t=[t[0]].concat(Pe.default(t.slice(2)))),this.returnState&&(t=[t].concat(Pe.default(Array(2).fill([e[0]].concat(Pe.default(t.slice(-3))))))),t}},{key:"getInitialState",value:function(e){var t=this;return m.tidy((function(){var n=t.cell.stateSize,r=e.shape,a=t.computeSingleOutputShape(r),i=[a[0]].concat(Pe.default(a.slice(2))),o=ot.zeros(i);return Array.isArray(n)?Array(n.length).fill(o):[o]}))}},{key:"resetStates",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;m.tidy((function(){if(!n.stateful)throw new Ri("Cannot call resetStates() on an RNN Layer that is not stateful.");var r=n.inputSpec[0].shape,a=n.computeSingleOutputShape(r),i=[a[0]].concat(Pe.default(a.slice(2)));if(null==r[0])throw new Bi("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(null==n.getStates())Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(){return ot.zeros(i)})):n.states_=[ot.zeros(i)];else if(null==e)m.dispose(n.states_),null!=n.keptStates&&(m.dispose(n.keptStates),n.keptStates=[]),Array.isArray(n.cell.stateSize)?n.states_=n.cell.stateSize.map((function(){return ot.zeros(i)})):n.states_[0]=ot.zeros(i);else{if(Array.isArray(e)||(e=[e]),e.length!==n.states_.length)throw new Bi("Layer ".concat(n.name," expects ").concat(n.states_.length," state(s), ")+"but it received ".concat(e.length," state value(s). Input ")+"received: ".concat(e));t?n.keptStates.push(n.states_.slice()):m.dispose(n.states_);for(var o=0;o<n.states_.length;++o){var u=e[o],s=i;if(!g.arraysEqual(u.shape,s))throw new Bi("State ".concat(o," is incompatible with layer ").concat(n.name,": ")+"expected shape=".concat(s,", received shape=").concat(u.shape));n.states_[o]=u}}n.states_=n.states_.map((function(e){return m.keep(e.clone())}))}))}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this),t=(e.cell,Kf(e,["cell"])),r=this.cell.getConfig();return Object.assign({},r,t)}},{key:"computeSingleOutputShape",value:function(e){var t=this.cell,n=t.dataFormat,r=t.filters,a=t.kernelSize,i=t.padding,o=t.strides,u=t.dilationRate,s="channelsFirst"===n,c=e[s?3:2],l=e[s?4:3],f=ff(c,a[0],i,o[0],u[0]),d=ff(l,a[1],i,o[1],u[1]);return Pe.default(e.slice(0,2)).concat(Pe.default(s?[r,f,d]:[f,d,r]))}}]),n}(Lf);Xf.className="ConvRNN2D";var Yf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;c.default(this,n);var a=e.filters,i=e.kernelSize,o=e.strides,u=e.padding,s=e.dataFormat,l=e.dilationRate;return(r=t.call(this,Object.assign({},e,{units:a}))).filters=a,to(r.filters,"filters"),r.kernelSize=lf(i,2,"kernelSize"),r.kernelSize.map((function(e){return to(e,"kernelSize")})),r.strides=lf(o||1,2,"strides"),r.strides.map((function(e){return to(e,"strides")})),r.padding=u||"valid",Jo(r.padding),r.dataFormat=s||"channelsLast",qo(r.dataFormat),r.dilationRate=lf(l||1,2,"dilationRate"),r.dilationRate.map((function(e){return to(e,"dilationRate")})),r}return l.default(n,[{key:"build",value:function(e){var t;e=rs(e);var n="channelsFirst"===this.dataFormat?1:e.length-1;if(null==e[n])throw new Bi("The channel dimension of the input should be defined. "+"Found ".concat(e[n]));var r=e[n],a=this.kernelSize.concat([r,4*this.filters]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);var i=this.kernelSize.concat([this.filters,4*this.filters]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",i,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){var o;if(this.unitForgetBias){var u=this.biasInitializer,s=this.filters;o=new(t=function(e){p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"apply",value:function(e,t){return vu([u.apply([s]),vo.ones([s]),u.apply([2*s])])}}]),n}(Du),t.className="CustomInit",t)}else o=this.biasInitializer;this.bias=this.addWeight("bias",[4*this.filters],null,o,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){if(3!==e.length)throw new Bi("ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got "+"".concat(e.length,"."));var r=t.training||!1,a=e[0],i=e[1],o=e[2];0<n.dropout&&n.dropout<1&&null==n.dropoutMask&&(n.dropoutMask=Jf({ones:function(){return Io.onesLike(a)},rate:n.dropout,training:r,count:4}));var u=n.dropoutMask,s=function(e,t,n){return t&&t[n]?Ci.mul(t[n],e):e},c=s(a,u,0),l=s(a,u,1),f=s(a,u,2),p=s(a,u,3);0<n.recurrentDropout&&n.recurrentDropout<1&&null==n.recurrentDropoutMask&&(n.recurrentDropoutMask=Jf({ones:function(){return Io.onesLike(i)},rate:n.recurrentDropout,training:r,count:4}));var h=n.recurrentDropoutMask,v=s(i,h,0),g=s(i,h,1),m=s(i,h,2),y=s(i,h,3),x=d.default(Of.split(n.kernel.read(),4,3),4),b=x[0],k=x[1],w=x[2],A=x[3],E=d.default(n.useBias?Of.split(n.bias.read(),4):[null,null,null,null],4),C=E[0],S=E[1],N=E[2],T=E[3];c=n.inputConv(c,b,C,n.padding),l=n.inputConv(l,k,S,n.padding),f=n.inputConv(f,w,N,n.padding),p=n.inputConv(p,A,T,n.padding);var D=d.default(Of.split(n.recurrentKernel.read(),4,3),4),F=D[0],O=D[1],_=D[2],I=D[3];v=n.recurrentConv(v,F),g=n.recurrentConv(g,O),m=n.recurrentConv(m,_),y=n.recurrentConv(y,I);var R=n.recurrentActivation.apply(Ti.add(c,v)),M=n.recurrentActivation.apply(Ti.add(l,g)),B=Ti.add(Ci.mul(M,o),Ci.mul(R,n.activation.apply(Ti.add(f,m)))),P=Ci.mul(n.recurrentActivation.apply(Ti.add(p,y)),n.activation.apply(B));return[P,P,B]}))}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this),t=(e.units,Kf(e,["units"])),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate};return Object.assign({},t,r)}},{key:"inputConv",value:function(e,t,n,r){var a=_f.conv2d(e,t,this.strides,r||"valid","channelsFirst"===this.dataFormat?"NCHW":"NHWC",this.dilationRate);return n?Au(a,n,this.dataFormat):a}},{key:"recurrentConv",value:function(e,t){return _f.conv2d(e,t,1,"same","channelsFirst"===this.dataFormat?"NCHW":"NHWC")}}]),n}(Gf);Yf.className="ConvLSTM2DCell",Si.registerClass(Yf);var Qf=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){c.default(this,n);var r=new Yf(e);return t.call(this,Object.assign({},e,{cell:r}))}return l.default(n,null,[{key:"fromConfig",value:function(e,t){return new e(t)}}]),n}(Xf);Qf.className="ConvLSTM2D",Si.registerClass(Qf),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O"),af=s("4Ui3v");s("jbRpz");m=s("P1tXK"),Si=s("6b8rQ"),g=s("kglvN"),st=s("9PS5J");var Zf=s("a7Ldu"),$f=s("7owLz"),ed=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).rate=Math.max(Math.min(e.rate,1),0),r.noiseShape=e.noiseShape,r.seed=e.seed,r.supportsMasking=!0,r}return l.default(n,[{key:"getNoiseShape",value:function(e){if(null==this.noiseShape)return this.noiseShape;for(var t=e.shape,n=[],r=0;r<this.noiseShape.length;++r)n.push(null==this.noiseShape[r]?t[r]:this.noiseShape[r]);return n}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e);if(0<n.rate&&n.rate<1){var a=n,i=null!=t.training&&t.training,o=n.getNoiseShape(r);return Su((function(){return Cu(r,a.rate,o,a.seed)}),(function(){return r}),i)}return e}))}},{key:"getConfig",value:function(){var e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"dispose",value:function(){return F.default(O.default(n.prototype),"dispose",this).call(this)}}]),n}(gs);ed.className="Dropout",Si.registerClass(ed);var td=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).inputSpec=[{ndim:3}],r}return l.default(n,[{key:"getNoiseShape",value:function(e){var t=e.shape;return[t[0],1,t[2]]}}]),n}(ed);td.className="SpatialDropout1D",Si.registerClass(td);var nd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,e)).activation=null,r.useBias=!0,r.kernel=null,r.bias=null,r.DEFAULT_KERNEL_INITIALIZER="glorotNormal",r.DEFAULT_BIAS_INITIALIZER="zeros",null==e.batchInputShape&&null==e.inputShape&&null!=e.inputDim){var a=null;null!=e.batchSize&&(a=e.batchSize),r.batchInputShape=[a,e.inputDim]}return r.units=e.units,to(r.units,"units"),r.activation=Gl(e.activation),null!=e.useBias&&(r.useBias=e.useBias),r.kernelInitializer=Ku(e.kernelInitializer||r.DEFAULT_KERNEL_INITIALIZER),r.biasInitializer=Ku(e.biasInitializer||r.DEFAULT_BIAS_INITIALIZER),r.kernelConstraint=ho(e.kernelConstraint),r.biasConstraint=ho(e.biasConstraint),r.kernelRegularizer=Ql(e.kernelRegularizer),r.biasRegularizer=Ql(e.biasRegularizer),r.activityRegularizer=Ql(e.activityRegularizer),r.supportsMasking=!0,r.inputSpec=[{minNDim:2}],r}return l.default(n,[{key:"build",value:function(e){var t=(e=rs(e))[e.length-1];null==this.kernel&&(this.kernel=this.addWeight("kernel",[t,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:af.default({},-1,t)}],this.built=!0}},{key:"computeOutputShape",value:function(e){var t=(e=rs(e)).slice();return t[t.length-1]=this.units,t}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r,a=ns(e),i=ro(n.activation.getClassName());return null!=i?r=xu(a,n.kernel.read(),i,n.bias?n.bias.read():null):(r=xu(a,n.kernel.read()),null!=n.bias&&(r=Au(r,n.bias.read())),null!=n.activation&&(r=n.activation.apply(r))),r}))}},{key:"getConfig",value:function(){var e={units:this.units,activation:Vl(this.activation),useBias:this.useBias,kernelInitializer:Ju(this.kernelInitializer),biasInitializer:Ju(this.biasInitializer),kernelRegularizer:Xl(this.kernelRegularizer),biasRegularizer:Xl(this.biasRegularizer),activityRegularizer:Xl(this.activityRegularizer),kernelConstraint:fo(this.kernelConstraint),biasConstraint:fo(this.biasConstraint)},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);nd.className="Dense",Si.registerClass(nd);var rd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),e=e||{},(r=t.call(this,e)).inputSpec=[{minNDim:3}],r.dataFormat=e.dataFormat,r}return l.default(n,[{key:"computeOutputShape",value:function(e){e=rs(e);var t=!0,n=!1,r=void 0;try{for(var a,i=e.slice(1)[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){if(null==a.value)throw new Bi('The shape of the input to "Flatten" is not fully defined '+"(got ".concat(e.slice(1),"). Make sure to pass a complete ")+'"input_shape" or "batch_input_shape" argument to the first layer in your model.')}}catch(e){n=!0,r=e}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}return[e[0],au(e,1)]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e);if("channelsFirst"===n.dataFormat&&r.rank>1){for(var a=[0],i=2;i<r.rank;++i)a.push(i);a.push(1),r=r.transpose(a)}return function(e){if(e.rank<=1)throw new Bi("batchFlatten requires a minimum rank of 2. Got rank: ".concat(e.rank,"."));var t=[e.shape[0],au(e.shape,1)];return e.reshape(t)}(r)}))}},{key:"getConfig",value:function(){var e={};null!=this.dataFormat&&(e.dataFormat=this.dataFormat);var t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);rd.className="Flatten",Si.registerClass(rd);var ad=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).supportsMasking=!0,r.activation=Gl(e.activation),r}return l.default(n,[{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e);return n.activation.apply(r)}))}},{key:"getConfig",value:function(){var e={activation:Vl(this.activation)},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);ad.className="Activation",Si.registerClass(ad);var id=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).n=e.n,r.inputSpec=[{ndim:2}],r}return l.default(n,[{key:"computeOutputShape",value:function(e){return[e[0],this.n,e[1]]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){return function(e,t){return m.tidy((function(){if(2!==e.shape.length)throw new Bi("repeat() expects a rank-2 tensor, but received a "+"rank-".concat(e.shape.length," tensor."));return mu(lu(e,1),[1,t,1])}))}(e=ns(e),n.n)}))}},{key:"getConfig",value:function(){var e={n:this.n},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);id.className="RepeatVector",Si.registerClass(id);var od=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;c.default(this,n),(r=t.call(this,e)).targetShape=e.targetShape;for(var a=0;a<r.targetShape.length;++a)r.isUnknown(r.targetShape[a])&&(r.targetShape[a]=null);return r}return l.default(n,[{key:"isUnknown",value:function(e){return e<0||null==e}},{key:"fixUnknownDimension",value:function(e,t){for(var n="Total size of new array must be unchanged.",r=t.slice(),a=1,i=null,o=0;o<r.length;++o){var u=r[o];if(this.isUnknown(u)){if(null!==i)throw new Bi("Can only specifiy one unknown dimension.");i=o}else a*=u}var s=au(e);if(null!==i){if(0===a||s%a!=0)throw new Bi(n);r[i]=s/a}else if(s!==a)throw new Bi(n);return r}},{key:"computeOutputShape",value:function(e){for(var t=!1,n=0;n<e.length;++n)if(this.isUnknown(e[n])){t=!0;break}return t?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e),a=r.shape,i=a.slice(0,1).concat(n.fixUnknownDimension(a.slice(1),n.targetShape));return r.reshape(i)}))}},{key:"getConfig",value:function(){var e={targetShape:this.targetShape},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);od.className="Reshape",Si.registerClass(od);var ud=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),r=t.call(this,e),null==e.dims)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error("Permute constructor requires `dims` to be an Array, but received "+"".concat(e.dims," instead."));var a=su(1,e.dims.length+1);if(!g.arraysEqual(e.dims.slice().sort(),a))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");return r.dims=e.dims,r.dimsIncludingBatch=[0].concat(r.dims),r.inputSpec=[new fs({ndim:r.dims.length+1})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){var t=(e=rs(e)).slice();return this.dims.forEach((function(n,r){t[r+1]=e[n]})),t}},{key:"call",value:function(e,t){return st.transpose(ns(e),this.dimsIncludingBatch)}},{key:"getConfig",value:function(){var e={dims:this.dims},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);ud.className="Permute",Si.registerClass(ud);var sd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,null==e?{}:e)).supportsMasking=!0,r.maskValue=null!=e?null==e.maskValue?0:e.maskValue:0,r}return l.default(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this),t={maskValue:this.maskValue};return Object.assign(t,e),t}},{key:"computeMask",value:function(e,t){var n=ns(e);return Zf.any($f.notEqual(n,this.maskValue),-1)}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e),a=Zf.any($f.notEqual(r,n.maskValue),-1,!0);return r.mul(a.asType(r.dtype))}))}}]),n}(gs);sd.className="Masking",Si.registerClass(sd),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),Pe=s("9M1dW"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");m=s("P1tXK"),$f=s("7owLz"),_o=s("8p3bZ"),Si=s("6b8rQ");var cd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),(r=t.call(this,e)).embeddings=null,r.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",null==e.batchInputShape&&null==e.inputShape){var a=null;null!=e.batchSize&&(a=e.batchSize),null==e.inputLength?r.batchInputShape=[a,null]:r.batchInputShape=[a].concat(Wi(e.inputLength))}return r.inputDim=e.inputDim,to(r.inputDim,"inputDim"),r.outputDim=e.outputDim,to(r.outputDim,"outputDim"),r.embeddingsInitializer=Ku(e.embeddingsInitializer||r.DEFAULT_EMBEDDINGS_INITIALIZER),r.embeddingsRegularizer=Ql(e.embeddingsRegularizer),r.activityRegularizer=Ql(e.activityRegularizer),r.embeddingsConstraint=ho(e.embeddingsConstraint),r.maskZero=e.maskZero,r.supportsMasking=e.maskZero,r.inputLength=e.inputLength,r}return l.default(n,[{key:"build",value:function(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}},{key:"warnOnIncompatibleInputShape",value:function(e){}},{key:"computeMask",value:function(e,t){var n=this;return m.tidy((function(){return n.maskZero?(e=ns(e),$f.notEqual(e,_o.zerosLike(e))):null}))}},{key:"computeOutputShape",value:function(e){if(e=rs(e),null==this.inputLength)return Pe.default(e).concat([this.outputDim]);var t=Wi(this.inputLength);if(t.length!==e.length-1)throw new Bi('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));for(var n=0,r=0;r<t.length;++r){var a=t[r],i=e[r+1];if(null!=a&&null!=i&&a!==i)throw new Bi('"inputLength" is '.concat(this.inputLength,", but received ")+"input shape has shape ".concat(e));null==a&&(t[n]=i),n++}return[e[0]].concat(Pe.default(t),[this.outputDim])}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e);return"int32"!==r.dtype&&(r=cu(r,"int32")),bu(n.embeddings.read(),r.as1D()).reshape(rs(n.computeOutputShape(r.shape)))}))}},{key:"getConfig",value:function(){var e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Ju(this.embeddingsInitializer),embeddingsRegularizer:Xl(this.embeddingsRegularizer),activityRegularizer:Xl(this.activityRegularizer),embeddingsConstraint:fo(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);cd.className="Embedding",Si.registerClass(cd),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");m=s("P1tXK"),st=s("9PS5J"),If=s("fwOP6"),nc=s("7WLBj"),Ti=s("b3Qcj"),Si=s("6b8rQ"),Ci=s("j0e1k"),Ls=s("k7Du7"),Cl=s("eu81x"),g=s("kglvN"),Io=s("4z0yD"),Eo=s("6hkW8");var ld=s("d6rwS");s("jbRpz");m=s("P1tXK"),st=s("9PS5J"),If=s("fwOP6"),nc=s("7WLBj"),Ti=s("b3Qcj"),Si=s("6b8rQ"),Ci=s("j0e1k"),Ls=s("k7Du7"),Cl=s("eu81x"),g=s("kglvN"),Io=s("4z0yD"),Eo=s("6hkW8"),ld=s("d6rwS");var fd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e||{})).supportsMasking=!0,r}return l.default(n,[{key:"mergeFunction",value:function(e){throw new Pi}},{key:"computeElementwiseOpOutputShape",value:function(e,t){if(null==e||null==t)return null;if(e.length<t.length)return this.computeElementwiseOpOutputShape(t,e);if(0===t.length)return e;for(var n=e.slice(0,e.length-t.length),r=0;r<t.length;++r){var a=e[e.length-t.length+r],i=t[r];if(null==a||null==i||a<0||i<0)n.push(null);else if(1===a)n.push(i);else if(1===i)n.push(a);else{if(a!==i)throw new Bi("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(t));n.push(a)}}return n}},{key:"build",value:function(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[rs(e)]),e.length<2)throw new Bi("A merge layer should be called on an Array of at least 2 inputs."+" Got ".concat(e.length," input(s)."));var t=[],n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;null!=u&&null!==u[0]&&t.push(u[0])}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if((t=Qi(t)).length>1)throw new Bi("Can not merge tensors with different batch sizes. "+"Got tensors with shapes: ".concat(JSON.stringify(e),"."));for(var s=null==e[0]?null:e[0].slice(1),c=1;c<e.length;++c){var l=null==e[c]?null:e[c].slice(1);s=this.computeElementwiseOpOutputShape(s,l)}var f=e.map((function(e){return e.length}));-1===e.indexOf(null)&&1===Qi(f).length?this.reshapeRequired=!1:this.reshapeRequired=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){if(n.reshapeRequired){var t=[],r=e.map((function(e){return e.rank}));if(-1===r.indexOf(null)){var a=uu(r),i=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){for(var l=s.value,f=l.rank,d=0;d<a-f;++d)l=lu(l,1);t.push(l)}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}return n.mergeFunction(t)}var p=!1,h=!0,v=!1,g=void 0;try{for(var m,y=e[Symbol.iterator]();!(h=(m=y.next()).done);h=!0){var x=m.value,b=x.rank;if(null==b){var k=x.shape,w=k[0],A=k.slice(1).concat([w]),E=x.reshape([w].concat(au(k.slice(1))));E=(E=st.transpose(E,[1,0])).reshape(A),t.push(E),p=!0}else if(b>1){var C=su(1,b).concat([0]);t.push(st.transpose(x,C)),p=!0}else t.push(x)}}catch(e){v=!0,g=e}finally{try{h||null==y.return||y.return()}finally{if(v)throw g}}var S=n.mergeFunction(t),N=S.rank;if(p)if(null==N){var T=S.shape,D=T[T.length-1],F=[D].concat(T.slice(0,T.length-1));S=st.transpose(S.reshape([-1,D]),[1,0]).reshape(F)}else if(N>1){var O=[N-1].concat(su(0,N-1));S=st.transpose(S,O)}return S}return n.mergeFunction(e)}))}},{key:"computeOutputShape",value:function(e){var t;t=null==e[0]?null:e[0].slice(1);for(var n=1;n<e.length;++n){var r=null==e[n]?null:e[n].slice(1);t=this.computeElementwiseOpOutputShape(t,r)}var a=[],i=!0,o=!1,u=void 0;try{for(var s,c=e[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;null!=l&&null!==l[0]&&a.push(l[0])}}catch(e){o=!0,u=e}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}return t=1===(a=Qi(a)).length?a.concat(t):[null].concat(t)}},{key:"computeMask",value:function(e,t){return m.tidy((function(){if(null==t)return null;if(!Array.isArray(t))throw new Bi("`mask` should be an Array");if(!Array.isArray(e))throw new Bi("`inputs` should be an Array");if(t.length!==e.length)throw new Bi("The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths "+"(".concat(e.length," vs ").concat(t.length,")"));if(t.every((function(e){return null==e})))return null;for(var n=(t=t.map((function(e){return null==e?e:If.expandDims(e,0)})))[0],r=1;r<t.length-1;++r)n=nc.logicalAnd(n,t[r]);return n}))}}]),n}(gs),dd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"mergeFunction",value:function(e){return m.tidy((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Ti.add(t,e[n]);return t}))}}]),n}(fd);dd.className="Add",Si.registerClass(dd);var pd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"mergeFunction",value:function(e){return m.tidy((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Ci.mul(t,e[n]);return t}))}}]),n}(fd);pd.className="Multiply",Si.registerClass(pd);var hd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"mergeFunction",value:function(e){return m.tidy((function(){for(var t=e[0].clone(),n=1;n<e.length;++n)t=Ti.add(t,e[n]);return Ci.mul(1/e.length,t)}))}}]),n}(fd);hd.className="Average",Si.registerClass(hd);var vd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"mergeFunction",value:function(e){return m.tidy((function(){for(var t=e[0],n=1;n<e.length;++n)t=Ls.maximum(t,e[n]);return t}))}}]),n}(fd);vd.className="Maximum",Si.registerClass(vd);var gd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"mergeFunction",value:function(e){return m.tidy((function(){for(var t=e[0],n=1;n<e.length;++n)t=Cl.minimum(t,e[n]);return t}))}}]),n}(fd);gd.className="Minimum",Si.registerClass(gd);var md=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).DEFAULT_AXIS=-1,null==e&&(e={}),r.axis=null==e.axis?r.DEFAULT_AXIS:e.axis,r.supportsMasking=!0,r.reshapeRequired=!1,r}return l.default(n,[{key:"build",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0])||1===e.length)throw new Bi("A `Concatenate` layer should be called on a list of at least 2 inputs");var t=!0,n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){if(null!=i.value){t=!1;break}}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}if(!t){for(var u=[],s=0;s<e.length;++s){var c=e[s].slice();c.splice(this.axis,1);var l=!1,f=!0,d=!1,p=void 0;try{for(var h,v=u[Symbol.iterator]();!(f=(h=v.next()).done);f=!0){var m=h.value;if(g.arraysEqual(m,c)){l=!0;break}}}catch(e){d=!0,p=e}finally{try{f||null==v.return||v.return()}finally{if(d)throw p}}l||u.push(c)}if(u.length>1)throw new Bi("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}}},{key:"mergeFunction",value:function(e){var t=this;return m.tidy((function(){return vu(e,t.axis)}))}},{key:"computeOutputShape",value:function(e){if(!Array.isArray(e)||!Array.isArray(e[0]))throw new Bi("A `Concatenate` layer should be called on a list of inputs.");var t=e,n=t[0].slice(),r=this.axis<0?n.length+this.axis:this.axis,a=!0,i=!1,o=void 0;try{for(var u,s=t.slice(1)[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;if(null==n[r]||null==c[r]){n[r]=null;break}n[r]+=c[r]}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return n}},{key:"computeMask",value:function(e,t){var n=this;if(null==t)return null;if(!Array.isArray(t))throw new Bi("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new Bi("`inputs` should be an array for Concatenate");if(t.length!==e.length)throw new Bi("Mismatch in the length of mask (".concat(t.length,") ")+"and the legnth of inputs (".concat(e.length,")"));return m.tidy((function(){var r=!0;if(t.forEach((function(e){null==e||(r=!1)})),r)return null;for(var a=[],i=0;i<e.length;++i)null==t[i]?a.push(Io.onesLike(e[i]).asType("bool")):t[i].rank<e[i].rank?a.push(If.expandDims(t[i],-1)):a.push(t[i]);var o=Eo.concat(a,n.axis);return ld.all(o,-1,!1)}))}},{key:"getConfig",value:function(){var e={axis:this.axis},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(fd);function yd(e,t){for(;e<0;)e+=t;return e}md.className="Concatenate",Si.registerClass(md);var xd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).axes=e.axes,r.normalize=null!=e.normalize&&e.normalize,r.supportsMasking=!0,r.reshapeRequired=!1,r}return l.default(n,[{key:"build",value:function(e){g.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0],n=e[1];if(t.length>3||n.length>3)throw new Pi("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);if(t[r[0]]!==n[r[1]])throw new Bi("Dimension incompatibility: "+"".concat(t[r[0]]," !== ").concat(n[r[1]]))}},{key:"mergeFunction",value:function(e){if(2!==e.length)throw new Bi("A `Dot` layer must be called on exactly 2 inputs, "+"but received ".concat(e.length," input(s)."));var t,n=e[0],r=e[1];return t=Array.isArray(this.axes)?this.axes.map((function(t,n){return yd(t,e[n].shape.length)})):[yd(this.axes,n.shape.length),yd(this.axes,r.shape.length)],this.normalize&&(n=Ws(n,t[0]),r=Ws(r,t[1])),function(e,t,n){if(e.shape.length>3||t.shape.length>3)throw new Pi("batchDot is not implemented for tensors of 4D or higher rank yet");if(g.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of x to be >= 2, "+"but got ".concat(e.shape.length)})),g.assert(e.shape.length>=2,(function(){return"batchDot requires the rank of y to be >= 2, "+"but got ".concat(t.shape.length)})),"number"==typeof n&&(n=[n,n]),"complex64"===e.dtype||"complex64"===t.dtype)throw new Pi("batchDot is not implemented for complex64-type Tensors yet.");var r=e.shape.length,a=t.shape.length;null==n&&(n=[r-1,a-2]);var i=n;return m.tidy((function(){var n,o;if(r>a){n=r-a;for(var u=[],s=0;s<n;++s)u.push(1);t=t.reshape(t.shape.concat(u))}else if(a>r){n=a-r;for(var c=[],l=0;l<n;++l)c.push(1);e=e.reshape(e.shape.concat(c))}else n=0;if(2===e.shape.length&&2===t.shape.length)o=i[0]===i[1]?e.mul(t).sum(i[0]):e.transpose([1,0]).mul(t).sum(i[1]);else{var f=i[0]!==e.shape.length-1,d=i[1]===t.shape.length-1;o=e.matMul(t,f,d)}if(n>0){for(var p,h=[],v=p=r>a?r+a-3:r-1;v<p+n;++v)h.push(v);o=o.squeeze(h)}return 1===o.shape.length&&(o=o.expandDims(1)),o}))}(n,r,t)}},{key:"interpretAxes",value:function(e,t){return Array.isArray(this.axes)?this.axes:[yd(this.axes,e.length),yd(this.axes,t.length)]}},{key:"computeOutputShape",value:function(e){g.assert(Array.isArray(e)&&2===e.length&&Array.isArray(e[0])&&Array.isArray(e[1]),(function(){return"A `Dot` layer should be called on a list of exactly 2 inputs."}));var t=e[0].slice(),n=e[1].slice();if(t.length>3||n.length>3)throw new Pi("Dot layer does not support tensors of 4D or higher rank yet.");var r=this.interpretAxes(t,n);t.splice(r[0],1),n.splice(r[1],1),n.splice(0,1);var a=t.concat(n);return 1===a.length&&a.push(1),a}},{key:"computeMask",value:function(e,t){return null}},{key:"getConfig",value:function(){var e={axes:this.axes,normalize:this.normalize},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(fd);xd.className="Dot",Si.registerClass(xd),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");m=s("P1tXK"),Si=s("6b8rQ");var bd=s("6Bgjr"),kd=(go=s("1GxQM"),function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).supportsMasking=!0,r.stddev=e.stddev,r}return l.default(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this),t={stddev:this.stddev};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r=n;n.invokeCallHook(e,t);var a=ns(e);return Su((function(){return yu(a.shape,0,r.stddev).add(a)}),(function(){return a}),t.training||!1)}))}}]),n}(gs));kd.className="GaussianNoise",Si.registerClass(kd);var wd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r}return l.default(n,[{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t);var r=ns(e);if(n.rate>0&&n.rate<1){var a=n;return Su((function(){var e=Math.sqrt(a.rate/(1-a.rate));return r.mul(yu(r.shape,1,e))}),(function(){return r}),t.training||!1)}return r}))}}]),n}(gs);wd.className="GaussianDropout",Si.registerClass(wd);var Ad=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).supportsMasking=!0,r.rate=e.rate,r.noiseShape=e.noiseShape,r}return l.default(n,[{key:"_getNoiseShape",value:function(e){return this.noiseShape||ns(e).shape}},{key:"computeOutputShape",value:function(e){return e}},{key:"getConfig",value:function(){var e=F.default(O.default(n.prototype),"getConfig",this).call(this),t={rate:this.rate};return Object.assign(t,e),t}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){if(n.rate<1&&n.rate>0){var r=n,a=n._getNoiseShape(e);return Su((function(){var t=ns(e),n=-1.7580993408473766,i=bd.greaterEqual(go.randomUniform(a),r.rate);i=cu(i,"float32");var o=Math.pow((1-r.rate)*(1+r.rate*Math.pow(n,2)),-.5),u=-o*n*r.rate;return t.mul(i).add(i.add(-1).mul(n)).mul(o).add(u)}),(function(){return ns(e)}),t.training||!1)}return e}))}}]),n}(gs);Ad.className="AlphaDropout",Si.registerClass(Ad),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),af=s("4Ui3v"),d=s("6vecG"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");var Ed=s("1wkm4"),Cd=s("7qMEf"),Sd=s("3bI6J"),Nd=(m=s("P1tXK"),s("bRIeS"));g=s("kglvN"),Si=s("6b8rQ");s("jbRpz");Ed=s("1wkm4"),Cd=s("7qMEf"),Sd=s("3bI6J"),m=s("P1tXK"),Nd=s("bRIeS"),g=s("kglvN"),Si=s("6b8rQ");function Td(e,t,n,r,a){var i,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.001;if(2===e.rank)i=Ed.batchNorm2d(e,t,n,r,a,o);else if(3===e.rank)i=Cd.batchNorm3d(e,t,n,r,a,o);else{if(4!==e.rank)throw new Pi("batchNormalization is not implemented for array of rank ".concat(e.rank," ")+"yet");i=Sd.batchNorm4d(e,t,n,r,a,o)}return i}function Dd(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return m.tidy((function(){var i=Nd.moments(e,r),o=i.mean,u=i.variance;return[Td(e,o,u,n,t,a),o,u]}))}function Fd(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return m.tidy((function(){var i=Nd.moments(e,r),o=i.mean,u=i.variance,s=[],c=!0,l=!1,f=void 0;try{for(var d,p=su(0,e.rank)[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;-1!==r.indexOf(h)?s.push(1):s.push(e.shape[h])}}catch(e){l=!0,f=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}var v=o.reshape(s),g=u.reshape(s),m=null==t?null:t.reshape(s),y=null==n?null:n.reshape(s);return[Td(e,v,g,y,m,a),o,u]}))}var Od=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),null==e&&(e={}),(r=t.call(this,e)).supportsMasking=!0,r.axis=null==e.axis?-1:e.axis,r.momentum=null==e.momentum?.99:e.momentum,r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Ku(e.betaInitializer||"zeros"),r.gammaInitializer=Ku(e.gammaInitializer||"ones"),r.movingMeanInitializer=Ku(e.movingMeanInitializer||"zeros"),r.movingVarianceInitializer=Ku(e.movingVarianceInitializer||"ones"),r.betaConstraint=ho(e.betaConstraint),r.gammaConstraint=ho(e.gammaConstraint),r.betaRegularizer=Ql(e.betaRegularizer),r.gammaRegularizer=Ql(e.gammaRegularizer),r}return l.default(n,[{key:"build",value:function(e){e=rs(e);var t=this.axis>=0?this.axis:this.axis+e.length,n=e[t];if(null==n)throw new Bi("Axis ".concat(t," of input tensor should have a defined dimension but ")+"the layer received an input with shape "+"".concat(JSON.stringify(e),"."));this.inputSpec=[new fs({ndim:e.length,axes:af.default({},t,n)})];var r=[n];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r=n,a=null!=t.training&&t.training,i=ns(e),o=i.shape,u=o.length,s=su(0,u),c=n.axis>=0?n.axis:n.axis+u;s.splice(c,1);var l=ji(1,u);l[c]=o[c];var f=s.slice();f.sort();var p=!g.arraysEqual(f,su(0,u).slice(0,u-1));if(!a)return function(){if(p){var e=r.movingMean.read().reshape(l),t=r.movingVariance.read().reshape(l),n=r.center?r.beta.read().reshape(l):null,a=r.scale?r.gamma.read().reshape(l):null;return Td(i,e,t,n,a,r.epsilon)}return Td(i,r.movingMean.read(),r.movingVariance.read(),null==r.beta?null:r.beta.read(),null==r.gamma?null:r.gamma.read(),r.epsilon)}();var h=d.default(function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.001;return g.arraysEqual(r.slice().sort(),su(0,e.rank-1))?Dd(e,t,n,r,a):Fd(e,t,n,r,a)}(i,n.gamma.read(),n.beta.read(),s,n.epsilon),3),v=h[0],y=h[1],x=h[2],b=function(e,t,n){m.tidy((function(){var r=1-n,a=e.read(),i=a.sub(t).mul(r);e.write(a.sub(i))}))};return b(r.movingMean,y,r.momentum),b(r.movingVariance,x,r.momentum),v}))}},{key:"getConfig",value:function(){var e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ju(this.betaInitializer),gammaInitializer:Ju(this.gammaInitializer),movingMeanInitializer:Ju(this.movingMeanInitializer),movingVarianceInitializer:Ju(this.movingVarianceInitializer),betaRegularizer:Xl(this.betaRegularizer),gammaRegularizer:Xl(this.gammaRegularizer),betaConstraint:fo(this.betaConstraint),gammaConstraint:fo(this.gammaConstraint)},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);Od.className="BatchNormalization",Si.registerClass(Od);var _d=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;c.default(this,n),null==e&&(e={}),(r=t.call(this,e)).axis=null==e.axis?-1:e.axis;var a=!0,i=!1,o=void 0;if("number"==typeof r.axis){if(!Number.isInteger(r.axis))throw new Error("Expected axis to be an integer, but received ".concat(r.axis))}else{if(!Array.isArray(r.axis))throw new Error("Expected axis to be an integer or an array of integers, "+"but received ".concat(JSON.stringify(r.axis)));try{for(var u,s=r.axis[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var l=u.value;if(!Number.isInteger(l))throw new Error("Expected axis to be an array of integers, "+"but received ".concat(JSON.stringify(r.axis)))}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}}return r.epsilon=null==e.epsilon?.001:e.epsilon,r.center=null==e.center||e.center,r.scale=null==e.scale||e.scale,r.betaInitializer=Ku(e.betaInitializer||"zeros"),r.gammaInitializer=Ku(e.gammaInitializer||"ones"),r.betaRegularizer=Ql(e.betaRegularizer),r.gammaRegularizer=Ql(e.gammaRegularizer),r.supportsMasking=!0,r}return l.default(n,[{key:"build",value:function(e){var t=(e=rs(e)).length;"number"==typeof this.axis&&(this.axis=[this.axis]);for(var n=0;n<this.axis.length;++n)this.axis[n]<0&&(this.axis[n]+=t);var r=!0,a=!1,i=void 0;try{for(var o,u=this.axis[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;if(s<0||s>=t)throw new Error("Invalid axis: ".concat(s))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}if(this.axis.length!==Qi(this.axis).length)throw new Error("Found duplicate axes in: ".concat(this.axis));var c=this.axis.map((function(t){return e[t]}));this.scale?this.gamma=this.addWeight("gamma",c,"float32",this.gammaInitializer,this.gammaRegularizer,true):this.gamma=null,this.center?this.beta=this.addWeight("beta",c,"float32",this.betaInitializer,this.betaRegularizer,true):this.beta=null,this.built=!0}},{key:"call",value:function(e,t){var n=this,r=ns(e),a=r.shape,i=a.length;return m.tidy((function(){var e=n,t=Nd.moments(r,n.axis,!0),o=t.mean,u=t.variance,s=ji(1,i),c=!0,l=!1,f=void 0;try{for(var d,p=n.axis[Symbol.iterator]();!(c=(d=p.next()).done);c=!0){var h=d.value;s[h]=a[h]}}catch(e){l=!0,f=e}finally{try{c||null==p.return||p.return()}finally{if(l)throw f}}for(var v=function(t){return null!=t&&t.shape.length!==i&&e.axis!==[i-1]?t.reshape(s):t},g=v(n.gamma.read()),m=v(n.beta.read()),y=[],x=[],b=0;b<i;++b)-1!==n.axis.indexOf(b)?(y.push(a[b]),x.push(1)):(y.push(1),x.push(a[b]));return o=o.tile(y),u=u.tile(y),g=g.tile(x),m=m.tile(x),Td(r,o,u,m,g,n.epsilon)}))}},{key:"getConfig",value:function(){var e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Ju(this.betaInitializer),gammaInitializer:Ju(this.gammaInitializer),betaRegularizer:Xl(this.betaRegularizer),gammaRegularizer:Xl(this.gammaRegularizer)},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);_d.className="LayerNormalization",Si.registerClass(_d),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");m=s("P1tXK");var Id=s("elYe2");Si=s("6b8rQ");s("jbRpz");m=s("P1tXK"),Id=s("elYe2"),Si=s("6b8rQ");var Rd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),null==e&&(e={}),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,null==e.padding)r.padding=[[1,1],[1,1]];else if("number"==typeof e.padding)r.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,2!==e.padding.length)throw new Bi("ZeroPadding2D expects padding to be a length-2 array, but "+"received a length-".concat(e.padding.length," array."));var a,i;if("number"==typeof e.padding[0])a=[e.padding[0],e.padding[0]],i=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,2!==e.padding[0].length)throw new Bi("ZeroPadding2D expects height padding to be a length-2 array, "+"but received a length-".concat(e.padding[0].length," array."));if(a=e.padding[0],2!==e.padding[1].length)throw new Bi("ZeroPadding2D expects width padding to be a length-2 array, "+"but received a length-".concat(e.padding[1].length," array."));i=e.padding[1]}r.padding=[a,i]}return r.inputSpec=[new fs({ndim:4})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){var t,n;return e=rs(e),"channelsFirst"===this.dataFormat?(t=null!=e[2]&&e[2]>=0?e[2]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[3]&&e[3]>=0?e[3]+this.padding[1][0]+this.padding[1][1]:null,[e[0],e[1],t,n]):(t=null!=e[1]&&e[1]>=0?e[1]+this.padding[0][0]+this.padding[0][1]:null,n=null!=e[2]&&e[2]>=0?e[2]+this.padding[1][0]+this.padding[1][1]:null,[e[0],t,n,e[3]])}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){return function(e,t,n){return m.tidy((function(){if(4!==e.rank)throw new Bi("temporalPadding expects input tensor to be 4-D, but received a "+"".concat(e.rank,"-D tensor."));if(null==t&&(t=[[1,1],[1,1]]),2!==t.length||2!==t[0].length||2!==t[1].length)throw new Bi("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(null==n&&(n="channelsLast"),"channelsLast"!==n&&"channelsFirst"!==n)throw new Bi("Unknown data format: ".concat(n,". ")+"Supported data formats are 'channelsLast' and 'channelsFirst.");var r;return r="channelsFirst"===n?[[0,0],[0,0],t[0],t[1]]:[[0,0],t[0],t[1],[0,0]],Id.pad(e,r)}))}(ns(e),n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={padding:this.padding,dataFormat:this.dataFormat},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs);Rd.className="ZeroPadding2D",Si.registerClass(Rd),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O");s("jbRpz");m=s("P1tXK");var Md=s("2dPgQ"),Bd=s("WcUsE"),Pd=(st=s("9PS5J"),s("181UU")),Ld=s("4laI6"),jd=s("4y8cw");Si=s("6b8rQ"),Rs=s("4804C"),at=s("avJI0");s("jbRpz");m=s("P1tXK"),Md=s("2dPgQ"),Bd=s("WcUsE"),st=s("9PS5J"),Pd=s("181UU"),Ld=s("4laI6"),jd=s("4y8cw"),Si=s("6b8rQ"),Rs=s("4804C"),at=s("avJI0");function zd(e,t,n,r,a,i){return m.tidy((function(){var o;qo(a),Ko(i),Jo(r),null==n&&(n=[1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=pf(e,a);var u="same"===r?"same":"valid";return o="max"===i?Md.maxPool(e,t,n,u):Bd.avgPool(e,t,n,u),"channelsFirst"===a&&(o=st.transpose(o,[0,3,1,2])),o}))}function Ud(e,t,n,r,a,i){return m.tidy((function(){var o;qo(a),Ko(i),Jo(r),null==n&&(n=[1,1,1]),null==r&&(r="valid"),null==a&&(a="channelsLast"),null==i&&(i="max"),e=hf(e,a);var u="same"===r?"same":"valid";return o="max"===i?Pd.maxPool3d(e,t,n,u):Ld.avgPool3d(e,t,n,u),"channelsFirst"===a&&(o=st.transpose(o,[0,4,1,2,3])),o}))}var Vd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),null==e.poolSize&&(e.poolSize=2),r=t.call(this,e),"number"==typeof e.poolSize)r.poolSize=[e.poolSize];else{if(!Array.isArray(e.poolSize)||1!==e.poolSize.length||"number"!=typeof e.poolSize[0])throw new Bi("poolSize for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.poolSize)));r.poolSize=e.poolSize}if(to(r.poolSize,"poolSize"),null==e.strides)r.strides=r.poolSize;else if("number"==typeof e.strides)r.strides=[e.strides];else{if(!Array.isArray(e.strides)||1!==e.strides.length||"number"!=typeof e.strides[0])throw new Bi("strides for 1D convolutional layer must be a number or an Array of a single number, but received "+"".concat(JSON.stringify(e.strides)));r.strides=e.strides}return to(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,Jo(r.padding),r.inputSpec=[new fs({ndim:3})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){var t=ff((e=rs(e))[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],t,e[2]]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){n.invokeCallHook(e,t),e=lu(ns(e),2);var r=n.poolingFunction(ns(e),[n.poolSize[0],1],[n.strides[0],1],n.padding,"channelsLast");return jd.squeeze(r,[2])}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs),Wd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return qo(a),Jo(r),zd(e,t,n,r,a,"max")}}]),n}(Vd);Wd.className="MaxPooling1D",Si.registerClass(Wd);var Gd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return qo(a),Jo(r),zd(e,t,n,r,a,"avg")}}]),n}(Vd);Gd.className="AveragePooling1D",Si.registerClass(Gd);var Hd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),null==e.poolSize&&(e.poolSize=[2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(2!==e.strides.length)throw new Bi("If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides];return to(r.poolSize,"poolSize"),to(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,qo(r.dataFormat),Jo(r.padding),r.inputSpec=[new fs({ndim:4})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){e=rs(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2];return t=ff(t,this.poolSize[0],this.padding,this.strides[0]),n=ff(n,this.poolSize[1],this.padding,this.strides[1]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n]:[e[0],t,n,e[3]]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){return n.invokeCallHook(e,t),n.poolingFunction(ns(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs),qd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return qo(a),Jo(r),zd(e,t,n,r,a,"max")}}]),n}(Hd);qd.className="MaxPooling2D",Si.registerClass(qd);var Jd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return qo(a),Jo(r),zd(e,t,n,r,a,"avg")}}]),n}(Hd);Jd.className="AveragePooling2D",Si.registerClass(Jd);var Kd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;if(c.default(this,n),null==e.poolSize&&(e.poolSize=[2,2,2]),(r=t.call(this,e)).poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],null==e.strides)r.strides=r.poolSize;else if(Array.isArray(e.strides)){if(3!==e.strides.length)throw new Bi("If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length "+"".concat(e.strides.length,"."));r.strides=e.strides}else r.strides=[e.strides,e.strides,e.strides];return to(r.poolSize,"poolSize"),to(r.strides,"strides"),r.padding=null==e.padding?"valid":e.padding,r.dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,qo(r.dataFormat),Jo(r.padding),r.inputSpec=[new fs({ndim:5})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){e=rs(e);var t="channelsFirst"===this.dataFormat?e[2]:e[1],n="channelsFirst"===this.dataFormat?e[3]:e[2],r="channelsFirst"===this.dataFormat?e[4]:e[3];return t=ff(t,this.poolSize[0],this.padding,this.strides[0]),n=ff(n,this.poolSize[1],this.padding,this.strides[1]),r=ff(r,this.poolSize[2],this.padding,this.strides[2]),"channelsFirst"===this.dataFormat?[e[0],e[1],t,n,r]:[e[0],t,n,r,e[4]]}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){return n.invokeCallHook(e,t),n.poolingFunction(ns(e),n.poolSize,n.strides,n.padding,n.dataFormat)}))}},{key:"getConfig",value:function(){var e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs),Xd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return qo(a),Jo(r),Ud(e,t,n,r,a,"max")}}]),n}(Kd);Xd.className="MaxPooling3D",Si.registerClass(Xd);var Yd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e)}return l.default(n,[{key:"poolingFunction",value:function(e,t,n,r,a){return qo(a),Jo(r),Ud(e,t,n,r,a,"avg")}}]),n}(Kd);Yd.className="AveragePooling3D",Si.registerClass(Yd);var Qd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).inputSpec=[new fs({ndim:3})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){return[e[0],e[2]]}},{key:"call",value:function(e,t){throw new Pi}}]),n}(gs),Zd=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e||{})}return l.default(n,[{key:"call",value:function(e,t){return m.tidy((function(){var t=ns(e);return Rs.mean(t,1)}))}}]),n}(Qd);Zd.className="GlobalAveragePooling1D",Si.registerClass(Zd);var $d=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){return c.default(this,n),t.call(this,e||{})}return l.default(n,[{key:"call",value:function(e,t){return m.tidy((function(){var t=ns(e);return at.max(t,1)}))}}]),n}(Qd);$d.className="GlobalMaxPooling1D",Si.registerClass($d);var ep=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).dataFormat=null==e.dataFormat?"channelsLast":e.dataFormat,qo(r.dataFormat),r.inputSpec=[new fs({ndim:4})],r}return l.default(n,[{key:"computeOutputShape",value:function(e){return"channelsLast"===this.dataFormat?[e[0],e[3]]:[e[0],e[1]]}},{key:"call",value:function(e,t){throw new Pi}},{key:"getConfig",value:function(){var e={dataFormat:this.dataFormat},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}]),n}(gs),tp=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t=ns(e);return"channelsLast"===n.dataFormat?Rs.mean(t,[1,2]):Rs.mean(t,[2,3])}))}}]),n}(ep);tp.className="GlobalAveragePooling2D",Si.registerClass(tp);var np=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var t=ns(e);return"channelsLast"===n.dataFormat?at.max(t,[1,2]):at.max(t,[2,3])}))}}]),n}(ep);np.className="GlobalMaxPooling2D",Si.registerClass(np),s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),F=s("kRKWT"),O=s("eYQ8O"),Pe=s("9M1dW");s("jbRpz");m=s("P1tXK"),Si=s("6b8rQ"),Rf=s("hYjAM"),Ti=s("b3Qcj"),Ci=s("j0e1k");s("jbRpz");m=s("P1tXK"),Si=s("6b8rQ"),Rf=s("hYjAM"),Ti=s("b3Qcj"),Ci=s("j0e1k");var rp=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).layer=e.layer,r}return l.default(n,[{key:"build",value:function(e){this.built=!0}},{key:"trainable",get:function(){return null!=this.layer&&this.layer.trainable},set:function(e){null!=this.layer&&(this.layer.trainable=e)}},{key:"trainableWeights",get:function(){return this.layer.trainableWeights}},{key:"nonTrainableWeights",get:function(){return this.layer.nonTrainableWeights}},{key:"updates",get:function(){return this.layer._updates}},{key:"losses",get:function(){return this.layer.losses}},{key:"getWeights",value:function(){return this.layer.getWeights()}},{key:"setWeights",value:function(e){this.layer.setWeights(e)}},{key:"getConfig",value:function(){var e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}},{key:"setFastWeightInitDuringBuild",value:function(e){F.default(O.default(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.layer&&this.layer.setFastWeightInitDuringBuild(e)}}],[{key:"fromConfig",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=t.layer,a=Bs(r,n);delete t.layer;var i={layer:a};return Object.assign(i,t),new e(i)}}]),n}(gs),ap=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;return c.default(this,n),(r=t.call(this,e)).supportsMasking=!0,r}return l.default(n,[{key:"build",value:function(e){if((e=rs(e)).length<3)throw new Bi("TimeDistributed layer expects an input shape >= 3D, but received "+"input shape ".concat(JSON.stringify(e)));this.inputSpec=[{shape:e}];var t=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(t),this.layer.built=!0),F.default(O.default(n.prototype),"build",this).call(this,e)}},{key:"computeOutputShape",value:function(e){var t=[(e=rs(e))[0]].concat(e.slice(2)),n=this.layer.computeOutputShape(t),r=e[1];return[n[0],r].concat(n.slice(1))}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r=n;return Pf((function(e,n){return[ns(r.layer.call(e,t)),[]]}),e=ns(e),[],!1,null,null,!1,!0)[1]}))}}]),n}(rp);ap.className="TimeDistributed",Si.registerClass(ap);var ip=function(e){"use strict";p.default(n,e);var t=h.default(n);function n(e){var r;c.default(this,n),r=t.call(this,e);var a=e.layer.getConfig(),i={};i.className=e.layer.getClassName(),i.config=a,r.forwardLayer=Bs(i),a.goBackwards=!0!==a.goBackwards;var o={};if(o.className=e.layer.getClassName(),o.config=a,r.backwardLayer=Bs(o),r.forwardLayer.name="forward_"+r.forwardLayer.name,r.backwardLayer.name="backward_"+r.backwardLayer.name,r.mergeMode=void 0===e.mergeMode?"concat":e.mergeMode,function(e){$i(Go,"BidirectionalMergeMode",e)}(r.mergeMode),e.weights)throw new Pi("weights support is not implemented for Bidirectional layer yet.");return r._stateful=e.layer.stateful,r.returnSequences=e.layer.returnSequences,r.returnState=e.layer.returnState,r.supportsMasking=!0,r._trainable=!0,r.inputSpec=e.layer.inputSpec,r.numConstants=null,r}return l.default(n,[{key:"trainable",get:function(){return this._trainable},set:function(e){this._trainable=e,null!=this.forwardLayer&&(this.forwardLayer.trainable=e),null!=this.backwardLayer&&(this.backwardLayer.trainable=e)}},{key:"getWeights",value:function(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}},{key:"setWeights",value:function(e){var t=e.length,n=Math.floor(t/2);this.forwardLayer.setWeights(e.slice(0,n)),this.backwardLayer.setWeights(e.slice(n))}},{key:"computeOutputShape",value:function(e){var t,n,r,a=this.forwardLayer.computeOutputShape(e);return Array.isArray(a)&&Array.isArray(a[0])||(a=[a]),this.returnState?(r=a.slice(1),t=a[0]):t=a[0],"concat"===this.mergeMode?(t[t.length-1]*=2,n=[t]):n=null==this.mergeMode?[t,t.slice()]:[t],this.returnState?null==this.mergeMode?n.concat(r).concat(r.slice()):[t].concat(r).concat(r.slice()):Vi(n)}},{key:"apply",value:function(e,t){var r=null==t?null:t.initialState,a=null==t?null:t.constants;null==t&&(t={});var i=Bf(e,r,a,this.numConstants);if(e=i.inputs,r=i.initialState,a=i.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(null==r||0===r.length)&&null==a)return F.default(O.default(n.prototype),"apply",this).call(this,e,t);var o=[],u=[];if(null!=r){var s,c,l=r.length;if(l%2>0)throw new Bi("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");t.initialState=r,(s=o).push.apply(s,Pe.default(r));var f=r.map((function(e){return new fs({shape:e.shape})}));this.forwardLayer.stateSpec=f.slice(0,l/2),this.backwardLayer.stateSpec=f.slice(l/2),(c=u).push.apply(c,Pe.default(f))}if(null!=a)throw new Pi("Support for constants in Bidirectional layers is not implemented yet.");var d=o[0]instanceof ds,p=!0,h=!1,v=void 0;try{for(var g,m=o[Symbol.iterator]();!(p=(g=m.next()).done);p=!0){if(g.value instanceof ds!==d)throw new Bi("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors")}}catch(e){h=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(h)throw v}}if(d){var y=[e].concat(o),x=this.inputSpec.concat(u),b=this.inputSpec;this.inputSpec=x;var k=F.default(O.default(n.prototype),"apply",this).call(this,y,t);return this.inputSpec=b,k}return F.default(O.default(n.prototype),"apply",this).call(this,e,t)}},{key:"call",value:function(e,t){var n=this;return m.tidy((function(){var r,a,i,o,u=t.initialState;if(null==u)r=n.forwardLayer.call(e,t),a=n.backwardLayer.call(e,t);else{var s=u.slice(0,u.length/2),c=u.slice(u.length/2);r=n.forwardLayer.call(e,Object.assign(t,{initialState:s})),a=n.backwardLayer.call(e,Object.assign(t,{initialState:c}))}return n.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),n.returnSequences&&(a=Rf.reverse(a,1)),"concat"===n.mergeMode?o=vu([r,a]):"sum"===n.mergeMode?o=Ti.add(r,a):"ave"===n.mergeMode?o=Ci.mul(.5,Ti.add(r,a)):"mul"===n.mergeMode?o=Ci.mul(r,a):null==n.mergeMode&&(o=[r,a]),n.returnState?null==n.mergeMode?o.concat(i):[o].concat(i):o}))}},{key:"resetStates",value:function(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}},{key:"build",value:function(e){var t=this;Yo(this.forwardLayer.name,(function(){t.forwardLayer.build(e)})),Yo(this.backwardLayer.name,(function(){t.backwardLayer.build(e)})),this.built=!0}},{key:"computeMask",value:function(e,t){var n;if(Array.isArray(t)&&(t=t[0]),n=this.returnSequences?null==this.mergeMode?[t,t]:t:null==this.mergeMode?[null,null]:null,this.returnState){var r=this.forwardLayer.states.map((function(e){return null}));return Array.isArray(n)?n.concat(r).concat(r):[n].concat(r).concat(r)}return n}},{key:"trainableWeights",get:function(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}},{key:"nonTrainableWeights",get:function(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}},{key:"setFastWeightInitDuringBuild",value:function(e){F.default(O.default(n.prototype),"setFastWeightInitDuringBuild",this).call(this,e),null!=this.forwardLayer&&this.forwardLayer.setFastWeightInitDuringBuild(e),null!=this.backwardLayer&&this.backwardLayer.setFastWeightInitDuringBuild(e)}},{key:"getConfig",value:function(){var e={mergeMode:this.mergeMode},t=F.default(O.default(n.prototype),"getConfig",this).call(this);return Object.assign(e,t),e}}],[{key:"fromConfig",value:function(e,t){var n=Bs(t.layer);if(delete t.layer,null!=t.numConstants)throw new Pi("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");var r=t;return r.layer=n,new e(r)}}]),n}(rp);function op(e){return new ys(e)}function up(e){return new tf(e)}function sp(e){return new Zl(e)}function cp(e){return new $l(e)}function lp(e){return new ef(e)}function fp(e){return new rf(e)}function dp(e){return new nf(e)}function pp(e){return new Cf(e)}function hp(e){return new bf(e)}function vp(e){return new wf(e)}function gp(e){return new kf(e)}function mp(e){return new Ef(e)}function yp(e){return new Sf(e)}function xp(e){return new Nf(e)}function bp(e){return new Df(e)}function kp(e){return new ad(e)}function wp(e){return new nd(e)}function Ap(e){return new ed(e)}function Ep(e){return new td(e)}function Cp(e){return new rd(e)}function Sp(e){return new id(e)}function Np(e){return new od(e)}function Tp(e){return new ud(e)}function Dp(e){return new cd(e)}function Fp(e){return new dd(e)}function Op(e){return new hd(e)}function _p(e){return new md(e)}function Ip(e){return new vd(e)}function Rp(e){return new gd(e)}function Mp(e){return new pd(e)}function Bp(e){return new xd(e)}function Pp(e){return new Od(e)}function Lp(e){return new _d(e)}function jp(e){return new Rd(e)}function zp(e){return new Gd(e)}function Up(e){return zp(e)}function Vp(e){return zp(e)}function Wp(e){return new Jd(e)}function Gp(e){return Wp(e)}function Hp(e){return Wp(e)}function qp(e){return new Yd(e)}function Jp(e){return qp(e)}function Kp(e){return qp(e)}function Xp(e){return new Zd(e)}function Yp(e){return new tp(e)}function Qp(e){return new $d(e)}function Zp(e){return new np(e)}function $p(e){return new Wd(e)}function eh(e){return new qd(e)}function th(e){return new Xd(e)}function nh(e){return new Wf(e)}function rh(e){return new Vf(e)}function ah(e){return new Hf(e)}function ih(e){return new Gf(e)}function oh(e){return new Uf(e)}function uh(e){return new zf(e)}function sh(e){return new Ff.ConvLSTM2D(e)}function ch(e){return new Ff.ConvLSTM2DCell(e)}function lh(e){return new Lf(e)}function fh(e){return new qf(e)}function dh(e){return new ip(e)}function ph(e){return new ap(e)}ip.className="Bidirectional",Si.registerClass(ip);var hh=Qp,vh=Zp,gh=$p,mh=eh;function yh(e){return new kd(e)}function xh(e){return new wd(e)}function bh(e){return new Ad(e)}function kh(e){return new sd(e)}s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");Ms=s("j8KB3"),y=s("4JvjV");s("1i51P");c=s("3QOYJ"),Pe=s("9M1dW"),l=s("2tuUj"),d=s("6vecG");s("jbRpz");var wh,Ah;re=s("lU3MY");!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(wh||(wh={})),function(e){var t;(t=e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))[t.LEGACY=0]="LEGACY",t[t.V1=1]="V1",t[t.V2=2]="V2"}(Ah||(Ah={}));s("1i51P");d=s("6vecG");s("jbRpz");g=s("kglvN");var Eh=s("dOUsY");function Ch(e,t,n,r){var a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){var i=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?i+1:a.inputIndexEnd;if("tensor"===a.type)return Sh(t.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return t.inputNames.slice(i,o).map((function(e){return Sh(e,n,r)}));var u=Sh(t.inputNames.slice(i)[0],n,r),s=u.dataSync();return"number"===a.type?s[0]:g.toNestedArray(u.shape,s)}var c=t.attrParams[e];return c&&c.value}function Sh(e,t,n){var r=d.default(Th(e),2),a=r[0],i=r[1],o=n.currentContextIds.find((function(e){return!!t[Nh(a,e)]}));return void 0!==o?t[Nh(a,o)][i]:void 0}function Nh(e,t){return t?"".concat(e,"-").concat(t):e}function Th(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function Dh(e){return e.kept?e:Eh.clone(e)}var Fh={};n(Fh,"json",(function(){return Oh}));var Oh=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],_h={};n(_h,"json",(function(){return Ih}));var Ih=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Rh={};n(Rh,"json",(function(){return Mh}));var Mh=[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}],Bh={};n(Bh,"json",(function(){return Ph}));var Ph=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],Lh={};n(Lh,"json",(function(){return jh}));var jh=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],zh={};n(zh,"json",(function(){return Uh}));var Uh=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Vh={};n(Vh,"json",(function(){return Wh}));var Wh=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}],Gh={};n(Gh,"json",(function(){return Hh}));var Hh=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],qh={};n(qh,"json",(function(){return Jh}));var Jh=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}],Kh={};n(Kh,"json",(function(){return Xh}));var Xh=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Yh={};n(Yh,"json",(function(){return Qh}));var Qh=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],Zh={};n(Zh,"json",(function(){return $h}));var $h=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],ev={};n(ev,"json",(function(){return tv}));var tv=[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],nv={};n(nv,"json",(function(){return rv}));var rv=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],av={};n(av,"json",(function(){return iv}));var iv=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],ov={};n(ov,"json",(function(){return uv}));var uv=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}];s("1mtJC").Buffer;s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),Pe=s("9M1dW"),d=s("6vecG"),f=s("e3nFV"),v=s("40Zzs");s("jbRpz");m=s("P1tXK"),g=s("kglvN");s("jbRpz");m=s("P1tXK");s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),Ti=s("b3Qcj"),s("1XItt"),s("hQKIK"),Ci=s("j0e1k"),it=s("6baO0"),s("1DCIn"),s("cisxn"),nu=s("fZE7S"),Cl=s("eu81x"),Ls=s("k7Du7"),s("WvbbQ"),s("lfNC8"),jo=s("3gUC5"),s("4JdlT"),s("deh8x"),s("6jOGJ"),s("ilRXh"),s("1KNQy"),s("hL6PI"),s("9MsjU"),s("fecqZ"),tt=s("3IcUj"),s("9D7bL"),s("hmI2F"),Lo=s("gGOj0"),s("c5hEb"),s("byJMV"),s("lX82t"),Vs=s("ksyR5"),js=s("WSSiT"),s("3rEkq"),et=s("hXj3N"),Us=s("ee0Eu"),s("1FDpf"),$e=s("2acG6"),Di=s("2MKa7"),s("8Irjk"),El=s("lKM5m"),Sl=s("5uQwR"),s("hHkhi"),s("d10y4"),s("kPryz"),zs=s("eQuwX"),Ai=s("buy0T");var sv=s("4C8ia");Nl=s("lzRoG"),s("jc2CK"),Ni=s("djUTy"),s("giife"),s("iGcXf"),wl=s("1LZgP"),Al=s("9JCtR");s("1i51P");f=s("e3nFV"),v=s("40Zzs");s("jbRpz");nt=s("bftEy");s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),Pe=s("9M1dW");s("jbRpz");nt=s("bftEy"),m=s("P1tXK"),b=s("616DT"),x=s("biSQf"),Eo=s("6hkW8"),Mf=s("6jWCC"),Er=s("gldWN"),Ao=s("jPaTA");s("jbRpz");g=s("kglvN");function cv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";g.assert(lv(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function lv(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0}var fv=function(){"use strict";function e(t,n,r,a,i,o,u){c.default(this,e),this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=nt.scalar(0),m.keep(this.idTensor)}return l.default(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),cv(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,m.keep(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return b.tensor([],[0].concat(this.elementShape));var r=this.readMany(e);return cv(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),x.stack(r,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return b.tensor([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return cv(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(r[0].shape,")")),Eo.concat(r,0)}},{key:"scatter",value:function(e,t){var n;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var r=(n=Math).max.apply(n,Pe.default(e));if(!this.dynamicSize&&r>=this.maxSize)throw new Error("Max index must be < array size (".concat(r,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Mf.unstack(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];m.tidy((function(){t=Er.reshape(t,[1,r,i]);for(var u=0;u<e.length;++u){var s=[0,0===u?0:a[u-1],0],c=[1,e[u],i];o[u]=Er.reshape(Ao.slice(t,s,c),n.elementShape)}return o}));for(var u=[],s=0;s<e.length;s++)u[s]=s;this.writeMany(u,o)}}]),e}();s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),Pe=s("9M1dW");s("jbRpz");m=s("P1tXK"),nt=s("bftEy"),Er=s("gldWN"),x=s("biSQf"),b=s("616DT"),Eo=s("6hkW8"),Mf=s("6jWCC"),Ao=s("jPaTA");var dv=function(){"use strict";function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;c.default(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=r,null!=t&&t.forEach((function(e){if(r!==e.dtype)throw new Error("Invalid data types; op elements ".concat(r,", but list elements ").concat(e.dtype));cv(n,e.shape,"TensorList shape mismatch: "),m.keep(e)})),this.idTensor=nt.scalar(0),this.maxNumElements=a,m.keep(this.idTensor)}return l.default(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(Pe.default(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==n&&this.tensors.length!==n)throw new Error("Operation expected a list with ".concat(n," elements but got a list with ").concat(this.tensors.length," elements."));return cv(e,this.elementShape,"TensorList shape mismatch: "),m.tidy((function(){var t=r.tensors.map((function(t){return Er.reshape(t,e)}));return x.stack(t,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=this.tensors.pop();return cv(n.shape,e,"TensorList shape mismatch: "),Er.reshape(n,e)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(cv(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");m.keep(e),this.tensors.push(e)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=e}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));return cv(this.tensors[e].shape,t,"TensorList shape mismatch: "),this.tensors[e]}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));cv(this.elementShape,t.shape,"TensorList shape mismatch: "),m.keep(t),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var r=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));return cv(this.elementShape,n,"TensorList shape mismatch: "),0===(e=e.slice(0,this.size())).length?b.tensor([],[0].concat(this.elementShape)):m.tidy((function(){var t=r,a=e.map((function(e){return Er.reshape(t.tensors[e],n)}));return x.stack(a,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));return cv(this.elementShape,t,"TensorList shape mismatch: "),0===this.size()?b.tensor([],[0].concat(this.elementShape)):m.tidy((function(){var e=n.tensors.map((function(e){return Er.reshape(e,t)}));return Eo.concat(e,0)}))}}]),e}();function pv(e,t,n){var r=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));cv(e.shape.slice(1),t,"TensorList shape mismatch: ");var a=Mf.unstack(e);return new dv(a,t,r)}function hv(e,t,n){return new dv([],e,t,n)}function vv(e,t,n,r){var a;if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var i=(a=Math).max.apply(a,Pe.default(t));if(null!=r&&-1!==r&&i>=r)throw new Error("Max index must be < array size (".concat(i,"  vs. ").concat(r,")"));var o=new dv([],n,e.dtype,r),u=Mf.unstack(e,0);return t.forEach((function(e,t){o.setItem(e,u[t])})),o}function gv(e,t,n){var r=0,a=t.map((function(e){return r+=e}));if(r!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(r,", and tensor's shape is: ").concat(e.shape));for(var i=0===r?0:e.size/r,o=m.tidy((function(){var o=[];e=Er.reshape(e,[1,r,i]);for(var u=0;u<t.length;++u){var s=[0,0===u?0:a[u-1],0],c=[1,t[u],i];o[u]=Er.reshape(Ao.slice(e,s,c),n)}return e.dispose(),o})),u=new dv([],n,e.dtype,t.length),s=0;s<o.length;s++)u.setItem(s,o[s]);return u}var mv;mv=f.default(t(v).mark((function e(n,r,a){var i,o,u,s,c,l,f,d,p,h,g,m,y,x,b,k,w,A,E,C,S,N,T,D,F,O,_,I,R,M,B,P,L,j,z,U,V,W,G,H,q,J,K,X,Y,Q,Z,$,ee,te,ne,re,ae,ie,oe,ue,se,ce,le,fe,de,pe,he,ve,ge,me,ye,xe,be,ke,we,Ae,Ee,Ce,Se,Ne,Te,De,Fe,Oe,_e,Ie,Re,Me,Be,Pe,Le,je,ze,Ue,Ve,We,Ge,He,qe,Je,Ke,Xe,Ye,Qe,Ze,$e,et,tt;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?44:"Switch"===e.t0?46:"Merge"===e.t0?57:"Enter"===e.t0?62:"Exit"===e.t0?66:"NextIteration"===e.t0?69:"TensorArrayV3"===e.t0?72:"TensorArrayWriteV3"===e.t0?82:"TensorArrayReadV3"===e.t0?88:"TensorArrayGatherV3"===e.t0?92:"TensorArrayScatterV3"===e.t0?97:"TensorArrayConcatV3"===e.t0?103:"TensorArraySplitV3"===e.t0?107:"TensorArraySizeV3"===e.t0?113:"TensorArrayCloseV3"===e.t0?116:"TensorListSetItem"===e.t0?120:"TensorListGetItem"===e.t0?126:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?132:"TensorListReserve"===e.t0?139:"TensorListGather"===e.t0?145:"TensorListStack"===e.t0?151:"TensorListFromTensor"===e.t0?157:"TensorListConcat"===e.t0?163:"TensorListPushBack"===e.t0?168:"TensorListPopBack"===e.t0?173:"TensorListSplit"===e.t0?178:184;break;case 3:return i=Ch("thenBranch",n,r,a),o=Ch("elseBranch",n,r,a),u=Ch("cond",n,r,a),s=Ch("args",n,r,a),e.next=9,u.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",a.functionMap[i].executeFunctionAsync(s,a.tensorArrayMap,a.tensorListMap));case 14:return e.abrupt("return",a.functionMap[o].executeFunctionAsync(s,a.tensorArrayMap,a.tensorListMap));case 15:return c=Ch("body",n,r,a),l=Ch("cond",n,r,a),f=Ch("args",n,r,a),e.next=20,a.functionMap[l].executeFunctionAsync(f,a.tensorArrayMap,a.tensorListMap);case 20:return d=e.sent,p=f.map((function(e){return e.id})),e.next=24,d[0].data();case 24:h=e.sent,d.forEach((function(e){e.kept||-1!==p.indexOf(e.id)||e.dispose()})),g=f;case 27:if(!h[0]){e.next=43;break}return m=g,e.next=31,a.functionMap[c].executeFunctionAsync(g,a.tensorArrayMap,a.tensorListMap);case 31:return g=e.sent,y=g.map((function(e){return e.id})),m.forEach((function(e){e.kept||-1!==p.indexOf(e.id)||-1!==y.indexOf(e.id)||e.dispose()})),e.next=36,a.functionMap[l].executeFunctionAsync(g,a.tensorArrayMap,a.tensorListMap);case 36:return x=e.sent,e.next=39,x[0].data();case 39:h=e.sent,x.forEach((function(e){e.kept||-1!==p.indexOf(e.id)||-1!==y.indexOf(e.id)||e.dispose()})),e.next=27;break;case 43:return e.abrupt("return",g);case 44:return b=Ch("pred",n,r,a),e.abrupt("return",[Dh(b)]);case 46:return k=Ch("pred",n,r,a),(w=Ch("data",n,r,a)).kept||(w=Dh(w)),e.next=51,k.data();case 51:if(!e.sent[0]){e.next=55;break}e.t1=[void 0,w],e.next=56;break;case 55:e.t1=[w,void 0];case 56:return e.abrupt("return",e.t1);case 57:if(A=n.inputNames.find((function(e){return void 0!==Sh(e,r,a)})),!A){e.next=61;break}return E=Sh(A,r,a),e.abrupt("return",[Dh(E)]);case 61:return e.abrupt("return",void 0);case 62:return C=Ch("frameName",n,r,a),S=Ch("tensor",n,r,a),a.enterFrame(C),e.abrupt("return",[Dh(S)]);case 66:return N=Ch("tensor",n,r,a),a.exitFrame(),e.abrupt("return",[Dh(N)]);case 69:return T=Ch("tensor",n,r,a),a.nextIteration(),e.abrupt("return",[Dh(T)]);case 72:return D=Ch("size",n,r,a),F=Ch("dtype",n,r,a),O=Ch("elementShape",n,r,a),_=Ch("dynamicSize",n,r,a),I=Ch("clearAfterRead",n,r,a),R=Ch("identicalElementShapes",n,r,a),M=Ch("name",n,r,a),B=new fv(M,F,D,O,R,_,I),a.addTensorArray(B),e.abrupt("return",[B.idTensor,nt.scalar(1)]);case 82:return P=Ch("tensorArrayId",n,r,a),L=Ch("index",n,r,a),j=Ch("tensor",n,r,a),(z=a.getTensorArray(P.id)).write(L,j),e.abrupt("return",[z.idTensor]);case 88:return U=Ch("tensorArrayId",n,r,a),V=Ch("index",n,r,a),W=a.getTensorArray(U.id),e.abrupt("return",[W.read(V)]);case 92:return G=Ch("tensorArrayId",n,r,a),H=Ch("indices",n,r,a),q=Ch("dtype",n,r,a),J=a.getTensorArray(G.id),e.abrupt("return",[J.gather(H,q)]);case 97:return K=Ch("tensorArrayId",n,r,a),X=Ch("indices",n,r,a),Y=Ch("tensor",n,r,a),(Q=a.getTensorArray(K.id)).scatter(X,Y),e.abrupt("return",[Q.idTensor]);case 103:return Z=Ch("tensorArrayId",n,r,a),$=a.getTensorArray(Z.id),ee=Ch("dtype",n,r,a),e.abrupt("return",[$.concat(ee)]);case 107:return te=Ch("tensorArrayId",n,r,a),ne=Ch("tensor",n,r,a),re=Ch("lengths",n,r,a),(ae=a.getTensorArray(te.id)).split(re,ne),e.abrupt("return",[ae.idTensor]);case 113:return ie=Ch("tensorArrayId",n,r,a),oe=a.getTensorArray(ie.id),e.abrupt("return",[nt.scalar(oe.size(),"int32")]);case 116:return ue=Ch("tensorArrayId",n,r,a),(se=a.getTensorArray(ue.id)).clearAndClose(),e.abrupt("return",[se.idTensor]);case 120:return ce=Ch("tensorListId",n,r,a),le=Ch("index",n,r,a),fe=Ch("tensor",n,r,a),(de=a.getTensorList(ce.id)).setItem(le,fe),e.abrupt("return",[de.idTensor]);case 126:return pe=Ch("tensorListId",n,r,a),he=Ch("index",n,r,a),ve=Ch("elementShape",n,r,a),ge=Ch("elementDType",n,r,a),me=a.getTensorList(pe.id),e.abrupt("return",[me.getItem(he,ve,ge)]);case 132:return ye=Ch("indices",n,r,a),xe=Ch("tensor",n,r,a),be=Ch("elementShape",n,r,a),ke=Ch("numElements",n,r,a),we=vv(xe,ye,be,ke),a.addTensorList(we),e.abrupt("return",[we.idTensor]);case 139:return Ae=Ch("elementShape",n,r,a),Ee=Ch("elementDType",n,r,a),Ce=Ch("numElements",n,r,a),Se=hv(Ae,Ee,Ce),a.addTensorList(Se),e.abrupt("return",[Se.idTensor]);case 145:return Ne=Ch("tensorListId",n,r,a),Te=Ch("indices",n,r,a),De=Ch("elementShape",n,r,a),Fe=Ch("elementDType",n,r,a),Oe=a.getTensorList(Ne.id),e.abrupt("return",[Oe.gather(Te,Fe,De)]);case 151:return _e=Ch("tensorListId",n,r,a),Ie=Ch("elementShape",n,r,a),Re=Ch("elementDType",n,r,a),Me=Ch("numElements",n,r,a),Be=a.getTensorList(_e.id),e.abrupt("return",[Be.stack(Ie,Re,Me)]);case 157:return Pe=Ch("tensor",n,r,a),Le=Ch("elementShape",n,r,a),je=Ch("elementDType",n,r,a),ze=pv(Pe,Le,je),a.addTensorList(ze),e.abrupt("return",[ze.idTensor]);case 163:return Ue=Ch("tensorListId",n,r,a),Ve=a.getTensorList(Ue.id),We=Ch("dtype",n,r,a),Ge=Ch("elementShape",n,r,a),e.abrupt("return",[Ve.concat(We,Ge)]);case 168:return He=Ch("tensorListId",n,r,a),qe=Ch("tensor",n,r,a),(Je=a.getTensorList(He.id)).pushBack(qe),e.abrupt("return",[Je.idTensor]);case 173:return Ke=Ch("tensorListId",n,r,a),Xe=Ch("elementShape",n,r,a),Ye=Ch("elementDType",n,r,a),Qe=a.getTensorList(Ke.id),e.abrupt("return",[Qe.popBack(Xe,Ye)]);case 178:return Ze=Ch("tensor",n,r,a),$e=Ch("elementShape",n,r,a),et=Ch("lengths",n,r,a),tt=gv(Ze,et,$e),a.addTensorList(tt),e.abrupt("return",[tt.idTensor]);case 184:throw TypeError("Node type ".concat(n.op," is not implemented"));case 185:case"end":return e.stop()}}),e)})));s("1i51P");d=s("6vecG"),of=s("ceZj5"),_f=s("dH9u6"),Oo=s("lGvfM"),sf=s("1DPo2"),Tf=s("btnhd"),uf=s("bxgT2"),Bd=s("WcUsE"),Md=s("2dPgQ"),s("lsNiP"),Ld=s("4laI6"),Pd=s("181UU"),s("8h0Lc");Ps=s("jwnkA"),s("dPpnl");var yv=s("1SpQu");Bo=s("9ZTJv"),vo=s("6XDPM"),Io=s("4z0yD"),go=s("1GxQM"),Cr=s("jlvqc"),mo=s("dqB3G"),ot=s("ilMKa"),_o=s("8p3bZ");s("1i51P");f=s("e3nFV"),v=s("40Zzs"),oe=s("j2ViA"),Nc=s("782ce");var xv=s("cxotR"),bv=s("fFUjj");function kv(e,t,n){return{boxes:Ch("boxes",e,t,n),scores:Ch("scores",e,t,n),maxOutputSize:Ch("maxOutputSize",e,t,n),iouThreshold:Ch("iouThreshold",e,t,n),scoreThreshold:Ch("scoreThreshold",e,t,n),softNmsSigma:Ch("softNmsSigma",e,t,n)}}(function(){var e=f.default(t(v).mark((function e(n,r,a){var i,o,u,s,c,l,f,d,p,h,g,m,y,x,b,k,w,A,E,C,S,N,T,D;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV4"===e.t0?8:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?14:"Where"===e.t0?19:"ListDiff"===e.t0?26:27;break;case 3:return i=kv(n,r,a),o=i.boxes,u=i.scores,s=i.maxOutputSize,c=i.iouThreshold,l=i.scoreThreshold,f=i.softNmsSigma,e.next=6,oe.image.nonMaxSuppressionWithScoreAsync(o,u,s,c,l,f);case 6:return d=e.sent,e.abrupt("return",[d.selectedIndices,d.selectedScores]);case 8:return p=kv(n,r,a),h=p.boxes,g=p.scores,m=p.maxOutputSize,y=p.iouThreshold,x=p.scoreThreshold,b=Ch("padToMaxOutputSize",n,r,a),e.next=12,oe.image.nonMaxSuppressionPaddedAsync(h,g,m,y,x,b);case 12:return k=e.sent,e.abrupt("return",[k.selectedIndices,k.validOutputs]);case 14:return w=kv(n,r,a),A=w.boxes,E=w.scores,C=w.maxOutputSize,S=w.iouThreshold,N=w.scoreThreshold,e.next=17,oe.image.nonMaxSuppressionAsync(A,E,C,S,N);case 17:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 19:return T=Nc.cast(Ch("condition",n,r,a),"bool"),e.next=22,xv.whereAsync(T);case 22:return e.t2=e.sent,D=[e.t2],T.dispose(),e.abrupt("return",D);case 26:return e.abrupt("return",bv.setdiff1dAsync(Ch("x",n,r,a),Ch("y",n,r,a)));case 27:throw TypeError("Node type ".concat(n.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})))})(),s("1jhOm"),ae=s("5J0XY"),nt=s("bftEy"),oe=s("j2ViA"),ut=s("iuFae"),$f=s("7owLz"),Mo=s("ejjI8"),bd=s("6Bgjr"),s("dKHZ2"),s("j0AHg"),nc=s("7WLBj"),s("1bFci"),s("49dpo"),Ro=s("6FAlx");s("1i51P");d=s("6vecG"),s("5KHLt"),st=s("9PS5J"),Oo=s("lGvfM"),s("7oZFS"),s("jq1h8"),lt=s("etmQx"),Tl=s("bYmSd"),s("ios2x"),at=s("avJI0"),Rs=s("4804C"),tu=s("cGC0n"),Ei=s("2xCpB"),ld=s("d6rwS"),Zf=s("a7Ldu"),tc=s("9UQ7R"),s("8wukb"),s("iGcXf"),s("bjxnt");s("jbRpz");m=s("P1tXK"),g=s("kglvN"),Eo=s("6hkW8"),Po=s("17OvF"),Nc=s("782ce"),Rf=s("hYjAM"),Ao=s("jPaTA"),s("fTdnV"),jd=s("4y8cw"),Er=s("gldWN"),x=s("biSQf"),Mf=s("6jWCC"),Do=s("kP8JI"),Of=s("htMbZ"),s("cjdFa"),s("lOxkD"),s("ios2x"),s("casYn"),s("eBkYt"),s("8x9VA"),s("dvCn4"),Nc=s("782ce"),If=s("fwOP6"),jd=s("4y8cw"),Er=s("gldWN"),Id=s("elYe2"),s("h7Gux"),s("fiGYl"),s("46h8X"),s("kEXNH");s("1i51P");c=s("3QOYJ"),l=s("2tuUj");s("1i51P");Pe=s("9M1dW");s("jbRpz");s("9lNTO").version,m=s("P1tXK"),bs=s("QkKgL"),nu=s("fZE7S"),ie=s("bqdMI"),oe=s("j2ViA"),os=s("2c3OP"),Sl=s("5uQwR"),Eo=s("6hkW8"),yv=s("1SpQu"),Ms=s("j8KB3"),Ee=s("8orDI"),Rs=s("4804C"),Ai=s("buy0T"),sv=s("4C8ia"),x=s("biSQf");s("1i51P");f=s("e3nFV"),v=s("40Zzs"),bs=s("QkKgL"),pc=s("aqs9m"),m=s("P1tXK");var wv={};Object.defineProperty(wv,"__esModule",{value:!0}),s("jbRpz"),s("2Lolk");var Av={},Ev=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))}),Cv=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Av,"__esModule",{value:!0});var Sv=Cv(s("lJspJ")),Nv={};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(Nv,"__esModule",{value:!0});var Tv={};Object.defineProperty(Tv,"__esModule",{value:!0}),Tv.compose=Tv.merge=Tv.$=Tv.style=Tv.presets=Tv.keyframes=Tv.fontFace=Tv.insertGlobal=Tv.insertRule=Tv.plugins=Tv.styleSheet=void 0,Tv.speedy=function(e){return Ym.speedy(e)},Tv.simulations=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];ey=!!e},Tv.simulate=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!(t=(0,yg.default)(t)))return{};if(!ey)return ty||(console.warn("can't simulate without once calling simulations(true)"),ty=!0),ny||(console.warn("don't use simulation outside dev"),ny=!0),{};return t.reduce((function(e,t){return e["data-simulate-"+ay(t)]="",e}),{})},Tv.cssLabels=function(e){ry=!!e},Tv.isLikeRule=oy,Tv.idFor=uy,Tv.css=Dy,Tv.rehydrate=function(e){(0,Rv.default)(hy,e.reduce((function(e,t){return e[t]=!0,e}),{}))},Tv.flush=function(){hy=Ym.inserted={},vy=Ym.registered={},my={},Ym.flush(),Ym.inject()},Tv.select=Oy,Tv.parent=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Dy(Xm({},e+" &",n))},Tv.media=function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Dy(Xm({},"@media "+e,n))},Tv.pseudo=_y,Tv.active=function(e){return _y(":active",e)},Tv.any=function(e){return _y(":any",e)},Tv.checked=function(e){return _y(":checked",e)},Tv.disabled=function(e){return _y(":disabled",e)},Tv.empty=function(e){return _y(":empty",e)},Tv.enabled=function(e){return _y(":enabled",e)},Tv._default=function(e){return _y(":default",e)},Tv.first=function(e){return _y(":first",e)},Tv.firstChild=function(e){return _y(":first-child",e)},Tv.firstOfType=function(e){return _y(":first-of-type",e)},Tv.fullscreen=function(e){return _y(":fullscreen",e)},Tv.focus=function(e){return _y(":focus",e)},Tv.hover=function(e){return _y(":hover",e)},Tv.indeterminate=function(e){return _y(":indeterminate",e)},Tv.inRange=function(e){return _y(":in-range",e)},Tv.invalid=function(e){return _y(":invalid",e)},Tv.lastChild=function(e){return _y(":last-child",e)},Tv.lastOfType=function(e){return _y(":last-of-type",e)},Tv.left=function(e){return _y(":left",e)},Tv.link=function(e){return _y(":link",e)},Tv.onlyChild=function(e){return _y(":only-child",e)},Tv.onlyOfType=function(e){return _y(":only-of-type",e)},Tv.optional=function(e){return _y(":optional",e)},Tv.outOfRange=function(e){return _y(":out-of-range",e)},Tv.readOnly=function(e){return _y(":read-only",e)},Tv.readWrite=function(e){return _y(":read-write",e)},Tv.required=function(e){return _y(":required",e)},Tv.right=function(e){return _y(":right",e)},Tv.root=function(e){return _y(":root",e)},Tv.scope=function(e){return _y(":scope",e)},Tv.target=function(e){return _y(":target",e)},Tv.valid=function(e){return _y(":valid",e)},Tv.visited=function(e){return _y(":visited",e)},Tv.dir=function(e,t){return _y(":dir("+e+")",t)},Tv.lang=function(e,t){return _y(":lang("+e+")",t)},Tv.not=function(e,t){var n=e.split(",").map((function(e){return e.trim()})).map((function(e){return":not("+e+")"}));return 1===n.length?_y(":not("+e+")",t):Oy(n.join(""),t)},Tv.nthChild=function(e,t){return _y(":nth-child("+e+")",t)},Tv.nthLastChild=function(e,t){return _y(":nth-last-child("+e+")",t)},Tv.nthLastOfType=function(e,t){return _y(":nth-last-of-type("+e+")",t)},Tv.nthOfType=function(e,t){return _y(":nth-of-type("+e+")",t)},Tv.after=function(e){return _y("::after",e)},Tv.before=function(e){return _y("::before",e)},Tv.firstLetter=function(e){return _y("::first-letter",e)},Tv.firstLine=function(e){return _y("::first-line",e)},Tv.selection=function(e){return _y("::selection",e)},Tv.backdrop=function(e){return _y("::backdrop",e)},Tv.placeholder=function(e){return Dy({"::placeholder":e})},Tv.cssFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(t=(0,yg.default)(t))?t.map((function(e){var t={label:[]};return Ay(t,{src:e}),py(iy(t),dy(t)).join("")})).join(""):""},Tv.attribsFor=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=(t=(0,yg.default)(t))?t.map((function(e){uy(e);var t=Object.keys(e)[0];return t+'="'+(e[t]||"")+'"'})).join(" "):"";return r};var Dv,Fv=Object.getOwnPropertySymbols,Ov=Object.prototype.hasOwnProperty,_v=Object.prototype.propertyIsEnumerable;
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/function Iv(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}Dv=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,r,a=Iv(e),i=1;i<arguments.length;i++){for(var o in n=Object(arguments[i]))Ov.call(n,o)&&(a[o]=n[o]);if(Fv){r=Fv(n);for(var u=0;u<r.length;u++)_v.call(n,r[u])&&(a[r[u]]=n[r[u]])}}return a};var Rv=Km(Dv),Mv={};Object.defineProperty(Mv,"__esModule",{value:!0}),Mv.StyleSheet=Gv;var Bv,Pv=(Bv=Dv)&&Bv.__esModule?Bv:{default:Bv};function Lv(e){return e[e.length-1]}function jv(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}var zv="undefined"!=typeof window,Uv=!1,Vv=function(){if(zv){var e=document.createElement("div");return e.innerHTML="\x3c!--[if lt IE 10]><i></i><![endif]--\x3e",1===e.getElementsByTagName("i").length}}();function Wv(){var e=document.createElement("style");return e.type="text/css",e.setAttribute("data-glamor",""),e.appendChild(document.createTextNode("")),(document.head||document.getElementsByTagName("head")[0]).appendChild(e),e}function Gv(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.speedy,n=void 0===t||t,r=e.maxLength,a=void 0===r?zv&&Vv?4e3:65e3:r;this.isSpeedy=n,this.sheet=void 0,this.tags=[],this.maxLength=a,this.ctr=0}(0,Pv.default)(Gv.prototype,{getSheet:function(){return jv(Lv(this.tags))},inject:function(){var e=this;if(this.injected)throw new Error("already injected stylesheet!");zv?this.tags[0]=Wv():this.sheet={cssRules:[],insertRule:function(t){e.sheet.cssRules.push({cssText:t})}},this.injected=!0},speedy:function(e){if(0!==this.ctr)throw new Error("cannot change speedy mode after inserting any rule to sheet. Either call speedy("+e+") earlier in your app, or call flush() before speedy("+e+")");this.isSpeedy=!!e},_insert:function(e){try{var t=this.getSheet();t.insertRule(e,-1!==e.indexOf("@import")?0:t.cssRules.length)}catch(e){Uv}},insert:function(e){if(zv)if(this.isSpeedy&&this.getSheet().insertRule)this._insert(e);else if(-1!==e.indexOf("@import")){var t=Lv(this.tags);t.insertBefore(document.createTextNode(e),t.firstChild)}else Lv(this.tags).appendChild(document.createTextNode(e));else this.sheet.insertRule(e,-1!==e.indexOf("@import")?0:this.sheet.cssRules.length);return this.ctr++,zv&&this.ctr%this.maxLength==0&&this.tags.push(Wv()),this.ctr-1},delete:function(e){return this.replace(e,"")},flush:function(){zv?(this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.sheet=null,this.ctr=0):this.sheet.cssRules=[],this.injected=!1},rules:function(){if(!zv)return this.sheet.cssRules;var e=[];return this.tags.forEach((function(t){return e.splice.apply(e,[e.length,0].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(Array.from(jv(t).cssRules))))})),e}});var Hv={};Object.defineProperty(Hv,"__esModule",{value:!0}),Hv.processStyleName=void 0,Hv.createMarkupForStyles=function(e,t){var n="";for(var r in e){var a=0===r.indexOf("--");if(e.hasOwnProperty(r)&&"label"!==r){var i=e[r];null!=i&&(a?n+=r+":"+i+";":(n+=pg(r)+":",n+=(0,og.default)(r,i,t)+";"))}}return n||null};var qv={},Jv=/-(.)/g;qv=function(e){return e.replace(Jv,(function(e,t){return t.toUpperCase()}))};var Kv=/^-ms-/;dg((function(e){return qv(e.replace(Kv,"ms-"))}));var Xv={};Object.defineProperty(Xv,"__esModule",{value:!0});var Yv={};Object.defineProperty(Yv,"__esModule",{value:!0});var Qv={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowStart:!0,gridRowEnd:!0,gridColumn:!0,gridColumnStart:!0,gridColumnEnd:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0};var Zv=["Webkit","ms","Moz","O"];Object.keys(Qv).forEach((function(e){Zv.forEach((function(t){Qv[function(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}(t,e)]=Qv[e]}))}));var $v={isUnitlessNumber:Qv,shorthandPropertyExpansions:{background:{backgroundAttachment:!0,backgroundColor:!0,backgroundImage:!0,backgroundPositionX:!0,backgroundPositionY:!0,backgroundRepeat:!0},backgroundPosition:{backgroundPositionX:!0,backgroundPositionY:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0},outline:{outlineWidth:!0,outlineStyle:!0,outlineColor:!0}}};Yv.default=$v;var eg,tg=ag(Yv);function ng(e){return function(){return e}}var rg=function(){};rg.thatReturns=ng,rg.thatReturnsFalse=ng(!1),rg.thatReturnsTrue=ng(!0),rg.thatReturnsNull=ng(null),rg.thatReturnsThis=function(){return this},rg.thatReturnsArgument=function(e){return e};ag(eg=rg);function ag(e){return e&&e.__esModule?e:{default:e}}var ig=tg.default.isUnitlessNumber;Xv.default=function(e,t,n){return null==t||"boolean"==typeof t||""===t?"":isNaN(t)||0===t||ig.hasOwnProperty(e)&&ig[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")};var og=dg(Xv),ug={},sg=/([A-Z])/g;ug=function(e){return e.replace(sg,"-$1").toLowerCase()};var cg=/^ms-/;var lg=dg((function(e){return ug(e).replace(cg,"-ms-")}));var fg=dg((function(e){var t={};return function(n){return t.hasOwnProperty(n)||(t[n]=e.call(this,n)),t[n]}}));dg(eg);function dg(e){return e&&e.__esModule?e:{default:e}}var pg=Hv.processStyleName=(0,fg.default)(lg.default);var hg={};s("1i51P");_i=s("5lcaY");Object.defineProperty(hg,"__esModule",{value:!0});var vg="function"==typeof Symbol&&"symbol"===_i.default(Symbol.iterator)?function(e){return void 0===e?"undefined":_i.default(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_i.default(e)};function gg(e){if(function(e){return null==e||!1===e||"object"===(void 0===e?"undefined":vg(e))&&0===Object.keys(e).length}(e))return null;if("object"!==(void 0===e?"undefined":vg(e)))return e;for(var t={},n=Object.keys(e),r=!1,a=0;a<n.length;a++){var i=e[n[a]],o=mg(i);null!==o&&o===i||(r=!0),null!==o&&(t[n[a]]=o)}return 0===Object.keys(t).length?null:r?t:e}function mg(e){return Array.isArray(e)?(n=!1,r=[],(t=e).forEach((function(e){var t=mg(e);null!==t&&t===e||(n=!0),null!==t&&r.push(t)})),0==r.length?null:n?r:t):gg(e);var t,n,r}hg.default=mg;var yg=Km(hg),xg={};Object.defineProperty(xg,"__esModule",{value:!0});var bg=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};xg.PluginSet=Um,xg.fallbacks=function(e){var t=Object.keys(e.style).map((function(t){return Array.isArray(e.style[t])})).indexOf(!0)>=0;if(t){var n=e.style,r=Object.keys(n).reduce((function(e,t){return e[t]=Array.isArray(n[t])?n[t].join("; "+(0,Hv.processStyleName)(t)+": "):n[t],e}),{});return(0,kg.default)({},e,{style:r})}return e},xg.contentWrap=function(e){if(e.style.content){var t=e.style.content;return Vm.indexOf(t)>=0||/^(attr|calc|counters?|url)\(/.test(t)?e:t.charAt(0)!==t.charAt(t.length-1)||'"'!==t.charAt(0)&&"'"!==t.charAt(0)?bg({},e,{style:bg({},e.style,{content:'"'+t+'"'})}):e}return e},xg.prefixes=function(e){return(0,kg.default)({},e,{style:(0,jm.default)(bg({},e.style))})};var kg=zm(Dv),wg={};Object.defineProperty(wg,"__esModule",{value:!0}),wg.default=function(e){for(var t in e){var n=e[t],r=(0,Bg.default)(Pm,t,n,e,Lm);r&&(e[t]=r),(0,Rg.default)(Lm,t,e)}return e};var Ag={};Object.defineProperty(Ag,"__esModule",{value:!0});var Eg=["Webkit"],Cg=["Moz"],Sg=["ms"],Ng=["Webkit","Moz"],Tg=["Webkit","ms"],Dg=["Webkit","Moz","ms"];Ag.default={plugins:[],prefixMap:{appearance:Ng,userSelect:Dg,textEmphasisPosition:Eg,textEmphasis:Eg,textEmphasisStyle:Eg,textEmphasisColor:Eg,boxDecorationBreak:Eg,clipPath:Eg,maskImage:Eg,maskMode:Eg,maskRepeat:Eg,maskPosition:Eg,maskClip:Eg,maskOrigin:Eg,maskSize:Eg,maskComposite:Eg,mask:Eg,maskBorderSource:Eg,maskBorderMode:Eg,maskBorderSlice:Eg,maskBorderWidth:Eg,maskBorderOutset:Eg,maskBorderRepeat:Eg,maskBorder:Eg,maskType:Eg,textDecorationStyle:Eg,textDecorationSkip:Eg,textDecorationLine:Eg,textDecorationColor:Eg,filter:Eg,fontFeatureSettings:Eg,breakAfter:Dg,breakBefore:Dg,breakInside:Dg,columnCount:Ng,columnFill:Ng,columnGap:Ng,columnRule:Ng,columnRuleColor:Ng,columnRuleStyle:Ng,columnRuleWidth:Ng,columns:Ng,columnSpan:Ng,columnWidth:Ng,writingMode:Tg,flex:Eg,flexBasis:Eg,flexDirection:Eg,flexGrow:Eg,flexFlow:Eg,flexShrink:Eg,flexWrap:Eg,alignContent:Eg,alignItems:Eg,alignSelf:Eg,justifyContent:Eg,order:Eg,transform:Eg,transformOrigin:Eg,transformOriginX:Eg,transformOriginY:Eg,backfaceVisibility:Eg,perspective:Eg,perspectiveOrigin:Eg,transformStyle:Eg,transformOriginZ:Eg,animation:Eg,animationDelay:Eg,animationDirection:Eg,animationFillMode:Eg,animationDuration:Eg,animationIterationCount:Eg,animationName:Eg,animationPlayState:Eg,animationTimingFunction:Eg,backdropFilter:Eg,fontKerning:Eg,scrollSnapType:Tg,scrollSnapPointsX:Tg,scrollSnapPointsY:Tg,scrollSnapDestination:Tg,scrollSnapCoordinate:Tg,shapeImageThreshold:Eg,shapeImageMargin:Eg,shapeImageOutside:Eg,hyphens:Dg,flowInto:Tg,flowFrom:Tg,regionFragment:Tg,textAlignLast:Cg,tabSize:Cg,wrapFlow:Sg,wrapThrough:Sg,wrapMargin:Sg,gridTemplateColumns:Sg,gridTemplateRows:Sg,gridTemplateAreas:Sg,gridTemplate:Sg,gridAutoColumns:Sg,gridAutoRows:Sg,gridAutoFlow:Sg,grid:Sg,gridRowStart:Sg,gridColumnStart:Sg,gridRowEnd:Sg,gridRow:Sg,gridColumn:Sg,gridColumnEnd:Sg,gridColumnGap:Sg,gridRowGap:Sg,gridArea:Sg,gridGap:Sg,textSizeAdjust:Tg,borderImage:Eg,borderImageOutset:Eg,borderImageRepeat:Eg,borderImageSlice:Eg,borderImageSource:Eg,borderImageWidth:Eg,transitionDelay:Eg,transitionDuration:Eg,transitionProperty:Eg,transitionTimingFunction:Eg}};var Fg=Bm(Ag=Ag.default),Og={};Object.defineProperty(Og,"__esModule",{value:!0}),Og.default=function(e,t,n){if(e.hasOwnProperty(t))for(var r=e[t],a=0,i=r.length;a<i;++a)n[r[a]+(0,Ig.default)(t)]=n[t]};var _g={};Object.defineProperty(_g,"__esModule",{value:!0}),_g.default=function(e){return e.charAt(0).toUpperCase()+e.slice(1)};var Ig=function(e){return e&&e.__esModule?e:{default:e}}(_g=_g.default);var Rg=Bm(Og=Og.default),Mg={};Object.defineProperty(Mg,"__esModule",{value:!0}),Mg.default=function(e,t,n,r,a){for(var i=0,o=e.length;i<o;++i){var u=e[i](t,n,r,a);if(u)return u}};var Bg=Bm(Mg=Mg.default),Pg={};Object.defineProperty(Pg,"__esModule",{value:!0}),Pg.default=function(e,t){if("cursor"===e&&jg.hasOwnProperty(t))return Lg.map((function(e){return e+t}))};var Lg=["-webkit-","-moz-",""],jg={"zoom-in":!0,"zoom-out":!0,grab:!0,grabbing:!0};var zg=Bm(Pg=Pg.default),Ug={};Object.defineProperty(Ug,"__esModule",{value:!0}),Ug.default=function(e,t){if("string"==typeof t&&!(0,Gg.default)(t)&&t.indexOf("cross-fade(")>-1)return Hg.map((function(e){return t.replace(/cross-fade\(/g,e+"cross-fade(")}))};var Vg={};Object.defineProperty(Vg,"__esModule",{value:!0}),Vg.default=function(e){return"string"==typeof e&&Wg.test(e)};var Wg=/-webkit-|-moz-|-ms-/;var Gg=function(e){return e&&e.__esModule?e:{default:e}}(Vg=Vg.default);var Hg=["-webkit-",""];var qg=Bm(Ug=Ug.default),Jg={};Object.defineProperty(Jg,"__esModule",{value:!0}),Jg.default=function(e,t){if("string"==typeof t&&!(0,Kg.default)(t)&&t.indexOf("filter(")>-1)return Xg.map((function(e){return t.replace(/filter\(/g,e+"filter(")}))};var Kg=function(e){return e&&e.__esModule?e:{default:e}}(Vg);var Xg=["-webkit-",""];var Yg=Bm(Jg=Jg.default),Qg={};Object.defineProperty(Qg,"__esModule",{value:!0}),Qg.default=function(e,t){if("display"===e&&Zg.hasOwnProperty(t))return Zg[t]};var Zg={flex:["-webkit-box","-moz-box","-ms-flexbox","-webkit-flex","flex"],"inline-flex":["-webkit-inline-box","-moz-inline-box","-ms-inline-flexbox","-webkit-inline-flex","inline-flex"]};var $g=Bm(Qg=Qg.default),em={};Object.defineProperty(em,"__esModule",{value:!0}),em.default=function(e,t,n){"flexDirection"===e&&"string"==typeof t&&(t.indexOf("column")>-1?n.WebkitBoxOrient="vertical":n.WebkitBoxOrient="horizontal",t.indexOf("reverse")>-1?n.WebkitBoxDirection="reverse":n.WebkitBoxDirection="normal");nm.hasOwnProperty(e)&&(n[nm[e]]=tm[t]||t)};var tm={"space-around":"justify","space-between":"justify","flex-start":"start","flex-end":"end","wrap-reverse":"multiple",wrap:"multiple"},nm={alignItems:"WebkitBoxAlign",justifyContent:"WebkitBoxPack",flexWrap:"WebkitBoxLines"};var rm=Bm(em=em.default),am={};Object.defineProperty(am,"__esModule",{value:!0}),am.default=function(e,t){if("string"==typeof t&&!(0,im.default)(t)&&um.test(t))return om.map((function(e){return e+t}))};var im=function(e){return e&&e.__esModule?e:{default:e}}(Vg);var om=["-webkit-","-moz-",""],um=/linear-gradient|radial-gradient|repeating-linear-gradient|repeating-radial-gradient/;var sm=Bm(am=am.default),cm={};Object.defineProperty(cm,"__esModule",{value:!0}),cm.default=function(e,t){if("string"==typeof t&&!(0,lm.default)(t)&&t.indexOf("image-set(")>-1)return fm.map((function(e){return t.replace(/image-set\(/g,e+"image-set(")}))};var lm=function(e){return e&&e.__esModule?e:{default:e}}(Vg);var fm=["-webkit-",""];var dm=Bm(cm=cm.default),pm={};Object.defineProperty(pm,"__esModule",{value:!0}),pm.default=function(e,t){if("position"===e&&"sticky"===t)return["-webkit-sticky","sticky"]};var hm=Bm(pm=pm.default),vm={};Object.defineProperty(vm,"__esModule",{value:!0}),vm.default=function(e,t){if(mm.hasOwnProperty(e)&&ym.hasOwnProperty(t))return gm.map((function(e){return e+t}))};var gm=["-webkit-","-moz-",""],mm={maxHeight:!0,maxWidth:!0,width:!0,height:!0,columnWidth:!0,minWidth:!0,minHeight:!0},ym={"min-content":!0,"max-content":!0,"fill-available":!0,"fit-content":!0,"contain-floats":!0};var xm=Bm(vm=vm.default),bm={};Object.defineProperty(bm,"__esModule",{value:!0}),bm.default=function(e,t,n,r){if("string"==typeof t&&Im.hasOwnProperty(e)){var a=function(e,t){if((0,Fm.default)(e))return e;for(var n=e.split(/,(?![^()]*(?:\([^()]*\))?\))/g),r=0,a=n.length;r<a;++r){var i=n[r],o=[i];for(var u in t){var s=(0,Dm.default)(u);if(i.indexOf(s)>-1&&"order"!==s)for(var c=t[u],l=0,f=c.length;l<f;++l)o.unshift(i.replace(s,Rm[c[l]]+s))}n[r]=o.join(",")}return n.join(",")}(t,r),i=a.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-moz-|-ms-/.test(e)})).join(",");if(e.indexOf("Webkit")>-1)return i;var o=a.split(/,(?![^()]*(?:\([^()]*\))?\))/g).filter((function(e){return!/-webkit-|-ms-/.test(e)})).join(",");return e.indexOf("Moz")>-1?o:(n["Webkit"+(0,Om.default)(e)]=i,n["Moz"+(0,Om.default)(e)]=o,a)}};var km={};Object.defineProperty(km,"__esModule",{value:!0}),km.default=function(e){return(0,Tm.default)(e)};var wm={};a(wm),n(wm,"default",(function(){return Nm}));var Am=/[A-Z]/g,Em=/^ms-/,Cm={};function Sm(e){return"-"+e.toLowerCase()}var Nm=function(e){if(Cm.hasOwnProperty(e))return Cm[e];var t=e.replace(Am,Sm);return Cm[e]=Em.test(t)?"-"+t:t},Tm=function(e){return e&&e.__esModule?e:{default:e}}(wm);var Dm=_m(km=km.default),Fm=_m(Vg),Om=_m(_g);function _m(e){return e&&e.__esModule?e:{default:e}}var Im={transition:!0,transitionProperty:!0,WebkitTransition:!0,WebkitTransitionProperty:!0,MozTransition:!0,MozTransitionProperty:!0},Rm={Webkit:"-webkit-",Moz:"-moz-",ms:"-ms-"};var Mm=Bm(bm=bm.default);function Bm(e){return e&&e.__esModule?e:{default:e}}var Pm=[qg.default,zg.default,Yg.default,rm.default,sm.default,dm.default,hm.default,xm.default,Mm.default,$g.default],Lm=Fg.default.prefixMap;var jm=zm(wg);function zm(e){return e&&e.__esModule?e:{default:e}}function Um(e){this.fns=e||[]}(0,kg.default)(Um.prototype,{add:function(){for(var e=this,t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){e.fns.indexOf(t)>=0||(e.fns=[t].concat(e.fns))}))},remove:function(e){this.fns=this.fns.filter((function(t){return t!==e}))},clear:function(){this.fns=[]},transform:function(e){return this.fns.reduce((function(e,t){return t(e)}),e)}});var Vm=["normal","none","counter","open-quote","close-quote","no-open-quote","no-close-quote","initial","inherit"];var Wm={};function Gm(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)+(e.charCodeAt(t++)<<16)+(e.charCodeAt(t)<<24)}function Hm(e,t){return e.charCodeAt(t++)+(e.charCodeAt(t++)<<8)}function qm(e,t){return(65535&(e|=0))*(t|=0)+(((e>>>16)*t&65535)<<16)|0}Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.default=function(e,t){var n=1540483477,r=t^e.length,a=e.length,i=0;for(;a>=4;){var o=Gm(e,i);o=qm(o,n),o=qm(o^=o>>>24,n),r=qm(r,n),r^=o,i+=4,a-=4}switch(a){case 3:r^=Hm(e,i),r=qm(r^=e.charCodeAt(i+2)<<16,n);break;case 2:r=qm(r^=Hm(e,i),n);break;case 1:r=qm(r^=e.charCodeAt(i),n)}return r=qm(r^=r>>>13,n),(r^=r>>>15)>>>0};var Jm=Km(Wm);function Km(e){return e&&e.__esModule?e:{default:e}}function Xm(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Ym=Tv.styleSheet=new Mv.StyleSheet;Ym.inject();var Qm=Tv.plugins=Ym.plugins=new xg.PluginSet([xg.prefixes,xg.contentWrap,xg.fallbacks]);Qm.media=new xg.PluginSet,Qm.fontFace=new xg.PluginSet,Qm.keyframes=new xg.PluginSet([xg.prefixes,xg.fallbacks]);var Zm=!1,$m="undefined"!=typeof window,ey=Zm,ty=!1,ny=!1;var ry=Zm;function ay(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.toLowerCase().replace(/[^a-z0-9]/g,t)}function iy(e){var t=JSON.stringify(e),n=(0,Jm.default)(t).toString(36);return e.label&&e.label.length,n}function oy(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));return 1===t.length&&!!/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0])}function uy(e){var t=Object.keys(e).filter((function(e){return"toString"!==e}));if(1!==t.length)throw new Error("not a rule");var n=/data\-css\-([a-zA-Z0-9\-_]+)/.exec(t[0]);if(!n)throw new Error("not a rule");return n[1]}var sy=/[(),]|"(?:\\.|[^"\n])*"|'(?:\\.|[^'\n])*'|\/\*[\s\S]*?\*\//g;function cy(e){if(-1===e.indexOf(","))return[e];for(var t,n=[],r=[],a=0;t=sy.exec(e);)switch(t[0]){case"(":a++;break;case")":a--;break;case",":if(a)break;n.push(t.index)}for(t=n.length;t--;)r.unshift(e.slice(n[t]+1)),e=e.slice(0,n[t]);return r.unshift(e),r}function ly(e,t){if(!e)return t.replace(/\&/g,"");if(!t)return".css-"+e+",[data-css-"+e+"]";var n=cy(t).map((function(t){return t.indexOf("&")>=0?[t.replace(/\&/gm,".css-"+e),t.replace(/\&/gm,"[data-css-"+e+"]")].join(","):".css-"+e+t+",[data-css-"+e+"]"+t})).join(",");return ey&&/^\&\:/.exec(t)&&!/\s/.exec(t)&&(n+=",.css-"+e+"[data-simulate-"+ay(t)+"],[data-css-"+e+"][data-simulate-"+ay(t)+"]"),n}function fy(e){var t=e.selector,n=e.style,r=Qm.transform({selector:t,style:n});return r.selector+"{"+(0,Hv.createMarkupForStyles)(r.style)+"}"}function dy(e){var t=void 0,n=void 0,r=void 0,a=void 0;return Object.keys(e).forEach((function(i){i.indexOf("&")>=0?(n=n||{})[i]=e[i]:0===i.indexOf("@media")?(r=r||{})[i]=dy(e[i]):0===i.indexOf("@supports")?(a=a||{})[i]=dy(e[i]):"label"===i?e.label.length>0&&((t=t||{}).label=ry?e.label.join("."):""):(t=t||{})[i]=e[i]})),{plain:t,selects:n,medias:r,supports:a}}function py(e,t){var n=[],r=t.plain,a=t.selects,i=t.medias,o=t.supports;return r&&n.push(fy({style:r,selector:ly(e)})),a&&Object.keys(a).forEach((function(t){return n.push(fy({style:a[t],selector:ly(e,t)}))})),i&&Object.keys(i).forEach((function(t){return n.push(t+"{"+py(e,i[t]).join("")+"}")})),o&&Object.keys(o).forEach((function(t){return n.push(t+"{"+py(e,o[t]).join("")+"}")})),n}var hy=Ym.inserted={};var vy=Ym.registered={};function gy(e){vy[e.id]||(vy[e.id]=e)}var my={};function yy(e){if(gy(e),function(e){if(!hy[e.id]){hy[e.id]=!0;var t=dy(e.style),n=py(e.id,t);hy[e.id]=!!$m||n,n.forEach((function(e){return Ym.insert(e)}))}}(e),my[e.id])return my[e.id];var t=Xm({},"data-css-"+e.id,ry&&e.label||"");return Object.defineProperty(t,"toString",{enumerable:!1,value:function(){return"css-"+e.id}}),my[e.id]=t,t}function xy(e,t){var n=cy(e).map((function(e){return e.indexOf("&")>=0?e:"&"+e}));return cy(t).map((function(e){return e.indexOf("&")>=0?e:"&"+e})).reduce((function(e,t){return e.concat(n.map((function(e){return t.replace(/\&/g,e)})))}),[]).join(",")}function by(e,t){return e?"@supports "+e.substring(9)+" and "+t.substring(9):t}function ky(e){for(var t=[],n=0;n<e.length;n++)t=Array.isArray(e[n])?t.concat(ky(e[n])):t.concat(e[n]);return t}var wy={"::placeholder":["::-webkit-input-placeholder","::-moz-placeholder","::-ms-input-placeholder"],":fullscreen":[":-webkit-full-screen",":-moz-full-screen",":-ms-fullscreen"]};function Ay(e,t){var n=t.selector,r=void 0===n?"":n,a=t.mq,i=void 0===a?"":a,o=t.supp,u=void 0===o?"":o,s=t.src,c=void 0===s?{}:s;Array.isArray(c)||(c=[c]),(c=ky(c)).forEach((function(t){if(oy(t)){var n=function(e){if(oy(e)){var t=vy[uy(e)];if(null==t)throw new Error("[glamor] an unexpected rule cache miss occurred. This is probably a sign of multiple glamor instances in your app. See https://github.com/threepointone/glamor/issues/79");return t}return e}(t);if("css"!==n.type)throw new Error("cannot merge this rule");t=n.style}(t=(0,yg.default)(t))&&t.composes&&Ay(e,{selector:r,mq:i,supp:u,src:t.composes}),Object.keys(t||{}).forEach((function(n){if(function(e){for(var t=[":",".","[",">"," "],n=!1,r=e.charAt(0),a=0;a<t.length;a++)if(r===t[a]){n=!0;break}return n||e.indexOf("&")>=0}(n))wy[n]&&wy[n].forEach((function(a){return Ay(e,{selector:xy(r,a),mq:i,supp:u,src:t[n]})})),Ay(e,{selector:xy(r,n),mq:i,supp:u,src:t[n]});else if(function(e){return 0===e.indexOf("@media")}(n))Ay(e,{selector:r,mq:(o=i,s=n,o?"@media "+o.substring(6)+" and "+s.substring(6):s),supp:u,src:t[n]});else if(function(e){return 0===e.indexOf("@supports")}(n))Ay(e,{selector:r,mq:i,supp:by(u,n),src:t[n]});else if("composes"===n);else{var a=e;u&&(a[u]=a[u]||{},a=a[u]),i&&(a[i]=a[i]||{},a=a[i]),r&&(a[r]=a[r]||{},a=a[r]),"label"===n?ry&&(e.label=e.label.concat(t.label)):a[n]=t[n]}var o,s}))}))}function Ey(e){var t={label:[]};return Ay(t,{src:e}),yy({id:iy(t),style:t,label:ry?t.label.join("."):"",type:"css"})}var Cy={};Object.defineProperty(Cy,"toString",{enumerable:!1,value:function(){return"css-nil"}});var Sy="undefined"!=typeof WeakMap?[Cy,new WeakMap,new WeakMap,new WeakMap]:[Cy];var Ny,Ty="undefined"!=typeof WeakMap?(Ny=Ey,function(e){if(Sy[e.length]){for(var t=Sy[e.length],n=0;n<e.length-1;)t.has(e[n])||t.set(e[n],new WeakMap),t=t.get(e[n]),n++;if(t.has(e[e.length-1])){var r=t.get(e[n]);if(vy[r.toString().substring(4)])return r}}var a=Ny(e);if(Sy[e.length]){for(var i=0,o=Sy[e.length];i<e.length-1;)o=o.get(e[i]),i++;try{o.set(e[i],a)}catch(e){}}return a}):Ey;function Dy(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(t[0]&&t[0].length&&t[0].raw)throw new Error("you forgot to include glamor/babel in your babel plugins.");return(t=(0,yg.default)(t))?Ty(t):Cy}Dy.insert=function(e){var t={id:iy(e),css:e,type:"raw"};gy(t),hy[t.id]||(Ym.insert(t.css),hy[t.id]=!!$m||[t.css])};Tv.insertRule=Dy.insert;Dy.global=function(e,t){if(t=(0,yg.default)(t))return Dy.insert(fy({selector:e,style:t}))};Tv.insertGlobal=Dy.global;Dy.keyframes=function(e,t){t||(t=e,e="animation");var n={id:iy({name:e,kfs:t=(0,yg.default)(t)||{}}),type:"keyframes",name:e,keyframes:t};return gy(n),function(e){if(!hy[e.id]){var t=Object.keys(e.keyframes).map((function(t){var n=Qm.keyframes.transform({id:e.id,name:t,style:e.keyframes[t]});return n.name+"{"+(0,Hv.createMarkupForStyles)(n.style)+"}"})).join(""),n=["-webkit-","-moz-","-o-",""].map((function(n){return"@"+n+"keyframes "+e.name+"_"+e.id+"{"+t+"}"}));n.forEach((function(e){return Ym.insert(e)})),hy[e.id]=!!$m||n}}(n),e+"_"+n.id},Dy.fontFace=function(e){var t={id:iy(e=(0,yg.default)(e)),type:"font-face",font:e};return gy(t),function(e){if(!hy[e.id]){var t="@font-face{"+(0,Hv.createMarkupForStyles)(e.font)+"}";Ym.insert(t),hy[e.id]=!!$m||[t]}}(t),e.fontFamily};Tv.fontFace=Dy.fontFace,Tv.keyframes=Dy.keyframes;Tv.presets={mobile:"(min-width: 400px)",Mobile:"@media (min-width: 400px)",phablet:"(min-width: 550px)",Phablet:"@media (min-width: 550px)",tablet:"(min-width: 750px)",Tablet:"@media (min-width: 750px)",desktop:"(min-width: 1000px)",Desktop:"@media (min-width: 1000px)",hd:"(min-width: 1200px)",Hd:"@media (min-width: 1200px)"};var Fy=Tv.style=Dy;function Oy(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e?Dy(Xm({},e,n)):Fy(n)}Tv.$=Oy;Tv.merge=Dy,Tv.compose=Dy;function _y(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Dy(Xm({},e,n))}var Iy={},Ry=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))});Object.defineProperty(Iy,"__esModule",{value:!0});var My=s("eoZhW"),By={};s("1i51P");c=s("3QOYJ"),l=s("2tuUj");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(By,"__esModule",{value:!0});var Py={};s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),Ye=s("jZS3C"),l=s("2tuUj");function Ly(){}
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(Py,"__esModule",{value:!0});var jy={},zy=[],Uy=[];function Vy(e,t){var n,r,a,i,o=Uy;for(i=arguments.length;i-- >2;)zy.push(arguments[i]);for(t&&null!=t.children&&(zy.length||zy.push(t.children),delete t.children);zy.length;)if((r=zy.pop())&&void 0!==r.pop)for(i=r.length;i--;)zy.push(r[i]);else"boolean"==typeof r&&(r=null),(a="function"!=typeof e)&&(null==r?r="":"number"==typeof r?r=String(r):"string"!=typeof r&&(a=!1)),a&&n?o[o.length-1]+=r:o===Uy?o=[r]:o.push(r),n=a;var u=new Ly;return u.nodeName=e,u.children=o,u.attributes=null==t?void 0:t,u.key=null==t?void 0:t.key,void 0!==jy.vnode&&jy.vnode(u),u}function Wy(e,t){for(var n in t)e[n]=t[n];return e}var Gy="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;var Hy=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,qy=[];function Jy(e){!e._dirty&&(e._dirty=!0)&&1==qy.push(e)&&(jy.debounceRendering||Gy)(Ky)}function Ky(){var e,t=qy;for(qy=[];e=t.pop();)e._dirty&&hx(e)}function Xy(e,t,n){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&Yy(e,t.nodeName):n||e._componentConstructor===t.nodeName}function Yy(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function Qy(e){var t=Wy({},e.attributes);t.children=e.children;var n=e.nodeName.defaultProps;if(void 0!==n)for(var r in n)void 0===t[r]&&(t[r]=n[r]);return t}function Zy(e){var t=e.parentNode;t&&t.removeChild(e)}function $y(e,t,n,r,a){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)n&&n(null),r&&r(e);else if("class"!==t||a)if("style"===t){if(r&&"string"!=typeof r&&"string"!=typeof n||(e.style.cssText=r||""),r&&"object"==typeof r){if("string"!=typeof n)for(var i in n)i in r||(e.style[i]="");for(var i in r)e.style[i]="number"==typeof r[i]&&!1===Hy.test(i)?r[i]+"px":r[i]}}else if("dangerouslySetInnerHTML"===t)r&&(e.innerHTML=r.__html||"");else if("o"==t[0]&&"n"==t[1]){var o=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),r?n||e.addEventListener(t,ex,o):e.removeEventListener(t,ex,o),(e._listeners||(e._listeners={}))[t]=r}else if("list"!==t&&"type"!==t&&!a&&t in e)!function(e,t,n){try{e[t]=n}catch(e){}}(e,t,null==r?"":r),null!=r&&!1!==r||e.removeAttribute(t);else{var u=a&&t!==(t=t.replace(/^xlink:?/,""));null==r||!1===r?u?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof r&&(u?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),r):e.setAttribute(t,r))}else e.className=r||""}function ex(e){return this._listeners[e.type](jy.event&&jy.event(e)||e)}var tx=[],nx=0,rx=!1,ax=!1;function ix(){for(var e;e=tx.pop();)jy.afterMount&&jy.afterMount(e),e.componentDidMount&&e.componentDidMount()}function ox(e,t,n,r,a,i){nx++||(rx=null!=a&&void 0!==a.ownerSVGElement,ax=null!=e&&!("__preactattr_"in e));var o=ux(e,t,n,r,i);return a&&o.parentNode!==a&&a.appendChild(o),--nx||(ax=!1,i||ix()),o}function ux(e,t,n,r,a){var i=e,o=rx;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||a)?e.nodeValue!=t&&(e.nodeValue=t):(i=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild(i,e),sx(e,!0))),i.__preactattr_=!0,i;var u,s,c=t.nodeName;if("function"==typeof c)return function(e,t,n,r){var a=e&&e._component,i=a,o=e,u=a&&e._componentConstructor===t.nodeName,s=u,c=Qy(t);for(;a&&!s&&(a=a._parentComponent);)s=a.constructor===t.nodeName;a&&s&&(!r||a._component)?(px(a,c,3,n,r),e=a.base):(i&&!u&&(vx(i),e=o=null),a=fx(t.nodeName,c,n),e&&!a.nextBase&&(a.nextBase=e,o=null),px(a,c,1,n,r),e=a.base,o&&e!==o&&(o._component=null,sx(o,!1)));return e}(e,t,n,r);if(rx="svg"===c||"foreignObject"!==c&&rx,c=String(c),(!e||!Yy(e,c))&&(u=c,(s=rx?document.createElementNS("http://www.w3.org/2000/svg",u):document.createElement(u)).normalizedNodeName=u,i=s,e)){for(;e.firstChild;)i.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(i,e),sx(e,!0)}var l=i.firstChild,f=i.__preactattr_,d=t.children;if(null==f){f=i.__preactattr_={};for(var p=i.attributes,h=p.length;h--;)f[p[h].name]=p[h].value}return!ax&&d&&1===d.length&&"string"==typeof d[0]&&null!=l&&void 0!==l.splitText&&null==l.nextSibling?l.nodeValue!=d[0]&&(l.nodeValue=d[0]):(d&&d.length||null!=l)&&function(e,t,n,r,a){var i,o,u,s,c,l=e.childNodes,f=[],d={},p=0,h=0,v=l.length,g=0,m=t?t.length:0;if(0!==v)for(var y=0;y<v;y++){var x=l[y],b=x.__preactattr_;null!=(k=m&&b?x._component?x._component.__key:b.key:null)?(p++,d[k]=x):(b||(void 0!==x.splitText?!a||x.nodeValue.trim():a))&&(f[g++]=x)}if(0!==m)for(y=0;y<m;y++){var k;if(c=null,null!=(k=(s=t[y]).key))p&&void 0!==d[k]&&(c=d[k],d[k]=void 0,p--);else if(!c&&h<g)for(i=h;i<g;i++)if(void 0!==f[i]&&Xy(o=f[i],s,a)){c=o,f[i]=void 0,i===g-1&&g--,i===h&&h++;break}c=ux(c,s,n,r),u=l[y],c&&c!==e&&c!==u&&(null==u?e.appendChild(c):c===u.nextSibling?Zy(u):e.insertBefore(c,u))}if(p)for(var y in d)void 0!==d[y]&&sx(d[y],!1);for(;h<=g;)void 0!==(c=f[g--])&&sx(c,!1)}(i,d,n,r,ax||null!=f.dangerouslySetInnerHTML),function(e,t,n){var r;for(r in n)t&&null!=t[r]||null==n[r]||$y(e,r,n[r],n[r]=void 0,rx);for(r in t)"children"===r||"innerHTML"===r||r in n&&t[r]===("value"===r||"checked"===r?e[r]:n[r])||$y(e,r,n[r],n[r]=t[r],rx)}(i,t.attributes,f),rx=o,i}function sx(e,t){var n=e._component;n?vx(n):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||Zy(e),cx(e))}function cx(e){for(e=e.lastChild;e;){var t=e.previousSibling;sx(e,!0),e=t}}var lx={};function fx(e,t,n){var r,a=lx[e.name];if(e.prototype&&e.prototype.render?(r=new e(t,n),gx.call(r,t,n)):((r=new gx(t,n)).constructor=e,r.render=dx),a)for(var i=a.length;i--;)if(a[i].constructor===e){r.nextBase=a[i].nextBase,a.splice(i,1);break}return r}function dx(e,t,n){return this.constructor(e,n)}function px(e,t,n,r,a){e._disable||(e._disable=!0,(e.__ref=t.ref)&&delete t.ref,(e.__key=t.key)&&delete t.key,!e.base||a?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,r),r&&r!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=r),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==n&&(1!==n&&!1===jy.syncComponentUpdates&&e.base?Jy(e):hx(e,1,a)),e.__ref&&e.__ref(e))}function hx(e,t,n,r){if(!e._disable){var a,i,o,u=e.props,s=e.state,c=e.context,l=e.prevProps||u,f=e.prevState||s,d=e.prevContext||c,p=e.base,h=e.nextBase,v=p||h,g=e._component,m=!1;if(p&&(e.props=l,e.state=f,e.context=d,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(u,s,c)?m=!0:e.componentWillUpdate&&e.componentWillUpdate(u,s,c),e.props=u,e.state=s,e.context=c),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!m){a=e.render(u,s,c),e.getChildContext&&(c=Wy(Wy({},c),e.getChildContext()));var y,x,b=a&&a.nodeName;if("function"==typeof b){var k=Qy(a);(i=g)&&i.constructor===b&&k.key==i.__key?px(i,k,1,c,!1):(y=i,e._component=i=fx(b,k,c),i.nextBase=i.nextBase||h,i._parentComponent=e,px(i,k,0,c,!1),hx(i,1,n,!0)),x=i.base}else o=v,(y=g)&&(o=e._component=null),(v||1===t)&&(o&&(o._component=null),x=ox(o,a,c,n||!p,v&&v.parentNode,!0));if(v&&x!==v&&i!==g){var w=v.parentNode;w&&x!==w&&(w.replaceChild(x,v),y||(v._component=null,sx(v,!1)))}if(y&&vx(y),e.base=x,x&&!r){for(var A=e,E=e;E=E._parentComponent;)(A=E).base=x;x._component=A,x._componentConstructor=A.constructor}}if(!p||n?tx.unshift(e):m||(e.componentDidUpdate&&e.componentDidUpdate(l,f,d),jy.afterUpdate&&jy.afterUpdate(e)),null!=e._renderCallbacks)for(;e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);nx||r||ix()}}function vx(e){jy.beforeUnmount&&jy.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var n=e._component;n?vx(n):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,Zy(t),function(e){var t=e.constructor.name;(lx[t]||(lx[t]=[])).push(e)}(e),cx(t)),e.__ref&&e.__ref(null)}function gx(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{}}function mx(e,t,n){return ox(n,e,{},!1,t,!1)}Wy(gx.prototype,{setState:function(e,t){var n=this.state;this.prevState||(this.prevState=Wy({},n)),Wy(n,"function"==typeof e?e(n,this.props):e),t&&(this._renderCallbacks=this._renderCallbacks||[]).push(t),Jy(this)},forceUpdate:function(e){e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),hx(this,2)},render:function(){}});var yx={};s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(yx,"__esModule",{value:!0});var xx=function(e){p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.name,n=e.tab;this.props.registerSurface(t,n,this)}},{key:"componentDidUpdate",value:function(){return!1}},{key:"render",value:function(){var e=this,t=this.props,r=t.name,a=t.visible,i=t.styles,o=Object.assign({},n.defaultStyles,i),u=o.width,s=o.height,c=o.maxHeight,l=o.maxWidth;c=s===n.defaultStyles.height?c:s,l=u===n.defaultStyles.width?l:u;var f=Tv.css({display:a?"block":"none",backgroundColor:"white",marginTop:"10px",marginBottom:"10px",boxShadow:"0 0 6px -3px #777",padding:"10px !important",height:s,width:u,maxHeight:c,maxWidth:l,overflow:"auto"}),d=Tv.css({backgroundColor:"white",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",marginBottom:"20px",fontWeight:"600",textAlign:"center"}),p=Tv.css({boxSizing:"border-box"});return Vy("div",{className:"".concat(f," tf-surface"),ref:function(t){return e.container=t},"data-visible":a},Vy("div",{className:"".concat(d," tf-label"),ref:function(t){return e.label=t}},r),Vy("div",{className:"".concat(p," tf-draw-area"),ref:function(t){return e.drawArea=t}}))}}]),n}(gx);xx.defaultStyles={maxWidth:"550px",maxHeight:"580px",height:"auto",width:"auto"},yx.SurfaceComponent=xx;var bx={};s("1i51P");p=s("2vsUb"),h=s("d6iiX"),c=s("3QOYJ"),l=s("2tuUj");
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(bx,"__esModule",{value:!0});var kx=function(e){p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"render",value:function(){var e=this.props,t=e.tabNames,n=e.activeTab,r=e.handleClick,a=t.length>0?t.map((function(e){return Vy(Ax,{key:e,id:e,handleClick:r,isActive:e===n},e)})):null,i=Tv.css({overflowX:"scroll",overflowY:"hidden",whiteSpace:"nowrap",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"#eee",paddingBottom:"1rem",marginTop:"1rem"});return Vy("div",{className:"".concat(i," visor-tabs")},a)}}]),n}(gx);bx.Tabs=kx;var wx,Ax=function(e){p.default(n,e);var t=h.default(n);function n(){return c.default(this,n),t.apply(this,arguments)}return l.default(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isActive,r=e.handleClick,a=e.id,i=Tv.css({borderBottomColor:n?"#357EDD":"#AAAAAA",borderBottomWidth:"1px",borderBottomStyle:"solid",cursor:"pointer",":hover":{color:"#357EDD"},display:"inline-block",marginRight:"1rem",padding:".5rem",fontSize:"1rem",fontWeight:"bold"});return Vy("a",{className:"".concat(i," tf-tab"),"data-isactive":n,onClick:function(){return r(a)}},t)}}]),n}(gx),Ex=function(e){p.default(n,e);var t=h.default(n);function n(e){var r;c.default(this,n),(r=t.call(this,e)).surfaces=new Map;var a=null==e.startOpen||e.startOpen;return r.state={isOpen:a,isFullscreen:!1,activeTab:null,tabs:new Set},r.keyHandler=r.keyHandler.bind(Ye.default(r)),r}return l.default(n,[{key:"close",value:function(){this.setState({isOpen:!1})}},{key:"open",value:function(){this.setState({isOpen:!0})}},{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"toggleFullScreen",value:function(){this.setState({isFullscreen:!this.state.isFullscreen})}},{key:"isOpen",value:function(){return this.state.isOpen}},{key:"isFullscreen",value:function(){return this.state.isFullscreen}},{key:"getSurface",value:function(e,t){var n,r=this.surfaceId(e,t);if(!this.surfaces.has(r))throw Error("Surface not found with id: ".concat(r));return{container:(n=this.surfaces.get(r)).container,label:n.label,drawArea:n.drawArea}}},{key:"bindKeys",value:function(){document.addEventListener("keydown",this.keyHandler,!1)}},{key:"unbindKeys",value:function(){document.removeEventListener("keydown",this.keyHandler)}},{key:"surfaceId",value:function(e,t){return e+t}},{key:"setTabs",value:function(e){var t,n=e.map((function(e){return e.tab})),r=this.state.tabs,a=!0,i=!1,o=void 0;try{for(var u,s=n[Symbol.iterator]();!(a=(u=s.next()).done);a=!0){var c=u.value;r.has(c)||(r.add(c),t=c)}}catch(e){i=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}null!=t&&this.setState({tabs:r,activeTab:t})}},{key:"getTabs",value:function(){return this.state.tabs}},{key:"registerSurface",value:function(e,t,n){var r=this.surfaceId(e,t);this.surfaces.set(r,n)}},{key:"keyHandler",value:function(e){192===e.keyCode&&(e.shiftKey?this.toggleFullScreen():this.toggle())}},{key:"setActiveTab",value:function(e){this.setState({activeTab:e})}},{key:"componentDidMount",value:function(){this.bindKeys()}},{key:"componentWillMount",value:function(){this.setTabs(this.props.surfaceList)}},{key:"componentWillReceiveProps",value:function(e){this.setTabs(e.surfaceList)}},{key:"render",value:function(){var e=this,t=this.state,n=t.isOpen,r=t.isFullscreen,a=t.activeTab,i=this.props.surfaceList,o=Array.from(this.getTabs().values()),u=r?"90vw":"550px",s=Tv.css({width:u,height:"100%",backgroundColor:"#fafafa",boxSizing:"border-box",padding:"10px",position:"fixed",top:"0px",transition:"right 0.5s cubic-bezier(0.645, 0.045, 0.355, 1), width 0.5s cubic-bezier(0.645, 0.045, 0.355, 1)",boxShadow:"0 2px 5px rgba(0, 0, 0, 0.12), 0 2px 5px rgba(0, 0, 0, 0.24)",overflow:"auto",fontFamily:"sans-serif",fontSize:"14px",zIndex:1e3}),c=Tv.css({right:"0"}),l=Tv.css({right:"calc(-".concat(u," - 10px)")}),f=n?c:l,d=Tv.css({});return Vy("div",{className:"".concat(s," ").concat(f," visor"),"data-isopen":n,"data-isfullscreen":r},Vy(Cx,{fullScreenHandler:this.toggleFullScreen.bind(this),closeHandler:this.close.bind(this),isFullScreen:r}),Vy(bx.Tabs,{tabNames:o,activeTab:a,handleClick:this.setActiveTab.bind(this)}),Vy("div",{className:"".concat(d," visor-surfaces")},i.map((function(t){return Vy(yx.SurfaceComponent,{key:t.name+t.tab,name:t.name,tab:t.tab,styles:t.styles,registerSurface:e.registerSurface.bind(e),visible:a===t.tab})}))))}}],[{key:"render",value:function(e,t,r){return mx(Vy(n,Object.assign({},r)),e,t)}}]),n}(gx);function Cx(e){var t=e.isFullScreen,n=e.fullScreenHandler,r=e.closeHandler,a=Tv.css({display:"flex",backgroundColor:"white",border:"1px solid white",padding:"6px",paddingTop:"10px",marginBottom:"10px",borderRadius:"6px",marginTop:"-16px"}),i=Tv.css({fontSize:".875rem",borderRadius:".25rem",paddingLeft:"1rem",paddingRight:"1rem",paddingTop:".5rem",paddingBottom:".5rem",textDecoration:"none",transition:"color .15s ease-in",color:"#111"}),o=Tv.css({marginLeft:"auto"});return Vy("div",{className:"".concat(a," visor-controls")},Vy("button",{className:"".concat(i),onClick:n},t?"Minimize":"Maximize"),Vy("button",{className:"".concat(i," ").concat(o),onClick:r},"Hide"))}Py.VisorComponent=Ex;var Sx="tfjs-visor-container";By.visor=function(){if("undefined"==typeof document)throw new Error("No document defined. This library needs a browser/dom to work");if(document.getElementById(Sx)&&null!=wx)return wx;var e,t=document.getElementById(Sx);function n(t,n){var r=null;return e=Py.VisorComponent.render(t,e,{ref:function(e){return r=e},surfaceList:Array.from(n.values())}),r}null==t&&((t=document.createElement("div")).id=Sx,document.body.appendChild(t));var r=new Map,a=n(t,r);return wx=new Nx(a,t,r,n)};var Nx=function(){function e(t,n,r,a){c.default(this,e),this.visorComponent=t,this.el=n,this.surfaceList=r,this.renderVisor=a}return l.default(e,[{key:"surface",value:function(e){var t=e.name,n=null==e.tab?"Visor":e.tab;if(null==t||!("string"==typeof t||t instanceof String))throw new Error("You must pass a config object with a 'name' property to create or retrieve a surface");var r=Object.assign({},e,{tab:n}),a="".concat(t,"-").concat(n);return this.surfaceList.has(a)||this.surfaceList.set(a,r),this.renderVisor(this.el,this.surfaceList),this.visorComponent.getSurface(t,n)}},{key:"isFullscreen",value:function(){return this.visorComponent.isFullscreen()}},{key:"isOpen",value:function(){return this.visorComponent.isOpen()}},{key:"close",value:function(){return this.visorComponent.close()}},{key:"open",value:function(){return this.visorComponent.open()}},{key:"toggle",value:function(){return this.visorComponent.toggle()}},{key:"toggleFullScreen",value:function(){return this.visorComponent.toggleFullScreen()}},{key:"bindKeys",value:function(){return this.visorComponent.bindKeys()}},{key:"unbindKeys",value:function(){return this.visorComponent.unbindKeys()}},{key:"setActiveTab",value:function(e){if(!this.visorComponent.state.tabs.has(e))throw new Error("Tab '".concat(e,"' does not exist"));this.visorComponent.setState({activeTab:e})}}]),e}();By.Visor=Nx,Iy.getDrawArea=function(e){if(e instanceof HTMLElement)return e;if(My.isSurface(e))return e.drawArea;if(My.isSurfaceInfo(e))return By.visor().surface({name:e.name,tab:e.tab,styles:e.styles}).drawArea;throw new Error("Not a drawable")},Iy.shallowEquals=function(e,t){var n=Object.getOwnPropertyNames(e),r=Object.getOwnPropertyNames(t);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){var i=n[a];if(e[i]!==t[i])return!1}return!0},Iy.nextFrame=function(){return Ry(this,void 0,void 0,t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return requestAnimationFrame(e)}));case 2:case"end":return e.stop()}}),e)})))};var Tx={prepend:!1};Nv.subSurface=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=Iy.getDrawArea(e),a=Tv.css({"& canvas":{display:"block"},marginTop:".5rem",marginBottom:".5rem"}),i=Tv.css({backgroundColor:"white",display:"inline-block",boxSizing:"border-box",borderBottom:"1px solid #357EDD",lineHeight:"2em",padding:"0 10px 0 10px",marginBottom:"20px",fontWeight:"600",textAlign:"left"}),o=Object.assign({},Tx,n),u=r.querySelector("div[data-name=".concat(t,"]"));if(!u){if((u=document.createElement("div")).setAttribute("class","".concat(a)),u.dataset.name=t,o.title){var s=document.createElement("div");s.setAttribute("class","subsurface-title ".concat(i)),s.innerText=o.title,u.appendChild(s)}o.prepend?r.insertBefore(u,r.firstChild):r.appendChild(u)}return u},Nv.getDefaultWidth=function(e){for(var t=0,n=e;n&&0===n.clientWidth;)n=n.parentElement,t=50;return n.clientWidth-t},Nv.getDefaultHeight=function(e){return 0===e.clientHeight?200:e.clientHeight},Av.barchart=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Ev(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l,f,d,p,h,g,m,y,x,b,k;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Iy.getDrawArea(e),o=n,u=Object.assign({},Dx,r),!Fx.has(i)){t.next=13;break}if(s=Fx.get(i),!Iy.shallowEquals(u,s.lastOptions)){t.next=13;break}return t.next=8,Iy.nextFrame();case 8:return c=s.view,l=c.changeset().remove((function(){return!0})).insert(o),t.next=12,c.change("values",l).runAsync();case 12:return t.abrupt("return");case 13:return f=u.xLabel,d=u.yLabel,p=u.xType,h=u.yType,g=null,null!=f&&(g={title:f}),m=null,null!=d&&(m={title:d}),y={actions:!1,mode:"vega-lite",defaultStyle:!1},x=null!=u.color?Array.isArray(u.color)?{field:"index",type:"nominal",scale:{range:u.color}}:{value:u.color}:{value:"#4C78A0"},b={width:u.width||Nv.getDefaultWidth(i),height:u.height||Nv.getDefaultHeight(i),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:u.fontSize,titleFontSize:u.fontSize},text:{fontSize:u.fontSize},legend:{labelFontSize:u.fontSize,titleFontSize:u.fontSize}},data:{values:o,name:"values"},mark:{type:"bar",tooltip:!0},encoding:{x:{field:"index",type:p,axis:g},y:{field:"value",type:h,axis:m},color:x}},t.next=24,Iy.nextFrame();case 24:return t.next=26,Sv.default(i,b,y);case 26:k=t.sent,Fx.set(i,{view:k.view,lastOptions:u});case 28:case"end":return t.stop()}}),a)})))};var Dx={xLabel:"",yLabel:"",xType:"ordinal",yType:"quantitative",fontSize:11},Fx=new Map,Ox={},_x=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))}),Ix=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ox,"__esModule",{value:!0});var Rx=Ix(s("lJspJ"));Ox.confusionMatrix=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _x(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l,f,d,p,h,g,m,y,x,b,k,w,A,E,C,S;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=Object.assign({},Mx,r),o=Iy.getDrawArea(e),u=[],s=n.values,c=n.tickLabels||[],l=0===c.length,f=!0,d=0;d<s.length;d++)for(p=l?"Class ".concat(d):c[d],l&&c.push(p),h=0;h<s[d].length;h++)g=l?"Class ".concat(h):c[h],m=s[d][h],d!==h||i.shadeDiagonal?(u.push({label:p,prediction:g,count:m,scaleCount:m}),0!==m&&(f=!1)):u.push({label:p,prediction:g,count:m,noFill:!0});if(i.shadeDiagonal||!f){t.next=26;break}for(y=!0,x=!1,b=void 0,t.prev=10,k=u[Symbol.iterator]();!(y=(w=k.next()).done);y=!0)!0===(A=w.value).noFill&&(A.noFill=!1,A.scaleCount=A.count);t.next=18;break;case 14:t.prev=14,t.t0=t.catch(10),x=!0,b=t.t0;case 18:t.prev=18,t.prev=19,y||null==k.return||k.return();case 21:if(t.prev=21,!x){t.next=24;break}throw b;case 24:return t.finish(21);case 25:return t.finish(18);case 26:return E={actions:!1,mode:"vega-lite",defaultStyle:!1},C={width:i.width||Nv.getDefaultWidth(o),height:i.height||Nv.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize}},data:{values:u},encoding:{x:{field:"prediction",type:"ordinal",title:i.xLabel||"prediction",scale:{domain:c}},y:{field:"label",type:"ordinal",title:i.yLabel||"label",scale:{domain:c}}},layer:[{transform:[{filter:"datum.noFill != true"}],mark:{type:"rect"},encoding:{color:{field:"scaleCount",type:"quantitative",scale:{range:i.colorMap}},tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}]},!1===i.shadeDiagonal&&C.layer.push({transform:[{filter:"datum.noFill == true"}],mark:{type:"rect",fill:"white"},encoding:{tooltip:[{field:"label",type:"nominal"},{field:"prediction",type:"nominal"},{field:"count",type:"quantitative"}]}}),i.showTextOverlay&&C.layer.push({mark:{type:"text",baseline:"middle"},encoding:{text:{field:"count",type:"nominal"}}}),S="string"==typeof i.colorMap?{scheme:i.colorMap}:i.colorMap,C.layer[0].encoding.color.scale.range=S,t.next=34,Rx.default(o,C,E);case 34:case"end":return t.stop()}}),a,null,[[10,14,18,26],[19,,21,25]])})))};var Mx={xLabel:null,yLabel:null,xType:"nominal",yType:"nominal",shadeDiagonal:!0,fontSize:12,showTextOverlay:!0,height:400,colorMap:["#f7fbff","#4292c6"]},Bx={};s("1i51P");d=s("6vecG"),v=s("40Zzs");var Px=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},Lx=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},jx=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Bx,"__esModule",{value:!0});var zx=Lx(s("jbRpz")),Ux=jx(s("lJspJ")),Vx={};
/*
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
function Wx(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function Gx(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function Hx(e){return Px(this,void 0,void 0,t(v).mark((function n(){var r,a,i,o;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e instanceof zx.Tensor?(r=e.shape,a=e.transpose()):(r=[e.length,e[0].length],a=zx.tidy((function(){return zx.tensor2d(e).transpose()}))),Vx.assert(2===a.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),t.next=6,a.array();case 6:return i=t.sent,a.dispose(),o=[i.length,i[0].length],Vx.assert(r[0]===o[1]&&r[1]===o[0],"Unexpected transposed shape. Original ".concat(r," : Transposed ").concat(o)),t.abrupt("return",i);case 11:case"end":return t.stop()}}),n)})))}function qx(e,t,n){var r=e instanceof zx.Tensor?e.shape:[e.length,e[0].length];0===n?Vx.assert(r[0]===t.length,"Length of xTickLabels (".concat(t.length,") must match number of rows")+" (".concat(r[0],")")):1===n&&Vx.assert(r[1]===t.length,"Length of yTickLabels (".concat(t.length,") must match number of columns (").concat(r[1],")"))}Object.defineProperty(Vx,"__esModule",{value:!0}),Vx.assert=Wx,Vx.assertShapesMatch=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";Wx(Gx(e,t),n+" Shapes ".concat(e," and ").concat(t," must match"))},Vx.arraysEqual=Gx,Vx.DECIMAL_PLACES_TO_CHECK=4,Bx.heatmap=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Px(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l,f,p,h,g,m,y,x,b,k,w,A,E,C,S,N,T,D,F,O,_,I,R;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=Object.assign({},Jx,r),o=Iy.getDrawArea(e),u=n.values,!i.rowMajor){t.next=7;break}return t.next=6,Hx(n.values);case 6:u=t.sent;case 7:if(s=n.xTickLabels,c=n.yTickLabels,null!=s&&(0,qx(u,s,0)),null!=c&&(1,qx(u,c,1)),l="@tfidx@",f=[],!(u instanceof zx.Tensor)){t.next=21;break}return Vx.assert(2===u.rank,"Input to renderHeatmap must be a 2d array or Tensor2d"),t.next=16,u.data();case 16:for(p=t.sent,h=d.default(u.shape,2),g=h[0],m=h[1],y=0;y<g;y++)for(x=s?"".concat(s[y]).concat(l).concat(y):y,b=0;b<m;b++)k=c?"".concat(c[b]).concat(l).concat(b):b,w=p[y*m+b],f.push({x:x,y:k,value:w});t.next=22;break;case 21:for(A=u,E=0;E<A.length;E++)for(C=s?"".concat(s[E]).concat(l).concat(E):E,S=0;S<A[E].length;S++)N=c?"".concat(c[S]).concat(l).concat(S):S,T=A[E][S],f.push({x:C,y:N,value:T});case 22:D={actions:!1,mode:"vega-lite",defaultStyle:!1},F={width:i.width||Nv.getDefaultWidth(o),height:i.height||Nv.getDefaultHeight(o),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},text:{fontSize:i.fontSize},legend:{labelFontSize:i.fontSize,titleFontSize:i.fontSize},scale:{bandPaddingInner:0,bandPaddingOuter:0}},data:{values:f},mark:{type:"rect",tooltip:!0},encoding:{x:{field:"x",type:i.xType,title:i.xLabel,sort:!1},y:{field:"y",type:i.yType,title:i.yLabel,sort:!1},fill:{field:"value",type:"quantitative"}}},O="".concat(l,"\\d+$"),_=new RegExp(O),s&&(F.encoding.x.axis={labelExpr:"replace(datum.value, regexp(/".concat(O,"/), '')")}),c&&(F.encoding.y.axis={labelExpr:"replace(datum.value, regexp(/".concat(O,"/), '')")}),(s||c)&&(D.tooltip={sanitize:function(e){return String(e).replace(_,"")}}),t.t0=i.colorMap,t.next="blues"===t.t0?33:"greyscale"===t.t0?35:(t.t0,37);break;case 33:return I=["#f7fbff","#4292c6"],t.abrupt("break",39);case 35:return I=["#000000","#ffffff"],t.abrupt("break",39);case 37:return I="viridis",t.abrupt("break",39);case 39:return"viridis"!==I&&(F.encoding.fill.scale={range:I}),i.domain&&(null!=(R=F.encoding.fill).scale?R.scale=Object.assign({},R.scale,{domain:i.domain}):R.scale={domain:i.domain}),t.next=43,Ux.default(o,F,D);case 43:case"end":return t.stop()}}),a)})))};var Jx={xLabel:null,yLabel:null,xType:"ordinal",yType:"ordinal",colorMap:"viridis",fontSize:12,domain:null,rowMajor:!1},Kx={},Xx=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))}),Yx=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Kx,"__esModule",{value:!0}),s("cftDg");var Qx=s("l2BE5"),Zx=Yx(s("lJspJ")),$x={};s("1i51P");d=s("6vecG"),v=s("40Zzs");var eb=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};Object.defineProperty($x,"__esModule",{value:!0}),s("jbRpz");m=s("P1tXK"),nt=s("bftEy"),Ls=s("k7Du7");$x.arrayStats=function(e){if(!Array.isArray(e))throw new Error("input must be an array");if(0===e.length)return{numVals:0,numNans:0,numZeros:0,max:void 0,min:void 0};for(var t=e.length,n=-1/0,r=1/0,a=0,i=0,o=0,u=0;u<t;u++){var s=e[u];s>n&&(n=s),s<r&&(r=s),0===s&&(a+=1),isNaN(s)?i+=1:isFinite(s)||(o+=1)}var c={numVals:t,numZeros:a,numNans:i,max:n,min:r,numInfs:o};return c.max===-1/0&&(c.max=NaN),c.min===1/0&&(c.min=NaN),c},$x.tensorStats=function(e){return eb(this,void 0,void 0,t(v).mark((function n(){var r,a,i,o;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=d.default(m.tidy((function(){var t=nt.scalar(0,e.dtype);return[e.min(),e.max(),e.equal(t).sum()]})),3),a=r[0],i=r[1],o=r[2],t.abrupt("return",Promise.all([e.data(),a.data(),i.data(),o.data()]).then((function(e){for(var t=d.default(e,4),n=t[0],r=t[1],a=t[2],i=t[3],o=n.length,u=0,s=0,c=0;c<o;c++){var l=n[c];isNaN(l)?u+=1:isFinite(l)||(s+=1)}var f=r[0],p=a[0];return u===o&&(f=NaN,p=NaN),{numVals:o,numZeros:i[0],numNans:u,min:f,max:p,numInfs:s}})));case 2:case"end":return t.stop()}}),n)})))},$x.confusionMatrix=function(e,n,r,a){return eb(this,void 0,void 0,t(v).mark((function i(){var o,u,s;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Vx.assert(1===e.rank,"labels must be a 1D tensor"),Vx.assert(1===n.rank,"predictions must be a 1D tensor"),Vx.assert(e.size===n.size,"labels and predictions must be the same length"),null!=a&&Vx.assert(a.size===n.size,"labels and predictions must be the same length"),o=e.cast("int32"),u=n.cast("int32"),null==r&&(r=m.tidy((function(){return Ls.maximum(o.max(),u.max()).cast("int32").dataSync()[0]+1}))),s=Promise.resolve(null),null!=a&&(s=a.data()),t.abrupt("return",Promise.all([o.data(),u.data(),s]).then((function(e){for(var t=d.default(e,3),n=t[0],a=t[1],i=t[2],o=Array(r).fill(0),u=0;u<r;u++)o[u]=Array(r).fill(0);for(var s=0;s<n.length;s++){var c=n[s],l=a[s];o[c][l]+=null!=i?i[s]:1}return o})));case 10:case"end":return t.stop()}}),i)})))},$x.accuracy=function(e,n){return eb(this,void 0,void 0,t(v).mark((function r(){var a,i,o;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Vx.assertShapesMatch(e.shape,n.shape,"Error computing accuracy."),a=e.equal(n),i=a.mean(),t.next=5,i.data();case 5:return o=t.sent[0],m.dispose([a,i]),t.abrupt("return",o);case 8:case"end":return t.stop()}}),r)})))},$x.perClassAccuracy=function(e,n,r){return eb(this,void 0,void 0,t(v).mark((function a(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return Vx.assert(1===e.rank,"labels must be a 1D tensor"),Vx.assert(1===n.rank,"predictions must be a 1D tensor"),Vx.assert(e.size===n.size,"labels and predictions must be the same length"),null==r&&(r=m.tidy((function(){return Ls.maximum(e.max(),n.max()).dataSync()[0]+1}))),t.abrupt("return",Promise.all([e.data(),n.data()]).then((function(e){for(var t=d.default(e,2),n=t[0],a=t[1],i=Array(r).fill(0),o=Array(r).fill(0),u=0;u<n.length;u++){var s=n[u],c=a[u];i[s]+=1,s===c&&(o[s]+=1)}for(var l=[],f=0;f<i.length;f++)l.push({count:i[f],accuracy:0===i[f]?0:o[f]/i[f]});return l})));case 5:case"end":return t.stop()}}),a)})))};var tb={};
/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */
Object.defineProperty(tb,"__esModule",{value:!0}),s("cftDg");Qx=s("l2BE5");var nb="http://www.w3.org/1999/xhtml",rb={svg:"http://www.w3.org/2000/svg",xhtml:nb,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ab(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),rb.hasOwnProperty(t)?{space:rb[t],local:e}:e}function ib(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===nb&&t.documentElement.namespaceURI===nb?t.createElement(e):t.createElementNS(n,e)}}function ob(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function ub(e){var t=ab(e);return(t.local?ob:ib)(t)}function sb(){}function cb(e){return null==e?sb:function(){return this.querySelector(e)}}function lb(){return[]}var fb=function(e){return function(){return this.matches(e)}};if("undefined"!=typeof document){var db=document.documentElement;if(!db.matches){var pb=db.webkitMatchesSelector||db.msMatchesSelector||db.mozMatchesSelector||db.oMatchesSelector;fb=function(e){return function(){return pb.call(this,e)}}}}var hb=fb;function vb(e){return new Array(e.length)}function gb(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}gb.prototype={constructor:gb,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function mb(e,t,n,r,a,i){for(var o,u=0,s=t.length,c=i.length;u<c;++u)(o=t[u])?(o.__data__=i[u],r[u]=o):n[u]=new gb(e,i[u]);for(;u<s;++u)(o=t[u])&&(a[u]=o)}function yb(e,t,n,r,a,i,o){var u,s,c,l={},f=t.length,d=i.length,p=new Array(f);for(u=0;u<f;++u)(s=t[u])&&(p[u]=c="$"+o.call(s,s.__data__,u,t),c in l?a[u]=s:l[c]=s);for(u=0;u<d;++u)(s=l[c="$"+o.call(e,i[u],u,i)])?(r[u]=s,s.__data__=i[u],l[c]=null):n[u]=new gb(e,i[u]);for(u=0;u<f;++u)(s=t[u])&&l[p[u]]===s&&(a[u]=s)}function xb(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function bb(e){return function(){this.removeAttribute(e)}}function kb(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wb(e,t){return function(){this.setAttribute(e,t)}}function Ab(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Eb(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function Cb(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Sb(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Nb(e){return function(){this.style.removeProperty(e)}}function Tb(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Db(e,t,n){return function(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function Fb(e,t){return e.style.getPropertyValue(t)||Sb(e).getComputedStyle(e,null).getPropertyValue(t)}function Ob(e){return function(){delete this[e]}}function _b(e,t){return function(){this[e]=t}}function Ib(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function Rb(e){return e.trim().split(/^|\s+/)}function Mb(e){return e.classList||new Bb(e)}function Bb(e){this._node=e,this._names=Rb(e.getAttribute("class")||"")}function Pb(e,t){for(var n=Mb(e),r=-1,a=t.length;++r<a;)n.add(t[r])}function Lb(e,t){for(var n=Mb(e),r=-1,a=t.length;++r<a;)n.remove(t[r])}function jb(e){return function(){Pb(this,e)}}function zb(e){return function(){Lb(this,e)}}function Ub(e,t){return function(){(t.apply(this,arguments)?Pb:Lb)(this,e)}}function Vb(){this.textContent=""}function Wb(e){return function(){this.textContent=e}}function Gb(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function Hb(){this.innerHTML=""}function qb(e){return function(){this.innerHTML=e}}function Jb(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function Kb(){this.nextSibling&&this.parentNode.appendChild(this)}function Xb(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yb(){return null}function Qb(){var e=this.parentNode;e&&e.removeChild(this)}function Zb(){return this.parentNode.insertBefore(this.cloneNode(!1),this.nextSibling)}function $b(){return this.parentNode.insertBefore(this.cloneNode(!0),this.nextSibling)}Bb.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var ek={},tk=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(ek={mouseenter:"mouseover",mouseleave:"mouseout"}));function nk(e,t,n){return e=rk(e,t,n),function(t){var n=t.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||e.call(this,t)}}function rk(e,t,n){return function(r){var a=tk;tk=r;try{e.call(this,this.__data__,t,n)}finally{tk=a}}}function ak(e){return e.trim().split(/^|\s+/).map((function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}}))}function ik(e){return function(){var t=this.__on;if(t){for(var n,r=0,a=-1,i=t.length;r<i;++r)n=t[r],e.type&&n.type!==e.type||n.name!==e.name?t[++a]=n:this.removeEventListener(n.type,n.listener,n.capture);++a?t.length=a:delete this.__on}}}function ok(e,t,n){var r=ek.hasOwnProperty(e.type)?nk:rk;return function(a,i,o){var u,s=this.__on,c=r(t,i,o);if(s)for(var l=0,f=s.length;l<f;++l)if((u=s[l]).type===e.type&&u.name===e.name)return this.removeEventListener(u.type,u.listener,u.capture),this.addEventListener(u.type,u.listener=c,u.capture=n),void(u.value=t);this.addEventListener(e.type,c,n),u={type:e.type,name:e.name,value:t,listener:c,capture:n},s?s.push(u):this.__on=[u]}}function uk(e,t,n){var r=Sb(e),a=r.CustomEvent;"function"==typeof a?a=new a(t,n):(a=r.document.createEvent("Event"),n?(a.initEvent(t,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(t,!1,!1)),e.dispatchEvent(a)}function sk(e,t){return function(){return uk(this,e,t)}}function ck(e,t){return function(){return uk(this,e,t.apply(this,arguments))}}var lk=[null];function fk(e,t){this._groups=e,this._parents=t}function dk(){return new fk([[document.documentElement]],lk)}fk.prototype=dk.prototype={constructor:fk,select:function(e){"function"!=typeof e&&(e=cb(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o,u=t[a],s=u.length,c=r[a]=new Array(s),l=0;l<s;++l)(i=u[l])&&(o=e.call(i,i.__data__,l,u))&&("__data__"in i&&(o.__data__=i.__data__),c[l]=o);return new fk(r,this._parents)},selectAll:function(e){var t;"function"!=typeof e&&(e=null==(t=e)?lb:function(){return this.querySelectorAll(t)});for(var n=this._groups,r=n.length,a=[],i=[],o=0;o<r;++o)for(var u,s=n[o],c=s.length,l=0;l<c;++l)(u=s[l])&&(a.push(e.call(u,u.__data__,l,s)),i.push(u));return new fk(a,i)},filter:function(e){"function"!=typeof e&&(e=hb(e));for(var t=this._groups,n=t.length,r=new Array(n),a=0;a<n;++a)for(var i,o=t[a],u=o.length,s=r[a]=[],c=0;c<u;++c)(i=o[c])&&e.call(i,i.__data__,c,o)&&s.push(i);return new fk(r,this._parents)},data:function(e,t){if(!e)return p=new Array(this.size()),c=-1,this.each((function(e){p[++c]=e})),p;var n=t?yb:mb,r=this._parents,a=this._groups;"function"!=typeof e&&(e=function(e){return function(){return e}}(e));for(var i=a.length,o=new Array(i),u=new Array(i),s=new Array(i),c=0;c<i;++c){var l=r[c],f=a[c],d=f.length,p=e.call(l,l&&l.__data__,c,r),h=p.length,v=u[c]=new Array(h),g=o[c]=new Array(h);n(l,f,v,g,s[c]=new Array(d),p,t);for(var m,y,x=0,b=0;x<h;++x)if(m=v[x]){for(x>=b&&(b=x+1);!(y=g[b])&&++b<h;);m._next=y||null}}return(o=new fk(o,r))._enter=u,o._exit=s,o},enter:function(){return new fk(this._enter||this._groups.map(vb),this._parents)},exit:function(){return new fk(this._exit||this._groups.map(vb),this._parents)},merge:function(e){for(var t=this._groups,n=e._groups,r=t.length,a=n.length,i=Math.min(r,a),o=new Array(r),u=0;u<i;++u)for(var s,c=t[u],l=n[u],f=c.length,d=o[u]=new Array(f),p=0;p<f;++p)(s=c[p]||l[p])&&(d[p]=s);for(;u<r;++u)o[u]=t[u];return new fk(o,this._parents)},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r,a=e[t],i=a.length-1,o=a[i];--i>=0;)(r=a[i])&&(o&&o!==r.nextSibling&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=xb);for(var n=this._groups,r=n.length,a=new Array(r),i=0;i<r;++i){for(var o,u=n[i],s=u.length,c=a[i]=new Array(s),l=0;l<s;++l)(o=u[l])&&(c[l]=o);c.sort(t)}return new fk(a,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){var e=new Array(this.size()),t=-1;return this.each((function(){e[++t]=this})),e},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],a=0,i=r.length;a<i;++a){var o=r[a];if(o)return o}return null},size:function(){var e=0;return this.each((function(){++e})),e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var a,i=t[n],o=0,u=i.length;o<u;++o)(a=i[o])&&e.call(a,a.__data__,o,i);return this},attr:function(e,t){var n=ab(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==t?n.local?kb:bb:"function"==typeof t?n.local?Cb:Eb:n.local?Ab:wb)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?Nb:"function"==typeof t?Db:Tb)(e,t,null==n?"":n)):Fb(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Ob:"function"==typeof t?Ib:_b)(e,t)):this.node()[e]},classed:function(e,t){var n=Rb(e+"");if(arguments.length<2){for(var r=Mb(this.node()),a=-1,i=n.length;++a<i;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof t?Ub:t?jb:zb)(n,t))},text:function(e){return arguments.length?this.each(null==e?Vb:("function"==typeof e?Gb:Wb)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?Hb:("function"==typeof e?Jb:qb)(e)):this.node().innerHTML},raise:function(){return this.each(Kb)},lower:function(){return this.each(Xb)},append:function(e){var t="function"==typeof e?e:ub(e);return this.select((function(){return this.appendChild(t.apply(this,arguments))}))},insert:function(e,t){var n="function"==typeof e?e:ub(e),r=null==t?Yb:"function"==typeof t?t:cb(t);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Qb)},clone:function(e){return this.select(e?$b:Zb)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var r,a,i=ak(e+""),o=i.length;if(!(arguments.length<2)){for(u=t?ok:ik,null==n&&(n=!1),r=0;r<o;++r)this.each(u(i[r],t,n));return this}var u=this.node().__on;if(u)for(var s,c=0,l=u.length;c<l;++c)for(r=0,s=u[c];r<o;++r)if((a=i[r]).type===s.type&&a.name===s.name)return s.value},dispatch:function(e,t){return this.each(("function"==typeof t?ck:sk)(e,t))}};function pk(e){return"string"==typeof e?new fk([[document.querySelector(e)]],[document.documentElement]):new fk([[e]],lk)}var hk=0;function vk(){this._="@"+(++hk).toString(36)}vk.prototype=function(){return new vk}.prototype={constructor:vk,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}},tb.table=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t&&null==t.headers)throw new Error('Data to render must have a "headers" property');if(t&&null==t.values)throw new Error('Data to render must have a "values" property');var r=Iy.getDrawArea(e),a=Object.assign({},gk,n),i=pk(r).select("table.tf-table"),o=Tv.css({fontSize:a.fontSize||".875rem",width:"100%",maxWidth:"64rem",marginRight:"auto",marginLeft:"auto"});if(0===i.size()&&((i=pk(r).append("table")).attr("class"," ".concat(o," tf-table")),i.append("thead").append("tr"),i.append("tbody")),1!==i.size())throw new Error("Error inserting table");var u=Tv.css({fontWeight:"600",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )",textAlign:"left",paddingBottom:"1rem",paddingRight:"1rem",backgroundColor:"#fff"}),s=i.select("thead").select("tr").selectAll("th").data(t.headers),c=s.enter().append("th").attr("class","".concat(u));s.merge(c).html((function(e){return e})),s.exit().remove();var l=Qx.format(",.4~f"),f=i.select("tbody").selectAll("tr").data(t.values),d=f.enter().append("tr"),p=Tv.css({padding:"0.25rem",borderBottomStyle:"solid",borderBottomWidth:"1px",borderColor:"rgba( 0, 0, 0, .2 )"}),h=f.merge(d).selectAll("td").data((function(e){return e})),v=h.enter().append("td").attr("class","".concat(p));h.merge(v).html((function(e){return"number"==typeof e?l(e):e})),h.exit().remove(),f.exit().remove()};var gk={fontSize:14},mk={maxBins:12,fontSize:11};function yk(e,t,n){var r=Qx.format(",.4~f"),a=Qx.format(".4~p"),i=[],o=[];if(null!=e.numVals&&(i.push("Num Vals"),o.push(r(e.numVals))),null!=e.min&&(i.push("Min"),o.push(r(e.min))),null!=e.max&&(i.push("Max"),o.push(r(e.max))),null!=e.numZeros){i.push("# Zeros");var u="";e.numVals&&(u=e.numZeros>0?"(".concat(a(e.numZeros/e.numVals),")"):""),o.push("".concat(r(e.numZeros)," ").concat(u))}if(null!=e.numNans){i.push("# NaNs");var s="";e.numVals&&(s=e.numNans>0?"(".concat(a(e.numNans/e.numVals),")"):""),o.push("".concat(r(e.numNans)," ").concat(s))}if(null!=e.numInfs){i.push("# Infinity");var c="";e.numVals&&(c=e.numInfs>0?"(".concat(a(e.numInfs/e.numVals),")"):""),o.push("".concat(r(e.numInfs)," ").concat(c))}tb.table(t,{headers:i,values:[o]},n)}function xk(e){if(null==e.length)throw new Error("input data must be an array");if(0===e.length)return[];if("object"==typeof e[0]){if(null==e[0].value)throw new Error("input data must have a value field");return e}for(var t=Array(e.length),n=0;n<e.length;n++)t[n]={value:e[n]};return t}Kx.histogram=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Xx(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l,f,d,p,h;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=xk(n),o=Object.assign({},mk,r),u={actions:!1,mode:"vega-lite",defaultStyle:!1},s=Nv.subSurface(e,"histogram"),!1!==r.stats&&(c=Nv.subSurface(e,"stats",{prepend:!0}),l=r.stats?r.stats:$x.arrayStats(i.map((function(e){return e.value}))),yk(l,c,{fontSize:o.fontSize})),0!==i.length){t.next=7;break}return t.abrupt("return",void 0);case 7:for(f=[],d=0;d<i.length;d++)null!=(p=i[d].value)&&isFinite(p)&&f.push(i[d]);return h={width:o.width||Nv.getDefaultWidth(s),height:o.height||Nv.getDefaultHeight(s),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},data:{values:f},mark:{type:"bar",tooltip:!0},config:{axis:{labelFontSize:o.fontSize,titleFontSize:o.fontSize},text:{fontSize:o.fontSize},legend:{labelFontSize:o.fontSize,titleFontSize:o.fontSize}},encoding:{x:{bin:{maxbins:o.maxBins},field:"value",type:"quantitative"},y:{aggregate:"count",type:"quantitative"},color:{value:o.color||"#001B44"}}},t.abrupt("return",Zx.default(s,h,u));case 11:case"end":return t.stop()}}),a)})))};var bk={};s("1i51P");Pe=s("9M1dW"),v=s("40Zzs");var kk=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},wk=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(bk,"__esModule",{value:!0});var Ak=wk(s("lJspJ"));bk.linechart=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return kk(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l,f,d,p,h,g,m,y,x;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=Array.isArray(n.values[0])?n.values:[n.values],o=i[0].length,u=n.series?n.series:i.map((function(e,t){return"Series ".concat(t+1)})),Vx.assert(u.length===i.length,"Must have an equal number of series labels as there are data series"),null!=r.seriesColors&&Vx.assert(r.seriesColors.length===i.length,"Must have an equal number of series colors as there are data series"),s=[],c=0;c<o;c++)l={x:c},u.forEach((function(e,t){var n=i[t][c].y;l[e]=n,l["".concat(e,"-name")]=e})),s.push(l);return f=Object.assign({},Ek,r),d=function(){return f.zoomToFit?{zero:!1}:null!=f.yAxisDomain?{domain:f.yAxisDomain}:void 0},p={x:{field:"x",type:f.xType,title:f.xLabel},tooltip:[{field:"x",type:"quantitative"}].concat(Pe.default(u.map((function(e){return{field:e,type:"quantitative"}}))))},h=u.map((function(e){return{data:void 0,mark:{type:"line",clip:!0},encoding:{y:{field:e,type:f.yType,title:f.yLabel,scale:d()},color:{field:"".concat(e,"-name"),type:"nominal",legend:{values:u,title:null},scale:{range:f.seriesColors}}}}})),g={mark:"rule",selection:{hover:{type:"single",on:"mouseover",nearest:!0,clear:"mouseout"}},encoding:{color:{value:"grey",condition:{selection:{not:"hover"},value:"transparent"}}}},m=Iy.getDrawArea(e),y={width:f.width||Nv.getDefaultWidth(m),height:f.height||Nv.getDefaultHeight(m),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:f.fontSize,titleFontSize:f.fontSize},text:{fontSize:f.fontSize},legend:{labelFontSize:f.fontSize,titleFontSize:f.fontSize}},data:{values:s},encoding:p,layer:Pe.default(h).concat([g])},x={actions:!1,mode:"vega-lite",defaultStyle:!1},t.next=17,Ak.default(m,y,x);case 17:return t.abrupt("return",Promise.resolve());case 18:case"end":return t.stop()}}),a)})))};var Ek={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11},Ck={};s("1i51P");Pe=s("9M1dW"),v=s("40Zzs");var Sk=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))},Nk=function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ck,"__esModule",{value:!0});var Tk=Nk(s("lJspJ"));Ck.scatterplot=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Sk(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l,f,d,p;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=n.values,o=null==n.series?[]:n.series,i=Array.isArray(i[0])?i:[i],u=[],i.forEach((function(e,t){var n,r=null!=o[t]?o[t]:"Series ".concat(t+1),a=e.map((function(e){return Object.assign({},e,{series:r})}));(n=u).push.apply(n,Pe.default(a))})),null!=r.seriesColors&&Vx.assert(r.seriesColors.length===i.length,"Must have an equal number of series colors as there are data series"),s=Iy.getDrawArea(e),c=Object.assign({},Dk,r),l={actions:!1,mode:"vega-lite",defaultStyle:!1},f=function(){return c.zoomToFit?{zero:!1}:null!=c.xAxisDomain?{domain:c.xAxisDomain}:void 0},d=function(){return c.zoomToFit?{zero:!1}:null!=c.yAxisDomain?{domain:c.yAxisDomain}:void 0},p={width:c.width||Nv.getDefaultWidth(s),height:c.height||Nv.getDefaultHeight(s),padding:0,autosize:{type:"fit",contains:"padding",resize:!0},config:{axis:{labelFontSize:c.fontSize,titleFontSize:c.fontSize},text:{fontSize:c.fontSize},legend:{labelFontSize:c.fontSize,titleFontSize:c.fontSize}},data:{values:u},mark:{type:"point",clip:!0,tooltip:{content:"data"}},encoding:{x:{field:"x",type:c.xType,title:c.xLabel,scale:f()},y:{field:"y",type:c.yType,title:c.yLabel,scale:d()},color:{field:"series",type:"nominal",scale:{range:c.seriesColors}},shape:{field:"series",type:"nominal"}}},t.next=14,Tk.default(s,p,l);case 14:return t.abrupt("return",Promise.resolve());case 15:case"end":return t.stop()}}),a)})))};var Dk={xLabel:"x",yLabel:"y",xType:"quantitative",yType:"quantitative",zoomToFit:!1,fontSize:11},Fk={};s("1i51P");af=s("4Ui3v"),v=s("40Zzs");var Ok=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))};function _k(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Ok(this,void 0,void 0,t(v).mark((function i(){var o,u,s,c,l,f,d,p,h,g,m,y,x,b,k,w,A,E,C,S,N,T,D,F;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(o=Iy.getDrawArea(e),u={},s=!0,c=!1,l=void 0,t.prev=3,f=r[Symbol.iterator]();!(s=(d=f.next()).done);s=!0)p=d.value,/val_/.test(p)?(g=p.replace("val_",""),Ik(u,g),m=Rk(n,p,r.indexOf(p)),u[g].series.push(p),u[g].values.push(m)):(h=Rk(n,p,r.indexOf(p)),Ik(u,p),u[p].series.push(p),u[p].values.push(h));t.next=11;break;case 7:t.prev=7,t.t0=t.catch(3),c=!0,l=t.t0;case 11:t.prev=11,t.prev=12,s||null==f.return||f.return();case 14:if(t.prev=14,!c){t.next=17;break}throw l;case 17:return t.finish(14);case 18:return t.finish(11);case 19:for(y=Object.keys(u),x=Object.assign({},{xLabel:"Iteration",yLabel:"Value"},a),b=[],k=!0,w=!1,A=void 0,t.prev=23,E=y[Symbol.iterator]();!(k=(C=E.next()).done);k=!0)S=C.value,N=Nv.subSurface(o,S),T=u[S].series,D=u[S].values,T.every((function(e){return Boolean(e.match("acc"))}))&&(x.zoomToFitAccuracy?x.zoomToFit=!0:(x.yAxisDomain=[0,1],delete x.zoomToFit)),F=bk.linechart(N,{values:D,series:T},x),b.push(F);t.next=31;break;case 27:t.prev=27,t.t1=t.catch(23),w=!0,A=t.t1;case 31:t.prev=31,t.prev=32,k||null==E.return||E.return();case 34:if(t.prev=34,!w){t.next=37;break}throw A;case 37:return t.finish(34);case 38:return t.finish(31);case 39:return t.next=41,Promise.all(b);case 41:case"end":return t.stop()}}),i,null,[[3,7,11,19],[12,,14,18],[23,27,31,39],[32,,34,38]])})))}function Ik(e,t){null==e[t]&&(e[t]={series:[],values:[]})}function Rk(e,t,n){if(Array.isArray(e)){for(var r=Array.isArray(e[0])?e[n]:e,a=[],i=0;i<r.length;i++){var o=r[i];a.push({x:i,y:o[t]})}return a}return e.history[t].map((function(e,t){return{x:t,y:e}}))}function Mk(e,t,n){return null==e[t]&&(e[t]={}),null==e[t][n]&&(e[t][n]=[]),e[t][n]}Object.defineProperty(Fk,"__esModule",{value:!0}),Fk.history=_k,Fk.fitCallbacks=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a={},i=r.callbacks||["onEpochEnd","onBatchEnd"],o=Iy.getDrawArea(e),u=Object.assign({},r);function s(e){var r=this;return function(i,s){return Ok(r,void 0,void 0,t(v).mark((function r(){var i,c,l,f,d,p,h,g,m;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(/batch/i.test(e)?u.xLabel="Batch":/epoch/i.test(e)&&(u.xLabel="Epoch"),i=[],c=[],l=!0,f=!1,d=void 0,t.prev=4,p=n[Symbol.iterator]();!(l=(h=p.next()).done);l=!0)g=h.value,null!=s[g]&&(c.push(g),(m=Mk(a,e,g)).push(af.default({},g,s[g])),i.push(m));t.next=12;break;case 8:t.prev=8,t.t0=t.catch(4),f=!0,d=t.t0;case 12:t.prev=12,t.prev=13,l||null==p.return||p.return();case 15:if(t.prev=15,!f){t.next=18;break}throw d;case 18:return t.finish(15);case 19:return t.finish(12);case 20:return _k(Nv.subSurface(o,e,{title:e}),i,c,u),t.next=24,Iy.nextFrame();case 24:case"end":return t.stop()}}),r,null,[[4,8,12,20],[13,,15,19]])})))}}delete u.callbacks;var c={};return i.forEach((function(e){c[e]=s(e)})),c};var Bk={},Pk=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))});function Lk(e){return{layers:e.layers.map(jk)}}function jk(e){var t;if(Array.isArray(e.outputShape[0])){var n=e.outputShape.map((function(e){return Uk(e)}));t="[".concat(n.join(", "),"]")}else t=Uk(e.outputShape);return{name:e.name,trainable:e.trainable,parameters:e.countParams(),outputShape:t}}function zk(e){return Pk(this,void 0,void 0,t(v).mark((function n(){var r,a,i,o,u;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getWeights(),a=e.weights,i=r.map($x.tensorStats),t.next=5,Promise.all(i);case 5:return o=t.sent,u=r.map((function(e){return e.shape})),t.abrupt("return",r.map((function(e,t){return{name:a[t].name,stats:o[t],shape:Uk(u[t]),weight:e}})));case 8:case"end":return t.stop()}}),n)})))}function Uk(e){var t=e.slice();return 0===t.length?"Scalar":(null===t[0]&&(t[0]="batch"),"[".concat(t.join(","),"]"))}function Vk(e,t,n){var r="\n    <select>\n      ".concat(e.map((function(e){return"<option value=".concat(e,">").concat(e,"</option>")})),"\n    </select>\n  "),a="<div>".concat("<button>Show Values Distribution for:</button>").concat(r,"</div>");t.innerHTML=a;var i=t.querySelector("button"),o=t.querySelector("select");i.addEventListener("click",(function(){n(o.selectedOptions[0].label)}))}Object.defineProperty(Bk,"__esModule",{value:!0}),Bk.modelSummary=function(e,n){return Pk(this,void 0,void 0,t(v).mark((function r(){var a,i,o,u;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=Iy.getDrawArea(e),i=Lk(n),o=["Layer Name","Output Shape","# Of Params","Trainable"],u=i.layers.map((function(e){return[e.name,e.outputShape,e.parameters,e.trainable]})),tb.table(a,{headers:o,values:u});case 5:case"end":return t.stop()}}),r)})))},Bk.layer=function(e,n){return Pk(this,void 0,void 0,t(v).mark((function r(){var a,i,o,u,s,c,l,f,d;return t(v).wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return a=this,i=Iy.getDrawArea(e),r.next=4,zk(n);case 4:o=r.sent,u=["Weight Name","Shape","Min","Max","# Params","# Zeros","# NaNs","# Infinity"],s=Nv.subSurface(i,"layer-weights-info"),c=o.map((function(e){return[e.name,e.shape,e.stats.min,e.stats.max,e.weight.size,e.stats.numZeros,e.stats.numNans,e.stats.numInfs]})),tb.table(s,{headers:u,values:c}),l=Nv.subSurface(i,"select-layer"),f=Nv.subSurface(i,"param-distribution"),d=function(e){return Pk(a,void 0,void 0,t(v).mark((function n(){var r,a;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=o.filter((function(t){return t.name===e}))[0],t.next=3,r.weight.data();case 3:a=t.sent,Kx.histogram(f,a,{height:150,width:460,stats:!1});case 5:case"end":return t.stop()}}),n)})))},Vk(o.map((function(e){return e.name})),l,d);case 13:case"end":return r.stop()}}),r,this)})))};var Wk={},Gk=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))});Object.defineProperty(Wk,"__esModule",{value:!0}),Wk.perClassAccuracy=function(e,n,r){return Gk(this,void 0,void 0,t(v).mark((function a(){var i,o,u,s,c,l;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=Iy.getDrawArea(e),o=["Class","Accuracy","# Samples"],u=[],s=0;s<n.length;s++)c=r?r[s]:s.toString(),l=n[s],u.push([c,l.accuracy,l.count]);return t.abrupt("return",tb.table(i,{headers:o,values:u}));case 5:case"end":return t.stop()}}),a)})))};var Hk={},qk=(v=s("40Zzs"),function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,u)}s((r=r.apply(e,t||[])).next())}))});Object.defineProperty(Hk,"__esModule",{value:!0}),Hk.valuesDistribution=function(e,n){return qk(this,void 0,void 0,t(v).mark((function r(){var a,i,o;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Iy.getDrawArea(e),t.next=3,$x.tensorStats(n);case 3:return i=t.sent,t.next=6,n.data();case 6:o=t.sent,Kx.histogram(a,o,{height:150,stats:i});case 8:case"end":return t.stop()}}),r)})))};var Jk={};
/** @license See the LICENSE file. */Object.defineProperty(Jk,"__esModule",{value:!0});Jk.version="1.5.1",wv.version_vis=Jk.version;var Kk={barchart:Av.barchart,table:tb.table,histogram:Kx.histogram,linechart:bk.linechart,scatterplot:Ck.scatterplot,confusionMatrix:Ox.confusionMatrix,heatmap:Bx.heatmap};wv.render=Kk;var Xk={accuracy:$x.accuracy,perClassAccuracy:$x.perClassAccuracy,confusionMatrix:$x.confusionMatrix};wv.metrics=Xk;var Yk={history:Fk.history,fitCallbacks:Fk.fitCallbacks,perClassAccuracy:Wk.perClassAccuracy,valuesDistribution:Hk.valuesDistribution,layer:Bk.layer,modelSummary:Bk.modelSummary};wv.show=Yk,wv.visor=By.visor,function(e){for(var t in e)wv.hasOwnProperty(t)||(wv[t]=e[t])}(s("eoZhW")),s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),Pe=s("9M1dW");s("gwYJi");s("lq2em"),s("4qDAZ");s("eBb9L");s("caNzv");var Qk=s("eBb9L");s("eBb9L");s("caNzv"),Qk=s("eBb9L");s("1i51P");Pe=s("9M1dW");Math.E,Math.LN2,Math.LN10,Math.LOG2E,Math.LOG10E,Math.PI,Math.SQRT1_2,Math.SQRT2,Number.MIN_VALUE,Number.MAX_VALUE;var Zk=Array.prototype.slice,$k=function(e,t,n){var r=n?n(t[0]):t[0];return r[e].apply(r,Zk.call(t,1))};Number.isNaN,Number.isFinite,Math.abs,Math.acos,Math.asin,Math.atan,Math.atan2,Math.ceil,Math.cos,Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.random,Math.round,Math.sin,Math.sqrt,Math.tan,Date.now,Date.UTC,parseFloat,parseInt,RegExp;var ew=s("2Wi4c");s("axtJv"),s("ixC8H");s("1i51P");c=s("3QOYJ"),l=s("2tuUj");function tw(e,t,n){return e.fields=t||[],e.fname=n,e}function nw(e){return 1===e.length?rw(e[0]):aw(e)}var rw=function(e){return function(t){return t[e]}},aw=function(e){var t=e.length;return function(n){for(var r=0;r<t;++r)n=n[e[r]];return n}};function iw(e){throw Error(e)}function ow(e){var t,n,r,a=[],i=e.length,o=null,u=0,s="";function c(){a.push(s+e.substring(t,n)),s="",t=n+1}for(e+="",t=n=0;n<i;++n)if("\\"===(r=e[n]))s+=e.substring(t,n),s+=e.substring(++n,++n),t=n;else if(r===o)c(),o=null,u=-1;else{if(o)continue;t===u&&'"'===r||t===u&&"'"===r?(t=n+1,o=r):"."!==r||u?"["===r?(n>t&&c(),u=t=n+1):"]"===r&&(u||iw("Access path missing open bracket: "+e),u>0&&c(),u=0,t=n+1):n>t?c():t=n+1}return u&&iw("Access path missing closing bracket: "+e),o&&iw("Access path missing closing quote: "+e),n>t&&(n++,c()),a}function uw(e,t,n){var r=ow(e);return e=1===r.length?r[0]:e,tw((n&&n.get||nw)(r),[e],t||e)}uw("id"),tw((function(e){return e}),[],"identity"),tw((function(){return 0}),[],"zero"),tw((function(){return 1}),[],"one"),tw((function(){return!0}),[],"true"),tw((function(){return!1}),[],"false");Array.isArray;Object.prototype.hasOwnProperty;var sw=s("dJYM3");var cw,lw=Object.prototype,fw=lw.hasOwnProperty,dw="function"==typeof Symbol?Symbol:{},pw=dw.iterator||"@@iterator",hw=dw.asyncIterator||"@@asyncIterator",vw=dw.toStringTag||"@@toStringTag";function gw(e,t,n,r){var a=t&&t.prototype instanceof Aw?t:Aw,i=Object.create(a.prototype),o=new Bw(r||[]);return i._invoke=function(e,t,n){var r=yw;return function(a,i){if(r===bw)throw new Error("Generator is already running");if(r===kw){if("throw"===a)throw i;return Lw()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var u=Iw(o,n);if(u){if(u===ww)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===yw)throw r=kw,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=bw;var s=mw(e,t,n);if("normal"===s.type){if(r=n.done?kw:xw,s.arg===ww)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r=kw,n.method="throw",n.arg=s.arg)}}}(e,n,o),i}function mw(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}var yw="suspendedStart",xw="suspendedYield",bw="executing",kw="completed",ww={};function Aw(){}function Ew(){}function Cw(){}var Sw={};Sw[pw]=function(){return this};var Nw=Object.getPrototypeOf,Tw=Nw&&Nw(Nw(Pw([])));Tw&&Tw!==lw&&fw.call(Tw,pw)&&(Sw=Tw);var Dw=Cw.prototype=Aw.prototype=Object.create(Sw);function Fw(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function Ow(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===Ew||"GeneratorFunction"===(t.displayName||t.name))}function _w(e,t){function n(r,a,i,o){var u=mw(e[r],e,a);if("throw"!==u.type){var s=u.arg,c=s.value;return c&&"object"==typeof c&&fw.call(c,"__await")?t.resolve(c.__await).then((function(e){n("next",e,i,o)}),(function(e){n("throw",e,i,o)})):t.resolve(c).then((function(e){s.value=e,i(s)}),(function(e){return n("throw",e,i,o)}))}o(u.arg)}var r;this._invoke=function(e,a){function i(){return new t((function(t,r){n(e,a,t,r)}))}return r=r?r.then(i,i):i()}}function Iw(e,t){var n=e.iterator[t.method];if(n===cw){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=cw,Iw(e,t),"throw"===t.method))return ww;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return ww}var r=mw(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,ww;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=cw),t.delegate=null,ww):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,ww)}function Rw(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function Mw(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Bw(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(Rw,this),this.reset(!0)}function Pw(e){if(e){var t=e[pw];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(fw.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=cw,t.done=!0,t};return r.next=r}}return{next:Lw}}function Lw(){return{value:cw,done:!0}}Ew.prototype=Dw.constructor=Cw,Cw.constructor=Ew,Cw[vw]=Ew.displayName="GeneratorFunction",Fw(_w.prototype),_w.prototype[hw]=function(){return this},Fw(Dw),Dw[vw]="Generator",Dw[pw]=function(){return this},Dw.toString=function(){return"[object Generator]"},Bw.prototype={constructor:Bw,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=cw,this.done=!1,this.delegate=null,this.method="next",this.arg=cw,this.tryEntries.forEach(Mw),!e)for(var t in this)"t"===t.charAt(0)&&fw.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=cw)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=cw),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var o=fw.call(a,"catchLoc"),u=fw.call(a,"finallyLoc");if(o&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&fw.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,ww):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),ww},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),Mw(n),ww}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;Mw(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:Pw(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=cw),ww}};var jw={wrap:gw,isGeneratorFunction:Ow,AsyncIterator:_w,mark:function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,Cw):(e.__proto__=Cw,vw in e||(e[vw]="GeneratorFunction")),e.prototype=Object.create(Dw),e},awrap:function(e){return{__await:e}},async:function(e,t,n,r,a){void 0===a&&(a=Promise);var i=new _w(gw(e,t,n,r),a);return Ow(t)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},keys:function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},values:Pw},zw=Uw;function Uw(e){var t=this;if(t instanceof Uw||(t=new Uw),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)t.push(arguments[n]);return t}function Vw(e,t,n){var r=t===e.head?new Hw(n,null,t,e):new Hw(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function Ww(e,t){e.tail=new Hw(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function Gw(e,t){e.head=new Hw(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function Hw(e,t,n,r){if(!(this instanceof Hw))return new Hw(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Uw.Node=Hw,Uw.create=Uw,Uw.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},Uw.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},Uw.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},Uw.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Ww(this,arguments[e]);return this.length},Uw.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)Gw(this,arguments[e]);return this.length},Uw.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},Uw.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},Uw.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},Uw.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},Uw.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},Uw.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},Uw.prototype.map=function(e,t){t=t||this;for(var n=new Uw,r=this.head;null!==r;)n.push(e.call(t,r.value,this)),r=r.next;return n},Uw.prototype.mapReverse=function(e,t){t=t||this;for(var n=new Uw,r=this.tail;null!==r;)n.push(e.call(t,r.value,this)),r=r.prev;return n},Uw.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var a=0;null!==r;a++)n=e(n,r.value,a),r=r.next;return n},Uw.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var a=this.length-1;null!==r;a--)n=e(n,r.value,a),r=r.prev;return n},Uw.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},Uw.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},Uw.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Uw;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=0,a=this.head;null!==a&&r<e;r++)a=a.next;for(;null!==a&&r<t;r++,a=a.next)n.push(a.value);return n},Uw.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new Uw;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var r=this.length,a=this.tail;null!==a&&r>t;r--)a=a.prev;for(;null!==a&&r>e;r--,a=a.prev)n.push(a.value);return n},Uw.prototype.splice=function(e,t){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,r=this.head;null!==r&&n<e;n++)r=r.next;var a=[];for(n=0;r&&n<t;n++)a.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(n=0;n<(arguments.length<=2?0:arguments.length-2);n++)r=Vw(this,r,n+2<2||arguments.length<=n+2?void 0:arguments[n+2]);return a},Uw.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{Uw.prototype[Symbol.iterator]=jw.mark((function e(){var t;return jw.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.head;case 1:if(!t){e.next=7;break}return e.next=4,t.value;case 4:t=t.next,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}catch(e){}var qw,Jw,Kw,Xw,Yw,Qw,Zw,$w,eA=zw,tA=Symbol("max"),nA=Symbol("length"),rA=Symbol("lengthCalculator"),aA=Symbol("allowStale"),iA=Symbol("maxAge"),oA=Symbol("dispose"),uA=Symbol("noDisposeOnSet"),sA=Symbol("lruList"),cA=Symbol("cache"),lA=Symbol("updateAgeOnGet"),fA=function(){return 1},dA=function(){"use strict";function e(t){if(c.default(this,e),"number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[tA]=t.max||1/0;var n=t.length||fA;if(this[rA]="function"!=typeof n?fA:n,this[aA]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[iA]=t.maxAge||0,this[oA]=t.dispose,this[uA]=t.noDisposeOnSet||!1,this[lA]=t.updateAgeOnGet||!1,this.reset()}return l.default(e,[{key:"max",get:function(){return this[tA]},set:function(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[tA]=e||1/0,vA(this)}},{key:"allowStale",get:function(){return this[aA]},set:function(e){this[aA]=!!e}},{key:"maxAge",get:function(){return this[iA]},set:function(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[iA]=e,vA(this)}},{key:"lengthCalculator",get:function(){return this[rA]},set:function(e){if("function"!=typeof e&&(e=fA),e!==this[rA]){var t=this;this[rA]=e,this[nA]=0,this[sA].forEach((function(e){e.length=t[rA](e.value,e.key),t[nA]+=e.length}))}vA(this)}},{key:"length",get:function(){return this[nA]}},{key:"itemCount",get:function(){return this[sA].length}},{key:"rforEach",value:function(e,t){t=t||this;for(var n=this[sA].tail;null!==n;){var r=n.prev;yA(this,e,n,t),n=r}}},{key:"forEach",value:function(e,t){t=t||this;for(var n=this[sA].head;null!==n;){var r=n.next;yA(this,e,n,t),n=r}}},{key:"keys",value:function(){return this[sA].toArray().map((function(e){return e.key}))}},{key:"values",value:function(){return this[sA].toArray().map((function(e){return e.value}))}},{key:"reset",value:function(){var e=this;this[oA]&&this[sA]&&this[sA].length&&this[sA].forEach((function(t){return e[oA](t.key,t.value)})),this[cA]=new Map,this[sA]=new eA,this[nA]=0}},{key:"dump",value:function(){var e=this;return this[sA].map((function(t){return!hA(e,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}})).toArray().filter((function(e){return e}))}},{key:"dumpLru",value:function(){return this[sA]}},{key:"set",value:function(e,t,n){if((n=n||this[iA])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");var r=n?Date.now():0,a=this[rA](t,e);if(this[cA].has(e)){if(a>this[tA])return gA(this,this[cA].get(e)),!1;var i=this[cA].get(e).value;return this[oA]&&(this[uA]||this[oA](e,i.value)),i.now=r,i.maxAge=n,i.value=t,this[nA]+=a-i.length,i.length=a,this.get(e),vA(this),!0}var o=new mA(e,t,a,r,n);return o.length>this[tA]?(this[oA]&&this[oA](e,t),!1):(this[nA]+=o.length,this[sA].unshift(o),this[cA].set(e,this[sA].head),vA(this),!0)}},{key:"has",value:function(e){if(!this[cA].has(e))return!1;var t=this[cA].get(e).value;return!hA(this,t)}},{key:"get",value:function(e){return pA(this,e,!0)}},{key:"peek",value:function(e){return pA(this,e,!1)}},{key:"pop",value:function(){var e=this[sA].tail;return e?(gA(this,e),e.value):null}},{key:"del",value:function(e){gA(this,this[cA].get(e))}},{key:"load",value:function(e){this.reset();for(var t=Date.now(),n=e.length-1;n>=0;n--){var r=e[n],a=r.e||0;if(0===a)this.set(r.k,r.v);else{var i=a-t;i>0&&this.set(r.k,r.v,i)}}}},{key:"prune",value:function(){var e=this;this[cA].forEach((function(t,n){return pA(e,n,!1)}))}}]),e}(),pA=function(e,t,n){var r=e[cA].get(t);if(r){var a=r.value;if(hA(e,a)){if(gA(e,r),!e[aA])return}else n&&(e[lA]&&(r.value.now=Date.now()),e[sA].unshiftNode(r));return a.value}},hA=function(e,t){if(!t||!t.maxAge&&!e[iA])return!1;var n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[iA]&&n>e[iA]},vA=function(e){if(e[nA]>e[tA])for(var t=e[sA].tail;e[nA]>e[tA]&&null!==t;){var n=t.prev;gA(e,t),t=n}},gA=function(e,t){if(t){var n=t.value;e[oA]&&e[oA](n.key,n.value),e[nA]-=n.length,e[cA].delete(n.key),e[sA].removeNode(t)}},mA=function e(t,n,r,a,i){"use strict";c.default(this,e),this.key=t,this.value=n,this.length=r,this.now=a,this.maxAge=i||0},yA=function(e,t,n,r){var a=n.value;hA(e,a)&&(gA(e,n),e[aA]||(a=void 0)),a&&t.call(r,a.value,a.key,e)},xA=dA,bA={exports:{}},kA={SEMVER_SPEC_VERSION:"2.0.0",MAX_LENGTH:256,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,MAX_SAFE_COMPONENT_LENGTH:16},wA=("object"==typeof sw&&sw.env,function(){});qw=bA.exports,Jw=kA.MAX_SAFE_COMPONENT_LENGTH,Kw=wA,Xw=(qw=bA.exports={}).re=[],Yw=qw.src=[],Qw=qw.t={},Zw=0,$w=function(e,t,n){var r=Zw++;Kw(r,t),Qw[e]=r,Yw[r]=t,Xw[r]=new RegExp(t,n?"g":void 0)},$w("NUMERICIDENTIFIER","0|[1-9]\\d*"),$w("NUMERICIDENTIFIERLOOSE","[0-9]+"),$w("NONNUMERICIDENTIFIER","\\d*[a-zA-Z-][a-zA-Z0-9-]*"),$w("MAINVERSION","(".concat(Yw[Qw.NUMERICIDENTIFIER],")\\.")+"(".concat(Yw[Qw.NUMERICIDENTIFIER],")\\.")+"(".concat(Yw[Qw.NUMERICIDENTIFIER],")")),$w("MAINVERSIONLOOSE","(".concat(Yw[Qw.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(Yw[Qw.NUMERICIDENTIFIERLOOSE],")\\.")+"(".concat(Yw[Qw.NUMERICIDENTIFIERLOOSE],")")),$w("PRERELEASEIDENTIFIER","(?:".concat(Yw[Qw.NUMERICIDENTIFIER],"|").concat(Yw[Qw.NONNUMERICIDENTIFIER],")")),$w("PRERELEASEIDENTIFIERLOOSE","(?:".concat(Yw[Qw.NUMERICIDENTIFIERLOOSE],"|").concat(Yw[Qw.NONNUMERICIDENTIFIER],")")),$w("PRERELEASE","(?:-(".concat(Yw[Qw.PRERELEASEIDENTIFIER],"(?:\\.").concat(Yw[Qw.PRERELEASEIDENTIFIER],")*))")),$w("PRERELEASELOOSE","(?:-?(".concat(Yw[Qw.PRERELEASEIDENTIFIERLOOSE],"(?:\\.").concat(Yw[Qw.PRERELEASEIDENTIFIERLOOSE],")*))")),$w("BUILDIDENTIFIER","[0-9A-Za-z-]+"),$w("BUILD","(?:\\+(".concat(Yw[Qw.BUILDIDENTIFIER],"(?:\\.").concat(Yw[Qw.BUILDIDENTIFIER],")*))")),$w("FULLPLAIN","v?".concat(Yw[Qw.MAINVERSION]).concat(Yw[Qw.PRERELEASE],"?").concat(Yw[Qw.BUILD],"?")),$w("FULL","^".concat(Yw[Qw.FULLPLAIN],"$")),$w("LOOSEPLAIN","[v=\\s]*".concat(Yw[Qw.MAINVERSIONLOOSE]).concat(Yw[Qw.PRERELEASELOOSE],"?").concat(Yw[Qw.BUILD],"?")),$w("LOOSE","^".concat(Yw[Qw.LOOSEPLAIN],"$")),$w("GTLT","((?:<|>)?=?)"),$w("XRANGEIDENTIFIERLOOSE","".concat(Yw[Qw.NUMERICIDENTIFIERLOOSE],"|x|X|\\*")),$w("XRANGEIDENTIFIER","".concat(Yw[Qw.NUMERICIDENTIFIER],"|x|X|\\*")),$w("XRANGEPLAIN","[v=\\s]*(".concat(Yw[Qw.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(Yw[Qw.XRANGEIDENTIFIER],")")+"(?:\\.(".concat(Yw[Qw.XRANGEIDENTIFIER],")")+"(?:".concat(Yw[Qw.PRERELEASE],")?").concat(Yw[Qw.BUILD],"?")+")?)?"),$w("XRANGEPLAINLOOSE","[v=\\s]*(".concat(Yw[Qw.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(Yw[Qw.XRANGEIDENTIFIERLOOSE],")")+"(?:\\.(".concat(Yw[Qw.XRANGEIDENTIFIERLOOSE],")")+"(?:".concat(Yw[Qw.PRERELEASELOOSE],")?").concat(Yw[Qw.BUILD],"?")+")?)?"),$w("XRANGE","^".concat(Yw[Qw.GTLT],"\\s*").concat(Yw[Qw.XRANGEPLAIN],"$")),$w("XRANGELOOSE","^".concat(Yw[Qw.GTLT],"\\s*").concat(Yw[Qw.XRANGEPLAINLOOSE],"$")),$w("COERCE","".concat("(^|[^\\d])(\\d{1,").concat(Jw,"})")+"(?:\\.(\\d{1,".concat(Jw,"}))?")+"(?:\\.(\\d{1,".concat(Jw,"}))?")+"(?:$|[^\\d])"),$w("COERCERTL",Yw[Qw.COERCE],!0),$w("LONETILDE","(?:~>?)"),$w("TILDETRIM","(\\s*)".concat(Yw[Qw.LONETILDE],"\\s+"),!0),qw.tildeTrimReplace="$1~",$w("TILDE","^".concat(Yw[Qw.LONETILDE]).concat(Yw[Qw.XRANGEPLAIN],"$")),$w("TILDELOOSE","^".concat(Yw[Qw.LONETILDE]).concat(Yw[Qw.XRANGEPLAINLOOSE],"$")),$w("LONECARET","(?:\\^)"),$w("CARETTRIM","(\\s*)".concat(Yw[Qw.LONECARET],"\\s+"),!0),qw.caretTrimReplace="$1^",$w("CARET","^".concat(Yw[Qw.LONECARET]).concat(Yw[Qw.XRANGEPLAIN],"$")),$w("CARETLOOSE","^".concat(Yw[Qw.LONECARET]).concat(Yw[Qw.XRANGEPLAINLOOSE],"$")),$w("COMPARATORLOOSE","^".concat(Yw[Qw.GTLT],"\\s*(").concat(Yw[Qw.LOOSEPLAIN],")$|^$")),$w("COMPARATOR","^".concat(Yw[Qw.GTLT],"\\s*(").concat(Yw[Qw.FULLPLAIN],")$|^$")),$w("COMPARATORTRIM","(\\s*)".concat(Yw[Qw.GTLT],"\\s*(").concat(Yw[Qw.LOOSEPLAIN],"|").concat(Yw[Qw.XRANGEPLAIN],")"),!0),qw.comparatorTrimReplace="$1$2$3",$w("HYPHENRANGE","^\\s*(".concat(Yw[Qw.XRANGEPLAIN],")")+"\\s+-\\s+"+"(".concat(Yw[Qw.XRANGEPLAIN],")")+"\\s*$"),$w("HYPHENRANGELOOSE","^\\s*(".concat(Yw[Qw.XRANGEPLAINLOOSE],")")+"\\s+-\\s+"+"(".concat(Yw[Qw.XRANGEPLAINLOOSE],")")+"\\s*$"),$w("STAR","(<|>)?=?\\s*\\*"),$w("GTE0","^\\s*>=\\s*0.0.0\\s*$"),$w("GTE0PRE","^\\s*>=\\s*0.0.0-0\\s*$");bA.exports.re,bA.exports.t,Symbol("SemVer ANY"),bA.exports.re,bA.exports.t;new xA({max:1e3}),bA.exports.re,bA.exports.t,bA.exports.comparatorTrimReplace,bA.exports.tildeTrimReplace,bA.exports.caretTrimReplace;String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return this.substr(!t||t<0?0:+t,e.length)===e});var AA;var EA=Qk,CA=ew,SA="undefined"!=typeof window?window:void 0;void 0===CA&&null!=SA&&null!==(AA=SA.vl)&&void 0!==AA&&AA.compile&&(CA=SA.vl);EA.version,CA&&CA.version;s("1i51P");c=s("3QOYJ"),l=s("2tuUj");var NA=function(){"use strict";function e(){c.default(this,e),this.RIGHT_BOUND=500,this.LOWER_BOUND=150,this.x=this.RIGHT_BOUND/2,this.y=Math.random()*this.LOWER_BOUND,this.speed=10,this.r=3,this.velocity={x:-1,y:Math.random()-.5}}return l.default(e,[{key:"update",value:function(e,t){return(this.y<=0&&this.velocity.y<0||this.y>=this.LOWER_BOUND&&this.velocity.y>0)&&(this.velocity.y*=-1),(this.intersect(e.getRect())||this.intersect(t.getRect()))&&(this.velocity.x*=-1),this.x+=this.velocity.x*this.speed,this.y+=this.velocity.y*this.speed,this.isDone()}},{key:"isDone",value:function(){return this.x<0||this.x>this.RIGHT_BOUND}},{key:"intersect",value:function(e){return!(e.x>this.x+this.r||e.x+e.width<this.x||e.y>this.y+this.r||e.y+e.height<this.y)}},{key:"setRandomState",value:function(){this.x=this.RIGHT_BOUND/2,this.y=Math.random()*this.LOWER_BOUND,this.velocity={x:-1,y:Math.random()-.5}}}]),e}();s("1i51P");c=s("3QOYJ"),l=s("2tuUj"),ie=s("bqdMI");var TA=function(){"use strict";function e(t,n){c.default(this,e),this.x=!0===n?450:50,this.ball=t,this.speed=10,this.isAI=n,this.height=10,this.width=5,this.screenWidth=500,this.screenHeight=150,this.y=this.screenHeight/2-this.height/2}return l.default(e,[{key:"getStateTensor",value:function(){return ie.tensor2d([[this.y/this.screenHeight,this.ball.y/this.screenHeight,this.ball.velocity.x,this.ball.velocity.y]])}},{key:"setRandomState",value:function(){this.y=Math.random()*(this.screenHeight-this.height)}},{key:"update",value:function(e){var t;!0===this.isAI?this.y=this.ball.y:(t=e>0?1:-1,this.y+=t*this.speed),this.y<0&&(this.y=0),this.y>this.screenHeight-this.height&&(this.y=this.screenHeight-this.height)}},{key:"getRect",value:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}}]),e}();function DA(e){return FA(e)/e.length}function FA(e){if(0===e.length)throw new Error("Expected xs to be a non-empty Array.");return e.reduce((function(e,t){return t+e}))}var OA,_A=document.getElementById("app-status"),IA=document.getElementById("stored-model-status"),RA=document.getElementById("hidden-layer-sizes"),MA=document.getElementById("create-model"),BA=document.getElementById("delete-stored-model"),PA=document.getElementById("cart-pole-canvas"),LA=document.getElementById("num-iterations"),jA=document.getElementById("games-per-iteration"),zA=document.getElementById("discount-rate"),UA=document.getElementById("max-steps-per-game"),VA=document.getElementById("learning-rate"),WA=document.getElementById("render-during-training"),GA=document.getElementById("train"),HA=document.getElementById("test"),qA=document.getElementById("iteration-status"),JA=document.getElementById("iteration-progress"),KA=document.getElementById("train-status"),XA=document.getElementById("train-speed"),YA=document.getElementById("train-progress"),QA=document.getElementById("steps-container"),ZA=!1;function $A(e){_A.textContent=e,console.log(e)}var eE=!0;function tE(e,t,n){return nE.apply(this,arguments)}function nE(){return(nE=f.default(t(v).mark((function e(n,r,a){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!eE){e.next=4;break}return cE(n,r,a,PA),e.next=4,bs.nextFrame();case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function rE(e,t){qA.textContent="Game ".concat(e," of ").concat(t),JA.value=e/t*100,e===t&&(qA.textContent="Updating weights...")}function aE(e,t){KA.textContent="Iteration ".concat(e," of ").concat(t),YA.value=e/t*100}var iE=[];function oE(){wv.render.linechart(QA,{values:iE},{xLabel:"Training Iteration",yLabel:"Mean Steps Per Game",width:400,height:300})}function uE(){GA.textContent="Stop",HA.disabled=!0,BA.disabled=!0}function sE(){GA.textContent="Train",HA.disabled=!1,BA.disabled=!1}function cE(e,t,n,r){r.style.display||(r.style.display="block");var a=r.getContext("2d");a.clearRect(0,0,r.width,r.height),a.beginPath(),a.strokeStyle="#000000",a.lineWidth=2,a.rect(e.x,e.y,e.width,e.height),a.stroke(),a.beginPath(),a.strokeStyle="#000000",a.lineWidth=2,a.rect(t.x,t.y,t.width,t.height),a.stroke(),a.beginPath(),a.rect(n.x,n.y,n.r,n.r),a.lineWidth=2,a.strokeStyle="#000000",a.stroke()}function lE(){return fE.apply(this,arguments)}function fE(){return(fE=f.default(t(v).mark((function e(){var n;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hE.checkStoredModelStatus();case 2:null==(n=e.sent)?(IA.value="No stored model.",BA.disabled=!0):(IA.value="Saved@".concat(n.dateSaved.toISOString()),BA.disabled=!1,MA.disabled=!0),MA.disabled=null!=OA,RA.disabled=null!=OA,GA.disabled=null==OA,HA.disabled=null==OA,WA.checked=eE;case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dE(){return(dE=f.default(t(v).mark((function e(){var n,r,a;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new NA,r=new TA(n,!1),a=new TA(n,!0),e.next=5,hE.checkStoredModelStatus();case 5:if(e.t0=e.sent,null==e.t0){e.next=12;break}return e.next=9,hE.loadModel();case 9:OA=e.sent,$A("Loaded policy network from IndexedDB."),RA.value=OA.hiddenLayerSizes();case 12:return e.next=14,lE();case 14:WA.addEventListener("change",(function(){eE=WA.checked})),MA.addEventListener("click",f.default(t(v).mark((function e(){var n;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=RA.value.trim().split(",").map((function(e){var t=Number.parseInt(e.trim());if(!(t>0))throw new Error("Invalid hidden layer sizes string: "+"".concat(RA.value));return t})),OA=new hE(n),console.log("DONE constructing new instance of SaveablePolicyNetwork"),e.next=5,lE();case 5:case"end":return e.stop()}}),e)})))),BA.addEventListener("click",f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!confirm("Are you sure you want to delete the locally-stored model?")){e.next=6;break}return e.next=3,OA.removeModel();case 3:return OA=null,e.next=6,lE();case 6:case"end":return e.stop()}}),e)})))),GA.addEventListener("click",f.default(t(v).mark((function e(){var i,o,u,s,c,l,f,d,p,h,g;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Stop"!==GA.textContent){e.next=4;break}ZA=!0,e.next=51;break;case 4:if(uE(),(i=Number.parseInt(LA.value))>0){e.next=8;break}throw new Error("Invalid number of iterations: ".concat(i));case 8:if((o=Number.parseInt(jA.value))>0){e.next=11;break}throw new Error("Invalid # of games per iterations: ".concat(o));case 11:if((u=Number.parseInt(UA.value))>1){e.next=14;break}throw new Error("Invalid max. steps per game: ".concat(u));case 14:if((s=Number.parseFloat(zA.value))>0&&s<1){e.next=17;break}throw new Error("Invalid discount rate: ".concat(s));case 17:c=Number.parseFloat(VA.value),$A("Training policy network... Please wait. Network is saved to IndexedDB at the end of each iteration."),l=pc.train.adam(c),iE=[],aE(0,i),f=(new Date).getTime(),ZA=!1,d=0;case 25:if(!(d<i)){e.next=49;break}return e.next=28,OA.train(r,a,n,l,s,o,u);case 28:return p=e.sent,h=(new Date).getTime(),g=FA(p)/((h-f)/1e3),f=h,XA.textContent="".concat(g.toFixed(1)," steps/s"),iE.push({x:d+1,y:DA(p)}),console.log("# of tensors: ".concat(m.memory().numTensors)),oE(),aE(d+1,i),e.next=39,bs.nextFrame();case 39:return e.next=41,OA.saveModel();case 41:return e.next=43,lE();case 43:if(!ZA){e.next=46;break}return $A("Training stopped by user."),e.abrupt("break",49);case 46:++d,e.next=25;break;case 49:ZA||$A("Training completed."),sE();case 51:case"end":return e.stop()}}),e)})))),HA.addEventListener("click",f.default(t(v).mark((function e(){var n,r,a,i,o;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:uE(),n=!1,r=new NA,a=new TA(r,!1),i=new TA(r,!0),a.setRandomState(),o=0,ZA=!1;case 8:if(n){e.next=17;break}return o++,m.tidy((function(){var e=OA.getActions(a.getStateTensor())[0];$A("Test in progress. "+"Action: ".concat(1===e?"DOWN":"UP"," (Step ").concat(o,")")),a.update(e),i.update(),n=r.update(a,i),cE(a,i,r,PA)})),e.next=13,bs.nextFrame();case 13:if(!ZA){e.next=15;break}return e.abrupt("break",17);case 15:e.next=8;break;case 17:$A(ZA?"Test stopped by user after ".concat(o," step(s)."):"Test finished. Survived ".concat(o," step(s).")),console.log("# of tensors: ".concat(m.memory().numTensors)),sE();case 20:case"end":return e.stop()}}),e)}))));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var pE="indexeddb://pong-v1",hE=function(e){"use strict";p.default(r,e);var n=h.default(r);function r(e){return c.default(this,r),n.call(this,e)}return l.default(r,[{key:"saveModel",value:function(){var e=this;return f.default(t(v).mark((function n(){return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.policyNet.save(pE);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),n)})))()}},{key:"removeModel",value:function(){return f.default(t(v).mark((function e(){return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ms.removeModel(pE);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))()}},{key:"hiddenLayerSizes",value:function(){for(var e=[],t=0;t<this.policyNet.layers.length-1;++t)e.push(this.policyNet.layers[t].units);return 1===e.length?e[0]:e}}],[{key:"loadModel",value:function(){return f.default(t(v).mark((function e(){var n,a;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ms.listModels();case 2:if(n=e.sent,!(pE in n)){e.next=12;break}return console.log("Loading existing model..."),e.next=7,bl(pE);case 7:return a=e.sent,console.log("Loaded model from ".concat(pE)),e.abrupt("return",new r(a));case 12:throw new Error("Cannot find model at ".concat(pE,"."));case 13:case"end":return e.stop()}}),e)})))()}},{key:"checkStoredModelStatus",value:function(){return f.default(t(v).mark((function e(){var n;return t(v).wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ms.listModels();case 2:return n=e.sent,e.abrupt("return",n["indexeddb://pong-v1"]);case 4:case"end":return e.stop()}}),e)})))()}}]),r}(function(){"use strict";function e(t){c.default(this,e),t instanceof pl?this.policyNet=t:this.createPolicyNetwork(t)}return l.default(e,[{key:"createPolicyNetwork",value:function(e){var t,n=this;Array.isArray(e)||(e=[e]),this.policyNet=new xl(t),e.forEach((function(e,t){n.policyNet.add(Xu.dense({units:e,activation:"sigmoid",inputShape:0===t?[4]:void 0}))})),this.policyNet.add(Xu.dense({units:1}))}},{key:"train",value:function(e,n,r,a,i,o,u){var s=this;return f.default(t(v).mark((function c(){var l,f,d,p,h,g,y,x,b,k;return t(v).wrap((function(t){for(;;)switch(t.prev=t.next){case 0:l=[],f=[],d=[],rE(0,o),p=0;case 5:if(!(p<o)){t.next=39;break}e.setRandomState(),n.setRandomState(),r.setRandomState(),h=[],g=[],y=0;case 12:if(!(y<u)){t.next=30;break}return x=m.tidy((function(){var t=e.getStateTensor();return s.getGradientsAndSaveActions(t).grads})),s.pushGradients(g,x),b=s.currentActions_[0],e.update(b),n.update(),k=r.update(e,n),t.next=21,tE(e,n,r);case 21:if(!k){t.next=26;break}return h.push(0),t.abrupt("break",30);case 26:h.push(1);case 27:++y,t.next=12;break;case 30:return rE(p+1,o),d.push(h.length),s.pushGradients(l,g),f.push(h),t.next=36,bs.nextFrame();case 36:++p,t.next=5;break;case 39:return m.tidy((function(){var e=gE(f,i);a.applyGradients(mE(l,e));for(var t=e.sort((function(e,t){return e.size-t.size})),n=t[t.length-1].dataSync(),r=0,o=0;o<n.length;o++)r+=n[o];console.log("bestRewards",n),console.log("bestRewardSum2",r)})),m.dispose(l),t.abrupt("return",d);case 42:case"end":return t.stop()}}),c)})))()}},{key:"getGradientsAndSaveActions",value:function(e){var t=this;return os.variableGrads((function(){return m.tidy((function(){var n=d.default(t.getLogitsAndActions(e),2),r=n[0],a=n[1];t.currentActions_=a.dataSync();var i=nu.sub(1,ie.tensor2d(t.currentActions_,a.shape));return oe.losses.sigmoidCrossEntropy(i,r).asScalar()}))}))}},{key:"getCurrentActions",value:function(){return this.currentActions_}},{key:"getLogitsAndActions",value:function(e){var t=this;return m.tidy((function(){var n=t.policyNet.predict(e),r=Sl.sigmoid(n),a=Eo.concat([r,nu.sub(1,r)],1);return[n,yv.multinomial(a,1,null,!0)]}))}},{key:"getActions",value:function(e){return this.getLogitsAndActions(e)[1].dataSync()}},{key:"pushGradients",value:function(e,t){for(var n in t)n in e?e[n].push(t[n]):e[n]=[t[n]]}}]),e}());function vE(e,t){for(var n=Ee.buffer([e.length]),r=0,a=e.length-1;a>=0;--a){var i=t*r+e[a];n.set(i,a),r=i}return n.toTensor()}function gE(e,t){return m.tidy((function(){var n=[],r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;n.push(vE(s,t))}}catch(e){a=!0,i=e}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}var c=Eo.concat(n),l=Rs.mean(c),f=Ai.sqrt(Rs.mean(sv.square(c.sub(l))));return n.map((function(e){return e.sub(l).div(f)}))}))}function mE(e,t){return m.tidy((function(){var n=function(n){r[n]=m.tidy((function(){for(var r=e[n].map((function(e){return x.stack(e)})),a=[],i=0;i<r[0].rank-1;++i)a.push(1);for(var o=t.map((function(e){return e.reshape(e.shape.concat(a))})),u=0;u<r.length;++u)r[u]=r[u].mul(o[u]);return Rs.mean(Eo.concat(r,0),0)}))},r={};for(var a in e)n(a);return r}))}!function(){dE.apply(this,arguments)}()}();
//# sourceMappingURL=index.js.map
